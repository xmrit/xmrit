let t,e,i,r;function o(t){return t&&t.__esModule?t.default:t}function s(t,e,i,r){Object.defineProperty(t,e,{get:i,set:r,enumerable:!0,configurable:!0})}var n,a,l,h,c,d,u,g,p,f,m,y,w,b,C,S,x,E,R,T,M,k,A,O,P,I,H,L,D,N,_,F,j,B,W,V,U,z,Y,G,$,X,q,K,Z,Q,J,tt,te,ti,tr=globalThis,to={},ts={},tn=tr.parcelRequire94c2;null==tn&&((tn=function(t){if(t in to)return to[t].exports;if(t in ts){var e=ts[t];delete ts[t];var i={id:t,exports:{}};return to[t]=i,e.call(i.exports,i,i.exports),i.exports}var r=Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(t,e){ts[t]=e},tr.parcelRequire94c2=tn);var ta=tn.register;ta("45fvw",function(t,e){var i;i=function(){function e(){return q.apply(null,arguments)}function i(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function r(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function o(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function s(t){var e;if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(t).length;for(e in t)if(o(t,e))return!1;return!0}function n(t){return void 0===t}function a(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)}function l(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function h(t,e){var i,r=[],o=t.length;for(i=0;i<o;++i)r.push(e(t[i],i));return r}function c(t,e){for(var i in e)o(e,i)&&(t[i]=e[i]);return o(e,"toString")&&(t.toString=e.toString),o(e,"valueOf")&&(t.valueOf=e.valueOf),t}function d(t,e,i,r){return eo(t,e,i,r,!0).utc()}function u(t){return null==t._pf&&(t._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}),t._pf}function g(t){if(null==t._isValid){var e=u(t),i=K.call(e.parsedDateParts,function(t){return null!=t}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&i);if(t._strict&&(r=r&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour),null!=Object.isFrozen&&Object.isFrozen(t))return r;t._isValid=r}return t._isValid}function p(t){var e=d(NaN);return null!=t?c(u(e),t):u(e).userInvalidated=!0,e}K=Array.prototype.some?Array.prototype.some:function(t){var e,i=Object(this),r=i.length>>>0;for(e=0;e<r;e++)if(e in i&&t.call(this,i[e],e,i))return!0;return!1};var f,m,y=e.momentProperties=[],w=!1;function b(t,e){var i,r,o,s=y.length;if(n(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),n(e._i)||(t._i=e._i),n(e._f)||(t._f=e._f),n(e._l)||(t._l=e._l),n(e._strict)||(t._strict=e._strict),n(e._tzm)||(t._tzm=e._tzm),n(e._isUTC)||(t._isUTC=e._isUTC),n(e._offset)||(t._offset=e._offset),n(e._pf)||(t._pf=u(e)),n(e._locale)||(t._locale=e._locale),s>0)for(i=0;i<s;i++)n(o=e[r=y[i]])||(t[r]=o);return t}function C(t){b(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===w&&(w=!0,e.updateOffset(this),w=!1)}function S(t){return t instanceof C||null!=t&&null!=t._isAMomentObject}function x(t){!1===e.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function E(t,i){var r=!0;return c(function(){if(null!=e.deprecationHandler&&e.deprecationHandler(null,t),r){var s,n,a,l=[],h=arguments.length;for(n=0;n<h;n++){if(s="","object"==typeof arguments[n]){for(a in s+="\n["+n+"] ",arguments[0])o(arguments[0],a)&&(s+=a+": "+arguments[0][a]+", ");s=s.slice(0,-2)}else s=arguments[n];l.push(s)}x(t+"\nArguments: "+Array.prototype.slice.call(l).join("")+"\n"+Error().stack),r=!1}return i.apply(this,arguments)},i)}var R={};function T(t,i){null!=e.deprecationHandler&&e.deprecationHandler(t,i),R[t]||(x(i),R[t]=!0)}function M(t){return"undefined"!=typeof Function&&t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function k(t,e){var i,s=c({},t);for(i in e)o(e,i)&&(r(t[i])&&r(e[i])?(s[i]={},c(s[i],t[i]),c(s[i],e[i])):null!=e[i]?s[i]=e[i]:delete s[i]);for(i in t)o(t,i)&&!o(e,i)&&r(t[i])&&(s[i]=c({},s[i]));return s}function A(t){null!=t&&this.set(t)}function O(t,e,i){var r=""+Math.abs(t);return(t>=0?i?"+":"":"-")+Math.pow(10,Math.max(0,e-r.length)).toString().substr(1)+r}e.suppressDeprecationWarnings=!1,e.deprecationHandler=null,Z=Object.keys?Object.keys:function(t){var e,i=[];for(e in t)o(t,e)&&i.push(e);return i};var P=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,I=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,H={},L={};function D(t,e,i,r){var o=r;"string"==typeof r&&(o=function(){return this[r]()}),t&&(L[t]=o),e&&(L[e[0]]=function(){return O(o.apply(this,arguments),e[1],e[2])}),i&&(L[i]=function(){return this.localeData().ordinal(o.apply(this,arguments),t)})}function N(t,e){return t.isValid()?(H[e=_(e,t.localeData())]=H[e]||function(t){var e,i,r,o=t.match(P);for(i=0,r=o.length;i<r;i++)L[o[i]]?o[i]=L[o[i]]:o[i]=(e=o[i]).match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"");return function(e){var i,s="";for(i=0;i<r;i++)s+=M(o[i])?o[i].call(e,t):o[i];return s}}(e),H[e](t)):t.localeData().invalidDate()}function _(t,e){var i=5;function r(t){return e.longDateFormat(t)||t}for(I.lastIndex=0;i>=0&&I.test(t);)t=t.replace(I,r),I.lastIndex=0,i-=1;return t}var F={};function j(t,e){var i=t.toLowerCase();F[i]=F[i+"s"]=F[e]=t}function B(t){return"string"==typeof t?F[t]||F[t.toLowerCase()]:void 0}function W(t){var e,i,r={};for(i in t)o(t,i)&&(e=B(i))&&(r[e]=t[i]);return r}var V={};function U(t){return t%4==0&&t%100!=0||t%400==0}function z(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Y(t){var e=+t,i=0;return 0!==e&&isFinite(e)&&(i=z(e)),i}function G(t,i){return function(r){return null!=r?(X(this,t,r),e.updateOffset(this,i),this):$(this,t)}}function $(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function X(t,e,i){t.isValid()&&!isNaN(i)&&("FullYear"===e&&U(t.year())&&1===t.month()&&29===t.date()?(i=Y(i),t._d["set"+(t._isUTC?"UTC":"")+e](i,t.month(),tb(i,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](i))}var q,K,Z,Q,J=/\d/,tt=/\d\d/,te=/\d{3}/,ti=/\d{4}/,tr=/[+-]?\d{6}/,to=/\d\d?/,ts=/\d\d\d\d?/,tn=/\d\d\d\d\d\d?/,ta=/\d{1,3}/,tl=/\d{1,4}/,th=/[+-]?\d{1,6}/,tc=/\d+/,td=/[+-]?\d+/,tu=/Z|[+-]\d\d:?\d\d/gi,tg=/Z|[+-]\d\d(?::?\d\d)?/gi,tp=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function tf(t,e,i){Q[t]=M(e)?e:function(t,r){return t&&i?i:e}}function tm(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}Q={};var ty={};function tv(t,e){var i,r,o=e;for("string"==typeof t&&(t=[t]),a(e)&&(o=function(t,i){i[e]=Y(t)}),r=t.length,i=0;i<r;i++)ty[t[i]]=o}function tw(t,e){tv(t,function(t,i,r,o){r._w=r._w||{},e(t,r._w,r,o)})}function tb(t,e){if(isNaN(t)||isNaN(e))return NaN;var i=(e%12+12)%12;return t+=(e-i)/12,1===i?U(t)?29:28:31-i%7%2}tV=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return -1},D("M",["MM",2],"Mo",function(){return this.month()+1}),D("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)}),D("MMMM",0,0,function(t){return this.localeData().months(this,t)}),j("month","M"),V.month=8,tf("M",to),tf("MM",to,tt),tf("MMM",function(t,e){return e.monthsShortRegex(t)}),tf("MMMM",function(t,e){return e.monthsRegex(t)}),tv(["M","MM"],function(t,e){e[1]=Y(t)-1}),tv(["MMM","MMMM"],function(t,e,i,r){var o=i._locale.monthsParse(t,r,i._strict);null!=o?e[1]=o:u(i).invalidMonth=t});var tC="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),tS=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;function tx(t,e,i){var r,o,s,n=t.toLocaleLowerCase();if(!this._monthsParse)for(r=0,this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[];r<12;++r)s=d([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(s,"").toLocaleLowerCase();return i?"MMM"===e?-1!==(o=tV.call(this._shortMonthsParse,n))?o:null:-1!==(o=tV.call(this._longMonthsParse,n))?o:null:"MMM"===e?-1!==(o=tV.call(this._shortMonthsParse,n))?o:-1!==(o=tV.call(this._longMonthsParse,n))?o:null:-1!==(o=tV.call(this._longMonthsParse,n))?o:-1!==(o=tV.call(this._shortMonthsParse,n))?o:null}function tE(t,e){var i;if(!t.isValid())return t;if("string"==typeof e){if(/^\d+$/.test(e))e=Y(e);else if(!a(e=t.localeData().monthsParse(e)))return t}return i=Math.min(t.date(),tb(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,i),t}function tR(t){return null!=t?(tE(this,t),e.updateOffset(this,!0),this):$(this,"Month")}function tT(){function t(t,e){return e.length-t.length}var e,i,r=[],o=[],s=[];for(e=0;e<12;e++)i=d([2e3,e]),r.push(this.monthsShort(i,"")),o.push(this.months(i,"")),s.push(this.months(i,"")),s.push(this.monthsShort(i,""));for(r.sort(t),o.sort(t),s.sort(t),e=0;e<12;e++)r[e]=tm(r[e]),o[e]=tm(o[e]);for(e=0;e<24;e++)s[e]=tm(s[e]);this._monthsRegex=RegExp("^("+s.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=RegExp("^("+r.join("|")+")","i")}function tM(t){return U(t)?366:365}D("Y",0,0,function(){var t=this.year();return t<=9999?O(t,4):"+"+t}),D(0,["YY",2],0,function(){return this.year()%100}),D(0,["YYYY",4],0,"year"),D(0,["YYYYY",5],0,"year"),D(0,["YYYYYY",6,!0],0,"year"),j("year","y"),V.year=1,tf("Y",td),tf("YY",to,tt),tf("YYYY",tl,ti),tf("YYYYY",th,tr),tf("YYYYYY",th,tr),tv(["YYYYY","YYYYYY"],0),tv("YYYY",function(t,i){i[0]=2===t.length?e.parseTwoDigitYear(t):Y(t)}),tv("YY",function(t,i){i[0]=e.parseTwoDigitYear(t)}),tv("Y",function(t,e){e[0]=parseInt(t,10)}),e.parseTwoDigitYear=function(t){return Y(t)+(Y(t)>68?1900:2e3)};var tk=G("FullYear",!0);function tA(t,e,i,r,o,s,n){var a;return t<100&&t>=0?isFinite((a=new Date(t+400,e,i,r,o,s,n)).getFullYear())&&a.setFullYear(t):a=new Date(t,e,i,r,o,s,n),a}function tO(t){var e,i;return t<100&&t>=0?(i=Array.prototype.slice.call(arguments),i[0]=t+400,isFinite((e=new Date(Date.UTC.apply(null,i))).getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function tP(t,e,i){var r=7+e-i;return-((7+tO(t,0,r).getUTCDay()-e)%7)+r-1}function tI(t,e,i,r,o){var s,n,a=1+7*(e-1)+(7+i-r)%7+tP(t,r,o);return a<=0?n=tM(s=t-1)+a:a>tM(t)?(s=t+1,n=a-tM(t)):(s=t,n=a),{year:s,dayOfYear:n}}function tH(t,e,i){var r,o,s=tP(t.year(),e,i),n=Math.floor((t.dayOfYear()-s-1)/7)+1;return n<1?r=n+tL(o=t.year()-1,e,i):n>tL(t.year(),e,i)?(r=n-tL(t.year(),e,i),o=t.year()+1):(o=t.year(),r=n),{week:r,year:o}}function tL(t,e,i){var r=tP(t,e,i),o=tP(t+1,e,i);return(tM(t)-r+o)/7}function tD(t,e){return t.slice(e,7).concat(t.slice(0,e))}D("w",["ww",2],"wo","week"),D("W",["WW",2],"Wo","isoWeek"),j("week","w"),j("isoWeek","W"),V.week=5,V.isoWeek=5,tf("w",to),tf("ww",to,tt),tf("W",to),tf("WW",to,tt),tw(["w","ww","W","WW"],function(t,e,i,r){e[r.substr(0,1)]=Y(t)}),D("d",0,"do","day"),D("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)}),D("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)}),D("dddd",0,0,function(t){return this.localeData().weekdays(this,t)}),D("e",0,0,"weekday"),D("E",0,0,"isoWeekday"),j("day","d"),j("weekday","e"),j("isoWeekday","E"),V.day=11,V.weekday=11,V.isoWeekday=11,tf("d",to),tf("e",to),tf("E",to),tf("dd",function(t,e){return e.weekdaysMinRegex(t)}),tf("ddd",function(t,e){return e.weekdaysShortRegex(t)}),tf("dddd",function(t,e){return e.weekdaysRegex(t)}),tw(["dd","ddd","dddd"],function(t,e,i,r){var o=i._locale.weekdaysParse(t,r,i._strict);null!=o?e.d=o:u(i).invalidWeekday=t}),tw(["d","e","E"],function(t,e,i,r){e[r]=Y(t)});var tN="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function t_(t,e,i){var r,o,s,n=t.toLocaleLowerCase();if(!this._weekdaysParse)for(r=0,this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[];r<7;++r)s=d([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(s,"").toLocaleLowerCase();return i?"dddd"===e?-1!==(o=tV.call(this._weekdaysParse,n))?o:null:"ddd"===e?-1!==(o=tV.call(this._shortWeekdaysParse,n))?o:null:-1!==(o=tV.call(this._minWeekdaysParse,n))?o:null:"dddd"===e?-1!==(o=tV.call(this._weekdaysParse,n))||-1!==(o=tV.call(this._shortWeekdaysParse,n))?o:-1!==(o=tV.call(this._minWeekdaysParse,n))?o:null:"ddd"===e?-1!==(o=tV.call(this._shortWeekdaysParse,n))||-1!==(o=tV.call(this._weekdaysParse,n))?o:-1!==(o=tV.call(this._minWeekdaysParse,n))?o:null:-1!==(o=tV.call(this._minWeekdaysParse,n))||-1!==(o=tV.call(this._weekdaysParse,n))?o:-1!==(o=tV.call(this._shortWeekdaysParse,n))?o:null}function tF(){function t(t,e){return e.length-t.length}var e,i,r,o,s,n=[],a=[],l=[],h=[];for(e=0;e<7;e++)i=d([2e3,1]).day(e),r=tm(this.weekdaysMin(i,"")),o=tm(this.weekdaysShort(i,"")),s=tm(this.weekdays(i,"")),n.push(r),a.push(o),l.push(s),h.push(r),h.push(o),h.push(s);n.sort(t),a.sort(t),l.sort(t),h.sort(t),this._weekdaysRegex=RegExp("^("+h.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=RegExp("^("+n.join("|")+")","i")}function tj(){return this.hours()%12||12}function tB(t,e){D(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}function tW(t,e){return e._meridiemParse}D("H",["HH",2],0,"hour"),D("h",["hh",2],0,tj),D("k",["kk",2],0,function(){return this.hours()||24}),D("hmm",0,0,function(){return""+tj.apply(this)+O(this.minutes(),2)}),D("hmmss",0,0,function(){return""+tj.apply(this)+O(this.minutes(),2)+O(this.seconds(),2)}),D("Hmm",0,0,function(){return""+this.hours()+O(this.minutes(),2)}),D("Hmmss",0,0,function(){return""+this.hours()+O(this.minutes(),2)+O(this.seconds(),2)}),tB("a",!0),tB("A",!1),j("hour","h"),V.hour=13,tf("a",tW),tf("A",tW),tf("H",to),tf("h",to),tf("k",to),tf("HH",to,tt),tf("hh",to,tt),tf("kk",to,tt),tf("hmm",ts),tf("hmmss",tn),tf("Hmm",ts),tf("Hmmss",tn),tv(["H","HH"],3),tv(["k","kk"],function(t,e,i){var r=Y(t);e[3]=24===r?0:r}),tv(["a","A"],function(t,e,i){i._isPm=i._locale.isPM(t),i._meridiem=t}),tv(["h","hh"],function(t,e,i){e[3]=Y(t),u(i).bigHour=!0}),tv("hmm",function(t,e,i){var r=t.length-2;e[3]=Y(t.substr(0,r)),e[4]=Y(t.substr(r)),u(i).bigHour=!0}),tv("hmmss",function(t,e,i){var r=t.length-4,o=t.length-2;e[3]=Y(t.substr(0,r)),e[4]=Y(t.substr(r,2)),e[5]=Y(t.substr(o)),u(i).bigHour=!0}),tv("Hmm",function(t,e,i){var r=t.length-2;e[3]=Y(t.substr(0,r)),e[4]=Y(t.substr(r))}),tv("Hmmss",function(t,e,i){var r=t.length-4,o=t.length-2;e[3]=Y(t.substr(0,r)),e[4]=Y(t.substr(r,2)),e[5]=Y(t.substr(o))});var tV,tU,tz=G("Hours",!0),tY={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:tC,week:{dow:0,doy:6},weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysShort:tN,meridiemParse:/[ap]\.?m?\.?/i},tG={},t$={};function tX(t){return t?t.toLowerCase().replace("_","-"):t}function tq(e){var i=null;if(void 0===tG[e]&&t&&t.exports&&null!=e.match("^[^/\\\\]*$"))try{i=tU._abbr,(void 0)("./locale/"+e),tK(i)}catch(t){tG[e]=null}return tG[e]}function tK(t,e){var i;return t&&((i=n(e)?tQ(t):tZ(t,e))?tU=i:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),tU._abbr}function tZ(t,e){if(null===e)return delete tG[t],null;var i,r=tY;if(e.abbr=t,null!=tG[t])T("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=tG[t]._config;else if(null!=e.parentLocale){if(null!=tG[e.parentLocale])r=tG[e.parentLocale]._config;else{if(null==(i=tq(e.parentLocale)))return t$[e.parentLocale]||(t$[e.parentLocale]=[]),t$[e.parentLocale].push({name:t,config:e}),null;r=i._config}}return tG[t]=new A(k(r,e)),t$[t]&&t$[t].forEach(function(t){tZ(t.name,t.config)}),tK(t),tG[t]}function tQ(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return tU;if(!i(t)){if(e=tq(t))return e;t=[t]}return function(t){for(var e,i,r,o,s=0;s<t.length;){for(e=(o=tX(t[s]).split("-")).length,i=(i=tX(t[s+1]))?i.split("-"):null;e>0;){if(r=tq(o.slice(0,e).join("-")))return r;if(i&&i.length>=e&&function(t,e){var i,r=Math.min(t.length,e.length);for(i=0;i<r;i+=1)if(t[i]!==e[i])return i;return r}(o,i)>=e-1)break;e--}s++}return tU}(t)}function tJ(t){var e,i=t._a;return i&&-2===u(t).overflow&&(e=i[1]<0||i[1]>11?1:i[2]<1||i[2]>tb(i[0],i[1])?2:i[3]<0||i[3]>24||24===i[3]&&(0!==i[4]||0!==i[5]||0!==i[6])?3:i[4]<0||i[4]>59?4:i[5]<0||i[5]>59?5:i[6]<0||i[6]>999?6:-1,u(t)._overflowDayOfYear&&(e<0||e>2)&&(e=2),u(t)._overflowWeeks&&-1===e&&(e=7),u(t)._overflowWeekday&&-1===e&&(e=8),u(t).overflow=e),t}var t0=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,t1=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,t2=/Z|[+-]\d\d(?::?\d\d)?/,t3=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],t6=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],t4=/^\/?Date\((-?\d+)/i,t5=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,t9={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function t8(t){var e,i,r,o,s,n,a=t._i,l=t0.exec(a)||t1.exec(a),h=t3.length,c=t6.length;if(l){for(e=0,u(t).iso=!0,i=h;e<i;e++)if(t3[e][1].exec(l[1])){o=t3[e][0],r=!1!==t3[e][2];break}if(null==o){t._isValid=!1;return}if(l[3]){for(e=0,i=c;e<i;e++)if(t6[e][1].exec(l[3])){s=(l[2]||" ")+t6[e][0];break}if(null==s){t._isValid=!1;return}}if(!r&&null!=s){t._isValid=!1;return}if(l[4]){if(t2.exec(l[4]))n="Z";else{t._isValid=!1;return}}t._f=o+(s||"")+(n||""),ei(t)}else t._isValid=!1}function t7(t){var e,i,r,o,s,n,a,l,h,c=t5.exec(t._i.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(c){if(i=c[4],r=c[3],o=c[2],s=c[5],n=c[6],a=c[7],l=[(e=parseInt(i,10))<=49?2e3+e:e<=999?1900+e:e,tC.indexOf(r),parseInt(o,10),parseInt(s,10),parseInt(n,10)],a&&l.push(parseInt(a,10)),(h=c[1])&&tN.indexOf(h)!==new Date(l[0],l[1],l[2]).getDay()&&(u(t).weekdayMismatch=!0,t._isValid=!1,1))return;t._a=l,t._tzm=function(t,e,i){if(t)return t9[t];if(e)return 0;var r=parseInt(i,10),o=r%100;return(r-o)/100*60+o}(c[8],c[9],c[10]),t._d=tO.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),u(t).rfc2822=!0}else t._isValid=!1}function et(t,e,i){return null!=t?t:null!=e?e:i}function ee(t){var i,r,o,s,n,a,l,h,c,d,g,p,f,m,y,w=[];if(!t._d){for(d=new Date(e.now()),f=t._useUTC?[d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()]:[d.getFullYear(),d.getMonth(),d.getDate()],t._w&&null==t._a[2]&&null==t._a[1]&&(null!=(i=t._w).GG||null!=i.W||null!=i.E?(n=1,a=4,r=et(i.GG,t._a[0],tH(es(),1,4).year),o=et(i.W,1),((s=et(i.E,1))<1||s>7)&&(h=!0)):(n=t._locale._week.dow,a=t._locale._week.doy,c=tH(es(),n,a),r=et(i.gg,t._a[0],c.year),o=et(i.w,c.week),null!=i.d?((s=i.d)<0||s>6)&&(h=!0):null!=i.e?(s=i.e+n,(i.e<0||i.e>6)&&(h=!0)):s=n),o<1||o>tL(r,n,a)?u(t)._overflowWeeks=!0:null!=h?u(t)._overflowWeekday=!0:(l=tI(r,o,s,n,a),t._a[0]=l.year,t._dayOfYear=l.dayOfYear)),null!=t._dayOfYear&&(y=et(t._a[0],f[0]),(t._dayOfYear>tM(y)||0===t._dayOfYear)&&(u(t)._overflowDayOfYear=!0),p=tO(y,0,t._dayOfYear),t._a[1]=p.getUTCMonth(),t._a[2]=p.getUTCDate()),g=0;g<3&&null==t._a[g];++g)t._a[g]=w[g]=f[g];for(;g<7;g++)t._a[g]=w[g]=null==t._a[g]?2===g?1:0:t._a[g];24===t._a[3]&&0===t._a[4]&&0===t._a[5]&&0===t._a[6]&&(t._nextDay=!0,t._a[3]=0),t._d=(t._useUTC?tO:tA).apply(null,w),m=t._useUTC?t._d.getUTCDay():t._d.getDay(),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[3]=24),t._w&&void 0!==t._w.d&&t._w.d!==m&&(u(t).weekdayMismatch=!0)}}function ei(t){if(t._f===e.ISO_8601){t8(t);return}if(t._f===e.RFC_2822){t7(t);return}t._a=[],u(t).empty=!0;var i,r,s,n,a,l,h,c,d,g,p,f=""+t._i,m=f.length,y=0;for(a=0,p=(h=_(t._f,t._locale).match(P)||[]).length;a<p;a++)(c=h[a],(l=(f.match(o(Q,c)?Q[c](t._strict,t._locale):new RegExp(tm(c.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,i,r,o){return e||i||r||o}))))||[])[0])&&((d=f.substr(0,f.indexOf(l))).length>0&&u(t).unusedInput.push(d),f=f.slice(f.indexOf(l)+l.length),y+=l.length),L[c])?(l?u(t).empty=!1:u(t).unusedTokens.push(c),null!=l&&o(ty,c)&&ty[c](l,t._a,t,c)):t._strict&&!l&&u(t).unusedTokens.push(c);u(t).charsLeftOver=m-y,f.length>0&&u(t).unusedInput.push(f),t._a[3]<=12&&!0===u(t).bigHour&&t._a[3]>0&&(u(t).bigHour=void 0),u(t).parsedDateParts=t._a.slice(0),u(t).meridiem=t._meridiem,t._a[3]=(i=t._locale,r=t._a[3],null==(s=t._meridiem)?r:null!=i.meridiemHour?i.meridiemHour(r,s):(null!=i.isPM&&((n=i.isPM(s))&&r<12&&(r+=12),n||12!==r||(r=0)),r)),null!==(g=u(t).era)&&(t._a[0]=t._locale.erasConvertYear(g,t._a[0])),ee(t),tJ(t)}function er(t){var o,s=t._i,d=t._f;return(t._locale=t._locale||tQ(t._l),null===s||void 0===d&&""===s)?p({nullInput:!0}):("string"==typeof s&&(t._i=s=t._locale.preparse(s)),S(s))?new C(tJ(s)):(l(s)?t._d=s:i(d)?function(t){var e,i,r,o,s,n,a=!1,l=t._f.length;if(0===l){u(t).invalidFormat=!0,t._d=new Date(NaN);return}for(o=0;o<l;o++)s=0,n=!1,e=b({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[o],ei(e),g(e)&&(n=!0),s+=u(e).charsLeftOver+10*u(e).unusedTokens.length,u(e).score=s,a?s<r&&(r=s,i=e):(null==r||s<r||n)&&(r=s,i=e,n&&(a=!0));c(t,i||e)}(t):d?ei(t):n(o=t._i)?t._d=new Date(e.now()):l(o)?t._d=new Date(o.valueOf()):"string"==typeof o?function(t){var i=t4.exec(t._i);if(null!==i){t._d=new Date(+i[1]);return}t8(t),!1===t._isValid&&(delete t._isValid,t7(t),!1===t._isValid&&(delete t._isValid,t._strict?t._isValid=!1:e.createFromInputFallback(t)))}(t):i(o)?(t._a=h(o.slice(0),function(t){return parseInt(t,10)}),ee(t)):r(o)?function(t){if(!t._d){var e=W(t._i),i=void 0===e.day?e.date:e.day;t._a=h([e.year,e.month,i,e.hour,e.minute,e.second,e.millisecond],function(t){return t&&parseInt(t,10)}),ee(t)}}(t):a(o)?t._d=new Date(o):e.createFromInputFallback(t),g(t)||(t._d=null),t)}function eo(t,e,o,n,a){var l,h={};return(!0===e||!1===e)&&(n=e,e=void 0),(!0===o||!1===o)&&(n=o,o=void 0),(r(t)&&s(t)||i(t)&&0===t.length)&&(t=void 0),h._isAMomentObject=!0,h._useUTC=h._isUTC=a,h._l=o,h._i=t,h._f=e,h._strict=n,(l=new C(tJ(er(h))))._nextDay&&(l.add(1,"d"),l._nextDay=void 0),l}function es(t,e,i,r){return eo(t,e,i,r,!1)}e.createFromInputFallback=E("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))}),e.ISO_8601=function(){},e.RFC_2822=function(){};var en=E("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=es.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:p()}),ea=E("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=es.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:p()});function el(t,e){var r,o;if(1===e.length&&i(e[0])&&(e=e[0]),!e.length)return es();for(o=1,r=e[0];o<e.length;++o)(!e[o].isValid()||e[o][t](r))&&(r=e[o]);return r}var eh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function ec(t){var e=W(t),i=e.year||0,r=e.quarter||0,s=e.month||0,n=e.week||e.isoWeek||0,a=e.day||0,l=e.hour||0,h=e.minute||0,c=e.second||0,d=e.millisecond||0;this._isValid=function(t){var e,i,r=!1,s=eh.length;for(e in t)if(o(t,e)&&!(-1!==tV.call(eh,e)&&(null==t[e]||!isNaN(t[e]))))return!1;for(i=0;i<s;++i)if(t[eh[i]]){if(r)return!1;parseFloat(t[eh[i]])!==Y(t[eh[i]])&&(r=!0)}return!0}(e),this._milliseconds=+d+1e3*c+6e4*h+36e5*l,this._days=+a+7*n,this._months=+s+3*r+12*i,this._data={},this._locale=tQ(),this._bubble()}function ed(t){return t instanceof ec}function eu(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function eg(t,e){D(t,0,0,function(){var t=this.utcOffset(),i="+";return t<0&&(t=-t,i="-"),i+O(~~(t/60),2)+e+O(~~t%60,2)})}eg("Z",":"),eg("ZZ",""),tf("Z",tg),tf("ZZ",tg),tv(["Z","ZZ"],function(t,e,i){i._useUTC=!0,i._tzm=ef(tg,t)});var ep=/([\+\-]|\d\d)/gi;function ef(t,e){var i,r,o=(e||"").match(t);return null===o?null:0===(r=+(60*(i=((o[o.length-1]||[])+"").match(ep)||["-",0,0])[1])+Y(i[2]))?0:"+"===i[0]?r:-r}function em(t,i){var r,o;return i._isUTC?(r=i.clone(),o=(S(t)||l(t)?t.valueOf():es(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+o),e.updateOffset(r,!1),r):es(t).local()}function ey(t){return-Math.round(t._d.getTimezoneOffset())}function ev(){return!!this.isValid()&&this._isUTC&&0===this._offset}e.updateOffset=function(){};var ew=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,eb=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function eC(t,e){var i,r,s,n,l,h,c=t,d=null;return ed(t)?c={ms:t._milliseconds,d:t._days,M:t._months}:a(t)||!isNaN(+t)?(c={},e?c[e]=+t:c.milliseconds=+t):(d=ew.exec(t))?(n="-"===d[1]?-1:1,c={y:0,d:Y(d[2])*n,h:Y(d[3])*n,m:Y(d[4])*n,s:Y(d[5])*n,ms:Y(eu(1e3*d[6]))*n}):(d=eb.exec(t))?(n="-"===d[1]?-1:1,c={y:eS(d[2],n),M:eS(d[3],n),w:eS(d[4],n),d:eS(d[5],n),h:eS(d[6],n),m:eS(d[7],n),s:eS(d[8],n)}):null==c?c={}:"object"==typeof c&&("from"in c||"to"in c)&&(i=es(c.from),r=es(c.to),h=i.isValid()&&r.isValid()?(r=em(r,i),i.isBefore(r)?s=ex(i,r):((s=ex(r,i)).milliseconds=-s.milliseconds,s.months=-s.months),s):{milliseconds:0,months:0},(c={}).ms=h.milliseconds,c.M=h.months),l=new ec(c),ed(t)&&o(t,"_locale")&&(l._locale=t._locale),ed(t)&&o(t,"_isValid")&&(l._isValid=t._isValid),l}function eS(t,e){var i=t&&parseFloat(t.replace(",","."));return(isNaN(i)?0:i)*e}function ex(t,e){var i={};return i.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(i.months,"M").isAfter(e)&&--i.months,i.milliseconds=+e-+t.clone().add(i.months,"M"),i}function eE(t,e){return function(i,r){var o;return null===r||isNaN(+r)||(T(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=i,i=r,r=o),eR(this,eC(i,r),t),this}}function eR(t,i,r,o){var s=i._milliseconds,n=eu(i._days),a=eu(i._months);t.isValid()&&(o=null==o||o,a&&tE(t,$(t,"Month")+a*r),n&&X(t,"Date",$(t,"Date")+n*r),s&&t._d.setTime(t._d.valueOf()+s*r),o&&e.updateOffset(t,n||a))}eC.fn=ec.prototype,eC.invalid=function(){return eC(NaN)};var eT=eE(1,"add"),eM=eE(-1,"subtract");function ek(t){return"string"==typeof t||t instanceof String}function eA(t,e){if(t.date()<e.date())return-eA(e,t);var i,r=(e.year()-t.year())*12+(e.month()-t.month()),o=t.clone().add(r,"months");return i=e-o<0?(e-o)/(o-t.clone().add(r-1,"months")):(e-o)/(t.clone().add(r+1,"months")-o),-(r+i)||0}function eO(t){var e;return void 0===t?this._locale._abbr:(null!=(e=tQ(t))&&(this._locale=e),this)}e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",e.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var eP=E("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return void 0===t?this.localeData():this.locale(t)});function eI(){return this._locale}function eH(t,e,i){return t<100&&t>=0?new Date(t+400,e,i)-126227808e5:new Date(t,e,i).valueOf()}function eL(t,e,i){return t<100&&t>=0?Date.UTC(t+400,e,i)-126227808e5:Date.UTC(t,e,i)}function eD(t,e){return e.erasAbbrRegex(t)}function eN(){var t,e,i=[],r=[],o=[],s=[],n=this.eras();for(t=0,e=n.length;t<e;++t)r.push(tm(n[t].name)),i.push(tm(n[t].abbr)),o.push(tm(n[t].narrow)),s.push(tm(n[t].name)),s.push(tm(n[t].abbr)),s.push(tm(n[t].narrow));this._erasRegex=RegExp("^("+s.join("|")+")","i"),this._erasNameRegex=RegExp("^("+r.join("|")+")","i"),this._erasAbbrRegex=RegExp("^("+i.join("|")+")","i"),this._erasNarrowRegex=RegExp("^("+o.join("|")+")","i")}function e_(t,e){D(0,[t,t.length],0,e)}function eF(t,e,i,r,o){var s;return null==t?tH(this,r,o).year:(e>(s=tL(t,r,o))&&(e=s),ej.call(this,t,e,i,r,o))}function ej(t,e,i,r,o){var s=tI(t,e,i,r,o),n=tO(s.year,0,s.dayOfYear);return this.year(n.getUTCFullYear()),this.month(n.getUTCMonth()),this.date(n.getUTCDate()),this}D("N",0,0,"eraAbbr"),D("NN",0,0,"eraAbbr"),D("NNN",0,0,"eraAbbr"),D("NNNN",0,0,"eraName"),D("NNNNN",0,0,"eraNarrow"),D("y",["y",1],"yo","eraYear"),D("y",["yy",2],0,"eraYear"),D("y",["yyy",3],0,"eraYear"),D("y",["yyyy",4],0,"eraYear"),tf("N",eD),tf("NN",eD),tf("NNN",eD),tf("NNNN",function(t,e){return e.erasNameRegex(t)}),tf("NNNNN",function(t,e){return e.erasNarrowRegex(t)}),tv(["N","NN","NNN","NNNN","NNNNN"],function(t,e,i,r){var o=i._locale.erasParse(t,r,i._strict);o?u(i).era=o:u(i).invalidEra=t}),tf("y",tc),tf("yy",tc),tf("yyy",tc),tf("yyyy",tc),tf("yo",function(t,e){return e._eraYearOrdinalRegex||tc}),tv(["y","yy","yyy","yyyy"],0),tv(["yo"],function(t,e,i,r){var o;i._locale._eraYearOrdinalRegex&&(o=t.match(i._locale._eraYearOrdinalRegex)),i._locale.eraYearOrdinalParse?e[0]=i._locale.eraYearOrdinalParse(t,o):e[0]=parseInt(t,10)}),D(0,["gg",2],0,function(){return this.weekYear()%100}),D(0,["GG",2],0,function(){return this.isoWeekYear()%100}),e_("gggg","weekYear"),e_("ggggg","weekYear"),e_("GGGG","isoWeekYear"),e_("GGGGG","isoWeekYear"),j("weekYear","gg"),j("isoWeekYear","GG"),V.weekYear=1,V.isoWeekYear=1,tf("G",td),tf("g",td),tf("GG",to,tt),tf("gg",to,tt),tf("GGGG",tl,ti),tf("gggg",tl,ti),tf("GGGGG",th,tr),tf("ggggg",th,tr),tw(["gggg","ggggg","GGGG","GGGGG"],function(t,e,i,r){e[r.substr(0,2)]=Y(t)}),tw(["gg","GG"],function(t,i,r,o){i[o]=e.parseTwoDigitYear(t)}),D("Q",0,"Qo","quarter"),j("quarter","Q"),V.quarter=7,tf("Q",J),tv("Q",function(t,e){e[1]=(Y(t)-1)*3}),D("D",["DD",2],"Do","date"),j("date","D"),V.date=9,tf("D",to),tf("DD",to,tt),tf("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient}),tv(["D","DD"],2),tv("Do",function(t,e){e[2]=Y(t.match(to)[0])});var eB=G("Date",!0);D("DDD",["DDDD",3],"DDDo","dayOfYear"),j("dayOfYear","DDD"),V.dayOfYear=4,tf("DDD",ta),tf("DDDD",te),tv(["DDD","DDDD"],function(t,e,i){i._dayOfYear=Y(t)}),D("m",["mm",2],0,"minute"),j("minute","m"),V.minute=14,tf("m",to),tf("mm",to,tt),tv(["m","mm"],4);var eW=G("Minutes",!1);D("s",["ss",2],0,"second"),j("second","s"),V.second=15,tf("s",to),tf("ss",to,tt),tv(["s","ss"],5);var eV=G("Seconds",!1);for(D("S",0,0,function(){return~~(this.millisecond()/100)}),D(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),D(0,["SSS",3],0,"millisecond"),D(0,["SSSS",4],0,function(){return 10*this.millisecond()}),D(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),D(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),D(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),D(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),D(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),j("millisecond","ms"),V.millisecond=16,tf("S",ta,J),tf("SS",ta,tt),tf("SSS",ta,te),f="SSSS";f.length<=9;f+="S")tf(f,tc);function eU(t,e){e[6]=Y(("0."+t)*1e3)}for(f="S";f.length<=9;f+="S")tv(f,eU);m=G("Milliseconds",!1),D("z",0,0,"zoneAbbr"),D("zz",0,0,"zoneName");var ez=C.prototype;function eY(t){return t}ez.add=eT,ez.calendar=function(t,n){if(1==arguments.length){if(arguments[0]){var h,c,d;(h=arguments[0],S(h)||l(h)||ek(h)||a(h)||(c=i(h),d=!1,c&&(d=0===h.filter(function(t){return!a(t)&&ek(h)}).length),c&&d)||function(t){var e,i,n=r(t)&&!s(t),a=!1,l=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],h=l.length;for(e=0;e<h;e+=1)i=l[e],a=a||o(t,i);return n&&a}(h)||null==h)?(t=arguments[0],n=void 0):function(t){var e,i,n=r(t)&&!s(t),a=!1,l=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(e=0;e<l.length;e+=1)i=l[e],a=a||o(t,i);return n&&a}(arguments[0])&&(n=arguments[0],t=void 0)}else t=void 0,n=void 0}var u=t||es(),g=em(u,this).startOf("day"),p=e.calendarFormat(this,g)||"sameElse",f=n&&(M(n[p])?n[p].call(this,u):n[p]);return this.format(f||this.localeData().calendar(p,this,es(u)))},ez.clone=function(){return new C(this)},ez.diff=function(t,e,i){var r,o,s;if(!this.isValid()||!(r=em(t,this)).isValid())return NaN;switch(o=(r.utcOffset()-this.utcOffset())*6e4,e=B(e)){case"year":s=eA(this,r)/12;break;case"month":s=eA(this,r);break;case"quarter":s=eA(this,r)/3;break;case"second":s=(this-r)/1e3;break;case"minute":s=(this-r)/6e4;break;case"hour":s=(this-r)/36e5;break;case"day":s=(this-r-o)/864e5;break;case"week":s=(this-r-o)/6048e5;break;default:s=this-r}return i?s:z(s)},ez.endOf=function(t){var i,r;if(void 0===(t=B(t))||"millisecond"===t||!this.isValid())return this;switch(r=this._isUTC?eL:eH,t){case"year":i=r(this.year()+1,0,1)-1;break;case"quarter":i=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":i=r(this.year(),this.month()+1,1)-1;break;case"week":i=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":i=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":i=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":i=this._d.valueOf(),i+=36e5-((i+(this._isUTC?0:6e4*this.utcOffset()))%36e5+36e5)%36e5-1;break;case"minute":i=this._d.valueOf(),i+=6e4-(i%6e4+6e4)%6e4-1;break;case"second":i=this._d.valueOf(),i+=1e3-(i%1e3+1e3)%1e3-1}return this._d.setTime(i),e.updateOffset(this,!0),this},ez.format=function(t){t||(t=this.isUtc()?e.defaultFormatUtc:e.defaultFormat);var i=N(this,t);return this.localeData().postformat(i)},ez.from=function(t,e){return this.isValid()&&(S(t)&&t.isValid()||es(t).isValid())?eC({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},ez.fromNow=function(t){return this.from(es(),t)},ez.to=function(t,e){return this.isValid()&&(S(t)&&t.isValid()||es(t).isValid())?eC({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},ez.toNow=function(t){return this.to(es(),t)},ez.get=function(t){return M(this[t=B(t)])?this[t]():this},ez.invalidAt=function(){return u(this).overflow},ez.isAfter=function(t,e){var i=S(t)?t:es(t);return!!(this.isValid()&&i.isValid())&&("millisecond"===(e=B(e)||"millisecond")?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(e).valueOf())},ez.isBefore=function(t,e){var i=S(t)?t:es(t);return!!(this.isValid()&&i.isValid())&&("millisecond"===(e=B(e)||"millisecond")?this.valueOf()<i.valueOf():this.clone().endOf(e).valueOf()<i.valueOf())},ez.isBetween=function(t,e,i,r){var o=S(t)?t:es(t),s=S(e)?e:es(e);return!!(this.isValid()&&o.isValid()&&s.isValid())&&("("===(r=r||"()")[0]?this.isAfter(o,i):!this.isBefore(o,i))&&(")"===r[1]?this.isBefore(s,i):!this.isAfter(s,i))},ez.isSame=function(t,e){var i,r=S(t)?t:es(t);return!!(this.isValid()&&r.isValid())&&("millisecond"===(e=B(e)||"millisecond")?this.valueOf()===r.valueOf():(i=r.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf()))},ez.isSameOrAfter=function(t,e){return this.isSame(t,e)||this.isAfter(t,e)},ez.isSameOrBefore=function(t,e){return this.isSame(t,e)||this.isBefore(t,e)},ez.isValid=function(){return g(this)},ez.lang=eP,ez.locale=eO,ez.localeData=eI,ez.max=ea,ez.min=en,ez.parsingFlags=function(){return c({},u(this))},ez.set=function(t,e){if("object"==typeof t){var i,r=function(t){var e,i=[];for(e in t)o(t,e)&&i.push({unit:e,priority:V[e]});return i.sort(function(t,e){return t.priority-e.priority}),i}(t=W(t)),s=r.length;for(i=0;i<s;i++)this[r[i].unit](t[r[i].unit])}else if(M(this[t=B(t)]))return this[t](e);return this},ez.startOf=function(t){var i,r;if(void 0===(t=B(t))||"millisecond"===t||!this.isValid())return this;switch(r=this._isUTC?eL:eH,t){case"year":i=r(this.year(),0,1);break;case"quarter":i=r(this.year(),this.month()-this.month()%3,1);break;case"month":i=r(this.year(),this.month(),1);break;case"week":i=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":i=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":i=r(this.year(),this.month(),this.date());break;case"hour":i=this._d.valueOf(),i-=((i+(this._isUTC?0:6e4*this.utcOffset()))%36e5+36e5)%36e5;break;case"minute":i=this._d.valueOf(),i-=(i%6e4+6e4)%6e4;break;case"second":i=this._d.valueOf(),i-=(i%1e3+1e3)%1e3}return this._d.setTime(i),e.updateOffset(this,!0),this},ez.subtract=eM,ez.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]},ez.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}},ez.toDate=function(){return new Date(this.valueOf())},ez.toISOString=function(t){if(!this.isValid())return null;var e=!0!==t,i=e?this.clone().utc():this;return 0>i.year()||i.year()>9999?N(i,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):M(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+6e4*this.utcOffset()).toISOString().replace("Z",N(i,"Z")):N(i,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},ez.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t,e,i,r,o="moment",s="";return this.isLocal()||(o=0===this.utcOffset()?"moment.utc":"moment.parseZone",s="Z"),t="["+o+'("]',e=0<=this.year()&&9999>=this.year()?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",r=s+'[")]',this.format(t+e+i+r)},"undefined"!=typeof Symbol&&null!=Symbol.for&&(ez[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),ez.toJSON=function(){return this.isValid()?this.toISOString():null},ez.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},ez.unix=function(){return Math.floor(this.valueOf()/1e3)},ez.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},ez.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},ez.eraName=function(){var t,e,i,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(i=this.clone().startOf("day").valueOf(),r[t].since<=i&&i<=r[t].until||r[t].until<=i&&i<=r[t].since)return r[t].name;return""},ez.eraNarrow=function(){var t,e,i,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(i=this.clone().startOf("day").valueOf(),r[t].since<=i&&i<=r[t].until||r[t].until<=i&&i<=r[t].since)return r[t].narrow;return""},ez.eraAbbr=function(){var t,e,i,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(i=this.clone().startOf("day").valueOf(),r[t].since<=i&&i<=r[t].until||r[t].until<=i&&i<=r[t].since)return r[t].abbr;return""},ez.eraYear=function(){var t,i,r,o,s=this.localeData().eras();for(t=0,i=s.length;t<i;++t)if(r=s[t].since<=s[t].until?1:-1,o=this.clone().startOf("day").valueOf(),s[t].since<=o&&o<=s[t].until||s[t].until<=o&&o<=s[t].since)return(this.year()-e(s[t].since).year())*r+s[t].offset;return this.year()},ez.year=tk,ez.isLeapYear=function(){return U(this.year())},ez.weekYear=function(t){return eF.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},ez.isoWeekYear=function(t){return eF.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)},ez.quarter=ez.quarters=function(t){return null==t?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)},ez.month=tR,ez.daysInMonth=function(){return tb(this.year(),this.month())},ez.week=ez.weeks=function(t){var e=this.localeData().week(this);return null==t?e:this.add((t-e)*7,"d")},ez.isoWeek=ez.isoWeeks=function(t){var e=tH(this,1,4).week;return null==t?e:this.add((t-e)*7,"d")},ez.weeksInYear=function(){var t=this.localeData()._week;return tL(this.year(),t.dow,t.doy)},ez.weeksInWeekYear=function(){var t=this.localeData()._week;return tL(this.weekYear(),t.dow,t.doy)},ez.isoWeeksInYear=function(){return tL(this.year(),1,4)},ez.isoWeeksInISOWeekYear=function(){return tL(this.isoWeekYear(),1,4)},ez.date=eB,ez.day=ez.days=function(t){if(!this.isValid())return null!=t?this:NaN;var e,i,r=this._isUTC?this._d.getUTCDay():this._d.getDay();return null==t?r:(e=t,i=this.localeData(),t="string"!=typeof e?e:isNaN(e)?"number"==typeof(e=i.weekdaysParse(e))?e:null:parseInt(e,10),this.add(t-r,"d"))},ez.weekday=function(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},ez.isoWeekday=function(t){if(!this.isValid())return null!=t?this:NaN;if(null==t)return this.day()||7;var e,i=(e=this.localeData(),"string"==typeof t?e.weekdaysParse(t)%7||7:isNaN(t)?null:t);return this.day(this.day()%7?i:i-7)},ez.dayOfYear=function(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},ez.hour=ez.hours=tz,ez.minute=ez.minutes=eW,ez.second=ez.seconds=eV,ez.millisecond=ez.milliseconds=m,ez.utcOffset=function(t,i,r){var o,s=this._offset||0;if(!this.isValid())return null!=t?this:NaN;if(null==t)return this._isUTC?s:ey(this);if("string"==typeof t){if(null===(t=ef(tg,t)))return this}else 16>Math.abs(t)&&!r&&(t*=60);return!this._isUTC&&i&&(o=ey(this)),this._offset=t,this._isUTC=!0,null!=o&&this.add(o,"m"),s===t||(!i||this._changeInProgress?eR(this,eC(t-s,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this},ez.utc=function(t){return this.utcOffset(0,t)},ez.local=function(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(ey(this),"m")),this},ez.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var t=ef(tu,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this},ez.hasAlignedHourOffset=function(t){return!!this.isValid()&&(t=t?es(t).utcOffset():0,(this.utcOffset()-t)%60==0)},ez.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},ez.isLocal=function(){return!!this.isValid()&&!this._isUTC},ez.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},ez.isUtc=ev,ez.isUTC=ev,ez.zoneAbbr=function(){return this._isUTC?"UTC":""},ez.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},ez.dates=E("dates accessor is deprecated. Use date instead.",eB),ez.months=E("months accessor is deprecated. Use month instead",tR),ez.years=E("years accessor is deprecated. Use year instead",tk),ez.zone=E("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}),ez.isDSTShifted=E("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!n(this._isDSTShifted))return this._isDSTShifted;var t,e={};return b(e,this),(e=er(e))._a?(t=e._isUTC?d(e._a):es(e._a),this._isDSTShifted=this.isValid()&&function(t,e,i){var r,o=Math.min(t.length,e.length),s=Math.abs(t.length-e.length),n=0;for(r=0;r<o;r++)Y(t[r])!==Y(e[r])&&n++;return n+s}(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted});var eG=A.prototype;function e$(t,e,i,r){var o=tQ(),s=d().set(r,e);return o[i](s,t)}function eX(t,e,i){if(a(t)&&(e=t,t=void 0),t=t||"",null!=e)return e$(t,e,i,"month");var r,o=[];for(r=0;r<12;r++)o[r]=e$(t,r,i,"month");return o}function eq(t,e,i,r){"boolean"==typeof t||(i=e=t,t=!1),a(e)&&(i=e,e=void 0),e=e||"";var o,s=tQ(),n=t?s._week.dow:0,l=[];if(null!=i)return e$(e,(i+n)%7,r,"day");for(o=0;o<7;o++)l[o]=e$(e,(o+n)%7,r,"day");return l}eG.calendar=function(t,e,i){var r=this._calendar[t]||this._calendar.sameElse;return M(r)?r.call(e,i):r},eG.longDateFormat=function(t){var e=this._longDateFormat[t],i=this._longDateFormat[t.toUpperCase()];return e||!i?e:(this._longDateFormat[t]=i.match(P).map(function(t){return"MMMM"===t||"MM"===t||"DD"===t||"dddd"===t?t.slice(1):t}).join(""),this._longDateFormat[t])},eG.invalidDate=function(){return this._invalidDate},eG.ordinal=function(t){return this._ordinal.replace("%d",t)},eG.preparse=eY,eG.postformat=eY,eG.relativeTime=function(t,e,i,r){var o=this._relativeTime[i];return M(o)?o(t,e,i,r):o.replace(/%d/i,t)},eG.pastFuture=function(t,e){var i=this._relativeTime[t>0?"future":"past"];return M(i)?i(e):i.replace(/%s/i,e)},eG.set=function(t){var e,i;for(i in t)o(t,i)&&(M(e=t[i])?this[i]=e:this["_"+i]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},eG.eras=function(t,i){var r,o,s,n=this._eras||tQ("en")._eras;for(r=0,o=n.length;r<o;++r)switch("string"==typeof n[r].since&&(s=e(n[r].since).startOf("day"),n[r].since=s.valueOf()),typeof n[r].until){case"undefined":n[r].until=1/0;break;case"string":s=e(n[r].until).startOf("day").valueOf(),n[r].until=s.valueOf()}return n},eG.erasParse=function(t,e,i){var r,o,s,n,a,l=this.eras();for(r=0,t=t.toUpperCase(),o=l.length;r<o;++r)if(s=l[r].name.toUpperCase(),n=l[r].abbr.toUpperCase(),a=l[r].narrow.toUpperCase(),i)switch(e){case"N":case"NN":case"NNN":if(n===t)return l[r];break;case"NNNN":if(s===t)return l[r];break;case"NNNNN":if(a===t)return l[r]}else if([s,n,a].indexOf(t)>=0)return l[r]},eG.erasConvertYear=function(t,i){var r=t.since<=t.until?1:-1;return void 0===i?e(t.since).year():e(t.since).year()+(i-t.offset)*r},eG.erasAbbrRegex=function(t){return o(this,"_erasAbbrRegex")||eN.call(this),t?this._erasAbbrRegex:this._erasRegex},eG.erasNameRegex=function(t){return o(this,"_erasNameRegex")||eN.call(this),t?this._erasNameRegex:this._erasRegex},eG.erasNarrowRegex=function(t){return o(this,"_erasNarrowRegex")||eN.call(this),t?this._erasNarrowRegex:this._erasRegex},eG.months=function(t,e){return t?i(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||tS).test(e)?"format":"standalone"][t.month()]:i(this._months)?this._months:this._months.standalone},eG.monthsShort=function(t,e){return t?i(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[tS.test(e)?"format":"standalone"][t.month()]:i(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},eG.monthsParse=function(t,e,i){var r,o,s;if(this._monthsParseExact)return tx.call(this,t,e,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++)if(o=d([2e3,r]),i&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),i||this._monthsParse[r]||(s="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[r]=RegExp(s.replace(".",""),"i")),i&&"MMMM"===e&&this._longMonthsParse[r].test(t)||i&&"MMM"===e&&this._shortMonthsParse[r].test(t)||!i&&this._monthsParse[r].test(t))return r},eG.monthsRegex=function(t){return this._monthsParseExact?(o(this,"_monthsRegex")||tT.call(this),t)?this._monthsStrictRegex:this._monthsRegex:(o(this,"_monthsRegex")||(this._monthsRegex=tp),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)},eG.monthsShortRegex=function(t){return this._monthsParseExact?(o(this,"_monthsRegex")||tT.call(this),t)?this._monthsShortStrictRegex:this._monthsShortRegex:(o(this,"_monthsShortRegex")||(this._monthsShortRegex=tp),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)},eG.week=function(t){return tH(t,this._week.dow,this._week.doy).week},eG.firstDayOfYear=function(){return this._week.doy},eG.firstDayOfWeek=function(){return this._week.dow},eG.weekdays=function(t,e){var r=i(this._weekdays)?this._weekdays:this._weekdays[t&&!0!==t&&this._weekdays.isFormat.test(e)?"format":"standalone"];return!0===t?tD(r,this._week.dow):t?r[t.day()]:r},eG.weekdaysMin=function(t){return!0===t?tD(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin},eG.weekdaysShort=function(t){return!0===t?tD(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort},eG.weekdaysParse=function(t,e,i){var r,o,s;if(this._weekdaysParseExact)return t_.call(this,t,e,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(o=d([2e3,1]).day(r),i&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(s="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[r]=RegExp(s.replace(".",""),"i")),i&&"dddd"===e&&this._fullWeekdaysParse[r].test(t)||i&&"ddd"===e&&this._shortWeekdaysParse[r].test(t))return r;if(i&&"dd"===e&&this._minWeekdaysParse[r].test(t))return r;if(!i&&this._weekdaysParse[r].test(t))return r}},eG.weekdaysRegex=function(t){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||tF.call(this),t)?this._weekdaysStrictRegex:this._weekdaysRegex:(o(this,"_weekdaysRegex")||(this._weekdaysRegex=tp),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)},eG.weekdaysShortRegex=function(t){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||tF.call(this),t)?this._weekdaysShortStrictRegex:this._weekdaysShortRegex:(o(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=tp),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},eG.weekdaysMinRegex=function(t){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||tF.call(this),t)?this._weekdaysMinStrictRegex:this._weekdaysMinRegex:(o(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=tp),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},eG.isPM=function(t){return"p"===(t+"").toLowerCase().charAt(0)},eG.meridiem=function(t,e,i){return t>11?i?"pm":"PM":i?"am":"AM"},tK("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,i=1===Y(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th";return t+i}}),e.lang=E("moment.lang is deprecated. Use moment.locale instead.",tK),e.langData=E("moment.langData is deprecated. Use moment.localeData instead.",tQ);var eK=Math.abs;function eZ(t,e,i,r){var o=eC(e,i);return t._milliseconds+=r*o._milliseconds,t._days+=r*o._days,t._months+=r*o._months,t._bubble()}function eQ(t){return t<0?Math.floor(t):Math.ceil(t)}function eJ(t){return 4800*t/146097}function e0(t){return 146097*t/4800}function e1(t){return function(){return this.as(t)}}var e2=e1("ms"),e3=e1("s"),e6=e1("m"),e4=e1("h"),e5=e1("d"),e9=e1("w"),e8=e1("M"),e7=e1("Q"),it=e1("y");function ie(t){return function(){return this.isValid()?this._data[t]:NaN}}var ii=ie("milliseconds"),ir=ie("seconds"),io=ie("minutes"),is=ie("hours"),ia=ie("days"),il=ie("months"),ih=ie("years"),ic=Math.round,id={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function iu(t,e,i,r,o){return o.relativeTime(e||1,!!i,t,r)}var ig=Math.abs;function ip(t){return(t>0)-(t<0)||+t}function im(){if(!this.isValid())return this.localeData().invalidDate();var t,e,i,r,o,s,n,a,l=ig(this._milliseconds)/1e3,h=ig(this._days),c=ig(this._months),d=this.asSeconds();return d?(t=z(l/60),e=z(t/60),l%=60,t%=60,i=z(c/12),c%=12,r=l?l.toFixed(3).replace(/\.?0+$/,""):"",o=d<0?"-":"",s=ip(this._months)!==ip(d)?"-":"",n=ip(this._days)!==ip(d)?"-":"",a=ip(this._milliseconds)!==ip(d)?"-":"",o+"P"+(i?s+i+"Y":"")+(c?s+c+"M":"")+(h?n+h+"D":"")+(e||t||l?"T":"")+(e?a+e+"H":"")+(t?a+t+"M":"")+(l?a+r+"S":"")):"P0D"}var iy=ec.prototype;return iy.isValid=function(){return this._isValid},iy.abs=function(){var t=this._data;return this._milliseconds=eK(this._milliseconds),this._days=eK(this._days),this._months=eK(this._months),t.milliseconds=eK(t.milliseconds),t.seconds=eK(t.seconds),t.minutes=eK(t.minutes),t.hours=eK(t.hours),t.months=eK(t.months),t.years=eK(t.years),this},iy.add=function(t,e){return eZ(this,t,e,1)},iy.subtract=function(t,e){return eZ(this,t,e,-1)},iy.as=function(t){if(!this.isValid())return NaN;var e,i,r=this._milliseconds;if("month"===(t=B(t))||"quarter"===t||"year"===t)switch(e=this._days+r/864e5,i=this._months+eJ(e),t){case"month":return i;case"quarter":return i/3;case"year":return i/12}else switch(e=this._days+Math.round(e0(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return 24*e+r/36e5;case"minute":return 1440*e+r/6e4;case"second":return 86400*e+r/1e3;case"millisecond":return Math.floor(864e5*e)+r;default:throw Error("Unknown unit "+t)}},iy.asMilliseconds=e2,iy.asSeconds=e3,iy.asMinutes=e6,iy.asHours=e4,iy.asDays=e5,iy.asWeeks=e9,iy.asMonths=e8,iy.asQuarters=e7,iy.asYears=it,iy.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*Y(this._months/12):NaN},iy._bubble=function(){var t,e,i,r,o,s=this._milliseconds,n=this._days,a=this._months,l=this._data;return s>=0&&n>=0&&a>=0||s<=0&&n<=0&&a<=0||(s+=864e5*eQ(e0(a)+n),n=0,a=0),l.milliseconds=s%1e3,t=z(s/1e3),l.seconds=t%60,e=z(t/60),l.minutes=e%60,i=z(e/60),l.hours=i%24,n+=z(i/24),a+=o=z(eJ(n)),n-=eQ(e0(o)),r=z(a/12),a%=12,l.days=n,l.months=a,l.years=r,this},iy.clone=function(){return eC(this)},iy.get=function(t){return t=B(t),this.isValid()?this[t+"s"]():NaN},iy.milliseconds=ii,iy.seconds=ir,iy.minutes=io,iy.hours=is,iy.days=ia,iy.weeks=function(){return z(this.days()/7)},iy.months=il,iy.years=ih,iy.humanize=function(t,e){if(!this.isValid())return this.localeData().invalidDate();var i,r,o,s,n,a,l,h,c,d,u,g,p,f=!1,m=id;return"object"==typeof t&&(e=t,t=!1),"boolean"==typeof t&&(f=t),"object"==typeof e&&(m=Object.assign({},id,e),null!=e.s&&null==e.ss&&(m.ss=e.s-1)),g=this.localeData(),i=!f,r=m,o=eC(this).abs(),s=ic(o.as("s")),n=ic(o.as("m")),a=ic(o.as("h")),l=ic(o.as("d")),h=ic(o.as("M")),c=ic(o.as("w")),d=ic(o.as("y")),u=s<=r.ss&&["s",s]||s<r.s&&["ss",s]||n<=1&&["m"]||n<r.m&&["mm",n]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l],null!=r.w&&(u=u||c<=1&&["w"]||c<r.w&&["ww",c]),(u=u||h<=1&&["M"]||h<r.M&&["MM",h]||d<=1&&["y"]||["yy",d])[2]=i,u[3]=+this>0,u[4]=g,p=iu.apply(null,u),f&&(p=g.pastFuture(+this,p)),g.postformat(p)},iy.toISOString=im,iy.toString=im,iy.toJSON=im,iy.locale=eO,iy.localeData=eI,iy.toIsoString=E("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",im),iy.lang=eP,D("X",0,0,"unix"),D("x",0,0,"valueOf"),tf("x",td),tf("X",/[+-]?\d+(\.\d{1,3})?/),tv("X",function(t,e,i){i._d=new Date(1e3*parseFloat(t))}),tv("x",function(t,e,i){i._d=new Date(Y(t))}),e.version="2.29.4",q=es,e.fn=ez,e.min=function(){var t=[].slice.call(arguments,0);return el("isBefore",t)},e.max=function(){var t=[].slice.call(arguments,0);return el("isAfter",t)},e.now=function(){return Date.now?Date.now():+new Date},e.utc=d,e.unix=function(t){return es(1e3*t)},e.months=function(t,e){return eX(t,e,"months")},e.isDate=l,e.locale=tK,e.invalid=p,e.duration=eC,e.isMoment=S,e.weekdays=function(t,e,i){return eq(t,e,i,"weekdays")},e.parseZone=function(){return es.apply(null,arguments).parseZone()},e.localeData=tQ,e.isDuration=ed,e.monthsShort=function(t,e){return eX(t,e,"monthsShort")},e.weekdaysMin=function(t,e,i){return eq(t,e,i,"weekdaysMin")},e.defineLocale=tZ,e.updateLocale=function(t,e){if(null!=e){var i,r,o=tY;null!=tG[t]&&null!=tG[t].parentLocale?tG[t].set(k(tG[t]._config,e)):(null!=(r=tq(t))&&(o=r._config),e=k(o,e),null==r&&(e.abbr=t),(i=new A(e)).parentLocale=tG[t],tG[t]=i),tK(t)}else null!=tG[t]&&(null!=tG[t].parentLocale?(tG[t]=tG[t].parentLocale,t===tK()&&tK(t)):null!=tG[t]&&delete tG[t]);return tG[t]},e.locales=function(){return Z(tG)},e.weekdaysShort=function(t,e,i){return eq(t,e,i,"weekdaysShort")},e.normalizeUnits=B,e.relativeTimeRounding=function(t){return void 0===t?ic:"function"==typeof t&&(ic=t,!0)},e.relativeTimeThreshold=function(t,e){return void 0!==id[t]&&(void 0===e?id[t]:(id[t]=e,"s"===t&&(id.ss=e-1),!0))},e.calendarFormat=function(t,e){var i=t.diff(e,"days",!0);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"},e.prototype=ez,e.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},e},t.exports=i()}),ta("bTWiY",function(t,e){s(t.exports,"dateValidator",()=>l);var i=tn("45fvw"),r=tn("jxqWV"),n=tn("iMgTM"),a=tn("7cVHX");function l(t,e){let s=(0,r.getEditorInstance)(n.EDITOR_TYPE,this.instance),l=t,h=!0;null==l&&(l="");let c=o(i)(l,this.dateFormat||s.defaultDateFormat,!0).isValid(),d=o(i)(new Date(l)).isValid()||c;if(this.allowEmpty&&""===l&&(d=!0,c=!0),d||(h=!1),!d&&c&&(h=!0),d&&!c){if(!0===this.correctFormat){let t=function(t,e){let r=o(i)((0,a.getNormalizedDate)(t)),s=o(i)(t,e),n=t.search(/[A-z]/g)>-1;return(r.isValid()&&r.format("x")===s.format("x")||!s.isValid()||n?r:s).format(e)}(l,this.dateFormat),e=this.instance.toVisualRow(this.row),r=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(e,r,t,"dateValidator"),h=!0}else h=!1}e(h)}l.VALIDATOR_TYPE="date"}),ta("jxqWV",function(t,e){s(t.exports,"hasEditor",()=>l),s(t.exports,"getRegisteredEditorNames",()=>h),s(t.exports,"registerEditor",()=>p),s(t.exports,"getEditor",()=>g),s(t.exports,"getEditorInstance",()=>u),tn("1C6fS");var i=tn("10euP"),r=tn("lSZ9A");let o=new WeakMap,{register:n,getItem:a,hasItem:l,getNames:h,getValues:c}=(0,r.default)("editors");function d(t){let e={};this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new t(i)),e[i.guid]},(0,i.default).getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function u(t,e){let i;if("function"==typeof t)o.get(t)||p(null,t),i=o.get(t);else if("string"==typeof t)i=a(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!i)throw Error(`No editor registered under name "${t}"`);return i.getInstance(e)}function g(t){if("function"==typeof t)return t;if(!l(t))throw Error(`No registered editor found under "${t}" name`);return a(t).getConstructor()}function p(t,e){t&&"string"!=typeof t&&(t=(e=t).EDITOR_TYPE);let i=new d(e);"string"==typeof t&&n(t,i),o.set(e,i)}}),ta("1C6fS",function(t,e){var i=tn("hmx0d"),r=tn("7mb70"),o=tn("5dW2a"),s=tn("g4JpJ"),n="WebAssembly",a=r[n],l=7!==Error("e",{cause:7}).cause,h=function(t,e){var r={};r[t]=s(t,e,l),i({global:!0,constructor:!0,arity:1,forced:l},r)},c=function(t,e){if(a&&a[t]){var r={};r[t]=s(n+"."+t,e,l),i({target:n,stat:!0,constructor:!0,arity:1,forced:l},r)}};h("Error",function(t){return function(e){return o(t,this,arguments)}}),h("EvalError",function(t){return function(e){return o(t,this,arguments)}}),h("RangeError",function(t){return function(e){return o(t,this,arguments)}}),h("ReferenceError",function(t){return function(e){return o(t,this,arguments)}}),h("SyntaxError",function(t){return function(e){return o(t,this,arguments)}}),h("TypeError",function(t){return function(e){return o(t,this,arguments)}}),h("URIError",function(t){return function(e){return o(t,this,arguments)}}),c("CompileError",function(t){return function(e){return o(t,this,arguments)}}),c("LinkError",function(t){return function(e){return o(t,this,arguments)}}),c("RuntimeError",function(t){return function(e){return o(t,this,arguments)}})}),ta("hmx0d",function(t,e){var i=tn("7mb70"),r=tn("9po1L").f,o=tn("bylnm"),s=tn("5zwnU"),n=tn("6BhPC"),a=tn("kwCyx"),l=tn("hm2ET");t.exports=function(t,e){var h,c,d,u,g,p=t.target,f=t.global,m=t.stat;if(h=f?i:m?i[p]||n(p,{}):i[p]&&i[p].prototype)for(c in e){if(u=e[c],d=t.dontCallGetSet?(g=r(h,c))&&g.value:h[c],!l(f?c:p+(m?".":"#")+c,t.forced)&&void 0!==d){if(typeof u==typeof d)continue;a(u,d)}(t.sham||d&&d.sham)&&o(u,"sham",!0),s(h,c,u,t)}}}),ta("7mb70",function(t,e){var i=function(t){return t&&t.Math===Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof tr&&tr)||i("object"==typeof t.exports&&t.exports)||function(){return this}()||Function("return this")()}),ta("9po1L",function(t,e){s(t.exports,"f",()=>i,t=>i=t);var i,r=tn("kxexm"),o=tn("bGtV7"),n=tn("2zQpY"),a=tn("fEYls"),l=tn("6CGth"),h=tn("aUydt"),c=tn("2HOcD"),d=tn("ieeYC"),u=Object.getOwnPropertyDescriptor;i=r?u:function(t,e){if(t=l(t),e=h(e),d)try{return u(t,e)}catch(t){}if(c(t,e))return a(!o(n.f,t,e),t[e])}}),ta("kxexm",function(t,e){var i=tn("8lFU3");t.exports=!i(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})}),ta("8lFU3",function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}}),ta("bGtV7",function(t,e){var i=tn("gcG3g"),r=Function.prototype.call;t.exports=i?r.bind(r):function(){return r.apply(r,arguments)}}),ta("gcG3g",function(t,e){var i=tn("8lFU3");t.exports=!i(function(){var t=(function(){}).bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})}),ta("2zQpY",function(t,e){s(t.exports,"f",()=>i,t=>i=t);var i,r={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor;i=o&&!r.call({1:2},1)?function(t){var e=o(this,t);return!!e&&e.enumerable}:r}),ta("fEYls",function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}}),ta("6CGth",function(t,e){var i=tn("bbbU8"),r=tn("gMtBp");t.exports=function(t){return i(r(t))}}),ta("bbbU8",function(t,e){var i=tn("5Okwt"),r=tn("8lFU3"),o=tn("faIBy"),s=Object,n=i("".split);t.exports=r(function(){return!s("z").propertyIsEnumerable(0)})?function(t){return"String"===o(t)?n(t,""):s(t)}:s}),ta("5Okwt",function(t,e){var i=tn("gcG3g"),r=Function.prototype,o=r.call,s=i&&r.bind.bind(o,o);t.exports=i?s:function(t){return function(){return o.apply(t,arguments)}}}),ta("faIBy",function(t,e){var i=tn("5Okwt"),r=i({}.toString),o=i("".slice);t.exports=function(t){return o(r(t),8,-1)}}),ta("gMtBp",function(t,e){var i=tn("aIKND"),r=TypeError;t.exports=function(t){if(i(t))throw new r("Can't call method on "+t);return t}}),ta("aIKND",function(t,e){t.exports=function(t){return null==t}}),ta("aUydt",function(t,e){var i=tn("cmpCY"),r=tn("XW8Vm");t.exports=function(t){var e=i(t,"string");return r(e)?e:e+""}}),ta("cmpCY",function(t,e){var i=tn("bGtV7"),r=tn("96Da4"),o=tn("XW8Vm"),s=tn("kdzTk"),n=tn("fc07P"),a=tn("blCy8"),l=TypeError,h=a("toPrimitive");t.exports=function(t,e){if(!r(t)||o(t))return t;var a,c=s(t,h);if(c){if(void 0===e&&(e="default"),!r(a=i(c,t,e))||o(a))return a;throw new l("Can't convert object to primitive value")}return void 0===e&&(e="number"),n(t,e)}}),ta("96Da4",function(t,e){var i=tn("9GTLg");t.exports=function(t){return"object"==typeof t?null!==t:i(t)}}),ta("9GTLg",function(t,e){var i="object"==typeof document&&document.all;t.exports=void 0===i&&void 0!==i?function(t){return"function"==typeof t||t===i}:function(t){return"function"==typeof t}}),ta("XW8Vm",function(t,e){var i=tn("eaZdY"),r=tn("9GTLg"),o=tn("5Ef1u"),s=tn("6aX88"),n=Object;t.exports=s?function(t){return"symbol"==typeof t}:function(t){var e=i("Symbol");return r(e)&&o(e.prototype,n(t))}}),ta("eaZdY",function(t,e){var i=tn("7mb70"),r=tn("9GTLg");t.exports=function(t,e){var o;return arguments.length<2?r(o=i[t])?o:void 0:i[t]&&i[t][e]}}),ta("5Ef1u",function(t,e){var i=tn("5Okwt");t.exports=i({}.isPrototypeOf)}),ta("6aX88",function(t,e){var i=tn("6n5Js");t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator}),ta("6n5Js",function(t,e){var i=tn("dbmhE"),r=tn("8lFU3"),o=tn("7mb70").String;t.exports=!!Object.getOwnPropertySymbols&&!r(function(){var t=Symbol("symbol detection");return!o(t)||!(Object(t) instanceof Symbol)||!Symbol.sham&&i&&i<41})}),ta("dbmhE",function(t,e){var i,r,o=tn("7mb70"),s=tn("6hv4b"),n=o.process,a=o.Deno,l=n&&n.versions||a&&a.version,h=l&&l.v8;h&&(r=(i=h.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!r&&s&&(!(i=s.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=s.match(/Chrome\/(\d+)/))&&(r=+i[1]),t.exports=r}),ta("6hv4b",function(t,e){t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""}),ta("kdzTk",function(t,e){var i=tn("eXHxq"),r=tn("aIKND");t.exports=function(t,e){var o=t[e];return r(o)?void 0:i(o)}}),ta("eXHxq",function(t,e){var i=tn("9GTLg"),r=tn("chuuX"),o=TypeError;t.exports=function(t){if(i(t))return t;throw new o(r(t)+" is not a function")}}),ta("chuuX",function(t,e){var i=String;t.exports=function(t){try{return i(t)}catch(t){return"Object"}}}),ta("fc07P",function(t,e){var i=tn("bGtV7"),r=tn("9GTLg"),o=tn("96Da4"),s=TypeError;t.exports=function(t,e){var n,a;if("string"===e&&r(n=t.toString)&&!o(a=i(n,t))||r(n=t.valueOf)&&!o(a=i(n,t))||"string"!==e&&r(n=t.toString)&&!o(a=i(n,t)))return a;throw new s("Can't convert object to primitive value")}}),ta("blCy8",function(t,e){var i=tn("7mb70"),r=tn("2axMY"),o=tn("2HOcD"),s=tn("84zlK"),n=tn("6n5Js"),a=tn("6aX88"),l=i.Symbol,h=r("wks"),c=a?l.for||l:l&&l.withoutSetter||s;t.exports=function(t){return o(h,t)||(h[t]=n&&o(l,t)?l[t]:c("Symbol."+t)),h[t]}}),ta("2axMY",function(t,e){var i=tn("hRrSO");t.exports=function(t,e){return i[t]||(i[t]=e||{})}}),ta("hRrSO",function(t,e){var i=tn("jfGLK"),r=tn("7mb70"),o=tn("6BhPC"),s="__core-js_shared__",n=t.exports=r[s]||o(s,{});(n.versions||(n.versions=[])).push({version:"3.37.0",mode:i?"pure":"global",copyright:" 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),ta("jfGLK",function(t,e){t.exports=!1}),ta("6BhPC",function(t,e){var i=tn("7mb70"),r=Object.defineProperty;t.exports=function(t,e){try{r(i,t,{value:e,configurable:!0,writable:!0})}catch(r){i[t]=e}return e}}),ta("2HOcD",function(t,e){var i=tn("5Okwt"),r=tn("dZoqA"),o=i({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return o(r(t),e)}}),ta("dZoqA",function(t,e){var i=tn("gMtBp"),r=Object;t.exports=function(t){return r(i(t))}}),ta("84zlK",function(t,e){var i=tn("5Okwt"),r=0,o=Math.random(),s=i(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+s(++r+o,36)}}),ta("ieeYC",function(t,e){var i=tn("kxexm"),r=tn("8lFU3"),o=tn("1RN1j");t.exports=!i&&!r(function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a})}),ta("1RN1j",function(t,e){var i=tn("7mb70"),r=tn("96Da4"),o=i.document,s=r(o)&&r(o.createElement);t.exports=function(t){return s?o.createElement(t):{}}}),ta("bylnm",function(t,e){var i=tn("kxexm"),r=tn("3RKYQ"),o=tn("fEYls");t.exports=i?function(t,e,i){return r.f(t,e,o(1,i))}:function(t,e,i){return t[e]=i,t}}),ta("3RKYQ",function(t,e){s(t.exports,"f",()=>i,t=>i=t);var i,r=tn("kxexm"),o=tn("ieeYC"),n=tn("1TEKD"),a=tn("hc2VB"),l=tn("aUydt"),h=TypeError,c=Object.defineProperty,d=Object.getOwnPropertyDescriptor,u="enumerable",g="configurable",p="writable";i=r?n?function(t,e,i){if(a(t),e=l(e),a(i),"function"==typeof t&&"prototype"===e&&"value"in i&&p in i&&!i[p]){var r=d(t,e);r&&r[p]&&(t[e]=i.value,i={configurable:g in i?i[g]:r[g],enumerable:u in i?i[u]:r[u],writable:!1})}return c(t,e,i)}:c:function(t,e,i){if(a(t),e=l(e),a(i),o)try{return c(t,e,i)}catch(t){}if("get"in i||"set"in i)throw new h("Accessors not supported");return"value"in i&&(t[e]=i.value),t}}),ta("1TEKD",function(t,e){var i=tn("kxexm"),r=tn("8lFU3");t.exports=i&&r(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})}),ta("hc2VB",function(t,e){var i=tn("96Da4"),r=String,o=TypeError;t.exports=function(t){if(i(t))return t;throw new o(r(t)+" is not an object")}}),ta("5zwnU",function(t,e){var i=tn("9GTLg"),r=tn("3RKYQ"),o=tn("Q0KqA"),s=tn("6BhPC");t.exports=function(t,e,n,a){a||(a={});var l=a.enumerable,h=void 0!==a.name?a.name:e;if(i(n)&&o(n,h,a),a.global)l?t[e]=n:s(e,n);else{try{a.unsafe?t[e]&&(l=!0):delete t[e]}catch(t){}l?t[e]=n:r.f(t,e,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return t}}),ta("Q0KqA",function(t,e){var i=tn("5Okwt"),r=tn("8lFU3"),o=tn("9GTLg"),s=tn("2HOcD"),n=tn("kxexm"),a=tn("b8MME").CONFIGURABLE,l=tn("dbqDy"),h=tn("51DEQ"),c=h.enforce,d=h.get,u=String,g=Object.defineProperty,p=i("".slice),f=i("".replace),m=i([].join),y=n&&!r(function(){return 8!==g(function(){},"length",{value:8}).length}),w=String(String).split("String"),b=t.exports=function(t,e,i){"Symbol("===p(u(e),0,7)&&(e="["+f(u(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),i&&i.getter&&(e="get "+e),i&&i.setter&&(e="set "+e),(!s(t,"name")||a&&t.name!==e)&&(n?g(t,"name",{value:e,configurable:!0}):t.name=e),y&&i&&s(i,"arity")&&t.length!==i.arity&&g(t,"length",{value:i.arity});try{i&&s(i,"constructor")&&i.constructor?n&&g(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=c(t);return s(r,"source")||(r.source=m(w,"string"==typeof e?e:"")),t};Function.prototype.toString=b(function(){return o(this)&&d(this).source||l(this)},"toString")}),ta("b8MME",function(t,e){var i=tn("kxexm"),r=tn("2HOcD"),o=Function.prototype,s=i&&Object.getOwnPropertyDescriptor,n=r(o,"name"),a=n&&(!i||i&&s(o,"name").configurable);t.exports={EXISTS:n,PROPER:n&&"something"===(function(){}).name,CONFIGURABLE:a}}),ta("dbqDy",function(t,e){var i=tn("5Okwt"),r=tn("9GTLg"),o=tn("hRrSO"),s=i(Function.toString);r(o.inspectSource)||(o.inspectSource=function(t){return s(t)}),t.exports=o.inspectSource}),ta("51DEQ",function(t,e){var i,r,o,s=tn("6amDj"),n=tn("7mb70"),a=tn("96Da4"),l=tn("bylnm"),h=tn("2HOcD"),c=tn("hRrSO"),d=tn("bgRz0"),u=tn("dGabS"),g="Object already initialized",p=n.TypeError,f=n.WeakMap;if(s||c.state){var m=c.state||(c.state=new f);m.get=m.get,m.has=m.has,m.set=m.set,i=function(t,e){if(m.has(t))throw new p(g);return e.facade=t,m.set(t,e),e},r=function(t){return m.get(t)||{}},o=function(t){return m.has(t)}}else{var y=d("state");u[y]=!0,i=function(t,e){if(h(t,y))throw new p(g);return e.facade=t,l(t,y,e),e},r=function(t){return h(t,y)?t[y]:{}},o=function(t){return h(t,y)}}t.exports={set:i,get:r,has:o,enforce:function(t){return o(t)?r(t):i(t,{})},getterFor:function(t){return function(e){var i;if(!a(e)||(i=r(e)).type!==t)throw new p("Incompatible receiver, "+t+" required");return i}}}}),ta("6amDj",function(t,e){var i=tn("7mb70"),r=tn("9GTLg"),o=i.WeakMap;t.exports=r(o)&&/native code/.test(String(o))}),ta("bgRz0",function(t,e){var i=tn("2axMY"),r=tn("84zlK"),o=i("keys");t.exports=function(t){return o[t]||(o[t]=r(t))}}),ta("dGabS",function(t,e){t.exports={}}),ta("kwCyx",function(t,e){var i=tn("2HOcD"),r=tn("4qMpp"),o=tn("9po1L"),s=tn("3RKYQ");t.exports=function(t,e,n){for(var a=r(e),l=s.f,h=o.f,c=0;c<a.length;c++){var d=a[c];i(t,d)||n&&i(n,d)||l(t,d,h(e,d))}}}),ta("4qMpp",function(t,e){var i=tn("eaZdY"),r=tn("5Okwt"),o=tn("lbvB0"),s=tn("1gYLQ"),n=tn("hc2VB"),a=r([].concat);t.exports=i("Reflect","ownKeys")||function(t){var e=o.f(n(t)),i=s.f;return i?a(e,i(t)):e}}),ta("lbvB0",function(t,e){s(t.exports,"f",()=>i,t=>i=t);var i,r=tn("gUxdt"),o=tn("jQUZd").concat("length","prototype");i=Object.getOwnPropertyNames||function(t){return r(t,o)}}),ta("gUxdt",function(t,e){var i=tn("5Okwt"),r=tn("2HOcD"),o=tn("6CGth"),s=tn("kBDFQ").indexOf,n=tn("dGabS"),a=i([].push);t.exports=function(t,e){var i,l=o(t),h=0,c=[];for(i in l)!r(n,i)&&r(l,i)&&a(c,i);for(;e.length>h;)r(l,i=e[h++])&&(~s(c,i)||a(c,i));return c}}),ta("kBDFQ",function(t,e){var i=tn("6CGth"),r=tn("2ES4E"),o=tn("ptmgx"),s=function(t){return function(e,s,n){var a,l=i(e),h=o(l);if(0===h)return!t&&-1;var c=r(n,h);if(t&&s!=s){for(;h>c;)if((a=l[c++])!=a)return!0}else for(;h>c;c++)if((t||c in l)&&l[c]===s)return t||c||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}}),ta("2ES4E",function(t,e){var i=tn("fBlGn"),r=Math.max,o=Math.min;t.exports=function(t,e){var s=i(t);return s<0?r(s+e,0):o(s,e)}}),ta("fBlGn",function(t,e){var i=tn("7aV2g");t.exports=function(t){var e=+t;return e!=e||0===e?0:i(e)}}),ta("7aV2g",function(t,e){var i=Math.ceil,r=Math.floor;t.exports=Math.trunc||function(t){var e=+t;return(e>0?r:i)(e)}}),ta("ptmgx",function(t,e){var i=tn("6pMmI");t.exports=function(t){return i(t.length)}}),ta("6pMmI",function(t,e){var i=tn("fBlGn"),r=Math.min;t.exports=function(t){var e=i(t);return e>0?r(e,9007199254740991):0}}),ta("jQUZd",function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]}),ta("1gYLQ",function(t,e){var i;s(t.exports,"f",()=>i,t=>i=t),i=Object.getOwnPropertySymbols}),ta("hm2ET",function(t,e){var i=tn("8lFU3"),r=tn("9GTLg"),o=/#|\.prototype\./,s=function(t,e){var o=a[n(t)];return o===h||o!==l&&(r(e)?i(e):!!e)},n=s.normalize=function(t){return String(t).replace(o,".").toLowerCase()},a=s.data={},l=s.NATIVE="N",h=s.POLYFILL="P";t.exports=s}),ta("5dW2a",function(t,e){var i=tn("gcG3g"),r=Function.prototype,o=r.apply,s=r.call;t.exports="object"==typeof Reflect&&Reflect.apply||(i?s.bind(o):function(){return s.apply(o,arguments)})}),ta("g4JpJ",function(t,e){var i=tn("eaZdY"),r=tn("2HOcD"),o=tn("bylnm"),s=tn("5Ef1u"),n=tn("86ypM"),a=tn("kwCyx"),l=tn("4N46w"),h=tn("hc27f"),c=tn("kZ0Uj"),d=tn("uRxC1"),u=tn("fze5Y"),g=tn("kxexm"),p=tn("jfGLK");t.exports=function(t,e,f,m){var y="stackTraceLimit",w=m?2:1,b=t.split("."),C=b[b.length-1],S=i.apply(null,b);if(S){var x=S.prototype;if(!p&&r(x,"cause")&&delete x.cause,!f)return S;var E=i("Error"),R=e(function(t,e){var i=c(m?e:t,void 0),r=m?new S(t):new S;return void 0!==i&&o(r,"message",i),u(r,R,r.stack,2),this&&s(x,this)&&h(r,this,R),arguments.length>w&&d(r,arguments[w]),r});if(R.prototype=x,"Error"!==C?n?n(R,E):a(R,E,{name:!0}):g&&y in S&&(l(R,S,y),l(R,S,"prepareStackTrace")),a(R,S),!p)try{x.name!==C&&o(x,"name",C),x.constructor=R}catch(t){}return R}}}),ta("86ypM",function(t,e){var i=tn("eH2QD"),r=tn("96Da4"),o=tn("gMtBp"),s=tn("igRk2");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=i(Object.prototype,"__proto__","set"))(n,[]),e=n instanceof Array}catch(t){}return function(i,n){return o(i),s(n),r(i)&&(e?t(i,n):i.__proto__=n),i}}():void 0)}),ta("eH2QD",function(t,e){var i=tn("5Okwt"),r=tn("eXHxq");t.exports=function(t,e,o){try{return i(r(Object.getOwnPropertyDescriptor(t,e)[o]))}catch(t){}}}),ta("igRk2",function(t,e){var i=tn("64ANw"),r=String,o=TypeError;t.exports=function(t){if(i(t))return t;throw new o("Can't set "+r(t)+" as a prototype")}}),ta("64ANw",function(t,e){var i=tn("96Da4");t.exports=function(t){return i(t)||null===t}}),ta("4N46w",function(t,e){var i=tn("3RKYQ").f;t.exports=function(t,e,r){r in t||i(t,r,{configurable:!0,get:function(){return e[r]},set:function(t){e[r]=t}})}}),ta("hc27f",function(t,e){var i=tn("9GTLg"),r=tn("96Da4"),o=tn("86ypM");t.exports=function(t,e,s){var n,a;return o&&i(n=e.constructor)&&n!==s&&r(a=n.prototype)&&a!==s.prototype&&o(t,a),t}}),ta("kZ0Uj",function(t,e){var i=tn("jqSLA");t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:i(t)}}),ta("jqSLA",function(t,e){var i=tn("f9qXf"),r=String;t.exports=function(t){if("Symbol"===i(t))throw TypeError("Cannot convert a Symbol value to a string");return r(t)}}),ta("f9qXf",function(t,e){var i=tn("dYl9B"),r=tn("9GTLg"),o=tn("faIBy"),s=tn("blCy8")("toStringTag"),n=Object,a="Arguments"===o(function(){return arguments}()),l=function(t,e){try{return t[e]}catch(t){}};t.exports=i?o:function(t){var e,i,h;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=l(e=n(t),s))?i:a?o(e):"Object"===(h=o(e))&&r(e.callee)?"Arguments":h}}),ta("dYl9B",function(t,e){var i=tn("blCy8")("toStringTag"),r={};r[i]="z",t.exports="[object z]"===String(r)}),ta("uRxC1",function(t,e){var i=tn("96Da4"),r=tn("bylnm");t.exports=function(t,e){i(e)&&"cause"in e&&r(t,"cause",e.cause)}}),ta("fze5Y",function(t,e){var i=tn("bylnm"),r=tn("aqrkN"),o=tn("gmQfy"),s=Error.captureStackTrace;t.exports=function(t,e,n,a){o&&(s?s(t,e):i(t,"stack",r(n,a)))}}),ta("aqrkN",function(t,e){var i=tn("5Okwt"),r=Error,o=i("".replace),s=String(new r("zxcasd").stack),n=/\n\s*at [^:]*:[^\n]*/,a=n.test(s);t.exports=function(t,e){if(a&&"string"==typeof t&&!r.prepareStackTrace)for(;e--;)t=o(t,n,"");return t}}),ta("gmQfy",function(t,e){var i=tn("8lFU3"),r=tn("fEYls");t.exports=!i(function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",r(1,7)),7!==t.stack)})}),ta("10euP",function(t,e){s(t.exports,"default",()=>f),tn("1C6fS"),tn("1hIp0");var i=tn("ceXML"),r=tn("hwT6B"),o=tn("bO142"),n=tn("jlXkd"),a=tn("iCsRe"),l=tn("f3221");let h=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],c=(0,a.toSingleLine)`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,d=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),u=new Map([[]]);class g{static getSingleton(){return p}constructor(){var t,e,i;e=void 0,(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="globalBucket","string"))?i:i+"")in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e,this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){let t=Object.create(null);return(0,i.arrayEach)(h,e=>t[e]=[]),t}getBucket(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}add(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))(0,i.arrayEach)(e,e=>this.add(t,e,r));else{d.has(t)&&(0,n.warn)((0,o.substitute)(c,{hookName:t,removedInVersion:d.get(t)})),u.has(t)&&(0,n.warn)(u.get(t));let s=this.getBucket(r);if(void 0===s[t]&&(this.register(t),s[t]=[]),e.skip=!1,-1===s[t].indexOf(e)){let r=!1;e.initialHook&&(0,i.arrayEach)(s[t],(i,o)=>{if(i.initialHook)return s[t][o]=e,r=!0,!1}),r||s[t].push(e)}}return this}once(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?(0,i.arrayEach)(e,e=>this.once(t,e,r)):(e.runOnce=!0,this.add(t,e,r))}remove(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(i);return!!(void 0!==r[t]&&r[t].indexOf(e)>=0)&&(e.skip=!0,!0)}has(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.getBucket(e);return!!(void 0!==i[t]&&i[t].length)}run(t,e,i,r,o,s,n,a){{let h=this.globalBucket[e],c=h?h.length:0,d=0;if(c)for(;d<c;){if(!h[d]||h[d].skip){d+=1;continue}let c=(0,l.fastCall)(h[d],t,i,r,o,s,n,a);void 0!==c&&(i=c),h[d]&&h[d].runOnce&&this.remove(e,h[d]),d+=1}}{let h=this.getBucket(t)[e],c=h?h.length:0,d=0;if(c)for(;d<c;){if(!h[d]||h[d].skip){d+=1;continue}let c=(0,l.fastCall)(h[d],t,i,r,o,s,n,a);void 0!==c&&(i=c),h[d]&&h[d].runOnce&&this.remove(e,h[d],t),d+=1}}return i}destroy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,r.objectEach)(this.getBucket(t),(t,e,i)=>i[e].length=0)}register(t){this.isRegistered(t)||h.push(t)}deregister(t){this.isRegistered(t)&&h.splice(h.indexOf(t),1)}isDeprecated(t){return u.has(t)||d.has(t)}isRegistered(t){return h.indexOf(t)>=0}getRegistered(){return h}}let p=new g;var f=g}),ta("1hIp0",function(t,e){var i=tn("hmx0d"),r=tn("dZoqA"),o=tn("ptmgx"),s=tn("6BH0Y"),n=tn("6Rnn4");i({target:"Array",proto:!0,arity:1,forced:tn("8lFU3")(function(){return 4294967297!==[].push.call({length:4294967296},1)})||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}()},{push:function(t){var e=r(this),i=o(e),a=arguments.length;n(i+a);for(var l=0;l<a;l++)e[i]=arguments[l],i++;return s(e,i),i}})}),ta("6BH0Y",function(t,e){var i=tn("kxexm"),r=tn("h6ycM"),o=TypeError,s=Object.getOwnPropertyDescriptor,n=i&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=n?function(t,e){if(r(t)&&!s(t,"length").writable)throw new o("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}}),ta("h6ycM",function(t,e){var i=tn("faIBy");t.exports=Array.isArray||function(t){return"Array"===i(t)}}),ta("6Rnn4",function(t,e){var i=TypeError;t.exports=function(t){if(t>9007199254740991)throw i("Maximum allowed index exceeded");return t}}),ta("ceXML",function(t,e){function i(t){let e=t.length,i=0;for(;i<e;)t[i]=[t[i]],i+=1}function r(t,e){let i=e.length,r=0;for(;r<i;)t.push(e[r]),r+=1}function o(t){let e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;let i=t.length,r=t[0].length;for(let o=0;o<i;o++)for(let i=0;i<r;i++)e[i]||(e[i]=[]),e[i][o]=t[o][i];return e}function n(t,e,i,r){let o=-1,s=t,n=i;Array.isArray(t)||(s=Array.from(t));let a=s.length;for(r&&a&&(o+=1,n=s[o]),o+=1;o<a;)n=e(n,s[o],o,s),o+=1;return n}function a(t,e){let i=0,r=t;Array.isArray(t)||(r=Array.from(t));let o=r.length,s=[],n=-1;for(;i<o;){let t=r[i];e(t,i,r)&&(s[n+=1]=t),i+=1}return s}function l(t,e){let i=0,r=t;Array.isArray(t)||(r=Array.from(t));let o=r.length,s=[],n=-1;for(;i<o;){let t=r[i];s[n+=1]=e(t,i,r),i+=1}return s}function h(t,e){let i=0,r=t;Array.isArray(t)||(r=Array.from(t));let o=r.length;for(;i<o&&!1!==e(r[i],i,r);)i+=1;return t}function c(t){return n(t,(t,e)=>t+e,0)}function d(t){return n(t,(t,e)=>t>e?t:e,Array.isArray(t)?t[0]:void 0)}function u(t){return n(t,(t,e)=>t<e?t:e,Array.isArray(t)?t[0]:void 0)}function g(t){return t.length?c(t)/t.length:0}function p(t){let e=[];return h(t,t=>{-1===e.indexOf(t)&&e.push(t)}),e}function f(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let[r,...o]=[...e],s=r;return h(o,t=>{s=s.filter(e=>!t.includes(e))}),s}function m(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let[r,...o]=[...e],s=r;return h(o,t=>{s=s.filter(e=>t.includes(e))}),s}function y(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let[r,...o]=[...e],s=new Set(r);return h(o,t=>{h(t,t=>{s.has(t)||s.add(t)})}),Array.from(s)}function w(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}s(t.exports,"to2dArray",()=>i),s(t.exports,"extendArray",()=>r),s(t.exports,"pivot",()=>o),s(t.exports,"arrayReduce",()=>n),s(t.exports,"arrayFilter",()=>a),s(t.exports,"arrayMap",()=>l),s(t.exports,"arrayEach",()=>h),s(t.exports,"arraySum",()=>c),s(t.exports,"arrayMax",()=>d),s(t.exports,"arrayMin",()=>u),s(t.exports,"arrayAvg",()=>g),s(t.exports,"arrayFlatten",()=>function t(e){return n(e,(e,i)=>e.concat(Array.isArray(i)?t(i):i),[])}),s(t.exports,"arrayUnique",()=>p),s(t.exports,"getDifferenceOfArrays",()=>f),s(t.exports,"getIntersectionOfArrays",()=>m),s(t.exports,"getUnionOfArrays",()=>y),s(t.exports,"stringToArray",()=>w),tn("1hIp0")}),ta("hwT6B",function(t,e){s(t.exports,"duckSchema",()=>function t(e){let i;return Array.isArray(e)?i=e.length?Array(e.length).fill(null):[]:(i={},u(e,(e,r)=>{"__children"!==r&&(e&&"object"==typeof e&&!Array.isArray(e)?i[r]=t(e):Array.isArray(e)?e.length&&"object"==typeof e[0]&&!Array.isArray(e[0])?i[r]=[t(e[0])]:i[r]=[]:i[r]=null)})),i}),s(t.exports,"objectEach",()=>u),s(t.exports,"inherit",()=>r),s(t.exports,"extend",()=>o),s(t.exports,"deepExtend",()=>function t(e,i){u(i,(r,o)=>{i[o]&&"object"==typeof i[o]?(e[o]||(Array.isArray(i[o])?e[o]=[]:"[object Date]"===Object.prototype.toString.call(i[o])?e[o]=i[o]:e[o]={}),t(e[o],i[o])):e[o]=i[o]})}),s(t.exports,"deepClone",()=>n),s(t.exports,"clone",()=>a),s(t.exports,"mixin",()=>l),s(t.exports,"isObject",()=>c),s(t.exports,"isObjectEqual",()=>h),s(t.exports,"defineGetter",()=>d),s(t.exports,"getProperty",()=>g),s(t.exports,"setProperty",()=>p),s(t.exports,"hasOwnProperty",()=>y),s(t.exports,"deepObjectSize",()=>f),s(t.exports,"createObjectPropListener",()=>m),tn("1C6fS"),tn("1hIp0"),tn("euqEx");var i=tn("ceXML");function r(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function o(t,e,i){let r=Array.isArray(i);return u(e,(e,o)=>{(!1===r||i.includes(o))&&(t[o]=e)}),t}function n(t){return"object"==typeof t?JSON.parse(JSON.stringify(t)):t}function a(t){let e={};return u(t,(t,i)=>{e[i]=t}),e}function l(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];return(0,i.arrayEach)(r,e=>{t.MIXINS.push(e.MIXIN_NAME),u(e,(e,i)=>{if(void 0!==t.prototype[i])throw Error(`Mixin conflict. Property '${i}' already exist and cannot be overwritten.`);"function"==typeof e?t.prototype[i]=e:Object.defineProperty(t.prototype,i,{get:function(t,e){let i=`_${t}`,r=t=>{let e=t;return(Array.isArray(e)||c(e))&&(e=n(e)),e};return function(){return void 0===this[i]&&(this[i]=r(e)),this[i]}}(i,e),set:function(t){let e=`_${t}`;return function(t){this[e]=t}}(i),configurable:!0})})}),t}function h(t,e){return JSON.stringify(t)===JSON.stringify(e)}function c(t){return"[object Object]"===Object.prototype.toString.call(t)}function d(t,e,i,r){r.value=i,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(t,e,r)}function u(t,e){for(let i in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,i))&&!1===e(t[i],i,t))break;return t}function g(t,e){let i=e.split("."),r=t;return u(i,t=>{if(void 0===(r=r[t]))return r=void 0,!1}),r}function p(t,e,i){let r=e.split("."),o=t;r.forEach((t,e)=>{e!==r.length-1?(y(o,t)||(o[t]={}),o=o[t]):o[t]=i})}function f(t){if(!c(t))return 0;let e=function(t){let i=0;return c(t)?u(t,(t,r)=>{"__children"!==r&&(i+=e(t))}):i+=1,i};return e(t)}function m(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",i=`_${e}`,r={_touched:!1,[i]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[i]},set(t){this._touched=!0,this[i]=t},enumerable:!0,configurable:!0}),r}function y(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}),ta("euqEx",function(t,e){var i=tn("hmx0d"),r=tn("eaZdY"),o=tn("5dW2a"),s=tn("bGtV7"),n=tn("5Okwt"),a=tn("8lFU3"),l=tn("9GTLg"),h=tn("XW8Vm"),c=tn("BsNAl"),d=tn("lkYqI"),u=tn("6n5Js"),g=String,p=r("JSON","stringify"),f=n(/./.exec),m=n("".charAt),y=n("".charCodeAt),w=n("".replace),b=n(1..toString),C=/[\uD800-\uDFFF]/g,S=/^[\uD800-\uDBFF]$/,x=/^[\uDC00-\uDFFF]$/,E=!u||a(function(){var t=r("Symbol")("stringify detection");return"[null]"!==p([t])||"{}"!==p({a:t})||"{}"!==p(Object(t))}),R=a(function(){return'"\udf06\ud834"'!==p("\uDF06\uD834")||'"\udead"'!==p("\uDEAD")}),T=function(t,e){var i=c(arguments),r=d(e);if(!(!l(r)&&(void 0===t||h(t))))return i[1]=function(t,e){if(l(r)&&(e=s(r,this,g(t),e)),!h(e))return e},o(p,null,i)},M=function(t,e,i){var r=m(i,e-1),o=m(i,e+1);return f(S,t)&&!f(x,o)||f(x,t)&&!f(S,r)?"\\u"+b(y(t,0),16):t};p&&i({target:"JSON",stat:!0,arity:3,forced:E||R},{stringify:function(t,e,i){var r=c(arguments),s=o(E?T:p,null,r);return R&&"string"==typeof s?w(s,C,M):s}})}),ta("BsNAl",function(t,e){var i=tn("5Okwt");t.exports=i([].slice)}),ta("lkYqI",function(t,e){var i=tn("5Okwt"),r=tn("h6ycM"),o=tn("9GTLg"),s=tn("faIBy"),n=tn("jqSLA"),a=i([].push);t.exports=function(t){if(o(t))return t;if(r(t)){for(var e=t.length,i=[],l=0;l<e;l++){var h=t[l];"string"==typeof h?a(i,h):("number"==typeof h||"Number"===s(h)||"String"===s(h))&&a(i,n(h))}var c=i.length,d=!0;return function(t,e){if(d)return d=!1,e;if(r(this))return e;for(var o=0;o<c;o++)if(i[o]===t)return e}}}}),ta("bO142",function(t,e){s(t.exports,"toUpperCaseFirst",()=>n),s(t.exports,"equalsIgnoreCase",()=>a),s(t.exports,"randomString",()=>l),s(t.exports,"isPercentValue",()=>h),s(t.exports,"substitute",()=>c),s(t.exports,"stripTags",()=>d),s(t.exports,"sanitize",()=>u),tn("1hIp0");var i=tn("i8Fxz"),r=tn("gnaTS");function n(t){return t[0].toUpperCase()+t.substr(1)}function a(){let t=[];for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];let s=i.length;for(;s;){s-=1;let e=(0,r.stringify)(i[s]).toLowerCase();-1===t.indexOf(e)&&t.push(e)}return 1===t.length}function l(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function h(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function c(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,i)=>"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[i]?"":e[i])}function d(t){return u(`${t}`,{ALLOWED_TAGS:[]})}function u(t,e){return o(i).sanitize(t,e)}}),ta("i8Fxz",function(t,e){var i;t.exports,i=function(){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,i){return(e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,i)}function i(t,r,o){return(i=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}()?function(t,i,r){var o=[null];o.push.apply(o,i);var s=new(Function.bind.apply(t,o));return r&&e(s,r.prototype),s}:Reflect.construct).apply(null,arguments)}function r(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return o(t,void 0);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return o(t,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);i<e;i++)r[i]=t[i];return r}var s,n=Object.hasOwnProperty,a=Object.setPrototypeOf,l=Object.isFrozen,h=Object.getPrototypeOf,c=Object.getOwnPropertyDescriptor,d=Object.freeze,u=Object.seal,g=Object.create,p="undefined"!=typeof Reflect&&Reflect,f=p.apply,m=p.construct;f||(f=function(t,e,i){return t.apply(e,i)}),d||(d=function(t){return t}),u||(u=function(t){return t}),m||(m=function(t,e){return i(t,r(e))});var y=A(Array.prototype.forEach),w=A(Array.prototype.pop),b=A(Array.prototype.push),C=A(String.prototype.toLowerCase),S=A(String.prototype.toString),x=A(String.prototype.match),E=A(String.prototype.replace),R=A(String.prototype.indexOf),T=A(String.prototype.trim),M=A(RegExp.prototype.test),k=(s=TypeError,function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return m(s,e)});function A(t){return function(e){for(var i=arguments.length,r=Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];return f(t,e,r)}}function O(t,e,i){i=null!==(r=i)&&void 0!==r?r:C,a&&a(t,null);for(var r,o=e.length;o--;){var s=e[o];if("string"==typeof s){var n=i(s);n!==s&&(l(e)||(e[o]=n),s=n)}t[s]=!0}return t}function P(t){var e,i=g(null);for(e in t)!0===f(n,t,[e])&&(i[e]=t[e]);return i}function I(t,e){for(;null!==t;){var i=c(t,e);if(i){if(i.get)return A(i.get);if("function"==typeof i.value)return A(i.value)}t=h(t)}return function(t){return console.warn("fallback value for",t),null}}var H=d(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),L=d(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),D=d(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),N=d(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),_=d(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),F=d(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),j=d(["#text"]),B=d(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),W=d(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),V=d(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),U=d(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),z=u(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Y=u(/<%[\w\W]*|[\w\W]*%>/gm),G=u(/\${[\w\W]*}/gm),$=u(/^data-[\-\w.\u00B7-\uFFFF]/),X=u(/^aria-[\-\w]+$/),q=u(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),K=u(/^(?:\w+script|data):/i),Z=u(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Q=u(/^html$/i),J=u(/^[a-z][.\w]*(-[.\w]+)+$/i),tt=function(e,i){if("object"!==t(e)||"function"!=typeof e.createPolicy)return null;var r=null,o="data-tt-policy-suffix";i.currentScript&&i.currentScript.hasAttribute(o)&&(r=i.currentScript.getAttribute(o));var s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML:function(t){return t},createScriptURL:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+s+" could not be created."),null}};return function e(){var i,o,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,n=function(t){return e(t)};if(n.version="2.5.0",n.removed=[],!s||!s.document||9!==s.document.nodeType)return n.isSupported=!1,n;var a=s.document,l=s.document,h=s.DocumentFragment,c=s.HTMLTemplateElement,u=s.Node,g=s.Element,p=s.NodeFilter,f=s.NamedNodeMap,m=void 0===f?s.NamedNodeMap||s.MozNamedAttrMap:f,A=s.HTMLFormElement,te=s.DOMParser,ti=s.trustedTypes,tr=g.prototype,to=I(tr,"cloneNode"),ts=I(tr,"nextSibling"),tn=I(tr,"childNodes"),ta=I(tr,"parentNode");if("function"==typeof c){var tl=l.createElement("template");tl.content&&tl.content.ownerDocument&&(l=tl.content.ownerDocument)}var th=tt(ti,a),tc=th?th.createHTML(""):"",td=l,tu=td.implementation,tg=td.createNodeIterator,tp=td.createDocumentFragment,tf=td.getElementsByTagName,tm=a.importNode,ty={};try{ty=P(l).documentMode?l.documentMode:{}}catch(t){}var tv={};n.isSupported="function"==typeof ta&&tu&&void 0!==tu.createHTMLDocument&&9!==ty;var tw=q,tb=null,tC=O({},[].concat(r(H),r(L),r(D),r(_),r(j))),tS=null,tx=O({},[].concat(r(B),r(W),r(V),r(U))),tE=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),tR=null,tT=null,tM=!0,tk=!0,tA=!1,tO=!0,tP=!1,tI=!0,tH=!1,tL=!1,tD=!1,tN=!1,t_=!1,tF=!1,tj=!0,tB=!1,tW=!0,tV=!1,tU={},tz=null,tY=O({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),tG=null,t$=O({},["audio","video","img","source","image","track"]),tX=null,tq=O({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),tK="http://www.w3.org/1998/Math/MathML",tZ="http://www.w3.org/2000/svg",tQ="http://www.w3.org/1999/xhtml",tJ=tQ,t0=!1,t1=null,t2=O({},[tK,tZ,tQ],S),t3=["application/xhtml+xml","text/html"],t6=null,t4=l.createElement("form"),t5=function(t){return t instanceof RegExp||t instanceof Function},t9=function(e){t6&&t6===e||(e&&"object"===t(e)||(e={}),e=P(e),o="application/xhtml+xml"===(i=i=-1===t3.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE)?S:C,tb="ALLOWED_TAGS"in e?O({},e.ALLOWED_TAGS,o):tC,tS="ALLOWED_ATTR"in e?O({},e.ALLOWED_ATTR,o):tx,t1="ALLOWED_NAMESPACES"in e?O({},e.ALLOWED_NAMESPACES,S):t2,tX="ADD_URI_SAFE_ATTR"in e?O(P(tq),e.ADD_URI_SAFE_ATTR,o):tq,tG="ADD_DATA_URI_TAGS"in e?O(P(t$),e.ADD_DATA_URI_TAGS,o):t$,tz="FORBID_CONTENTS"in e?O({},e.FORBID_CONTENTS,o):tY,tR="FORBID_TAGS"in e?O({},e.FORBID_TAGS,o):{},tT="FORBID_ATTR"in e?O({},e.FORBID_ATTR,o):{},tU="USE_PROFILES"in e&&e.USE_PROFILES,tM=!1!==e.ALLOW_ARIA_ATTR,tk=!1!==e.ALLOW_DATA_ATTR,tA=e.ALLOW_UNKNOWN_PROTOCOLS||!1,tO=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,tP=e.SAFE_FOR_TEMPLATES||!1,tI=!1!==e.SAFE_FOR_XML,tH=e.WHOLE_DOCUMENT||!1,tN=e.RETURN_DOM||!1,t_=e.RETURN_DOM_FRAGMENT||!1,tF=e.RETURN_TRUSTED_TYPE||!1,tD=e.FORCE_BODY||!1,tj=!1!==e.SANITIZE_DOM,tB=e.SANITIZE_NAMED_PROPS||!1,tW=!1!==e.KEEP_CONTENT,tV=e.IN_PLACE||!1,tw=e.ALLOWED_URI_REGEXP||tw,tJ=e.NAMESPACE||tQ,tE=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&t5(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(tE.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&t5(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(tE.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(tE.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),tP&&(tk=!1),t_&&(tN=!0),tU&&(tb=O({},r(j)),tS=[],!0===tU.html&&(O(tb,H),O(tS,B)),!0===tU.svg&&(O(tb,L),O(tS,W),O(tS,U)),!0===tU.svgFilters&&(O(tb,D),O(tS,W),O(tS,U)),!0===tU.mathMl&&(O(tb,_),O(tS,V),O(tS,U))),e.ADD_TAGS&&(tb===tC&&(tb=P(tb)),O(tb,e.ADD_TAGS,o)),e.ADD_ATTR&&(tS===tx&&(tS=P(tS)),O(tS,e.ADD_ATTR,o)),e.ADD_URI_SAFE_ATTR&&O(tX,e.ADD_URI_SAFE_ATTR,o),e.FORBID_CONTENTS&&(tz===tY&&(tz=P(tz)),O(tz,e.FORBID_CONTENTS,o)),tW&&(tb["#text"]=!0),tH&&O(tb,["html","head","body"]),tb.table&&(O(tb,["tbody"]),delete tR.tbody),d&&d(e),t6=e)},t8=O({},["mi","mo","mn","ms","mtext"]),t7=O({},["foreignobject","desc","title","annotation-xml"]),et=O({},["title","style","font","a","script"]),ee=O({},L);O(ee,D),O(ee,N);var ei=O({},_);O(ei,F);var er=function(t){var e=ta(t);e&&e.tagName||(e={namespaceURI:tJ,tagName:"template"});var r=C(t.tagName),o=C(e.tagName);return!!t1[t.namespaceURI]&&(t.namespaceURI===tZ?e.namespaceURI===tQ?"svg"===r:e.namespaceURI===tK?"svg"===r&&("annotation-xml"===o||t8[o]):!!ee[r]:t.namespaceURI===tK?e.namespaceURI===tQ?"math"===r:e.namespaceURI===tZ?"math"===r&&t7[o]:!!ei[r]:t.namespaceURI===tQ?(e.namespaceURI!==tZ||!!t7[o])&&(e.namespaceURI!==tK||!!t8[o])&&!ei[r]&&(et[r]||!ee[r]):"application/xhtml+xml"===i&&!!t1[t.namespaceURI])},eo=function(t){b(n.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){try{t.outerHTML=tc}catch(e){t.remove()}}},es=function(t,e){try{b(n.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){b(n.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!tS[t]){if(tN||t_)try{eo(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}}},en=function(t){if(tD)t="<remove></remove>"+t;else{var e,r,o=x(t,/^[\r\n\t ]+/);r=o&&o[0]}"application/xhtml+xml"===i&&tJ===tQ&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var s=th?th.createHTML(t):t;if(tJ===tQ)try{e=new te().parseFromString(s,i)}catch(t){}if(!e||!e.documentElement){e=tu.createDocument(tJ,"template",null);try{e.documentElement.innerHTML=t0?tc:s}catch(t){}}var n=e.body||e.documentElement;return(t&&r&&n.insertBefore(l.createTextNode(r),n.childNodes[0]||null),tJ===tQ)?tf.call(e,tH?"html":"body")[0]:tH?e.documentElement:n},ea=function(t){return tg.call(t.ownerDocument||t,t,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT|p.SHOW_PROCESSING_INSTRUCTION|p.SHOW_CDATA_SECTION,null,!1)},el=function(e){return"object"===t(u)?e instanceof u:e&&"object"===t(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},eh=function(t,e,i){tv[t]&&y(tv[t],function(t){t.call(n,e,i,t6)})},ec=function(t){if(eh("beforeSanitizeElements",t,null),t instanceof A&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof m)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)||M(/[\u0080-\uFFFF]/,t.nodeName))return eo(t),!0;var e,i=o(t.nodeName);if(eh("uponSanitizeElement",t,{tagName:i,allowedTags:tb}),t.hasChildNodes()&&!el(t.firstElementChild)&&(!el(t.content)||!el(t.content.firstElementChild))&&M(/<[/\w]/g,t.innerHTML)&&M(/<[/\w]/g,t.textContent)||"select"===i&&M(/<template/i,t.innerHTML)||7===t.nodeType||tI&&8===t.nodeType&&M(/<[/\w]/g,t.data))return eo(t),!0;if(!tb[i]||tR[i]){if(!tR[i]&&eu(i)&&(tE.tagNameCheck instanceof RegExp&&M(tE.tagNameCheck,i)||tE.tagNameCheck instanceof Function&&tE.tagNameCheck(i)))return!1;if(tW&&!tz[i]){var r=ta(t)||t.parentNode,s=tn(t)||t.childNodes;if(s&&r)for(var a=s.length,l=a-1;l>=0;--l)r.insertBefore(to(s[l],!0),ts(t))}return eo(t),!0}return t instanceof g&&!er(t)||("noscript"===i||"noembed"===i||"noframes"===i)&&M(/<\/no(script|embed|frames)/i,t.innerHTML)?(eo(t),!0):(tP&&3===t.nodeType&&(e=E(e=t.textContent,z," "),e=E(e,Y," "),e=E(e,G," "),t.textContent!==e&&(b(n.removed,{element:t.cloneNode()}),t.textContent=e)),eh("afterSanitizeElements",t,null),!1)},ed=function(t,e,i){if(tj&&("id"===e||"name"===e)&&(i in l||i in t4))return!1;if(tk&&!tT[e]&&M($,e));else if(tM&&M(X,e));else if(!tS[e]||tT[e]){if(!(eu(t)&&(tE.tagNameCheck instanceof RegExp&&M(tE.tagNameCheck,t)||tE.tagNameCheck instanceof Function&&tE.tagNameCheck(t))&&(tE.attributeNameCheck instanceof RegExp&&M(tE.attributeNameCheck,e)||tE.attributeNameCheck instanceof Function&&tE.attributeNameCheck(e))||"is"===e&&tE.allowCustomizedBuiltInElements&&(tE.tagNameCheck instanceof RegExp&&M(tE.tagNameCheck,i)||tE.tagNameCheck instanceof Function&&tE.tagNameCheck(i))))return!1}else if(tX[e]);else if(M(tw,E(i,Z,"")));else if(("src"===e||"xlink:href"===e||"href"===e)&&"script"!==t&&0===R(i,"data:")&&tG[t]);else if(tA&&!M(K,E(i,Z,"")));else if(i)return!1;return!0},eu=function(t){return"annotation-xml"!==t&&x(t,J)},eg=function(e){eh("beforeSanitizeAttributes",e,null);var i,r,s,a,l=e.attributes;if(l){var h={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:tS};for(a=l.length;a--;){var c=(i=l[a]).name,d=i.namespaceURI;if(r="value"===c?i.value:T(i.value),s=o(c),h.attrName=s,h.attrValue=r,h.keepAttr=!0,h.forceKeepAttr=void 0,eh("uponSanitizeAttribute",e,h),r=h.attrValue,!h.forceKeepAttr&&(es(c,e),h.keepAttr)){if(!tO&&M(/\/>/i,r)){es(c,e);continue}tP&&(r=E(r,z," "),r=E(r,Y," "),r=E(r,G," "));var u=o(e.nodeName);if(ed(u,s,r)){if(tB&&("id"===s||"name"===s)&&(es(c,e),r="user-content-"+r),th&&"object"===t(ti)&&"function"==typeof ti.getAttributeType){if(d);else switch(ti.getAttributeType(u,s)){case"TrustedHTML":r=th.createHTML(r);break;case"TrustedScriptURL":r=th.createScriptURL(r)}}try{d?e.setAttributeNS(d,c,r):e.setAttribute(c,r),w(n.removed)}catch(t){}}}}eh("afterSanitizeAttributes",e,null)}},ep=function t(e){var i,r=ea(e);for(eh("beforeSanitizeShadowDOM",e,null);i=r.nextNode();)eh("uponSanitizeShadowNode",i,null),ec(i)||(i.content instanceof h&&t(i.content),eg(i));eh("afterSanitizeShadowDOM",e,null)};return n.sanitize=function(e){var i,r,l,c,d,g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((t0=!e)&&(e="<!-->"),"string"!=typeof e&&!el(e)){if("function"==typeof e.toString){if("string"!=typeof(e=e.toString()))throw k("dirty is not a string, aborting")}else throw k("toString is not a function")}if(!n.isSupported){if("object"===t(s.toStaticHTML)||"function"==typeof s.toStaticHTML){if("string"==typeof e)return s.toStaticHTML(e);if(el(e))return s.toStaticHTML(e.outerHTML)}return e}if(tL||t9(g),n.removed=[],"string"==typeof e&&(tV=!1),tV){if(e.nodeName){var p=o(e.nodeName);if(!tb[p]||tR[p])throw k("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof u)1===(r=(i=en("<!---->")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===r.nodeName?i=r:"HTML"===r.nodeName?i=r:i.appendChild(r);else{if(!tN&&!tP&&!tH&&-1===e.indexOf("<"))return th&&tF?th.createHTML(e):e;if(!(i=en(e)))return tN?null:tF?tc:""}i&&tD&&eo(i.firstChild);for(var f=ea(tV?e:i);l=f.nextNode();)3===l.nodeType&&l===c||ec(l)||(l.content instanceof h&&ep(l.content),eg(l),c=l);if(c=null,tV)return e;if(tN){if(t_)for(d=tp.call(i.ownerDocument);i.firstChild;)d.appendChild(i.firstChild);else d=i;return(tS.shadowroot||tS.shadowrootmod)&&(d=tm.call(a,d,!0)),d}var m=tH?i.outerHTML:i.innerHTML;return tH&&tb["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&M(Q,i.ownerDocument.doctype.name)&&(m="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+m),tP&&(m=E(m,z," "),m=E(m,Y," "),m=E(m,G," ")),th&&tF?th.createHTML(m):m},n.setConfig=function(t){t9(t),tL=!0},n.clearConfig=function(){t6=null,tL=!1},n.isValidAttribute=function(t,e,i){return t6||t9({}),ed(o(t),o(e),i)},n.addHook=function(t,e){"function"==typeof e&&(tv[t]=tv[t]||[],b(tv[t],e))},n.removeHook=function(t){if(tv[t])return w(tv[t])},n.removeHooks=function(t){tv[t]&&(tv[t]=[])},n.removeAllHooks=function(){tv={}},n}()},t.exports=i()}),ta("gnaTS",function(t,e){s(t.exports,"stringify",()=>n),s(t.exports,"isDefined",()=>a),s(t.exports,"isUndefined",()=>l),s(t.exports,"isEmpty",()=>h),s(t.exports,"isRegExp",()=>c),s(t.exports,"_injectProductInfo",()=>x);var i=tn("45fvw"),r=tn("iCsRe");function n(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString()}return e}function a(t){return void 0!==t}function l(t){return void 0===t}function h(t){return null===t||""===t||l(t)}function c(t){return"[object RegExp]"===Object.prototype.toString.call(t)}let d="length",u=t=>parseInt(t,16),g=t=>parseInt(t,10),p=(t,e,i)=>t.substr(e,i),f=t=>t.codePointAt(0)-65,m=t=>`${t}`.replace(/\-/g,""),y=t=>u(p(m(t),u("12"),f("F")))/(u(p(m(t),f("B"),~~![][d]))||9),w=()=>"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host),b=!1,C={invalid:()=>(0,r.toSingleLine)`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:i}=t;return(0,r.toSingleLine)`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${i}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>(0,r.toSingleLine)`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},S={invalid:()=>(0,r.toSingleLine)`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:i}=t;return(0,r.toSingleLine)`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${i}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>(0,r.toSingleLine)`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function x(t,e){let r;let s=!h(t),n="string"==typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),a="14.3.0",l="invalid",c="invalid",x=function(t){let e=[][d],i=e;if(t[d]!==f("Z"))return!1;for(let e="",r="B<H4P+".split(""),o=f(r.shift());o;o=f(r.shift()||"A"))--o<""[d]?i|=(g(`${g(u(e)+(u(p(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:e=p(t,o,o?1===r[d]?9:8:6);return i===e}(t=m(t||""));if(s||n||x){if(x){let e=Math.floor(o(i)("16/04/2024","DD/MM/YYYY").toDate().getTime()/864e5),s=y(t);r=o(i)((s+1)*864e5,"x").format("MMMM DD, YYYY"),e>s?(l="expired",c="expired"):(l="valid",c="valid")}else n?(l="non_commercial",c="valid"):(l="invalid",c="invalid")}else l="missing",c="missing";if(w()&&(l="valid",c="valid"),b||"valid"===l||(C[l]({keyValidityDate:r,hotVersion:a})&&console["non_commercial"===l?"info":"warn"](C[l]({keyValidityDate:r,hotVersion:a})),b=!0),"valid"!==c&&e.parentNode&&S[c]({keyValidityDate:r,hotVersion:a})){let t=document.createElement("div");t.className="hot-display-license-info",t.innerHTML=S[c]({keyValidityDate:r,hotVersion:a}),e.parentNode.insertBefore(t,e.nextSibling)}}}),ta("iCsRe",function(t,e){s(t.exports,"toSingleLine",()=>r);var i=tn("ceXML");function r(t){for(var e=arguments.length,r=Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];return(0,i.arrayReduce)(t,(t,e,i)=>t+e.replace(/\r?\n\s*/g,"")+(r[i]?r[i]:""),"").trim()}}),ta("jlXkd",function(t,e){s(t.exports,"warn",()=>r),s(t.exports,"error",()=>o);var i=tn("gnaTS");function r(){(0,i.isDefined)(console)&&console.warn(...arguments)}function o(){(0,i.isDefined)(console)&&console.error(...arguments)}}),ta("f3221",function(t,e){s(t.exports,"isFunction",()=>o),s(t.exports,"throttle",()=>n),s(t.exports,"throttleAfterHits",()=>a),s(t.exports,"debounce",()=>l),s(t.exports,"pipe",()=>h),s(t.exports,"partial",()=>c),s(t.exports,"curry",()=>d),s(t.exports,"curryRight",()=>u),s(t.exports,"fastCall",()=>g);var i=tn("ceXML"),r=tn("gnaTS");function o(t){return"function"==typeof t}function n(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=0,r={lastCallThrottled:!0},o=null;return function(){for(var s=arguments.length,n=Array(s),a=0;a<s;a++)n[a]=arguments[a];let l=Date.now(),h=!1;r.lastCallThrottled=!0,i||(i=l,h=!0);let c=e-(l-i);return h?(r.lastCallThrottled=!1,t.apply(this,n)):(o&&clearTimeout(o),o=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,n),i=0,o=void 0},c)),r}}function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=n(t,e),o=i;function s(){for(var e=arguments.length,i=Array(e),s=0;s<e;s++)i[s]=arguments[s];return o?(o-=1,t.apply(this,i)):r.apply(this,i)}return s.clearHits=function(){o=i},s}function l(t){let e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;return function(){for(var o=arguments.length,s=Array(o),n=0;n<o;n++)s[n]=arguments[n];return r&&clearTimeout(r),r=setTimeout(()=>{e=t.apply(this,s)},i),e}}function h(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let[o,...s]=e;return function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return(0,i.arrayReduce)(s,(t,e)=>e(t),o.apply(this,e))}}function c(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return function(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return t.apply(this,i.concat(r))}}function d(t){let e=t.length;return function i(r){return function(){for(var o=arguments.length,s=Array(o),n=0;n<o;n++)s[n]=arguments[n];let a=r.concat(s);return a.length>=e?t.apply(this,a):i(a)}}([])}function u(t){let e=t.length;return function i(r){return function(){for(var o=arguments.length,s=Array(o),n=0;n<o;n++)s[n]=arguments[n];let a=r.concat(s.reverse());return a.length>=e?t.apply(this,a):i(a)}}([])}function g(t,e,i,o,s,n,a,l){return(0,r.isDefined)(l)?t.call(e,i,o,s,n,a,l):(0,r.isDefined)(a)?t.call(e,i,o,s,n,a):(0,r.isDefined)(n)?t.call(e,i,o,s,n):(0,r.isDefined)(s)?t.call(e,i,o,s):(0,r.isDefined)(o)?t.call(e,i,o):(0,r.isDefined)(i)?t.call(e,i):t.call(e)}}),ta("lSZ9A",function(t,e){s(t.exports,"default",()=>r);let i=new Map;function r(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";i.has(t)||i.set(t,new Map);let e=i.get(t);return{register:function(t,i){e.set(t,i)},getItem:function(t){return e.get(t)},hasItem:function(t){return e.has(t)},getNames:function(){return[...e.keys()]},getValues:function(){return[...e.values()]}}}}),ta("iMgTM",function(t,e){s(t.exports,"EDITOR_TYPE",()=>u),s(t.exports,"DateEditor",()=>p),tn("1C6fS");var i=tn("45fvw"),r=tn("e5bJ0"),n=tn("3BsF4"),a=tn("9PLwv"),l=tn("gFbQZ"),h=tn("hwT6B"),c=tn("bCtEl");function d(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let u="date",g="dateEditor";class p extends a.TextEditor{constructor(){super(...arguments),d(this,"defaultDateFormat","DD/MM/YYYY"),d(this,"parentDestroyed",!1),d(this,"$datePicker",null)}static get EDITOR_TYPE(){return u}init(){if("function"!=typeof o(i))throw Error("You need to include moment.js to your project.");if("function"!=typeof r.default)throw Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),(0,l.addClass)(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",t=>{(0,l.hasClass)(t.target,"pika-day")&&this.hideDatepicker(),t.stopPropagation()})}destroyElements(){let t=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}prepare(t,e,i,r,o,s){super.prepare(t,e,i,r,o,s)}open(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(t),super.open(),e.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:g})}close(){var t;this._opened=!1,null!==(t=this.$datePicker)&&void 0!==t&&t.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(g),super.close()}finishEditing(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.finishEditing(t,e)}showDatepicker(t){let e;let s=this.cellProperties.dateFormat||this.defaultDateFormat,n=this.hot.view.isMouseDown(),a=!!t&&(0,c.isFunctionKey)(t.keyCode);this.datePicker.style.display="block",this.$datePicker=new r.default(this.getDatePickerConfig()),"function"==typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(o(i)),this.$datePicker._onInputFocus=function(){},this.originalValue?(e=this.originalValue,o(i)(e,s,!0).isValid()&&this.$datePicker.setMoment(o(i)(e,s),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),a||n||this.setValue("")):this.cellProperties.defaultDate?(e=this.cellProperties.defaultDate,o(i)(e,s,!0).isValid()&&this.$datePicker.setMoment(o(i)(e,s),!0),a||n||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){let t=this.TEXTAREA,e={};this.cellProperties&&this.cellProperties.datePickerConfig&&(0,h.deepExtend)(e,this.cellProperties.datePickerConfig);let r=e.onSelect,s=e.onClose;return e.field=t,e.trigger=t,e.container=this.datePicker,e.bound=!1,e.keyboardInput=!1,e.format=e.format||this.defaultDateFormat,e.reposition=e.reposition||!1,e.isRTL=!1,e.onSelect=t=>{let e=t;isNaN(e.getTime())||(e=o(i)(e).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(e),r&&r()},e.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),s&&s()},e}refreshDimensions(t){var e;if(super.refreshDimensions(t),this.state!==n.EDITOR_STATE.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}let{rowIndexMapper:i,columnIndexMapper:r}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=null!==(e=o.getParentOverlay(this.TD))&&void 0!==e?e:this.hot.view._wt,a=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),h=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),c=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),d=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=h&&this.col>=c&&this.col<=d){let t=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+t.top+(0,l.outerHeight)(this.TD)}px`;let e=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?e+=t.right-(0,l.outerWidth)(this.datePicker):e+=t.left,this.datePickerStyle.left=`${e}px`}else this.hideDatepicker()}}}),ta("e5bJ0",function(t,e){s(t.exports,"default",()=>k);/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */let i=()=>window,r=()=>window.document,o=(t,e)=>window.setTimeout(t,e),n=function(t,e,i,r){t.addEventListener(e,i,!!r)},a=function(t,e,i,r){t.removeEventListener(e,i,!!r)},l=function(t,e){return -1!==(" "+t.className+" ").indexOf(" "+e+" ")},h=function(t,e){l(t,e)||(t.className=""===t.className?e:t.className+" "+e)},c=function(t,e){var i;t.className=(i=(" "+t.className+" ").replace(" "+e+" "," ")).trim?i.trim():i.replace(/^\s+|\s+$/g,"")},d=function(t){return/Array/.test(Object.prototype.toString.call(t))},u=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},g=function(t){let e=t.getDay();return 0===e||6===e},p=function(t,e){return[31,t%4==0&&t%100!=0||t%400==0?29:28,31,30,31,30,31,31,30,31,30,31][e]},f=function(t){u(t)&&t.setHours(0,0,0,0)},m=function(t,e){return t.getTime()===e.getTime()},y=function(t,e,i){let r,o;for(r in e)(o=void 0!==t[r])&&"object"==typeof e[r]&&null!==e[r]&&void 0===e[r].nodeName?u(e[r])?i&&(t[r]=new Date(e[r].getTime())):d(e[r])?i&&(t[r]=e[r].slice(0)):t[r]=y({},e[r],i):(i||!o)&&(t[r]=e[r]);return t},w=function(t,e,i){let o=r().createEvent("HTMLEvents");o.initEvent(e,!0,!1),o=y(o,i),t.dispatchEvent(o)},b=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},C={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},S=function(t,e,i){for(e+=t.firstDay;e>=7;)e-=7;return i?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},x=function(t){let e=[],i="false";if(t.isEmpty){if(!t.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled")}return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),i="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+i+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},E=function(t,e){t.setHours(0,0,0,0);let i=t.getDate(),r=t.getDay(),o=e-1,s=function(t){return(t+7-1)%7};t.setDate(i+o-s(r));let n=new Date(t.getFullYear(),0,e);return 1+Math.round(((t.getTime()-n.getTime())/864e5-o+s(n.getDay()))/7)},R=function(t,e,i,r,o){let s=new Date(r,i,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(s).isoWeek():E(s,o))+"</td>"},T=function(t){let e,i=[];for(t.showWeekNumber&&i.push("<th></th>"),e=0;e<7;e++)i.push('<th scope="col"><abbr title="'+S(t,e)+'">'+S(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?i.reverse():i).join("")+"</tr></thead>"},M=function(t,e,i,r,o,s){let n,a,l,h=t._o,c=i===h.minYear,u=i===h.maxYear,g='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',p,f,m=!0,y=!0;for(l=[],n=0;n<12;n++)l.push('<option value="'+(i===o?n-e:12+n-e)+'"'+(n===r?' selected="selected"':"")+(c&&n<h.minMonth||u&&n>h.maxMonth?' disabled="disabled"':"")+">"+h.i18n.months[n]+"</option>");for(p='<div class="pika-label">'+h.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",d(h.yearRange)?(n=h.yearRange[0],a=h.yearRange[1]+1):(n=i-h.yearRange,a=1+i+h.yearRange),l=[];n<a&&n<=h.maxYear;n++)n>=h.minYear&&l.push('<option value="'+n+'"'+(n===i?' selected="selected"':"")+">"+n+"</option>");return f='<div class="pika-label">'+i+h.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",h.showMonthAfterYear?g+=f+p:g+=p+f,c&&(0===r||h.minMonth>=r)&&(m=!1),u&&(11===r||h.maxMonth<=r)&&(y=!1),0===e&&(g+='<button class="pika-prev'+(m?"":" is-disabled")+'" type="button">'+h.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(g+='<button class="pika-next'+(y?"":" is-disabled")+'" type="button">'+h.i18n.nextMonth+"</button>"),g+"</div>"};function k(t){let e=this,s=e.config(t);e._onMouseDown=function(t){if(!e._v)return;let r=(t=t||i().event).target||t.srcElement;if(r){if(!l(r,"is-disabled")&&(!l(r,"pika-button")||l(r,"is-empty")||l(r.parentNode,"is-disabled")?l(r,"pika-prev")?e.prevMonth():l(r,"pika-next")&&e.nextMonth():(e.setDate(new Date(r.getAttribute("data-pika-year"),r.getAttribute("data-pika-month"),r.getAttribute("data-pika-day"))),s.bound&&o(function(){e.hide(),s.blurFieldOnSelect&&s.field&&s.field.blur()},100))),l(r,"pika-select"))e._c=!0;else{if(!t.preventDefault)return t.returnValue=!1,!1;t.preventDefault()}}},e._onChange=function(t){let r=(t=t||i().event).target||t.srcElement;r&&(l(r,"pika-select-month")?e.gotoMonth(r.value):l(r,"pika-select-year")&&e.gotoYear(r.value))},e._onKeyChange=function(t){if(t=t||i().event,e.isVisible())switch(t.keyCode){case 13:case 27:s.field&&s.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null)}},e._parseFieldValue=function(){if(s.parse)return s.parse(s.field.value,s.format);if(!this.hasMoment)return new Date(Date.parse(s.field.value));{let t=this.moment(s.field.value,s.format,s.formatStrict);return t&&t.isValid()?t.toDate():null}},e._onInputChange=function(t){let i;t.firedBy===e||(u(i=e._parseFieldValue())&&e.setDate(i),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let t=r().activeElement;do if(l(t,"pika-single"))return;while(t=t.parentNode)e._c||(e._b=o(function(){e.hide()},50)),e._c=!1},e._onClick=function(t){let r=(t=t||i().event).target||t.srcElement,o=r;if(r){!hasEventListeners&&l(r,"pika-select")&&!r.onchange&&(r.setAttribute("onchange","return;"),n(r,"change",e._onChange));do if(l(o,"pika-single")||o===s.trigger)return;while(o=o.parentNode)e._v&&r!==s.trigger&&o!==s.trigger&&e.hide()}},e.el=r().createElement("div"),e.el.className="pika-single"+(s.isRTL?" is-rtl":"")+(s.theme?" "+s.theme:""),n(e.el,"mousedown",e._onMouseDown,!0),n(e.el,"touchend",e._onMouseDown,!0),n(e.el,"change",e._onChange),s.keyboardInput&&n(r(),"keydown",e._onKeyChange),s.field&&(s.container?s.container.appendChild(e.el):s.bound?r().body.appendChild(e.el):s.field.parentNode.insertBefore(e.el,s.field.nextSibling),n(s.field,"change",e._onInputChange),s.defaultDate||(s.defaultDate=e._parseFieldValue(),s.setDefaultDate=!0));let a=s.defaultDate;u(a)?s.setDefaultDate?e.setDate(a,!0):e.gotoDate(a):e.gotoDate(new Date),s.bound?(this.hide(),e.el.className+=" is-bound",n(s.trigger,"click",e._onInputClick),n(s.trigger,"focus",e._onInputFocus),n(s.trigger,"blur",e._onInputBlur)):this.show()}k.prototype={config:function(t){this._o||(this._o=y({},C,!0));let e=y(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null;let i=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=i>4?4:i,u(e.minDate)||(e.minDate=!1),u(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),d(e.yearRange)){let t=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||t,e.yearRange[1]=parseInt(e.yearRange[1],10)||t}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||C.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return(t=t||this._o.format,u(this._d))?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return u(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",w(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),!u(t))return;let i=this._o.minDate,r=this._o.maxDate;u(i)&&t<i?t=i:u(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),f(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),w(this._o.field,"change",{firedBy:this})),e||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(u(t)){if(this.calendars){let i=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=o<i.getTime()||r.getTime()<o}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let i,r=this.getDate()||new Date,o=864e5*parseInt(e);"add"===t?i=new Date(r.valueOf()+o):"subtract"===t&&(i=new Date(r.valueOf()-o)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=b(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=b({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(f(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=C.minDate,this._o.minYear=C.minYear,this._o.minMonth=C.minMonth,this._o.startRange=C.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(f(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=C.maxDate,this._o.maxYear=C.maxYear,this._o.maxMonth=C.maxMonth,this._o.endRange=C.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,i=e.minYear,r=e.maxYear,s=e.minMonth,n=e.maxMonth,a="",l;this._y<=i&&(this._y=i,!isNaN(s)&&this._m<s&&(this._m=s)),this._y>=r&&(this._y=r,!isNaN(n)&&this._m>n&&(this._m=n));for(let t=0;t<e.numberOfMonths;t++)l="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),a+='<div class="pika-lendar">'+M(this,t,this.calendars[t].year,this.calendars[t].month,this.calendars[0].year,l)+this.render(this.calendars[t].year,this.calendars[t].month,l)+"</div>";this.el.innerHTML=a,e.bound&&"hidden"!==e.field.type&&o(function(){e.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,o,s,n,a,l,d,u,g,p;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,o=this.el.offsetHeight,s=i().innerWidth||r().documentElement.clientWidth,n=i().innerHeight||r().documentElement.clientHeight,a=r().body.scrollTop||r().documentElement.scrollTop,g=!0,p=!0,l=(u=t.getBoundingClientRect()).left+i().pageXOffset,d=u.bottom+i().pageYOffset,(this._o.reposition&&l+e>s||this._o.position.indexOf("right")>-1&&l-e+t.offsetWidth>0)&&(l=l-e+t.offsetWidth,g=!1),(this._o.reposition&&d+o>n+a||this._o.position.indexOf("top")>-1&&d-o-t.offsetHeight>0)&&(d=d-o-t.offsetHeight,p=!1),l<0&&(l=0),d<0&&(d=0),this.el.style.left=l+"px",this.el.style.top=d+"px",h(this.el,g?"left-aligned":"right-aligned"),h(this.el,p?"bottom-aligned":"top-aligned"),c(this.el,g?"right-aligned":"left-aligned"),c(this.el,p?"top-aligned":"bottom-aligned"))},render:function(t,e,i){var r,o;let s=this._o,n=new Date,a=p(t,e),l=new Date(t,e,1).getDay(),h=[],c=[];f(n),s.firstDay>0&&(l-=s.firstDay)<0&&(l+=7);let d=0===e?11:e-1,y=11===e?0:e+1,w=0===e?t-1:t,b=11===e?t+1:t,C=p(w,d),S=a+l,E=S;for(;E>7;)E-=7;S+=7-E;let M=!1;for(let i=0,p=0;i<S;i++){let f=new Date(t,e,1+(i-l)),S=!!u(this._d)&&m(f,this._d),E=m(f,n),T=-1!==s.events.indexOf(f.toDateString()),k=i<l||i>=a+l,A=1+(i-l),O=e,P=t,I=s.startRange&&m(s.startRange,f),H=s.endRange&&m(s.endRange,f),L=s.startRange&&s.endRange&&s.startRange<f&&f<s.endRange,D=s.minDate&&f<s.minDate||s.maxDate&&f>s.maxDate||s.disableWeekends&&g(f)||s.disableDayFn&&s.disableDayFn(f);k&&(i<l?(A=C+A,O=d,P=w):(A-=a,O=y,P=b));let N={day:A,month:O,year:P,hasEvent:T,isSelected:S,isToday:E,isDisabled:D,isEmpty:k,isStartRange:I,isEndRange:H,isInRange:L,showDaysInNextAndPreviousMonths:s.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:s.enableSelectionDaysInNextAndPreviousMonths};s.pickWholeWeek&&S&&(M=!0),c.push(x(N)),7==++p&&(s.showWeekNumber&&c.unshift(R(this,i-l,e,t,s.firstWeekOfYearMinDays)),h.push((r=c,o=s.isRTL,'<tr class="pika-row'+(s.pickWholeWeek?" pick-whole-week":"")+(M?" is-selected":"")+'">'+(o?r.reverse():r).join("")+"</tr>")),c=[],p=0,M=!1)}return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+i+'">'+T(s)+"<tbody>"+h.join("")+"</tbody></table>"},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),c(this.el,"is-hidden"),this._o.bound&&(n(r(),"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let t=this._v;!1!==t&&(this._o.bound&&a(r(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),h(this.el,"is-hidden"),this._v=!1,void 0!==t&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),a(this.el,"mousedown",this._onMouseDown,!0),a(this.el,"touchend",this._onMouseDown,!0),a(this.el,"change",this._onChange),t.keyboardInput&&a(r(),"keydown",this._onKeyChange),t.field&&(a(t.field,"change",this._onInputChange),t.bound&&(a(t.trigger,"click",this._onInputClick),a(t.trigger,"focus",this._onInputFocus),a(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}}}),ta("3BsF4",function(t,e){s(t.exports,"EDITOR_STATE",()=>h),s(t.exports,"SHORTCUTS_GROUP_EDITOR",()=>c),s(t.exports,"BaseEditor",()=>d),tn("1C6fS");var i=tn("gnaTS"),r=tn("hwT6B"),o=tn("aud0i"),n=tn("kdwDx"),a=tn("gFbQZ");function l(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let h=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),c="baseEditor";class d{static get EDITOR_TYPE(){return"base"}constructor(t){l(this,"hot",void 0),l(this,"state",h.VIRGIN),l(this,"_opened",!1),l(this,"_fullEditMode",!1),l(this,"_closeCallback",null),l(this,"TD",null),l(this,"row",null),l(this,"col",null),l(this,"prop",null),l(this,"originalValue",null),l(this,"cellProperties",null),this.hot=t,this.init()}_fireCallbacks(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(t,e,i,r,o,s){this.TD=r,this.row=t,this.col=e,this.prop=i,this.originalValue=o,this.cellProperties=s,this.state=h.VIRGIN}extend(){return class extends this.constructor{}}saveValue(t,e){let r,o,s,n;if(e){let t=this.hot.getSelectedLast();r=Math.max(Math.min(t[0],t[2]),0),o=Math.max(Math.min(t[1],t[3]),0),s=Math.max(t[0],t[2]),n=Math.max(t[1],t[3])}else[r,o,s,n]=[this.row,this.col,null,null];let a=this.hot.runHooks("modifyGetCellCoords",r,o);Array.isArray(a)&&([r,o]=a);let l=this.hot.getShortcutManager().getContext("editor");this.isInFullEditMode()&&l.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],{runOnlyIf:()=>(0,i.isDefined)(this.hot.getSelected()),group:c}),this.hot.populateFromArray(r,o,t,s,n,"edit")}beginEditing(t,e){if(this.state!==h.VIRGIN)return;let r=this.hot,o=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(o,s)),this.state=h.EDITING,this.isInFullEditMode()){let e="string"==typeof t?t:(0,i.stringify)(this.originalValue);this.setValue(e)}this.open(e),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(t,e,i){let r;if(i){let t=this._closeCallback;this._closeCallback=e=>{t&&t(e),i(e),this.hot.view.render()}}if(this.isWaiting())return;let s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(c),s.removeShortcutsByGroup(o.SHORTCUTS_GROUP_NAVIGATION),this.state===h.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===h.EDITING){if(t){this.cancelChanges(),this.hot.view.render();return}let i=this.getValue();r=this.cellProperties.trimWhitespace?[["string"==typeof i?String.prototype.trim.call(i||""):i]]:[[i]],this.state=h.WAITING,this.saveValue(r,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",t=>{this.state=h.FINISHED,this.discardEditor(t)}):(this.state=h.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=h.FINISHED,this.discardEditor()}discardEditor(t){this.state===h.FINISHED&&(!1===t&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=h.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=h.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===h.WAITING}getEditedCellRect(){var t;let e=this.getEditedCell();if(!e)return;let{wtOverlays:i,wtViewport:r}=this.hot.view._wt,o=this.hot.rootWindow,s=(0,a.offset)(e),n=(0,a.outerWidth)(e),l=(0,a.offset)(this.hot.rootElement),h=(0,a.outerWidth)(this.hot.rootElement),c=i.topOverlay.holder,d=i.inlineStartOverlay.holder,u=c!==o?c.scrollTop:0,g=d!==o?d.scrollLeft:0,p=o.innerWidth-l.left-h,{wtTable:f}=null!==(t=i.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt,m=f.name,y=["master","inline_start"].includes(m)?u:0,w=["master","top","bottom"].includes(m)?g:0,b=s.top===l.top?0:1,C=s.top-l.top-b-y,S=0;S=this.hot.isRtl()?o.innerWidth-s.left-n-p-1+w:s.left-l.left-1-w,["top","top_inline_start_corner"].includes(m)&&(C+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(S+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));let x=this.hot.hasColHeaders(),E=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),R=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),T=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(x&&E<=0||E===T)&&(C+=1),R<=0&&(S+=1);let M=r.rowsRenderCalculator.startPosition,k=r.columnsRenderCalculator.startPosition,A=Math.abs(i.inlineStartOverlay.getScrollPosition()),O=i.topOverlay.getScrollPosition(),P=(0,a.getScrollbarWidth)(this.hot.rootDocument),I=e.offsetTop;if(["inline_start","master"].includes(m)&&(I+=M-O),["bottom","bottom_inline_start_corner"].includes(m)){let{wtViewport:t,wtTable:e}=i.bottomOverlay.clone;I+=t.getWorkspaceHeight()-e.getHeight()-P}let H=e.offsetLeft;this.hot.isRtl()?H=(H>=0?f.getWidth()-e.offsetLeft:Math.abs(H))+(k-A-n):["top","master","bottom"].includes(m)&&(H+=k-A);let L=(0,a.getComputedStyle)(this.TD,this.hot.rootWindow),D=parseInt(L[this.hot.isRtl()?"borderRightWidth":"borderLeftWidth"],10)>0?0:1,N=parseInt(L.borderTopWidth,10)>0?0:1,_=(0,a.outerWidth)(e)+D,F=(0,a.outerHeight)(e)+N,j=(0,a.hasVerticalScrollbar)(c)?P:0,B=(0,a.hasHorizontalScrollbar)(d)?P:0,W=this.hot.view.maximumVisibleElementWidth(H)-j+D;return{top:C,start:S,height:F,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(I)-B+N,23),width:_,maxWidth:W}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){let t=this.hot.countRows(),e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}(0,r.mixin)(d,n.default)}),ta("aud0i",function(t,e){s(t.exports,"SHORTCUTS_GROUP_NAVIGATION",()=>c),s(t.exports,"default",()=>m),tn("1C6fS");var i=tn("bCtEl"),r=tn("7HxIw"),o=tn("jxqWV"),n=tn("1k8Ev"),a=tn("gnaTS");function l(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function h(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let c="editorManager.navigation";var d=new WeakSet;class u{constructor(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,d),d.add(this),l(this,"hot",void 0),l(this,"tableMeta",void 0),l(this,"selection",void 0),l(this,"eventManager",void 0),l(this,"destroyed",!1),l(this,"lock",!1),l(this,"activeEditor",void 0),l(this,"cellProperties",void 0),this.hot=t,this.tableMeta=e,this.selection=i,this.eventManager=new n.default(t),this.hot.addHook("afterDocumentKeyDown",t=>h(d,this,g).call(this,t)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",t=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",t)}),this.hot.view._wt.update("onCellDblClick",(t,e,i)=>h(d,this,p).call(this,t,e,i))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(t){this.lock||this.closeEditor(t)}getActiveEditor(){return this.activeEditor}prepareEditor(){var t;if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,t=>{t&&this.prepareEditor()});return}let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!e||e.isHeader())return;let{row:i,col:r}=e,s=this.hot.runHooks("modifyGetCellCoords",i,r),n=i,a=r;if(Array.isArray(s)&&([n,a]=s),this.cellProperties=this.hot.getCellMeta(n,a),!this.isCellEditable()){this.clearActiveEditor();return}let l=this.hot.getCell(i,r,!0);if(l){let t=this.hot.getCellEditor(this.cellProperties),e=this.hot.colToProp(a),s=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(n),a);this.activeEditor=(0,o.getEditorInstance)(t,this.hot),this.activeEditor.prepare(i,r,e,l,s,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable()){this.clearActiveEditor();return}let r=this.hot.getSelectedRangeLast(),o=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,t,e,i);if(e instanceof MouseEvent&&"boolean"!=typeof o&&(o=0===this.hot.selection.getLayerLevel()&&r.isSingle()),!1===o){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))}closeEditor(t,e,i){this.activeEditor?this.activeEditor.finishEditing(t,e,i):i&&i(!1)}closeEditorAndSaveChanges(t){this.closeEditor(!1,t)}closeEditorAndRestoreOriginalValue(t){this.closeEditor(!0,t)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){let t=this.hot.getSelectedRangeLast();if(!t)return!1;let e=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=t.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,n=o.isHidden(this.hot.toPhysicalRow(i))||s.isHidden(this.hot.toPhysicalColumn(r));return!this.cellProperties.readOnly&&!!e&&!n}moveSelectionAfterEnter(t){let e={..."function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(t):this.tableMeta.enterMoves};t.shiftKey&&(e.row=-e.row,e.col=-e.col),this.hot.selection.isMultiple()?this.selection.transformFocus(e.row,e.col):this.selection.transformStart(e.row,e.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function g(t){let e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||(0,r.isImmediatePropagationStopped)(t))return;let{keyCode:o}=t,s=(t.ctrlKey||t.metaKey)&&!t.altKey;this.activeEditor&&(!this.activeEditor||this.activeEditor.isWaiting())||(0,i.isFunctionKey)(o)||(0,i.isCtrlMetaKey)(o)||s||this.isEditorOpened()||(this.hot.getShortcutManager().getContext("editor").addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],{runOnlyIf:()=>(0,a.isDefined)(this.hot.getSelected()),group:c}),this.openEditor("",t))}function p(t,e){e.isCell()&&this.openEditor(null,t,!0)}let f=new WeakMap;u.getInstance=function(t,e,i){let r=f.get(t);return r||(r=new u(t,e,i),f.set(t,r)),r};var m=u}),ta("bCtEl",function(t,e){s(t.exports,"KEY_CODES",()=>o),s(t.exports,"isPrintableChar",()=>a),s(t.exports,"isFunctionKey",()=>l),s(t.exports,"isCtrlKey",()=>h),s(t.exports,"isCtrlMetaKey",()=>c),s(t.exports,"isKey",()=>d),tn("1hIp0");var i=tn("ceXML"),r=tn("eL8cl");let o={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:(0,r.isFirefox)()?182:174,AUDIO_MUTE:(0,r.isFirefox)()?181:173,AUDIO_UP:(0,r.isFirefox)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},n=[o.ALT,o.ARROW_DOWN,o.ARROW_LEFT,o.ARROW_RIGHT,o.ARROW_UP,o.AUDIO_DOWN,o.AUDIO_MUTE,o.AUDIO_UP,o.BACKSPACE,o.CAPS_LOCK,o.DELETE,o.END,o.ENTER,o.ESCAPE,o.F1,o.F2,o.F3,o.F4,o.F5,o.F6,o.F7,o.F8,o.F9,o.F10,o.F11,o.F12,o.F13,o.F14,o.F15,o.F16,o.F17,o.F18,o.F19,o.HOME,o.INSERT,o.MEDIA_NEXT,o.MEDIA_PLAY_PAUSE,o.MEDIA_PREV,o.MEDIA_STOP,o.NULL,o.NUM_LOCK,o.PAGE_DOWN,o.PAGE_UP,o.PAUSE,o.SCROLL_LOCK,o.SHIFT,o.TAB];function a(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function l(t){return n.includes(t)}function h(t){let e=[];return(0,r.isMacOS)()?e.push(o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX):e.push(o.CONTROL),e.includes(t)}function c(t){return[o.CONTROL,o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX].includes(t)}function d(t,e){let r=e.split("|"),s=!1;return(0,i.arrayEach)(r,e=>{if(t===o[e])return s=!0,!1}),s}}),ta("eL8cl",function(t,e){s(t.exports,"setBrowserMeta",()=>l),s(t.exports,"setPlatformMeta",()=>h),s(t.exports,"isChrome",()=>c),s(t.exports,"isChromeWebKit",()=>d),s(t.exports,"isFirefox",()=>u),s(t.exports,"isFirefoxWebKit",()=>g),s(t.exports,"isSafari",()=>p),s(t.exports,"isEdge",()=>f),s(t.exports,"isEdgeWebKit",()=>m),s(t.exports,"isMobileBrowser",()=>y),s(t.exports,"isIOS",()=>w),s(t.exports,"isIpadOS",()=>b),s(t.exports,"isWindowsOS",()=>C),s(t.exports,"isMacOS",()=>S),s(t.exports,"isLinuxOS",()=>x);var i=tn("hwT6B"),r=tn("llu1T");let o=t=>{let e={value:!1};return e.test=(i,r)=>{e.value=t(i,r)},e},n={chrome:o((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:o(t=>/CriOS/.test(t)),edge:o(t=>/Edge/.test(t)),edgeWebKit:o(t=>/EdgiOS/.test(t)),firefox:o(t=>/Firefox/.test(t)),firefoxWebKit:o(t=>/FxiOS/.test(t)),mobile:o(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:o((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},a={mac:o(t=>/^Mac/.test(t)),win:o(t=>/^Win/.test(t)),linux:o(t=>/^Linux/.test(t)),ios:o(t=>/iPhone|iPad|iPod/i.test(t))};function l(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.objectEach)(n,i=>{let{test:r}=i;r(t,e)})}function h(){let{platform:t=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.objectEach)(a,e=>{let{test:i}=e;i(t)})}function c(){return n.chrome.value}function d(){return n.chromeWebKit.value}function u(){return n.firefox.value}function g(){return n.firefoxWebKit.value}function p(){return n.safari.value}function f(){return n.edge.value}function m(){return n.edgeWebKit.value}function y(){return n.mobile.value}function w(){return a.ios.value}function b(){let{maxTouchPoints:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return t>2&&a.mac.value}function C(){return a.win.value}function S(){return a.mac.value}function x(){return a.linux.value}(0,r.isCSR)()&&(l(),h())}),ta("llu1T",function(t,e){let i;function r(t){return window.requestAnimationFrame(t)}function o(t){window.cancelAnimationFrame(t)}function n(){return"ontouchstart"in window}function a(){return"undefined"!=typeof window}function l(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i||("object"==typeof Intl?i=new Intl.Collator(t,e).compare:i="function"==typeof String.prototype.localeCompare?(t,e)=>`${t}`.localeCompare(e):(t,e)=>t===e?0:t>e?-1:1),i}s(t.exports,"requestAnimationFrame",()=>r),s(t.exports,"cancelAnimationFrame",()=>o),s(t.exports,"isTouchSupported",()=>n),s(t.exports,"isCSR",()=>a),s(t.exports,"getComparisonFunction",()=>l)}),ta("7HxIw",function(t,e){function i(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function r(t){return!1===t.isImmediatePropagationEnabled}function o(t){return 2===t.button}function n(t){return 0===t.button}function a(t,e){let i={x:t.offsetX,y:t.offsetY},r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return i;for(;r!==e;)i.x+=r.offsetLeft,i.y+=r.offsetTop,r=r.offsetParent;return i}s(t.exports,"stopImmediatePropagation",()=>i),s(t.exports,"isImmediatePropagationStopped",()=>r),s(t.exports,"isRightClick",()=>o),s(t.exports,"isLeftClick",()=>n),s(t.exports,"offsetRelativeTo",()=>a)}),ta("1k8Ev",function(t,e){s(t.exports,"default",()=>o),s(t.exports,"getListenersCounter",()=>n),tn("1C6fS"),tn("1hIp0");var i=tn("7HxIw");let r=0;var o=class{constructor(){var t,e,i;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=void 0,(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="context","string"))?i:i+"")in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e,this.context=r||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(t,e,o){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function n(t){o.call(this,function(t){let e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),(0,i.stopImmediatePropagation)(this)},t}(t))}return this.context.eventListeners.push({element:t,event:e,callback:o,callbackProxy:n,options:s,eventManager:this}),t.addEventListener(e,n,s),r+=1,()=>{this.removeEventListener(t,e,o)}}removeEventListener(t,e,i){let o,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=this.context.eventListeners.length;for(;n;)if(n-=1,(o=this.context.eventListeners[n]).event===e&&o.element===t){if(i&&i!==o.callback||s&&o.eventManager!==this)continue;this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),r-=1}}clearEvents(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let e=this.context.eventListeners.length;for(;e;){e-=1;let i=this.context.eventListeners[e];t&&i.eventManager!==this||(this.context.eventListeners.splice(e,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),r-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(t,e){let i,r=t.document,o=t;r||(o=(r=t.ownerDocument?t.ownerDocument:t).defaultView);let s={bubbles:!0,cancelable:"mousemove"!==e,view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};r.createEvent?(i=r.createEvent("MouseEvents")).initMouseEvent(e,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,s.relatedTarget||r.body.parentNode):i=r.createEventObject(),t.dispatchEvent?t.dispatchEvent(i):t.fireEvent(`on${e}`,i)}};function n(){return r}}),ta("kdwDx",function(t,e){s(t.exports,"default",()=>n),tn("1hIp0");var i=tn("ceXML"),r=tn("hwT6B");let o={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){(0,i.arrayEach)(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){(0,r.objectEach)(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};(0,r.defineGetter)(o,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var n=o}),ta("gFbQZ",function(t,e){let i;s(t.exports,"getParent",()=>n),s(t.exports,"isThisHotChild",()=>a),s(t.exports,"getFrameElement",()=>l),s(t.exports,"getParentWindow",()=>h),s(t.exports,"hasAccessToParentWindow",()=>c),s(t.exports,"closest",()=>d),s(t.exports,"closestDown",()=>u),s(t.exports,"isChildOf",()=>g),s(t.exports,"index",()=>p),s(t.exports,"overlayContainsElement",()=>f),s(t.exports,"hasClass",()=>w),s(t.exports,"addClass",()=>b),s(t.exports,"removeClass",()=>C),s(t.exports,"setAttribute",()=>S),s(t.exports,"removeAttribute",()=>x),s(t.exports,"removeTextNodes",()=>function t(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){let i=e.childNodes;for(let e=i.length-1;e>=0;e--)t(i[e])}}),s(t.exports,"empty",()=>E),s(t.exports,"HTML_CHARACTERS",()=>R),s(t.exports,"fastInnerHTML",()=>T),s(t.exports,"fastInnerText",()=>M),s(t.exports,"isVisible",()=>function t(e){let i=e.ownerDocument.documentElement,r=e;for(;r!==i;){if(null===r)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(!r.host)return!1;if(r.host.impl)return t(r.host.impl);if(r.host)return t(r.host);throw Error("Lost in Web Components world")}if("none"===j(r).display)return!1;r=r.parentNode}return!0}),s(t.exports,"getComputedStyle",()=>j),s(t.exports,"offset",()=>k),s(t.exports,"getWindowScrollTop",()=>A),s(t.exports,"getWindowScrollLeft",()=>O),s(t.exports,"getScrollTop",()=>P),s(t.exports,"getScrollLeft",()=>I),s(t.exports,"getScrollableElement",()=>H),s(t.exports,"getMaximumScrollTop",()=>L),s(t.exports,"getMaximumScrollLeft",()=>D),s(t.exports,"getTrimmingContainer",()=>N),s(t.exports,"getStyle",()=>_),s(t.exports,"matchesCSSRules",()=>F),s(t.exports,"outerWidth",()=>B),s(t.exports,"outerHeight",()=>W),s(t.exports,"innerHeight",()=>V),s(t.exports,"innerWidth",()=>U),s(t.exports,"addEvent",()=>z),s(t.exports,"removeEvent",()=>Y),s(t.exports,"getCaretPosition",()=>G),s(t.exports,"getSelectionEndPosition",()=>$),s(t.exports,"getSelectionText",()=>X),s(t.exports,"clearTextSelection",()=>q),s(t.exports,"setCaretPosition",()=>K),s(t.exports,"getScrollbarWidth",()=>Z),s(t.exports,"hasVerticalScrollbar",()=>Q),s(t.exports,"hasHorizontalScrollbar",()=>J),s(t.exports,"setOverlayPosition",()=>tt),s(t.exports,"getCssTransform",()=>te),s(t.exports,"resetCssTransform",()=>ti),s(t.exports,"isInput",()=>tr),s(t.exports,"isOutsideInput",()=>to),s(t.exports,"selectElementIfAllowed",()=>ts),s(t.exports,"isDetached",()=>ta),s(t.exports,"observeVisibilityChangeOnce",()=>tl),s(t.exports,"makeElementContentEditableAndSelectItsContent",()=>th),s(t.exports,"removeContentEditableFromElementAndDeselect",()=>tc),s(t.exports,"runWithSelectedContendEditableElement",()=>td),tn("1C6fS"),tn("1hIp0");var r=tn("bO142"),o=tn("4Pbrh");function n(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=-1,r=null,o=t;for(;null!==o;){if(i===e){r=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(i+=1,o=o.parentNode)}return r}function a(t,e){let i=t.closest(".handsontable");return!!i&&(i.parentNode===e||i===e)}function l(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function h(t){return l(t)&&t.parent}function c(t){return!!Object.getPrototypeOf(t.parent)}function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:o}=Node,s=t;for(;null!=s&&s!==i;){let{nodeType:t,nodeName:i}=s;if(t===r&&(e.includes(i)||e.includes(s)))return s;let{host:n}=s;s=n&&t===o?n:s.parentNode}return null}function u(t,e,i){let r=[],o=t;for(;o&&(o=d(o,e,i))&&(!i||i.contains(o));)r.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;let s=r.length;return s?r[s-1]:null}function g(t,e){let i=t.parentNode,r=[];for("string"==typeof e?r=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);null!==i;){if(r.indexOf(i)>-1)return!0;i=i.parentNode}return!1}function p(t){let e=0,i=t;if(i.previousSibling)for(;i=i.previousSibling;)e+=1;return e}function f(t,e,i){let r=i.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function m(t){return t&&t.length?t.filter(t=>!!t):[]}function y(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];let i=[],r=[];return r.push(...t.filter(t=>{let r=t instanceof RegExp;return r&&e&&i.push(t),!r})),e?{regexFree:r,regexes:i}:r}function w(t,e){return void 0!==t.classList&&"string"==typeof e&&""!==e&&t.classList.contains(e)}function b(t,e){"string"==typeof e&&(e=e.split(" ")),(e=m(e)).length>0&&t.classList.add(...e)}function C(t,e){"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:i,regexes:r}=y(e,!0);(i=m(i)).length>0&&t.classList.remove(...i),r.forEach(e=>{t.classList.forEach(i=>{e.test(i)&&t.classList.remove(i)})})}function S(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,i]]),e.forEach(e=>{Array.isArray(e)&&""!==e[0]&&t.setAttribute(...e)})}function x(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:i,regexes:r}=y(e,!0);i.forEach(e=>{""!==e&&t.removeAttribute(e)}),r.forEach(e=>{t.getAttributeNames().forEach(i=>{e.test(i)&&t.removeAttribute(i)})})}function E(t){let e;for(;e=t.lastChild;)t.removeChild(e)}let R=/(<(.*)>|&(.*);)/;function T(t,e){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];R.test(e)?t.innerHTML=i?(0,r.sanitize)(e):e:M(t,e)}function M(t,e){let i=t.firstChild;i&&3===i.nodeType&&null===i.nextSibling?i.textContent=e:(E(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function k(t){let e,i,r;let o=t.ownerDocument,s=o.defaultView,n=o.documentElement,a=t;for(e=a.offsetLeft,i=a.offsetTop,r=a;(a=a.offsetParent)&&a!==o.body&&("offsetLeft"in a);)e+=a.offsetLeft,i+=a.offsetTop,r=a;return r&&"fixed"===r.style.position&&(e+=s.pageXOffset||n.scrollLeft,i+=s.pageYOffset||n.scrollTop),{left:e,top:i}}function A(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollY}function O(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollX}function P(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?A(e):t.scrollTop}function I(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?O(e):t.scrollLeft}function H(t){let e=t.ownerDocument,i=e?e.defaultView:void 0;e||(i=(e=t.document?t.document:t).defaultView);let r=["auto","scroll"],o=t.parentNode;for(;o&&o.style&&e.body!==o;){let{overflow:t,overflowX:e,overflowY:s}=o.style;if([t,e,s].includes("scroll")||({overflow:t,overflowX:e,overflowY:s}=i.getComputedStyle(o),r.includes(t)||r.includes(e)||r.includes(s))||o.clientHeight<=o.scrollHeight+1&&(r.includes(s)||r.includes(t))||o.clientWidth<=o.scrollWidth+1&&(r.includes(e)||r.includes(t)))return o;o=o.parentNode}return i}function L(t){return t.scrollHeight-t.clientHeight}function D(t){return t.scrollWidth-t.clientWidth}function N(t){let e=t.ownerDocument,i=e.defaultView,r=t.parentNode;for(;r&&r.style&&e.body!==r;){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;let t=j(r,i),e=["scroll","hidden","auto"],o=t.getPropertyValue("overflow"),s=t.getPropertyValue("overflow-y"),n=t.getPropertyValue("overflow-x");if(e.includes(o)||e.includes(s)||e.includes(n))return r;r=r.parentNode}return i}function _(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!t)return;if(t===i)return"width"===e?`${i.innerWidth}px`:"height"===e?`${i.innerHeight}px`:void 0;let r=t.style[e];if(""!==r&&void 0!==r)return r;let o=j(t,i);if(""!==o[e]&&void 0!==o[e])return o[e]}function F(t,e){let{selectorText:i}=e,r=!1;return e.type===CSSRule.STYLE_RULE&&i&&(t.msMatchesSelector?r=t.msMatchesSelector(i):t.matches&&(r=t.matches(i))),r}function j(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function B(t){return t.offsetWidth}function W(t){return t.offsetHeight}function V(t){return t.clientHeight||t.innerHeight}function U(t){return t.clientWidth||t.innerWidth}function z(t,e,i){t.addEventListener(e,i,!1)}function Y(t,e,i){t.removeEventListener(e,i,!1)}function G(t){return t.selectionStart?t.selectionStart:0}function $(t){return t.selectionEnd?t.selectionEnd:0}function X(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.document,i="";return t.getSelection?i=t.getSelection().toString():e.selection&&"Control"!==e.selection.type&&(i=e.selection.createRange().text),i}function q(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function K(t,e,i){if(void 0===i&&(i=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,i)}catch(s){let r=t.parentNode,o=r.style.display;r.style.display="block",t.setSelectionRange(e,i),r.style.display=o}}}function Z(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===i&&(i=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";let i=t.createElement("div");i.style.boxSizing="content-box",i.style.height="150px",i.style.left="0px",i.style.overflow="hidden",i.style.position="absolute",i.style.top="0px",i.style.width="200px",i.style.visibility="hidden",i.appendChild(e),(t.body||t.documentElement).appendChild(i);let r=e.offsetWidth;i.style.overflow="scroll";let o=e.offsetWidth;return r===o&&(o=i.clientWidth),(t.body||t.documentElement).removeChild(i),r-o}(t)),i}function Q(t){return t.offsetWidth!==t.clientWidth}function J(t){return t.offsetHeight!==t.clientHeight}function tt(t,e,i){t.style.transform=`translate3d(${e},${i},0)`}function te(t){let e;return t.style.transform&&""!==(e=t.style.transform)?["transform",e]:-1}function ti(t){t.style.transform&&""!==t.style.transform&&(t.style.transform="")}function tr(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function to(t){return tr(t)&&!1===t.hasAttribute("data-hot-input")}function ts(t){to(t.ownerDocument.activeElement)||t.select()}function ta(t){return!t.parentNode}function tl(t,e){new IntersectionObserver((i,r)=>{i.forEach(i=>{i.isIntersecting&&null!==t.offsetParent&&(e(),r.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function th(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t.ownerDocument,s=r.createRange(),n=r.defaultView.getSelection();S(t,"contenteditable",!0),i&&S(t,...(0,o.A11Y_HIDDEN)()),e&&b(t,"invisibleSelection"),s.selectNodeContents(t),n.removeAllRanges(),n.addRange(s)}function tc(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),i.removeAllRanges(),e&&C(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function td(t,e){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];th(t,i),e(),tc(t,i)}}),ta("4Pbrh",function(t,e){s(t.exports,"A11Y_TABINDEX",()=>i),s(t.exports,"A11Y_TREEGRID",()=>r),s(t.exports,"A11Y_PRESENTATION",()=>o),s(t.exports,"A11Y_GRIDCELL",()=>n),s(t.exports,"A11Y_ROWHEADER",()=>a),s(t.exports,"A11Y_ROWGROUP",()=>l),s(t.exports,"A11Y_COLUMNHEADER",()=>h),s(t.exports,"A11Y_ROW",()=>c),s(t.exports,"A11Y_MENU",()=>d),s(t.exports,"A11Y_MENU_ITEM",()=>u),s(t.exports,"A11Y_COMBOBOX",()=>g),s(t.exports,"A11Y_LISTBOX",()=>p),s(t.exports,"A11Y_OPTION",()=>f),s(t.exports,"A11Y_CHECKBOX",()=>m),s(t.exports,"A11Y_SCOPE_COL",()=>y),s(t.exports,"A11Y_SCOPE_ROW",()=>w),s(t.exports,"A11Y_TEXT",()=>b),s(t.exports,"A11Y_LABEL",()=>C),s(t.exports,"A11Y_HIDDEN",()=>S),s(t.exports,"A11Y_DISABLED",()=>x),s(t.exports,"A11Y_MULTISELECTABLE",()=>E),s(t.exports,"A11Y_HASPOPUP",()=>R),s(t.exports,"A11Y_ROWCOUNT",()=>T),s(t.exports,"A11Y_COLCOUNT",()=>M),s(t.exports,"A11Y_ROWINDEX",()=>k),s(t.exports,"A11Y_COLINDEX",()=>A),s(t.exports,"A11Y_EXPANDED",()=>O),s(t.exports,"A11Y_SORT",()=>P),s(t.exports,"A11Y_READONLY",()=>I),s(t.exports,"A11Y_INVALID",()=>H),s(t.exports,"A11Y_CHECKED",()=>L),s(t.exports,"A11Y_SELECTED",()=>D),s(t.exports,"A11Y_AUTOCOMPLETE",()=>N),s(t.exports,"A11Y_CONTROLS",()=>_),s(t.exports,"A11Y_ACTIVEDESCENDANT",()=>F),s(t.exports,"A11Y_LIVE",()=>j),s(t.exports,"A11Y_RELEVANT",()=>B),s(t.exports,"A11Y_SETSIZE",()=>W),s(t.exports,"A11Y_POSINSET",()=>V);let i=t=>["tabindex",t],r=()=>["role","treegrid"],o=()=>["role","presentation"],n=()=>["role","gridcell"],a=()=>["role","rowheader"],l=()=>["role","rowgroup"],h=()=>["role","columnheader"],c=()=>["role","row"],d=()=>["role","menu"],u=()=>["role","menuitem"],g=()=>["role","combobox"],p=()=>["role","listbox"],f=()=>["role","option"],m=()=>["role","checkbox"],y=()=>["scope","col"],w=()=>["scope","row"],b=()=>["type","text"],C=t=>["aria-label",t],S=()=>["aria-hidden","true"],x=()=>["aria-disabled","true"],E=()=>["aria-multiselectable","true"],R=t=>["aria-haspopup",t],T=t=>["aria-rowcount",t],M=t=>["aria-colcount",t],k=t=>["aria-rowindex",t],A=t=>["aria-colindex",t],O=t=>["aria-expanded",t],P=t=>["aria-sort",t],I=()=>["aria-readonly","true"],H=()=>["aria-invalid","true"],L=t=>["aria-checked",t],D=()=>["aria-selected","true"],N=()=>["aria-autocomplete","list"],_=t=>["aria-controls",t],F=t=>["aria-activedescendant",t],j=t=>["aria-live",t],B=t=>["aria-relevant",t],W=t=>["aria-setsize",t],V=t=>["aria-posinset",t]}),ta("9PLwv",function(t,e){s(t.exports,"TextEditor",()=>m),tn("1C6fS");var i=tn("3BsF4"),r=tn("1k8Ev"),o=tn("eL8cl"),n=tn("gFbQZ"),a=tn("guO5N"),l=tn("f64HE"),h=tn("gnaTS"),c=tn("aud0i"),i=tn("3BsF4"),d=tn("1yccg"),u=tn("4Pbrh");function g(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let p="ht_editor_hidden",f="textEditor";class m extends i.BaseEditor{static get EDITOR_TYPE(){return"text"}constructor(t){super(t),g(this,"eventManager",new r.default(this)),g(this,"autoResize",(0,l.createInputElementResizer)(this.hot.rootDocument)),g(this,"TEXTAREA",void 0),g(this,"textareaStyle",void 0),g(this,"TEXTAREA_PARENT",void 0),g(this,"textareaParentStyle",void 0),g(this,"layerClass",void 0),this.eventManager=new r.default(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(t){this.TEXTAREA.value=t}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),(0,n.isThisHotChild)(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(t,e,r,o,s,n){let a=this.state;if(super.prepare(t,e,r,o,s,n),!n.readOnly){this.refreshDimensions(!0);let{allowInvalid:t}=n;t&&(this.TEXTAREA.value=""),a!==i.EDITOR_STATE.FINISHED&&this.hideEditableElement()}}beginEditing(t,e){this.state===i.EDITOR_STATE.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(t,e))}focus(){this.TEXTAREA.select(),(0,n.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){let{rootDocument:t}=this.hot;this.TEXTAREA=t.createElement("TEXTAREA"),(0,n.setAttribute)(this.TEXTAREA,[["data-hot-input",""],(0,u.A11Y_TABINDEX)(-1)]),this.hot.getSettings().ariaTags&&(0,n.setAttribute)(this.TEXTAREA,[(0,u.A11Y_HIDDEN)()]),(0,n.addClass)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),(0,n.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder"),(0,n.hasClass)(this.TEXTAREA_PARENT,this.layerClass)&&(0,n.removeClass)(this.TEXTAREA_PARENT,this.layerClass),(0,n.addClass)(this.TEXTAREA_PARENT,p),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){(0,o.isEdge)()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",(0,n.removeClass)(this.TEXTAREA_PARENT,this.layerClass),(0,n.addClass)(this.TEXTAREA_PARENT,p)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";let t=this.TEXTAREA_PARENT.childNodes,e=!1;(0,a.rangeEach)(t.length-1,i=>{let r=t[i];if((0,n.hasClass)(r,"handsontableEditor"))return e=!0,!1}),(0,n.hasClass)(this.TEXTAREA_PARENT,p)&&(0,n.removeClass)(this.TEXTAREA_PARENT,p),e?this.layerClass="ht_editor_visible":this.layerClass=this.getEditedCellsLayerClass(),(0,n.addClass)(this.TEXTAREA_PARENT,this.layerClass)}refreshValue(){let t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==i.EDITOR_STATE.EDITING&&!t)return;if(this.TD=this.getEditedCell(),!this.TD){t||this.close();return}let{top:e,start:r,width:o,maxWidth:s,height:a,maxHeight:l}=this.getEditedCellRect();this.textareaParentStyle.top=`${e}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();let h=(0,n.getComputedStyle)(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;let c=(0,n.getComputedStyle)(this.TEXTAREA),d=parseInt(c.paddingLeft,10)+parseInt(c.paddingRight,10),u=parseInt(c.paddingTop,10)+parseInt(c.paddingBottom,10),g=s-d,p=l-u;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(o-d,g),minHeight:Math.min(a-u,p),maxWidth:g,maxHeight:p},!0)}bindEvents(){(0,o.isIOS)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===i.EDITOR_STATE.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===i.EDITOR_STATE.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){let t=this.hot.getShortcutManager(),e=t.getContext("editor"),i=t.getContext("grid"),r=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:i,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:t=>!this.hot.selection.isMultiple()&&!t.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(t,e)=>{let[i]=e;(0,d.updateCaretPosition)(i,this.TEXTAREA)}},{keys:[["End"]],callback:(t,e)=>{let[i]=e;(0,d.updateCaretPosition)(i,this.TEXTAREA)}}],{runOnlyIf:()=>(0,h.isDefined)(this.hot.getSelected()),group:f})}unregisterShortcuts(){let t=this.hot.getShortcutManager().getContext("editor");t.removeShortcutsByGroup(c.SHORTCUTS_GROUP_NAVIGATION),t.removeShortcutsByGroup(f),t.removeShortcutsByGroup(i.SHORTCUTS_GROUP_EDITOR)}}}),ta("guO5N",function(t,e){function i(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=typeof t;if("number"===i)return!isNaN(t)&&isFinite(t);if("string"===i){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);let i=Array.from(new Set([".",...e])).map(t=>`\\${t}`).join("|");return RegExp(`^[+-]?\\s*(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}return"object"===i&&!!t&&"number"==typeof t.valueOf()&&!(t instanceof Date)}function r(t){return i(t,[","])}function o(t,e,i){let r=-1;for("function"==typeof e?(i=e,e=t):r=t-1;++r<=e&&!1!==i(r););}function n(t,e,i){let r=t+1;for("function"==typeof e&&(i=e,e=0);--r>=e&&!1!==i(r););}function a(t,e){return parseInt(t*(e=isNaN(e=parseInt(e.toString().replace("%",""),10))?0:e)/100,10)}function l(t,e,i){return Math.min(t,e)===t?e:Math.max(t,i)===t?i:t}s(t.exports,"isNumeric",()=>i),s(t.exports,"isNumericLike",()=>r),s(t.exports,"rangeEach",()=>o),s(t.exports,"rangeEachReverse",()=>n),s(t.exports,"valueAccordingPercent",()=>a),s(t.exports,"clamp",()=>l)}),ta("f64HE",function(t,e){function i(t,e,i){t.addEventListener(e,i,!1)}function r(t,e,i){t.removeEventListener(e,i,!1)}function o(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function n(t){let e;let s={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,a=t.createTextNode(""),l=t.createElement("span");function h(){a.textContent=e.value,l.style.position="absolute",l.style.fontSize=o(e).fontSize,l.style.fontFamily=o(e).fontFamily,l.style.whiteSpace="pre",n.appendChild(l);let t=l.clientWidth+2;n.removeChild(l);let i=e.style;i.height=`${s.minHeight}px`,s.minWidth>t?i.width=`${s.minWidth}px`:t>s.maxWidth?i.width=`${s.maxWidth}px`:i.width=`${t}px`;let r=e.scrollHeight?e.scrollHeight-1:0;s.minHeight>r?i.height=`${s.minHeight}px`:s.maxHeight<r?(i.height=`${s.maxHeight}px`,i.overflowY="visible"):i.height=`${r}px`}function c(){t.defaultView.setTimeout(h,0)}return{init:function(t,r){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=t,function(t){if(t&&t.minHeight){if("inherit"===t.minHeight)s.minHeight=e.clientHeight;else{let e=parseInt(t.minHeight,10);isNaN(e)||(s.minHeight=e)}}if(t&&t.maxHeight){if("inherit"===t.maxHeight)s.maxHeight=e.clientHeight;else{let e=parseInt(t.maxHeight,10);isNaN(e)||(s.maxHeight=e)}}if(t&&t.minWidth){if("inherit"===t.minWidth)s.minWidth=e.clientWidth;else{let e=parseInt(t.minWidth,10);isNaN(e)||(s.minWidth=e)}}if(t&&t.maxWidth){if("inherit"===t.maxWidth)s.maxWidth=e.clientWidth;else{let e=parseInt(t.maxWidth,10);isNaN(e)||(s.maxWidth=e)}}l.firstChild||(l.className="autoResize",l.style.display="inline-block",l.appendChild(a))}(r),"TEXTAREA"===e.nodeName&&(e.style.resize="none",e.style.height=`${s.minHeight}px`,e.style.minWidth=`${s.minWidth}px`,e.style.maxWidth=`${s.maxWidth}px`,e.style.overflowY="hidden"),o&&(i(e,"input",h),i(e,"keydown",c)),h()},resize:h,unObserve(){r(e,"input",h),r(e,"keydown",c)}}}s(t.exports,"createInputElementResizer",()=>n)}),ta("1yccg",function(t,e){s(t.exports,"updateCaretPosition",()=>r);var i=tn("gFbQZ");function r(t,e){let r=(0,i.getCaretPosition)(e),o=e.value.split("\n"),s=r,n=0;for(let e=0;e<o.length;e++){let i=o[e];0!==e&&(n+=o[e-1].length+1);let a=n+i.length;if("home"===t?s=n:"end"===t&&(s=a),r<=a)break}(0,i.setCaretPosition)(e,s)}}),ta("7cVHX",function(t,e){s(t.exports,"getNormalizedDate",()=>i);function i(t){let e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}}),tn("1C6fS"),tn("1hIp0");var tl=tn("hmx0d"),th=tn("7mb70"),tc={},th=tn("7mb70"),td=tn("5dW2a"),tu={},tg={},tp=tn("faIBy"),tf=tn("5Okwt");tg=function(t){if("Function"===tp(t))return tf(t)};var tm=tn("eXHxq"),ty=tn("gcG3g"),tv=tg(tg.bind);tu=function(t,e){return tm(t),void 0===e?t:ty?tv(t,e):function(){return t.apply(e,arguments)}};var tw=tn("9GTLg"),tb=tn("2HOcD"),tC=tn("8lFU3"),tS={};tS=tn("eaZdY")("document","documentElement");var tx=tn("BsNAl"),tE=tn("1RN1j"),tR={},tT=TypeError;tR=function(t,e){if(t<e)throw new tT("Not enough arguments");return t};var tM={},tk=tn("6hv4b");tM=/(?:ipad|iphone|ipod).*applewebkit/i.test(tk);var tA={},th=tn("7mb70"),tp=tn("faIBy");tA="process"===tp(th.process);var tO=th.setImmediate,tP=th.clearImmediate,tI=th.process,tH=th.Dispatch,tL=th.Function,tD=th.MessageChannel,tN=th.String,t_=0,tF={},tj="onreadystatechange";tC(function(){z=th.location});var tB=function(t){if(tb(tF,t)){var e=tF[t];delete tF[t],e()}},tW=function(t){return function(){tB(t)}},tV=function(t){tB(t.data)},tU=function(t){th.postMessage(tN(t),z.protocol+"//"+z.host)};tO&&tP||(tO=function(t){tR(arguments.length,1);var e=tw(t)?t:tL(t),i=tx(arguments,1);return tF[++t_]=function(){td(e,void 0,i)},Y(t_),t_},tP=function(t){delete tF[t]},tA?Y=function(t){tI.nextTick(tW(t))}:tH&&tH.now?Y=function(t){tH.now(tW(t))}:tD&&!tM?($=(G=new tD).port2,G.port1.onmessage=tV,Y=tu($.postMessage,$)):th.addEventListener&&tw(th.postMessage)&&!th.importScripts&&z&&"file:"!==z.protocol&&!tC(tU)?(Y=tU,th.addEventListener("message",tV,!1)):Y=tj in tE("script")?function(t){tS.appendChild(tE("script"))[tj]=function(){tS.removeChild(this),tB(t)}}:function(t){setTimeout(tW(t),0)});var tz=(tc={set:tO,clear:tP}).clear;tl({global:!0,bind:!0,enumerable:!0,forced:th.clearImmediate!==tz},{clearImmediate:tz});var tl=tn("hmx0d"),th=tn("7mb70"),tY=tc.set,tG={},th=tn("7mb70"),td=tn("5dW2a"),tw=tn("9GTLg"),t$={};t$="function"==typeof Bun&&Bun&&"string"==typeof Bun.version;var tk=tn("6hv4b"),tx=tn("BsNAl"),tX=th.Function,tq=/MSIE .\./.test(tk)||t$&&((A=th.Bun.version.split(".")).length<3||"0"===A[0]&&(A[1]<3||"3"===A[1]&&"0"===A[2]));tG=function(t,e){var i=e?2:1;return tq?function(r,o){var s=tR(arguments.length,1)>i,n=tw(r)?r:tX(r),a=s?tx(arguments,i):[],l=s?function(){td(n,this,a)}:n;return e?t(l,o):t(l)}:t};var tK=th.setImmediate?tG(tY,!1):tY;tl({global:!0,bind:!0,enumerable:!0,forced:th.setImmediate!==tK},{setImmediate:tK});var tZ=tn("gFbQZ"),tQ=tn("f3221"),tJ=tn("gnaTS"),t0=tn("eL8cl"),t1=tn("aud0i"),t2=tn("1k8Ev"),t3=tn("hwT6B");tn("1C6fS");var t6=tn("jlXkd"),tZ=tn("gFbQZ"),tQ=tn("f3221");function t4(t,e,i){t5(t,e),e.set(t,i)}function t5(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function t9(t,e){return t.get(t7(t,e))}function t8(t,e,i){return t.set(t7(t,e),i),i}function t7(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const et=Object.freeze({CELL:"cell",MIXED:"mixed"});var ee=new WeakMap,ei=new WeakMap,er=new WeakMap,eo=new WeakMap,es=new WeakMap,en=new WeakSet;class ea{constructor(t){var e=this;t5(this,en),en.add(this),t4(this,ee,void 0),t4(this,ei,void 0),t4(this,er,50),t4(this,eo,null),t4(this,es,new Map);let i=t.getSettings();t8(ee,this,t),t8(ei,this,i.imeFastEdit?et.MIXED:et.CELL),t9(ee,this).addHook("afterUpdateSettings",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return t7(en,e,ed).call(e,...i)}),t9(ee,this).addHook("afterSelection",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return t7(en,e,eh).call(e,...i)}),t9(ee,this).addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return t7(en,e,eh).call(e,...i)}),t9(ee,this).addHook("afterSelectionEnd",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return t7(en,e,ec).call(e,...i)})}getFocusMode(){return t9(ei,this)}setFocusMode(t){Object.values(et).includes(t)?t8(ei,this,t):(0,t6.warn)(`"${t}" is not a valid focus mode.`)}getRefocusDelay(){return t9(er,this)}setRefocusDelay(t){t8(er,this,t)}setRefocusElementGetter(t){t8(eo,this,t)}getRefocusElement(){var t;return"function"==typeof t9(eo,this)?t9(eo,this).call(this):null===(t=t9(ee,this).getActiveEditor())||void 0===t?void 0:t.TEXTAREA}focusOnHighlightedCell(t){let e=t=>{var e,i;let r=null===(e=t9(ee,this).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!r)return;let o=t9(ee,this).runHooks("modifyFocusedElement",r.row,r.col,t);o instanceof HTMLElement||(o=t),o&&!(null!==(i=t9(ee,this).getActiveEditor())&&void 0!==i&&i.isOpened())&&o.focus({preventScroll:!0})};t?e(t):t7(en,this,el).call(this,t=>e(t))}refocusToEditorTextarea(){var t;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t9(er,this),i=this.getRefocusElement();t9(ee,this).getSettings().imeFastEdit&&!(null!==(t=t9(ee,this).getActiveEditor())&&void 0!==t&&t.isOpened())&&i&&(t9(es,this).has(e)||t9(es,this).set(e,(0,tQ.debounce)(()=>{i.select()},e)),t9(es,this).get(e)())}}function el(t){var e;let i=null===(e=t9(ee,this).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!i||!t9(ee,this).selection.isCellVisible(i)){t(null);return}let r=t9(ee,this).getCell(i.row,i.col,!0);null===r?t9(ee,this).addHookOnce("afterScroll",()=>{t(t9(ee,this).getCell(i.row,i.col,!0))}):t(r)}function eh(){t7(en,this,el).call(this,t=>{let{activeElement:e}=t9(ee,this).rootDocument;e&&(0,tZ.isOutsideInput)(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function ec(){t7(en,this,el).call(this,t=>{this.getFocusMode()===et.MIXED&&"TD"===t.nodeName&&this.refocusToEditorTextarea()})}function ed(t){t.imeFastEdit&&this.getFocusMode()!==et.MIXED?this.setFocusMode(et.MIXED):t.imeFastEdit||this.getFocusMode()===et.CELL||this.setFocusMode(et.CELL)}var eu=tn("ceXML"),eg={};s(eg,"instanceToHTML",()=>eY),s(eg,"_dataToHTML",()=>eG),s(eg,"htmlToGridSettings",()=>e$),tn("1hIp0");var tl=tn("hmx0d"),ep=tn("bGtV7"),tf=tn("5Okwt"),ef=tn("gMtBp"),tw=tn("9GTLg"),em=tn("aIKND"),ey={},ev=tn("96Da4"),tp=tn("faIBy"),ew=tn("blCy8"),eb=ew("match");ey=function(t){var e;return ev(t)&&(void 0!==(e=t[eb])?!!e:"RegExp"===tp(t))};var eC=tn("jqSLA"),eS=tn("kdzTk"),ex={},ep=tn("bGtV7"),tb=tn("2HOcD"),eE=tn("5Ef1u"),eR={},eT=tn("hc2VB");eR=function(){var t=eT(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e};var eM=RegExp.prototype;ex=function(t){var e=t.flags;return!(void 0===e&&!("flags"in eM)&&!tb(t,"flags")&&eE(eM,t))?e:ep(eR,t)};var ek={},tf=tn("5Okwt"),eA=tn("dZoqA"),eO=Math.floor,eP=tf("".charAt),eI=tf("".replace),eH=tf("".slice),eL=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,eD=/\$([$&'`]|\d{1,2})/g;ek=function(t,e,i,r,o,s){var n=i+t.length,a=r.length,l=eD;return void 0!==o&&(o=eA(o),l=eL),eI(s,l,function(s,l){var h;switch(eP(l,0)){case"$":return"$";case"&":return t;case"`":return eH(e,0,i);case"'":return eH(e,n);case"<":h=o[eH(l,1,-1)];break;default:var c=+l;if(0===c)return s;if(c>a){var d=eO(c/10);if(0===d)return s;if(d<=a)return void 0===r[d-1]?eP(l,1):r[d-1]+eP(l,1);return s}h=r[c-1]}return void 0===h?"":h})};var ew=tn("blCy8"),eN=tn("jfGLK"),e_=ew("replace"),eF=TypeError,ej=tf("".indexOf),eB=tf("".replace),eW=tf("".slice),eV=Math.max;tl({target:"String",proto:!0},{replaceAll:function(t,e){var i,r,o,s,n,a,l,h,c=ef(this),d=0,u=0,g="";if(!em(t)){if((i=ey(t))&&!~ej(eC(ef(ex(t))),"g"))throw new eF("`.replaceAll` does not allow non-global regexes");if(r=eS(t,e_))return ep(r,t,c,e);if(eN&&i)return eB(eC(c),t,e)}for(o=eC(c),s=eC(t),(n=tw(e))||(e=eC(e)),l=eV(1,a=s.length),d=ej(o,s);-1!==d;)h=n?eC(e(s,d,o)):ek(s,o,d,[],void 0,e),g+=eW(o,u,d)+h,u=d+a,d=d+l>o.length?-1:ej(o,s,d+l);return u<o.length&&(g+=eW(o,u)),g}});var tJ=tn("gnaTS");const eU={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},ez=RegExp(Object.keys(eU).map(t=>`(${t})`).join("|"),"gi");function eY(t){let e=t.hasColHeaders(),i=t.hasRowHeaders(),r=[e?-1:0,i?-1:0,t.countRows()-1,t.countCols()-1],o=t.getData(...r),s=o.length,n=s>0?o[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],c=i?1:0,d=e?1:0;for(let r=0;r<s;r+=1){let s=e&&0===r,a=[];for(let e=0;e<n;e+=1){let n=!s&&i&&0===e,l="";if(s)l=`<th>${t.getColHeader(e-c)}</th>`;else if(n)l=`<th>${t.getRowHeader(r-d)}</th>`;else{let i=o[r][e],{hidden:s,rowspan:n,colspan:a}=t.getCellMeta(r-d,e-c);if(!s){let t=[];if(n&&t.push(`rowspan="${n}"`),a&&t.push(`colspan="${a}"`),(0,tJ.isEmpty)(i))l=`<td ${t.join(" ")}></td>`;else{let e=i.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");l=`<td ${t.join(" ")}>${e}</td>`}}}a.push(l)}let u=["<tr>",...a,"</tr>"].join("");s?l.splice(1,0,u):h.splice(-1,0,u)}return a.splice(1,0,l.join(""),h.join("")),a.join("")}function eG(t){let e=t.length,i=["<table>"];for(let r=0;r<e;r+=1){let o=t[r],s=o.length,n=[];0===r&&i.push("<tbody>");for(let t=0;t<s;t+=1){let e=o[t],i=(0,tJ.isEmpty)(e)?"":e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,t=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(t.length-1)} </span>`).replace(/\t/gi,"&#9;");n.push(`<td>${i}</td>`)}i.push("<tr>",...n,"</tr>"),r+1===e&&i.push("</tbody>")}return i.push("</table>"),i.join("")}function e$(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,r={},o=i.createDocumentFragment(),s=i.createElement("div");o.appendChild(s);let n=t;if("string"==typeof n){let t=n.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,t=>{let e=t.match(/<td\b[^>]*?>/g)[0],i=t.substring(e.length,t.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(/<p.*?>/g,"\n").replace("\n","").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${e}${i}</td>`});s.insertAdjacentHTML("afterbegin",`${t}`),n=s.querySelector("table")}if(!n||"TABLE"!==((e=n)&&e.nodeName||""))return;let a=s.querySelector('meta[name$="enerator"]'),l=null!==n.querySelector("tbody th"),h=n.querySelector("tr"),c=h?Array.from(h.cells).reduce((t,e)=>t+e.colSpan,0)-(l?1:0):0,d=n.tFoot&&Array.from(n.tFoot.rows)||[],u=[],g=!1,p=0,f=0;if(n.tHead){let t=Array.from(n.tHead.rows).filter(t=>{let e=null!==t.querySelector("td");return e&&u.push(t),!e});g=(p=t.length)>0,p>1?r.nestedHeaders=Array.from(t).reduce((t,e)=>{let i=Array.from(e.cells).reduce((t,e,i)=>{if(l&&0===i)return t;let{colSpan:r,innerHTML:o}=e;return t.push(r>1?{label:o,colspan:r}:o),t},[]);return t.push(i),t},[]):g&&(r.colHeaders=Array.from(t[0].children).reduce((t,e,i)=>(l&&0===i||t.push(e.innerHTML),t),[]))}u.length&&(r.fixedRowsTop=u.length),d.length&&(r.fixedRowsBottom=d.length);let m=[...u,...Array.from(n.tBodies).reduce((t,e)=>(t.push(...Array.from(e.rows)),t),[]),...d],y=Array(f=m.length);for(let t=0;t<f;t++)y[t]=Array(c);let w=[],b=[];for(let t=0;t<f;t++){let e=Array.from(m[t].cells),i=e.length;for(let r=0;r<i;r++){let i=e[r],{nodeName:o,innerHTML:s,rowSpan:n,colSpan:l}=i,h=y[t].findIndex(t=>void 0===t);if("TD"===o){if(n>1||l>1){for(let e=t;e<t+n;e++)if(e<f)for(let t=h;t<h+l;t++)y[e][t]=null;let e=i.getAttribute("style");e&&e.includes("mso-ignore:colspan")||w.push({col:h,row:t,rowspan:n,colspan:l})}let e="";e=a&&/excel/gi.test(a.content)?s.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):s.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),y[t][h]=e.replace(ez,t=>eU[t])}else b.push(s)}}return w.length&&(r.mergeCells=w),b.length&&(r.rowHeaders=b),y.length&&(r.data=y),r}tn("1C6fS");var eX=tn("bO142");tn("1C6fS");var eq=tn("guO5N"),tQ=tn("f3221");const eK=new Map([["asc",[-1,1]],["desc",[1,-1]]]),eZ=t=>`The priority '${t}' is already declared in a map.`,eQ=t=>`The priority '${t}' is not a number.`;tn("1C6fS");var tQ=tn("f3221");const eJ=t=>`The id '${t}' is already declared in a map.`;function e0(){let{errorIdExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new Map;function i(){return[...e]}function r(t){return e.has(t)}return t=(0,tQ.isFunction)(t)?t:eJ,{addItem:function(i,o){if(r(i))throw Error(t(i));e.set(i,o)},clear:function(){e.clear()},getId:function(t){let[e]=i().find(e=>{let[i,r]=e;return t===r&&i})||[null];return e},getItem:function(t){return e.get(t)},getItems:i,hasItem:r,removeItem:function(t){return e.delete(t)}}}tn("1C6fS");var tQ=tn("f3221");const e1=t=>`'${t}' value is already declared in a unique set.`,e2=t=>`There is already registered "${t}" plugin.`,e3=function(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=new Map;return t=(0,tQ.isFunction)(t)?t:eZ,e=(0,tQ.isFunction)(e)?e:eQ,{addItem:function(r,o){if(!(0,eq.isNumeric)(r))throw Error(e(r));if(i.has(r))throw Error(t(r));i.set(r,o)},getItems:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asc",[e,r]=eK.get(t)||eK.get("asc");return[...i].sort((t,i)=>t[0]<i[0]?e:r).map(t=>t[1])}}}({errorPriorityExists:t=>`There is already registered plugin on priority "${t}".`,errorPriorityNaN:t=>`The priority "${t}" is not a number.`}),e6=function(){let{errorItemExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new Set;return t=(0,tQ.isFunction)(t)?t:e1,{addItem:function(i){if(e.has(i))throw Error(t(i));e.add(i)},clear:function(){e.clear()},getItems:function(){return[...e]}}}({errorItemExists:e2}),e4=e0({errorIdExists:e2});function e5(){return[...e3.getItems(),...e6.getItems()]}function e9(t){let e=(0,eX.toUpperCaseFirst)(t);return e4.getItem(e)}function e8(t,e,i){var r,o,s;[t,e,i]=(r=t,o=e,s=i,"function"==typeof r&&(r=(o=r).PLUGIN_KEY,s=o.PLUGIN_PRIORITY),[r,o,s]),void 0===e9(t)&&function(t,e,i){let r=(0,eX.toUpperCaseFirst)(t);if(e4.hasItem(r))throw Error(e2(r));void 0===i?e6.addItem(r):e3.addItem(i,r),e4.addItem(r,e)}(t,e,i)}tn("1C6fS");var e7=tn("lSZ9A");const{register:it,getItem:ie,hasItem:ii,getNames:ir,getValues:io}=(0,e7.default)("renderers");function is(t){if("function"==typeof t)return t;if(!ii(t))throw Error(`No registered renderer found under "${t}" name`);return ie(t)}function ia(t,e){"string"!=typeof t&&(t=(e=t).RENDERER_TYPE),it(t,e)}var il=tn("jxqWV");tn("1C6fS");var e7=tn("lSZ9A");const{register:ih,getItem:ic,hasItem:id,getNames:iu,getValues:ig}=(0,e7.default)("validators");function ip(t){if("function"==typeof t)return t;if(!id(t))throw Error(`No registered validator found under "${t}" name`);return ic(t)}function im(t,e){"string"!=typeof t&&(t=(e=t).VALIDATOR_TYPE),ih(t,e)}var eX=tn("bO142"),eq=tn("guO5N");tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),t2=tn("1k8Ev"),iy=tn("7HxIw");tn("1hIp0"),tn("1C6fS");var tZ=tn("gFbQZ"),tQ=tn("f3221"),iv=tn("llu1T"),t0=tn("eL8cl"),tJ=tn("gnaTS");function iw(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function ib(t,e){return t.get(iS(t,e))}function iC(t,e,i){return t.set(iS(t,e),i),i}function iS(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var ix=new WeakMap,iE=new WeakMap,iR=new WeakMap,iT=new WeakMap,iM=new WeakMap,ik=new WeakMap,iA=new WeakMap,iO=new WeakMap,iP=new WeakMap,iI=new WeakMap,iH=class{constructor(t,e,i,r,o,s){let n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;iw(this,ix,void 0),iw(this,iE,void 0),iw(this,iR,void 0),iw(this,iT,void 0),iw(this,iM,void 0),iw(this,ik,void 0),iw(this,iA,void 0),iw(this,iO,void 0),iw(this,iP,[null,null]),iw(this,iI,[null,null]),iC(ix,this,i),iC(iE,this,e),iC(iR,this,o),iC(iT,this,s),iC(iM,this,n),iC(ik,this,r),iC(iA,this,t),this.registerEvents()}registerEvents(){ib(ik,this).addEventListener(ib(iR,this).holder,"contextmenu",t=>this.onContextMenu(t)),ib(ik,this).addEventListener(ib(iR,this).TABLE,"mouseover",t=>this.onMouseOver(t)),ib(ik,this).addEventListener(ib(iR,this).TABLE,"mouseout",t=>this.onMouseOut(t));let t=()=>{ib(ik,this).addEventListener(ib(iR,this).holder,"touchstart",t=>this.onTouchStart(t)),ib(ik,this).addEventListener(ib(iR,this).holder,"touchend",t=>this.onTouchEnd(t)),this.momentumScrolling||(this.momentumScrolling={}),ib(ik,this).addEventListener(ib(iR,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ib(ix,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ib(ix,this).getSetting("onAfterMomentumScroll"))},200)})};(0,t0.isMobileBrowser)()?t():((0,iv.isTouchSupported)()&&t(),(()=>{ib(ik,this).addEventListener(ib(iR,this).holder,"mouseup",t=>this.onMouseUp(t)),ib(ik,this).addEventListener(ib(iR,this).holder,"mousedown",t=>this.onMouseDown(t))})())}selectedCellWasTouched(t){let e=this.parentCell(t).coords;if(ib(iO,this)&&e){let[t,i]=[e.row,ib(iO,this).from.row],[r,o]=[e.col,ib(iO,this).from.col];return t===i&&r===o}return!1}parentCell(t){let e={},i=ib(iR,this).TABLE,r=(0,tZ.closestDown)(t,["TD","TH"],i);return r?(e.coords=ib(iR,this).getCoords(r),e.TD=r):(0,tZ.hasClass)(t,"wtBorder")&&(0,tZ.hasClass)(t,"current")?(e.coords=ib(iT,this).getFocusSelection().cellRange.highlight,e.TD=ib(iR,this).getCell(e.coords)):(0,tZ.hasClass)(t,"wtBorder")&&(0,tZ.hasClass)(t,"area")&&ib(iT,this).getAreaSelection().cellRange&&(e.coords=ib(iT,this).getAreaSelection().cellRange.to,e.TD=ib(iR,this).getCell(e.coords)),e}onMouseDown(t){let e=ib(iE,this).rootDocument.activeElement,i=(0,tQ.partial)(tZ.getParent,t.target),r=t.target;if(!["TD","TH"].includes(e.nodeName)&&(r===e||i(0)===e||i(1)===e))return;let o=this.parentCell(r);(0,tZ.hasClass)(r,"corner")?ib(ix,this).getSetting("onCellCornerMouseDown",t,r):o.TD&&ib(ix,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,o.coords,o.TD),(0===t.button||this.touchApplied)&&o.TD&&(ib(iI,this)[0]=o.TD,clearTimeout(ib(iP,this)[0]),ib(iP,this)[0]=setTimeout(()=>{ib(iI,this)[0]=null},1e3))}onContextMenu(t){if(ib(ix,this).has("onCellContextMenu")){let e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}onMouseOver(t){if(!ib(ix,this).has("onCellMouseOver"))return;let e=ib(iR,this).TABLE,i=(0,tZ.closestDown)(t.target,["TD","TH"],e),r=ib(iM,this)||this;i&&i!==r.lastMouseOver&&(0,tZ.isChildOf)(i,e)&&(r.lastMouseOver=i,this.callListener("onCellMouseOver",t,ib(iR,this).getCoords(i),i))}onMouseOut(t){if(!ib(ix,this).has("onCellMouseOut"))return;let e=ib(iR,this).TABLE,i=(0,tZ.closestDown)(t.target,["TD","TH"],e),r=(0,tZ.closestDown)(t.relatedTarget,["TD","TH"],e),o=ib(iM,this)||this;i&&i!==r&&(0,tZ.isChildOf)(i,e)&&(this.callListener("onCellMouseOut",t,ib(iR,this).getCoords(i),i),null===r&&(o.lastMouseOver=null))}onMouseUp(t){let e=this.parentCell(t.target);e.TD&&ib(ix,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,e.coords,e.TD),(0===t.button||this.touchApplied)&&(e.TD===ib(iI,this)[0]&&e.TD===ib(iI,this)[1]?((0,tZ.hasClass)(t.target,"corner")?this.callListener("onCellCornerDblClick",t,e.coords,e.TD):this.callListener("onCellDblClick",t,e.coords,e.TD),ib(iI,this)[0]=null,ib(iI,this)[1]=null):e.TD===ib(iI,this)[0]&&(ib(iI,this)[1]=e.TD,clearTimeout(ib(iP,this)[1]),ib(iP,this)[1]=setTimeout(()=>{ib(iI,this)[1]=null},500)))}onTouchStart(t){iC(iO,this,ib(iT,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(t)}onTouchEnd(t){var e;let i=t.target,r=null===(e=this.parentCell(i))||void 0===e?void 0:e.coords,o=(0,tJ.isDefined)(r)&&r.row>=0&&r.col>=0;t.cancelable&&o&&ib(ix,this).getSetting("isDataViewInstance")&&((0,t0.isIOS)()&&((0,t0.isChromeWebKit)()||(0,t0.isFirefoxWebKit)())&&this.selectedCellWasTouched(i)&&!["A","BUTTON","INPUT"].includes(i.tagName)?t.preventDefault():this.selectedCellWasTouched(i)||t.preventDefault()),this.onMouseUp(t),this.touchApplied=!1}callListener(t,e,i,r){let o=ib(ix,this).getSettingPure(t);o&&o(e,i,r,ib(iA,this).call(this))}destroy(){clearTimeout(ib(iP,this)[0]),clearTimeout(ib(iP,this)[1]),ib(ik,this).destroy()}};tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),iv=tn("llu1T"),eu=tn("ceXML"),iL=tn("bCtEl"),t0=tn("eL8cl"),tZ=tn("gFbQZ");tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),tQ=tn("f3221");function iD(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}tn("1C6fS");var iN=class{constructor(t,e,i){iD(this,"offset",void 0),iD(this,"total",void 0),iD(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=i}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleRowHeadedColumnToSourceColumn(t){return this.renderedToSource(this.offsettedTH(t))}sourceColumnToVisibleRowHeadedColumn(t){return this.unOffsettedTH(this.sourceToRendered(t))}};function i_(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}tn("1C6fS");var iF=class{constructor(t,e,i){i_(this,"offset",void 0),i_(this,"total",void 0),i_(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=i}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleColHeadedRowToSourceRow(t){return this.renderedToSource(this.offsettedTH(t))}sourceRowToVisibleColHeadedRow(t){return this.unOffsettedTH(this.sourceToRendered(t))}};function ij(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}tn("1C6fS"),tn("1C6fS"),tn("1hIp0"),tn("1C6fS"),tn("1C6fS");class iB{constructor(){ij(this,"currentSize",0),ij(this,"nextSize",0),ij(this,"currentOffset",0),ij(this,"nextOffset",0)}setSize(t){this.currentSize=this.nextSize,this.nextSize=t}setOffset(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}function iW(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class iV{constructor(){iW(this,"size",new iB),iW(this,"workingSpace",0),iW(this,"sharedSize",null)}setSize(t){this.size.setSize(t)}setOffset(t){this.size.setOffset(t)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof iB}isPlaceOn(t){return this.workingSpace===t}append(t){this.workingSpace=1,t.workingSpace=2,this.sharedSize=t.getViewSize()}prepend(t){this.workingSpace=2,t.workingSpace=1,this.sharedSize=t.getViewSize()}}function iU(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class iz{constructor(t,e,i){iU(this,"rootNode",void 0),iU(this,"nodesPool",void 0),iU(this,"sizeSet",new iV),iU(this,"childNodeType",void 0),iU(this,"visualIndex",0),iU(this,"collectedNodes",[]),this.rootNode=t,this.nodesPool=e,this.childNodeType=i.toUpperCase()}setSize(t){return this.sizeSet.setSize(t),this}setOffset(t){return this.sizeSet.setOffset(t),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}getCurrentNode(){let t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}getRenderedChildCount(){let{rootNode:t,sizeSet:e}=this,i=0;if(this.isSharedViewSet()){let r=t.firstElementChild;for(;r;){if(r.tagName===this.childNodeType)i+=1;else if(e.isPlaceOn(1))break;r=r.nextElementSibling}}else i=t.childElementCount;return i}start(){this.collectedNodes.length=0,this.visualIndex=0;let{rootNode:t,sizeSet:e}=this,i=this.isSharedViewSet(),{nextSize:r}=e.getViewSize(),o=this.getRenderedChildCount();for(;o<r;){let r=this.nodesPool();!i||i&&e.isPlaceOn(2)?t.appendChild(r):t.insertBefore(r,t.firstChild),o+=1}let s=i&&e.isPlaceOn(1);for(;o>r;)t.removeChild(s?t.firstChild:t.lastChild),o-=1}render(){let{rootNode:t,sizeSet:e}=this,i=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(2)&&(i+=e.sharedSize.nextSize);let r=t.childNodes[i];if(r.tagName!==this.childNodeType){let e=this.nodesPool();t.replaceChild(e,r),r=e}this.collectedNodes.push(r),this.visualIndex+=1}end(){}}class iY extends iz{prependView(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}appendView(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}tn("1C6fS"),tn("1C6fS");class iG{constructor(t){var e,i,r;i=void 0,(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e="nodeType","string"))?r:r+"")in this?Object.defineProperty(this,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[e]=i,this.nodeType=t.toUpperCase()}setRootDocument(t){this.rootDocument=t}obtain(){return this.rootDocument.createElement(this.nodeType)}}function i$(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class iX{constructor(t,e){i$(this,"nodesPool",null),i$(this,"nodeType",void 0),i$(this,"rootNode",void 0),i$(this,"table",null),i$(this,"renderedNodes",0),this.nodesPool="string"==typeof t?new iG(t):null,this.nodeType=t,this.rootNode=e}setTable(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}adjust(){}render(){}}var tZ=tn("gFbQZ"),iq=tn("4Pbrh");function iK(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class iZ extends iX{constructor(){super("TH"),iK(this,"orderViews",new WeakMap),iK(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new iY(t,t=>this.nodesPool.obtain(this.sourceRowIndex,t),this.nodeType),this.orderViews.set(t,e)),e}render(){let{rowsToRender:t,rowHeaderFunctions:e,rowHeadersCount:i,rows:r,cells:o}=this.table;for(let s=0;s<t;s++){let t=this.table.renderedRowToSource(s),n=r.getRenderedNode(s);this.sourceRowIndex=t;let a=this.obtainOrderView(n),l=o.obtainOrderView(n);a.appendView(l).setSize(i).setOffset(this.table.renderedColumnToSource(0)).start();for(let r=0;r<i;r++){a.render();let i=a.getCurrentNode();i.className="",i.removeAttribute("style"),(0,tZ.removeAttribute)(i,[RegExp("aria-(.*)"),/role/]),this.table.isAriaEnabled()&&(0,tZ.setAttribute)(i,[(0,iq.A11Y_ROWHEADER)(),(0,iq.A11Y_SCOPE_ROW)(),(0,iq.A11Y_COLINDEX)(r+1),(0,iq.A11Y_TABINDEX)(-1)]),e[r](t,i,r)}a.end()}}}var tZ=tn("gFbQZ"),iq=tn("4Pbrh");class iQ extends iX{constructor(t){super(null,t)}adjust(){let{columnHeadersCount:t,rowHeadersCount:e}=this.table,i=this.rootNode.firstChild;if(t){let{columnsToRender:r}=this.table,o=r+e;for(let e=0;e<t;e++){for((i=this.rootNode.childNodes[e])||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<o;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)i.removeChild(i.lastChild),this.renderedNodes-=1}let s=this.rootNode.childNodes.length;if(s>t)for(let e=t;e<s;e++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&(0,tZ.empty)(i)}render(){let{columnHeadersCount:t}=this.table;this.table.isAriaEnabled()&&(0,tZ.setAttribute)(this.rootNode,[(0,iq.A11Y_ROWGROUP)()]);for(let e=0;e<t;e+=1){let{columnHeaderFunctions:t,columnsToRender:i,rowHeadersCount:r}=this.table,o=this.rootNode.childNodes[e];this.table.isAriaEnabled()&&(0,tZ.setAttribute)(o,[(0,iq.A11Y_ROW)(),(0,iq.A11Y_ROWINDEX)(e+1)]);for(let s=-1*r;s<i;s+=1){let i=this.table.renderedColumnToSource(s),n=o.childNodes[s+r];n.className="",n.removeAttribute("style"),(0,tZ.removeAttribute)(n,[RegExp("aria-(.*)"),/role/]),this.table.isAriaEnabled()&&(0,tZ.setAttribute)(n,[(0,iq.A11Y_COLINDEX)(s+1+this.table.rowHeadersCount),(0,iq.A11Y_TABINDEX)(-1),(0,iq.A11Y_COLUMNHEADER)(),...s>=0?[(0,iq.A11Y_SCOPE_COL)()]:[(0,iq.A11Y_ROW)()]]),t[e](i,n,e)}}}}var t6=tn("jlXkd"),iJ=tn("iCsRe"),tZ=tn("gFbQZ");let i0=!1;class i1 extends iX{constructor(t){super(null,t)}adjust(){let{columnsToRender:t,rowHeadersCount:e}=this.table,i=t+e;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();let{columnsToRender:t,rowHeadersCount:e}=this.table;!i0&&t>1e3&&(i0=!0,(0,t6.warn)((0,iJ.toSingleLine)`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let t=0;t<e;t++){let e=this.table.renderedColumnToSource(t),i=this.table.columnUtils.getHeaderWidth(e);this.rootNode.childNodes[t].style.width=`${i}px`}for(let i=0;i<t;i++){let t=this.table.renderedColumnToSource(i),r=this.table.columnUtils.getStretchedColumnWidth(t);this.rootNode.childNodes[i+e].style.width=`${r}px`}let i=this.rootNode.firstChild;i&&(0,tZ.addClass)(i,"rowHeader")}}tn("1C6fS");var t6=tn("jlXkd"),iJ=tn("iCsRe"),tZ=tn("gFbQZ"),iq=tn("4Pbrh");let i2=!1;class i3 extends iX{constructor(t){var e,i,r;super("TR",t),i=void 0,(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e="orderView","string"))?r:r+"")in this?Object.defineProperty(this,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[e]=i,this.orderView=new iz(t,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(t){return this.orderView.getNode(t)}render(){let{rowsToRender:t}=this.table;!i2&&t>1e3&&(i2=!0,(0,t6.warn)((0,iJ.toSingleLine)`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&(0,tZ.setAttribute)(this.rootNode,[(0,iq.A11Y_ROWGROUP)()]),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<t;r++){this.orderView.render();let t=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(r);if(this.table.isAriaEnabled()){var e,i;(0,tZ.setAttribute)(t,[(0,iq.A11Y_ROW)(),(0,iq.A11Y_ROWINDEX)(o+(null!==(e=null===(i=this.table.rowUtils)||void 0===i||null===(i=i.dataAccessObject)||void 0===i?void 0:i.columnHeaders.length)&&void 0!==e?e:0)+1)])}}this.orderView.end()}}tn("1C6fS");var tZ=tn("gFbQZ"),iq=tn("4Pbrh");function i6(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class i4 extends iX{constructor(){super("TD"),i6(this,"orderViews",new WeakMap),i6(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new iY(t,t=>this.nodesPool.obtain(this.sourceRowIndex,t),this.nodeType),this.orderViews.set(t,e)),e}render(){let{rowsToRender:t,columnsToRender:e,rows:i,rowHeaders:r}=this.table;for(let n=0;n<t;n++){let t=this.table.renderedRowToSource(n),a=i.getRenderedNode(n);this.sourceRowIndex=t;let l=this.obtainOrderView(a),h=r.obtainOrderView(a);l.prependView(h).setSize(e).setOffset(this.table.renderedColumnToSource(0)).start();for(let i=0;i<e;i++){l.render();let e=l.getCurrentNode(),r=this.table.renderedColumnToSource(i);if((0,tZ.hasClass)(e,"hide")||(e.className=""),e.removeAttribute("style"),e.removeAttribute("dir"),(0,tZ.removeAttribute)(e,[RegExp("aria-(.*)"),/role/]),this.table.cellRenderer(t,r,e),this.table.isAriaEnabled()){var o,s;(0,tZ.setAttribute)(e,[...e.hasAttribute("role")?[]:[(0,iq.A11Y_GRIDCELL)()],(0,iq.A11Y_TABINDEX)(-1),(0,iq.A11Y_COLINDEX)(r+(null!==(o=null===(s=this.table.rowUtils)||void 0===s||null===(s=s.dataAccessObject)||void 0===s?void 0:s.rowHeaders.length)&&void 0!==o?o:0)+1)])}}l.end()}}}function i5(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}tn("1C6fS");class i9{constructor(t){let{cellRenderer:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i5(this,"rootNode",void 0),i5(this,"rootDocument",void 0),i5(this,"rowHeaders",null),i5(this,"columnHeaders",null),i5(this,"colGroup",null),i5(this,"rows",null),i5(this,"cells",null),i5(this,"rowFilter",null),i5(this,"columnFilter",null),i5(this,"rowUtils",null),i5(this,"columnUtils",null),i5(this,"rowsToRender",0),i5(this,"columnsToRender",0),i5(this,"rowHeaderFunctions",[]),i5(this,"rowHeadersCount",0),i5(this,"columnHeaderFunctions",[]),i5(this,"columnHeadersCount",0),i5(this,"cellRenderer",void 0),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=e}setAxisUtils(t,e){this.rowUtils=t,this.columnUtils=e}setViewportSize(t,e){this.rowsToRender=t,this.columnsToRender=e}setFilters(t,e){this.rowFilter=t,this.columnFilter=e}setHeaderContentRenderers(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}setRenderers(){let{rowHeaders:t,columnHeaders:e,colGroup:i,rows:r,cells:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setTable(this),e.setTable(this),i.setTable(this),r.setTable(this),o.setTable(this),this.rowHeaders=t,this.columnHeaders=e,this.colGroup=i,this.rows=r,this.cells=o}renderedRowToSource(t){return this.rowFilter.renderedToSource(t)}renderedColumnToSource(t){return this.columnFilter.renderedToSource(t)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();let{rowsToRender:t,rows:e}=this;for(let i=0;i<t;i++){let t=e.getRenderedNode(i);if(t.firstChild){let e=this.renderedRowToSource(i),r=this.rowUtils.getHeight(e);r?t.firstChild.style.height=`${r-1}px`:t.firstChild.style.height=""}}}}class i8{constructor(){let{TABLE:t,THEAD:e,COLGROUP:i,TBODY:r,rowUtils:o,columnUtils:s,cellRenderer:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new i9(t,{cellRenderer:n}),this.renderer.setRenderers({rowHeaders:new iZ,columnHeaders:new iQ(e),colGroup:new i1(i),rows:new i3(r),cells:new i4}),this.renderer.setAxisUtils(o,s)}setFilters(t,e){return this.renderer.setFilters(t,e),this}setViewportSize(t,e){return this.renderer.setViewportSize(t,e),this}setHeaderContentRenderers(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}tn("1C6fS");var tZ=tn("gFbQZ");function i7(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function rt(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function re(t,e){return t.get(rr(t,e))}function ri(t,e,i){return t.set(rr(t,e),i),i}function rr(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}tn("1C6fS");var ro=new WeakMap,rs=new WeakMap,rn=new WeakMap,ra=new WeakMap,rl=new WeakMap;class rh{static get DEFAULT_WIDTH(){return 50}constructor(t){let{totalColumns:e,stretchMode:i,stretchingColumnWidthFn:r,columnWidthFn:o}=t;rt(this,"stretchAllRatio",0),rt(this,"stretchLastWidth",0),rt(this,"stretchAllColumnsWidth",[]),i7(this,ro,0),rt(this,"needVerifyLastColumnWidth",!0),i7(this,rs,()=>0),i7(this,rn,t=>t),i7(this,ra,t=>t),i7(this,rl,()=>"none"),ri(rs,this,e),ri(rl,this,i),ri(rn,this,null!=r?r:re(rn,this)),ri(ra,this,null!=o?o:re(ra,this))}refreshStretching(t){if("none"===re(rl,this).call(this))return;ri(ro,this,t);let e=0;for(let i=0;i<re(rs,this).call(this);i++){let r=this._getColumnWidth(i),o=re(rn,this).call(this,void 0,i);"number"==typeof o?t-=o:e+=r}let i=t-e;if("all"===re(rl,this).call(this)&&i>0)this.stretchAllRatio=t/e,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===re(rl,this).call(this)&&t!==1/0){let t=this._getColumnWidth(re(rs,this).call(this)-1),e=i+t;this.stretchLastWidth=e>=0?e:t}}getStretchedColumnWidth(t,e){let i=null;return"all"===re(rl,this).call(this)&&0!==this.stretchAllRatio?i=this._getStretchedAllColumnWidth(t,e):"last"===re(rl,this).call(this)&&0!==this.stretchLastWidth&&(i=this._getStretchedLastColumnWidth(t)),i}_getStretchedAllColumnWidth(t,e){let i=0;if(!this.stretchAllColumnsWidth[t]){let i=Math.round(e*this.stretchAllRatio),r=re(rn,this).call(this,i,t);void 0===r?this.stretchAllColumnsWidth[t]=i:this.stretchAllColumnsWidth[t]=isNaN(r)?this._getColumnWidth(t):r}if(this.stretchAllColumnsWidth.length===re(rs,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let t=0;t<this.stretchAllColumnsWidth.length;t++)i+=this.stretchAllColumnsWidth[t];i!==re(ro,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=re(ro,this)-i)}return this.stretchAllColumnsWidth[t]}_getStretchedLastColumnWidth(t){return t===re(rs,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(t){let e=re(ra,this).call(this,t);return isNaN(e)&&(e=rh.DEFAULT_WIDTH),e}}function rc(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class rd{constructor(t,e){rc(this,"dataAccessObject",void 0),rc(this,"wtSettings",void 0),rc(this,"headerWidths",new Map),rc(this,"stretching",void 0),this.dataAccessObject=t,this.wtSettings=e,this.stretching=new rh({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(t,e)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",t,e),columnWidthFn:t=>this.dataAccessObject.wtTable.getColumnWidth(t)})}getWidth(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(t){let e=this.getWidth(t),i=this.stretching.getStretchedColumnWidth(t,e);return i&&(e=i),e}getHeaderHeight(t){let e=this.wtSettings.getSetting("defaultRowHeight"),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==i&&(e=e?Math.max(e,i):i),e}getHeaderWidth(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}refreshStretching(){let{wtTable:t,wtViewport:e,cloneSource:i}=this.dataAccessObject,r=i?i.wtTable.holder:t.holder,o=r.offsetHeight<r.scrollHeight?(0,tZ.getScrollbarWidth)():0;this.stretching.refreshStretching(e.getViewportWidth()-o)}calculateWidths(){let{wtSettings:t}=this,e=t.getSetting("rowHeaderWidth");if(this.refreshStretching(),null!=(e=t.getSetting("onModifyRowHeaderWidth",e))){let i=t.getSetting("rowHeaders").length,r=t.getSetting("defaultColumnWidth");for(let t=0;t<i;t++){let i=Array.isArray(e)?e[t]:e;i=null==i?r:i,this.headerWidths.set(t,i)}}}}function ru(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}tn("1C6fS");class rg{constructor(t,e){ru(this,"dataAccessObject",void 0),ru(this,"wtSettings",void 0),this.dataAccessObject=t,this.wtSettings=e}getHeight(t){let e=this.wtSettings.getSetting("rowHeight",t),i=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==i&&(e=void 0===e?i:Math.max(e,i)),e}}const rp="bottom",rf="inline_start",rm="top_inline_start_corner",ry="bottom_inline_start_corner",rv=["top",rp,rf,rm,ry],rw=new Map([["top","ht_clone_top"],[rp,`ht_clone_${rp}`],[rf,`ht_clone_${rf} ht_clone_left`],[rm,`ht_clone_${rm} ht_clone_top_left_corner`],[ry,`ht_clone_${ry} ht_clone_bottom_left_corner`]]);var iq=tn("4Pbrh");function rb(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var rC=class{constructor(t,e,i,r,o){rb(this,"wtSettings",null),rb(this,"domBindings",void 0),rb(this,"TBODY",null),rb(this,"THEAD",null),rb(this,"COLGROUP",null),rb(this,"hasTableHeight",!0),rb(this,"hasTableWidth",!0),rb(this,"isTableVisible",!1),rb(this,"tableOffset",0),rb(this,"holderOffset",0),this.domBindings=i,this.isMaster="master"===o,this.name=o,this.dataAccessObject=t,this.facadeGetter=e,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,(0,tZ.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;let s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new rg(this.dataAccessObject,this.wtSettings),this.columnUtils=new rd(this.dataAccessObject,this.wtSettings),this.tableRenderer=new i8({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(t){return this.name===t}fixTableDomTree(){let t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(t){let e;let i=t.parentNode;return i&&i.nodeType===Node.ELEMENT_NODE&&(0,tZ.hasClass)(i,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).className="wtSpreader",i&&i.insertBefore(e,t),e.appendChild(t)),e.style.position="relative",this.wtSettings.getSetting("ariaTags")&&(0,tZ.setAttribute)(e,[(0,iq.A11Y_PRESENTATION)()]),e}createHider(t){let e;let i=t.parentNode;return i&&i.nodeType===Node.ELEMENT_NODE&&(0,tZ.hasClass)(i,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).className="wtHider",i&&i.insertBefore(e,t),e.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&(0,tZ.setAttribute)(e,[(0,iq.A11Y_PRESENTATION)()]),e}createHolder(t){let e;let i=t.parentNode;return i&&i.nodeType===Node.ELEMENT_NODE&&(0,tZ.hasClass)(i,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).style.position="relative",e.className="wtHolder",i&&i.insertBefore(e,t),this.isMaster&&(e.parentNode.className+="ht_master handsontable",e.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&(0,tZ.setAttribute)(e.parentNode,[(0,iq.A11Y_PRESENTATION)()])),e.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&(0,tZ.setAttribute)(e,[(0,iq.A11Y_PRESENTATION)()]),e}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtSettings:e}=this,{wtOverlays:i,wtViewport:r}=this.dataAccessObject,o=e.getSetting("totalRows"),s=e.getSetting("totalColumns"),n=e.getSetting("rowHeaders"),a=n.length,l=e.getSetting("columnHeaders"),h=l.length,c=!1,d=t;if(this.isMaster&&(this.holderOffset=(0,tZ.offset)(this.holder),d=r.createRenderCalculators(d),a&&!e.getSetting("fixedColumnsStart"))){let t=i.inlineStartOverlay.getScrollPosition(),e=this.correctHeaderWidth;this.correctHeaderWidth=0!==t,e!==this.correctHeaderWidth&&(d=!1)}if(this.isMaster&&(c=i.updateStateOfRendering()),d)this.isMaster&&(r.createVisibleCalculators(),r.createPartiallyVisibleCalculators()),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=(0,tZ.offset)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;let t=o>0?this.getFirstRenderedRow():0,e=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new iF(t,o,h),this.columnFilter=new iN(e,s,a);let i=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();let t={};this.wtSettings.getSetting("beforeDraw",!0,t),i=!0!==t.skipRender}if(i){let t;if(this.tableRenderer.setHeaderContentRenderers(n,l),(this.is(rp)||this.is(ry))&&this.tableRenderer.setHeaderContentRenderers(n,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(t=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(rp))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtViewport.createPartiallyVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();let e=(0,tZ.outerWidth)(this.hider),i=(0,tZ.outerWidth)(this.TABLE);0!==e&&i!==e&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),t!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(rp)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let u=!1;return this.isMaster&&(u=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(u=i.bottomOverlay.resetFixedPosition()||u),u=i.inlineStartOverlay.resetFixedPosition()||u,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),u?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(d),c&&i.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(t){let e,i,r;let o=this.columnFilter.renderedToSource(t),s=this.wtSettings.getSetting("columnHeaders").length,n=this.wtSettings.getSetting("defaultRowHeight"),a=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;s;)s-=1,e=this.getColumnHeaderHeight(s),(i=this.getColumnHeader(o,s))&&(r=(0,tZ.innerHeight)(i),(!e&&n<r||e<r)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=r),Array.isArray(a)?null!==a[s]&&void 0!==a[s]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a[s]):isNaN(a)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a),this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]<(a[s]||a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a[s]||a))}adjustColumnHeaderHeights(){let{wtSettings:t}=this,e=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=t.getSetting("columnHeaders");for(let t=0,o=r.length;t<o;t++)if(i[t]){if(!e[t]||0===e[t].childNodes.length)return;e[t].childNodes[0].style.height=`${i[t]}px`}}resetOversizedRows(){let{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject;if((this.isMaster||this.is(rp))&&!t.getSetting("externalRowCalculator")){let t=this.getRenderedRowsCount();for(let i=0;i<t;i++){let t=this.rowFilter.renderedToSource(i);e.oversizedRows&&e.oversizedRows[t]&&(e.oversizedRows[t]=void 0)}}}getCell(t){let e=t.row,i=t.col,r=this.wtSettings.getSetting("onModifyGetCellCoords",e,i);if(r&&Array.isArray(r)&&([e,i]=r),this.isRowBeforeRenderedRows(e))return -1;if(this.isRowAfterRenderedRows(e))return -2;if(this.isColumnBeforeRenderedColumns(i))return -3;if(this.isColumnAfterRenderedColumns(i))return -4;let o=this.getRow(e);if(!o&&e>=0)throw Error("TR was expected to be rendered but is not");let s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!s&&i>=0)throw Error("TD or TH was expected to be rendered but is not");return s}getRow(t){var e,i;let r=null,o=null;return t<0?(r=null===(e=this.rowFilter)||void 0===e?void 0:e.sourceRowToVisibleColHeadedRow(t),o=this.THEAD):(r=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(t),o=this.TBODY),void 0!==r&&void 0!==o&&!(o.childNodes.length<r+1)&&o.childNodes[r]}getColumnHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.THEAD.childNodes[e];return null==i?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}getColumnHeaders(t){let e=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach(t=>{let r=t.childNodes[i];r&&e.push(r)}),e}getRowHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e>=this.wtSettings.getSetting("rowHeaders").length)return;let i=this.rowFilter.sourceToRendered(t),r=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(t):i,o=(i<0?this.THEAD:this.TBODY).childNodes[r];return null==o?void 0:o.childNodes[e]}getRowHeaders(t){let e=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){let i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],o=null==i?void 0:i.childNodes[r];o&&e.push(o)}return e}getCoords(t){let e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=(0,tZ.closest)(e,["TD","TH"])),null===e)return null;let i=e.parentNode,r=i.parentNode,o=(0,tZ.index)(i),s=e.cellIndex;return(0,tZ.overlayContainsElement)(rm,e,this.wtRootElement)||(0,tZ.overlayContainsElement)("top",e,this.wtRootElement)?"THEAD"===r.nodeName&&(o-=r.childNodes.length):o=(0,tZ.overlayContainsElement)(ry,e,this.wtRootElement)||(0,tZ.overlayContainsElement)(rp,e,this.wtRootElement)?this.wtSettings.getSetting("totalRows")-r.childNodes.length+o:r===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter.renderedToSource(o),s=(0,tZ.overlayContainsElement)(rm,e,this.wtRootElement)||(0,tZ.overlayContainsElement)(rf,e,this.wtRootElement)||(0,tZ.overlayContainsElement)(ry,e,this.wtRootElement)?this.columnFilter.offsettedTH(s):this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){let t,e,i,r,o;if(this.wtSettings.getSetting("externalRowCalculator"))return;let s=this.TBODY.childNodes.length;if(s*this.wtSettings.getSetting("defaultRowHeight")!=(0,tZ.innerHeight)(this.TBODY)-1||this.wtSettings.getSetting("fixedRowsBottom"))for(;s;)s-=1,i=this.rowFilter.renderedToSource(s),t=this.getRowHeight(i),e=(o=(r=this.getTrForRow(i)).querySelector("th"))?(0,tZ.innerHeight)(o):(0,tZ.innerHeight)(r)-1,(!t&&this.wtSettings.getSetting("defaultRowHeight")<e||t<e)&&(e+=1,this.dataAccessObject.wtViewport.oversizedRows[i]=e)}getTrForRow(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}isColumnHeaderRendered(t){return!(t>=0)&&Math.abs(t)<=this.wtSettings.getSetting("rowHeaders").length}isRowHeaderRendered(t){return!(t>=0)&&Math.abs(t)<=this.wtSettings.getSetting("columnHeaders").length}isRowBeforeRenderedRows(t){let e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}isRowAfterRenderedRows(t){return t>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(t){let e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}isColumnAfterRenderedColumns(t){return this.columnFilter&&t>this.getLastRenderedColumn()}isColumnAfterViewport(t){return this.columnFilter&&t>this.getLastVisibleColumn()}isRowAfterViewport(t){return this.rowFilter&&t>this.getLastVisibleRow()}isColumnBeforeViewport(t){return this.columnFilter&&0>this.columnFilter.sourceToRendered(t)&&t>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(t){return this.rowUtils.getHeight(t)}getColumnHeaderHeight(t){return this.columnUtils.getHeaderHeight(t)}getColumnWidth(t){return this.columnUtils.getWidth(t)}getStretchedColumnWidth(t){return this.columnUtils.getStretchedColumnWidth(t)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return(0,tZ.outerWidth)(this.TABLE)}getHeight(){return(0,tZ.outerHeight)(this.TABLE)}getTotalWidth(){let t=(0,tZ.outerWidth)(this.hider);return 0!==t?t:this.getWidth()}getTotalHeight(){let t=(0,tZ.outerHeight)(this.hider);return 0!==t?t:this.getHeight()}isVisible(){return(0,tZ.isVisible)(this.TABLE)}_modifyRowHeaderWidth(t){let e=(0,tQ.isFunction)(t)?t():null;return Array.isArray(e)?(e=[...e])[e.length-1]=this._correctRowHeaderWidth(e[e.length-1]):e=this._correctRowHeaderWidth(e),e}_correctRowHeaderWidth(t){let e=t;return"number"!=typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}},t3=tn("hwT6B");const rS={getFirstRenderedRow(){let t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),i=t-e;return 0===t||0===e?-1:i<0?0:i},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};(0,t3.defineGetter)(rS,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});var t3=tn("hwT6B");const rx={getFirstRenderedColumn(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){let t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,t3.defineGetter)(rx,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});var t3=tn("hwT6B");class rE extends rC{constructor(t,e,i,r){super(t,e,i,r,ry)}}(0,t3.mixin)(rE,rS),(0,t3.mixin)(rE,rx),tn("1C6fS");var tZ=tn("gFbQZ"),t3=tn("hwT6B"),eu=tn("ceXML"),t6=tn("jlXkd");tn("1C6fS"),tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),eX=tn("bO142"),t2=tn("1k8Ev");tn("1C6fS");var tZ=tn("gFbQZ");function rR(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var rT=new WeakSet;function rM(t){let{wtSettings:e,inlineStartOverlay:i,wtTable:r,wtViewport:o,totalColumns:s,rootWindow:n}=this.dataAccessObject;if(i.mainTableScrollableElement===n){let a=e.getSetting("rtlMode"),l=null;if(a){let t=r.TABLE.getBoundingClientRect(),e=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(t.right-e)}else l=(0,tZ.offset)(r.wtRootElement).left;let h=Math.abs((0,tZ.getScrollLeft)(n,n));if(l>h){let e=(0,tZ.innerWidth)(n),r=o.getRowHeaderWidth();for(let o=1;o<=s;o++)if(l+(r+=i.sumCellSizes(o-1,o))-h>=e){t=o-2;break}}}return t}function rk(t){let{topOverlay:e,wtTable:i,wtViewport:r,totalRows:o,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){let n=(0,tZ.offset)(i.wtRootElement),a=(0,tZ.getScrollTop)(s,s);if(n.top>a){let i=(0,tZ.innerHeight)(s),l=r.getColumnHeaderHeight();for(let r=1;r<=o;r++)if(l+=e.sumCellSizes(r-1,r),n.top+l-a>=i){t=r-2;break}}}return t}var rA=class{constructor(t){var e,i,r;(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,rT),rT.add(this),i=void 0,(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e="dataAccessObject","string"))?r:r+"")in this?Object.defineProperty(this,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[e]=i,this.dataAccessObject=t}scrollViewport(t,e,i,r,o){let s=this.scrollViewportHorizontally(t.col,i,o),n=this.scrollViewportVertically(t.row,e,r);return s||n}scrollViewportHorizontally(t,e,i){let{drawn:r,totalColumns:o}=this.dataAccessObject;if(!r||!Number.isInteger(t)||t<0||t>o)return!1;let s=void 0===e&&void 0===i,{fixedColumnsStart:n,inlineStartOverlay:a}=this.dataAccessObject;if(s&&t<n||!Number.isInteger(t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",t))||t<0||t>o)return!1;let l=this.getFirstVisibleColumn(),h=this.getLastVisibleColumn(),c=!1;return(s&&(t<l||t>h)||!s)&&(c=a.scrollTo(t,s?t>=this.getLastPartiallyVisibleColumn():e)),c}scrollViewportVertically(t,e,i){let{drawn:r,totalRows:o}=this.dataAccessObject;if(!r||!Number.isInteger(t)||t<0||t>o)return!1;let s=void 0===e&&void 0===i,{fixedRowsBottom:n,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject;if(s&&(t<a||t>o-n-1)||!Number.isInteger(t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",t))||t<0||t>o)return!1;let h=this.getFirstVisibleRow(),c=this.getLastVisibleRow(),d=!1;return(s&&(t<h||t>c)||!s)&&(d=l.scrollTo(t,s?t>=this.getLastPartiallyVisibleRow():i)),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return rR(rT,this,rk).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return rR(rT,this,rk).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return rR(rT,this,rM).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return rR(rT,this,rM).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};function rO(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function rP(t,e){return t.get(rH(t,e))}function rI(t,e,i){return t.set(rH(t,e),i),i}function rH(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}tn("1C6fS");var rL=new WeakMap;class rD{constructor(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];rO(this,"row",null),rO(this,"col",null),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,rL),rL.set(this,!1),rI(rL,this,i),void 0!==t&&void 0!==e&&(this.row=t,this.col=e)}isValid(t){let{countRows:e,countCols:i,countRowHeaders:r,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...t};return!!Number.isInteger(this.row)&&!!Number.isInteger(this.col)&&!(this.row<-o)&&!(this.col<-r)&&!(this.row>=e)&&!(this.col>=i)}isEqual(t){return t===this||this.row===t.row&&this.col===t.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return rP(rL,this)}isSouthEastOf(t){return this.row>=t.row&&(rP(rL,this)?this.col<=t.col:this.col>=t.col)}isNorthWestOf(t){return this.row<=t.row&&(rP(rL,this)?this.col>=t.col:this.col<=t.col)}isSouthWestOf(t){return this.row>=t.row&&(rP(rL,this)?this.col>=t.col:this.col<=t.col)}isNorthEastOf(t){return this.row<=t.row&&(rP(rL,this)?this.col<=t.col:this.col>=t.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(t){return Number.isInteger(null==t?void 0:t.row)&&(this.row=t.row),Number.isInteger(null==t?void 0:t.col)&&(this.col=t.col),t instanceof rD&&rI(rL,this,t.isRtl()),this}clone(){return new rD(this.row,this.col,rP(rL,this))}toObject(){return{row:this.row,col:this.col}}}function rN(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function r_(t,e){return t.get(rF(t,e))}function rF(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}tn("1C6fS"),tn("1hIp0");var rj=new WeakMap;class rB{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];rN(this,"highlight",null),rN(this,"from",null),rN(this,"to",null),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,rj),rj.set(this,!1),this.highlight=t.clone(),this.from=e.clone(),this.to=i.clone(),rj.set(rF(rj,this),r)}setHighlight(t){return this.highlight=t.clone(),this}setFrom(t){return this.from=t.clone(),this}setTo(t){return this.to=t.clone(),this}isValid(t){return this.from.isValid(t)&&this.to.isValid(t)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!!(this.from.isHeader()&&this.to.isHeader())||this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;let t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;let t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(t){let{row:e,col:i}=t,r=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<=e&&o.row>=e&&r.col<=i&&o.col>=i}includesRange(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}isEqual(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}overlaps(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}isNorthWestOf(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}isOverlappingHorizontally(t){return this.getOuterTopEndCorner().col>=t.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=t.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=t.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=t.getOuterTopStartCorner().col}isOverlappingVertically(t){return this.getOuterBottomStartCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=t.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=t.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=t.getOuterTopRightCorner().row}expand(t){let e=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>i.row||t.col>i.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(i.row,t.row),Math.max(i.col,t.col)),!0)}expandByRange(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(this.includesRange(t)||!this.overlaps(t))return!1;let i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),o=this.getDirection(),s=t.getOuterTopStartCorner(),n=t.getOuterBottomEndCorner(),a=Math.min(i.row,s.row),l=Math.min(i.col,s.col),h=Math.max(r.row,n.row),c=Math.max(r.col,n.col),d=this._createCellCoords(a,l),u=this._createCellCoords(h,c);return this.from=d,this.to=u,this.setDirection(o),e&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally()),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(t){switch(t){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return r_(rj,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return r_(rj,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return r_(rj,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return r_(rj,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return r_(rj,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return r_(rj,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return r_(rj,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return r_(rj,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(t){return t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(t){return t instanceof rD&&(t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(t){if(!this.includesRange(t))return[];let e={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},r=[];return e.top===i.top&&r.push("top"),e.right===i.right&&r.push(r_(rj,this)?"left":"right"),e.bottom===i.bottom&&r.push("bottom"),e.left===i.left&&r.push(r_(rj,this)?"right":"left"),r}getInner(){let t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),i=[];for(let r=t.row;r<=e.row;r++)for(let o=t.col;o<=e.col;o++)this.from.row===r&&this.from.col===o||this.to.row===r&&this.to.col===o||i.push(this._createCellCoords(r,o));return i}getAll(){let t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),i=[];for(let r=t.row;r<=e.row;r++)for(let o=t.col;o<=e.col;o++)t.row===r&&t.col===o?i.push(t):e.row===r&&e.col===o?i.push(e):i.push(this._createCellCoords(r,o));return i}forAll(t){let e=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let r=e.row;r<=i.row;r++)for(let o=e.col;o<=i.col;o++)if(!1===t(r,o))return}clone(){return new rB(this.highlight,this.from,this.to,r_(rj,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(t,e){return new rD(t,e,r_(rj,this))}}function rW(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class rV{get eventManager(){return new t2.default(this)}constructor(t,e){rW(this,"wtTable",void 0),rW(this,"wtScroll",void 0),rW(this,"wtViewport",void 0),rW(this,"wtOverlays",void 0),rW(this,"selectionManager",void 0),rW(this,"wtEvent",void 0),rW(this,"guid",`wt_${(0,eX.randomString)()}`),rW(this,"drawInterrupted",!1),rW(this,"drawn",!1),rW(this,"domBindings",void 0),rW(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new rA(this.createScrollDao())}findOriginalHeaders(){let t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let e=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;e<i;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,i){(0,tZ.fastInnerText)(i,t[e])}])}}createCellCoords(t,e){return new rD(t,e,this.wtSettings.getSetting("rtlMode"))}createCellRange(t,e,i){return new rB(t,e,i,this.wtSettings.getSetting("rtlMode"))}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return this.wtTable.getCell(t);let i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<r&&t.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<s&&t.row>=i-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else if(t.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);else if(t.row<i&&t.row>=i-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t);return this.wtTable.getCell(t)}scrollViewport(t,e,i,r,o){return!(t.col<0)&&!(t.row<0)&&this.wtScroll.scrollViewport(t,e,i,r,o)}scrollViewportHorizontally(t,e,i){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,i)}scrollViewportVertically(t,e,i){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,i)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){let t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){let t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selectionManager(){return t.selectionManager},get drawn(){return t.drawn},set drawn(v){t.drawn=v},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return t.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return t.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return t.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return t.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return t.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return t.wtSettings.getSetting("rowHeaders")}}}}function rU(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class rz extends rV{constructor(t,e,i){super(t,e),rU(this,"cloneSource",void 0),rU(this,"cloneOverlay",void 0);let r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new iH(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}var iq=tn("4Pbrh");class rY{constructor(t,e,i,r,o){var s,n;(s="symbol"==typeof(n=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(s="wtSettings","string"))?n:n+"")in this?Object.defineProperty(this,s,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[s]=null,(0,t3.defineGetter)(this,"wot",t,{writable:!1}),this.domBindings=o,this.facadeGetter=e,this.wtSettings=r;let{TABLE:a,hider:l,spreader:h,holder:c,wtRootElement:d}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=l,this.spreader=h,this.holder=c,this.wtRootElement=d,this.trimmingContainer=(0,tZ.getTrimmingContainer)(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){let t=this.needFullRender;this.needFullRender=this.shouldBeRendered();let e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=(0,tZ.getTrimmingContainer)(this.hider.parentNode.parentNode)}updateMainScrollableElement(){let{wtTable:t}=this.wot,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=(0,tZ.getScrollableElement)(t.TABLE)}getRelativeCellPosition(t,e,i){if(!1===this.clone.wtTable.holder.contains(t)){(0,t6.warn)(`The provided element is not a child of the ${this.type} overlay`);return}let r=this.mainTableScrollableElement===this.domBindings.rootWindow,o=i<this.wtSettings.getSetting("fixedColumnsStart"),s=e<this.wtSettings.getSetting("fixedRowsTop"),n=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),a=this.clone.wtTable.spreader,l={start:this.getRelativeStartPosition(a),top:a.offsetTop},h={start:this.getRelativeStartPosition(t),top:t.offsetTop};return r?this.getRelativeCellPositionWithinWindow(s,o,h,l):this.getRelativeCellPositionWithinHolder(s,n,o,h,l)}getRelativeStartPosition(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}getRelativeCellPositionWithinWindow(t,e,i,r){let o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,n=0;if(e){let t=o.left;this.isRtl()&&(t=this.domBindings.rootWindow.innerWidth-(o.left+o.width+(0,tZ.getScrollbarWidth)())),s=t<=0?-1*t:0}else s=r.start;return n=t?this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:r.top,{start:i.start+s,top:i.top+n}}getRelativeCellPositionWithinHolder(t,e,i,r,o){let s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},n=0,a=0;if(i||(n=s.horizontal-o.start),e){let t=this.wot.wtTable.wtRootElement.getBoundingClientRect();a=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+t.top}else t||(a=s.vertical-o.top);return{start:r.start-n,top:r.top-a}}makeClone(){if(-1===rv.indexOf(this.type))throw Error(`Clone type "${this.type}" is not supported.`);let{wtTable:t,wtSettings:e}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=i.createElement("div"),s=i.createElement("table"),n=t.wtRootElement.parentNode;o.className=`${rw.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,e.getSetting("ariaTags")&&(0,tZ.setAttribute)(o,[(0,iq.A11Y_PRESENTATION)()]),s.className=t.TABLE.className,t.TABLE.getAttribute("role")&&s.setAttribute("role",t.TABLE.getAttribute("role")),o.appendChild(s),n.appendChild(o);let a=this.wtSettings.getSetting("preventOverflow");return!0===a||"horizontal"===a&&"top"===this.type||"vertical"===a&&this.type===rf?this.mainTableScrollableElement=r:"hidden"===r.getComputedStyle(n).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=(0,tZ.getScrollableElement)(t.TABLE),new rz(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}reset(){if(!this.clone)return;let t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,i=t.style,r=e.style,o=t.parentNode.style;(0,eu.arrayEach)([i,r,o],t=>{t.width="",t.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class rG extends rY{constructor(t,e,i,r,o,s){super(t,e,ry,i,r),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new rE(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wot:t}=this;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){let t=this.inlineStartOverlay.getOverlayOffset(),i=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]=`${t}px`,e.style.bottom=`${i}px`}else(0,tZ.resetCssTransform)(e),this.repositionOverlay();let i=(0,tZ.outerHeight)(this.clone.wtTable.TABLE),r=(0,tZ.outerWidth)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),e.style.height=`${i}px`,e.style.width=`${r}px`,!1}repositionOverlay(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode,o=0;e.hasVerticalScroll()||(o+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(o+=(0,tZ.getScrollbarWidth)(i)),r.style.bottom=`${o}px`}}tn("1C6fS");var tZ=tn("gFbQZ"),t3=tn("hwT6B");const r$={getFirstRenderedColumn(){let t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn(){let t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getFirstPartiallyVisibleColumn(){let t=this.dataAccessObject.startColumnPartiallyVisible;return null===t?-1:t},getLastRenderedColumn(){let t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn(){let t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getLastPartiallyVisibleColumn(){let t=this.dataAccessObject.endColumnPartiallyVisible;return null===t?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,t3.defineGetter)(r$,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});var t3=tn("hwT6B");class rX extends rC{constructor(t,e,i,r){super(t,e,i,r,rp)}}(0,t3.mixin)(rX,rS),(0,t3.mixin)(rX,r$);class rq extends rY{constructor(t,e,i,r){var o,s;super(t,e,rp,i,r),(o="symbol"==typeof(s=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o="cachedFixedRowsBottom","string"))?s:s+"")in this?Object.defineProperty(this,o,{value:-1,enumerable:!0,configurable:!0,writable:!0}):this[o]=-1,this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new rX(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;let{rootWindow:t}=this.domBindings,e=this.clone.wtTable.holder.parentNode;e.style.top="";let i=0,r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||r&&"vertical"===r?(i=this.getScrollPosition(),this.repositionOverlay()):(i=this.getOverlayOffset(),e.style.bottom=`${i}px`);let o=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),o}repositionOverlay(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode,o=0;e.hasVerticalScroll()||(o+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(o+=(0,tZ.getScrollbarWidth)(i)),r.style.bottom=`${o}px`}setScrollPosition(t){let{rootWindow:e}=this.domBindings,i=!1;return this.mainTableScrollableElement===e?(e.scrollTo((0,tZ.getWindowScrollLeft)(e),t),i=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){let{wtTable:i,wtSettings:r}=this.wot,o=r.getSetting("defaultRowHeight"),s=t,n=0;for(;s<e;){let t=i.getRowHeight(s);n+=void 0===t?o:t,s+=1}return n}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=(0,tZ.getScrollbarWidth)(i),s=this.clone.wtTable.holder.parentNode.style,n=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===n){let i=e.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(i-=o),i=Math.min(i,t.wtRootElement.scrollWidth),s.width=`${i}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let a=(0,tZ.outerHeight)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(a=0),s.height=`${a}px`}adjustRootChildrenSize(){let{holder:t}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}applyToDOM(){let t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(0===t)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let i=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,o=0;e&&r.offsetHeight!==r.clientHeight&&(o=(0,tZ.getScrollbarWidth)(this.domBindings.rootDocument)),e?(i+=this.sumCellSizes(0,t+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),i+=o,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,tZ.getScrollTop)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){let t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),r=this.domBindings.rootDocument.documentElement.clientHeight;(i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-r+t,0))>t-e&&(i=0)}return i}adjustHeaderBordersPosition(t){let e=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==e,r=this.wtSettings.getSetting("columnHeaders"),o=!1;if((i||0===e)&&r.length>0){let e=this.wot.wtTable.holder.parentNode,i=(0,tZ.hasClass)(e,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?((0,tZ.addClass)(e,"innerBorderBottom"),o=!i):((0,tZ.removeClass)(e,"innerBorderBottom"),o=i)}return o}}tn("1C6fS");var tZ=tn("gFbQZ"),t3=tn("hwT6B");const rK={getFirstRenderedRow(){let t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow(){let t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getFirstPartiallyVisibleRow(){let t=this.dataAccessObject.startRowPartiallyVisible;return null===t?-1:t},getLastRenderedRow(){let t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow(){let t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getLastPartiallyVisibleRow(){let t=this.dataAccessObject.endRowPartiallyVisible;return null===t?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,t3.defineGetter)(rK,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});var t3=tn("hwT6B");class rZ extends rC{constructor(t,e,i,r){super(t,e,i,r,rf)}}(0,t3.mixin)(rZ,rK),(0,t3.mixin)(rZ,rx);const rQ=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});class rJ extends rY{constructor(t,e,i,r){super(t,e,rf,i,r)}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new rZ(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wtTable:t}=this.wot;if(!this.needFullRender||!t.holder.parentNode)return!1;let{rootWindow:e}=this.domBindings,i=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow"),o=0;this.trimmingContainer!==e||r&&"horizontal"===r?(o=this.getScrollPosition(),(0,tZ.resetCssTransform)(i)):(o=this.getOverlayOffset()*(this.isRtl()?-1:1),(0,tZ.setOverlayPosition)(i,`${o}px`,"0px"));let s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(t){let{rootWindow:e}=this.domBindings,i=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,(0,tZ.getWindowScrollTop)(e)),i=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(t,e){let i=this.wtSettings.getSetting("defaultColumnWidth"),r=t,o=0;for(;r<e;)o+=this.wot.wtTable.getStretchedColumnWidth(r)||i,r+=1;return o}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:t}=this.wot,{rootDocument:e,rootWindow:i}=this.domBindings,r=(0,tZ.getScrollbarWidth)(e),o=this.clone.wtTable.holder.parentNode.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||"vertical"===s){let e=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(e-=r),e=Math.min(e,t.wtRootElement.scrollHeight),o.height=`${e}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;let n=(0,tZ.outerWidth)(this.clone.wtTable.TABLE);o.width=`${n}px`}adjustRootChildrenSize(){let{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(rQ.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+e}px`}applyToDOM(){let t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(0===t)this.spreader.style[e]="0";else throw Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(t,e){let{wtSettings:i}=this,r=i.getSetting("rowHeaders"),o=i.getSetting("fixedColumnsStart"),s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,n=0===o&&r.length>0&&!(0,tZ.hasClass)(s.parentNode,"innerBorderInlineStart")?1:0,a=this.getTableParentOffset(),l=0;return e&&this.wot.wtTable.getColumnWidth(t)>this.wot.wtViewport.getViewportWidth()&&(e=!1),e&&s.offsetWidth!==s.clientWidth&&(l=(0,tZ.getScrollbarWidth)(this.domBindings.rootDocument)),e?(a+=this.sumCellSizes(0,t+1),a-=this.wot.wtViewport.getViewportWidth(),a+=n):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),a+=l,(0,tZ.getMaximumScrollLeft)(this.mainTableScrollableElement)===a-n&&n>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(n),this.setScrollPosition(a)}getTableParentOffset(){let t=this.wtSettings.getSetting("preventOverflow"),e=0;return t||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs((0,tZ.getScrollLeft)(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){let{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow"),i=0;return this.trimmingContainer===t&&(!e||"horizontal"!==e)&&(i=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(i=0)),i}adjustHeaderBordersPosition(t){let e=this.wot.wtTable.holder.parentNode,i=this.wtSettings.getSetting("rowHeaders"),r=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?(0,tZ.removeClass)(e,"emptyRows"):(0,tZ.addClass)(e,"emptyRows");let o=!1;if(r&&!i.length)(0,tZ.addClass)(e,"innerBorderLeft innerBorderInlineStart");else if(!r&&i.length){let i=(0,tZ.hasClass)(e,"innerBorderInlineStart");t?((0,tZ.addClass)(e,"innerBorderLeft innerBorderInlineStart"),o=!i):((0,tZ.removeClass)(e,"innerBorderLeft innerBorderInlineStart"),o=i)}return o}}tn("1C6fS");var tZ=tn("gFbQZ"),t3=tn("hwT6B");const r0={getFirstRenderedRow(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,t3.defineGetter)(r0,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});var t3=tn("hwT6B");class r1 extends rC{constructor(t,e,i,r){super(t,e,i,r,rm)}}function r2(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}(0,t3.mixin)(r1,r0),(0,t3.mixin)(r1,rx);class r3 extends rY{constructor(t,e,i,r,o,s){super(t,e,rm,i,r),r2(this,"topOverlay",void 0),r2(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new r1(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;let t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){let e=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),i=this.topOverlay.getOverlayOffset();(0,tZ.setOverlayPosition)(t,`${e}px`,`${i}px`)}else(0,tZ.resetCssTransform)(t);let e=(0,tZ.outerHeight)(this.clone.wtTable.TABLE),i=(0,tZ.outerWidth)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(e=0),t.style.height=`${e}px`,t.style.width=`${i}px`,!1}}tn("1C6fS");var tZ=tn("gFbQZ"),t3=tn("hwT6B");class r6 extends rC{constructor(t,e,i,r){super(t,e,i,r,"top")}}(0,t3.mixin)(r6,r0),(0,t3.mixin)(r6,r$);class r4 extends rY{constructor(t,e,i,r){var o,s;super(t,e,"top",i,r),(o="symbol"==typeof(s=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o="cachedFixedRowsTop","string"))?s:s+"")in this?Object.defineProperty(this,o,{value:-1,enumerable:!0,configurable:!0,writable:!0}):this[o]=-1,this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new r6(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;let t=this.clone.wtTable.holder.parentNode,{rootWindow:e}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow"),r=0,o=!1;if(this.trimmingContainer!==e||i&&"vertical"===i)r=this.getScrollPosition(),(0,tZ.resetCssTransform)(t);else{let{wtTable:e}=this.wot;o=Math.ceil(e.hider.getBoundingClientRect().bottom)===t.offsetHeight,r=this.getOverlayOffset(),(0,tZ.setOverlayPosition)(t,"0px",`${r}px`)}let s=this.adjustHeaderBordersPosition(r,o);return this.adjustElementsSize(),s}setScrollPosition(t){let e=this.domBindings.rootWindow,i=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo((0,tZ.getWindowScrollLeft)(e),t),i=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){let i=this.wtSettings.getSetting("defaultRowHeight"),r=t,o=0;for(;r<e;){let t=this.wot.wtTable.getRowHeight(r);o+=void 0===t?i:t,r+=1}return o}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:t}=this.wot,{rootDocument:e,rootWindow:i}=this.domBindings,r=(0,tZ.getScrollbarWidth)(e),o=this.clone.wtTable.holder.parentNode.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||"horizontal"===s){let e=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(e-=r),e=Math.min(e,t.wtRootElement.scrollWidth),o.width=`${e}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let n=(0,tZ.outerHeight)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(n=0),o.height=`${n}px`}adjustRootChildrenSize(){let{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(rQ.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+e}px`}applyToDOM(){let t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(0===t)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let{wot:i,wtSettings:r}=this,o=(i.cloneSource?i.cloneSource:i).wtTable.holder,s=r.getSetting("columnHeaders"),n=0===r.getSetting("fixedRowsTop")&&s.length>0&&!(0,tZ.hasClass)(o.parentNode,"innerBorderTop")?1:0,a=this.getTableParentOffset(),l=0;if(e&&this.wot.wtTable.getRowHeight(t)>this.wot.wtViewport.getViewportHeight()&&(e=!1),e&&o.offsetHeight!==o.clientHeight&&(l=(0,tZ.getScrollbarWidth)(this.domBindings.rootDocument)),e){let e=r.getSetting("fixedRowsBottom"),o=r.getSetting("totalRows");a+=this.sumCellSizes(0,t+1),a-=i.wtViewport.getViewportHeight()-this.sumCellSizes(o-e,o),a+=1+n}else a+=this.sumCellSizes(r.getSetting("fixedRowsTop"),t);return a+=l,(0,tZ.getMaximumScrollTop)(this.mainTableScrollableElement)===a-n&&n>0&&this.wot.wtOverlays.expandHiderVerticallyBy(n),this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,tZ.getScrollTop)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){let t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight();(i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>t-e&&(i=0)}return i}adjustHeaderBordersPosition(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?(0,tZ.removeClass)(i,"emptyColumns"):(0,tZ.addClass)(i,"emptyColumns");let r=!1;if(!e){let e=this.wtSettings.getSetting("fixedRowsTop"),o=this.cachedFixedRowsTop!==e,s=this.wtSettings.getSetting("columnHeaders");if((o||0===e)&&s.length>0){let e=(0,tZ.hasClass)(i,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),t||0===this.wtSettings.getSetting("totalRows")?((0,tZ.addClass)(i,"innerBorderTop"),r=!e):((0,tZ.removeClass)(i,"innerBorderTop"),r=e)}}return r}}function r5(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var r9=class{constructor(t,e,i,r,o,s){r5(this,"wot",null),r5(this,"topOverlay",null),r5(this,"bottomOverlay",null),r5(this,"inlineStartOverlay",null),r5(this,"topInlineStartCornerOverlay",null),r5(this,"bottomInlineStartCornerOverlay",null),r5(this,"browserLineHeight",void 0),r5(this,"wtSettings",null),r5(this,"resizeObserver",new ResizeObserver(t=>{(0,iv.requestAnimationFrame)(()=>{Array.isArray(t)&&t.length&&this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=r,this.domBindings=i,this.facadeGetter=e,this.wtTable=s;let{rootDocument:n,rootWindow:a}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=(0,tZ.getScrollbarWidth)(n);let l="hidden"===a.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=l?s.holder:(0,tZ.getScrollableElement)(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=a.scrollX,this.lastScrollY=a.scrollY}getOverlays(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return t&&e.push(this.wtTable),e}initBrowserLineHeight(){let{rootWindow:t,rootDocument:e}=this.domBindings,i=t.getComputedStyle(e.body),r=parseInt(i.lineHeight,10),o=1.2*parseInt(i.fontSize,10);this.browserLineHeight=r||o}initOverlays(){let t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new r4(...t),this.bottomOverlay=new rq(...t),this.inlineStartOverlay=new rJ(...t),this.topInlineStartCornerOverlay=new r3(...t,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new rG(...t,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let t=this.topOverlay.updateStateOfRendering();return t=this.bottomOverlay.updateStateOfRendering()||t,t=this.inlineStartOverlay.updateStateOfRendering()||t,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(t=this.topInlineStartCornerOverlay.updateStateOfRendering()||t),this.bottomOverlay.needFullRender&&(t=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||t)),t}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){let t;let{rootDocument:e,rootWindow:i}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:o}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",t=>this.onKeyDown(t)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",t=>this.onTableScroll(t),{passive:!0}),r!==o&&this.eventManager.addEventListener(o,"scroll",t=>this.onTableScroll(t),{passive:!0});let s=i.devicePixelRatio&&i.devicePixelRatio>1,n=this.scrollableElement===i,a=this.wtSettings.getSetting("preventWheel"),l={passive:n};(a||s||!(0,t0.isChrome)())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",t=>this.onCloneWheel(t,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(t=>{if(t&&t.needFullRender){let{holder:e}=t.clone.wtTable;this.eventManager.addEventListener(e,"wheel",t=>this.onCloneWheel(t,a),l)}}),this.eventManager.addEventListener(i,"resize",()=>{clearTimeout(t),t=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),n||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(t){let e=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=t.target;(!this.keyPressed||(r===e||o===e||t.target.contains(r))&&(i===e||o===e||t.target.contains(i)))&&this.syncScrollPositions(t)}onCloneWheel(t,e){let{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=t.target,n=o!==i&&s!==i&&!s.contains(o),a=r!==i&&s!==i&&!s.contains(r);if(this.keyPressed&&(n||a))return;let l=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==i&&l)&&t.preventDefault()}onKeyDown(t){this.keyPressed=(0,iL.isKey)(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(t){let e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,i=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(i+=i*this.browserLineHeight,e+=e*this.browserLineHeight);let r=this.scrollVertically(e),o=this.scrollHorizontally(i);return r||o}scrollVertically(t){let e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}scrollHorizontally(t){let e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;let{rootWindow:t}=this.domBindings,e=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,[r,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=e.scrollLeft!==r||this.lastScrollX!==t.scrollX,this.verticalScrolling=i.scrollTop!==o||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=r;let t=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;t&&(t.scrollLeft=r)}this.verticalScrolling&&(i.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){let{scrollLeft:t,scrollTop:e}=this.topOverlay.mainTableScrollableElement;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=e)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();let{wtTable:t}=this,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=(0,tZ.getScrollableElement)(t.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}updateLastSpreaderSize(){let t=this.wtTable.spreader,e=t.clientWidth,i=t.clientHeight,r=e!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=i),r}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtViewport:e}=this.wot,{wtTable:i}=this,{rootWindow:r}=this.domBindings,o=this.scrollableElement===r,s=this.wtSettings.getSetting("totalColumns"),n=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),l=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,n)+1,h=a+this.inlineStartOverlay.sumCellSizes(0,s),c=i.hider.style,d=!o&&this.scrollableElement.scrollTop>Math.max(0,l-i.holder.clientHeight)?1:0,u=!o&&this.scrollableElement.scrollLeft>Math.max(0,h-i.holder.clientWidth)?1:0;if(c.width=`${h+u}px`,c.height=`${l+d}px`,this.scrollbarSize>0){let{scrollHeight:t,scrollWidth:e}=i.wtRootElement,{scrollHeight:r,scrollWidth:o}=i.holder;this.hasScrollbarRight=t<r,this.hasScrollbarBottom=e<o,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>e?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>t&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.inlineStartOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}expandHiderVerticallyBy(t){let{wtTable:e}=this;e.hider.style.height=`${parseInt(e.hider.style.height,10)+t}px`}expandHiderHorizontallyBy(t){let{wtTable:e}=this;e.hider.style.width=`${parseInt(e.hider.style.width,10)+t}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(t){if(!t)return null;let e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return(0,eu.arrayEach)(e,e=>{e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(i=e.clone)}),i}syncOverlayTableClassNames(){let t=this.wtTable.TABLE,e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];(0,eu.arrayEach)(e,e=>{e&&(e.clone.wtTable.TABLE.className=t.className)})}};tn("1C6fS");var tZ=tn("gFbQZ"),t3=tn("hwT6B");function r8(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class r7{constructor(t){r8(this,"settings",{}),r8(this,"defaults",Object.freeze(this.getDefaults())),(0,t3.objectEach)(this.defaults,(e,i)=>{if(void 0!==t[i])this.settings[i]=t[i];else if(void 0===e)throw Error(`A required setting "${i}" was not provided`);else this.settings[i]=e})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(t,e,i)=>{let r=this.getSetting("data",t,e);(0,tZ.fastInnerText)(i,null==r?"":r)},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:t=>t,onBeforeViewportScrollVertically:t=>t,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:t=>t,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:t=>t,onBeforeHighlightingColumnHeader:t=>t,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(t,e){return void 0===e?(0,t3.objectEach)(t,(t,e)=>{this.settings[e]=t}):this.settings[t]=e,this}getSetting(t,e,i,r,o){return"function"==typeof this.settings[t]?this.settings[t](e,i,r,o):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}getSettingPure(t){return this.settings[t]}has(t){return!!this.settings[t]}}var tZ=tn("gFbQZ"),t3=tn("hwT6B");class ot extends rC{constructor(t,e,i,r){super(t,e,i,r,"master")}alignOverlaysWithTrimmingContainer(){let t=(0,tZ.getTrimmingContainer)(this.wtRootElement),{rootWindow:e}=this.domBindings;if(t===e)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{let i=t.parentElement,r=(0,tZ.getStyle)(t,"height",e),o=(0,tZ.getStyle)(t,"overflow",e),s=this.holder.style,{scrollWidth:n,scrollHeight:a}=t,l=t.offsetWidth,h=t.offsetHeight;if(i&&["auto","hidden","scroll"].includes(o)){let r=t.cloneNode(!1);r.style.overflow="auto",r.style.position="absolute",t.nextElementSibling?i.insertBefore(r,t.nextElementSibling):i.appendChild(r);let o=parseInt((0,tZ.getComputedStyle)(r,e).height,10);i.removeChild(r),0===o&&(h=0)}h=Math.min(h,a),s.height="auto"===r?"auto":`${h}px`,l=Math.min(l,n),s.width=`${l}px`,s.overflow="",this.hasTableHeight="auto"===s.height||h>0,this.hasTableWidth=l>0}this.isTableVisible=(0,tZ.isVisible)(this.TABLE)}markOversizedColumnHeaders(){let{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject,i="master",r=t.getSetting("columnHeaders").length;if(r&&!e.hasOversizedColumnHeadersMarked[i]){let o=t.getSetting("rowHeaders").length,s=this.getRenderedColumnsCount();for(let t=0;t<r;t++)for(let t=-1*o;t<s;t++)this.markIfOversizedColumnHeader(t);e.hasOversizedColumnHeadersMarked[i]=!0}}}(0,t3.mixin)(ot,rK),(0,t3.mixin)(ot,r$);var tZ=tn("gFbQZ"),t3=tn("hwT6B");function oe(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}tn("1C6fS");class oi{constructor(t){oe(this,"count",0),oe(this,"startColumn",0),oe(this,"endColumn",0),oe(this,"startPosition",0),this.count=t.totalColumns,this.endColumn=this.count-1}}function or(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}tn("1C6fS");class oo{constructor(t){or(this,"count",0),or(this,"startRow",0),or(this,"endRow",0),or(this,"startPosition",0),this.count=t.totalRows,this.endRow=this.count-1}}tn("1C6fS");var tl=tn("hmx0d"),eA=tn("dZoqA"),os=tn("ptmgx"),on=tn("fBlGn"),oa={},ew=tn("blCy8"),ol={},eT=tn("hc2VB"),oh=tn("kxexm"),oc=tn("1TEKD"),od=tn("3RKYQ"),eT=tn("hc2VB"),ou=tn("6CGth"),og={},op=tn("gUxdt"),of=tn("jQUZd");og=Object.keys||function(t){return op(t,of)},X=oh&&!oc?Object.defineProperties:function(t,e){eT(t);for(var i,r=ou(e),o=og(e),s=o.length,n=0;s>n;)od.f(t,i=o[n++],r[i]);return t};var of=tn("jQUZd"),om=tn("dGabS"),tE=tn("1RN1j"),oy=tn("bgRz0"),ov="prototype",ow="script",ob=oy("IE_PROTO"),oC=function(){},oS=function(t){return"<"+ow+">"+t+"</"+ow+">"},ox=function(t){t.write(oS("")),t.close();var e=t.parentWindow.Object;return t=null,e},oE=function(){var t,e=tE("iframe");return e.style.display="none",tS.appendChild(e),e.src=String("java"+ow+":"),(t=e.contentWindow.document).open(),t.write(oS("document.F=Object")),t.close(),t.F},oR=function(){try{q=new ActiveXObject("htmlfile")}catch(t){}oR="undefined"!=typeof document?document.domain&&q?ox(q):oE():ox(q);for(var t=of.length;t--;)delete oR[ov][of[t]];return oR()};om[ob]=!0,ol=Object.create||function(t,e){var i;return null!==t?(oC[ov]=eT(t),i=new oC,oC[ov]=null,i[ob]=t):i=oR(),void 0===e?i:X(i,e)};var od=tn("3RKYQ"),oT=od.f,oM=ew("unscopables"),ok=Array.prototype;function oA(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function oO(t,e){return t.get(oP(t,e))}function oP(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}void 0===ok[oM]&&oT(ok,oM,{configurable:!0,value:ol(null)}),oa=function(t){ok[oM][t]=!0},tl({target:"Array",proto:!0},{at:function(t){var e=eA(this),i=os(e),r=on(t),o=r>=0?r:i+r;return o<0||o>=i?void 0:e[o]}}),oa("at"),tn("1hIp0");var oI=new WeakMap;class oH{static get DEFAULT_WIDTH(){return 50}constructor(t){var e;oA(this,"count",0),oA(this,"startColumn",null),oA(this,"endColumn",null),oA(this,"startPosition",null),oA(this,"isVisibleInTrimmingContainer",!1),e=void 0,function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,oI),oI.set(this,e),oI.set(oP(oI,this),t),this.calculate()}calculate(){let t;let{calculationType:e,overrideFn:i,scrollOffset:r,totalColumns:o,viewportWidth:s}=oO(oI,this),n=Math.max(oO(oI,this).scrollOffset,0),a=n>0?s+1:s,l=0,h=!0,c=[],d=0,u=0;for(let i=0;i<o;i++)if(t=this._getColumnWidth(i),l<=n&&2!==e&&(this.startColumn=i,d=t),l>=n&&l+(2===e?t:0)<=n+a&&((null===this.startColumn||void 0===this.startColumn)&&(this.startColumn=i,d=t),this.endColumn=i),c.push(l),l+=t,u=t,2!==e&&(this.endColumn=i),l>=n+s){h=!1;break}let g=2===e?0:u,p=2===e?d:0;if(r+s-a<-1*oO(oI,this).inlineStartOffset||r>c.at(-1)+g||-1*oO(oI,this).scrollOffset-oO(oI,this).viewportWidth>-1*p?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===o-1&&h)for(this.startColumn=this.endColumn;this.startColumn>0;){let i=c[this.endColumn]+t-c[this.startColumn-1];if((i<=s||2!==e)&&(this.startColumn-=1),i>s)break}1===e&&null!==this.startColumn&&i&&i(this),this.startPosition=c[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),o<this.endColumn&&(this.endColumn=o-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}_getColumnWidth(t){let e=oO(oI,this).columnWidthFn(t);return isNaN(e)&&(e=oH.DEFAULT_WIDTH),e}}function oL(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function oD(t,e){return t.get(oN(t,e))}function oN(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}tn("1C6fS"),tn("1hIp0");var o_=new WeakMap;class oF{static get DEFAULT_HEIGHT(){return 23}constructor(t){var e;oL(this,"count",0),oL(this,"startRow",null),oL(this,"endRow",null),oL(this,"startPosition",null),oL(this,"isVisibleInTrimmingContainer",!1),e=void 0,function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,o_),o_.set(this,e),o_.set(oN(o_,this),t),this.calculate()}calculate(){let t;let{calculationType:e,overrideFn:i,rowHeightFn:r,scrollOffset:o,totalRows:s,viewportHeight:n}=oD(o_,this),a=Math.max(oD(o_,this).scrollOffset,0),l=oD(o_,this).horizontalScrollbarHeight||0,h=0,c=!0,d=[],u=0,g=0;for(let i=0;i<s;i++)if(isNaN(t=r(i))&&(t=oF.DEFAULT_HEIGHT),h<=a&&2!==e&&(this.startRow=i,u=t),h>=a&&h+(2===e?t:0)<=a+n-l&&(null===this.startRow&&(this.startRow=i,u=t),this.endRow=i),d.push(h),h+=t,g=t,2!==e&&(this.endRow=i),h>=a+n-l){c=!1;break}let p=2===e?u:0,f=2===e?0:g;if(o+n-l<p||o>d.at(-1)+f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===s-1&&c)for(this.startRow=this.endRow;this.startRow>0;){let i=d[this.endRow]+t-d[this.startRow-1];if((i<=n-l||2!==e)&&(this.startRow-=1),i>=n-l)break}1===e&&null!==this.startRow&&i&&i(this),this.startPosition=d[this.startRow],void 0===this.startPosition&&(this.startPosition=null),s<this.endRow&&(this.endRow=s-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}var oj=class{constructor(t,e,i,r,o){this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=e,this.wtSettings=i,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){let t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer;return e===this.domBindings.rootWindow?t.documentElement.clientHeight:(0,tZ.outerHeight)(e)>0&&e.clientHeight>0?e.clientHeight:1/0}getWorkspaceWidth(){let t,e;let{wtSettings:i}=this,{rootDocument:r,rootWindow:o}=this.domBindings,s=this.dataAccessObject.inlineStartOverlayTrimmingContainer,n=r.documentElement.offsetWidth,a=i.getSetting("totalColumns"),l=i.getSetting("preventOverflow"),h=i.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),d=h?c.right-n:c.left,u=n-d;if(l)return(0,tZ.outerWidth)(this.wtTable.wtRootElement);if(t=i.getSetting("freezeOverlays")?Math.min(u,n):Math.min(this.getContainerFillWidth(),u,n),s===o&&a>0&&this.sumColumnWidths(0,a-1)>t)return r.documentElement.clientWidth;if(s!==o&&("scroll"===(e=(0,tZ.getStyle)(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o))||"hidden"===e||"auto"===e))return Math.max(t,s.clientWidth);let g=i.getSetting("stretchH");return"none"!==g&&g?t:Math.max(t,(0,tZ.outerWidth)(this.wtTable.TABLE))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(t,e){let i=0,r=t;for(;r<e;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;let t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);let i=e.offsetWidth;return this.containerWidth=i,t.removeChild(e),i}getWorkspaceOffset(){return(0,tZ.offset)(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,tZ.outerHeight)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let t=this.getWorkspaceHeight();if(t===1/0)return t;let e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}getRowHeaderWidth(){let t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(let i=0,r=e.length;i<r;i++)this.rowHeaderWidth+=t[i]||t}if(isNaN(this.rowHeaderWidth)){if(e.length){let t=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,r=e.length;i<r;i++)t?(this.rowHeaderWidth+=(0,tZ.outerWidth)(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){let t=this.getWorkspaceWidth();if(t===1/0)return t;let e=this.getRowHeaderWidth();return e>0?t-e:t}createRowsCalculator(){let t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,{wtSettings:r,wtTable:o}=this;if(r.getSetting("renderAllRows")&&1===i)return new oo({totalRows:r.getSetting("totalRows")});let s=this.getViewportHeight();this.rowHeaderWidth=NaN;let n=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,a=r.getSetting("fixedRowsTop"),l=r.getSetting("fixedRowsBottom"),h=r.getSetting("totalRows");return a&&n>=0&&(n+=e=this.dataAccessObject.topOverlay.sumCellSizes(0,a),s-=e),l&&this.dataAccessObject.bottomOverlay.clone&&(s-=e=this.dataAccessObject.bottomOverlay.sumCellSizes(h-l,h)),t=o.holder.clientHeight===o.holder.offsetHeight?0:(0,tZ.getScrollbarWidth)(this.domBindings.rootDocument),new oF({viewportHeight:s,scrollOffset:n,totalRows:r.getSetting("totalRows"),rowHeightFn:t=>o.getRowHeight(t),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),calculationType:i,horizontalScrollbarHeight:t})}createColumnsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,{wtSettings:e,wtTable:i}=this;if(e.getSetting("renderAllColumns")&&1===t)return new oi({totalColumns:e.getSetting("totalColumns")});let r=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;let s=e.getSetting("fixedColumnsStart");if(s&&o>=0){let t=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=t,r-=t}return i.holder.clientWidth!==i.holder.offsetWidth&&(r-=(0,tZ.getScrollbarWidth)(this.domBindings.rootDocument)),new oH({viewportWidth:r,scrollOffset:o,totalColumns:e.getSetting("totalColumns"),columnWidthFn:t=>i.getColumnWidth(t),overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),calculationType:t,inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtSettings:e}=this;if(t&&!e.getSetting("renderAllRows")){let e=this.createRowsCalculator(2);t=this.areAllProposedVisibleRowsAlreadyRendered(e)}if(t&&!e.getSetting("renderAllColumns")){let e=this.createColumnsCalculator(2);t=this.areAllProposedVisibleColumnsAlreadyRendered(e)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(1),this.columnsRenderCalculator=this.createColumnsCalculator(1)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(2),this.columnsVisibleCalculator=this.createColumnsCalculator(2)}createPartiallyVisibleCalculators(){this.rowsPartiallyVisibleCalculator=this.createRowsCalculator(3),this.columnsPartiallyVisibleCalculator=this.createColumnsCalculator(3)}areAllProposedVisibleRowsAlreadyRendered(t){if(!this.rowsVisibleCalculator)return!1;let{startRow:e,endRow:i,isVisibleInTrimmingContainer:r}=t;if(null===e&&null===i)return!r;let{startRow:o,endRow:s}=this.rowsRenderCalculator;return!(e<o)&&(e!==o||!(e>0))&&!(i>s||i===s&&i<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(t){if(!this.columnsVisibleCalculator)return!1;let{startColumn:e,endColumn:i,isVisibleInTrimmingContainer:r}=t;if(null===e&&null===i)return!r;let{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return!(e<o)&&(e!==o||!(e>0))&&!(i>s||i===s&&i<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){(0,t3.objectEach)(this.hasOversizedColumnHeadersMarked,(t,e,i)=>{i[e]=void 0})}};tn("1C6fS"),tn("1hIp0"),oa("flat");var tZ=tn("gFbQZ");tn("1C6fS");var tZ=tn("gFbQZ");function oB(t,e,i){oW(t,e),e.set(t,i)}function oW(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function oV(t,e){return t.get(oz(t,e))}function oU(t,e,i){return t.set(oz(t,e),i),i}function oz(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var oY=new WeakMap,oG=new WeakMap,o$=new WeakSet;class oX{constructor(){oW(this,o$),o$.add(this),oB(this,oY,void 0),oB(this,oG,void 0)}setActiveOverlay(t){return oU(oG,this,t),this}setActiveSelection(t){return oU(oY,this,t),this}scan(){let t=oV(oY,this).settings.selectionType,e=new Set;return"active-header"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t))):"area"===t?this.scanCellsRange(t=>e.add(t)):"focus"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t)),this.scanCellsRange(t=>e.add(t))):"fill"===t?this.scanCellsRange(t=>e.add(t)):"header"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t))):"row"===t?(this.scanRowsInHeadersRange(t=>e.add(t)),this.scanRowsInCellsRange(t=>e.add(t))):"column"===t&&(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanColumnsInCellsRange(t=>e.add(t))),e}scanColumnsInHeadersRange(t){let[e,i,r,o]=oV(oY,this).getCorners(),{wtTable:s}=oV(oG,this),n=s.getRenderedColumnsCount(),a=s.getColumnHeadersCount(),l=0;for(let h=-s.getRowHeadersCount();h<n;h++){let n=s.columnFilter.renderedToSource(h);if(!(n<i)&&!(n>o)){for(let h=-a;h<0;h++){if(h<e||h>r)continue;let c=h+a,d=s.getColumnHeader(n,c),u=oV(oG,this).getSetting("onBeforeHighlightingColumnHeader",n,c,{selectionType:oV(oY,this).settings.selectionType,columnCursor:l,selectionWidth:o-i+1});null!==u&&(u!==n&&(d=s.getColumnHeader(u,c)),t(d))}l+=1}}}scanRowsInHeadersRange(t){let[e,i,r,o]=oV(oY,this).getCorners(),{wtTable:s}=oV(oG,this),n=s.getRenderedRowsCount(),a=s.getRowHeadersCount(),l=0;for(let h=-s.getColumnHeadersCount();h<n;h++){let n=s.rowFilter.renderedToSource(h);if(!(n<e)&&!(n>r)){for(let h=-a;h<0;h++){if(h<i||h>o)continue;let c=h+a,d=s.getRowHeader(n,c),u=oV(oG,this).getSetting("onBeforeHighlightingRowHeader",n,c,{selectionType:oV(oY,this).settings.selectionType,rowCursor:l,selectionHeight:r-e+1});null!==u&&(u!==n&&(d=s.getRowHeader(u,c)),t(d))}l+=1}}}scanCellsRange(t){let[e,i,r,o]=oV(oY,this).getCorners(),{wtTable:s}=oV(oG,this);oz(o$,this,oq).call(this,(n,a)=>{if(n>=e&&n<=r&&a>=i&&a<=o){let e=s.getCell(oV(oG,this).createCellCoords(n,a)),i=oV(oG,this).getSetting("onAfterDrawSelection",n,a,oV(oY,this).settings.layerLevel);"string"==typeof i&&(0,tZ.addClass)(e,i),t(e)}})}scanRowsInCellsRange(t){let[e,,i]=oV(oY,this).getCorners(),{wtTable:r}=oV(oG,this);oz(o$,this,oq).call(this,(o,s)=>{o>=e&&o<=i&&t(r.getCell(oV(oG,this).createCellCoords(o,s)))})}scanColumnsInCellsRange(t){let[,e,,i]=oV(oY,this).getCorners(),{wtTable:r}=oV(oG,this);oz(o$,this,oq).call(this,(o,s)=>{s>=e&&s<=i&&t(r.getCell(oV(oG,this).createCellCoords(o,s)))})}}function oq(t){let{wtTable:e}=oV(oG,this),i=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let o=0;o<i;o+=1){let i=e.rowFilter.renderedToSource(o);for(let o=0;o<r;o+=1)t(i,e.columnFilter.renderedToSource(o))}}var tZ=tn("gFbQZ"),iy=tn("7HxIw"),t3=tn("hwT6B"),t0=tn("eL8cl"),oK=class{constructor(t,e){if(!e)return;this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=rQ,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners()}registerListeners(){let t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(t,"mouseup",()=>this.onMouseUp());for(let t=0,e=this.main.childNodes.length;t<e;t++){let e=this.main.childNodes[t];this.eventManager.addEventListener(e,"mouseenter",e=>this.onMouseEnter(e,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(t,e){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;t.preventDefault(),(0,iy.stopImmediatePropagation)(t);let i=this,r=this.wot.rootDocument.body,o=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(r,"mousemove",function t(s){(function(t){if(t.clientY<Math.floor(o.top)||t.clientY>Math.ceil(o.top+o.height)||t.clientX<Math.floor(o.left)||t.clientX>Math.ceil(o.left+o.width))return!0})(s)&&(i.eventManager.removeEventListener(r,"mousemove",t),e.style.display="block")})}createBorders(t){let{rootDocument:e}=this.wot;this.main=e.createElement("div");let i=["top","start","bottom","end","corner"],r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let o=0;o<5;o++){let s=i[o],n=e.createElement("div");n.className=`wtBorder ${this.settings.className||""}`,this.settings[s]&&this.settings[s].hide&&(n.className+=" hidden"),(r=n.style).backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:t.border.color,r.height=this.settings[s]&&this.settings[s].width?`${this.settings[s].width}px`:`${t.border.width}px`,r.width=this.settings[s]&&this.settings[s].width?`${this.settings[s].width}px`:`${t.border.width}px`,this.main.appendChild(n)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,t0.isMobileBrowser)()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();let{wtTable:o}=this.wot,s=o.bordersHolder;s||((s=e.createElement("div")).className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){let{rootDocument:t}=this.wot;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};let e={position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`};(0,t3.objectEach)(e,(t,e)=>{this.selectionHandles.styles.bottomHitArea[e]=t,this.selectionHandles.styles.topHitArea[e]=t});let i={position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};(0,t3.objectEach)(i,(t,e)=>{this.selectionHandles.styles.bottom[e]=t,this.selectionHandles.styles.top[e]=t}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(t,e){let i=this.wot.selectionManager.getAreaSelection();return!!i.cellRange&&(t!==i.cellRange.to.row||e!==i.cellRange.to.col)}updateMultipleSelectionHandlesPosition(t,e,i,r,o,s){let n=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:a,topHitArea:l,bottom:h,bottomHitArea:c}=this.selectionHandles.styles,d=parseInt(a.borderWidth,10),u=parseInt(a.width,10),g=parseInt(l.width,10),p=this.wot.wtTable.getWidth(),f=this.wot.wtTable.getHeight();a.top=`${parseInt(i-u-1,10)}px`,a[n]=`${parseInt(r-u-1,10)}px`,l.top=`${parseInt(i-g/4*3,10)}px`,l[n]=`${parseInt(r-g/4*3,10)}px`;let m=Math.min(parseInt(r+o,10),p-u-2*d),y=Math.min(parseInt(r+o-g/4,10),p-g-2*d);h[n]=`${m}px`,c[n]=`${y}px`;let w=Math.min(parseInt(i+s,10),f-u-2*d),b=Math.min(parseInt(i+s-g/4,10),f-g-2*d);h.top=`${w}px`,c.top=`${b}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(a.display="block",l.display="block",this.isPartRange(t,e)?(h.display="none",c.display="none"):(h.display="block",c.display="block")):(a.display="none",h.display="none",l.display="none",c.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(a.zIndex="9999",l.zIndex="9999"):(a.zIndex="",l.zIndex="")}appear(t){let e,i,r,o,s,n;if(this.disabled)return;let{wtTable:a,rootDocument:l,rootWindow:h}=this.wot,c=a.getRenderedRowsCount();for(let i=0;i<c;i+=1){let r=a.rowFilter.renderedToSource(i);if(r>=t[0]&&r<=t[2]){e=r,s=t[0];break}}for(let e=c-1;e>=0;e-=1){let r=a.rowFilter.renderedToSource(e);if(r>=t[0]&&r<=t[2]){i=r;break}}let d=a.getRenderedColumnsCount();for(let e=0;e<d;e+=1){let i=a.columnFilter.renderedToSource(e);if(i>=t[1]&&i<=t[3]){r=i,n=t[1];break}}for(let e=d-1;e>=0;e-=1){let i=a.columnFilter.renderedToSource(e);if(i>=t[1]&&i<=t[3]){o=i;break}}if(void 0===e||void 0===r){this.disappear();return}let u=a.getCell(this.wot.createCellCoords(e,r)),g=e!==i||r!==o,p=g?a.getCell(this.wot.createCellCoords(i,o)):u,f=(0,tZ.offset)(u),m=g?(0,tZ.offset)(p):f,y=(0,tZ.offset)(a.TABLE),w=(0,tZ.outerWidth)(a.TABLE),b=f.top,C=f.left,S=this.wot.wtSettings.getSetting("rtlMode"),x=0,E=0;if(S){let t=(0,tZ.outerWidth)(u),e=h.innerWidth-y.left-w;E=C+t-m.left,x=h.innerWidth-C-t-e-1}else E=m.left+(0,tZ.outerWidth)(p)-C,x=C-y.left-1;if(this.isEntireColumnSelected(e,i)){let t=this.getDimensionsFromHeader("columns",r,o,s,y),e=null;t&&([e,x,E]=t),e&&(u=e)}let R=b-y.top-1,T=m.top+(0,tZ.outerHeight)(p)-b;if(this.isEntireRowSelected(r,o)){let t=this.getDimensionsFromHeader("rows",e,i,n,y),r=null;t&&([r,R,T]=t),r&&(u=r)}let M=(0,tZ.getComputedStyle)(u,h);parseInt(M.borderTopWidth,10)>0&&(R+=1,T=T>0?T-1:0),parseInt(M[S?"borderRightWidth":"borderLeftWidth"],10)>0&&(x+=1,E=E>0?E-1:0);let k=S?"right":"left";this.topStyle.top=`${R}px`,this.topStyle[k]=`${x}px`,this.topStyle.width=`${E}px`,this.topStyle.display="block",this.startStyle.top=`${R}px`,this.startStyle[k]=`${x}px`,this.startStyle.height=`${T}px`,this.startStyle.display="block";let A=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${R+T-A}px`,this.bottomStyle[k]=`${x}px`,this.bottomStyle.width=`${E}px`,this.bottomStyle.display="block",this.endStyle.top=`${R}px`,this.endStyle[k]=`${x+E-A}px`,this.endStyle.height=`${T+1}px`,this.endStyle.display="block";let O=this.settings.border.cornerVisible;O="function"==typeof O?O(this.settings.layerLevel):O;let P=this.wot.getSetting("onModifyGetCellCoords",i,o),[I,H]=[i,o];if(P&&Array.isArray(P)&&([,,I,H]=P),(0,t0.isMobileBrowser)()||!O||this.isPartRange(I,H))this.cornerStyle.display="none";else{this.cornerStyle.top=`${R+T+this.cornerCenterPointOffset-1}px`,this.cornerStyle[k]=`${x+E+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let t=(0,tZ.getTrimmingContainer)(a.TABLE),e=t===h;e&&(t=l.documentElement);let r=parseInt(this.cornerDefaultStyle.width,10)/2,s=parseInt(this.cornerDefaultStyle.height,10)/2;if(o===this.wot.getSetting("totalColumns")-1){let i=e?p.getBoundingClientRect().left:p.offsetLeft;(S?i-parseInt(this.cornerDefaultStyle.width,10)/2<0:i+(0,tZ.outerWidth)(p)+parseInt(this.cornerDefaultStyle.width,10)/2>=(0,tZ.innerWidth)(t))&&(this.cornerStyle[k]=`${Math.floor(x+E+this.cornerCenterPointOffset-r)}px`,this.cornerStyle[S?"borderLeftWidth":"borderRightWidth"]=0)}i===this.wot.getSetting("totalRows")-1&&(e?p.getBoundingClientRect().top:p.offsetTop)+(0,tZ.outerHeight)(p)+parseInt(this.cornerDefaultStyle.height,10)/2>=(0,tZ.innerHeight)(t)&&(this.cornerStyle.top=`${Math.floor(R+T+this.cornerCenterPointOffset-s)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}(0,t0.isMobileBrowser)()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,R,x,E,T)}isEntireColumnSelected(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(t,e,i,r,o){let{wtTable:s}=this.wot,n=s.wtRootElement.parentNode,a=null,l=null,h=null,c=null,d=null,u=null,g=null,p=null;switch(t){case"rows":a=function(){return s.getRowHeader(...arguments)},l=function(){return(0,tZ.outerHeight)(...arguments)},h="ht__selection--rows",u="top";break;case"columns":a=function(){return s.getColumnHeader(...arguments)},l=function(){return(0,tZ.outerWidth)(...arguments)},h="ht__selection--columns",u="left"}if(n.classList.contains(h)){let t=this.wot.getSetting("columnHeaders").length;if(g=a(e,t-r),p=a(i,t-r),!g||!p)return!1;let s=(0,tZ.offset)(g),n=(0,tZ.offset)(p);return g&&p&&(c=s[u]-o[u]-1,d=n[u]+l(p)-s[u]),[g,c,d]}return!1}changeBorderStyle(t,e){let i=this[t].style,r=e[t];!r||r.hide?(0,tZ.addClass)(this[t],"hidden"):((0,tZ.hasClass)(this[t],"hidden")&&(0,tZ.removeClass)(this[t],"hidden"),i.backgroundColor=r.color,("top"===t||"bottom"===t)&&(i.height=`${r.width}px`),("start"===t||"end"===t)&&(i.width=`${r.width}px`))}changeBorderToDefaultStyle(t){let e=this[t].style;e.backgroundColor="#000",e.width="1px",e.height="1px"}toggleHiddenClass(t,e){this.changeBorderToDefaultStyle(t),e?(0,tZ.addClass)(this[t],"hidden"):(0,tZ.removeClass)(this[t],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",(0,t0.isMobileBrowser)()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}};function oZ(t,e,i){oQ(t,e),e.set(t,i)}function oQ(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function oJ(t,e){return t.get(o1(t,e))}function o0(t,e,i){return t.set(o1(t,e),i),i}function o1(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var o2=new WeakMap,o3=new WeakMap,o6=new WeakMap,o4=new WeakMap,o5=new WeakMap,o9=new WeakMap,o8=new WeakSet;class o7{constructor(t){oQ(this,o8),o8.add(this),oZ(this,o2,void 0),oZ(this,o3,void 0),oZ(this,o6,new oX),oZ(this,o4,new WeakMap),oZ(this,o5,new WeakSet),oZ(this,o9,new Map),o0(o3,this,t)}setActiveOverlay(t){return o0(o2,this,t),oJ(o6,this).setActiveOverlay(oJ(o2,this)),oJ(o4,this).has(oJ(o2,this))||oJ(o4,this).set(oJ(o2,this),new Set),this}getFocusSelection(){return null!==oJ(o3,this)?oJ(o3,this).getFocus():null}getAreaSelection(){return null!==oJ(o3,this)?oJ(o3,this).createLayeredArea():null}getBorderInstance(t){if(!t.settings.border)return null;if(oJ(o9,this).has(t)){let e=oJ(o9,this).get(t);if(e.has(oJ(o2,this)))return e.get(oJ(o2,this));let i=new oK(oJ(o2,this),t.settings);return e.set(oJ(o2,this),i),i}let e=new oK(oJ(o2,this),t.settings);return oJ(o9,this).set(t,new Map([[oJ(o2,this),e]])),e}getBorderInstances(t){var e,i;return Array.from(null!==(e=null===(i=oJ(o9,this).get(t))||void 0===i?void 0:i.values())&&void 0!==e?e:[])}destroyBorders(t){oJ(o9,this).get(t).forEach(t=>t.destroy()),oJ(o9,this).delete(t)}render(t){if(null===oJ(o3,this))return;t&&o1(o8,this,st).call(this);let e=Array.from(oJ(o3,this)),i=new Map,r=new Map;for(let t=0;t<e.length;t++){let o=e[t],{className:s,headerAttributes:n,createLayers:a,selectionType:l}=o.settings;oJ(o5,this).has(o)||(oJ(o5,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));let h=this.getBorderInstance(o);if(o.isEmpty()){null==h||h.disappear();continue}s&&oJ(o6,this).setActiveSelection(o).scan().forEach(t=>{if(i.has(t)){let e=i.get(t);e.has(s)&&!0===a?e.set(s,e.get(s)+1):e.set(s,1)}else i.set(t,new Map([[s,1]]));n&&(r.has(t)||r.set(t,[]),"TH"===t.nodeName&&r.get(t).push(...n))});let c=o.getCorners();oJ(o2,this).getSetting("onBeforeDrawBorders",c,l),null==h||h.appear(c)}i.forEach((t,e)=>{var i;let r=Array.from(t).map(t=>{let[e,i]=t;return 1===i?e:[e,...Array.from({length:i-1},(t,i)=>`${e}-${i+1}`)]}).flat();r.forEach(t=>oJ(o4,this).get(oJ(o2,this)).add(t)),(0,tZ.addClass)(e,r),"TD"===e.nodeName&&Array.isArray(null===(i=oJ(o3,this).options)||void 0===i?void 0:i.cellAttributes)&&(0,tZ.setAttribute)(e,oJ(o3,this).options.cellAttributes)}),Array.from(r.keys()).forEach(t=>{(0,tZ.setAttribute)(t,[...r.get(t)])})}}function st(){let t=oJ(o4,this).get(oJ(o2,this)),e=oJ(o2,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let i=0;i<e.length;i++)t.add(e[i]);t.forEach(t=>{var e,i;let r=oJ(o2,this).wtTable.TABLE.querySelectorAll(`.${t}`),o=[];Array.isArray(null===(e=oJ(o3,this).options)||void 0===e?void 0:e.cellAttributes)&&(o=oJ(o3,this).options.cellAttributes.map(t=>t[0])),Array.isArray(null===(i=oJ(o3,this).options)||void 0===i?void 0:i.headerAttributes)&&(o=[...o,...oJ(o3,this).options.headerAttributes.map(t=>t[0])]);for(let e=0,i=r.length;e<i;e++)(0,tZ.removeClass)(r[e],t),(0,tZ.removeAttribute)(r[e],o)}),t.clear()}var t3=tn("hwT6B"),tZ=tn("gFbQZ");class se extends rV{constructor(t,e){super(t,new r7(e));let i=this.wtSettings.getSetting("facade",this);this.wtTable=new ot(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new oj(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new o7(this.wtSettings.getSetting("selections")),this.wtEvent=new iH(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new r9(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){let t=[],e=[];(0,t3.objectEach)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(i,r)=>{this.wtSettings.getSetting(r).length&&e.push(i),t.push(i)}),(0,tZ.removeClass)(this.wtTable.wtRootElement.parentNode,t),(0,tZ.addClass)(this.wtTable.wtRootElement.parentNode,e)}getViewportDao(){let t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}class si{constructor(t){t instanceof rV?this._wot=t:this._initFromSettings(t)}_initFromSettings(t){t.facade=t=>{let e=new si(t);return()=>e},this._wot=new se(t.table,t)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(t){this._wot.drawn=t}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(t){this._wot.drawInterrupted=t}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(t){this._wot.lastMouseOver=t}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(t){this._wot.momentumScrolling=t}get touchApplied(){return this._wot.touchApplied}set touchApplied(t){this._wot.touchApplied=t}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(t){this._wot.eventListeners=t}get eventManager(){return this._wot.eventManager}createCellCoords(t,e){return this._wot.createCellCoords(t,e)}createCellRange(t,e,i){return this._wot.createCellRange(t,e,i)}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}scrollViewport(t,e,i,r,o){return this._wot.scrollViewport(t,e,i,r,o)}scrollViewportHorizontally(t,e,i){return this._wot.scrollViewportHorizontally(t,e,i)}scrollViewportVertically(t,e,i){return this._wot.scrollViewportVertically(t,e,i)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(t,e){return this._wot.wtSettings.update(t,e),this}getSetting(t,e,i,r,o){return this._wot.wtSettings.getSetting(t,e,i,r,o)}hasSetting(t){return this._wot.wtSettings.hasSetting(t)}destroy(){this._wot.destroy()}}var iy=tn("7HxIw");function sr(t){let{isShiftKey:e,isLeftClick:i,isRightClick:r,coords:o,selection:s,controller:n,cellCoordsFactory:a}=t,l=s.isSelected()?s.getSelectedRange().current():null,h=s.isSelectedByCorner(),c=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)o.row>=0&&o.col>=0&&!n.cell?s.setRangeEnd(o):(h||c)&&o.row>=0&&o.col>=0&&!n.cell?s.setRangeEnd(a(o.row,o.col)):h&&o.row<0&&!n.column?s.setRangeEnd(a(l.to.row,o.col)):c&&o.col<0&&!n.row?s.setRangeEnd(a(o.row,l.to.col)):(!h&&!c&&o.col<0||h&&o.col<0)&&!n.row?s.selectRows(Math.max(l.from.row,0),o.row,o.col):(!h&&!c&&o.row<0||c&&o.row<0)&&!n.column&&s.selectColumns(Math.max(l.from.col,0),o.col,o.row);else{let t=!s.inInSelection(o),e=i||r&&t;o.row<0&&o.col>=0&&!n.column?e&&s.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!n.row?e&&s.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!n.cell?e&&s.setRangeStart(o):o.col<0&&o.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}const so=new Map([["mousedown",sr],["mouseover",function(t){let{isLeftClick:e,coords:i,selection:r,controller:o,cellCoordsFactory:s}=t;if(!e)return;let n=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),h=r.tableProps.countRows();r.markSource("mouse"),a&&!o.column?r.setRangeEnd(s(h-1,i.col)):n&&!o.row?r.setRangeEnd(s(i.row,l-1)):o.cell||r.setRangeEnd(i),r.markEndSource()}],["touchstart",sr]]);function ss(t,e){let{coords:i,selection:r,controller:o,cellCoordsFactory:s}=e;so.get(t.type)({coords:i,selection:r,controller:o,cellCoordsFactory:s,isShiftKey:t.shiftKey,isLeftClick:(0,iy.isLeftClick)(t)||"touchstart"===t.type,isRightClick:(0,iy.isRightClick)(t)})}const sn=new WeakMap,sa=Symbol("rootInstance");function sl(t){return sn.has(t)}var iq=tn("4Pbrh");function sh(t,e,i){sc(t,e),e.set(t,i)}function sc(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function sd(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function su(t,e){return t.get(sp(t,e))}function sg(t,e,i){return t.set(sp(t,e),i),i}function sp(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var sf=new WeakMap,sm=new WeakMap,sy=new WeakMap,sv=new WeakMap,sw=new WeakMap,sb=new WeakMap,sC=new WeakMap,sS=new WeakSet;function sx(){return parseInt(this.hot.rootElement.getAttribute((0,iq.A11Y_COLCOUNT)()[0]),10)}function sE(t){let e=sp(sS,this,sx).call(this)+t;(0,tZ.setAttribute)(this.hot.rootElement,...(0,iq.A11Y_COLCOUNT)(e))}var sR=class{constructor(t){sc(this,sS),sS.add(this),sd(this,"hot",void 0),sd(this,"eventManager",void 0),sd(this,"settings",void 0),sd(this,"THEAD",void 0),sd(this,"TBODY",void 0),sd(this,"_wt",void 0),sd(this,"activeWt",void 0),sh(this,sf,0),sh(this,sm,0),sd(this,"postponedAdjustElementsSize",!1),sh(this,sy,!1),sh(this,sv,void 0),sh(this,sw,void 0),sh(this,sb,0),sh(this,sC,0),this.hot=t,this.eventManager=new t2.default(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(t)}getCellAtCoords(t,e){let i=this._wt.getCell(t,e);return i<0?null:i}scrollViewport(t,e,i,r,o){return this._wt.scrollViewport(t,e,i,r,o)}scrollViewportHorizontally(t,e,i){return this._wt.scrollViewportHorizontally(t,e,i)}scrollViewportVertically(t,e,i){return this._wt.scrollViewportVertically(t,e,i)}createElements(){let{rootElement:t,rootDocument:e}=this.hot,i=t.getAttribute("style");i&&t.setAttribute("data-originalstyle",i),(0,tZ.addClass)(t,"handsontable"),sg(sw,this,e.createElement("TABLE")),(0,tZ.addClass)(su(sw,this),"htCore"),this.hot.getSettings().tableClassName&&(0,tZ.addClass)(su(sw,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&((0,tZ.setAttribute)(su(sw,this),[(0,iq.A11Y_PRESENTATION)()]),(0,tZ.setAttribute)(t,[(0,iq.A11Y_TREEGRID)(),(0,iq.A11Y_ROWCOUNT)(-1),(0,iq.A11Y_COLCOUNT)(this.hot.countCols()),(0,iq.A11Y_MULTISELECTABLE)()])),this.THEAD=e.createElement("THEAD"),su(sw,this).appendChild(this.THEAD),this.TBODY=e.createElement("TBODY"),su(sw,this).appendChild(this.TBODY),this.hot.table=su(sw,this),this.hot.container.insertBefore(su(sw,this),this.hot.container.firstChild)}registerEvents(){let{rootElement:t,rootDocument:e,selection:i,rootWindow:r}=this.hot,o=e.documentElement;this.eventManager.addEventListener(t,"mousedown",t=>{sg(sy,this,!0),this.isTextSelectionAllowed(t.target)||((0,tZ.clearTextSelection)(r),t.preventDefault(),r.focus())}),this.eventManager.addEventListener(t,"mouseup",()=>{sg(sy,this,!1)}),this.eventManager.addEventListener(t,"mousemove",t=>{su(sy,this)&&!this.isTextSelectionAllowed(t.target)&&(this.settings.fragmentSelection&&(0,tZ.clearTextSelection)(r),t.preventDefault())}),this.eventManager.addEventListener(o,"keyup",t=>{i.isInProgress()&&!t.shiftKey&&i.finish()}),this.eventManager.addEventListener(o,"mouseup",r=>{i.isInProgress()&&(0,iy.isLeftClick)(r)&&i.finish(),sg(sv,this,!1);let o=(0,tZ.isOutsideInput)(e.activeElement);(0,tZ.isInput)(e.activeElement)&&!o||!o&&(i.isSelected()||i.isSelectedByAnyHeader()||t.contains(r.target)||(0,iy.isRightClick)(r))||this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",t=>{i.isInProgress()&&(0,iy.isRightClick)(t)&&(i.finish(),sg(sv,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{i.isInProgress()&&i.finish(),sg(sv,this,!1)}),this.eventManager.addEventListener(o,"mousedown",i=>{let r=i.target,s=i.x||i.clientX,n=i.y||i.clientY,a=i.target;if(su(sv,this)||!t||!this.hot.view)return;let{holder:l}=this.hot.view._wt.wtTable;if(a===l){let t=(0,tZ.getScrollbarWidth)(e);if(e.elementFromPoint(s+t,n)!==l||e.elementFromPoint(s,n+t)!==l)return}else for(;a!==o;){if(null===a){if(i.isTargetWebComponent)break;return}if(a===t)return;a=a.parentNode}("function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(r):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=(0,tZ.getParentWindow)(r);for(;null!==s;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=(0,tZ.getParentWindow)(s);this.eventManager.addEventListener(su(sw,this),"selectstart",t=>{this.settings.fragmentSelection||(0,tZ.isInput)(t.target)||t.preventDefault()})}translateFromRenderableToVisualCoords(t){let{row:e,col:i}=t;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(e,i))}translateFromRenderableToVisualIndex(t,e){let i=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t,r=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===i&&(i=t),null===r&&(r=e),[i,r]}countRenderableIndexes(t,e){let i=Math.min(t.getNotTrimmedIndexesLength(),e),r=t.getNearestNotHiddenIndex(i-1,-1);return null===r?0:t.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(t,e,i,r){if(isNaN(t)||t<0)return 0;let o=i.getNearestNotHiddenIndex(t,e),s=i.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let n=0;return e<0?n=s+1:e>0&&(n=r-s),n}countNotHiddenFixedColumnsStart(){let t=this.hot.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}countNotHiddenFixedRowsTop(){let t=this.hot.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}countNotHiddenFixedRowsBottom(){let t=Math.max(this.hot.countRows()-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(t,e){let i=0;for(let r=t;r<=e;r++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)&&(i+=1);return i}countRenderableRowsInRange(t,e){let i=0;for(let r=t;r<=e;r++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)&&(i+=1);return i}isMainTableNotFullyCoveredByOverlays(){let t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>t&&this.hot.countRenderedCols()>e}initializeWalkontable(){let t={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:su(sw,this),isDataViewInstance:()=>sl(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(t,e)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(t,e)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{let t=[];return this.hot.hasRowHeaders()&&t.push((t,e)=>{let i=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t;this.appendRowHeader(i,e)}),this.hot.runHooks("afterGetRowHeaderRenderers",t),sg(sm,this,t.length),this.hot.getSettings().ariaTags&&sp(sS,this,sx).call(this)===this.hot.countCols()&&sp(sS,this,sE).call(this,su(sm,this)),t},columnHeaders:()=>{let t=[];return this.hot.hasColHeaders()&&t.push((t,e)=>{let i=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;this.appendColHeader(i,e)}),this.hot.runHooks("afterGetColumnHeaderRenderers",t),sg(sf,this,t.length),t},columnWidth:t=>{let e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getColWidth(null===e?t:e)},rowHeight:t=>{let e=this.hot.rowIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getRowHeight(null===e?t:e)},cellRenderer:(t,e,i)=>{let[r,o]=this.translateFromRenderableToVisualIndex(t,e),s=this.hot.runHooks("modifyGetCellCoords",r,o),n=r,a=o;Array.isArray(s)&&([n,a]=s);let l=this.hot.getCellMeta(n,a),h=this.hot.colToProp(a),c=this.hot.getDataAtRowProp(n,h);this.hot.hasHook("beforeValueRender")&&(c=this.hot.runHooks("beforeValueRender",c,l)),this.hot.runHooks("beforeRenderer",i,r,o,h,c,l),this.hot.getCellRenderer(l)(this.hot,i,r,o,h,c,l),this.hot.runHooks("afterRenderer",i,r,o,h,c,l)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&(0,tZ.isVisible)(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(t,e,i,r)=>{let o=this.translateFromRenderableToVisualCoords(e),s={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=r,sg(sv,this,!0),this.hot.runHooks("beforeOnCellMouseDown",t,o,i,s),(0,iy.isImmediatePropagationStopped)(t)||(ss(t,{coords:o,selection:this.hot.selection,controller:s,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseDown",t,o,i),this.activeWt=this._wt)},onCellContextMenu:(t,e,i,r)=>{let o=this.translateFromRenderableToVisualCoords(e);this.activeWt=r,sg(sv,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",t,o,i),(0,iy.isImmediatePropagationStopped)(t)||(this.hot.runHooks("afterOnCellContextMenu",t,o,i),this.activeWt=this._wt)},onCellMouseOut:(t,e,i,r)=>{let o=this.translateFromRenderableToVisualCoords(e);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOut",t,o,i),(0,iy.isImmediatePropagationStopped)(t)||(this.hot.runHooks("afterOnCellMouseOut",t,o,i),this.activeWt=this._wt)},onCellMouseOver:(t,e,i,r)=>{let o=this.translateFromRenderableToVisualCoords(e),s={row:!1,column:!1,cell:!1};this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOver",t,o,i,s),(0,iy.isImmediatePropagationStopped)(t)||(su(sv,this)&&ss(t,{coords:o,selection:this.hot.selection,controller:s,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseOver",t,o,i),this.activeWt=this._wt)},onCellMouseUp:(t,e,i,r)=>{let o=this.translateFromRenderableToVisualCoords(e);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseUp",t,o,i),(0,iy.isImmediatePropagationStopped)(t)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",t,o,i),this.activeWt=this._wt)},onCellCornerMouseDown:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:(t,e)=>this.beforeRender(t,e),onDraw:t=>this.afterRender(t),onBeforeViewportScrollVertically:t=>{let e=this.hot.rowIndexMapper,i=t<0,r=t;return i||null!==(r=e.getVisualFromRenderableIndex(t))?(r=this.hot.runHooks("beforeViewportScrollVertically",r),this.hot.runHooks("beforeViewportScroll"),i)?r:e.getRenderableFromVisualIndex(r):t},onBeforeViewportScrollHorizontally:t=>{let e=this.hot.columnIndexMapper,i=t<0,r=t;return i||null!==(r=e.getVisualFromRenderableIndex(t))?(r=this.hot.runHooks("beforeViewportScrollHorizontally",r),this.hot.runHooks("beforeViewportScroll"),i)?r:e.getRenderableFromVisualIndex(r):t},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(t,e,i)=>{let r=this.hot.rowIndexMapper,o=t<0,s=t;o||(s=r.getVisualFromRenderableIndex(t));let n=this.hot.runHooks("beforeHighlightingRowHeader",s,e,i);return o?n:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(n,1))},onBeforeHighlightingColumnHeader:(t,e,i)=>{let r=this.hot.columnIndexMapper,o=t<0,s=t;o||(s=r.getVisualFromRenderableIndex(t));let n=this.hot.runHooks("beforeHighlightingColumnHeader",s,e,i);return o?n:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(n,1))},onAfterDrawSelection:(t,e,i)=>{let r;let[o,s]=this.translateFromRenderableToVisualIndex(t,e),n=this.hot.selection.getSelectedRange();if(n.size()>0){let t=n.peekByIndex(null!=i?i:0);r=[t.from.row,t.from.col,t.to.row,t.to.col]}return this.hot.runHooks("afterDrawSelection",o,s,r,i)},onBeforeDrawBorders:(t,e)=>{let[i,r,o,s]=t,n=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),this.hot.columnIndexMapper.getVisualFromRenderableIndex(s)];return this.hot.runHooks("beforeDrawBorders",n,e)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(t,e)=>{let i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.runHooks("beforeStretchingColumnWidth",t,i)},onModifyRowHeaderWidth:t=>this.hot.runHooks("modifyRowHeaderWidth",t),onModifyGetCellCoords:(t,e,i)=>{let r=this.hot.rowIndexMapper,o=this.hot.columnIndexMapper,s=e>=0?o.getVisualFromRenderableIndex(e):e,n=t>=0?r.getVisualFromRenderableIndex(t):t,a=this.hot.runHooks("modifyGetCellCoords",n,s,i);if(Array.isArray(a)){let[t,e,i,s]=a;return[t>=0?r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(t,1)):t,e>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(e,1)):e,i>=0?r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(i,-1)):i,s>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s,-1)):s]}},viewportRowCalculatorOverride:t=>{let e=this.settings.viewportRowRenderingOffset;if("auto"===e&&this.settings.fixedRowsTop&&(e=10),e>0||"auto"===e){let i=this.countRenderableRows(),r=t.startRow,o=t.endRow;if("number"==typeof e)t.startRow=Math.max(r-e,0),t.endRow=Math.min(o+e,i-1);else if("auto"===e){let e=Math.ceil(o/i*12);t.startRow=Math.max(r-e,0),t.endRow=Math.min(o+e,i-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:t=>{let e=this.settings.viewportColumnRenderingOffset;if("auto"===e&&this.settings.fixedColumnsStart&&(e=10),e>0||"auto"===e){let i=this.countRenderableColumns(),r=t.startColumn,o=t.endColumn;if("number"==typeof e&&(t.startColumn=Math.max(r-e,0),t.endColumn=Math.min(o+e,i-1)),"auto"===e){let e=Math.ceil(o/i*6);t.startColumn=Math.max(r-e,0),t.endColumn=Math.min(o+e,i-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{let t=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||t}};this.hot.runHooks("beforeInitWalkontable",t),this._wt=new si(t),this.activeWt=this._wt;let e=this._wt.wtTable.spreader,{width:i,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,r),this.eventManager.addEventListener(e,"mousedown",t=>{t.target===e&&3===t.which&&t.stopPropagation()}),this.eventManager.addEventListener(e,"contextmenu",t=>{t.target===e&&3===t.which&&t.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(t){if((0,tZ.isInput)(t))return!0;let e=(0,tZ.isChildOf)(t,this.hot.view._wt.wtTable.spreader);return!!(!0===this.settings.fragmentSelection&&e||"cell"===this.settings.fragmentSelection&&this.isSelectedOnlyCell()&&e||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return su(sv,this)}isSelectedOnlyCell(){var t,e;return null!==(t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingleCell())&&void 0!==t&&t}isCellEdited(){let t=this.hot.getActiveEditor();return t&&t.isOpened()}beforeRender(t,e){t&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,e)}afterRender(t){t&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(t,e){if(e.firstChild){let i=e.firstChild;if(!(0,tZ.hasClass)(i,"relative")){(0,tZ.empty)(e),this.appendRowHeader(t,e);return}this.updateCellHeader(i.querySelector(".rowHeader"),t,this.hot.getRowHeader)}else{let{rootDocument:i,getRowHeader:r}=this.hot,o=i.createElement("div"),s=i.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,t,r),o.appendChild(s),e.appendChild(o)}this.hot.runHooks("afterGetRowHeader",t,e)}appendColHeader(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e.firstChild){let o=e.firstChild;(0,tZ.hasClass)(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),t,i,r):((0,tZ.empty)(e),this.appendColHeader(t,e,i,r))}else{let{rootDocument:o}=this.hot,s=o.createElement("div"),n=o.createElement("span");s.className="relative",n.className="colHeader",this.settings.ariaTags&&((0,tZ.setAttribute)(s,...(0,iq.A11Y_PRESENTATION)()),(0,tZ.setAttribute)(n,...(0,iq.A11Y_PRESENTATION)())),this.updateCellHeader(n,t,i,r),s.appendChild(n),e.appendChild(s)}this.hot.runHooks("afterGetColHeader",t,e,r)}updateCellHeader(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e,s=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&((0,tZ.hasClass)(t,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(e):(0,tZ.hasClass)(t,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(e))),o>-1?(0,tZ.fastInnerHTML)(t,i(e,r)):((0,tZ.fastInnerText)(t,String.fromCharCode(160)),(0,tZ.addClass)(t,"cornerHeader"))}maximumVisibleElementWidth(t){let e=this._wt.wtViewport.getWorkspaceWidth()-t;return e>0?e:0}maximumVisibleElementHeight(t){let e=this._wt.wtViewport.getWorkspaceHeight()-t;return e>0?e:0}setLastSize(t,e){sg(sb,this,t),sg(sC,this,e)}getLastSize(){return{width:su(sb,this),height:su(sC,this)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return su(sf,this)}getRowHeadersCount(){return su(sm,this)}getViewportWidth(){return this.hot.view._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this.hot.view._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this.hot.view._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this.hot.view._wt.wtViewport.getWorkspaceHeight()}destroy(){this._wt.destroy(),this.eventManager.destroy()}};tn("1C6fS"),tn("1hIp0");var t3=tn("hwT6B"),sT={};s(sT,"spreadsheetColumnLabel",()=>sA),s(sT,"spreadsheetColumnIndex",()=>sO),s(sT,"createSpreadsheetData",()=>sP),s(sT,"createSpreadsheetObjectData",()=>sI),s(sT,"createEmptySpreadsheetData",()=>sH),s(sT,"dataRowToChangesArray",()=>sL),s(sT,"countFirstRowKeys",()=>sD),s(sT,"isArrayOfArrays",()=>sN),s(sT,"isArrayOfObjects",()=>s_),tn("1hIp0");var t3=tn("hwT6B");const sM="ABCDEFGHIJKLMNOPQRSTUVWXYZ",sk=sM.length;function sA(t){let e,i=t+1,r="";for(;i>0;)r=String.fromCharCode(65+(e=(i-1)%sk))+r,i=parseInt((i-e)/sk,10);return r}function sO(t){let e=0;if(t)for(let i=0,r=t.length-1;i<t.length;i+=1,r-=1)e+=sk**r*(sM.indexOf(t[i])+1);return e-1}function sP(){let t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(t=0;t<i;t++){let i=[];for(e=0;e<r;e++)i.push(sA(e)+(t+1));o.push(i)}return o}function sI(){let t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(t=0;t<i;t++){let i={};for(e=0;e<r;e++)i[`prop${e}`]=sA(e)+(t+1);o.push(i)}return o}function sH(t,e){let i;let r=[];for(let o=0;o<t;o++){i=[];for(let t=0;t<e;t++)i.push("");r.push(i)}return r}function sL(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=t,r=[];return Array.isArray(t)&&Array.isArray(t[0])||(i=[t]),i.forEach((t,i)=>{Array.isArray(t)?t.forEach((t,o)=>{r.push([i+e,o,t])}):Object.keys(t).forEach(o=>{r.push([i+e,o,t[o]])})}),r}function sD(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&(0,t3.isObject)(t[0])&&(e=(0,t3.deepObjectSize)(t[0]))),e}function sN(t){return!!(Array.isArray(t)&&t.length&&t.every(t=>Array.isArray(t)))}function s_(t){return!!(Array.isArray(t)&&t.length&&t.every(t=>"object"==typeof t&&!Array.isArray(t)&&null!==t))}var eu=tn("ceXML"),eq=tn("guO5N"),tQ=tn("f3221");function sF(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var sj=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];sF(this,"hot",void 0),sF(this,"data",void 0),sF(this,"dataType","array"),sF(this,"colToProp",()=>{}),sF(this,"propToCol",()=>{}),this.hot=t,this.data=e}modifyRowData(t){let e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}getData(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}setData(t){this.data=t}getAtColumn(t){let e=[];return(0,eu.arrayEach)(this.data,(i,r)=>{let o=this.getAtCell(r,t);e.push(o)}),e}getAtRow(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=void 0===e&&void 0===i,s=null,n=null;if(Array.isArray(s=this.modifyRowData(t)))n=[],o?s.forEach((e,i)=>{n[i]=this.getAtPhysicalCell(t,i,s)}):(0,eq.rangeEach)(e,i,i=>{n[i-e]=this.getAtPhysicalCell(t,i,s)});else if((0,t3.isObject)(s)||(0,tQ.isFunction)(s)){if(n=r?[]:{},!o||r){let o=this.countFirstRowKeys()-1;(0,eq.rangeEach)(0,o,a=>{let l=this.colToProp(a);if(a>=(e||0)&&a<=(i||o)&&!Number.isInteger(l)){let e=this.getAtPhysicalCell(t,l,s);r?n.push(e):(0,t3.setProperty)(n,l,e)}})}else(0,t3.objectEach)(s,(e,i)=>{(0,t3.setProperty)(n,i,this.getAtPhysicalCell(t,i,s))})}return n}setAtCell(t,e,i){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){let r=(0,t3.createObjectPropListener)(i);this.hot.runHooks("modifySourceData",t,e,r,"set"),r.isTouched()&&(i=r.value)}Number.isInteger(e)?this.data[t][e]=i:(0,t3.setProperty)(this.data[t],e,i)}}getAtPhysicalCell(t,e,i){let r=null;if(i&&(r="string"==typeof e?(0,t3.getProperty)(i,e):"function"==typeof e?e(i):i[e]),this.hot.hasHook("modifySourceData")){let i=(0,t3.createObjectPropListener)(r);this.hot.runHooks("modifySourceData",t,e,i,"get"),i.isTouched()&&(r=i.value)}return r}getAtCell(t,e){let i=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),i)}getByRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1,o=null,s=null,n=null,a=null;null===t||null===e?(r=!0,o=0,n=this.countRows()-1):(o=Math.min(t.row,e.row),s=Math.min(t.col,e.col),n=Math.max(t.row,e.row),a=Math.max(t.col,e.col));let l=[];return(0,eq.rangeEach)(o,n,t=>{l.push(r?this.getAtRow(t,void 0,void 0,i):this.getAtRow(t,s,a,i))}),l}countRows(){if(this.hot.hasHook("modifySourceLength")){let t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}countFirstRowKeys(){return sD(this.data)}destroy(){this.data=null,this.hot=null}};tn("1C6fS");var eu=tn("ceXML");tn("1C6fS"),tn("1hIp0"),tn("1C6fS"),tn("1hIp0");var eq=tn("guO5N"),t3=tn("hwT6B"),tQ=tn("f3221");tn("1hIp0");var t3=tn("hwT6B"),tQ=tn("f3221");const sB={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,i,r,o,s,n){if(this._localHooks[t]){let a=this._localHooks[t].length;for(let l=0;l<a;l++)(0,tQ.fastCall)(this._localHooks[t][l],this,e,i,r,o,s,n)}},clearLocalHooks(){return this._localHooks={},this}};function sW(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}(0,t3.defineGetter)(sB,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});class sV{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;sW(this,"indexedValues",[]),sW(this,"initValueOrFn",void 0),this.initValueOrFn=t}getValues(){return this.indexedValues}getValueAtIndex(t){let e=this.indexedValues;if(t<e.length)return e[t]}setValues(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}setValueAtIndex(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,(0,tQ.isFunction)(this.initValueOrFn)?(0,eq.rangeEach)(t-1,t=>this.indexedValues.push(this.initValueOrFn(t))):(0,eq.rangeEach)(t-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}(0,t3.mixin)(sV,sB);var tQ=tn("f3221"),eu=tn("ceXML");function sU(t,e,i,r){let o=i.length?i[0]:void 0;return[...t.slice(0,o),...i.map((t,e)=>(0,tQ.isFunction)(r)?r(t,e):r),...void 0===o?[]:t.slice(o)]}function sz(t,e){return(0,eu.arrayFilter)(t,(t,i)=>!1===e.includes(i))}class sY extends sV{insert(t,e){this.indexedValues=sU(this.indexedValues,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){this.indexedValues=sz(this.indexedValues,t),super.remove(t)}}var eu=tn("ceXML");class sG extends sY{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getHiddenIndexes(){return(0,eu.arrayReduce)(this.getValues(),(t,e,i)=>(e&&t.push(i),t),[])}}function s$(t,e,i){return[...t.slice(0,e),...i,...t.slice(e)]}function sX(t,e){return(0,eu.arrayFilter)(t,t=>!1===e.includes(t))}tn("1C6fS");var eu=(tn("ceXML"),tn("ceXML"));function sq(t,e){return(0,eu.arrayMap)(t,t=>t-e.filter(e=>e<t).length)}function sK(t,e){let i=e[0],r=e.length;return(0,eu.arrayMap)(t,t=>t>=i?t+r:t)}var tQ=tn("f3221");class sZ extends sV{constructor(){var t,e,i;super(...arguments),e=[],(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="orderOfIndexes","string"))?i:i+"")in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e}getValues(){return this.orderOfIndexes.map(t=>this.indexedValues[t])}setValues(t){this.orderOfIndexes=[...Array(t.length).keys()],super.setValues(t)}setValueAtIndex(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(i,0,t),this.runLocalHooks("change"),!0)}clearValue(t){this.orderOfIndexes=sX(this.orderOfIndexes,[t]),(0,tQ.isFunction)(this.initValueOrFn)?super.setValueAtIndex(t,this.initValueOrFn(t)):super.setValueAtIndex(t,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(t)}insert(t,e){this.indexedValues=sU(this.indexedValues,t,e,this.initValueOrFn),this.orderOfIndexes=sK(this.orderOfIndexes,e),super.insert(t,e)}remove(t){this.indexedValues=sz(this.indexedValues,t),this.orderOfIndexes=sX(this.orderOfIndexes,t),this.orderOfIndexes=sq(this.orderOfIndexes,t),super.remove(t)}getEntries(){return this.orderOfIndexes.map(t=>[t,this.getValueAtIndex(t)])}}tn("1hIp0");var eu=tn("ceXML");class sQ extends sY{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getTrimmedIndexes(){return(0,eu.arrayReduce)(this.getValues(),(t,e,i)=>(e&&t.push(i),t),[])}}class sJ extends sV{constructor(){super(t=>t)}insert(t,e){let i=sK(this.indexedValues,e);this.indexedValues=s$(i,t,e),super.insert(t,e)}remove(t){let e=sX(this.indexedValues,t);this.indexedValues=sq(e,t),super.remove(t)}}const s0=new Map([["hiding",sG],["index",sV],["linkedPhysicalIndexToValue",sZ],["physicalIndexToValue",sY],["trimming",sQ]]);tn("1C6fS"),tn("1hIp0"),tn("1C6fS");var tJ=tn("gnaTS"),t3=tn("hwT6B");let s1=0;class s2{constructor(){var t,e,i;t="collection",e=new Map,(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string"))?i:i+"")in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e}register(t,e){!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",()=>this.runLocalHooks("change",e)),s1+=1)}unregister(t){let e=this.collection.get(t);(0,tJ.isDefined)(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),s1-=1)}unregisterAll(){this.collection.forEach((t,e)=>this.unregister(e)),this.collection.clear()}get(t){return(0,tJ.isUndefined)(t)?Array.from(this.collection.values()):this.collection.get(t)}getLength(){return this.collection.size}removeFromEvery(t){this.collection.forEach(e=>{e.remove(t)})}insertToEvery(t,e){this.collection.forEach(i=>{i.insert(t,e)})}initEvery(t){this.collection.forEach(e=>{e.init(t)})}}(0,t3.mixin)(s2,sB);var eu=tn("ceXML"),tJ=tn("gnaTS");function s3(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class s6 extends s2{constructor(t,e){super(),s3(this,"mergedValuesCache",[]),s3(this,"aggregationFunction",void 0),s3(this,"fallbackValue",void 0),this.aggregationFunction=t,this.fallbackValue=e}getMergedValues(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===t)return this.mergedValuesCache;if(0===this.getLength())return[];let e=(0,eu.arrayMap)(this.get(),t=>t.getValues()),i=[],r=(0,tJ.isDefined)(e[0])&&e[0].length||0;for(let t=0;t<r;t+=1){let r=[];for(let i=0;i<this.getLength();i+=1)r.push(e[i][t]);i.push(r)}return(0,eu.arrayMap)(i,this.aggregationFunction)}getMergedValueAtIndex(t,e){let i=this.getMergedValues(e)[t];return(0,tJ.isDefined)(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}var t3=tn("hwT6B"),tJ=tn("gnaTS");tn("1C6fS"),tn("1C6fS");var t3=tn("hwT6B");function s4(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var s5=new WeakMap;class s9{constructor(){var t;t=[],function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,s5),s5.set(this,t)}subscribe(t){return this.addLocalHook("change",t),this._write(s5.get(s4(s5,this))),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(t){return t.length>0&&this.runLocalHooks("change",t),this}_writeInitialChanges(t){s5.set(s4(s5,this),t)}}function s8(t,e){let i=[],r=0,o=0;for(;r<t.length&&o<e.length;r++,o++)t[r]!==e[o]&&i.push({op:"replace",index:o,oldValue:t[r],newValue:e[o]});for(;r<e.length;r++)i.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;o<t.length;o++)i.push({op:"remove",index:o,oldValue:t[o],newValue:void 0});return i}function s7(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function nt(t,e){return t.get(ni(t,e))}function ne(t,e,i){return t.set(ni(t,e),i),i}function ni(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(0,t3.mixin)(s9,sB),tn("1hIp0");var nr=new WeakMap,no=new WeakMap,ns=new WeakMap,nn=new WeakMap,na=new WeakMap;class nl{constructor(){let{initialIndexValue:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s7(this,nr,new Set),s7(this,no,[]),s7(this,ns,[]),s7(this,nn,!1),s7(this,na,!1),ne(na,this,null!=t&&t)}createObserver(){let t=new s9;return nt(nr,this).add(t),t.addLocalHook("unsubscribe",()=>{nt(nr,this).delete(t)}),t._writeInitialChanges(s8(nt(no,this),nt(ns,this))),t}emit(t){let e=nt(ns,this);nt(nn,this)&&nt(no,this).length===t.length||(0===t.length?t=Array(e.length).fill(nt(na,this)):ne(no,this,Array(t.length).fill(nt(na,this))),nt(nn,this)||(ne(nn,this,!0),e=nt(no,this)));let i=s8(e,t);nt(nr,this).forEach(t=>t._write(i)),ne(ns,this,t)}}function nh(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class nc{constructor(){nh(this,"indexesSequence",new sJ),nh(this,"trimmingMapsCollection",new s6(t=>t.some(t=>!0===t),!1)),nh(this,"hidingMapsCollection",new s6(t=>t.some(t=>!0===t),!1)),nh(this,"variousMapsCollection",new s2),nh(this,"hidingChangesObservable",new nl({initialIndexValue:!1})),nh(this,"notTrimmedIndexesCache",[]),nh(this,"notHiddenIndexesCache",[]),nh(this,"isBatched",!1),nh(this,"indexesSequenceChanged",!1),nh(this,"indexesChangeSource",void 0),nh(this,"trimmedIndexesChanged",!1),nh(this,"hiddenIndexesChanged",!1),nh(this,"renderablePhysicalIndexesCache",[]),nh(this,"fromPhysicalToVisualIndexesCache",new Map),nh(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",t=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",t=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",t=>{this.runLocalHooks("change",t,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(t){if("hiding"!==t)throw Error(`Unsupported index map type "${t}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(t,e,i){return this.registerMap(t,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!s0.has(t))throw Error(`The provided map type ("${t}") does not exist.`);return new(s0.get(t))(e)}(e,i))}registerMap(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error(`Map with name "${t}" has been already registered.`);e instanceof sQ?this.trimmingMapsCollection.register(t,e):e instanceof sG?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);let i=this.getNumberOfIndexes();return i>0&&e.init(i),e}unregisterMap(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(t){let e=this.notTrimmedIndexesCache[t];return(0,tJ.isDefined)(e)?e:null}getPhysicalFromRenderableIndex(t){let e=this.renderablePhysicalIndexesCache[t];return(0,tJ.isDefined)(e)?e:null}getVisualFromPhysicalIndex(t){let e=this.fromPhysicalToVisualIndexesCache.get(t);return(0,tJ.isDefined)(e)?e:null}getVisualFromRenderableIndex(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}getRenderableFromVisualIndex(t){let e=this.fromVisualToRenderableIndexesCache.get(t);return(0,tJ.isDefined)(e)?e:null}getNearestNotHiddenIndex(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(t))return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;let r=Array.from(this.fromVisualToRenderableIndexesCache.keys()),o=-1;return -1===(o=e>0?r.findIndex(e=>e>t):r.reverse().findIndex(e=>e<t))?i?this.getNearestNotHiddenIndex(t,-e,!1):null:r[o]}initToLength(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...Array(t).keys()],this.notHiddenIndexesCache=[...Array(t).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(t){let e=this.getNumberOfIndexes();if(t<e){let e=[...Array(this.getNumberOfIndexes()-t).keys()].map(e=>e+t);this.removeIndexes(e)}else this.insertIndexes(e,t-e)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(t){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(t),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return!0===t?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(t=>!1===this.isTrimmed(t))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return!0===t?this.notHiddenIndexesCache:this.getIndexesSequence().filter(t=>!1===this.isHidden(t))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return!0===t?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(t=>!1===this.isHidden(t))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(t,e){"number"==typeof t&&(t=[t]);let i=(0,eu.arrayMap)(t,t=>this.getPhysicalFromVisualIndex(t)),r=this.getNotTrimmedIndexesLength(),o=t.length,s=sX(this.getIndexesSequence(),i),n=s.filter(t=>!1===this.isTrimmed(t)),a=s.indexOf(n[n.length-1])+1;if(e+o<r){let t=n[e];a=s.indexOf(t)}this.indexesChangeSource="move",this.setIndexesSequence(s$(s,a,i)),this.indexesChangeSource=void 0}isTrimmed(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}isHidden(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}insertIndexes(t,e){let i=this.getNotTrimmedIndexes()[t],r=(0,tJ.isDefined)(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=(0,eu.arrayMap)(Array(e).fill(r),(t,e)=>t+e);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(t){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}updateCache(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){let t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let e=0;e<t;e+=1){let t=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(t,e)}}cacheFromVisualToRenderableIndexes(){let t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let e=0;e<t;e+=1){let t=this.getPhysicalFromRenderableIndex(e),i=this.getVisualFromPhysicalIndex(t);this.fromVisualToRenderableIndexesCache.set(i,e)}}}(0,t3.mixin)(nc,sB);var nd=tn("10euP"),t3=tn("hwT6B"),eu=tn("ceXML"),tJ=(tn("gnaTS"),tn("gnaTS")),t3=tn("hwT6B"),t6=tn("jlXkd"),iJ=tn("iCsRe");function nu(t){let e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return e?`${e[1].toLowerCase()}-${e[2].toUpperCase()}`:t}function ng(t){(0,tJ.isDefined)(t)&&(0,t6.error)((0,iJ.toSingleLine)`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}var e7=(tn("lSZ9A"),tn("lSZ9A"));const{register:np,getValues:nf}=(0,e7.default)("phraseFormatters");np("pluralize",function(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t});/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */var nm={};s(nm,"CONTEXT_MENU_ITEMS_NAMESPACE",()=>ny),s(nm,"CONTEXTMENU_ITEMS_NO_ITEMS",()=>nv),s(nm,"CONTEXTMENU_ITEMS_ROW_ABOVE",()=>nw),s(nm,"CONTEXTMENU_ITEMS_ROW_BELOW",()=>nb),s(nm,"CONTEXTMENU_ITEMS_INSERT_LEFT",()=>nC),s(nm,"CONTEXTMENU_ITEMS_INSERT_RIGHT",()=>nS),s(nm,"CONTEXTMENU_ITEMS_REMOVE_ROW",()=>nx),s(nm,"CONTEXTMENU_ITEMS_REMOVE_COLUMN",()=>nE),s(nm,"CONTEXTMENU_ITEMS_UNDO",()=>nR),s(nm,"CONTEXTMENU_ITEMS_REDO",()=>nT),s(nm,"CONTEXTMENU_ITEMS_READ_ONLY",()=>nM),s(nm,"CONTEXTMENU_ITEMS_CLEAR_COLUMN",()=>nk),s(nm,"CONTEXTMENU_ITEMS_COPY",()=>nA),s(nm,"CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS",()=>nO),s(nm,"CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS",()=>nP),s(nm,"CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY",()=>nI),s(nm,"CONTEXTMENU_ITEMS_CUT",()=>nH),s(nm,"CONTEXTMENU_ITEMS_FREEZE_COLUMN",()=>nL),s(nm,"CONTEXTMENU_ITEMS_UNFREEZE_COLUMN",()=>nD),s(nm,"CONTEXTMENU_ITEMS_MERGE_CELLS",()=>nN),s(nm,"CONTEXTMENU_ITEMS_UNMERGE_CELLS",()=>n_),s(nm,"CONTEXTMENU_ITEMS_ADD_COMMENT",()=>nF),s(nm,"CONTEXTMENU_ITEMS_EDIT_COMMENT",()=>nj),s(nm,"CONTEXTMENU_ITEMS_REMOVE_COMMENT",()=>nB),s(nm,"CONTEXTMENU_ITEMS_READ_ONLY_COMMENT",()=>nW),s(nm,"CONTEXTMENU_ITEMS_ALIGNMENT",()=>nV),s(nm,"CONTEXTMENU_ITEMS_ALIGNMENT_LEFT",()=>nU),s(nm,"CONTEXTMENU_ITEMS_ALIGNMENT_CENTER",()=>nz),s(nm,"CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT",()=>nY),s(nm,"CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY",()=>nG),s(nm,"CONTEXTMENU_ITEMS_ALIGNMENT_TOP",()=>n$),s(nm,"CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE",()=>nX),s(nm,"CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM",()=>nq),s(nm,"CONTEXTMENU_ITEMS_BORDERS",()=>nK),s(nm,"CONTEXTMENU_ITEMS_BORDERS_TOP",()=>nZ),s(nm,"CONTEXTMENU_ITEMS_BORDERS_RIGHT",()=>nQ),s(nm,"CONTEXTMENU_ITEMS_BORDERS_BOTTOM",()=>nJ),s(nm,"CONTEXTMENU_ITEMS_BORDERS_LEFT",()=>n0),s(nm,"CONTEXTMENU_ITEMS_REMOVE_BORDERS",()=>n1),s(nm,"CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD",()=>n2),s(nm,"CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD",()=>n3),s(nm,"CONTEXTMENU_ITEMS_HIDE_COLUMN",()=>n6),s(nm,"CONTEXTMENU_ITEMS_SHOW_COLUMN",()=>n4),s(nm,"CONTEXTMENU_ITEMS_HIDE_ROW",()=>n5),s(nm,"CONTEXTMENU_ITEMS_SHOW_ROW",()=>n9),s(nm,"FILTERS_NAMESPACE",()=>n8),s(nm,"FILTERS_CONDITIONS_NAMESPACE",()=>n7),s(nm,"FILTERS_CONDITIONS_NONE",()=>at),s(nm,"FILTERS_CONDITIONS_EMPTY",()=>ae),s(nm,"FILTERS_CONDITIONS_NOT_EMPTY",()=>ai),s(nm,"FILTERS_CONDITIONS_EQUAL",()=>ar),s(nm,"FILTERS_CONDITIONS_NOT_EQUAL",()=>ao),s(nm,"FILTERS_CONDITIONS_BEGINS_WITH",()=>as),s(nm,"FILTERS_CONDITIONS_ENDS_WITH",()=>an),s(nm,"FILTERS_CONDITIONS_CONTAINS",()=>aa),s(nm,"FILTERS_CONDITIONS_NOT_CONTAIN",()=>al),s(nm,"FILTERS_CONDITIONS_BY_VALUE",()=>ah),s(nm,"FILTERS_CONDITIONS_GREATER_THAN",()=>ac),s(nm,"FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL",()=>ad),s(nm,"FILTERS_CONDITIONS_LESS_THAN",()=>au),s(nm,"FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL",()=>ag),s(nm,"FILTERS_CONDITIONS_BETWEEN",()=>ap),s(nm,"FILTERS_CONDITIONS_NOT_BETWEEN",()=>af),s(nm,"FILTERS_CONDITIONS_AFTER",()=>am),s(nm,"FILTERS_CONDITIONS_BEFORE",()=>ay),s(nm,"FILTERS_CONDITIONS_TODAY",()=>av),s(nm,"FILTERS_CONDITIONS_TOMORROW",()=>aw),s(nm,"FILTERS_CONDITIONS_YESTERDAY",()=>ab),s(nm,"FILTERS_DIVS_FILTER_BY_CONDITION",()=>aC),s(nm,"FILTERS_DIVS_FILTER_BY_VALUE",()=>aS),s(nm,"FILTERS_LABELS_CONJUNCTION",()=>ax),s(nm,"FILTERS_LABELS_DISJUNCTION",()=>aE),s(nm,"FILTERS_VALUES_BLANK_CELLS",()=>aR),s(nm,"FILTERS_BUTTONS_SELECT_ALL",()=>aT),s(nm,"FILTERS_BUTTONS_CLEAR",()=>aM),s(nm,"FILTERS_BUTTONS_OK",()=>ak),s(nm,"FILTERS_BUTTONS_CANCEL",()=>aA),s(nm,"FILTERS_BUTTONS_PLACEHOLDER_SEARCH",()=>aO),s(nm,"FILTERS_BUTTONS_PLACEHOLDER_VALUE",()=>aP),s(nm,"FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE",()=>aI),s(nm,"CHECKBOX_RENDERER_NAMESPACE",()=>aH),s(nm,"CHECKBOX_CHECKED",()=>aL),s(nm,"CHECKBOX_UNCHECKED",()=>aD);const ny="ContextMenu:items",nv=`${ny}.noItems`,nw=`${ny}.insertRowAbove`,nb=`${ny}.insertRowBelow`,nC=`${ny}.insertColumnOnTheLeft`,nS=`${ny}.insertColumnOnTheRight`,nx=`${ny}.removeRow`,nE=`${ny}.removeColumn`,nR=`${ny}.undo`,nT=`${ny}.redo`,nM=`${ny}.readOnly`,nk=`${ny}.clearColumn`,nA=`${ny}.copy`,nO=`${ny}.copyWithHeaders`,nP=`${ny}.copyWithGroupHeaders`,nI=`${ny}.copyHeadersOnly`,nH=`${ny}.cut`,nL=`${ny}.freezeColumn`,nD=`${ny}.unfreezeColumn`,nN=`${ny}.mergeCells`,n_=`${ny}.unmergeCells`,nF=`${ny}.addComment`,nj=`${ny}.editComment`,nB=`${ny}.removeComment`,nW=`${ny}.readOnlyComment`,nV=`${ny}.align`,nU=`${ny}.align.left`,nz=`${ny}.align.center`,nY=`${ny}.align.right`,nG=`${ny}.align.justify`,n$=`${ny}.align.top`,nX=`${ny}.align.middle`,nq=`${ny}.align.bottom`,nK=`${ny}.borders`,nZ=`${ny}.borders.top`,nQ=`${ny}.borders.right`,nJ=`${ny}.borders.bottom`,n0=`${ny}.borders.left`,n1=`${ny}.borders.remove`,n2=`${ny}.nestedHeaders.insertChildRow`,n3=`${ny}.nestedHeaders.detachFromParent`,n6=`${ny}.hideColumn`,n4=`${ny}.showColumn`,n5=`${ny}.hideRow`,n9=`${ny}.showRow`,n8="Filters:",n7=`${n8}conditions`,at=`${n7}.none`,ae=`${n7}.isEmpty`,ai=`${n7}.isNotEmpty`,ar=`${n7}.isEqualTo`,ao=`${n7}.isNotEqualTo`,as=`${n7}.beginsWith`,an=`${n7}.endsWith`,aa=`${n7}.contains`,al=`${n7}.doesNotContain`,ah=`${n7}.byValue`,ac=`${n7}.greaterThan`,ad=`${n7}.greaterThanOrEqualTo`,au=`${n7}.lessThan`,ag=`${n7}.lessThanOrEqualTo`,ap=`${n7}.isBetween`,af=`${n7}.isNotBetween`,am=`${n7}.after`,ay=`${n7}.before`,av=`${n7}.today`,aw=`${n7}.tomorrow`,ab=`${n7}.yesterday`,aC=`${n8}labels.filterByCondition`,aS=`${n8}labels.filterByValue`,ax=`${n8}labels.conjunction`,aE=`${n8}labels.disjunction`,aR=`${n8}values.blankCells`,aT=`${n8}buttons.selectAll`,aM=`${n8}buttons.clear`,ak=`${n8}buttons.ok`,aA=`${n8}buttons.cancel`,aO=`${n8}buttons.placeholder.search`,aP=`${n8}buttons.placeholder.value`,aI=`${n8}buttons.placeholder.secondValue`,aH="CheckboxRenderer:",aL=`${aH}checked`,aD=`${aH}unchecked`;var aN={languageCode:"en-US",[nv]:"No available options",[nw]:"Insert row above",[nb]:"Insert row below",[nC]:"Insert column left",[nS]:"Insert column right",[nx]:["Remove row","Remove rows"],[nE]:["Remove column","Remove columns"],[nR]:"Undo",[nT]:"Redo",[nM]:"Read only",[nk]:"Clear column",[nV]:"Alignment",[nU]:"Left",[nz]:"Center",[nY]:"Right",[nG]:"Justify",[n$]:"Top",[nX]:"Middle",[nq]:"Bottom",[nL]:"Freeze column",[nD]:"Unfreeze column",[nK]:"Borders",[nZ]:"Top",[nQ]:"Right",[nJ]:"Bottom",[n0]:"Left",[n1]:"Remove border(s)",[nF]:"Add comment",[nj]:"Edit comment",[nB]:"Delete comment",[nW]:"Read-only comment",[nN]:"Merge cells",[n_]:"Unmerge cells",[nA]:"Copy",[nO]:["Copy with header","Copy with headers"],[nP]:["Copy with group header","Copy with group headers"],[nI]:["Copy header only","Copy headers only"],[nH]:"Cut",[n2]:"Insert child row",[n3]:"Detach from parent",[n6]:["Hide column","Hide columns"],[n4]:["Show column","Show columns"],[n5]:["Hide row","Hide rows"],[n9]:["Show row","Show rows"],[at]:"None",[ae]:"Is empty",[ai]:"Is not empty",[ar]:"Is equal to",[ao]:"Is not equal to",[as]:"Begins with",[an]:"Ends with",[aa]:"Contains",[al]:"Does not contain",[ac]:"Greater than",[ad]:"Greater than or equal to",[au]:"Less than",[ag]:"Less than or equal to",[ap]:"Is between",[af]:"Is not between",[am]:"After",[ay]:"Before",[av]:"Today",[aw]:"Tomorrow",[ab]:"Yesterday",[aR]:"Blank cells",[aC]:"Filter by condition",[aS]:"Filter by value",[ax]:"And",[aE]:"Or",[aT]:"Select all",[aM]:"Clear",[ak]:"OK",[aA]:"Cancel",[aO]:"Search",[aP]:"Value",[aI]:"Second value",[aL]:"Checked",[aD]:"Unchecked"};const a_=aN.languageCode,{register:aF,getItem:aj,hasItem:aB,getValues:aW}=(0,e7.default)("languagesDictionaries");function aV(t,e){let i=t,r=e;return(0,t3.isObject)(t)&&(i=(r=t).languageCode),function(t,e){if(t!==a_){var i;i=aj(a_),(0,t3.objectEach)(i,(t,i)=>{(0,tJ.isUndefined)(e[i])&&(e[i]=t)})}}(i,r),aF(i,(0,t3.deepClone)(r)),(0,t3.deepClone)(r)}function aU(t){return aB(t)?(0,t3.deepClone)(aj(t)):null}function az(t,e,i){let r;let o=aU(t);if(null===o)return null;let s=o[e];if((0,tJ.isUndefined)(s))return null;let n=(r=s,(0,eu.arrayEach)(nf(),t=>{r=t(s,i)}),r);return Array.isArray(n)?n[0]:n}aV(aN),tn("1C6fS");const aY="active-header",aG="header",a$="area",aX="focus";tn("1C6fS"),tn("1hIp0"),tn("1C6fS");var t3=tn("hwT6B");class aq{constructor(t,e){this.settings=t,this.cellRange=e||null}isEmpty(){return null===this.cellRange}add(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}replace(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){let t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}destroy(){this.runLocalHooks("destroy")}}(0,t3.mixin)(aq,sB);var aK=aq,aZ=class extends aK{constructor(t,e){var i,r;super(t,null),(i="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i="visualCellRange","string"))?r:r+"")in this?Object.defineProperty(this,i,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[i]=null,this.visualCellRange=e||null,this.commit()}add(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(t){let{from:e,to:i}=t,r=this.getNearestNotHiddenCoords(e,1),o=this.getNearestNotHiddenCoords(i,-1);return null===r||null===o?null:((r.row>o.row||r.col>o.col)&&(r=e,o=i),this.settings.createCellRange(r,r,o))}getNearestNotHiddenCoords(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,t.row,e);if(null===r)return null;let o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,t.col,i);return null===o?null:this.settings.createCellCoords(r,o)}getNearestNotHiddenIndex(t,e,i){return e<0?e:t.getNearestNotHiddenIndex(e,i)}commit(){if(null===this.visualCellRange)return this;let t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return null===t?this.cellRange=null:this.cellRange=this.createRenderableCellRange(t.from,t.to),this}syncWith(t){let e=t.from.clone().normalize(),i="N-S"===t.getVerticalDirection()?1:-1,r="W-E"===t.getHorizontalDirection()?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight),s=null;if((null===o||null===o.col||null===o.row)&&(s=this.getNearestNotHiddenCoords(e,i,r)),null!==s&&t.overlaps(s)){let e=t.highlight.clone();if(e.row>=0&&(e.row=s.row),e.col>=0&&(e.col=s.col),null===this.cellRange){let t=this.settings.visualToRenderableCoords(e);this.cellRange=this.settings.createCellRange(t)}t.setHighlight(e)}return"focus"===this.settings.selectionType&&null!==o&&null===s&&t.setHighlight(this.visualCellRange.highlight),this}getCorners(){let{from:t,to:e}=this.cellRange;return[Math.min(t.row,e.row),Math.min(t.col,e.col),Math.max(t.row,e.row),Math.max(t.col,e.col)]}getVisualCorners(){let t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}createRenderableCellRange(t,e){let i=this.settings.visualToRenderableCoords(t),r=this.settings.visualToRenderableCoords(e);return null===i.row||null===i.col||null===r.row||null===r.col?null:this.settings.createCellRange(i,i,r)}};function aQ(t){let{activeHeaderClassName:e,...i}=t;return new aZ({className:e,...i,selectionType:aY})}function aJ(t){let{areaCornerVisible:e,...i}=t;return new aZ({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...i,selectionType:a$})}function a0(t){let{...e}=t;return new aZ({className:"highlight",...e,selectionType:a$})}function a1(t){let{columnClassName:e,...i}=t;return new aZ({className:e,...i,selectionType:"column"})}var iq=tn("4Pbrh");function a2(t){let{headerClassName:e,...i}=t;return new aZ({className:e,...i,selectionType:aG})}function a3(t){let{rowClassName:e,...i}=t;return new aZ({className:e,...i,selectionType:"row"})}var eu=tn("ceXML");function a6(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function a4(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var a5=new WeakSet;class a9{constructor(t){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,a5),a5.add(this),a6(this,"options",void 0),a6(this,"layerLevel",0),a6(this,"focus",void 0),a6(this,"fill",void 0),a6(this,"layeredAreas",new Map),a6(this,"areas",new Map),a6(this,"rowHeaders",new Map),a6(this,"columnHeaders",new Map),a6(this,"activeRowHeaders",new Map),a6(this,"activeColumnHeaders",new Map),a6(this,"activeCornerHeaders",new Map),a6(this,"rowHighlights",new Map),a6(this,"columnHighlights",new Map),a6(this,"customSelections",[]),this.options=t,this.focus=function(t){let{cellCornerVisible:e,...i}=t;return new aZ({className:"current",headerAttributes:[(0,iq.A11Y_SELECTED)()],border:{width:2,color:"#4b89ff",cornerVisible:e},...i,selectionType:aX})}(t),this.fill=function(t){let{...e}=t;return new aZ({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:"fill"})}(t)}isEnabledFor(t,e){let i=t;t===aX&&(i="current");let r=this.options.disabledCellSelection(e.row,e.col);return"string"==typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(i)}useLayerLevel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return a4(a5,this,a8).call(this,this.layeredAreas,aJ)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return a4(a5,this,a8).call(this,this.areas,a0)}getAreas(){return[...this.areas.values()]}createRowHeader(){return a4(a5,this,a8).call(this,this.rowHeaders,a2)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return a4(a5,this,a8).call(this,this.columnHeaders,a2)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return a4(a5,this,a8).call(this,this.activeRowHeaders,aQ)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return a4(a5,this,a8).call(this,this.activeColumnHeaders,aQ)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return a4(a5,this,a8).call(this,this.activeCornerHeaders,aQ)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return a4(a5,this,a8).call(this,this.rowHighlights,a3)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return a4(a5,this,a8).call(this,this.columnHighlights,a1)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(t){this.customSelections.push(function(t){let{border:e,visualCellRange:i,...r}=t;return new aZ({...e,...r,selectionType:"custom-selection"},i)}({...this.options,...t}))}clear(){this.focus.clear(),this.fill.clear(),(0,eu.arrayEach)(this.areas.values(),t=>void t.clear()),(0,eu.arrayEach)(this.layeredAreas.values(),t=>void t.clear()),(0,eu.arrayEach)(this.rowHeaders.values(),t=>void t.clear()),(0,eu.arrayEach)(this.columnHeaders.values(),t=>void t.clear()),(0,eu.arrayEach)(this.activeRowHeaders.values(),t=>void t.clear()),(0,eu.arrayEach)(this.activeColumnHeaders.values(),t=>void t.clear()),(0,eu.arrayEach)(this.activeCornerHeaders.values(),t=>void t.clear()),(0,eu.arrayEach)(this.rowHighlights.values(),t=>void t.clear()),(0,eu.arrayEach)(this.columnHighlights.values(),t=>void t.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function a8(t,e){let i=this.layerLevel;if(t.has(i))return t.get(i);let r=e({layerLevel:i,...this.options});return t.set(i,r),r}function a7(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}tn("1C6fS"),tn("1hIp0");class lt{constructor(t){a7(this,"ranges",[]),a7(this,"createCellRange",void 0),this.createCellRange=t}isEmpty(){return 0===this.size()}set(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}add(t){return this.ranges.push(this.createCellRange(t)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(t){return this.ranges.some(e=>e.includes(t))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}var t3=tn("hwT6B"),tJ=tn("gnaTS"),eq=tn("guO5N"),eu=tn("ceXML");tn("1C6fS");var t3=tn("hwT6B");function le(t,e,i){li(t,e),e.set(t,i)}function li(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function lr(t,e){return t.get(ls(t,e))}function lo(t,e,i){return t.set(ls(t,e),i),i}function ls(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var ln=new WeakMap,la=new WeakMap,ll=new WeakMap,lh=new WeakSet;class lc{constructor(t,e){li(this,lh),lh.add(this),le(this,ln,void 0),le(this,la,void 0),le(this,ll,{x:0,y:0}),lo(ln,this,t),lo(la,this,e)}transformStart(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=lr(la,this).createCellCoords(t,e),o=lr(ln,this).current().highlight,s=lr(la,this).visualToRenderableCoords(o),n=0,a=0;if(this.runLocalHooks("beforeTransformStart",r),null!==s.row&&null!==s.col){let{width:t,height:e}=ls(lh,this,lu).call(this),{row:s,col:l}=ls(lh,this,lf).call(this,o),h=lr(la,this).fixedRowsBottom(),c=lr(la,this).minSpareRows(),d=lr(la,this).minSpareCols(),u=lr(la,this).autoWrapRow(),g=lr(la,this).autoWrapCol(),p=lr(la,this).createCellCoords(s+r.row,l+r.col);if(p.row>=e){let r=(0,t3.createObjectPropListener)(i&&c>0&&0===h),o=p.col+1,s=lr(la,this).createCellCoords(p.row-e,o>=t?o-t:o);this.runLocalHooks("beforeColumnWrap",r,ls(lh,this,lm).call(this,s),o>=t),r.value?this.runLocalHooks("insertRowRequire",lr(la,this).countRenderableRows()):g&&p.assign(s)}else if(p.row<0){let i=(0,t3.createObjectPropListener)(g),r=p.col-1,o=lr(la,this).createCellCoords(e+p.row,r<0?t+r:r);this.runLocalHooks("beforeColumnWrap",i,ls(lh,this,lm).call(this,o),r<0),g&&p.assign(o)}if(p.col>=t){let r=(0,t3.createObjectPropListener)(i&&d>0),o=p.row+1,s=lr(la,this).createCellCoords(o>=e?o-e:o,p.col-t);this.runLocalHooks("beforeRowWrap",r,ls(lh,this,lm).call(this,s),o>=e),r.value?this.runLocalHooks("insertColRequire",lr(la,this).countRenderableColumns()):u&&p.assign(s)}else if(p.col<0){let i=(0,t3.createObjectPropListener)(u),r=p.row-1,o=lr(la,this).createCellCoords(r<0?e+r:r,t+p.col);this.runLocalHooks("beforeRowWrap",i,ls(lh,this,lm).call(this,o),r<0),u&&p.assign(o)}let{rowDir:f,colDir:m}=ls(lh,this,ld).call(this,p);n=f,a=m,o=ls(lh,this,lm).call(this,p)}return this.runLocalHooks("afterTransformStart",o,n,a),o}transformEnd(t,e){let i=lr(la,this).createCellCoords(t,e),r=lr(ln,this).current(),o=lr(la,this).visualToRenderableCoords(r.highlight),s=ls(lh,this,lg).call(this,r.to.row,r.from.row),n=ls(lh,this,lp).call(this,r.to.col,r.from.col),a=r.to.clone(),l=0,h=0;if(this.runLocalHooks("beforeTransformEnd",i),null!==o.row&&null!==o.col&&null!==s&&null!==n){let{row:t,col:e}=ls(lh,this,lf).call(this,r.highlight),o=lr(la,this).createCellCoords(s+i.row,n+i.col),c=r.getTopStartCorner(),d=r.getTopEndCorner(),u=r.getBottomEndCorner(),g={row:o.row-t,col:o.col-e};i.col<0?n>=e&&o.col<e&&(o.col=ls(lh,this,lp).call(this,c.col,d.col)+g.col):i.col>0&&n<=e&&o.col>e&&(o.col=ls(lh,this,lp).call(this,d.col,c.col)+g.col),i.row<0?s>=t&&o.row<t&&(o.row=ls(lh,this,lg).call(this,c.row,u.row)+g.row):i.row>0&&s<=t&&o.row>t&&(o.row=ls(lh,this,lg).call(this,u.row,c.row)+g.row);let{rowDir:p,colDir:f}=ls(lh,this,ld).call(this,o);l=p,h=f;let m=ls(lh,this,lm).call(this,o);0===i.row&&0!==i.col?a.col=m.col:0!==i.row&&0===i.col?a.row=m.row:(a.row=m.row,a.col=m.col)}return this.runLocalHooks("afterTransformEnd",a,l,h),a}setOffsetSize(t){let{x:e,y:i}=t;lo(ll,this,{x:e,y:i})}}function ld(t){let{width:e,height:i}=ls(lh,this,lu).call(this),r=0,o=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=i&&(r=1,t.row=i-1),t.col<0?(o=-1,t.col=0):t.col>0&&t.col>=e&&(o=1,t.col=e-1),{rowDir:r,colDir:o}}function lu(){return{width:lr(ll,this).x+lr(la,this).countRenderableColumns(),height:lr(ll,this).y+lr(la,this).countRenderableRows()}}function lg(t,e){let i=lr(la,this).findFirstNonHiddenRenderableRow(t,e);return null===i?null:lr(ll,this).y+i}function lp(t,e){let i=lr(la,this).findFirstNonHiddenRenderableColumn(t,e);return null===i?null:lr(ll,this).x+i}function lf(t){let{row:e,col:i}=lr(la,this).visualToRenderableCoords(t);if(null===e||null===i)throw Error("Renderable coords are not visible.");return lr(la,this).createCellCoords(lr(ll,this).y+e,lr(ll,this).x+i)}function lm(t){let e=t.clone();return e.col=t.col-lr(ll,this).x,e.row=t.row-lr(ll,this).y,lr(la,this).renderableToVisualCoords(e)}(0,t3.mixin)(lc,sB),tn("1C6fS"),tn("1hIp0");var eu=tn("ceXML"),tJ=tn("gnaTS");const ly=[3,2],lv=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],lw=Symbol("root"),lb=Symbol("child");function lC(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lw;if(e!==lw&&e!==lb)throw Error("The second argument is used internally only and cannot be overwritten.");let i=Array.isArray(t),r=e===lw,o=0;if(i){let e=t[0];0===t.length?o=1:r&&e instanceof rB?o=3:r&&Array.isArray(e)?o=lC(e,lb):t.length>=2&&t.length<=4&&!t.some((t,e)=>!lv[e].includes(typeof t))&&(o=2)}return o}function lS(t){let{createCellCoords:e,createCellRange:i,keepDirection:r=!1,propToCol:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ly.includes(t))throw Error("Unsupported selection ranges schema type was provided.");return function(s){let n=3===t,a=n?s.from.row:s[0],l=n?s.from.col:s[1],h=n?s.to.row:s[2],c=n?s.to.col:s[3];if("function"==typeof o&&("string"==typeof l&&(l=o(l)),"string"==typeof c&&(c=o(c))),(0,tJ.isUndefined)(h)&&(h=a),(0,tJ.isUndefined)(c)&&(c=l),!r){let t=a,e=l,i=h,r=c;a=Math.min(t,i),l=Math.min(e,r),h=Math.max(t,i),c=Math.max(e,r)}let d=e(a,l);return i(d,d,e(h,c))}}var iJ=tn("iCsRe"),iq=tn("4Pbrh");function lx(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function lE(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function lR(t,e){return t.get(lM(t,e))}function lT(t,e,i){return t.set(lM(t,e),i),i}function lM(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var lk=new WeakMap,lA=new WeakMap,lO=new WeakMap,lP=new WeakMap,lI=new WeakMap,lH=new WeakMap;class lL{constructor(t,e){var i=this;lE(this,"settings",void 0),lE(this,"tableProps",void 0),lE(this,"inProgress",!1),lE(this,"selectedRange",new lt((t,e,i)=>this.tableProps.createCellRange(t,e,i))),lE(this,"highlight",void 0),lx(this,lk,void 0),lx(this,lA,void 0),lE(this,"selectedByRowHeader",new Set),lE(this,"selectedByColumnHeader",new Set),lx(this,lO,!1),lx(this,lP,!1),lx(this,lI,"unknown"),lx(this,lH,-1),this.settings=t,this.tableProps=e,this.highlight=new a9({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,cellAttributes:[(0,iq.A11Y_SELECTED)()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(t,e)=>this.tableProps.isDisabledCellSelection(t,e),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),createCellRange:(t,e,i)=>this.tableProps.createCellRange(t,e,i)}),lT(lk,this,new lc(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),fixedRowsBottom:()=>t.fixedRowsBottom,minSpareRows:()=>t.minSpareRows,minSpareCols:()=>t.minSpareCols,autoWrapRow:()=>t.autoWrapRow,autoWrapCol:()=>t.autoWrapCol})),lT(lA,this,new lc(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{let t=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,t.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{let t=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,t.getOuterBottomEndCorner().col)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),lR(lk,this).addLocalHook("beforeTransformStart",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeModifyTransformStart",...e)}),lR(lk,this).addLocalHook("afterTransformStart",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("afterModifyTransformStart",...e)}),lR(lk,this).addLocalHook("beforeTransformEnd",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeModifyTransformEnd",...e)}),lR(lk,this).addLocalHook("afterTransformEnd",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("afterModifyTransformEnd",...e)}),lR(lk,this).addLocalHook("insertRowRequire",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("insertRowRequire",...e)}),lR(lk,this).addLocalHook("insertColRequire",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("insertColRequire",...e)}),lR(lk,this).addLocalHook("beforeRowWrap",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeRowWrap",...e)}),lR(lk,this).addLocalHook("beforeColumnWrap",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeColumnWrap",...e)}),lR(lA,this).addLocalHook("beforeTransformStart",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeModifyTransformFocus",...e)}),lR(lA,this).addLocalHook("afterTransformStart",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("afterModifyTransformFocus",...e)})}getSelectedRange(){return this.selectedRange}markSource(t){lT(lI,this,t)}markEndSource(){lT(lI,this,"unknown")}getSelectionSource(){return lR(lI,this)}setExpectedLayers(t){lT(lH,this,t)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,lT(lH,this,-1)}isInProgress(){return this.inProgress}setRangeStart(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,o="multiple"===this.settings.selectionMode,s=(0,tJ.isUndefined)(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,n=t.clone();lT(lO,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,n),(!o||o&&!s&&(0,tJ.isUndefined)(e))&&this.selectedRange.clear(),this.selectedRange.add(n).current().setHighlight(r.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(t)}setRangeStartOnly(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;this.setRangeStart(t,e,!0,i)}setRangeEnd(t){if(this.selectedRange.isEmpty())return;let e=t.clone(),i=this.tableProps.countRows(),r=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(t).isSingleHeader();if((i>0||r>0)&&(0===i&&e.col<0&&!o||0===r&&e.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",e),this.begin();let s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),"single"===this.settings.selectionMode)s.setFrom(s.highlight),s.setTo(s.highlight);else{let t=s.getHorizontalDirection(),i=s.getVerticalDirection(),r=this.isMultiple();s.setTo(e),r&&(t!==s.getHorizontalDirection()||1===s.getWidth()&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),r&&(i!==s.getVerticalDirection()||1===s.getHeight()&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}i>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight);let n=this.getLayerLevel();n<this.highlight.layerLevel&&((0,eu.arrayEach)(this.highlight.getAreas(),t=>void t.clear()),(0,eu.arrayEach)(this.highlight.getLayeredAreas(),t=>void t.clear()),(0,eu.arrayEach)(this.highlight.getRowHeaders(),t=>void t.clear()),(0,eu.arrayEach)(this.highlight.getColumnHeaders(),t=>void t.clear()),(0,eu.arrayEach)(this.highlight.getActiveRowHeaders(),t=>void t.clear()),(0,eu.arrayEach)(this.highlight.getActiveColumnHeaders(),t=>void t.clear()),(0,eu.arrayEach)(this.highlight.getActiveCornerHeaders(),t=>void t.clear()),(0,eu.arrayEach)(this.highlight.getRowHighlights(),t=>void t.clear()),(0,eu.arrayEach)(this.highlight.getColumnHighlights(),t=>void t.clear())),this.highlight.useLayerLevel(n);let a=this.highlight.createArea(),l=this.highlight.createLayeredArea(),h=this.highlight.createRowHeader(),c=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),g=this.highlight.createActiveCornerHeader(),p=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(a.clear(),l.clear(),h.clear(),c.clear(),d.clear(),u.clear(),g.clear(),p.clear(),f.clear(),this.highlight.isEnabledFor(a$,s.highlight)&&(this.isMultiple()||n>=1)&&(a.add(s.from).add(s.to).commit(),l.add(s.from).add(s.to).commit(),1===n)){let t=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(t.from).commit().syncWith(t),this.highlight.createLayeredArea().add(t.from).commit().syncWith(t),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(aG,s.highlight)){if(!s.isSingleHeader()){let t=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),e=this.tableProps.createCellCoords(s.to.row,-1),i=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),r=this.tableProps.createCellCoords(-1,s.to.col);"single"===this.settings.selectionMode?(h.add(t).commit(),c.add(i).commit(),p.add(t).commit(),f.add(i).commit()):(h.add(t).add(e).commit(),c.add(i).add(r).commit(),p.add(t).add(e).commit(),f.add(i).add(r).commit())}let t=!lR(lP,this)&&this.isEntireRowSelected()&&(r>0&&r===s.getWidth()||0===r&&this.isSelectedByRowHeader()),e=!lR(lP,this)&&this.isEntireColumnSelected()&&(i>0&&i===s.getHeight()||0===i&&this.isSelectedByColumnHeader());t&&d.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),e&&u.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),t&&e&&g.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}let m=-1===lR(lH,this)||this.selectedRange.size()===lR(lH,this);this.runLocalHooks("afterSetRangeEnd",t,m)}setRangeFocus(t){if(this.selectedRange.isEmpty())return;let e=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",t);let i=this.highlight.getFocus();i.clear(),e.setHighlight(t),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(aX,e.highlight)&&i.add(e.highlight).commit().syncWith(e),this.inProgress||(lT(lO,this,!0),this.runLocalHooks("afterSetFocus",e.highlight))}transformStart(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.settings.navigableHeaders&&lR(lk,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}),this.setRangeStart(lR(lk,this).transformStart(t,e,i))}transformEnd(t,e){this.settings.navigableHeaders&&lR(lk,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}),this.setRangeEnd(lR(lk,this).transformEnd(t,e))}transformFocus(t,e){let i=this.selectedRange.current(),{row:r,col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),n=this.tableProps.countRenderableRowsInRange(0,r-1);i.highlight.isHeader()?lR(lA,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:r<0?Math.abs(r):-n}):lR(lA,this).setOffsetSize({x:o<0?0:-s,y:r<0?0:-n});let a=lR(lA,this).transformStart(t,e);this.setRangeFocus(a.normalize())}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;let t=(0,t3.createObjectPropListener)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}isFocusSelectionChanged(){return this.isSelected()&&lR(lO,this)}isSelectedByRowHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&(-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t))}isEntireRowSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel(),e=t=>{let{col:e}=t.getOuterTopStartCorner(),i=this.tableProps.countRowHeaders(),r=this.tableProps.countCols();return(i>0&&e<0||0===i)&&t.getWidth()===r};if(-1===t)return Array.from(this.selectedRange).some(t=>e(t));let i=this.selectedRange.peekByIndex(t);return!!i&&e(i)}isSelectedByColumnHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t))}isEntireColumnSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel(),e=t=>{let{row:e}=t.getOuterTopStartCorner(),i=this.tableProps.countColHeaders(),r=this.tableProps.countRows();return(i>0&&e<0||0===i)&&t.getHeight()===r};if(-1===t)return Array.from(this.selectedRange).some(t=>e(t));let i=this.selectedRange.peekByIndex(t);return!!i&&e(i)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(t){return this.selectedRange.includes(t)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(t){let e=this.tableProps.visualToRenderableCoords(t);return null!==e.row&&null!==e.col}isAreaCornerVisible(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var t;let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1},o=this.tableProps.countRows(),s=this.tableProps.countCols(),n=this.tableProps.countRowHeaders(),a=this.tableProps.countColHeaders(),l=i?-a:0,h=e?-n:0;if(0===l&&0===h&&(0===o||0===s))return;let c=null===(t=this.getSelectedRange().current())||void 0===t?void 0:t.highlight,{focusPosition:d,disableHeadersHighlight:u}=r;lT(lP,this,u),d&&Number.isInteger(null==d?void 0:d.row)&&Number.isInteger(null==d?void 0:d.col)&&(c=this.tableProps.createCellCoords((0,eq.clamp)(d.row,l,o-1),(0,eq.clamp)(d.col,h,s-1)));let g=this.tableProps.createCellCoords(l,h),p=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(g,void 0,c),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),l<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.finish(),lT(lP,this,!1)}selectCells(t){var e=this;let i=lC(t);if(1===i)return!1;if(0===i)throw Error((0,iJ.toSingleLine)`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);let r=lS(i,{createCellCoords:function(){return e.tableProps.createCellCoords(...arguments)},createCellRange:function(){return e.tableProps.createCellRange(...arguments)},propToCol:t=>this.tableProps.propToCol(t),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},n=!t.some(t=>{let e=r(t),i=e.isValid(s);return!(i&&!e.containsHeaders()||i&&e.containsHeaders()&&e.isSingleHeader())});return n&&(this.clear(),this.setExpectedLayers(t.length),(0,eu.arrayEach)(t,t=>{let{from:e,to:i}=r(t);this.setRangeStartOnly(e.clone(),!1),this.setRangeEnd(i.clone())}),this.finish()),n}selectColumns(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r="string"==typeof t?this.tableProps.propToCol(t):t,o="string"==typeof e?this.tableProps.propToCol(e):e,s=this.tableProps.countRows(),n=this.tableProps.countCols(),a=this.tableProps.countColHeaders(),l=0===a?0:-a,h=this.tableProps.createCellCoords(l,r),c=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(h,h,c).isValid({countRows:s,countCols:n,countRowHeaders:0,countColHeaders:a});if(d){let t=0,e=0;Number.isInteger(null==i?void 0:i.row)&&Number.isInteger(null==i?void 0:i.col)?(t=(0,eq.clamp)(i.row,l,s-1),e=(0,eq.clamp)(i.col,Math.min(r,o),Math.max(r,o))):(t=(0,eq.clamp)(i,l,s-1),e=r);let n=this.tableProps.createCellCoords(t,e),h=0===a?0:(0,eq.clamp)(n.row,l,-1),c=s-1,d=this.tableProps.createCellCoords(h,r),u=this.tableProps.createCellCoords(c,o);this.runLocalHooks("beforeSelectColumns",d,u,n),d.row=h,u.row=c,this.setRangeStartOnly(d,void 0,n),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(u),this.runLocalHooks("afterSelectColumns",d,u,n),this.finish()}return d}selectRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),n=0===s?0:-s,a=this.tableProps.createCellCoords(t,n),l=this.tableProps.createCellCoords(e,o-1),h=this.tableProps.createCellRange(a,a,l).isValid({countRows:r,countCols:o,countRowHeaders:s,countColHeaders:0});if(h){let r=0,a=0;Number.isInteger(null==i?void 0:i.row)&&Number.isInteger(null==i?void 0:i.col)?(r=(0,eq.clamp)(i.row,Math.min(t,e),Math.max(t,e)),a=(0,eq.clamp)(i.col,n,o-1)):(r=t,a=(0,eq.clamp)(i,n,o-1));let l=this.tableProps.createCellCoords(r,a),h=0===s?0:(0,eq.clamp)(l.col,n,-1),c=o-1,d=this.tableProps.createCellCoords(t,h),u=this.tableProps.createCellCoords(e,c);this.runLocalHooks("beforeSelectRows",d,u,l),d.col=h,u.col=c,this.setRangeStartOnly(d,void 0,l),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(u),this.runLocalHooks("afterSelectRows",d,u,l),this.finish()}return h}refresh(){if(this.highlight.getCustomSelections().forEach(t=>{t.commit()}),!this.isSelected())return;let t=this.highlight.getFocus(),e=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let t=0;t<this.selectedRange.size();t+=1){this.highlight.useLayerLevel(t);let e=this.highlight.createArea(),i=this.highlight.createLayeredArea(),r=this.highlight.createRowHeader(),o=this.highlight.createColumnHeader(),s=this.highlight.createActiveRowHeader(),n=this.highlight.createActiveColumnHeader(),a=this.highlight.createActiveCornerHeader(),l=this.highlight.createRowHighlight(),h=this.highlight.createColumnHighlight();e.commit(),i.commit(),r.commit(),o.commit(),s.commit(),n.commit(),a.commit(),l.commit(),h.commit()}this.highlight.useLayerLevel(e)}}(0,t3.mixin)(lL,sB),tn("1C6fS");var nd=tn("10euP"),t3=tn("hwT6B"),tQ=tn("f3221");function lD(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class lN{constructor(t){lD(this,"metaManager",void 0),lD(this,"metaSyncMemo",new Map),this.metaManager=t,t.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),(0,nd.default).getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(t){var e,i;let{row:r,col:o}=t;if(null!==(e=this.metaSyncMemo.get(r))&&void 0!==e&&e.has(o))return;let{visualRow:s,visualCol:n}=t,a=this.metaManager.hot,l=a.colToProp(n);t.prop=l,a.runHooks("beforeGetCellMeta",s,n,t);let h=(0,t3.hasOwnProperty)(t,"type")?t.type:null,c=(0,tQ.isFunction)(t.cells)?t.cells(r,o,l):null;h&&(c?c.type=null!==(i=c.type)&&void 0!==i?i:h:c={type:h}),c&&this.metaManager.updateCellMeta(r,o,c),a.runHooks("afterGetCellMeta",s,n,t),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(o)}}function l_(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}tn("1C6fS");class lF{constructor(t){l_(this,"metaManager",void 0),l_(this,"usageTracker",new Set),l_(this,"propDescriptors",new Map([["ariaTags",{onChange(t,e,i){if(!i)throw Error(`The \`${t}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===t)throw Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,e,i){if(!i)throw Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=t,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((t,e)=>{let{target:i,onChange:r=()=>{}}=t,o="string"==typeof i,s=o?i:e,n=`_${s}`;this.metaManager.globalMeta.meta[n]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(e,n,r),o&&this.installPropWatcher(i,n,r)})}installPropWatcher(t,e,i){let r=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get(){return this[e]},set(o){let s=!r.usageTracker.has(t);r.usageTracker.add(t),i.call(r,t,o,s),this[e]=o},enumerable:!0,configurable:!0})}}tn("1C6fS"),tn("1C6fS");var t3=tn("hwT6B");tn("1C6fS");var t3=tn("hwT6B");tn("1C6fS");var e7=tn("lSZ9A"),il=tn("jxqWV");const{register:lj,getItem:lB,hasItem:lW,getNames:lV,getValues:lU}=(0,e7.default)("cellTypes");function lz(t){if(!lW(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return lB(t)}function lY(t,e){"string"!=typeof t&&(t=(e=t).CELL_TYPE);let{editor:i,renderer:r,validator:o}=e;i&&(0,il.registerEditor)(t,i),r&&ia(t,r),o&&im(t,o),lj(t,e)}function lG(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r="string"==typeof e.type?lz(e.type):e.type;if(t._automaticallyAssignedMetaProps&&(0,t3.objectEach)(e,(e,i)=>void t._automaticallyAssignedMetaProps.delete(i)),!(0,t3.isObject)(r))return;i!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);let o={};(0,t3.objectEach)(r,(e,r)=>{var s,n;"CELL_TYPE"!==r&&((null===(s=i._automaticallyAssignedMetaProps)||void 0===s?void 0:s.has(r))||!(0,t3.hasOwnProperty)(i,r))&&(o[r]=e,null===(n=t._automaticallyAssignedMetaProps)||void 0===n||n.add(r))}),(0,t3.extend)(t,o)}function l$(t){return Number.isInteger(t)&&t>=0}function lX(t,e){if(!t())throw Error(`Assertion failed: ${e}`)}var tJ=tn("gnaTS"),t3=tn("hwT6B"),lq=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,i,r;for(e=0,i=this.countRows();e<i;e++)if(r=this.getDataAtCell(e,t),!1===(0,tJ.isEmpty)(r))return!1;return!0},isEmptyRow(t){let e,i,r,o;for(e=0,i=this.countCols();e<i;e++)if(r=this.getDataAtCell(t,e),!1===(0,tJ.isEmpty)(r)){if("object"==typeof r)return o=this.getCellMeta(t,e),(0,t3.isObjectEqual)(this.getSchema()[o.prop],r);return!1}return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function lK(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class lZ{constructor(t){lK(this,"metaCtor",class{}),lK(this,"meta",void 0),this.meta=this.metaCtor.prototype,(0,t3.extend)(this.meta,lq()),this.meta.instance=t}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(t){var e;(0,t3.extend)(this.meta,t),lG(this.meta,{...t,type:null!==(e=t.type)&&void 0!==e?e:this.meta.type},t)}}tn("1C6fS");var t3=tn("hwT6B");class lQ{constructor(t){var e,i,r;i=void 0,(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e="meta","string"))?r:r+"")in this?Object.defineProperty(this,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[e]=i;let o=t.getMetaConstructor();this.meta=new o}getMeta(){return this.meta}updateMeta(t){(0,t3.extend)(this.meta,t),lG(this.meta,t,t)}}tn("1C6fS");var t3=tn("hwT6B");tn("1C6fS"),tn("1hIp0");var eu=tn("ceXML");function lJ(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class l0{constructor(t){lJ(this,"valueFactory",void 0),lJ(this,"data",[]),lJ(this,"index",[]),lJ(this,"holes",new Set),this.valueFactory=t}obtain(t){let e;lX(()=>l$(t),"Expecting an unsigned number.");let i=this._getStorageIndexByKey(t);if(i>=0)void 0===(e=this.data[i])&&(e=this.valueFactory(t),this.data[i]=e);else if(e=this.valueFactory(t),this.holes.size>0){let i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=e,this.index[t]=i}else this.data.push(e),this.index[t]=this.data.length-1;return e}insert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;lX(()=>l$(t)||null==t,"Expecting an unsigned number or null/undefined argument.");let i=[],r=this.data.length;for(let t=0;t<e;t++)i.push(r+t),this.data.push(void 0);let o=null==t?this.index.length:t;this.index=[...this.index.slice(0,o),...i,...this.index.slice(o)]}remove(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;lX(()=>l$(t)||null==t,"Expecting an unsigned number or null/undefined argument.");let i=this.index.splice(null==t?this.index.length-e:t,e);for(let t=0;t<i.length;t++){let e=i[t];"number"==typeof e&&this.holes.add(e)}}size(){return this.data.length-this.holes.size}values(){return(0,eu.arrayFilter)(this.data,(t,e)=>!this.holes.has(e))[Symbol.iterator]()}entries(){let t=[];for(let e=0;e<this.data.length;e++){let i=this._getKeyByStorageIndex(e);-1!==i&&t.push([i,this.data[e]])}let e=0;return{next:()=>{if(e<t.length){let i=t[e];return e+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(t){return this.index.length>t?this.index[t]:-1}_getKeyByStorageIndex(t){return this.index.indexOf(t)}[Symbol.iterator](){return this.entries()}}function l1(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const l2=["data","width"];class l3{constructor(t){l1(this,"globalMeta",void 0),l1(this,"metas",new l0(()=>this._createMeta())),this.globalMeta=t,this.metas=new l0(()=>this._createMeta())}updateMeta(t,e){let i=this.getMeta(t);(0,t3.extend)(i,e),lG(i,e)}createColumn(t,e){this.metas.insert(t,e)}removeColumn(t,e){this.metas.remove(t,e)}getMeta(t){return this.metas.obtain(t)}getMetaConstructor(t){return this.metas.obtain(t).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function i(){}(0,t3.inherit)(i,t);for(let t=0;t<e.length;t++)i.prototype[e[t]]=void 0;return i}(this.globalMeta.getMetaConstructor(),l2).prototype}}tn("1C6fS"),tn("1hIp0");var t3=tn("hwT6B"),tJ=tn("gnaTS");function l6(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class l4{constructor(t){l6(this,"columnMeta",void 0),l6(this,"metas",new l0(()=>this._createRow())),this.columnMeta=t}updateMeta(t,e,i){let r=this.getMeta(t,e);(0,t3.extend)(r,i),lG(r,i)}createRow(t,e){this.metas.insert(t,e)}createColumn(t,e){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(t,e)}removeRow(t,e){this.metas.remove(t,e)}removeColumn(t,e){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(t,e)}getMeta(t,e,i){let r=this.metas.obtain(t).obtain(e);return void 0===i?r:r[i]}setMeta(t,e,i,r){var o;let s=this.metas.obtain(t).obtain(e);null===(o=s._automaticallyAssignedMetaProps)||void 0===o||o.delete(i),s[i]=r}removeMeta(t,e,i){let r=this.metas.obtain(t).obtain(e);delete r[i]}getMetas(){let t=[],e=Array.from(this.metas.values());for(let i=0;i<e.length;i++)(0,tJ.isDefined)(e[i])&&t.push(...e[i].values());return t}getMetasAtRow(t){lX(()=>l$(t),"Expecting an unsigned number.");let e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new l0(t=>this._createMeta(t))}_createMeta(t){return new(this.columnMeta.getMetaConstructor(t))}}var t3=tn("hwT6B");class l5{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=t,this.globalMeta=new lZ(t),this.tableMeta=new lQ(this.globalMeta),this.columnMeta=new l3(this.globalMeta),this.cellMeta=new l4(this.columnMeta),i.forEach(t=>new t(this)),this.globalMeta.updateMeta(e)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(t){this.globalMeta.updateMeta(t)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(t){this.tableMeta.updateMeta(t)}getColumnMeta(t){return this.columnMeta.getMeta(t)}updateColumnMeta(t,e){this.columnMeta.updateMeta(t,e)}getCellMeta(t,e,i){let{visualRow:r,visualColumn:o}=i,s=this.cellMeta.getMeta(t,e);return s.visualRow=r,s.visualCol=o,s.row=t,s.col=e,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(t,e,i){if("string"!=typeof i)throw Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,i)}setCellMeta(t,e,i,r){this.cellMeta.setMeta(t,e,i,r)}updateCellMeta(t,e,i){this.cellMeta.updateMeta(t,e,i)}removeCellMeta(t,e,i){this.cellMeta.removeMeta(t,e,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(t){return this.cellMeta.getMetasAtRow(t)}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}createColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}removeColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}(0,t3.mixin)(l5,sB),tn("1C6fS"),tn("1hIp0");var eX=tn("bO142"),tQ=tn("f3221");tn("1C6fS"),tn("1hIp0");const l9=/^(\r\n|\n\r|\r|\n)/,l8=/^[^\t\r\n]+/,l7=/^\t/;function ht(t){let e,i,r,o,s;let n="";for(e=0,i=t.length;e<i;e+=1){for(r=0,o=t[e].length;r<o;r+=1)r>0&&(n+="	"),"string"==typeof(s=t[e][r])?s.indexOf("\n")>-1?n+=`"${s.replace(/"/g,'""')}"`:n+=s:null==s?n+="":n+=s;e!==i-1&&(n+="\n")}return n}var t3=tn("hwT6B"),eu=tn("ceXML"),eq=tn("guO5N"),tJ=tn("gnaTS");function he(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class hi{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(t,e,i){he(this,"hot",void 0),he(this,"metaManager",void 0),he(this,"tableMeta",void 0),he(this,"dataSource",void 0),he(this,"duckSchema",void 0),he(this,"colToPropCache",void 0),he(this,"propToColCache",void 0),this.hot=t,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=e,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){let t;let e=this.getSchema();if(void 0===e)throw Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");let i=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,i){let r=0,o=0,s=!1;if("function"==typeof i){let t=(0,t3.deepObjectSize)(e);r=t>0?t:this.countFirstRowKeys(),s=!0}else r=Math.min(this.tableMeta.maxCols,i.length);for(t=0;t<r;t++){let e=s?i(t):i[t];if((0,t3.isObject)(e)){if(void 0!==e.data){let i=s?o:t;this.colToPropCache[i]=e.data,this.propToColCache.set(e.data,i)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return sD(this.dataSource)}recursiveDuckColumns(t,e,i){let r,o=e,s=i;return void 0===o&&(o=0,s=""),"object"!=typeof t||Array.isArray(t)||(0,t3.objectEach)(t,(t,e)=>{null===t?(r=s+e,this.colToPropCache.push(r),this.propToColCache.set(r,o),o+=1):o=this.recursiveDuckColumns(t,o,`${e}.`)}),o}colToProp(t){if(!1===Number.isInteger(t))return t;let e=this.hot.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&(0,tJ.isDefined)(this.colToPropCache[e])?this.colToPropCache[e]:e}propToCol(t){let e=this.propToColCache.get(t);if((0,tJ.isDefined)(e))return this.hot.toVisualColumn(e);let i=this.hot.toVisualColumn(t);return null===i?t:i}getSchema(){let t=this.tableMeta.dataSchema;return t?"function"==typeof t?t():t:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?(0,t3.duckSchema)(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:i,mode:r="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this.hot.countSourceRows(),s=o,n=0,a=t;if(("number"!=typeof a||a>=o)&&(a=o),a<this.hot.countRows()&&(s=this.hot.toPhysicalRow(a)),!1===this.hot.runHooks("beforeCreateRow",a,e,i)||null===s)return{delta:0};let l=this.tableMeta.maxRows,h=this.getSchema().length,c=[];for(;n<e&&o+n<l;){let t=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?t=(0,t3.deepClone)(this.getSchema()):(t=[],(0,eq.rangeEach)(h-1,()=>t.push(null))):"function"===this.hot.dataType?t=this.tableMeta.dataSchema(a+n):(t={},(0,t3.deepExtend)(t,this.getSchema())),c.push(t),n+=1}this.hot.rowIndexMapper.insertIndexes(a,n),"below"===r&&(s=Math.min(s+1,o)),this.spliceData(s,0,c);let d=this.hot.toVisualRow(s);return this.hot.countSourceRows()===c.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),n>0&&(null==t?this.metaManager.createRow(null,n):"auto"!==i&&this.metaManager.createRow(s,e)),this.hot.runHooks("afterCreateRow",d,n,i),this.hot.forceFullRender=!0,{delta:n,startPhysicalIndex:s}}createCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:i,mode:r="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");let o=this.dataSource,s=this.tableMeta.maxCols,n=this.hot.countSourceCols(),a=t;if(("number"!=typeof a||a>=n)&&(a=n),!1===this.hot.runHooks("beforeCreateCol",a,e,i))return{delta:0};let l=n;a<this.hot.countCols()&&(l=this.hot.toPhysicalColumn(a));let h=this.hot.countSourceRows(),c=this.hot.countCols(),d=0,u=l;"end"===r&&(u=Math.min(u+1,n));let g=u;for(;d<e&&c<s;){if("number"!=typeof a||a>=c){if(h>0)for(let t=0;t<h;t+=1)void 0===o[t]&&(o[t]=[]),o[t].push(null);else o.push([null])}else for(let t=0;t<h;t++)o[t].splice(u,0,null);d+=1,u+=1,c+=1}this.hot.columnIndexMapper.insertIndexes(a,d),d>0&&(null==t?this.metaManager.createColumn(null,d):"auto"!==i&&this.metaManager.createColumn(g,e));let p=this.hot.toVisualColumn(g);return this.hot.runHooks("afterCreateCol",p,d,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:d,startPhysicalIndex:g}}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(t)?t:-e,o=this.visualRowsToPhysical(r,e),s=this.hot.countSourceRows();if(r=(s+r)%s,!1===this.hot.runHooks("beforeRemoveRow",r,o.length,o,i))return!1;let n=o.length;if(this.filterData(r,n,o),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);let t=(0,tJ.isDefined)(this.tableMeta.columns)||(0,tJ.isDefined)(this.tableMeta.dataSchema);0===this.hot.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===t&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((t,e)=>e-t).forEach(t=>{this.metaManager.removeRow(t,1)}),this.hot.runHooks("afterRemoveRow",r,n,o,i),this.hot.forceFullRender=!0,!0}removeCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw Error("cannot remove column with object data source or columns option specified");let r="number"!=typeof t?-e:t;r=(this.hot.countCols()+r)%this.hot.countCols();let o=this.visualColumnsToPhysical(r,e),s=o.slice(0).sort((t,e)=>e-t);if(!1===this.hot.runHooks("beforeRemoveCol",r,e,o,i))return!1;let n=!0,a=s.length,l=this.dataSource;for(let t=0;t<a;t++)n&&o[0]!==o[t]-t&&(n=!1);if(n)for(let t=0,i=this.hot.countSourceRows();t<i;t++)l[t].splice(o[0],e),0===t&&this.metaManager.removeColumn(o[0],e);else for(let t=0,e=this.hot.countSourceRows();t<e;t++)for(let e=0;e<a;e++)l[t].splice(s[e],1),0===t&&this.metaManager.removeColumn(s[e],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),0===this.hot.columnIndexMapper.getNotTrimmedIndexesLength()&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,e,o,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(t,e,i){let r=this.hot.getDataAtCol(t),o=r.slice(e,e+i),s=r.slice(e+i);for(var n=arguments.length,a=Array(n>3?n-3:0),l=3;l<n;l++)a[l-3]=arguments[l];(0,eu.extendArray)(a,s);let h=0;for(;h<i;)a.push(null),h+=1;return(0,eu.to2dArray)(a),this.hot.populateFromArray(e,t,a,null,null,"spliceCol"),o}spliceRow(t,e,i){let r=this.hot.getSourceDataAtRow(t),o=r.slice(e,e+i),s=r.slice(e+i);for(var n=arguments.length,a=Array(n>3?n-3:0),l=3;l<n;l++)a[l-3]=arguments[l];(0,eu.extendArray)(a,s);let h=0;for(;h<i;)a.push(null),h+=1;return this.hot.populateFromArray(t,e,[a],null,null,"spliceRow"),o}spliceData(t,e,i){if(!1!==this.hot.runHooks("beforeDataSplice",t,e,i)){let e=[...this.dataSource.slice(0,t),...i,...this.dataSource.slice(t)];this.dataSource.length=0,e.forEach(t=>this.dataSource.push(t))}}filterData(t,e,i){let r=this.hot.runHooks("filterData",t,e,i);!1===Array.isArray(r)&&(r=this.dataSource.filter((t,e)=>-1===i.indexOf(e))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(t,e){let i=this.hot.toPhysicalRow(t),r=this.dataSource[i],o=this.hot.runHooks("modifyRowData",i);r=isNaN(o)?o:r;let s=null;if(r&&r.hasOwnProperty&&(0,t3.hasOwnProperty)(r,e))s=r[e];else if("string"==typeof e&&e.indexOf(".")>-1){let t=e.split("."),i=r;if(!i)return null;for(let e=0,r=t.length;e<r;e++)if(void 0===(i=i[t[e]]))return null;s=i}else"function"==typeof e&&(s=e(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){let t=(0,t3.createObjectPropListener)(s);this.hot.runHooks("modifyData",i,this.propToCol(e),t,"get"),t.isTouched()&&(s=t.value)}return s}getCopyable(t,e){return this.hot.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}set(t,e,i){let r=this.hot.toPhysicalRow(t),o=i,s=this.dataSource[r],n=this.hot.runHooks("modifyRowData",r);if(s=isNaN(n)?n:s,this.hot.hasHook("modifyData")){let t=(0,t3.createObjectPropListener)(o);this.hot.runHooks("modifyData",r,this.propToCol(e),t,"set"),t.isTouched()&&(o=t.value)}if(s&&s.hasOwnProperty&&(0,t3.hasOwnProperty)(s,e))s[e]=o;else if("string"==typeof e&&e.indexOf(".")>-1){let t;let i=e.split("."),r=s,n=0;for(n=0,t=i.length-1;n<t;n++)void 0===r[i[n]]&&(r[i[n]]={}),r=r[i[n]];r[i[n]]=o}else"function"==typeof e?e(this.dataSource.slice(r,r+1)[0],o):s[e]=o}visualRowsToPhysical(t,e){let i=this.hot.countSourceRows(),r=[],o=(i+t)%i,s=e;for(;o<i&&s;)r.push(this.hot.toPhysicalRow(o)),s-=1,o+=1;return r}visualColumnsToPhysical(t,e){let i=this.hot.countCols(),r=[],o=(i+t)%i,s=e;for(;o<i&&s;){let t=this.hot.toPhysicalColumn(o);r.push(t),s-=1,o+=1}return r}clear(){for(let t=0;t<this.hot.countSourceRows();t++)for(let e=0;e<this.hot.countCols();e++)this.set(t,this.colToProp(e),"")}getLength(){let t;let e=this.tableMeta.maxRows;return t=e<0||0===e?0:e||1/0,Math.min(this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),t)}getAll(){let t={row:0,col:0},e={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return t.row-e.row!=0||this.hot.countSourceRows()?this.getRange(t,e,hi.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(t,e,i){let r,o,s;let n=[],a=this.tableMeta.maxRows,l=this.tableMeta.maxCols;if(0===a||0===l)return[];let h=i===hi.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,c=Math.min(Math.max(a-1,0),Math.max(t.row,e.row)),d=Math.min(Math.max(l-1,0),Math.max(t.col,e.col));for(r=Math.min(t.row,e.row);r<=c;r++){s=[];let i=r>=0?this.hot.toPhysicalRow(r):r;for(o=Math.min(t.col,e.col);o<=d&&null!==i;o++)s.push(h.call(this,r,this.colToProp(o)));null!==i&&n.push(s)}return n}getText(t,e){return ht(this.getRange(t,e,hi.DESTINATION_RENDERER))}getCopyableText(t,e){return ht(this.getRange(t,e,hi.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}var t3=tn("hwT6B"),tZ=tn("gFbQZ"),iq=tn("4Pbrh");function hr(t,e,i,r){let{hotInstance:o,dataMap:s,dataSource:n,internalSource:a,source:l,metaManager:h,firstRun:c}=r,d=(0,eX.toUpperCaseFirst)(a),u=o.getSettings();Array.isArray(u.dataSchema)?o.dataType="array":(0,tQ.isFunction)(u.dataSchema)?o.dataType="function":o.dataType="object",s&&s.destroy(),t=o.runHooks(`before${d}`,t,c,l);let g=new hi(o,t,h);if(e(g),"object"==typeof t&&null!==t)t.push&&t.splice||(t=[t]);else if(null===t){let e;let i=g.getSchema();t=[];let r=0,s=0;for(r=0,s=u.startRows;r<s;r++)if(("object"===o.dataType||"function"===o.dataType)&&u.dataSchema)e=(0,t3.deepClone)(i),t.push(e);else if("array"===o.dataType)e=(0,t3.deepClone)(i[0]),t.push(e);else{e=[];for(let t=0,i=u.startCols;t<i;t++)e.push(null);t.push(e)}}else throw Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(o.dataType="array"),u.data=t,g.dataSource=t,n.data=t,n.dataType=o.dataType,n.colToProp=g.colToProp.bind(g),n.propToCol=g.propToCol.bind(g),n.countCachedColumns=g.countCachedColumns.bind(g),i(g),o.runHooks(`after${d}`,t,c,l),c||(o.runHooks("afterChange",null,a),o.render()),o.getSettings().ariaTags&&(0,tZ.setAttribute)(o.rootElement,[(0,iq.A11Y_ROWCOUNT)(-1),(0,iq.A11Y_COLCOUNT)(o.countCols()+(o.view?o.countRowHeaders():0))])}const ho="gridDefault",hs="editorManager.handlingEditor";var tZ=tn("gFbQZ"),iq=tn("4Pbrh");function hn(t){let e=t.rootDocument.createElement("input");return e.type="text",e.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&(0,tZ.setAttribute)(e,[(0,iq.A11Y_PRESENTATION)(),(0,iq.A11Y_HIDDEN)()]),e}function ha(t){let{rowIndexMapper:e,columnIndexMapper:i}=t,{navigableHeaders:r}=t.getSettings(),o=r&&t.countColHeaders()>0?-t.countColHeaders():0,s=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return(0===o&&(o=e.getVisualFromRenderableIndex(o)),0===s&&(s=i.getVisualFromRenderableIndex(s)),null===o||null===s)?null:t._createCellCoords(o,s)}function hl(t){var e,i;let{rowIndexMapper:r,columnIndexMapper:o}=t,{navigableHeaders:s}=t.getSettings(),n=r.getRenderableIndexesLength()-1,a=o.getRenderableIndexesLength()-1;if(n<0){if(!s||0===t.countColHeaders())return null;n=-1}if(a<0){if(!s||0===t.countColHeaders())return null;a=-1}return t._createCellCoords(null!==(e=r.getVisualFromRenderableIndex(n))&&void 0!==e?e:n,null!==(i=o.getVisualFromRenderableIndex(a))&&void 0!==i?i:a)}tn("1C6fS");var iy=tn("7HxIw");tn("1C6fS"),tn("1hIp0");const hh=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),hc=t=>t.map(t=>{let e=t.toLowerCase();return hh.has(e)?hh.get(e):e}).sort().join("+"),hd=t=>t.split("+"),hu=RegExp("^(?:Key|Digit)([A-Z0-9])$"),hg=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),hp=t=>{let{key:e,code:i}=t,r=e;return hu.test(i)?r=i.replace(hu,"$1"):hg.has(i)&&(r=i),r.toLowerCase()};var tJ=tn("gnaTS"),tQ=tn("f3221"),t3=tn("hwT6B"),iJ=tn("iCsRe");const hf=Symbol("shortcut-context");function hm(t){return(0,t3.isObject)(t)&&t.__kindOf===hf}const hy=t=>{let e=e0({errorIdExists:e=>`The "${e}" shortcut is already registered in the "${t}" context.`}),i=function(){let{keys:t,callback:i,group:r,runOnlyIf:o=()=>!0,captureCtrl:s=!1,preventDefault:n=!0,stopPropagation:a=!1,relativeToGroup:l,position:h,forwardToContext:c}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,tJ.isUndefined)(r))throw Error("You need to define the shortcut's group.");if(!1===(0,tQ.isFunction)(i))throw Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(t))throw Error((0,iJ.toSingleLine)`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);let d={callback:i,group:r,runOnlyIf:o,captureCtrl:s,preventDefault:n,stopPropagation:a};(0,tJ.isDefined)(l)&&(d.relativeToGroup=l,d.position=h),hm(c)&&(d.forwardToContext=c),t.forEach(t=>{let i=hc(t);if(e.hasItem(i)){let t=e.getItem(i),r=t.findIndex(t=>t.group===l);-1!==r?"before"===h?r-=1:r+=1:r=t.length,t.splice(r,0,d)}else e.addItem(i,[d])})},r=t=>{let i=hc(t);e.removeItem(i)};return{__kindOf:hf,addShortcut:i,addShortcuts:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach(t=>{(0,t3.objectEach)(e,(i,r)=>{!1===Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=e[r])}),i(t)})},getShortcuts:t=>{let i=hc(t),r=e.getItem(i);return(0,tJ.isDefined)(r)?r.slice():[]},hasShortcut:t=>{let i=hc(t);return e.hasItem(i)},removeShortcutsByKeys:r,removeShortcutsByGroup:t=>{e.getItems().forEach(e=>{let[i,o]=e,s=o.filter(e=>e.group!==t);0===s.length?r(hd(i)):(o.length=0,o.push(...s))})}}};tn("1hIp0");var iy=tn("7HxIw"),tZ=tn("gFbQZ"),t0=tn("eL8cl");const hv=["meta","alt","shift","control"],hw=function(){let t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed:e=>t.has(e)}}(),hb=[];let hC=0;var iJ=tn("iCsRe");const hS=t=>{let{ownerWindow:e,handleEvent:i,beforeKeyDown:r,afterKeyDown:o}=t,s=e0({errorIdExists:t=>`The "${t}" context name is already registered.`}),n="grid",a=()=>n,l=t=>s.getItem(t),h=!1,c=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a(),r=hm(i)?i:l(i),o=!1;if(!r.hasShortcut(e))return o;let s=r.getShortcuts(e);for(let i=0;i<s.length;i++){let{callback:r,runOnlyIf:n,preventDefault:a,stopPropagation:l,captureCtrl:d,forwardToContext:u}=s[i];if(!0===n(t)){if(h=d,o=!1===r(t,e),h=!1,a&&t.preventDefault(),l&&((0,iy.stopImmediatePropagation)(t),t.stopPropagation()),o)break;u&&c(t,e,u)}}return o},d=function(t,e,i,r,o){let s=t=>hv.includes(t),n=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=[];return t.altKey&&i.push("alt"),e&&(t.ctrlKey||t.metaKey)?i.push("control/meta"):(t.ctrlKey&&i.push("control"),t.metaKey&&i.push("meta")),t.shiftKey&&i.push("shift"),i},a=t=>{if(!1===e(t))return;let a=i(t);if(229===t.keyCode||!1===a||(0,iy.isImmediatePropagationStopped)(t))return;let l=hp(t),h=[];s(l)||(h=n(t)),!o(t,[l].concat(h))&&((0,t0.isMacOS)()&&h.includes("meta")||!(0,t0.isMacOS)()&&h.includes("control"))&&o(t,[l].concat(n(t,!0))),r(t)},l=t=>{if(t.key){let e=hp(t);s(e)&&hw.press(e)}},h=t=>{if(t.key){let e=hp(t);s(e)&&hw.release(e)}},c=()=>{hw.releaseAll()};return{mount:()=>{let e=t;for(hC+=1;e;)1===hC&&(e.document.documentElement.addEventListener("keydown",l),hb.push({event:"keydown",listener:l}),e.document.documentElement.addEventListener("keyup",h),hb.push({event:"keyup",listener:h})),e.document.documentElement.addEventListener("keydown",a),e.document.documentElement.addEventListener("blur",c),e=(0,tZ.getParentWindow)(e)},unmount:()=>{let e=t;for(hC-=1;e;){if(0===hC){for(let t=0;t<hb.length;t++){let{event:i,listener:r}=hb[t];e.document.documentElement.removeEventListener(i,r)}hb.length=0}e.document.documentElement.removeEventListener("keydown",a),e.document.documentElement.removeEventListener("blur",c),e=(0,tZ.getParentWindow)(e)}},isPressed:t=>hw.isPressed(t),releasePressedKeys:()=>hw.releaseAll()}}(e,i,r,o,c);return d.mount(),{addContext:t=>{let e=hy(t);return s.addItem(t,e),e},getActiveContextName:a,getContext:l,setActiveContextName:t=>{if(!s.hasItem(t))throw Error((0,iJ.toSingleLine)`You've tried to activate the "${t}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);n=t},isCtrlPressed:()=>!h&&(d.isPressed("control")||d.isPressed("meta")),releasePressedKeys:()=>d.releasePressedKeys(),destroy:()=>d.unmount()}};var iy=tn("7HxIw");const hx=[{name:"editorCloseAndSave",callback(t,e){let i=t._getEditorManager();i.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),i.moveSelectionAfterEnter(e)}},{name:"editorCloseWithoutSaving",callback(t){let e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},{name:"editorFastOpen",callback(t,e){let{highlight:i}=t.getSelectedRangeLast();i.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},{name:"editorOpen",callback(t,e,i){let r=t._getEditorManager(),o=t.getSelectedRangeLast(),{highlight:s}=o;if(t.selection.isMultiple()&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){let r=t.getSettings(),o="function"==typeof r.enterMoves?r.enterMoves(e):r.enterMoves;i.includes("shift")?t.selection.transformFocus(-o.row,-o.col):t.selection.transformFocus(o.row,o.col);return}s.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),(0,iy.stopImmediatePropagation)(e))}},{name:"extendCellsSelectionDown",callback(t){let{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},{name:"extendCellsSelectionDownByViewportHeight",callback(t){let{to:e}=t.getSelectedRangeLast(),i=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(i,-1);if(null!==r){let i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"extendCellsSelectionLeft",callback(t){let{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},{name:"extendCellsSelectionRight",callback(t){let{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},{name:"extendCellsSelectionToColumns",callback(t){let{highlight:e,from:i,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(i.col,r.col,e)}},{name:"extendCellsSelectionToMostBottom",callback(t){let{selection:e,rowIndexMapper:i}=t,{highlight:r,from:o,to:s}=t.getSelectedRangeLast(),n=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||n){let a=i.getNearestNotHiddenIndex(t.countRows()-1,-1),l=o.clone();l.row=r.row,e.setRangeStart(l,void 0,!1,r.clone()),n&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col))}}},{name:"extendCellsSelectionToMostInlineEnd",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r,from:o,to:s}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&r.isCell()){let n=i.getNearestNotHiddenIndex(t.countCols()-1,-1),a=o.clone();a.col=r.col,e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(s.row,n))}}},{name:"extendCellsSelectionToMostInlineStart",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r,from:o,to:s}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&r.isCell()){let n=parseInt(t.getSettings().fixedColumnsStart,10),a=i.getNearestNotHiddenIndex(n,1),l=o.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},{name:"extendCellsSelectionToMostLeft",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r,from:o,to:s}=t.getSelectedRangeLast(),n=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||n){let a=i.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=o.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),n&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},{name:"extendCellsSelectionToMostRight",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r,from:o,to:s}=t.getSelectedRangeLast(),n=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||n){let a=i.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=o.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),n&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},{name:"extendCellsSelectionToMostTop",callback(t){let{selection:e,rowIndexMapper:i}=t,{highlight:r,from:o,to:s}=t.getSelectedRangeLast(),n=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||n){let a=i.getNearestNotHiddenIndex(0,1),l=o.clone();l.row=r.row,e.setRangeStart(l,void 0,!1,r.clone()),n&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col))}}},{name:"extendCellsSelectionToRows",callback(t){let{highlight:e,from:i,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(i.row,r.row,e)}},{name:"extendCellsSelectionUp",callback(t){let{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},{name:"extendCellsSelectionUpByViewportHeight",callback(t){let{to:e}=t.getSelectedRangeLast(),i=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(i,1);if(null!==r){let i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},{name:"moveCellSelectionDownByViewportHeight",callback(t){let{navigableHeaders:e}=t.getSettings(),i=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight,o=t.countVisibleRows()+i;r===t.countRows()-1?o=1:r+o>t.countRows()&&(o=t.countRows()-r-1),t.selection.transformStart(o,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},{name:"moveCellSelectionInlineEnd",callback(t,e){let i=t.getSettings(),r=t.getSelectedRangeLast(),o="function"==typeof i.tabMoves?i.tabMoves(e):i.tabMoves;t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-o.row,-o.col):t.selection.transformStart(-o.row,-o.col)}},{name:"moveCellSelectionInlineStart",callback(t,e){let i=t.getSettings(),r=t.getSelectedRangeLast(),o="function"==typeof i.tabMoves?i.tabMoves(e):i.tabMoves;t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(o.row,o.col):t.selection.transformStart(o.row,o.col)}},{name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},{name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},{name:"moveCellSelectionToMostBottom",callback(t){let{col:e}=t.getSelectedRangeLast().highlight,i=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);null===i&&(i=-1),t.selection.setRangeStart(t._createCellCoords(i,e))}},{name:"moveCellSelectionToMostBottomInlineEnd",callback(t){let{selection:e,rowIndexMapper:i,columnIndexMapper:r}=t,o=parseInt(t.getSettings().fixedRowsBottom,10),s=i.getNearestNotHiddenIndex(t.countRows()-o-1,-1),n=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(s,n))}},{name:"moveCellSelectionToMostInlineEnd",callback(t){let{selection:e,columnIndexMapper:i}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,i.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},{name:"moveCellSelectionToMostInlineStart",callback(t){let{selection:e,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),o=t.getSelectedRangeLast().highlight.row,s=i.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(o,s))}},{name:"moveCellSelectionToMostLeft",callback(t){let{selection:e,columnIndexMapper:i}=t,r=t.getSelectedRangeLast().highlight.row,o=i.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);null===o&&(o=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,o))}},{name:"moveCellSelectionToMostRight",callback(t){let{selection:e,columnIndexMapper:i}=t,{row:r}=t.getSelectedRangeLast().highlight,o=i.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);null===o&&(o=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,o))}},{name:"moveCellSelectionToMostTop",callback(t){let{col:e}=t.getSelectedRangeLast().highlight,i=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===i&&(i=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(i,e))}},{name:"moveCellSelectionToMostTopInlineStart",callback(t){let{selection:e,rowIndexMapper:i,columnIndexMapper:r}=t,o=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),n=i.getNearestNotHiddenIndex(o,1),a=r.getNearestNotHiddenIndex(s,1);e.setRangeStart(t._createCellCoords(n,a))}},{name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},{name:"moveCellSelectionUpByViewportHight",callback(t){let{navigableHeaders:e}=t.getSettings(),i=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight,o=-(t.countVisibleRows()+i);r===-i?o=-1:r+o<i&&(o=-(r+i)),t.selection.transformStart(o,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},{name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},{name:"scrollToFocusedCell",callback(t){let{highlight:e}=t.getSelectedRangeLast(),i=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,o=t.view.getLastFullyVisibleRow()+1,s=t.view.getLastFullyVisibleColumn()+1,n=t._createCellCoords(i,r),a=t._createCellCoords(o,s);if(!t._createCellRange(n,n,a).includes(e)&&(e.row>=0||e.col>=0)){let i={};if(e.col>=0){let r=Math.floor(t.countVisibleCols()/2);i.col=Math.max(e.col-r,0)}if(e.row>=0){let r=Math.floor(t.countVisibleRows()/2);i.row=Math.max(e.row-r,0)}t.scrollViewportTo({...i,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},{name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},{name:"populateSelectedCellsData",callback(t){let e=t.getSelectedRange(),{row:i,col:r}=e[e.length-1].highlight.normalize(),o=t.getDataAtCell(i,r),s=new Map;for(let n=0;n<e.length;n++)e[n].forAll((e,n)=>{if(e>=0&&n>=0&&(e!==i||n!==r)){let{readOnly:i}=t.getCellMeta(e,n);i||s.set(`${e}x${n}`,[e,n,o])}});t.setDataAtCell(Array.from(s.values()))}}];function hE(t){let e={};return hx.forEach(i=>{let{name:r,callback:o}=i;e[r]=function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return o(t,...i)}}),e}function hR(t){let e=t.getShortcutManager().addContext("editor"),i=hE(t);e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>i.editorCloseAndSave(t,e)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(t,e)=>i.editorCloseAndSave(t,e)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>i.editorCloseWithoutSaving()}],{group:hs})}var tJ=tn("gnaTS");function hT(t){let e=t.getShortcutManager().addContext("grid"),i=hE(t);e.addShortcuts([{keys:[["F2"]],callback:t=>i.editorFastOpen(t)},{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>i.editorOpen(t,e)},{keys:[["Backspace"],["Delete"]],callback:()=>i.emptySelectedCells()}],{group:hs,runOnlyIf:()=>(0,tJ.isDefined)(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>i.selectAllCells(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>t.getSelectedRangeLast().highlight.isHeader(),preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>i.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>i.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>i.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>i.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>i.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>i.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>i.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>i.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>i.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>i.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>i.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>i.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>i.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>i.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>i.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>i.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>i.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:t=>i.moveCellSelectionInlineStart(t)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:t=>i.moveCellSelectionInlineEnd(t)},{keys:[["Control/Meta","Backspace"]],callback:()=>i.scrollToFocusedCell()}],{runOnlyIf:()=>{let{navigableHeaders:e}=t.getSettings();return(0,tJ.isDefined)(t.getSelected())&&(e||!e&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:ho})}let hM=null;const hk=new Map;function hA(t,e){let i,r,o,s,n,a,l;var h,c,d,u=this;let g=arguments.length>2&&void 0!==arguments[2]&&arguments[2],p=this,f=new t2.default(p),m=!0;g===sa&&sn.set(this,!0),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;let y=null!==(d=null==e?void 0:e.layoutDirection)&&void 0!==d?d:"inherit",w=["rtl","ltr"].includes(y)?y:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",w),this.isRtl=function(){return"rtl"===w},this.isLtr=function(){return!p.isRtl()},this.getDirectionFactor=function(){return p.isLtr()?1:-1},e.language=(aB(l=nu(h=e.language))||(l=a_,ng(h)),l);let b=new l5(p,e,[lN,lF]),C=b.getTableMeta(),S=b.getGlobalMeta(),x=e0();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),sl(this)&&(0,tJ._injectProductInfo)(e.licenseKey,t),this.guid=`ht_${(0,eX.randomString)()}`,hk.set(this.guid,this),this.columnIndexMapper=new nc,this.rowIndexMapper=new nc,this.columnIndexMapper.addLocalHook("indexesSequenceChange",t=>{p.runHooks("afterColumnSequenceChange",t)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",t=>{p.runHooks("afterRowSequenceChange",t)}),r=new sj(p),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);let E=new lL(C,{rowIndexMapper:p.rowIndexMapper,columnIndexMapper:p.columnIndexMapper,countCols:()=>p.countCols(),countRows:()=>p.countRows(),propToCol:t=>i.propToCol(t),isEditorOpened:()=>!!p.getActiveEditor()&&p.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return u.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return u.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>p.getShortcutManager(),createCellCoords:(t,e)=>p._createCellCoords(t,e),createCellRange:(t,e,i)=>p._createCellRange(t,e,i),visualToRenderableCoords:t=>{let{row:e,col:i}=t;return p._createCellCoords(e>=0?p.rowIndexMapper.getRenderableFromVisualIndex(e):e,i>=0?p.columnIndexMapper.getRenderableFromVisualIndex(i):i)},renderableToVisualCoords:t=>{let{row:e,col:i}=t;return p._createCellCoords(e>=0?p.rowIndexMapper.getVisualFromRenderableIndex(e):e,i>=0?p.columnIndexMapper.getVisualFromRenderableIndex(i):i)},findFirstNonHiddenRenderableRow:(t,e)=>{let i=e>t?1:-1,r=Math.min(t,e),o=Math.max(t,e),s=p.rowIndexMapper.getNearestNotHiddenIndex(t,i);return null===s||1===i&&s>o||-1===i&&s<r?null:s>=0?p.rowIndexMapper.getRenderableFromVisualIndex(s):s},findFirstNonHiddenRenderableColumn:(t,e)=>{let i=e>t?1:-1,r=Math.min(t,e),o=Math.max(t,e),s=p.columnIndexMapper.getNearestNotHiddenIndex(t,i);return null===s||1===i&&s>o||-1===i&&s<r?null:s>=0?p.columnIndexMapper.getRenderableFromVisualIndex(s):s},isDisabledCellSelection:(t,e)=>t<0||e<0?p.getSettings().disableVisualSelection:p.getCellMeta(t,e).disableVisualSelection});this.selection=E;let R=t=>{let{hiddenIndexesChanged:e}=t;e&&this.selection.refresh()};function T(t,e){let i="className"===t?p.rootElement:p.table;if(m)(0,tZ.addClass)(i,e);else{let r=[],o=[];S[t]&&(r=Array.isArray(S[t])?S[t]:(0,eu.stringToArray)(S[t])),e&&(o=Array.isArray(e)?e:(0,eu.stringToArray)(e));let s=(0,eu.getDifferenceOfArrays)(r,o),n=(0,eu.getDifferenceOfArrays)(o,r);s.length&&(0,tZ.removeClass)(i,s),n.length&&(0,tZ.addClass)(i,n)}S[t]=e}function M(){let t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function k(t,e,r){if(!t.length)return;let o=p.getActiveEditor(),s=new M,n=!0;s.onQueueEmpty=t=>{o&&n&&o.cancelChanges(),r(t)};for(let r=t.length-1;r>=0;r--){let[o,a,,l]=t[r],h=i.propToCol(a),c=p.getCellMeta(o,h);"numeric"===c.type&&"string"==typeof l&&(0,eq.isNumericLike)(l)&&(t[r][3]=function(t){let e=t.replace(",",".");return!1===isNaN(parseFloat(e))?parseFloat(e):t}(l)),p.getCellValidator(c)&&(s.addValidatorToQueue(),p.validateCell(t[r][3],c,function(e,i){return function(r){if("boolean"!=typeof r)throw Error("Validation error: result is not boolean");if(!1===r&&!1===i.allowInvalid){n=!1,t.splice(e,1),i.valid=!0;let r=p.getCell(i.visualRow,i.visualCol);null!==r&&(0,tZ.removeClass)(r,C.invalidCellClassName)}s.removeValidatorFormQueue()}}(r,c),e))}s.checkIfQueueIsEmpty()}function A(t,e){let r=t.length-1;if(r<0)return;for(;r>=0;r--){let o=!1;if(null===t[r]){t.splice(r,1);continue}if(null!==t[r][2]&&void 0!==t[r][2]||null!==t[r][3]&&void 0!==t[r][3]){if(C.allowInsertRow)for(;t[r][0]>p.countRows()-1;){let{delta:t}=i.createRow(void 0,void 0,{source:e});if(0===t){o=!0;break}}if("array"===p.dataType&&(!C.columns||0===C.columns.length)&&C.allowInsertColumn)for(;i.propToCol(t[r][1])>p.countCols()-1;){let{delta:t}=i.createCol(void 0,void 0,{source:e});if(0===t){o=!0;break}}o||i.set(t[r][0],t[r][1],t[r][3])}}p.forceFullRender=!0,o.adjustRowsAndCols(),p.runHooks("beforeChangeRender",t,e),s.lockEditor(),p._refreshBorders(null),s.unlockEditor(),p.view.adjustElementsSize(),p.runHooks("afterChange",t,e||"edit");let n=p.getActiveEditor();n&&(0,tJ.isDefined)(n.refreshValue)&&n.refreshValue()}function O(t,e,i){return Array.isArray(t)?t:[[t,e,i]]}function P(t,e){let i=p.getActiveEditor(),r=p.runHooks("beforeChange",t,e||"edit"),o=t.filter(t=>null!==t);return!1===r||0===o.length?(i&&i.cancelChanges(),[]):o}this.columnIndexMapper.addLocalHook("cacheUpdated",R),this.rowIndexMapper.addLocalHook("cacheUpdated",R),this.selection.addLocalHook("afterSetRangeEnd",(t,e)=>{let i=(0,t3.createObjectPropListener)(!1),r=this.selection.getSelectedRange(),{from:o,to:s}=r.current(),n=r.size()-1;this.runHooks("afterSelection",o.row,o.col,s.row,s.col,i,n),this.runHooks("afterSelectionByProp",o.row,p.colToProp(o.col),s.row,p.colToProp(s.col),i,n),e&&(!i.isTouched()||i.isTouched()&&!i.value)&&a.scrollTo(t);let l=E.isSelectedByRowHeader(),h=E.isSelectedByColumnHeader();l&&h?(0,tZ.addClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]):l?((0,tZ.removeClass)(this.rootElement,"ht__selection--columns"),(0,tZ.addClass)(this.rootElement,"ht__selection--rows")):h?((0,tZ.removeClass)(this.rootElement,"ht__selection--rows"),(0,tZ.addClass)(this.rootElement,"ht__selection--columns")):(0,tZ.removeClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("beforeSetFocus",t=>{this.runHooks("beforeSelectionFocusSet",t.row,t.col)}),this.selection.addLocalHook("afterSetFocus",t=>{let e=(0,t3.createObjectPropListener)(!1);this.runHooks("afterSelectionFocusSet",t.row,t.col,e),(!e.isTouched()||e.isTouched()&&!e.value)&&a.scrollTo(t),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",t=>{let e=t.length-1,{from:i,to:r}=t[e];this.runHooks("afterSelectionEnd",i.row,i.col,r.row,r.col,e),this.runHooks("afterSelectionEndByProp",i.row,p.colToProp(i.col),r.row,p.colToProp(r.col),e)}),this.selection.addLocalHook("afterIsMultipleSelection",t=>{let e=this.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)}),this.selection.addLocalHook("afterDeselect",()=>{s.destroyEditor(),this._refreshBorders(),(0,tZ.removeClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return u.runHooks("beforeSetRangeStart",...e)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return u.runHooks("beforeSetRangeStartOnly",...e)}).addLocalHook("beforeSetRangeEnd",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return u.runHooks("beforeSetRangeEnd",...e)}).addLocalHook("beforeSelectColumns",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return u.runHooks("beforeSelectColumns",...e)}).addLocalHook("afterSelectColumns",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return u.runHooks("afterSelectColumns",...e)}).addLocalHook("beforeSelectRows",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return u.runHooks("beforeSelectRows",...e)}).addLocalHook("afterSelectRows",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return u.runHooks("afterSelectRows",...e)}).addLocalHook("beforeModifyTransformStart",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return u.runHooks("modifyTransformStart",...e)}).addLocalHook("afterModifyTransformStart",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return u.runHooks("afterModifyTransformStart",...e)}).addLocalHook("beforeModifyTransformFocus",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return u.runHooks("modifyTransformFocus",...e)}).addLocalHook("afterModifyTransformFocus",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return u.runHooks("afterModifyTransformFocus",...e)}).addLocalHook("beforeModifyTransformEnd",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return u.runHooks("modifyTransformEnd",...e)}).addLocalHook("afterModifyTransformEnd",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return u.runHooks("afterModifyTransformEnd",...e)}).addLocalHook("beforeRowWrap",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return u.runHooks("beforeRowWrap",...e)}).addLocalHook("beforeColumnWrap",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return u.runHooks("beforeColumnWrap",...e)}).addLocalHook("insertRowRequire",t=>this.alter("insert_row_above",t,1,"auto")).addLocalHook("insertColRequire",t=>this.alter("insert_col_start",t,1,"auto")),o={alter(t,e){var r,s,n,a;let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,h=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0,d=t=>{if(0===t.length)return[];let e=[...t];return e.sort((t,e)=>{let[i]=t,[r]=e;return i===r?0:i>r?1:-1}),(0,eu.arrayReduce)(e,(t,e)=>{let[i,r]=e,o=t[t.length-1],[s,n]=o,a=s+n;if(i<=a){let t=Math.max(r-(a-i),0);o[1]+=t}else t.push([i,r]);return t},[e[0]])};switch(t){case"insert_row_below":case"insert_row_above":let u=p.countSourceRows();if(C.maxRows===u)return;let g="insert_row_below"===t?"below":"above";e=null!==(r=e)&&void 0!==r?r:"below"===g?u:0;let{delta:f,startPhysicalIndex:m}=i.createRow(e,l,{source:h,mode:g});if(f){let t=E.selectedRange.current(),e=null==t?void 0:t.from,i=null==e?void 0:e.row,r=p.toVisualRow(m);if(E.isSelectedByCorner())E.selectAll(!0,!0,{disableHeadersHighlight:!0});else if((0,tJ.isDefined)(i)&&i>=r){let{row:r,col:o}=t.to,s=e.col;E.isSelectedByRowHeader()&&(s=-1),E.getSelectedRange().pop(),E.setRangeStartOnly(p._createCellCoords(i+f,s),!0),E.setRangeEnd(p._createCellCoords(r+f,o))}else p._refreshBorders()}break;case"insert_col_start":case"insert_col_end":let y="insert_col_end"===t?"end":"start";e=null!==(s=e)&&void 0!==s?s:"end"===y?p.countSourceCols():0;let{delta:w,startPhysicalIndex:b}=i.createCol(e,l,{source:h,mode:y});if(w){if(Array.isArray(C.colHeaders)){let t=[p.toVisualColumn(b),0];t.length+=w,Array.prototype.splice.apply(C.colHeaders,t)}let t=E.selectedRange.current(),e=null==t?void 0:t.from,i=null==e?void 0:e.col,r=p.toVisualColumn(b);if(E.isSelectedByCorner())E.selectAll(!0,!0,{disableHeadersHighlight:!0});else if((0,tJ.isDefined)(i)&&i>=r){let{row:r,col:o}=t.to,s=e.row;E.isSelectedByColumnHeader()&&(s=-1),E.getSelectedRange().pop(),E.setRangeStartOnly(p._createCellCoords(s,i+w),!0),E.setRangeEnd(p._createCellCoords(r,o+w))}else p._refreshBorders()}break;case"remove_row":let S;n=Array.isArray(e)?d(e):[[e,l]],S=0,(0,eu.arrayEach)(n,t=>{let[e,r]=t,o=(0,tJ.isEmpty)(e)?p.countRows()-1:Math.max(e-S,0);if(Number.isInteger(e)&&(e=Math.max(e-S,0)),!i.removeRow(e,r,h))return;let s=p.countRows(),n=C.fixedRowsTop;n>=o+1&&(C.fixedRowsTop-=Math.min(r,n-o));let a=C.fixedRowsBottom;a&&o>=s-a&&(C.fixedRowsBottom-=Math.min(r,a)),S+=r}),o.adjustRowsAndCols(),p._refreshBorders();break;case"remove_col":let x;a=Array.isArray(e)?d(e):[[e,l]],x=0,(0,eu.arrayEach)(a,t=>{let[e,r]=t,o=(0,tJ.isEmpty)(e)?p.countCols()-1:Math.max(e-x,0),s=p.toPhysicalColumn(o);if(Number.isInteger(e)&&(e=Math.max(e-x,0)),!i.removeCol(e,r,h))return;let n=C.fixedColumnsStart;n>=o+1&&(C.fixedColumnsStart-=Math.min(r,n-o)),Array.isArray(C.colHeaders)&&(void 0===s&&(s=-1),C.colHeaders.splice(s,r)),x+=r}),o.adjustRowsAndCols(),p._refreshBorders();break;default:throw Error(`There is no such action "${t}"`)}c||o.adjustRowsAndCols()},adjustRowsAndCols(){let t=C.minRows,e=C.minSpareRows,r=C.minCols,o=C.minSpareCols;if(0===p.countRows()&&0===p.countCols()&&E.deselect(),t){let e=p.countRows();e<t&&i.createRow(e,t-e,{source:"auto"})}if(e){let t=p.countEmptyRows(!0);if(t<e){let r=Math.min(e-t,C.maxRows-p.countSourceRows());i.createRow(p.countRows(),r,{source:"auto"})}}{let t;(r||o)&&(t=p.countEmptyCols(!0));let e=p.countCols();if(r&&!C.columns&&e<r){let o=r-e;t+=o,i.createCol(e,o,{source:"auto"})}if(o&&!C.columns&&"array"===p.dataType&&t<o){e=p.countCols();let r=Math.min(o-t,C.maxCols-e);i.createCol(e,r,{source:"auto"})}}if(E.isSelected()){let t=p.countRows(),e=p.countCols();(0,eu.arrayEach)(E.selectedRange,i=>{let r=!1,o=i.from.row,s=i.from.col,n=i.to.row,a=i.to.col;o>t-1?(r=!0,n>(o=t-1)&&(n=o)):n>t-1&&(r=!0,o>(n=t-1)&&(o=n)),s>e-1?(r=!0,a>(s=e-1)&&(a=s)):a>e-1&&(r=!0,s>(a=e-1)&&(s=a)),r&&(s<0?p.selectRows(o,n,s):o<0?p.selectColumns(s,a,o):p.selectCell(o,s,n,a))})}p.view&&p.view.adjustElementsSize()},populateFromArray(t,e,i,r,o){let s,n,a,l,h;let c=[],d={},u=[],g=t.row,f=t.col;if(0===(n=e.length))return!1;let m=0,y=0;switch((0,t3.isObject)(i)&&(m=i.col-f+1,y=i.row-g+1),o){case"shift_down":let w=(0,eu.pivot)(e),b=w.length,S=Math.max(b,m),x=p.getData().slice(g),E=(0,eu.pivot)(x).slice(f,f+S);for(a=0;a<S;a+=1)if(a<b){for(s=0,n=w[a].length;s<y-n;s+=1)w[a].push(w[a][s%n]);a<E.length?u.push(w[a].concat(E[a])):u.push(w[a].concat(Array(x.length).fill(null)))}else u.push(w[a%b].concat(E[a]));p.populateFromArray(g,f,(0,eu.pivot)(u));break;case"shift_right":let R=e.length,T=Math.max(R,y),M=p.getData().slice(g).map(t=>t.slice(f));for(s=0;s<T;s+=1)if(s<R){for(a=0,l=e[s].length;a<m-l;a+=1)e[s].push(e[s][a%l]);if(s<M.length)for(let t=0;t<M[s].length;t+=1)e[s].push(M[s][t]);else e[s].push(...Array(M[0].length).fill(null))}else e.push(e[s%n].slice(0,T).concat(M[s]));p.populateFromArray(g,f,e);break;default:d.row=t.row,d.col=t.col;let k=0,A=0,O=!0,P=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e[t%e.length];return null!==i?r[i%r.length]:r},I=e.length,H=i?i.row-t.row+1:0;for(s=0,n=i?H:Math.max(I,H);s<n&&!(i&&d.row>i.row&&H>I||!C.allowInsertRow&&d.row>p.countRows()-1)&&!(d.row>=C.maxRows);s++){let e=s-k,o=P(e).length,u=i?i.col-t.col+1:0;if(l=i?u:Math.max(o,u),d.col=t.col,h=p.getCellMeta(d.row,d.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&h.skipRowOnPaste){k+=1,d.row+=1,n+=1;continue}for(a=0,A=0;a<l&&!(i&&d.col>i.col&&u>o||!C.allowInsertColumn&&d.col>p.countCols()-1)&&!(d.col>=C.maxCols);a++){if(h=p.getCellMeta(d.row,d.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&h.skipColumnOnPaste){A+=1,d.col+=1,l+=1;continue}if(h.readOnly&&"UndoRedo.undo"!==r){d.col+=1;continue}let t=P(e,a-A),i=p.getDataAtCell(d.row,d.col);if(null!==t&&"object"==typeof t){if(Array.isArray(t)&&null===i&&(i=[]),null===i||"object"!=typeof i)O=!1;else{let e=(0,t3.duckSchema)(Array.isArray(i)?i:i[0]||i),r=(0,t3.duckSchema)(Array.isArray(t)?t:t[0]||t);(0,t3.isObjectEqual)(e,r)||Array.isArray(e)&&Array.isArray(r)?t=(0,t3.deepClone)(t):O=!1}}else null!==i&&"object"==typeof i&&(O=!1);O&&c.push([d.row,d.col,t]),O=!0,d.col+=1}d.row+=1}p.setDataAtCell(c,null,null,r||"populateFromArray")}}},this.init=function(){r.setData(C.data),p.runHooks("beforeInit"),((0,t0.isMobileBrowser)()||(0,t0.isIpadOS)())&&(0,tZ.addClass)(p.rootElement,"mobile"),this.updateSettings(C,!0),this.view=new sR(this),s=(0,t1.default).getInstance(p,C,E),a=function(t){let{selection:e}=t,i=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){i=!0},scrollTo(o){var s;let n;if(i||r){i=!1;return}e.isFocusSelectionChanged()?n=e=>{t.scrollViewportTo(e.toObject())}:e.isSelectedByCorner()?n=()=>{}:e.isSelectedByRowHeader()?n=e=>{let{row:i}=e;t.scrollViewportTo({row:i})}:e.isSelectedByColumnHeader()?n=e=>{let{col:i}=e;t.scrollViewportTo({col:i})}:1===e.getSelectedRange().size()&&e.isMultiple()?n=e=>{t.scrollViewportTo(e.toObject())}:1!==e.getSelectedRange().size()||e.isMultiple()?e.getSelectedRange().size()>1&&(n=e=>{t.scrollViewportTo(e.toObject())}):n=e=>{let i=t.selection.getSelectionSource(),{row:r,col:o}=e;if(r<0&&o>=0)t.scrollViewportTo({col:o});else if(o<0&&r>=0)t.scrollViewportTo({row:r});else{if("mouse"===i&&(o===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:o})}},null===(s=n)||void 0===s||s(o)}}}(p),n=new ea(p),sl(this)&&function(t){let e;let i=e=>{if(!e)return null;let i=ha(t),r=hl(t);return e.col<i.col&&(e.col=i.col),e.col>r.col&&(e.col=r.col),e.row<i.row&&(e.row=i.row),e.row>r.row&&(e.row=r.row),e},{activate:r,deactivate:o}=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.rootElement,r=hn(t),o=hn(t);return r.addEventListener("focus",()=>null==e?void 0:e.onFocusFromTop()),o.addEventListener("focus",()=>null==e?void 0:e.onFocusFromBottom()),i.firstChild.before(r),i.lastChild.after(o),{activate(){t._registerTimeout(()=>{r.tabIndex=0,o.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,o.tabIndex=-1},10)}}}(t,{onFocusFromTop(){var r;let o=null!==(r=i(e))&&void 0!==r?r:ha(t);o&&(t.runHooks("modifyFocusOnTabNavigation","from_above",o),t.selectCell(o.row,o.col)),t.listen()},onFocusFromBottom(){var r;let o=null!==(r=i(e))&&void 0!==r?r:hl(t);o&&(t.runHooks("modifyFocusOnTabNavigation","from_below",o),t.selectCell(o.row,o.col)),t.listen()}}),s={wrapped:!1,flipped:!1},n=!0,a=!1,l=!1;t.addHook("afterListen",()=>o()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(i,r,o,h,c)=>{if(a&&(s.wrapped&&s.flipped||l)&&(l=!1,c.value=!0),n){var d;e=null===(d=t.getSelectedRangeLast())||void 0===d?void 0:d.highlight}}),t.addHook("beforeRowWrap",(t,e,i)=>{s.wrapped=!0,s.flipped=i});let h={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:ho,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...h,callback:()=>{let{tabNavigation:e}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!e&&(n=!1),e||(l=!0)},position:"before"},{...h,callback:i=>{let{tabNavigation:r,autoWrapRow:o}=t.getSettings();if(a=!1,n=!0,!r||!t.selection.isSelected()||o&&s.wrapped&&s.flipped||!o&&s.wrapped)return o&&s.wrapped&&s.flipped&&(e=i.shiftKey?ha(t):hl(t)),s.wrapped=!1,s.flipped=!1,t.deselectCell(),t.unlisten(),!1;i.preventDefault()},position:"after"}])}(p),p.runHooks("init"),this.forceFullRender=!0,this.view.render(),m&&null===p.rootElement.offsetParent&&(0,tZ.observeVisibilityChangeOnce)(p.rootElement,()=>{p.view._wt.wtOverlays.updateLastSpreaderSize(),p.render(),p.view.adjustElementsSize()}),"object"==typeof m&&(p.runHooks("afterChange",m[0],m[1]),m=!1),p.runHooks("afterInit")},this._createCellCoords=function(t,e){return p.view._wt.createCellCoords(t,e)},this._createCellRange=function(t,e,i){return p.view._wt.createCellRange(t,e,i)},this.validateCell=function(t,e,i,r){let o=p.getCellValidator(e);function s(t){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!r||!0===e.hidden){i(t);return}let o=e.visualCol,s=e.visualRow,n=p.getCell(s,o,!0);if(n&&"TH"!==n.nodeName){let t=p.rowIndexMapper.getRenderableFromVisualIndex(s),e=p.columnIndexMapper.getRenderableFromVisualIndex(o);p.view._wt.getSetting("cellRenderer",t,e,n)}i(t)}if((0,tJ.isRegExp)(o)){var n;n=o,o=function(t,e){e(n.test(t))}}(0,tQ.isFunction)(o)?(t=p.runHooks("beforeValidate",t,e.visualRow,e.prop,r),p._registerImmediate(()=>{o.call(e,t,i=>{p&&(i=p.runHooks("afterValidate",i,t,e.visualRow,e.prop,r),e.valid=i,s(i),p.runHooks("postAfterValidate",i,t,e.visualRow,e.prop,r))})})):p._registerImmediate(()=>{e.valid=!0,s(e.valid,!1)})},this.setDataAtCell=function(t,e,o,s){let n,a,l;let h=O(t,e,o),c=[],d=s;for(n=0,a=h.length;n<a;n++){if("object"!=typeof h[n])throw Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof h[n][1])throw Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");l=h[n][1]>=this.countCols()?h[n][1]:i.colToProp(h[n][1]),c.push([h[n][0],l,r.getAtCell(this.toPhysicalRow(h[n][0]),h[n][1]),h[n][2]])}d||"object"!=typeof t||(d=e);let u=P(c,s);p.runHooks("afterSetDataAtCell",u,d),k(u,d,()=>{A(u,d)})},this.setDataAtRowProp=function(t,e,i,o){let s,n;let a=O(t,e,i),l=[],h=o;for(s=0,n=a.length;s<n;s++)l.push([a[s][0],a[s][1],r.getAtCell(this.toPhysicalRow(a[s][0]),a[s][1]),a[s][2]]);h||"object"!=typeof t||(h=e);let c=P(l,o);p.runHooks("afterSetDataAtRowProp",c,h),k(c,h,()=>{A(c,h)})},this.listen=function(){p&&!p.isListening()&&(hk.forEach(t=>{p!==t&&t.unlisten()}),hM=p.guid,p.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(hM=null,p.runHooks("afterUnlisten"))},this.isListening=function(){return hM===p.guid},this.destroyEditor=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];p._refreshBorders(t,e)},this.populateFromArray=function(t,e,i,r,s,n,a){if(!("object"==typeof i&&"object"==typeof i[0]))throw Error("populateFromArray parameter `input` must be an array of arrays");let l="number"==typeof r?p._createCellCoords(r,s):null;return o.populateFromArray(p._createCellCoords(t,e),i,l,n,a)},this.spliceCol=function(t,e,r){for(var o=arguments.length,s=Array(o>3?o-3:0),n=3;n<o;n++)s[n-3]=arguments[n];return i.spliceCol(t,e,r,...s)},this.spliceRow=function(t,e,r){for(var o=arguments.length,s=Array(o>3?o-3:0),n=3;n<o;n++)s[n-3]=arguments[n];return i.spliceRow(t,e,r,...s)},this.getSelected=function(){if(E.isSelected())return(0,eu.arrayMap)(E.getSelectedRange(),t=>{let{from:e,to:i}=t;return[e.row,e.col,i.row,i.col]})},this.getSelectedLast=function(){let t;let e=this.getSelected();return e&&e.length>0&&(t=e[e.length-1]),t},this.getSelectedRange=function(){if(E.isSelected())return Array.from(E.getSelectedRange())},this.getSelectedRangeLast=function(){let t;let e=this.getSelectedRange();return e&&e.length>0&&(t=e[e.length-1]),t},this.emptySelectedCells=function(t){if(!E.isSelected()||0===this.countRows()||0===this.countCols())return;let e=[];(0,eu.arrayEach)(E.getSelectedRange(),t=>{if(t.isSingleHeader())return;let i=t.getTopStartCorner(),r=t.getBottomEndCorner();(0,eq.rangeEach)(i.row,r.row,t=>{(0,eq.rangeEach)(i.col,r.col,i=>{this.getCellMeta(t,i).readOnly||e.push([t,i,null])})})}),e.length>0&&this.setDataAtCell(e,t)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){let t=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(t,0),this.isRenderSuspended()||t!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(s.lockEditor(),this._refreshBorders(null),s.unlockEditor()))},this.batchRender=function(t){this.suspendRender();let e=t();return this.resumeRender(),e},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(e,0),(!this.isExecutionSuspended()&&e===this.executionSuspendedCounter||t)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();let i=t();return this.resumeExecution(e),i},this.batch=function(t){this.suspendRender(),this.suspendExecution();let e=t();return this.resumeExecution(),this.resumeRender(),e},this.refreshDimensions=function(){if(!p.view)return;let{width:t,height:e}=p.view.getLastSize(),{width:i,height:r}=p.rootElement.getBoundingClientRect(),o=i!==t||r!==e;!1!==p.runHooks("beforeRefreshDimensions",{width:t,height:e},{width:i,height:r},o)&&((o||p.view._wt.wtOverlays.scrollableElement===p.rootWindow)&&(p.view.setLastSize(i,r),p.render()),p.runHooks("afterRefreshDimensions",{width:t,height:e},{width:i,height:r},o))},this.updateData=function(t,e){hr(t,t=>{i=t},t=>{i=t,p.columnIndexMapper.fitToLength(this.getInitialColumnCount()),p.rowIndexMapper.fitToLength(this.countSourceRows()),o.adjustRowsAndCols()},{hotInstance:p,dataMap:i,dataSource:r,internalSource:"updateData",source:e,metaManager:b,firstRun:m})},this.loadData=function(t,e){hr(t,t=>{i=t},()=>{b.clearCellsCache(),p.initIndexMappers(),o.adjustRowsAndCols(),m&&(m=[null,"loadData"])},{hotInstance:p,dataMap:i,dataSource:r,internalSource:"loadData",source:e,metaManager:b,firstRun:m})},this.getInitialColumnCount=function(){let t=C.columns,e=0;if(Array.isArray(t))e=t.length;else if((0,tQ.isFunction)(t)){if("array"===p.dataType){let i=this.countSourceCols();for(let r=0;r<i;r+=1)t(r)&&(e+=1)}else("object"===p.dataType||"function"===p.dataType)&&(e=i.colToPropCache.length)}else if((0,tJ.isDefined)(C.dataSchema)){let t=i.getSchema();e=Array.isArray(t)?t.length:(0,t3.deepObjectSize)(t)}else e=this.countSourceCols();return e},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(t,e,r,o){return(0,tJ.isUndefined)(t)?i.getAll():i.getRange(p._createCellCoords(t,e),p._createCellCoords(r,o),i.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,r,o){return i.getCopyableText(p._createCellCoords(t,e),p._createCellCoords(r,o))},this.getCopyableData=function(t,e){return i.getCopyable(t,i.colToProp(e))},this.getSchema=function(){return i.getSchema()},this.updateSettings=function(t){let e,r,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=(m?p.loadData:p.updateData).bind(this),l=!1;if((0,tJ.isDefined)(t.rows))throw Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if((0,tJ.isDefined)(t.cols))throw Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if((0,tJ.isDefined)(t.ganttChart))throw Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(e in t)"data"===e||("language"===e?function(t){let e=nu(t);aB(e)?(p.runHooks("beforeLanguageChange",e),S.language=e,p.runHooks("afterLanguageChange",e)):ng(t)}(t.language):"className"===e?T("className",t.className):"tableClassName"===e&&p.table?(T("tableClassName",t.tableClassName),p.view._wt.wtOverlays.syncOverlayTableClassNames()):(0,nd.default).getSingleton().isRegistered(e)||(0,nd.default).getSingleton().isDeprecated(e)?((0,tQ.isFunction)(t[e])||Array.isArray(t[e]))&&(t[e].initialHook=!0,p.addHook(e,t[e])):!n&&(0,t3.hasOwnProperty)(t,e)&&(S[e]=t[e]));void 0===t.data&&void 0===C.data?a(null,"updateSettings"):void 0!==t.data?a(t.data,"updateSettings"):void 0!==t.columns&&(i.createMap(),p.initIndexMappers());let h=p.countCols(),c=C.columns;if(c&&(0,tQ.isFunction)(c)&&(l=!0),(void 0!==t.cell||void 0!==t.cells||void 0!==t.columns)&&b.clearCache(),h>0)for(e=0,r=0;e<h;e++){if(c){let t=l?c(e):c[r];t&&b.updateColumnMeta(r,t)}r+=1}(0,tJ.isDefined)(t.cell)&&(0,t3.objectEach)(t.cell,t=>{p.setCellMetaObject(t.row,t.col,t)}),p.runHooks("afterCellMetaReset");let d=p.rootElement.style.height;""!==d&&(d=parseInt(p.rootElement.style.height,10));let u=t.height;if((0,tQ.isFunction)(u)&&(u=u()),n&&p.rootElement.getAttribute("style")&&p.rootElement.setAttribute("data-initialstyle",p.rootElement.getAttribute("style")),null===u){let t=p.rootElement.getAttribute("data-initialstyle");t&&(t.indexOf("height")>-1||t.indexOf("overflow")>-1)?p.rootElement.setAttribute("style",t):(p.rootElement.style.height="",p.rootElement.style.overflow="")}else void 0!==u&&(p.rootElement.style.height=isNaN(u)?`${u}`:`${u}px`,p.rootElement.style.overflow="hidden");if(void 0!==t.width){let e=t.width;(0,tQ.isFunction)(e)&&(e=e()),p.rootElement.style.width=isNaN(e)?`${e}`:`${e}px`}n||(p.view&&(p.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),p.view._wt.exportSettingsAsClassNames()),p.runHooks("afterUpdateSettings",t)),o.adjustRowsAndCols(),p.view&&!m&&(p.forceFullRender=!0,s.lockEditor(),p._refreshBorders(null),p.view._wt.wtOverlays.adjustElementsSize(),s.unlockEditor()),!n&&p.view&&(""===d||""===u||void 0===u)&&d!==u&&p.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){let t=p.getSelectedLast();if(C.getValue){if((0,tQ.isFunction)(C.getValue))return C.getValue.call(p);if(t)return p.getData()[t[0][0]][C.getValue]}else if(t)return p.getDataAtCell(t[0],t[1])},this.getSettings=function(){return C},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,i,r,s){o.alter(t,e,i,r,s)},this.getCell=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e,o=t;if(e>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(e)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(e)}if(t>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(t)))return null;o=this.rowIndexMapper.getRenderableFromVisualIndex(t)}return null===o||null===r?null:p.view.getCellAtCoords(p._createCellCoords(o,r),i)},this.getCoords=function(t){let e=this.view._wt.wtTable.getCoords(t);if(null===e)return null;let{row:i,col:r}=e,o=i,s=r;return i>=0&&(o=this.rowIndexMapper.getVisualFromRenderableIndex(i)),r>=0&&(s=this.columnIndexMapper.getVisualFromRenderableIndex(r)),p._createCellCoords(o,s)},this.colToProp=function(t){return i.colToProp(t)},this.propToCol=function(t){return i.propToCol(t)},this.toVisualRow=t=>this.rowIndexMapper.getVisualFromPhysicalIndex(t),this.toVisualColumn=t=>this.columnIndexMapper.getVisualFromPhysicalIndex(t),this.toPhysicalRow=t=>this.rowIndexMapper.getPhysicalFromVisualIndex(t),this.toPhysicalColumn=t=>this.columnIndexMapper.getPhysicalFromVisualIndex(t),this.getDataAtCell=function(t,e){return i.get(t,i.colToProp(e))},this.getDataAtRowProp=function(t,e){return i.get(t,e)},this.getDataAtCol=function(t){let e=[],r=i.getRange(p._createCellCoords(0,t),p._createCellCoords(C.data.length-1,t),i.DESTINATION_RENDERER);for(let t=0;t<r.length;t+=1)for(let i=0;i<r[t].length;i+=1)e.push(r[t][i]);return e},this.getDataAtProp=function(t){let e=[],r=i.getRange(p._createCellCoords(0,i.propToCol(t)),p._createCellCoords(C.data.length-1,i.propToCol(t)),i.DESTINATION_RENDERER);for(let t=0;t<r.length;t+=1)for(let i=0;i<r[t].length;i+=1)e.push(r[t][i]);return e},this.getSourceData=function(t,e,i,o){return void 0===t?r.getData():r.getByRange(p._createCellCoords(t,e),p._createCellCoords(i,o))},this.getSourceDataArray=function(t,e,i,o){return void 0===t?r.getData(!0):r.getByRange(p._createCellCoords(t,e),p._createCellCoords(i,o),!0)},this.getSourceDataAtCol=function(t){return r.getAtColumn(t)},this.setSourceDataAtCell=function(t,e,i,o){let s=O(t,e,i),n=this.hasHook("afterSetSourceDataAtCell"),a=[];n&&(0,eu.arrayEach)(s,t=>{let[e,i,o]=t;a.push([e,i,r.getAtCell(e,i),o])}),(0,eu.arrayEach)(s,t=>{let[e,i,o]=t;r.setAtCell(e,i,o)}),n&&this.runHooks("afterSetSourceDataAtCell",a,o),this.render();let l=p.getActiveEditor();l&&(0,tJ.isDefined)(l.refreshValue)&&l.refreshValue()},this.getSourceDataAtRow=function(t){return r.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return r.getAtCell(t,e)},this.getDataAtRow=function(t){return i.getRange(p._createCellCoords(t,0),p._createCellCoords(t,this.countCols()-1),i.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(t,e,i,r){let o=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,i,r],[s,n]=o,[,,a,l]=o,h=null,c=null;void 0===a&&(a=s),void 0===l&&(l=n);let d="mixed";return(0,eq.rangeEach)(Math.max(Math.min(s,a),0),Math.max(s,a),t=>{let e=!0;return(0,eq.rangeEach)(Math.max(Math.min(n,l),0),Math.max(n,l),i=>(c=this.getCellMeta(t,i).type,h?e=h===c:h=c,e)),d=e?c:"mixed",e}),d},this.removeCellMeta=function(t,e,i){let[r,o]=[this.toPhysicalRow(t),this.toPhysicalColumn(e)],s=b.getCellMetaKeyValue(r,o,i);!1!==p.runHooks("beforeRemoveCellMeta",t,e,i,s)&&(b.removeCellMeta(r,o,i),p.runHooks("afterRemoveCellMeta",t,e,i,s))},this.spliceCellsMeta=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var i=arguments.length,r=Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];if(r.length>0&&!Array.isArray(r[0]))throw Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");e>0&&b.removeRow(this.toPhysicalRow(t),e),r.length>0&&(0,eu.arrayEach)(r.reverse(),e=>{b.createRow(this.toPhysicalRow(t)),(0,eu.arrayEach)(e,(e,i)=>this.setCellMetaObject(t,i,e))}),p.render()},this.setCellMetaObject=function(t,e,i){"object"==typeof i&&(0,t3.objectEach)(i,(i,r)=>{this.setCellMeta(t,e,r,i)})},this.setCellMeta=function(t,e,i,r){if(!1===p.runHooks("beforeSetCellMeta",t,e,i,r))return;let o=t,s=e;t<this.countRows()&&(o=this.toPhysicalRow(t)),e<this.countCols()&&(s=this.toPhysicalColumn(e)),b.setCellMeta(o,s,i,r),p.runHooks("afterSetCellMeta",t,e,i,r)},this.getCellsMeta=function(){return b.getCellsMeta()},this.getCellMeta=function(t,e){let i=this.toPhysicalRow(t),r=this.toPhysicalColumn(e);return null===i&&(i=t),null===r&&(r=e),b.getCellMeta(i,r,{visualRow:t,visualColumn:e})},this.getCellMetaAtRow=function(t){return b.getCellsMetaAtRow(t)},this.isColumnModificationAllowed=function(){return!("object"===p.dataType||C.columns)},this.getCellRenderer=function(t,e){let i="number"==typeof t?p.getCellMeta(t,e).renderer:t.renderer;return"string"==typeof i?is(i):(0,tJ.isUndefined)(i)?is("text"):i},this.getCellEditor=function(t,e){let i="number"==typeof t?p.getCellMeta(t,e).editor:t.editor;return"string"==typeof i?(0,il.getEditor)(i):(0,tJ.isUndefined)(i)?(0,il.getEditor)("text"):i},this.getCellValidator=function(t,e){let i="number"==typeof t?p.getCellMeta(t,e).validator:t.validator;return"string"==typeof i?ip(i):i},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,i){let r=new M;t&&(r.onQueueEmpty=t);let o=p.countRows()-1;for(;o>=0;){if(void 0!==e&&-1===e.indexOf(o)){o-=1;continue}let t=p.countCols()-1;for(;t>=0;){if(void 0!==i&&-1===i.indexOf(t)){t-=1;continue}r.addValidatorToQueue(),p.validateCell(p.getDataAtCell(o,t),p.getCellMeta(o,t),t=>{if("boolean"!=typeof t)throw Error("Validation error: result is not boolean");!1===t&&(r.valid=!1),r.removeValidatorFormQueue()},"validateCells"),t-=1}o-=1}r.checkIfQueueIsEmpty()},this.getRowHeader=function(t){let e=C.rowHeaders,i=t;return void 0!==i&&(i=p.runHooks("modifyRowHeader",i)),void 0===i?(e=[],(0,eq.rangeEach)(p.countRows()-1,t=>{e.push(p.getRowHeader(t))})):Array.isArray(e)&&void 0!==e[i]?e=e[i]:(0,tQ.isFunction)(e)?e=e(i):e&&"string"!=typeof e&&"number"!=typeof e&&(e=i+1),e},this.hasRowHeaders=function(){return!!C.rowHeaders},this.hasColHeaders=function(){if(void 0!==C.colHeaders&&null!==C.colHeaders)return!!C.colHeaders;for(let t=0,e=p.countCols();t<e;t++)if(p.getColHeader(t))return!0;return!1},this.getColHeader=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,i=p.runHooks("modifyColHeader",t);if(void 0===i){let t=[],e=p.countCols();for(let i=0;i<e;i++)t.push(p.getColHeader(i));return t}let r=C.colHeaders,o=p.toPhysicalColumn(i),s=function(t){let e=[],i=p.countCols(),r=0;for(;r<i;r++)(0,tQ.isFunction)(C.columns)&&C.columns(r)&&e.push(r);return e[t]}(o);return!1===C.colHeaders?r=null:C.columns&&(0,tQ.isFunction)(C.columns)&&C.columns(s)&&C.columns(s).title?r=C.columns(s).title:C.columns&&C.columns[o]&&C.columns[o].title?r=C.columns[o].title:Array.isArray(C.colHeaders)&&void 0!==C.colHeaders[o]?r=C.colHeaders[o]:(0,tQ.isFunction)(C.colHeaders)?r=C.colHeaders(o):C.colHeaders&&"string"!=typeof C.colHeaders&&"number"!=typeof C.colHeaders&&(r=sA(i)),r=p.runHooks("modifyColumnHeaderValue",r,t,e)},this._getColWidthFromSettings=function(t){let e;if(t>=0&&(e=p.getCellMeta(0,t).width),(void 0===e||e===C.width)&&(e=C.colWidths),null!=e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getColWidth=function(t){let e=p._getColWidthFromSettings(t);return void 0===(e=p.runHooks("modifyColWidth",e,t))&&(e=oH.DEFAULT_WIDTH),e},this._getRowHeightFromSettings=function(t){let e=C.rowHeights;if(null!=e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){let e=p._getRowHeightFromSettings(t);return p.runHooks("modifyRowHeight",e,t)},this.countSourceRows=function(){return r.countRows()},this.countSourceCols=function(){return r.countFirstRowKeys()},this.countRows=function(){return i.getLength()},this.countCols=function(){return Math.min(C.maxCols,this.columnIndexMapper.getNotTrimmedIndexesLength())},this.countRenderedRows=function(){return p.view._wt.drawn?p.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return p.view._wt.drawn?p.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return p.view._wt.drawn?p.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return p.view._wt.drawn?p.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return(0,eq.rangeEachReverse)(p.countRows()-1,i=>{if(p.isEmptyRow(i))e+=1;else if(!0===t)return!1}),e},this.countEmptyCols=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return(0,eq.rangeEachReverse)(p.countCols()-1,i=>{if(p.isEmptyCol(i))e+=1;else if(!0===t)return!1}),e},this.isEmptyRow=function(t){return C.isEmptyRow.call(p,t)},this.isEmptyCol=function(t){return C.isEmptyCol.call(p,t)},this.selectCell=function(t,e,i,r){let o=!(arguments.length>4)||void 0===arguments[4]||arguments[4],s=!(arguments.length>5)||void 0===arguments[5]||arguments[5];return!((0,tJ.isUndefined)(t)||(0,tJ.isUndefined)(e))&&this.selectCells([[t,e,i,r]],o,s)},this.selectCells=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];!1===e&&a.suspend();let r=E.selectCells(t);return r&&i&&p.listen(),a.resume(),r},this.selectColumns=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2?arguments[2]:void 0;return E.selectColumns(t,e,i)},this.selectRows=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2?arguments[2]:void 0;return E.selectRows(t,e,i)},this.deselectCell=function(){E.deselect()},this.selectAll=function(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2?arguments[2]:void 0;a.skipNextScrollCycle(),E.selectAll(t,e,i)};let I=(t,e)=>t.getNearestNotHiddenIndex(e,1,!0);this.scrollViewportTo=function(t){var e,i;let r,o,s,n;"number"==typeof t&&(t={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(i=arguments[4])||void 0===i||i});let{row:a,col:l,verticalSnap:h,horizontalSnap:c,considerHiddenIndexes:d}=null!==(e=t)&&void 0!==e?e:{};void 0!==h&&(o=!(r="top"===h)),void 0!==c&&(n=!(s="start"===c));let u=a,g=l;if(void 0===d||d){let t=Number.isInteger(a)&&a>=0,e=Number.isInteger(l)&&l>=0,i=t?I(this.rowIndexMapper,a):void 0,r=e?I(this.columnIndexMapper,l):void 0;if(null===i||null===r)return!1;u=t?p.rowIndexMapper.getRenderableFromVisualIndex(i):a,g=e?p.columnIndexMapper.getRenderableFromVisualIndex(r):l}let f=Number.isInteger(u),m=Number.isInteger(g);return f&&u>=0&&m&&g>=0?p.view.scrollViewport(p._createCellCoords(u,g),r,n,o,s):f&&u>=0&&(m&&g<0||!m)?p.view.scrollViewportVertically(u,r,o):!!m&&g>=0&&(!!f&&u<0||!f)&&p.view.scrollViewportHorizontally(g,n,s)},this.scrollToFocusedCell=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",t);let{highlight:e}=this.getSelectedRangeLast();this.scrollViewportTo(e.toObject())?this.view.render():(this.removeHook("afterScroll",t),this._registerImmediate(()=>t()))},this.destroy=function(){if(p._clearTimeouts(),p._clearImmediates(),p.view&&p.view.destroy(),r&&r.destroy(),r=null,this.getShortcutManager().destroy(),b.clearCache(),hk.delete(this.guid),sl(p)){let t=this.rootDocument.querySelector(".hot-display-license-info");t&&t.parentNode.removeChild(t)}(0,tZ.empty)(p.rootElement),f.destroy(),s&&s.destroy(),p.batchExecution(()=>{p.rowIndexMapper.unregisterAll(),p.columnIndexMapper.unregisterAll(),x.getItems().forEach(t=>{let[,e]=t;e.destroy()}),x.clear(),p.runHooks("afterDestroy")},!0),(0,nd.default).getSingleton().destroy(p),(0,t3.objectEach)(p,(t,e,i)=>{(0,tQ.isFunction)(t)?i[e]=()=>{throw Error(`The "${e}" method cannot be called because this Handsontable instance has been destroyed`)}:"guid"!==e&&(i[e]=null)}),p.isDestroyed=!0,i&&i.destroy(),i=null,o=null,E=null,s=null,p=null},this.getActiveEditor=function(){return s.getActiveEditor()},this.getPlugin=function(t){let e=(0,eX.toUpperCaseFirst)(t);return"UndoRedo"===e?this.undoRedo:x.getItem(e)},this.getPluginName=function(t){return t===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:x.getId(t)},this.getInstance=function(){return p},this.addHook=function(t,e){(0,nd.default).getSingleton().add(t,e,p)},this.hasHook=function(t){return(0,nd.default).getSingleton().has(t,p)||(0,nd.default).getSingleton().has(t)},this.addHookOnce=function(t,e){(0,nd.default).getSingleton().once(t,e,p)},this.removeHook=function(t,e){(0,nd.default).getSingleton().remove(t,e,p)},this.runHooks=function(t,e,i,r,o,s,n){return(0,nd.default).getSingleton().run(p,t,e,i,r,o,s,n)},this.getTranslatedPhrase=function(t,e){return az(C.language,t,e)},this.toHTML=()=>eY(this),this.toTableElement=()=>{let t=this.rootDocument.createElement("div");return t.insertAdjacentHTML("afterbegin",eY(this)),t.firstElementChild},this.timeouts=[],this._registerTimeout=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=t;"function"==typeof i&&(i=setTimeout(i,e)),this.timeouts.push(i)},this._clearTimeouts=function(){(0,eu.arrayEach)(this.timeouts,t=>{clearTimeout(t)})},this.immediates=[],this._registerImmediate=function(t){this.immediates.push(setImmediate(t))},this._clearImmediates=function(){(0,eu.arrayEach)(this.immediates,t=>{clearImmediate(t)})},this._refreshBorders=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];s.destroyEditor(t),p.view.render(),e&&E.isSelected()&&s.prepareEditor()},this._getEditorManager=function(){return s},this.isRtl=function(){return"rtl"===p.rootWindow.getComputedStyle(p.rootElement).direction},this.isLtr=function(){return!p.isRtl()},this.getDirectionFactor=function(){return p.isLtr()?1:-1};let H=hS({handleEvent:()=>p.isListening(),beforeKeyDown:t=>this.runHooks("beforeKeyDown",t),afterKeyDown:t=>{this.isDestroyed||p.runHooks("afterDocumentKeyDown",t)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",t=>{!1===t.ctrlKey&&!1===t.metaKey&&H.releasePressedKeys()}),this.getShortcutManager=function(){return H},this.getFocusManager=function(){return n},e5().forEach(t=>{let e=e9(t);x.addItem(t,new e(this))}),c=p,[hR,hT].forEach(t=>t(c)),H.setActiveContextName("grid"),(0,nd.default).getSingleton().run(p,"construct")}var nd=tn("10euP"),hO=tn("9PLwv");tn("1hIp0");var tZ=tn("gFbQZ"),iq=tn("4Pbrh");function hP(t,e,i,r,o,s,n){let a=n.ariaTags,l=[],h=[],c=[],d=[];n.className&&(0,tZ.addClass)(e,n.className),n.readOnly?(l.push(n.readOnlyCellClassName),a&&d.push((0,iq.A11Y_READONLY)())):a&&c.push((0,iq.A11Y_READONLY)()[0]),!1===n.valid&&n.invalidCellClassName?(l.push(n.invalidCellClassName),a&&d.push((0,iq.A11Y_INVALID)())):(h.push(n.invalidCellClassName),a&&c.push((0,iq.A11Y_INVALID)()[0])),!1===n.wordWrap&&n.noWordWrapClassName&&l.push(n.noWordWrapClassName),!s&&n.placeholder&&l.push(n.placeholderCellClassName),(0,tZ.removeClass)(e,h),(0,tZ.addClass)(e,l),(0,tZ.removeAttribute)(e,c),(0,tZ.setAttribute)(e,d)}hP.RENDERER_TYPE="base";var tZ=tn("gFbQZ"),tJ=tn("gnaTS");function hI(t,e,i,r,o,s,n){hP.apply(this,[t,e,i,r,o,s,n]);let a=s;if(!a&&n.placeholder&&(a=n.placeholder),a=(0,tJ.stringify)(a),n.trimWhitespace&&(a=a.trim()),n.rendererTemplate){(0,tZ.empty)(e);let r=t.rootDocument.createElement("TEMPLATE");r.setAttribute("bind","{{}}"),r.innerHTML=n.rendererTemplate,HTMLTemplateElement.decorate(r),r.model=t.getSourceDataAtRow(i),e.appendChild(r)}else(0,tZ.fastInnerText)(e,a)}hI.RENDERER_TYPE="text";const hH={CELL_TYPE:"text",editor:hO.TextEditor,renderer:hI};var hL=tn("3BsF4");function hD(t,e){let i=new hA(t,e||{},sa);return i.init(),i}lY(hH),hD.editors={BaseEditor:hL.BaseEditor},hD.Core=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new hA(t,e,sa)},hD.DefaultSettings=lq(),hD.hooks=(0,nd.default).getSingleton(),hD.CellCoords=rD,hD.CellRange=rB,hD.packageName="handsontable",hD.buildDate="16/04/2024 10:23:22",hD.version="14.3.0",hD.languages={dictionaryKeys:nm,getLanguageDictionary:aU,getLanguagesDictionaries:function(){return aW()},registerLanguageDictionary:aV,getTranslatedPhrase:az},tn("1C6fS"),tn("1hIp0");var hO=tn("9PLwv"),tZ=tn("gFbQZ"),iy=tn("7HxIw"),t3=tn("hwT6B"),t1=tn("aud0i");const hN="handsontableEditor";class h_ extends hO.TextEditor{static get EDITOR_TYPE(){return"handsontable"}open(){super.open(),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),(0,tZ.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(t,e,i,r,o,s){super.prepare(t,e,i,r,o,s);let n=this,a={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(t,e){let i=this.getSourceData(e.row,e.col);void 0!==i&&n.setValue(i),n.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&(0,t3.extend)(a,s.handsontable),this.htOptions=a}beginEditing(t,e){let i=this.hot.getSettings().onBeginEditing;i&&!1===i()||super.beginEditing(t,e)}createElements(){super.createElements();let t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}finishEditing(t,e,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){let t=this.htEditor.getValue();void 0!==t&&this.setValue(t)}super.finishEditing(t,e,i)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){let t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();let e={group:hN,relativeToGroup:t1.SHORTCUTS_GROUP_NAVIGATION,position:"before"},i=(t,e)=>{let i=this.htEditor;if(void 0!==t&&(t<0||i.flipped&&t>i.countRows()-1?i.deselectCell():i.selectCell(t,0),i.getData().length))return e.preventDefault(),(0,iy.stopImmediatePropagation)(e),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:t=>{let e;let r=this.htEditor;return!r.getSelectedLast()&&r.flipped?e=r.countRows()-1:r.getSelectedLast()&&(e=r.flipped?Math.max(0,r.getSelectedLast()[0]-1):r.getSelectedLast()[0]-1),i(e,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:t=>{let e;let r=this.htEditor;return r.getSelectedLast()||r.flipped?r.getSelectedLast()&&(r.flipped?e=r.getSelectedLast()[0]+1:r.flipped||(e=Math.min(r.countRows()-1,r.getSelectedLast()[0]+1))):e=0,i(e,t)},preventDefault:!1}],e)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(hN)}}var eu=tn("ceXML"),tZ=tn("gFbQZ"),tJ=tn("gnaTS"),eX=tn("bO142"),iL=tn("bCtEl"),t0=tn("eL8cl"),iq=tn("4Pbrh");function hF(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function hj(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var hB=new WeakMap;class hW extends h_{constructor(){var t;super(...arguments),hF(this,"query",null),hF(this,"strippedChoices",[]),hF(this,"rawChoices",[]),t=this.hot.guid.slice(0,9),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,hB),hB.set(this,t),hF(this,"sortByRelevance",function(t,e,i){let r,o,s,n;let a=[],l=[],h=t.length,c=e.length;if(0===h){for(s=0;s<c;s++)l.push(s);return l}for(s=0;s<c;s++){if(o=(0,eX.stripTags)((0,tJ.stringify)(e[s])),i)n=o.indexOf(t);else{let e=this.cellProperties.locale;n=o.toLocaleLowerCase(e).indexOf(t.toLocaleLowerCase(e))}-1!==n&&(r=o.length-n-h,a.push({baseIndex:s,index:n,charsLeft:r,value:o}))}for(a.sort((t,e)=>{if(-1===e.index)return -1;if(-1===t.index)return 1;if(t.index<e.index)return -1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return -1;if(t.charsLeft>e.charsLeft)return 1}return 0}),s=0,c=a.length;s<c;s++)l.push(a[s].baseIndex);return l})}static get EDITOR_TYPE(){return"autocomplete"}getValue(){let t=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return(0,tJ.isDefined)(t)?t:this.TEXTAREA.value}createElements(){super.createElements(),(0,tZ.addClass)(this.htContainer,"autocompleteEditor"),(0,tZ.addClass)(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&(0,tZ.setAttribute)(this.TEXTAREA,[(0,iq.A11Y_TEXT)(),(0,iq.A11Y_COMBOBOX)(),(0,iq.A11Y_HASPOPUP)("listbox"),(0,iq.A11Y_AUTOCOMPLETE)()])}prepare(t,e,i,r,o,s){super.prepare(t,e,i,r,o,s),this.hot.getSettings().ariaTags&&(0,tZ.setAttribute)(this.TEXTAREA,[(0,iq.A11Y_EXPANDED)("false"),(0,iq.A11Y_CONTROLS)(`${hB.get(hj(hB,this))}-listbox-${t}-${e}`)])}open(){super.open();let t=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,e=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=null==i?void 0:i.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let n=(0,tZ.getScrollbarWidth)();0===n&&(0,t0.isMacOS)()&&(n+=15),this.addHook("beforeKeyDown",t=>this.onBeforeKeyDown(t)),this.htEditor.updateSettings({colWidths:t?[(0,tZ.outerWidth)(this.TEXTAREA)-2]:void 0,width:t?(0,tZ.outerWidth)(this.TEXTAREA)+n:void 0,autoColumnSize:!0,renderer:(t,o,s,n,a,l,h)=>{let c,d;hI(t,o,s,n,a,l,h);let{filteringCaseSensitive:u,allowHtml:g,locale:p}=this.cellProperties,f=this.query,m=(0,tJ.stringify)(l);m&&!g&&-1!==(c=!0===u?m.indexOf(f):m.toLocaleLowerCase(p).indexOf(f.toLocaleLowerCase(p)))&&(d=m.substr(c,f.length),m=m.replace(d,`<strong>${d}</strong>`)),e&&(0,tZ.setAttribute)(o,[(0,iq.A11Y_OPTION)(),...i?[(0,iq.A11Y_SETSIZE)(r)]:[],...i?[(0,iq.A11Y_POSINSET)(i.indexOf(l)+1)]:[],["id",`${this.htEditor.rootElement.id}_${s}-${n}`]]),o.innerHTML=m},afterSelectionEnd:(t,i)=>{if(e){let e=this.htEditor.getCell(t,i,!0);(0,tZ.setAttribute)(e,[(0,iq.A11Y_SELECTED)()]),(0,tZ.setAttribute)(this.TEXTAREA,...(0,iq.A11Y_ACTIVEDESCENDANT)(e.id))}}}),e&&((0,tZ.setAttribute)(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...(0,iq.A11Y_PRESENTATION)()),(0,tZ.setAttribute)(this.htEditor.rootElement,[(0,iq.A11Y_LISTBOX)(),(0,iq.A11Y_LIVE)("polite"),(0,iq.A11Y_RELEVANT)("text"),["id",`${hB.get(hj(hB,this))}-listbox-${o}-${s}`]]),(0,tZ.setAttribute)(this.TEXTAREA,...(0,iq.A11Y_EXPANDED)("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&(0,tZ.setAttribute)(this.TEXTAREA,[(0,iq.A11Y_EXPANDED)("false")])}discardEditor(t){super.discardEditor(t),this.hot.view.render()}queryChoices(t){let e=this.cellProperties.source;this.query=t,"function"==typeof e?e.call(this.cellProperties,t,t=>{this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))}):Array.isArray(e)?(this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))):this.updateChoicesList([])}updateChoicesList(t){let e=(0,tZ.getCaretPosition)(this.TEXTAREA),i=(0,tZ.getSelectionEndPosition)(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,s=null,n=null,a=t;r&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),a,this.cellProperties.filteringCaseSensitive));let l=Array.isArray(s)?s.length:0;if(!1===o)l&&(n=s[0]);else{let t=[];for(let e=0,i=a.length;e<i&&(!r||!(l<=e));e++)l?t.push(a[s[e]]):t.push(a[e]);n=0,a=t}this.strippedChoices=a,this.htEditor.loadData((0,eu.pivot)([a])),0===a.length?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(n)),this.hot.listen(),(0,tZ.setCaretPosition)(this.TEXTAREA,e,e===i?void 0:i)}flipDropdownIfNeeded(){let t=(0,tZ.getTrimmingContainer)(this.hot.view._wt.wtTable.TABLE),e=t===this.hot.rootWindow,i=this.cellProperties.preventOverflow;if(e||!e&&(i||"horizontal"===i))return!1;let r=(0,tZ.offset)(this.TEXTAREA),o=(0,tZ.outerHeight)(this.TEXTAREA),s=this.getDropdownHeight(),n=t.scrollTop,a=(0,tZ.outerHeight)(this.hot.view._wt.wtTable.THEAD),l=(0,tZ.offset)(t),h=r.top-l.top-a+n,c=t.scrollHeight-h-a-o,d=s>c&&h>c;return d?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(d?h:c,s),d}limitDropdownIfNeeded(t,e){if(e>t){let i=0,r=0,o=0,s=null;do i+=o=this.htEditor.getRowHeight(r)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=1;while(i<t)s=i-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+e-s}px`),this.setDropdownHeight(i-o)}}flipDropdown(t){let e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-t}px`,this.htEditor.flipped=!0}unflipDropdown(){let t=this.htEditor.rootElement.style;t.position="absolute",t.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){let t=this.htEditor.getColWidth(0)+(0,tZ.getScrollbarWidth)(this.hot.rootDocument)+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(t){this.htEditor.updateSettings({height:t})}highlightBestMatchingChoice(t){"number"==typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){let t=this.htEditor.getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8}stripValueIfNeeded(t){return this.stripValuesIfNeeded([t])[0]}stripValuesIfNeeded(t){let{allowHtml:e}=this.cellProperties,i=(0,eu.arrayMap)(t,t=>(0,tJ.stringify)(t));return(0,eu.arrayMap)(i,t=>e?t:(0,eX.stripTags)(t))}allowKeyEventPropagation(t){let e=this.htEditor.getSelectedRangeLast(),i={row:e?e.from.row:-1},r=!1;return t===iL.KEY_CODES.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(r=!0),t===iL.KEY_CODES.ARROW_UP&&i.row>-1&&(r=!0),r}onBeforeKeyDown(t){if((0,iL.isPrintableChar)(t.keyCode)||t.keyCode===iL.KEY_CODES.BACKSPACE||t.keyCode===iL.KEY_CODES.DELETE||t.keyCode===iL.KEY_CODES.INSERT){let e=10;t.keyCode===iL.KEY_CODES.C&&(t.ctrlKey||t.metaKey)||(this.isOpened()||(e+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},e))}}}var hL=(tn("3BsF4"),tn("3BsF4")),tZ=tn("gFbQZ");class hV extends hL.BaseEditor{static get EDITOR_TYPE(){return"checkbox"}beginEditing(t,e){if(e&&"mouseup"===e.type&&"TD"===e.target.nodeName){let t=this.TD.querySelector('input[type="checkbox"]');(0,tZ.hasClass)(t,"htBadValue")||t.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var hU=tn("iMgTM"),nd=tn("10euP");class hz extends hW{static get EDITOR_TYPE(){return"dropdown"}prepare(t,e,i,r,o,s){super.prepare(t,e,i,r,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}(0,nd.default).getSingleton().add("beforeValidate",function(t,e,i){let r=this.getCellMeta(e,this.propToCol(i));r.editor===hz&&void 0===r.strict&&(r.filter=!1,r.strict=!0)});var hO=tn("9PLwv");class hY extends hO.TextEditor{static get EDITOR_TYPE(){return"numeric"}}var hO=tn("9PLwv"),tZ=tn("gFbQZ"),iq=tn("4Pbrh");class hG extends hO.TextEditor{static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&(0,tZ.setAttribute)(this.TEXTAREA,[(0,iq.A11Y_HIDDEN)()]),(0,tZ.empty)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}var hL=tn("3BsF4"),tZ=tn("gFbQZ"),t3=tn("hwT6B");const h$="ht_editor_visible",hX="selectEditor";class hq extends hL.BaseEditor{static get EDITOR_TYPE(){return"select"}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",(0,tZ.addClass)(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(t){this.select.value=t}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",(0,tZ.hasClass)(this.select,h$)&&(0,tZ.removeClass)(this.select,h$),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(t,e,i,r,o,s){let n;super.prepare(t,e,i,r,o,s);let a=this.cellProperties.selectOptions;n="function"==typeof a?this.prepareOptions(a(this.row,this.col,this.prop)):this.prepareOptions(a),(0,tZ.empty)(this.select),(0,t3.objectEach)(n,(t,e)=>{let i=this.hot.rootDocument.createElement("OPTION");i.value=e,(0,tZ.fastInnerHTML)(i,t),this.select.appendChild(i)})}prepareOptions(t){let e={};if(Array.isArray(t))for(let i=0,r=t.length;i<r;i++)e[t[i]]=t[i];else"object"==typeof t&&(e=t);return e}refreshValue(){let t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){if(this.state!==hL.EDITOR_STATE.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}let{top:t,start:e,width:i,height:r}=this.getEditedCellRect(),o=this.select.style;o.height=`${r}px`,o.width=`${i}px`,o.top=`${t}px`,o[this.hot.isRtl()?"right":"left"]=`${e}px`,o.margin="0px",(0,tZ.addClass)(this.select,h$)}registerShortcuts(){let t=this.hot.getShortcutManager(),e=t.getContext("editor"),i=t.getContext("grid"),r={group:hX};e.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:i,callback:()=>{}}],r),!0===this.isInFullEditMode()&&e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{let t=this.select.selectedIndex-1;t>=0&&(this.select[t].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{let t=this.select.selectedIndex+1;t<=this.select.length-1&&(this.select[t].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(hX)}}var hO=(tn("9PLwv"),tn("9PLwv"));class hK extends hO.TextEditor{static get EDITOR_TYPE(){return"time"}prepare(t,e,i,r,o,s){super.prepare(t,e,i,r,o,s),this.TEXTAREA.dir="ltr"}}var il=tn("jxqWV"),tZ=tn("gFbQZ");function hZ(t,e,i,r,o,s,n){hP.apply(this,[t,e,i,r,o,s,n]),(0,tZ.fastInnerHTML)(e,null==s?"":s,!1)}hZ.RENDERER_TYPE="html";var t2=tn("1k8Ev"),tZ=tn("gFbQZ"),iq=tn("4Pbrh");function hQ(t,e,i,r,o,s,n){let{rootDocument:a}=t,l=n.allowHtml?hZ:hI,h=a.createElement("DIV"),c=t.getSettings().ariaTags;if(h.className="htAutocompleteArrow",c&&h.setAttribute(...(0,iq.A11Y_HIDDEN)()),h.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,i,r,o,s,n]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(h,e.firstChild),(0,tZ.addClass)(e,"htAutocomplete"),!t.acArrowListener){let o=new t2.default(t);t.acArrowListener=function(o){(0,tZ.hasClass)(o.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(i,r),e)},o.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{o.destroy()})}}function hJ(t,e,i,r,o,s,n){hQ.apply(this,[t,e,i,r,o,s,n])}hQ.RENDERER_TYPE="autocomplete",hJ.RENDERER_TYPE="dropdown",tn("1hIp0");var t2=tn("1k8Ev"),tZ=tn("gFbQZ"),tJ=tn("gnaTS"),nd=tn("10euP"),iq=tn("4Pbrh");const h0=new WeakMap,h1=new WeakMap,h2="data-row",h3="data-col",h6="checkbox";function h4(t,e,i,r,o,s,n){let{rootDocument:a}=t,l=t.getSettings().ariaTags;hP.apply(this,[t,e,i,r,o,s,n]),function(t){let e=h1.get(t);if(!e){let{rootElement:i}=t;(e=new t2.default(t)).addEventListener(i,"click",e=>(function(t,e){let{target:i}=t;if(!h5(i)||!i.hasAttribute(h2)||!i.hasAttribute(h3))return;let r=parseInt(i.getAttribute(h2),10),o=parseInt(i.getAttribute(h3),10);e.getCellMeta(r,o).readOnly&&t.preventDefault()})(e,t)),e.addEventListener(i,"mouseup",e=>(function(t,e){let{target:i}=t;h5(i)&&i.hasAttribute(h2)&&i.hasAttribute(h3)&&setTimeout(e.listen,10)})(e,t)),e.addEventListener(i,"change",e=>(function(t,e){let{target:i}=t;if(!h5(i)||!i.hasAttribute(h2)||!i.hasAttribute(h3))return;let r=parseInt(i.getAttribute(h2),10),o=parseInt(i.getAttribute(h3),10),s=e.getCellMeta(r,o);if(!s.readOnly){let i=null;i=t.target.checked?void 0===s.uncheckedTemplate||s.checkedTemplate:void 0!==s.uncheckedTemplate&&s.uncheckedTemplate,e.setDataAtCell(r,o,i)}})(e,t)),h1.set(t,e)}}(t);let h=function(t){let e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}(a),c=n.label,d=!1;if(void 0===n.checkedTemplate&&(n.checkedTemplate=!0),void 0===n.uncheckedTemplate&&(n.uncheckedTemplate=!1),(0,tZ.empty)(e),s===n.checkedTemplate||(0,tJ.stringify)(s).toLocaleLowerCase(n.locale)===(0,tJ.stringify)(n.checkedTemplate).toLocaleLowerCase(n.locale)?h.checked=!0:s===n.uncheckedTemplate||(0,tJ.stringify)(s).toLocaleLowerCase(n.locale)===(0,tJ.stringify)(n.uncheckedTemplate).toLocaleLowerCase(n.locale)?h.checked=!1:(0,tJ.isEmpty)(s)?(0,tZ.addClass)(h,"noValue"):(h.style.display="none",(0,tZ.addClass)(h,"htBadValue"),d=!0),(0,tZ.setAttribute)(h,[[h2,i],[h3,r]]),l&&(0,tZ.setAttribute)(h,[(0,iq.A11Y_LABEL)(h.checked?t.getTranslatedPhrase(aL):t.getTranslatedPhrase(aD)),(0,iq.A11Y_CHECKED)(h.checked),(0,iq.A11Y_CHECKBOX)()]),!d&&c){let n="";if(c.value)n="function"==typeof c.value?c.value.call(this,i,r,o,s):c.value;else if(c.property){let e=t.getDataAtRowProp(i,c.property);n=null!==e?e:""}let l=function(t,e,i){let r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${i?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}(a,n,!0!==c.separated);"before"===c.position?c.separated?(e.appendChild(l),e.appendChild(h)):(l.appendChild(h),h=l):c.position&&"after"!==c.position||(c.separated?(e.appendChild(h),e.appendChild(l)):(l.insertBefore(h,l.firstChild),h=l))}function u(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=t.getSelectedRange(),r=[],o=[],s=0;if(i){for(let n=0;n<i.length;n++){let{row:a,col:l}=i[n].getTopStartCorner(),{row:h,col:c}=i[n].getBottomEndCorner();for(let i=a;i<=h;i+=1)for(let r=l;r<=c;r+=1){let n=t.getCellMeta(i,r),a={checkedTemplate:n.checkedTemplate,uncheckedTemplate:n.uncheckedTemplate};if("checkbox"!==n.type)return;if(!0===n.readOnly)continue;void 0===n.checkedTemplate&&(n.checkedTemplate=!0),void 0===n.uncheckedTemplate&&(n.uncheckedTemplate=!1);let l=t.getDataAtCell(i,r);!1===e?[n.checkedTemplate,n.checkedTemplate.toString()].includes(l)?o.push([i,r,n.uncheckedTemplate,a]):[n.uncheckedTemplate,n.uncheckedTemplate.toString(),null,void 0].includes(l)&&o.push([i,r,n.checkedTemplate,a]):o.push([i,r,n.uncheckedTemplate,a]),s+=1}r.push(s),s=0}(o=o.every(t=>{let[,,e]=t;return e===o[0][2]})?o.map(t=>{let[e,i,r]=t;return[e,i,r]}):o.map(t=>{let[e,i,,r]=t;return[e,i,r.checkedTemplate]})).length>0&&r.forEach(e=>{let i=o.splice(0,e);t.setDataAtCell(i)})}}function g(){let e=t.getSelectedRange();if(e){for(let i=0;i<e.length;i++){let r=e[i].getTopStartCorner(),o=e[i].getBottomEndCorner();for(let e=r.row;e<=o.row;e++)for(let i=r.col;i<=o.col;i++){let r=t.getCellMeta(e,i);if("checkbox"!==r.type)return!1;let o=t.getCell(e,i);if(null==o||o.querySelectorAll("input[type=checkbox]").length>0&&!r.readOnly)return!0}}return!1}}c&&(!c||c.separated)||e.appendChild(h),d&&e.appendChild(a.createTextNode("#bad-value#")),h0.has(t)||(h0.set(t,!0),t.getShortcutManager().getContext("grid").addShortcuts([{keys:[["space"]],callback:()=>(u(),!g())},{keys:[["enter"]],callback:()=>(u(),!g()),runOnlyIf:()=>{var e;return t.getSettings().enterBeginsEditing&&(null===(e=t.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())}},{keys:[["delete"],["backspace"]],callback:()=>(u(!0),!g())}],{group:"checkboxRenderer",relativeToGroup:hs,position:"before"}))}function h5(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}function h9(t,e,i,r,o,s,n){hQ.apply(this,[t,e,i,r,o,s,n])}(0,nd.default).getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,i){let{label:r,type:o,row:s,column:n,prop:a}=e;if(o===h6){if(r){let{value:e,property:o}=r,l=i;if(e)l="function"==typeof e?e(s,n,a,i):e;else if(o){let t=this.getDataAtRowProp(s,o);l=null!==t?t:i}t=l}return t}}),h4.RENDERER_TYPE=h6,h9.RENDERER_TYPE="handsontable",tn("1hIp0");var h8={};h8=(function t(e,i,r){function o(n,a){if(!i[n]){if(!e[n]){var l=void 0;if(!a&&l)return l(n,!0);if(s)return s(n,!0);var h=Error("Cannot find module '"+n+"'");throw h.code="MODULE_NOT_FOUND",h}var c=i[n]={exports:{}};e[n][0].call(c.exports,function(t){return o(e[n][1][t]||t)},c,c.exports,t,e,i,r)}return i[n].exports}for(var s=void 0,n=0;n<r.length;n++)o(r[n]);return o})({1:[function(t,e,i){!function(t){var i,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,o=Math.ceil,s=Math.floor,n="[BigNumber Error] ",a=n+"Number primitive has more than 15 significant digits: ",l=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function h(t){var e=0|t;return 0<t||t===e?e:e-1}function c(t){for(var e,i,r=1,o=t.length,s=t[0]+"";r<o;){for(i=14-(e=t[r++]+"").length;i--;e="0"+e);s+=e}for(o=s.length;48===s.charCodeAt(--o););return s.slice(0,o+1||1)}function d(t,e){var i,r,o=t.c,s=e.c,n=t.s,a=e.s,l=t.e,h=e.e;if(!n||!a)return null;if(i=o&&!o[0],r=s&&!s[0],i||r)return i?r?0:-a:n;if(n!=a)return n;if(i=n<0,r=l==h,!o||!s)return r?0:!o^i?1:-1;if(!r)return h<l^i?1:-1;for(a=(l=o.length)<(h=s.length)?l:h,n=0;n<a;n++)if(o[n]!=s[n])return o[n]>s[n]^i?1:-1;return l==h?0:h<l^i?1:-1}function u(t,e,i,r){if(t<e||i<t||t!==(t<0?o(t):s(t)))throw Error(n+(r||"Argument")+("number"==typeof t?t<e||i<t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function g(t){var e=t.c.length-1;return h(t.e/14)==e&&t.c[e]%2!=0}function p(t,e){return(1<t.length?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function f(t,e,i){var r,o;if(e<0){for(o=i+".";++e;o+=i);t=o+t}else if(++e>(r=t.length)){for(o=i,e-=r;--e;o+=i);t+=o}else e<r&&(t=t.slice(0,e)+"."+t.slice(e));return t}(i=function t(e){var i,m,y,w,b,C,S,x,E,R=F.prototype={constructor:F,toString:null,valueOf:null},T=new F(1),M=20,k=4,A=-7,O=21,P=-1e7,I=1e7,H=!1,L=1,D=0,N={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},_="0123456789abcdefghijklmnopqrstuvwxyz";function F(t,e){var i,o,n,l,h,c,d,g,p=this;if(!(p instanceof F))return new F(t,e);if(null==e){if(t instanceof F)return p.s=t.s,p.e=t.e,void(p.c=(t=t.c)?t.slice():t);if((c="number"==typeof t)&&0*t==0){if(p.s=1/t<0?(t=-t,-1):1,t===~~t){for(l=0,h=t;10<=h;h/=10,l++);return p.e=l,void(p.c=[t])}g=String(t)}else{if(g=String(t),!r.test(g))return y(p,g,c);p.s=45==g.charCodeAt(0)?(g=g.slice(1),-1):1}-1<(l=g.indexOf("."))&&(g=g.replace(".","")),0<(h=g.search(/e/i))?(l<0&&(l=h),l+=+g.slice(h+1),g=g.substring(0,h)):l<0&&(l=g.length)}else{if(u(e,2,_.length,"Base"),g=String(t),10==e)return V(p=new F(t instanceof F?t:g),M+p.e+1,k);if(c="number"==typeof t){if(0*t!=0)return y(p,g,c,e);if(p.s=1/t<0?(g=g.slice(1),-1):1,F.DEBUG&&15<g.replace(/^0\.0*|\./,"").length)throw Error(a+t);c=!1}else p.s=45===g.charCodeAt(0)?(g=g.slice(1),-1):1;for(i=_.slice(0,e),l=h=0,d=g.length;h<d;h++)if(0>i.indexOf(o=g.charAt(h))){if("."==o){if(l<h){l=d;continue}}else if(!n&&(g==g.toUpperCase()&&(g=g.toLowerCase())||g==g.toLowerCase()&&(g=g.toUpperCase()))){n=!0,h=-1,l=0;continue}return y(p,String(t),c,e)}-1<(l=(g=m(g,e,10,p.s)).indexOf("."))?g=g.replace(".",""):l=g.length}for(h=0;48===g.charCodeAt(h);h++);for(d=g.length;48===g.charCodeAt(--d););if(g=g.slice(h,++d)){if(d-=h,c&&F.DEBUG&&15<d&&(9007199254740991<t||t!==s(t)))throw Error(a+p.s*t);if(I<(l=l-h-1))p.c=p.e=null;else if(l<P)p.c=[p.e=0];else{if(p.e=l,p.c=[],h=(l+1)%14,l<0&&(h+=14),h<d){for(h&&p.c.push(+g.slice(0,h)),d-=14;h<d;)p.c.push(+g.slice(h,h+=14));h=14-(g=g.slice(h)).length}else h-=d;for(;h--;g+="0");p.c.push(+g)}}else p.c=[p.e=0]}function j(t,e,i,r){var o,s,n,a,l;if(null==i?i=k:u(i,0,8),!t.c)return t.toString();if(o=t.c[0],n=t.e,null==e)l=c(t.c),l=1==r||2==r&&(n<=A||O<=n)?p(l,n):f(l,n,"0");else if(s=(t=V(new F(t),e,i)).e,a=(l=c(t.c)).length,1==r||2==r&&(e<=s||s<=A)){for(;a<e;l+="0",a++);l=p(l,s)}else if(e-=n,l=f(l,s,"0"),a<s+1){if(0<--e)for(l+=".";e--;l+="0");}else if(0<(e+=s-a))for(s+1==a&&(l+=".");e--;l+="0");return t.s<0&&o?"-"+l:l}function B(t,e){for(var i,r=1,o=new F(t[0]);r<t.length;r++){if(!(i=new F(t[r])).s){o=i;break}e.call(o,i)&&(o=i)}return o}function W(t,e,i){for(var r=1,o=e.length;!e[--o];e.pop());for(o=e[0];10<=o;o/=10,r++);return(i=r+14*i-1)>I?t.c=t.e=null:t.c=i<P?[t.e=0]:(t.e=i,e),t}function V(t,e,i,r){var n,a,h,c,d,u,g,p=t.c;if(p){t:{for(n=1,c=p[0];10<=c;c/=10,n++);if((a=e-n)<0)a+=14,h=e,g=(d=p[u=0])/l[n-h-1]%10|0;else if((u=o((a+1)/14))>=p.length){if(!r)break t;for(;p.length<=u;p.push(0));d=g=0,h=(a%=14)-14+(n=1)}else{for(d=c=p[u],n=1;10<=c;c/=10,n++);g=(h=(a%=14)-14+n)<0?0:d/l[n-h-1]%10|0}if(r=r||e<0||null!=p[u+1]||(h<0?d:d%l[n-h-1]),r=i<4?(g||r)&&(0==i||i==(t.s<0?3:2)):5<g||5==g&&(4==i||r||6==i&&(0<a?0<h?d/l[n-h]:0:p[u-1])%10&1||i==(t.s<0?8:7)),e<1||!p[0])return p.length=0,r?(e-=t.e+1,p[0]=l[(14-e%14)%14],t.e=-e||0):p[0]=t.e=0,t;if(0==a?(p.length=u,c=1,u--):(p.length=u+1,c=l[14-a],p[u]=0<h?s(d/l[n-h]%l[h])*c:0),r)for(;;){if(0==u){for(a=1,h=p[0];10<=h;h/=10,a++);for(h=p[0]+=c,c=1;10<=h;h/=10,c++);a!=c&&(t.e++,1e14==p[0]&&(p[0]=1));break}if(p[u]+=c,1e14!=p[u])break;p[u--]=0,c=1}for(a=p.length;0===p[--a];p.pop());}t.e>I?t.c=t.e=null:t.e<P&&(t.c=[t.e=0])}return t}function U(t){var e,i=t.e;return null===i?t.toString():(e=c(t.c),e=i<=A||O<=i?p(e,i):f(e,i,"0"),t.s<0?"-"+e:e)}return F.clone=t,F.ROUND_UP=0,F.ROUND_DOWN=1,F.ROUND_CEIL=2,F.ROUND_FLOOR=3,F.ROUND_HALF_UP=4,F.ROUND_HALF_DOWN=5,F.ROUND_HALF_EVEN=6,F.ROUND_HALF_CEIL=7,F.ROUND_HALF_FLOOR=8,F.EUCLID=9,F.config=F.set=function(t){var e,i;if(null!=t){if("object"!=typeof t)throw Error(n+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(u(i=t[e],0,1e9,e),M=i),t.hasOwnProperty(e="ROUNDING_MODE")&&(u(i=t[e],0,8,e),k=i),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((i=t[e])&&i.pop?(u(i[0],-1e9,0,e),u(i[1],0,1e9,e),A=i[0],O=i[1]):(u(i,-1e9,1e9,e),A=-(O=i<0?-i:i))),t.hasOwnProperty(e="RANGE")){if((i=t[e])&&i.pop)u(i[0],-1e9,-1,e),u(i[1],1,1e9,e),P=i[0],I=i[1];else{if(u(i,-1e9,1e9,e),!i)throw Error(n+e+" cannot be zero: "+i);P=-(I=i<0?-i:i)}}if(t.hasOwnProperty(e="CRYPTO")){if((i=t[e])!==!!i)throw Error(n+e+" not true or false: "+i);if(i){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw H=!i,Error(n+"crypto unavailable");H=i}else H=i}if(t.hasOwnProperty(e="MODULO_MODE")&&(u(i=t[e],0,9,e),L=i),t.hasOwnProperty(e="POW_PRECISION")&&(u(i=t[e],0,1e9,e),D=i),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(i=t[e]))throw Error(n+e+" not an object: "+i);N=i}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(i=t[e])||/^.$|[+-.\s]|(.).*\1/.test(i))throw Error(n+e+" invalid: "+i);_=i}}return{DECIMAL_PLACES:M,ROUNDING_MODE:k,EXPONENTIAL_AT:[A,O],RANGE:[P,I],CRYPTO:H,MODULO_MODE:L,POW_PRECISION:D,FORMAT:N,ALPHABET:_}},F.isBigNumber=function(t){return t instanceof F||t&&!0===t._isBigNumber||!1},F.maximum=F.max=function(){return B(arguments,R.lt)},F.minimum=F.min=function(){return B(arguments,R.gt)},F.random=(w=9007199254740992*Math.random()&2097151?function(){return s(9007199254740992*Math.random())}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,i,r,a,h,c=0,d=[],g=new F(T);if(null==t?t=M:u(t,0,1e9),a=o(t/14),H){if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(a*=2));c<a;)9e15<=(h=131072*e[c]+(e[c+1]>>>11))?(i=crypto.getRandomValues(new Uint32Array(2)),e[c]=i[0],e[c+1]=i[1]):(d.push(h%1e14),c+=2);c=a/2}else{if(!crypto.randomBytes)throw H=!1,Error(n+"crypto unavailable");for(e=crypto.randomBytes(a*=7);c<a;)9e15<=(h=281474976710656*(31&e[c])+1099511627776*e[c+1]+4294967296*e[c+2]+16777216*e[c+3]+(e[c+4]<<16)+(e[c+5]<<8)+e[c+6])?crypto.randomBytes(7).copy(e,c):(d.push(h%1e14),c+=7);c=a/7}}if(!H)for(;c<a;)(h=w())<9e15&&(d[c++]=h%1e14);for(a=d[--c],t%=14,a&&t&&(h=l[14-t],d[c]=s(a/h)*h);0===d[c];d.pop(),c--);if(c<0)d=[r=0];else{for(r=-1;0===d[0];d.splice(0,1),r-=14);for(c=1,h=d[0];10<=h;h/=10,c++);c<14&&(r-=14-c)}return g.e=r,g.c=d,g}),F.sum=function(){for(var t=1,e=arguments,i=new F(e[0]);t<e.length;)i=i.plus(e[t++]);return i},m=function(){var t="0123456789";function e(t,e,i,r){for(var o,s,n=[0],a=0,l=t.length;a<l;){for(s=n.length;s--;n[s]*=e);for(n[0]+=r.indexOf(t.charAt(a++)),o=0;o<n.length;o++)n[o]>i-1&&(null==n[o+1]&&(n[o+1]=0),n[o+1]+=n[o]/i|0,n[o]%=i)}return n.reverse()}return function(r,o,s,n,a){var l,h,d,u,g,p,m,y,w=r.indexOf("."),b=M,C=k;for(0<=w&&(u=D,D=0,r=r.replace(".",""),p=(y=new F(o)).pow(r.length-w),D=u,y.c=e(f(c(p.c),p.e,"0"),10,s,t),y.e=y.c.length),d=u=(m=e(r,o,s,a?(l=_,t):(l=t,_))).length;0==m[--u];m.pop());if(!m[0])return l.charAt(0);if(w<0?--d:(p.c=m,p.e=d,p.s=n,m=(p=i(p,y,b,C,s)).c,g=p.r,d=p.e),w=m[h=d+b+1],u=s/2,g=g||h<0||null!=m[h+1],g=C<4?(null!=w||g)&&(0==C||C==(p.s<0?3:2)):u<w||w==u&&(4==C||g||6==C&&1&m[h-1]||C==(p.s<0?8:7)),h<1||!m[0])r=g?f(l.charAt(1),-b,l.charAt(0)):l.charAt(0);else{if(m.length=h,g)for(--s;++m[--h]>s;)m[h]=0,h||(++d,m=[1].concat(m));for(u=m.length;!m[--u];);for(w=0,r="";w<=u;r+=l.charAt(m[w++]));r=f(r,d,l.charAt(0))}return r}}(),i=function(){function t(t,e,i){var r,o,s,n,a=0,l=t.length,h=e%1e7,c=e/1e7|0;for(t=t.slice();l--;)a=((o=h*(s=t[l]%1e7)+(r=c*s+(n=t[l]/1e7|0)*h)%1e7*1e7+a)/i|0)+(r/1e7|0)+c*n,t[l]=o%i;return a&&(t=[a].concat(t)),t}function e(t,e,i,r){var o,s;if(i!=r)s=r<i?1:-1;else for(o=s=0;o<i;o++)if(t[o]!=e[o]){s=t[o]>e[o]?1:-1;break}return s}function i(t,e,i,r){for(var o=0;i--;)t[i]-=o,o=t[i]<e[i]?1:0,t[i]=o*r+t[i]-e[i];for(;!t[0]&&1<t.length;t.splice(0,1));}return function(r,o,n,a,l){var c,d,u,g,p,f,m,y,w,b,C,S,x,E,R,T,M,k=r.s==o.s?1:-1,A=r.c,O=o.c;if(!(A&&A[0]&&O&&O[0]))return new F(r.s&&o.s&&(A?!O||A[0]!=O[0]:O)?A&&0==A[0]||!O?0*k:k/0:NaN);for(w=(y=new F(k)).c=[],k=n+(d=r.e-o.e)+1,l||(l=1e14,d=h(r.e/14)-h(o.e/14),k=k/14|0),u=0;O[u]==(A[u]||0);u++);if(O[u]>(A[u]||0)&&d--,k<0)w.push(1),g=!0;else{for(E=A.length,T=O.length,k+=2,1<(p=s(l/(O[u=0]+1)))&&(O=t(O,p,l),A=t(A,p,l),T=O.length,E=A.length),x=T,C=(b=A.slice(0,T)).length;C<T;b[C++]=0);M=[0].concat(M=O.slice()),R=O[0],O[1]>=l/2&&R++;do{if(p=0,(c=e(O,b,T,C))<0){if(S=b[0],T!=C&&(S=S*l+(b[1]||0)),1<(p=s(S/R)))for(l<=p&&(p=l-1),m=(f=t(O,p,l)).length,C=b.length;1==e(f,b,m,C);)p--,i(f,T<m?M:O,m,l),m=f.length,c=1;else 0==p&&(c=p=1),m=(f=O.slice()).length;if(m<C&&(f=[0].concat(f)),i(b,f,C,l),C=b.length,-1==c)for(;1>e(O,b,T,C);)p++,i(b,T<C?M:O,C,l),C=b.length}else 0===c&&(p++,b=[0]);w[u++]=p,b[0]?b[C++]=A[x]||0:(b=[A[x]],C=1)}while((x++<E||null!=b[0])&&k--)g=null!=b[0],w[0]||w.splice(0,1)}if(1e14==l){for(u=1,k=w[0];10<=k;k/=10,u++);V(y,n+(y.e=u+14*d-1)+1,a,g)}else y.e=d,y.r=+g;return y}}(),b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,C=/^([^.]+)\.$/,S=/^\.([^.]+)$/,x=/^-?(Infinity|NaN)$/,E=/^\s*\+(?=[\w.])|^\s+|\s+$/g,y=function(t,e,i,r){var o,s=i?e:e.replace(E,"");if(x.test(s))t.s=isNaN(s)?null:s<0?-1:1,t.c=t.e=null;else{if(!i&&(s=s.replace(b,function(t,e,i){return o="x"==(i=i.toLowerCase())?16:"b"==i?2:8,r&&r!=o?t:e}),r&&(o=r,s=s.replace(C,"$1").replace(S,"0.$1")),e!=s))return new F(s,o);if(F.DEBUG)throw Error(n+"Not a"+(r?" base "+r:"")+" number: "+e);t.c=t.e=t.s=null}},R.absoluteValue=R.abs=function(){var t=new F(this);return t.s<0&&(t.s=1),t},R.comparedTo=function(t,e){return d(this,new F(t,e))},R.decimalPlaces=R.dp=function(t,e){var i,r,o;if(null!=t)return u(t,0,1e9),null==e?e=k:u(e,0,8),V(new F(this),t+this.e+1,e);if(!(i=this.c))return null;if(r=((o=i.length-1)-h(this.e/14))*14,o=i[o])for(;o%10==0;o/=10,r--);return r<0&&(r=0),r},R.dividedBy=R.div=function(t,e){return i(this,new F(t,e),M,k)},R.dividedToIntegerBy=R.idiv=function(t,e){return i(this,new F(t,e),0,1)},R.exponentiatedBy=R.pow=function(t,e){var i,r,a,l,h,c,d,u,p=this;if((t=new F(t)).c&&!t.isInteger())throw Error(n+"Exponent not an integer: "+U(t));if(null!=e&&(e=new F(e)),h=14<t.e,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!t.c||!t.c[0])return u=new F(Math.pow(+U(p),h?2-g(t):+U(t))),e?u.mod(e):u;if(c=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new F(NaN);(r=!c&&p.isInteger()&&e.isInteger())&&(p=p.mod(e))}else{if(9<t.e&&(0<p.e||p.e<-1||(0==p.e?1<p.c[0]||h&&24e7<=p.c[1]:p.c[0]<8e13||h&&p.c[0]<=9999975e7)))return l=p.s<0&&g(t)?-0:0,-1<p.e&&(l=1/l),new F(c?1/l:l);D&&(l=o(D/14+2))}for(d=h?(i=new F(.5),c&&(t.s=1),g(t)):(a=Math.abs(+U(t)))%2,u=new F(T);;){if(d){if(!(u=u.times(p)).c)break;l?u.c.length>l&&(u.c.length=l):r&&(u=u.mod(e))}if(a){if(0===(a=s(a/2)))break;d=a%2}else if(V(t=t.times(i),t.e+1,1),14<t.e)d=g(t);else{if(0==(a=+U(t)))break;d=a%2}p=p.times(p),l?p.c&&p.c.length>l&&(p.c.length=l):r&&(p=p.mod(e))}return r?u:(c&&(u=T.div(u)),e?u.mod(e):l?V(u,D,k,void 0):u)},R.integerValue=function(t){var e=new F(this);return null==t?t=k:u(t,0,8),V(e,e.e+1,t)},R.isEqualTo=R.eq=function(t,e){return 0===d(this,new F(t,e))},R.isFinite=function(){return!!this.c},R.isGreaterThan=R.gt=function(t,e){return 0<d(this,new F(t,e))},R.isGreaterThanOrEqualTo=R.gte=function(t,e){return 1===(e=d(this,new F(t,e)))||0===e},R.isInteger=function(){return!!this.c&&h(this.e/14)>this.c.length-2},R.isLessThan=R.lt=function(t,e){return 0>d(this,new F(t,e))},R.isLessThanOrEqualTo=R.lte=function(t,e){return -1===(e=d(this,new F(t,e)))||0===e},R.isNaN=function(){return!this.s},R.isNegative=function(){return this.s<0},R.isPositive=function(){return 0<this.s},R.isZero=function(){return!!this.c&&0==this.c[0]},R.minus=function(t,e){var i,r,o,s,n=this.s;if(e=(t=new F(t,e)).s,!n||!e)return new F(NaN);if(n!=e)return t.s=-e,this.plus(t);var a=this.e/14,l=t.e/14,c=this.c,d=t.c;if(!a||!l){if(!c||!d)return c?(t.s=-e,t):new F(d?this:NaN);if(!c[0]||!d[0])return d[0]?(t.s=-e,t):new F(c[0]?this:3==k?-0:0)}if(a=h(a),l=h(l),c=c.slice(),n=a-l){for((o=(s=n<0)?(n=-n,c):(l=a,d)).reverse(),e=n;e--;o.push(0));o.reverse()}else for(r=(s=(n=c.length)<(e=d.length))?n:e,n=e=0;e<r;e++)if(c[e]!=d[e]){s=c[e]<d[e];break}if(s&&(o=c,c=d,d=o,t.s=-t.s),0<(e=(r=d.length)-(i=c.length)))for(;e--;c[i++]=0);for(e=1e14-1;n<r;){if(c[--r]<d[r]){for(i=r;i&&!c[--i];c[i]=e);--c[i],c[r]+=1e14}c[r]-=d[r]}for(;0==c[0];c.splice(0,1),--l);return c[0]?W(t,c,l):(t.s=3==k?-1:1,t.c=[t.e=0],t)},R.modulo=R.mod=function(t,e){var r,o;return t=new F(t,e),this.c&&t.s&&(!t.c||t.c[0])?t.c&&(!this.c||this.c[0])?(9==L?(o=t.s,t.s=1,r=i(this,t,0,3),t.s=o,r.s*=o):r=i(this,t,0,L),(t=this.minus(r.times(t))).c[0]||1!=L||(t.s=this.s),t):new F(this):new F(NaN)},R.multipliedBy=R.times=function(t,e){var i,r,o,s,n,a,l,c,d,u,g,p,f,m=this.c,y=(t=new F(t,e)).c;if(!(m&&y&&m[0]&&y[0]))return this.s&&t.s&&(!m||m[0]||y)&&(!y||y[0]||m)?(t.s*=this.s,m&&y?(t.c=[0],t.e=0):t.c=t.e=null):t.c=t.e=t.s=null,t;for(r=h(this.e/14)+h(t.e/14),t.s*=this.s,(l=m.length)<(u=y.length)&&(f=m,m=y,y=f,o=l,l=u,u=o),o=l+u,f=[];o--;f.push(0));for(o=u;0<=--o;){for(i=0,g=y[o]%1e7,p=y[o]/1e7|0,s=o+(n=l);o<s;)i=((c=g*(c=m[--n]%1e7)+(a=p*c+(d=m[n]/1e7|0)*g)%1e7*1e7+f[s]+i)/1e14|0)+(a/1e7|0)+p*d,f[s--]=c%1e14;f[s]=i}return i?++r:f.splice(0,1),W(t,f,r)},R.negated=function(){var t=new F(this);return t.s=-t.s||null,t},R.plus=function(t,e){var i,r=this.s;if(e=(t=new F(t,e)).s,!r||!e)return new F(NaN);if(r!=e)return t.s=-e,this.minus(t);var o=this.e/14,s=t.e/14,n=this.c,a=t.c;if(!o||!s){if(!n||!a)return new F(r/0);if(!n[0]||!a[0])return a[0]?t:new F(n[0]?this:0*r)}if(o=h(o),s=h(s),n=n.slice(),r=o-s){for((i=0<r?(s=o,a):(r=-r,n)).reverse();r--;i.push(0));i.reverse()}for((r=n.length)-(e=a.length)<0&&(i=a,a=n,n=i,e=r),r=0;e;)r=(n[--e]=n[e]+a[e]+r)/1e14|0,n[e]=1e14===n[e]?0:n[e]%1e14;return r&&(n=[r].concat(n),++s),W(t,n,s)},R.precision=R.sd=function(t,e){var i,r,o;if(null!=t&&!!t!==t)return u(t,1,1e9),null==e?e=k:u(e,0,8),V(new F(this),t,e);if(!(i=this.c))return null;if(r=14*(o=i.length-1)+1,o=i[o]){for(;o%10==0;o/=10,r--);for(o=i[0];10<=o;o/=10,r++);}return t&&this.e+1>r&&(r=this.e+1),r},R.shiftedBy=function(t){return u(t,-9007199254740991,9007199254740991),this.times("1e"+t)},R.squareRoot=R.sqrt=function(){var t,e,r,o,s,n=this.c,a=this.s,l=this.e,d=M+4,u=new F("0.5");if(1!==a||!n||!n[0])return new F(!a||a<0&&(!n||n[0])?NaN:n?this:1/0);if((r=0==(a=Math.sqrt(+U(this)))||a==1/0?(((e=c(n)).length+l)%2==0&&(e+="0"),a=Math.sqrt(+e),l=h((l+1)/2)-(l<0||l%2),new F(e=a==1/0?"1e"+l:(e=a.toExponential()).slice(0,e.indexOf("e")+1)+l)):new F(a+"")).c[0]){for((a=(l=r.e)+d)<3&&(a=0);;)if(s=r,r=u.times(s.plus(i(this,s,d,1))),c(s.c).slice(0,a)===(e=c(r.c)).slice(0,a)){if(r.e<l&&--a,"9999"!=(e=e.slice(a-3,a+1))&&(o||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(V(r,r.e+M+2,1),t=!r.times(r).eq(this));break}if(!o&&(V(s,s.e+M+2,0),s.times(s).eq(this))){r=s;break}d+=4,a+=4,o=1}}return V(r,r.e+M+1,k,t)},R.toExponential=function(t,e){return null!=t&&(u(t,0,1e9),t++),j(this,t,e,1)},R.toFixed=function(t,e){return null!=t&&(u(t,0,1e9),t=t+this.e+1),j(this,t,e)},R.toFormat=function(t,e,i){var r;if(null==i)null!=t&&e&&"object"==typeof e?(i=e,e=null):t&&"object"==typeof t?(i=t,t=e=null):i=N;else if("object"!=typeof i)throw Error(n+"Argument not an object: "+i);if(r=this.toFixed(t,e),this.c){var o,s=r.split("."),a=+i.groupSize,l=+i.secondaryGroupSize,h=i.groupSeparator||"",c=s[0],d=s[1],u=this.s<0,g=u?c.slice(1):c,p=g.length;if(l&&(o=a,a=l,p-=l=o),0<a&&0<p){for(o=p%a||a,c=g.substr(0,o);o<p;o+=a)c+=h+g.substr(o,a);0<l&&(c+=h+g.slice(o)),u&&(c="-"+c)}r=d?c+(i.decimalSeparator||"")+((l=+i.fractionGroupSize)?d.replace(RegExp("\\d{"+l+"}\\B","g"),"$&"+(i.fractionGroupSeparator||"")):d):c}return(i.prefix||"")+r+(i.suffix||"")},R.toFraction=function(t){var e,r,o,s,a,h,d,u,g,p,f,m,y=this.c;if(null!=t&&(!(d=new F(t)).isInteger()&&(d.c||1!==d.s)||d.lt(T)))throw Error(n+"Argument "+(d.isInteger()?"out of range: ":"not an integer: ")+U(d));if(!y)return new F(this);for(e=new F(T),g=r=new F(T),o=u=new F(T),m=c(y),a=e.e=m.length-this.e-1,e.c[0]=l[(h=a%14)<0?14+h:h],t=!t||0<d.comparedTo(e)?0<a?e:g:d,h=I,I=1/0,d=new F(m),u.c[0]=0;p=i(d,e,0,1),1!=(s=r.plus(p.times(o))).comparedTo(t);)r=o,o=s,g=u.plus(p.times(s=g)),u=s,e=d.minus(p.times(s=e)),d=s;return s=i(t.minus(r),o,0,1),u=u.plus(s.times(g)),r=r.plus(s.times(o)),u.s=g.s=this.s,f=1>i(g,o,a*=2,k).minus(this).abs().comparedTo(i(u,r,a,k).minus(this).abs())?[g,o]:[u,r],I=h,f},R.toNumber=function(){return+U(this)},R.toPrecision=function(t,e){return null!=t&&u(t,1,1e9),j(this,t,e,2)},R.toString=function(t){var e,i=this,r=i.s,o=i.e;return null===o?r?(e="Infinity",r<0&&(e="-"+e)):e="NaN":(e=null==t?o<=A||O<=o?p(c(i.c),o):f(c(i.c),o,"0"):10===t?f(c((i=V(new F(i),M+o+1,k)).c),i.e,"0"):(u(t,2,_.length,"Base"),m(f(c(i.c),o,"0"),10,t,r,!0)),r<0&&i.c[0]&&(e="-"+e)),e},R.valueOf=R.toJSON=function(){return U(this)},R._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(R[Symbol.toStringTag]="BigNumber",R[Symbol.for("nodejs.util.inspect.custom")]=R.valueOf),null!=e&&F.set(e),F}()).default=i.BigNumber=i,void 0!==e&&e.exports?e.exports=i:(t||(t="undefined"!=typeof self&&self?self:window),t.BigNumber=i)}(this)},{}],2:[function(t,e,i){e.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,e,i){function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=[],r=!0,o=!1,s=void 0;try{for(var n,a=t[Symbol.iterator]();!(r=(n=a.next()).done)&&(i.push(n.value),!e||i.length!==e);r=!0);}catch(t){o=!0,s=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw s}}return i}(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=t("./globalState"),s=t("./validating"),n=t("./parsing"),a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],l={general:{scale:1024,suffixes:a,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:a,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function c(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=2<arguments.length?arguments[2]:void 0;if("string"==typeof e&&(e=n.parseFormat(e)),!s.validateFormat(e))return"ERROR: invalid format";var r=e.prefix||"",a=e.postfix||"",c=function(t,e,i){var r,s,n,a,c,u,f,m,y,w,b,C,S,x,E,R,T,M,k,A,O,P,I,H,L,D,N,_;switch(e.output){case"currency":return R=e=p(e,o.currentCurrencyDefaultFormat()),T=o.currentCurrency(),M=Object.assign({},h,R),k=void 0,A="",O=!!M.totalLength||!!M.forceAverage||M.average,P=R.currencyPosition||T.position,I=R.currencySymbol||T.symbol,M.spaceSeparated&&(A=" "),"infix"===P&&(k=A+I+A),H=g({instance:t,providedFormat:R,state:o,decimalSeparator:k}),"prefix"===P&&(H=t._value<0&&"sign"===M.negative?"-".concat(A).concat(I).concat(H.slice(1)):I+A+H),P&&"postfix"!==P||(H=H+(A=O?"":A)+I),H;case"percent":return D=(L=e=p(e,o.currentPercentageDefaultFormat())).prefixSymbol,N=g({instance:i(100*t._value),providedFormat:L,state:o}),_=Object.assign({},h,L),D?"%".concat(_.spaceSeparated?" ":"").concat(N):"".concat(N).concat(_.spaceSeparated?" ":"","%");case"byte":return w=l[(y=e=p(e,o.currentByteDefaultFormat())).base||"binary"],C=(b=d(t._value,w.suffixes,w.scale)).value,S=b.suffix,x=g({instance:i(C),providedFormat:y,state:o,defaults:o.currentByteDefaultFormat()}),E=o.currentAbbreviations(),"".concat(x).concat(E.spaced?" ":"").concat(S);case"time":return e=p(e,o.currentTimeDefaultFormat()),u=Math.floor(t._value/60/60),f=Math.floor((t._value-60*u*60)/60),m=Math.round(t._value-60*u*60-60*f),"".concat(u,":").concat(f<10?"0":"").concat(f,":").concat(m<10?"0":"").concat(m);case"ordinal":return r=e=p(e,o.currentOrdinalDefaultFormat()),s=o.currentOrdinal(),n=Object.assign({},h,r),a=g({instance:t,providedFormat:r,state:o}),c=s(t._value),"".concat(a).concat(n.spaceSeparated?" ":"").concat(c);default:return g({instance:t,providedFormat:e,numbro:i})}}(t,e,i);return(c=r+c)+a}function d(t,e,i){var r=e[0],o=Math.abs(t);if(i<=o){for(var s=1;s<e.length;++s){var n=Math.pow(i,s),a=Math.pow(i,s+1);if(n<=o&&o<a){r=e[s],t/=n;break}}r===e[0]&&(t/=Math.pow(i,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function u(t){for(var e="",i=0;i<t;i++)e+="0";return e}function g(t){var e,i,s,n,a,l,c,d,g,p=t.instance,f=t.providedFormat,m=t.state,y=void 0===m?o:m,w=t.decimalSeparator,b=t.defaults,C=void 0===b?y.currentDefaults():b,S=p._value;if(0===S&&y.hasZeroFormat())return y.getZeroFormat();if(!isFinite(S))return S.toString();var x,E,R,T,M,k,A,O,P=Object.assign({},h,C,f),I=P.totalLength,H=I?0:P.characteristic,L=P.optionalCharacteristic,D=P.forceAverage,N=!!I||!!D||P.average,_=I?-1:N&&void 0===f.mantissa?0:P.mantissa,F=!I&&(void 0===f.optionalMantissa?-1===_:P.optionalMantissa),j=P.trimMantissa,B=P.thousandSeparated,W=P.spaceSeparated,V=P.negative,U=P.forceSign,z=P.exponential,Y="";if(N){var G,$,X,q,K,Z,Q,J,tt,te,ti=($=(G={value:S,forceAverage:D,abbreviations:y.currentAbbreviations(),spaceSeparated:W,totalLength:I}).value,X=G.forceAverage,q=G.abbreviations,K=G.spaceSeparated,Q=void 0===(Z=G.totalLength)?0:Z,J="",te=-1,(tt=Math.abs($))>=1e12&&!X||"trillion"===X?(J=q.trillion,$/=1e12):tt<1e12&&tt>=1e9&&!X||"billion"===X?(J=q.billion,$/=1e9):tt<1e9&&tt>=1e6&&!X||"million"===X?(J=q.million,$/=1e6):(tt<1e6&&tt>=1e3&&!X||"thousand"===X)&&(J=q.thousand,$/=1e3),J&&(J=(void 0!==K&&K?" ":"")+J),Q&&(te=Math.max(Q-$.toString().split(".")[0].length,0)),{value:$,abbreviation:J,mantissaPrecision:te});S=ti.value,Y+=ti.abbreviation,I&&(_=ti.mantissaPrecision)}if(z){var tr=(E=(x={value:S,characteristicPrecision:H}).value,T=void 0===(R=x.characteristicPrecision)?0:R,k=(M=r(E.toExponential().split("e"),2))[0],A=M[1],O=+k,T&&1<T&&(O*=Math.pow(10,T-1),A=0<=(A=+A-(T-1))?"+".concat(A):A),{value:O,abbreviation:"e".concat(A)});S=tr.value,Y=tr.abbreviation+Y}var to,ts,tn=function(t,e,i,o,s){if(-1===o)return t;var n=-1!==e.toString().indexOf("e")?function(t,e){var i=t.toString(),o=r(i.split("e"),2),s=o[0],n=o[1],a=r(s.split("."),2),l=a[0],h=a[1],c=void 0===h?"":h;if(0<+n)i=l+c+u(n-c.length);else{var d=".";d=0>+l?"-0".concat(d):"0".concat(d);var g=(u(-n-1)+Math.abs(l)+c).substr(0,e);g.length<e&&(g+=u(e-g.length)),i=d+g}return 0<+n&&0<e&&(i+=".".concat(u(e))),i}(e,o):(Math.round(+"".concat(e,"e+").concat(o))/Math.pow(10,o)).toFixed(o),a=r(n.toString().split("."),2),l=a[0],h=a[1],c=void 0===h?"":h;if(c.match(/^0+$/)&&(i||s))return l;var d=c.match(/0+$/);return s&&d?"".concat(l,".").concat(c.toString().slice(0,d.index)):n.toString()}(S.toString(),S,F,_,j);return e=tn=function(t,e,i,o){var s=t,n=r(s.toString().split("."),2),a=n[0],l=n[1];if(a.match(/^-?0$/)&&i)return l?"".concat(a.replace("0",""),".").concat(l):a.replace("0","");if(a.length<o)for(var h=o-a.length,c=0;c<h;c++)s="0".concat(s);return s.toString()}(tn,0,L,H),i=S,s=w,a=(n=y.currentDelimiters()).thousands,s=s||n.decimal,l=n.thousandsSize||3,d=(c=e.toString()).split(".")[0],g=c.split(".")[1],B&&(i<0&&(d=d.slice(1)),(function(t,e){for(var i=[],r=0,o=t;0<o;o--)r===e&&(i.unshift(o),r=0),r++;return i})(d.length,l).forEach(function(t,e){d=d.slice(0,t+e)+a+d.slice(t+e)}),i<0&&(d="-".concat(d))),tn=c=g?d+s+g:d,(N||z)&&(tn+=Y),(U||S<0)&&(to=tn,tn=0===(ts=S)?to:0==+to?to.replace("-",""):0<ts?"+".concat(to):"sign"===V?to:"(".concat(to.replace("-",""),")")),tn}function p(t,e){if(!t)return e;var i=Object.keys(t);return 1===i.length&&"output"===i[0]?e:t}e.exports=function(t){return{format:function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return c.apply(void 0,i.concat([t]))},getByteUnit:function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return(function(t){var e=l.general;return d(t._value,e.suffixes,e.scale).suffix}).apply(void 0,i.concat([t]))},getBinaryByteUnit:function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return(function(t){var e=l.binary;return d(t._value,e.suffixes,e.scale).suffix}).apply(void 0,i.concat([t]))},getDecimalByteUnit:function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return(function(t){var e=l.decimal;return d(t._value,e.suffixes,e.scale).suffix}).apply(void 0,i.concat([t]))},formatOrDefault:p}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,e,i){var r=t("./en-US"),o=t("./validating"),s=t("./parsing"),n={},a=void 0,l={},h=null,c={};function d(){return l[a]}n.languages=function(){return Object.assign({},l)},n.currentLanguage=function(){return a},n.currentCurrency=function(){return d().currency},n.currentAbbreviations=function(){return d().abbreviations},n.currentDelimiters=function(){return d().delimiters},n.currentOrdinal=function(){return d().ordinal},n.currentDefaults=function(){return Object.assign({},d().defaults,c)},n.currentOrdinalDefaultFormat=function(){return Object.assign({},n.currentDefaults(),d().ordinalFormat)},n.currentByteDefaultFormat=function(){return Object.assign({},n.currentDefaults(),d().byteFormat)},n.currentPercentageDefaultFormat=function(){return Object.assign({},n.currentDefaults(),d().percentageFormat)},n.currentCurrencyDefaultFormat=function(){return Object.assign({},n.currentDefaults(),d().currencyFormat)},n.currentTimeDefaultFormat=function(){return Object.assign({},n.currentDefaults(),d().timeFormat)},n.setDefaults=function(t){t=s.parseFormat(t),o.validateFormat(t)&&(c=t)},n.getZeroFormat=function(){return h},n.setZeroFormat=function(t){return h="string"==typeof t?t:null},n.hasZeroFormat=function(){return null!==h},n.languageData=function(t){if(t){if(l[t])return l[t];throw Error('Unknown tag "'.concat(t,'"'))}return d()},n.registerLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!o.validateLanguage(t))throw Error("Invalid language data");l[t.languageTag]=t,e&&(a=t.languageTag)},n.setLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:r.languageTag;if(!l[t]){var i=t.split("-")[0],o=Object.keys(l).find(function(t){return t.split("-")[0]===i});return l[o]?void(a=o):void(a=e)}a=t},n.registerLanguage(r),a=r.languageTag,e.exports=n},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,e,i){e.exports=function(e){return{loadLanguagesInNode:function(i){i.forEach(function(i){var r=void 0;try{r=t("../languages/".concat(i))}catch(t){console.error('Unable to load "'.concat(i,'". No matching language file found.'))}r&&e.registerLanguage(r)})}}}},{}],6:[function(t,e,i){var r=t("bignumber.js");function o(t,e,i){var o=new r(t._value),s=e;return i.isNumbro(e)&&(s=e._value),s=new r(s),t._value=o.minus(s).toNumber(),t}e.exports=function(t){return{add:function(e,i){var o,s;return o=new r(e._value),s=i,t.isNumbro(i)&&(s=i._value),s=new r(s),e._value=o.plus(s).toNumber(),e},subtract:function(e,i){return o(e,i,t)},multiply:function(e,i){var o,s;return o=new r(e._value),s=i,t.isNumbro(i)&&(s=i._value),s=new r(s),e._value=o.times(s).toNumber(),e},divide:function(e,i){var o,s;return o=new r(e._value),s=i,t.isNumbro(i)&&(s=i._value),s=new r(s),e._value=o.dividedBy(s).toNumber(),e},set:function(e,i){var r;return r=i,t.isNumbro(i)&&(r=i._value),e._value=r,e},difference:function(e,i){var r;return o(r=t(e._value),i,t),Math.abs(r._value)}}}},{"bignumber.js":1}],7:[function(t,e,i){function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=t("./globalState"),s=t("./validating"),n=t("./loading")(g),a=t("./unformatting"),l=t("./formatting")(g),h=t("./manipulating")(g),c=t("./parsing"),d=function(){var t,e;function i(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),this._value=t}return t=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return l.format(this,t)}},{key:"formatCurrency",value:function(t){return"string"==typeof t&&(t=c.parseFormat(t)),(t=l.formatOrDefault(t,o.currentCurrencyDefaultFormat())).output="currency",l.format(this,t)}},{key:"formatTime",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return t.output="time",l.format(this,t)}},{key:"binaryByteUnits",value:function(){return l.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return l.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return l.getByteUnit(this)}},{key:"difference",value:function(t){return h.difference(this,t)}},{key:"add",value:function(t){return h.add(this,t)}},{key:"subtract",value:function(t){return h.subtract(this,t)}},{key:"multiply",value:function(t){return h.multiply(this,t)}},{key:"divide",value:function(t){return h.divide(this,t)}},{key:"set",value:function(t){return h.set(this,u(t))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}],r(i.prototype,t),e&&r(i,e),i}();function u(t){var e=t;return g.isNumbro(t)?e=t._value:"string"==typeof t?e=g.unformat(t):isNaN(t)&&(e=NaN),e}function g(t){return new d(u(t))}g.version="2.1.2",g.isNumbro=function(t){return t instanceof d},g.language=o.currentLanguage,g.registerLanguage=o.registerLanguage,g.setLanguage=o.setLanguage,g.languages=o.languages,g.languageData=o.languageData,g.zeroFormat=o.setZeroFormat,g.defaultFormat=o.currentDefaults,g.setDefaults=o.setDefaults,g.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,g.validate=s.validate,g.loadLanguagesInNode=n.loadLanguagesInNode,g.unformat=a.unformat,e.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,e,i){e.exports={parseFormat:function(t){var e,i,r,o,s,n,a,l,h,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof t?t:(function(t,e){if(-1===t.indexOf("$")){if(-1===t.indexOf("%"))return -1!==t.indexOf("bd")?(e.output="byte",e.base="general"):-1!==t.indexOf("b")?(e.output="byte",e.base="binary"):-1!==t.indexOf("d")?(e.output="byte",e.base="decimal"):-1===t.indexOf(":")?-1!==t.indexOf("o")&&(e.output="ordinal"):e.output="time";e.output="percent"}else e.output="currency"}(t=(o=(r=t=(i=(e=t).match(/^{([^}]*)}/))?(c.prefix=i[1],e.slice(i[0].length)):e).match(/{([^}]*)}$/))?(c.postfix=o[1],r.slice(0,-o[0].length)):r,c),(s=t.match(/[1-9]+[0-9]*/))&&(c.totalLength=+s[0]),(n=t.split(".")[0].match(/0+/))&&(c.characteristic=n[0].length),function(t,e){if(-1!==t.indexOf(".")){var i=t.split(".")[0];e.optionalCharacteristic=-1===i.indexOf("0")}}(t,c),-1!==t.indexOf("a")&&(c.average=!0),-1!==(a=t).indexOf("K")?c.forceAverage="thousand":-1!==a.indexOf("M")?c.forceAverage="million":-1!==a.indexOf("B")?c.forceAverage="billion":-1!==a.indexOf("T")&&(c.forceAverage="trillion"),function(t,e){var i=t.split(".")[1];if(i){var r=i.match(/0+/);r&&(e.mantissa=r[0].length)}}(t,c),(l=t).match(/\[\.]/)?c.optionalMantissa=!0:l.match(/\./)&&(c.optionalMantissa=!1),-1!==t.indexOf(",")&&(c.thousandSeparated=!0),-1!==t.indexOf(" ")&&(c.spaceSeparated=!0),(h=t).match(/^\+?\([^)]*\)$/)&&(c.negative="parenthesis"),h.match(/^\+?-/)&&(c.negative="sign"),t.match(/^\+/)&&(c.forceSign=!0),c)}}},{}],9:[function(t,e,i){var r=[{key:"ZiB",factor:11805916207174113e5},{key:"ZB",factor:1e21},{key:"YiB",factor:12089258196146292e8},{key:"YB",factor:1e24},{key:"TiB",factor:1099511627776},{key:"TB",factor:1e12},{key:"PiB",factor:0x4000000000000},{key:"PB",factor:1e15},{key:"MiB",factor:1048576},{key:"MB",factor:1e6},{key:"KiB",factor:1024},{key:"KB",factor:1e3},{key:"GiB",factor:1073741824},{key:"GB",factor:1e9},{key:"EiB",factor:0x1000000000000000},{key:"EB",factor:1e18},{key:"B",factor:1}];function o(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}e.exports={unformat:function(e,i){var s,n,a,l=t("./globalState"),h=l.currentDelimiters(),c=l.currentCurrency().symbol,d=l.currentOrdinal(),u=l.getZeroFormat(),g=l.currentAbbreviations(),p=void 0;if("string"==typeof e)p=!function(t,e){if(!t.indexOf(":")||":"===e.thousands)return!1;var i=t.split(":");if(3!==i.length)return!1;var r=+i[0],o=+i[1],s=+i[2];return!isNaN(r)&&!isNaN(o)&&!isNaN(s)}(e,h)?function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",s=3<arguments.length?arguments[3]:void 0,n=4<arguments.length?arguments[4]:void 0,a=5<arguments.length?arguments[5]:void 0,l=6<arguments.length?arguments[6]:void 0;if(""!==t)return t===n?0:function t(e,i){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",n=3<arguments.length?arguments[3]:void 0,a=4<arguments.length?arguments[4]:void 0,l=5<arguments.length?arguments[5]:void 0,h=6<arguments.length?arguments[6]:void 0;if(!isNaN(+e))return+e;var c="",d=e.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(d!==e)return -1*t(d,i,s,n,a,l,h);for(var u=0;u<r.length;u++){var g=r[u];if((c=e.replace(g.key,""))!==e)return t(c,i,s,n,a,l,h)*g.factor}if((c=e.replace("%",""))!==e)return t(c,i,s,n,a,l,h)/100;var p=parseFloat(e);if(!isNaN(p)){var f=n(p);if(f&&"."!==f&&(c=e.replace(new RegExp("".concat(o(f),"$")),""))!==e)return t(c,i,s,n,a,l,h);var m={};Object.keys(l).forEach(function(t){m[l[t]]=t});for(var y=Object.keys(m).sort().reverse(),w=y.length,b=0;b<w;b++){var C=y[b],S=m[C];if((c=e.replace(C,""))!==e){var x=void 0;switch(S){case"thousand":x=1e3;break;case"million":x=1e6;break;case"billion":x=1e9;break;case"trillion":x=1e12}return t(c,i,s,n,a,l,h)*x}}}}(function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",r=t.replace(i,"");return(r=r.replace(RegExp("([0-9])".concat(o(e.thousands),"([0-9])"),"g"),"$1$2")).replace(e.decimal,".")}(t,e,i),e,i,s,n,a,l)}(e,h,c,d,u,g,i):(n=+(s=e.split(":"))[0],a=+s[1],+s[2]+60*a+3600*n);else{if("number"!=typeof e)return;p=e}if(void 0!==p)return p}}},{"./globalState":4}],10:[function(t,e,i){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=t("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(t,e){return"byte"===e.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(t){return"byte"===t.output}},characteristic:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(t){return 0<=t},message:"value must be positive"},{restriction:function(t,e){return!e.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(t,e){return"percent"===e.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},a={languageTag:{type:"string",mandatory:!0,restriction:function(t){return t.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function l(t){return!!o.unformat(t)}function h(t,e,i){var o,s=3<arguments.length&&void 0!==arguments[3]&&arguments[3],a=Object.keys(t).map(function(o){if(!e[o])return console.error("".concat(i," Invalid key: ").concat(o)),!1;var s=t[o],a=e[o];if("string"==typeof a&&(a={type:a}),"format"===a.type){if(!h(s,n,"[Validate ".concat(o,"]"),!0))return!1}else if(r(s)!==a.type)return console.error("".concat(i," ").concat(o,' type mismatched: "').concat(a.type,'" expected, "').concat(r(s),'" provided')),!1;if(a.restrictions&&a.restrictions.length)for(var l=a.restrictions.length,c=0;c<l;c++){var d=a.restrictions[c],u=d.restriction,g=d.message;if(!u(s,t))return console.error("".concat(i," ").concat(o," invalid value: ").concat(g)),!1}return a.restriction&&!a.restriction(s,t)?(console.error("".concat(i," ").concat(o," invalid value: ").concat(a.message)),!1):a.validValues&&-1===a.validValues.indexOf(s)?(console.error("".concat(i," ").concat(o," invalid value: must be among ").concat(JSON.stringify(a.validValues),', "').concat(s,'" provided')),!1):!a.children||!!h(s,a.children,"[Validate ".concat(o,"]"))});return s||a.push.apply(a,function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(o=Object.keys(e).map(function(r){var o=e[r];if("string"==typeof o&&(o={type:o}),o.mandatory){var s=o.mandatory;if("function"==typeof s&&(s=s(t)),s&&void 0===t[r])return console.error("".concat(i,' Missing mandatory key "').concat(r,'"')),!1}return!0}))||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(o)||function(){throw TypeError("Invalid attempt to spread non-iterable instance")}()),a.reduce(function(t,e){return t&&e},!0)}function c(t){return h(t,n,"[Validate format]")}e.exports={validate:function(t,e){var i=l(t),r=c(e);return i&&r},validateFormat:c,validateInput:l,validateLanguage:function(t){return h(t,a,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7);var eq=tn("guO5N");function h7(t,e){if((0,eq.isNumeric)(t)){let i=e.numericFormat,r=i&&i.culture||"-",s=i&&i.pattern;if(void 0!==r&&!o(h8).languages()[r]){let t=r.replace("-",""),e=o(h8).allLanguages?o(h8).allLanguages[r]:o(h8)[t];e&&o(h8).registerLanguage(e)}o(h8).setLanguage(r),t=o(h8)(t).format(s||"0")}return t}function ct(t,e,i,r,o,s,n){let a=s;if((0,eq.isNumeric)(a)){let t=n.className||"",i=t.length?t.split(" "):[];a=h7(a,n),0>i.indexOf("htLeft")&&0>i.indexOf("htCenter")&&0>i.indexOf("htRight")&&0>i.indexOf("htJustify")&&i.push("htRight"),0>i.indexOf("htNumeric")&&i.push("htNumeric"),n.className=i.join(" "),e.dir="ltr"}hI(t,e,i,r,o,a,n)}ct.RENDERER_TYPE="numeric";var tZ=tn("gFbQZ"),eq=tn("guO5N");function ce(t,e,i,r,o,s,n){hI.apply(this,[t,e,i,r,o,s,n]);let a=n.hashLength||e.innerHTML.length,l=n.hashSymbol||"*",h="";(0,eq.rangeEach)(a-1,()=>{h+=l}),(0,tZ.fastInnerHTML)(e,h)}function ci(t,e,i,r,o,s,n){hI.apply(this,[t,e,i,r,o,s,n])}function cr(t,e,i,r,o,s,n){hI.apply(this,[t,e,i,r,o,s,n]),e.dir="ltr"}function co(t,e){let i=t;if(null==i&&(i=""),this.allowEmpty&&""===i){e(!0);return}this.strict&&this.source?"function"==typeof this.source?this.source(i,cs(i,e)):cs(i,e)(this.source):e(!0)}function cs(t,e){return function(i){let r=!1;for(let e=0,o=i.length;e<o;e++)if(t===i[e]){r=!0;break}e(r)}}ce.RENDERER_TYPE="password",ci.RENDERER_TYPE="select",cr.RENDERER_TYPE="time",co.VALIDATOR_TYPE="autocomplete";var cn=tn("bTWiY");function ca(t,e){co.apply(this,[t,e])}ca.VALIDATOR_TYPE="dropdown";var eq=tn("guO5N");function cl(t,e){let i=t;null==i&&(i=""),e(!!this.allowEmpty&&""===i||""!==i&&(0,eq.isNumeric)(t))}cl.VALIDATOR_TYPE="numeric";var ch=tn("45fvw");const cc=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function cd(t,e){let i=this.timeFormat||"h:mm:ss a",r=!0,s=t;null===s&&(s=""),s=/^\d{3,}$/.test(s)?parseInt(s,10):s;let n=/^\d{1,2}$/.test(s);n&&(s+=":00");let a=o(ch)(s,cc,!0).isValid()?o(ch)(s):o(ch)(s,i),l=a.isValid(),h=o(ch)(s,i,!0).isValid()&&!n;if(this.allowEmpty&&""===s&&(l=!0,h=!0),l||(r=!1),!l&&h&&(r=!0),l&&!h){if(!0===this.correctFormat){let t=a.format(i),e=this.instance.toVisualRow(this.row),o=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(e,o,t,"timeValidator"),r=!0}else r=!1}e(r)}cd.VALIDATOR_TYPE="time";var hU=tn("iMgTM");function cu(t,e,i,r,o,s,n){hQ.apply(this,[t,e,i,r,o,s,n])}cu.RENDERER_TYPE="date";var cn=tn("bTWiY");const cg={CELL_TYPE:"date",editor:hU.DateEditor,renderer:cu,validator:cn.dateValidator};tn("1C6fS"),tn("1hIp0"),tn("1C6fS"),tn("1hIp0");var t3=tn("hwT6B"),eu=tn("ceXML"),il=tn("jxqWV"),t2=tn("1k8Ev");function cp(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function cf(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function cm(t,e){return t.get(cy(t,e))}function cy(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const cv=new Map([["plugin",function(t){return!!e9(t)}],["cell-type",lW],["editor",il.hasEditor],["renderer",ii],["validator",id]]),cw=[];let cb=null;var cC=new WeakMap,cS=new WeakSet;class cx{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(t){var e;cp(this,cS),cS.add(this),cf(this,"eventManager",new t2.default(this)),cf(this,"pluginName",null),cf(this,"pluginsInitializedCallbacks",[]),cf(this,"isPluginsReady",!1),cf(this,"enabled",!1),cf(this,"initialized",!1),e={},cp(this,cC),cC.set(this,e),(0,t3.defineGetter)(this,"hot",t,{writable:!1}),cb=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);let t=this.constructor.PLUGIN_DEPS,e=Array.isArray(t)?t:[];if(e.length>0){let t=[];if(e.forEach(e=>{let[i,r]=e.split(":");if(!cv.has(i))throw Error(`Unknown plugin dependency type "${i}" was found.`);cv.get(i)(r)||t.push(` - ${r} (${i})`)}),t.length>0){let e=`The ${this.pluginName} plugin requires the following modules:
${t.join("\n")}
`;cw.push(e)}}if(cb||(cb=e5()),cb.indexOf("UndoRedo")>=0&&cb.splice(cb.indexOf("UndoRedo"),1),cb.indexOf(this.pluginName)>=0&&cb.splice(cb.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),0===cb.length){if(cw.length>0)throw Error(`${cw.join("\n")}
You have to import and register them manually.`);this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var t;null===(t=this.eventManager)||void 0===t||t.clear(),this.clearHooks(),this.enabled=!1}addHook(t,e){cm(cC,this)[t]=cm(cC,this)[t]||[];let i=cm(cC,this)[t];this.hot.addHook(t,e),i.push(e),cm(cC,this)[t]=i}removeHooks(t){(0,eu.arrayEach)(cm(cC,this)[t]||[],e=>{this.hot.removeHook(t,e)})}clearHooks(){let t=cm(cC,this);(0,t3.objectEach)(t,(t,e)=>this.removeHooks(e)),t.length=0}callOnPluginsReady(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}onAfterPluginsInitialized(){(0,eu.arrayEach)(this.pluginsInitializedCallbacks,t=>t()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(t){let e=cy(cS,this,cE).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}updatePlugin(){}destroy(){var t;null===(t=this.eventManager)||void 0===t||t.destroy(),this.clearHooks(),(0,t3.objectEach)(this,(t,e)=>{"hot"!==e&&(this[e]=null)}),delete this.t,delete this.hot}}function cE(t){if(!t)return!1;let e=this.constructor.SETTING_KEYS;if("boolean"==typeof e)return e;for(let i=0;i<e.length;i++)if(void 0!==t[e[i]])return!0;return!1}var eu=tn("ceXML"),iv=tn("llu1T");tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),eu=tn("ceXML");function cR(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var cT=class{constructor(t){cR(this,"hot",null),cR(this,"container",null),cR(this,"injected",!1),cR(this,"rows",[]),cR(this,"columns",[]),cR(this,"samples",null),cR(this,"settings",{useHeaders:!0}),this.hot=t}addRow(t,e){if(this.columns.length)throw Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));let i={row:t};this.rows.push(i),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(t)),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(t){if(null!=this.hot.getColHeader(0)){let e={row:-1};this.rows.push(e),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),e.table=this.table.table}}addColumn(t,e){if(this.rows.length)throw Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));let i={col:t};this.columns.push(i),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(t){this.injected||this.injectTable(),(0,eu.arrayEach)(this.rows,e=>{t(e.row,(0,tZ.outerHeight)(e.table)-1)})}getWidths(t){this.injected||this.injectTable(),(0,eu.arrayEach)(this.columns,e=>{let{width:i}=e.table.getBoundingClientRect();t(e.col,Math.ceil(i))})}setSettings(t){this.settings=t}setSetting(t,e){this.settings||(this.settings={}),this.settings[t]=e}getSettings(){return this.settings}getSetting(t){return this.settings?this.settings[t]:null}createColGroupsCol(t){let e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{(0,eu.arrayEach)(i.strings,i=>{e.appendChild(this.createColElement(i.col,t))})}),e}createRow(t){let{rootDocument:e}=this.hot,i=e.createDocumentFragment(),r=e.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,r),i.appendChild(r)),this.samples.forEach(r=>{(0,eu.arrayEach)(r.strings,r=>{let o=r.col,s=this.hot.getCellMeta(t,o);s.col=o,s.row=t;let n=this.hot.getCellRenderer(s),a=e.createElement("td");a.setAttribute("ghost-table",1),n(this.hot,a,t,o,this.hot.colToProp(o),r.value,s),i.appendChild(a)})}),i}appendColumnHeadersRow(){let{rootDocument:t}=this.hot,e=t.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){let r=t.createElement("th");i.push([-1,r]),e.appendChild(r)}this.samples.forEach(r=>{(0,eu.arrayEach)(r.strings,r=>{let o=r.col,s=t.createElement("th");i.push([o,s]),e.appendChild(s)})}),this.table.tHead.appendChild(e),(0,eu.arrayEach)(i,t=>{let[e,i]=t;this.hot.view.appendColHeader(e,i)})}createCol(t){let{rootDocument:e}=this.hot,i=e.createDocumentFragment();return this.samples.forEach(r=>{(0,eu.arrayEach)(r.strings,r=>{let o=r.row,s=this.hot.getCellMeta(o,t);s.col=t,s.row=o;let n=this.hot.getCellRenderer(s),a=e.createElement("td"),l=e.createElement("tr");a.setAttribute("ghost-table",1),n(this.hot,a,o,t,this.hot.colToProp(t),r.value,s),l.appendChild(a),i.appendChild(l)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(t,e){let i=this.hot.rootDocument.createElement("col"),r=0;e>=0&&t>=0&&(r=this.hot.getCellMeta(e,t).colspan);let o=this.hot.getColWidth(t);if(r>1)for(let e=t+1;e<t+r;e++)o+=this.hot.getColWidth(e);return i.style.width=`${o}px`,i}createTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{rootDocument:e}=this.hot,i=e.createDocumentFragment(),r=e.createElement("table"),o=e.createElement("thead"),s=e.createElement("tbody"),n=e.createElement("colgroup"),a=e.createElement("tr"),l=e.createElement("th");return this.isVertical()&&r.appendChild(n),this.isHorizontal()&&(a.appendChild(l),o.appendChild(a),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&s.appendChild(a),r.appendChild(s),(0,tZ.addClass)(r,t),i.appendChild(r),{fragment:i,table:r,tHead:o,tBody:s,colGroup:n,tr:a,th:l}}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{rootDocument:e}=this.hot,i=e.createDocumentFragment(),r=e.createElement("div"),o=`htGhostTable htAutoSize ${t.trim()}`;return(0,tZ.addClass)(r,o),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}},nd=tn("10euP"),t3=tn("hwT6B"),eq=tn("guO5N");tn("1C6fS"),tn("1hIp0");var t3=tn("hwT6B"),eq=tn("guO5N"),tJ=tn("gnaTS");function cM(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class ck{static get SAMPLE_COUNT(){return 3}constructor(t){cM(this,"samples",null),cM(this,"dataFactory",null),cM(this,"customSampleCount",null),cM(this,"allowDuplicates",!1),this.dataFactory=t}getSampleCount(){return this.customSampleCount?this.customSampleCount:ck.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,e){return this.generateSamples("row",e,t)}generateColumnSamples(t,e){return this.generateSamples("col",e,t)}generateSamples(t,e,i){let r=new Map,{from:o,to:s}="number"==typeof i?{from:i,to:i}:i;return(0,eq.rangeEach)(o,s,i=>{let o=this.generateSample(t,e,i);r.set(i,o)}),r}generateSample(t,e,i){if("row"!==t&&"col"!==t)throw Error("Unsupported sample type");let r=new Map,o="row"===t?"col":"row",s=[];return(0,eq.rangeEach)(e.from,e.to,e=>{let n;let a="row"===t?this.dataFactory(i,e):this.dataFactory(e,i);if(!1===a)return;let{value:l,bundleSeed:h}=a,c="string"==typeof h&&h.length>0;n=c?h:(0,t3.isObject)(l)?`${Object.keys(l).length}`:Array.isArray(l)?`${l.length}`:`${(0,tJ.stringify)(l).length}`,r.has(n)||r.set(n,{needed:this.getSampleCount(),strings:[]});let d=r.get(n);d.needed&&(!(s.indexOf(l)>-1)||this.allowDuplicates||c)&&(d.strings.push({value:l,[o]:e}),s.push(l),d.needed-=1)}),r}}var eX=tn("bO142"),tJ=tn("gnaTS");function cA(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function cO(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function cP(t,e){return t.get(cI(t,e))}function cI(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(0,nd.default).getSingleton().register("modifyAutoColumnSizeSeed");const cH="autoColumnSize";var cL=new WeakMap,cD=new WeakSet;class cN extends cx{static get PLUGIN_KEY(){return cH}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){var e;super(t),cA(this,cD),cD.add(this),cO(this,"ghostTable",new cT(this.hot)),cO(this,"samplesGenerator",new ck((t,e)=>{let i=this.hot.toPhysicalRow(t),r=this.hot.toPhysicalColumn(e);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(r))return!1;let o=this.hot.getCellMeta(t,e),s="";o.spanned||(s=this.hot.getDataAtCell(t,e));let n="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(n=this.hot.runHooks("modifyAutoColumnSizeSeed",n,o,s)),{value:s,bundleSeed:n}})),cO(this,"firstCalculation",!0),cO(this,"inProgress",!1),cO(this,"measuredColumns",0),cO(this,"columnWidthsMap",new sY),e=[],cA(this,cL),cL.set(this,e),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",(t,e,i)=>cI(cD,this,cB).call(this,t,e,i))}isEnabled(){return!1!==this.hot.getSettings()[cH]&&!this.hot.getSettings().colWidths}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[cH];e&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return cI(cD,t,cF).call(t,...i)}),this.addHook("beforeChangeRender",t=>cI(cD,this,cj).call(this,t)),this.addHook("afterFormulasValuesUpdate",t=>cI(cD,this,cV).call(this,t)),this.addHook("beforeViewRender",t=>cI(cD,this,c_).call(this,t)),this.addHook("modifyColWidth",(t,e)=>this.getColumnWidth(e,t)),this.addHook("afterInit",()=>cI(cD,this,cW).call(this)),super.enablePlugin()}updatePlugin(){let t=this.findColumnsWhereHeaderWasChanged();t.length&&(this.clearCache(t),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(t,e,i)=>cI(cD,this,cB).call(this,t,e,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;let t=this.hot.renderCall,e=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();-1!==e&&-1!==i&&this.calculateColumnsWidth({from:e,to:i},void 0,t)}calculateColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="number"==typeof t?{from:t,to:t}:t,o="number"==typeof e?{from:e,to:e}:e;(0,eq.rangeEach)(r.from,r.to,t=>{let e=this.hot.toPhysicalColumn(t);if(null===e&&(e=t),i||null===this.columnWidthsMap.getValueAtIndex(e)&&!this.hot._getColWidthFromSettings(e)){let e=this.samplesGenerator.generateColumnSamples(t,o);(0,eu.arrayEach)(e,t=>{let[e,i]=t;return this.ghostTable.addColumn(e,i)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{let i=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(i,e)})},!0),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=0,i=this.hot.countCols()-1,r=null;this.inProgress=!0;let o=()=>{if(!this.hot){(0,iv.cancelAnimationFrame)(r),this.inProgress=!1;return}this.calculateColumnsWidth({from:e,to:Math.min(e+cN.CALCULATION_STEP,i)},t),(e=e+cN.CALCULATION_STEP+1)<i?r=(0,iv.requestAnimationFrame)(o):((0,iv.cancelAnimationFrame)(r),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},t),this.firstCalculation=!1,e=s+1),e<i?o():this.inProgress=!1}setSamplingOptions(){let t=this.hot.getSettings()[cH],e=t&&(0,t3.hasOwnProperty)(t,"samplingRatio")?t.samplingRatio:void 0,i=t&&(0,t3.hasOwnProperty)(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){let t=this.hot.getSettings()[cH],e=cN.SYNC_CALCULATION_LIMIT,i=this.hot.countCols()-1;return(0,t3.isObject)(t)&&(e=t.syncLimit,(0,eX.isPercentValue)(e)?e=(0,eq.valueAccordingPercent)(i,e):e>>=0),Math.min(e,i)}getColumnWidth(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=e;return void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),i&&"number"==typeof r&&(r=Math.max(r,oH.DEFAULT_WIDTH))),r}getFirstVisibleColumn(){let t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){let e=t.wtTable.getFirstVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){let e=t.wtTable.getFirstRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return -1}getLastVisibleColumn(){let t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){let e=t.wtTable.getLastVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){let e=t.wtTable.getLastRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return -1}findColumnsWhereHeaderWasChanged(){let t=this.hot.getColHeader();return(0,eu.arrayReduce)(t,(t,e,i)=>{let r=cP(cL,this).length;return(r-1<i||cP(cL,this)[i]!==e)&&t.push(i),r-1<i?cP(cL,this).push(e):cP(cL,this)[i]=e,t},[])}clearCache(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.batchExecution(()=>{(0,eu.arrayEach)(t,t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!(0,eu.arrayFilter)(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),t=>null===t).length}destroy(){this.ghostTable.clean(),super.destroy()}}function c_(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function cF(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function cj(t){let e=(0,eu.arrayMap)(t,t=>{let[,e]=t;return this.hot.toPhysicalColumn(this.hot.propToCol(e))});this.clearCache(Array.from(new Set(e)))}function cB(t,e,i){let r=t;return i&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function cW(){var t;t=this.hot.getColHeader(),cL.set(cI(cL,this),t)}function cV(t){let e=(0,eu.arrayFilter)(t,t=>{var e;return(0,tJ.isDefined)(null===(e=t.address)||void 0===e?void 0:e.col)}),i=(0,eu.arrayMap)(e,t=>t.address.col);this.clearCache(Array.from(new Set(i)))}tn("1C6fS"),tn("1hIp0");var nd=tn("10euP"),tZ=tn("gFbQZ"),eu=tn("ceXML"),tJ=tn("gnaTS"),t3=tn("hwT6B"),tJ=tn("gnaTS");const cU={horizontal:"horizontal",vertical:"vertical"};function cz(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function cY(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(0,nd.default).getSingleton().register("modifyAutofillRange"),(0,nd.default).getSingleton().register("beforeAutofill"),(0,nd.default).getSingleton().register("afterAutofill");const cG="autofill",c$=["fillHandle"];var cX=new WeakSet;function cq(){this.selectAdjacent()&&this.fillIn()}function cK(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function cZ(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function cQ(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function cJ(t){let e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}tn("1C6fS");var eu=tn("ceXML"),iv=tn("llu1T"),tZ=tn("gFbQZ"),t3=tn("hwT6B"),eq=tn("guO5N"),eX=tn("bO142");function c0(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function c1(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const c2="autoRowSize";var c3=new WeakSet;class c6 extends cx{static get PLUGIN_KEY(){return c2}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(t){super(t),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,c3),c3.add(this),c0(this,"headerHeight",null),c0(this,"ghostTable",new cT(this.hot)),c0(this,"samplesGenerator",new ck((t,e)=>{let i;let r=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(e);return!(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(o))&&(!(t>=0)||!(e>=0)||!this.hot.getCellMeta(t,e).hidden)&&(t>=0?i=this.hot.getDataAtCell(t,e):-1===t&&(i=this.hot.getColHeader(e)),{value:i})})),c0(this,"firstCalculation",!0),c0(this,"inProgress",!1),c0(this,"measuredRows",0),c0(this,"rowHeightsMap",new sY),this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",(t,e,i)=>c1(c3,this,c5).call(this,t,e,i))}isEnabled(){let t=this.hot.getSettings()[c2];return!0===t||(0,t3.isObject)(t)}enablePlugin(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return c1(c3,t,c9).call(t,...i)}),this.addHook("beforeChangeRender",t=>c1(c3,this,c8).call(this,t)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",t=>c1(c3,this,c4).call(this,t)),this.addHook("modifyRowHeight",(t,e)=>this.getRowHeight(e,t)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(t,e,i)=>c1(c3,this,c5).call(this,t,e,i))}calculateRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="number"==typeof t?{from:t,to:t}:t,o="number"==typeof e?{from:e,to:e}:e;if(null!==this.hot.getColHeader(0)){let t=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(t.get(-1))}(0,eq.rangeEach)(r.from,r.to,t=>{if(i||null===this.rowHeightsMap.getValueAtIndex(t)){let e=this.samplesGenerator.generateRowSamples(t,o);(0,eu.arrayEach)(e,t=>{let[e,i]=t;return this.ghostTable.addRow(e,i)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((t,e)=>{t<0?this.headerHeight=e:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(t),e)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=0,i=this.hot.countRows()-1,r=null;this.inProgress=!0;let o=()=>{if(!this.hot){(0,iv.cancelAnimationFrame)(r),this.inProgress=!1;return}this.calculateRowsHeight({from:e,to:Math.min(e+c6.CALCULATION_STEP,i)},t),(e=e+c6.CALCULATION_STEP+1)<i?r=(0,iv.requestAnimationFrame)(o):((0,iv.cancelAnimationFrame)(r),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},t),this.firstCalculation=!1,e=s+1),e<i?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){let t=this.hot.getSettings()[c2],e=t&&(0,t3.hasOwnProperty)(t,"samplingRatio")?t.samplingRatio:void 0,i=t&&(0,t3.hasOwnProperty)(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllRowsHeight(){(0,tZ.isVisible)(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){let t=this.hot.getSettings()[c2],e=c6.SYNC_CALCULATION_LIMIT,i=this.hot.countRows()-1;return(0,t3.isObject)(t)&&(e=t.syncLimit,(0,eX.isPercentValue)(e)?e=(0,eq.valueAccordingPercent)(i,e):e>>=0),Math.min(e,i)}getRowHeight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t)),r=e;return null!==i&&i>(e||0)&&(r=i),r}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){let t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){let t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(t){let{from:e,to:i}="number"==typeof t?{from:t,to:t}:t;this.hot.batchExecution(()=>{(0,eq.rangeEach)(Math.min(e,i),Math.max(e,i),t=>{this.rowHeightsMap.setValueAtIndex(t,null)})},!0)}isNeedRecalculate(){return!!(0,eu.arrayFilter)(this.rowHeightsMap.getValues().slice(0,this.measuredRows),t=>null===t).length}destroy(){this.ghostTable.clean(),super.destroy()}}function c4(){let t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,i=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(-1!==i&&-1!==r){if(this.calculateRowsHeight({from:i,to:r},void 0,t),e){let t=this.hot.countRows()-1;this.calculateRowsHeight({from:t-e,to:t})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function c5(t,e,i){let r=t;return i&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function c9(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function c8(t){let e=null;1===t.length?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}tn("1C6fS"),tn("1C6fS");const c7=new Map([["indexesSequence",{getListWithInsertedItems:s$,getListWithRemovedItems:sX}],["physicallyIndexed",{getListWithInsertedItems:sU,getListWithRemovedItems:sz}]]),dt=t=>{if(!1===c7.has(t))throw Error(`Alter strategy with ID '${t}' does not exist.`);return c7.get(t)},{getListWithInsertedItems:de,getListWithRemovedItems:di}=dt("physicallyIndexed");var dr=class extends sV{constructor(){super(t=>t)}insert(t,e){let i=sK(this.indexedValues,e);this.indexedValues=de(i,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){let e=di(this.indexedValues,t);this.indexedValues=sq(e,t),super.remove(t)}};const{getListWithInsertedItems:ds,getListWithRemovedItems:dn}=dt("physicallyIndexed");var da=class extends sV{constructor(){super(t=>t)}insert(t,e){this.indexedValues=ds(this.indexedValues,t,e,(t,e)=>this.getNextValue(e)),super.insert(t,e)}remove(t){this.indexedValues=dn(this.indexedValues,t),super.remove(t)}getNextValue(t){return Math.max(...this.getValues())+1+t}};const dl="bindRowsWithHeaders",dh=new Map([["loose",dr],["strict",da]]);var dc=new WeakSet;function dd(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}tn("1C6fS"),tn("1hIp0");var eu=tn("ceXML"),eq=tn("guO5N"),t6=tn("jlXkd"),tZ=tn("gFbQZ"),iy=tn("7HxIw"),iq=tn("4Pbrh");function du(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function dg(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function dp(t,e,i){return t.set(df(t,e),i),i}function df(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const dm="collapsibleColumns",dy=["nestedHeaders"],dv="collapsibleIndicator",dw=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var db=new WeakMap,dC=new WeakSet;function dS(t,e,i){var r,o;let{collapsible:s,origColspan:n,isCollapsed:a}=null!==(r=this.headerStateManager.getHeaderSettings(i,t))&&void 0!==r?r:{},l=s&&n>1&&t>=this.hot.getSettings().fixedColumnsStart,h=this.hot.getSettings().ariaTags,c=e.querySelector(`.${dv}`);(0,tZ.removeAttribute)(e,[(0,iq.A11Y_EXPANDED)("")[0]]),l?(c||(c=this.hot.rootDocument.createElement("div"),(0,tZ.addClass)(c,dv),e.querySelector("div:first-child").appendChild(c)),(0,tZ.removeClass)(c,["collapsed","expanded"]),a?((0,tZ.addClass)(c,"collapsed"),(0,tZ.fastInnerText)(c,"+"),h&&(0,tZ.setAttribute)(e,...(0,iq.A11Y_EXPANDED)(!1))):((0,tZ.addClass)(c,"expanded"),(0,tZ.fastInnerText)(c,"-"),h&&(0,tZ.setAttribute)(e,...(0,iq.A11Y_EXPANDED)(!0))),h&&(0,tZ.setAttribute)(c,...(0,iq.A11Y_HIDDEN)())):null===(o=c)||void 0===o||o.remove()}function dx(t,e){(0,tZ.hasClass)(t.target,dv)&&((0,tZ.hasClass)(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):(0,tZ.hasClass)(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),(0,iy.stopImmediatePropagation)(t))}function dE(){this.updatePlugin()}function dR(t,e){e||this.updatePlugin()}tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),tJ=tn("gnaTS"),t3=tn("hwT6B"),tQ=tn("f3221"),eu=tn("ceXML"),nd=tn("10euP");tn("1C6fS");var t3=tn("hwT6B"),tJ=tn("gnaTS");function dT(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const dM=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];class dk{constructor(t,e){dT(this,"hot",void 0),dT(this,"sortingStates",new sZ),dT(this,"sortEmptyCells",!1),dT(this,"indicator",!0),dT(this,"headerAction",!0),dT(this,"compareFunctionFactory",void 0),dT(this,"mapName",void 0),this.hot=t,this.mapName=e,this.hot.columnIndexMapper.registerMap(e,this.sortingStates)}updateAllColumnsProperties(t){(0,t3.isObject)(t)&&(0,t3.objectEach)(t,(t,e)=>{dM.includes(e)&&(this[e]=t)})}getAllColumnsProperties(){let t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}getSortOrderOfColumn(t){var e;return null===(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))||void 0===e?void 0:e.sortOrder}getIndexOfColumnInSortQueue(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex(e=>{let[i]=e;return i===t})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(t){return(0,t3.isObject)(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))}getSortStates(){return null===this.sortingStates?[]:this.sortingStates.getEntries().map(t=>{let[e,i]=t;return{column:this.hot.toVisualColumn(e),...i}})}getColumnSortState(t){let e=this.getSortOrderOfColumn(t);if((0,tJ.isDefined)(e))return{column:t,sortOrder:e}}setSortStates(t){this.sortingStates.clear();for(let e=0;e<t.length;e+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[e].column),{sortOrder:t[e].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}var t3=tn("hwT6B"),iy=tn("7HxIw");const dA="desc",dO="colHeader";function dP(t){return t===dA?void 0:"asc"===t?dA:"asc"}function dI(t){return t.querySelector(`.${dO}`)}function dH(t,e){if(t<0||!e.parentNode)return!1;let i=e.parentNode.parentNode.childNodes;return -1==Array.from(i).indexOf(e.parentNode)-i.length}function dL(t,e,i){return -1===t&&e>=0&&!1===(0,iy.isRightClick)(i)}tn("1hIp0");var tJ=tn("gnaTS");const dD="indicatorDisabled",dN="columnSorting",d_="sortAction",dF=new Map([["asc","ascending"],[dA,"descending"]]);var tJ=tn("gnaTS");function dj(t,e,i){let r=e.locale;return function(e,o){let{sortEmptyCells:s}=i;return("string"==typeof e&&(e=e.toLocaleLowerCase(r)),"string"==typeof o&&(o=o.toLocaleLowerCase(r)),e===o)?0:(0,tJ.isEmpty)(e)?(0,tJ.isEmpty)(o)?0:s&&"asc"===t?-1:1:(0,tJ.isEmpty)(o)?s&&"asc"===t?1:-1:isNaN(e)&&!isNaN(o)?"asc"===t?1:-1:!isNaN(e)&&isNaN(o)?"asc"===t?-1:1:(isNaN(e)||isNaN(o)||(e=parseFloat(e),o=parseFloat(o)),e<o)?"asc"===t?-1:1:e>o?"asc"===t?1:-1:0}}const dB="default";var tJ=(tn("gnaTS"),tn("gnaTS")),ch=tn("45fvw"),tJ=tn("gnaTS"),e7=tn("lSZ9A");const{register:dW,getItem:dV,hasItem:dU}=(0,e7.default)("sorting.compareFunctionFactory"),{register:dz,getItem:dY}=(0,e7.default)("sorting.mainSortComparator");function dG(t){return dU(t)?dV(t):dV(dB)}dW("numeric",function(t,e,i){return function(e,r){let o=parseFloat(e),s=parseFloat(r),{sortEmptyCells:n}=i;if(o===s||isNaN(o)&&isNaN(s))return 0;if(n){if((0,tJ.isEmpty)(e))return"asc"===t?-1:1;if((0,tJ.isEmpty)(r))return"asc"===t?1:-1}return isNaN(o)?1:isNaN(s)?-1:o<s?"asc"===t?-1:1:o>s?"asc"===t?1:-1:0}}),dW("checkbox",function(t,e,i){let r=e.checkedTemplate,o=e.uncheckedTemplate,{sortEmptyCells:s}=i;return function(n,a){let l=(0,tJ.isEmpty)(n),h=(0,tJ.isEmpty)(a),c=l?o:n,d=h?o:a,u=c===o||c===r,g=d===o||d===r;if(!1===s){if(l&&!1===h)return 1;if(!1===l&&h)return -1}return!1===u&&g?"asc"===t?-1:1:u&&!1===g?"asc"===t?1:-1:!1===u&&!1===g?dj(t,e,i)(n,a):c===o&&d===r?"asc"===t?-1:1:c===r&&d===o?"asc"===t?1:-1:0}}),dW("date",function(t,e,i){return function(r,s){let{sortEmptyCells:n}=i;if(r===s)return 0;if((0,tJ.isEmpty)(r))return(0,tJ.isEmpty)(s)?0:n&&"asc"===t?-1:1;if((0,tJ.isEmpty)(s))return n&&"asc"===t?1:-1;let a=e.dateFormat,l=o(ch)(r,a),h=o(ch)(s,a);return l.isValid()?h.isValid()?h.isAfter(l)?"asc"===t?-1:1:h.isBefore(l)?"asc"===t?1:-1:0:-1:1}}),dW(dB,dj);var iq=tn("4Pbrh");function d$(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function dX(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const dq="columnSorting",dK="append";dz(dq,function(t,e){return function(i,r){let[,...o]=i,[,...s]=r;return function(i){let r=t[0],n=e[0],a=o[0],l=s[i],h=n.columnSorting;return(h.compareFunctionFactory?h.compareFunctionFactory:dG(n.type))(r,n,h)(a,l)}(0)}}),(0,nd.default).getSingleton().register("beforeColumnSort"),(0,nd.default).getSingleton().register("afterColumnSort");var dZ=new WeakSet;class dQ extends cx{constructor(){super(...arguments),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,dZ),dZ.add(this),d$(this,"columnStatesManager",null),d$(this,"columnMetaCache",null),d$(this,"pluginKey",dq),d$(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return dq}static get PLUGIN_PRIORITY(){return 50}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var t=this;this.enabled||(this.columnStatesManager=new dk(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new sY(t=>{let e=this.hot.toVisualColumn(t);return null===e&&(e=t),this.getMergedPluginSettings(e)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,e)=>dX(dZ,this,d0).call(this,t,e)),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return dX(dZ,t,d2).call(t,...i)}),this.addHook("afterOnCellMouseDown",(t,e)=>this.onAfterOnCellMouseDown(t,e)),this.addHook("afterInit",()=>dX(dZ,this,dJ).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return dX(dZ,t,d1).call(t,...i)}),this.hot.view&&dX(dZ,this,dJ).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){let t=(t,e)=>{let i=dI(e);!1!==dH(t,e)&&null!==i&&this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",t)}),this.hot.batchExecution(()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{let{highlight:t}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(t.col)),!1},runOnlyIf:()=>{var t,e;let i=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return i&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(i)&&-1===i.row&&i.col>=0},relativeToGroup:hs,position:"before",group:dq})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dq)}sort(t){let e=this.getSortConfig(),i=this.getNormalizedSortConfigs(t),r=this.areValidSortConfigs(i);!1!==this.hot.runHooks("beforeColumnSort",e,i,r)&&(0===e.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new sJ),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",e,r?i:e,r),r&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(t){return(0,tJ.isDefined)(t)?this.columnStatesManager.getColumnSortState(t):this.columnStatesManager.getSortStates()}setSortConfig(t){let e=this.getNormalizedSortConfigs(t);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t]}areValidSortConfigs(t){let e=this.hot.countCols();return function(t){if(t.some(t=>!1===function(t){if(!1===(0,t3.isObject)(t))return!1;let{column:e,sortOrder:i}=t;return Number.isInteger(e)&&["asc",dA].includes(i)}(t)))return!1;let e=t.map(t=>{let{column:e}=t;return e});return new Set(e).size===e.length}(t)&&t.every(t=>{let{column:i}=t;return i<=e&&i>=0})}saveAllSortSettings(t){let e=this.columnStatesManager.getAllColumnsProperties();e.initialConfig=(0,eu.arrayMap)(t,t=>{let{column:e,...i}=t;return{column:this.hot.toPhysicalColumn(e),...i}}),this.hot.runHooks("persistentStateSave","columnSorting",e)}getAllSavedSortSettings(){let t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);let e=t.value;return(0,tJ.isDefined)(e)&&Array.isArray(e.initialConfig)&&(e.initialConfig=(0,eu.arrayMap)(e.initialConfig,t=>{let{column:e,...i}=t;return{column:this.hot.toVisualColumn(e),...i}})),e}getColumnNextConfig(t){let e=this.columnStatesManager.getSortOrderOfColumn(t);if((0,tJ.isDefined)(e)){let i=dP(e);return(0,tJ.isDefined)(i)?{column:t,sortOrder:i}:void 0}let i=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<i)return{column:t,sortOrder:dP()}}getNextSortConfig(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dK,i=this.columnStatesManager.getIndexOfColumnInSortQueue(t),r=-1!==i,o=this.getSortConfig(),s=this.getColumnNextConfig(t);if(r){if((0,tJ.isUndefined)(s))return[...o.slice(0,i),...o.slice(i+1)];if(e===dK)return[...o.slice(0,i),...o.slice(i+1),s];if("replace"===e)return[...o.slice(0,i),s,...o.slice(i+1)]}return(0,tJ.isDefined)(s)?o.concat(s):o}getPluginColumnConfig(t){if((0,t3.isObject)(t)){let e=t[this.pluginKey];if((0,t3.isObject)(e))return e}return{}}getMergedPluginSettings(t){let e=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),r=Object.getPrototypeOf(this.hot.getCellMeta(0,t));return Array.isArray(r.columns)?Object.assign(i,e,this.getPluginColumnConfig(r.columns[t])):(0,tQ.isFunction)(r.columns)?Object.assign(i,e,this.getPluginColumnConfig(r.columns(t))):Object.assign(i,e)}getFirstCellSettings(t){let e=Object.create(this.hot.getCellMeta(0,t));return e[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(t)),e}getNumberOfRowsToSort(t){let e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}sortByPresetSortStates(t){if(0===t.length){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}let e=[],i=this.hot.countRows(),r=e=>(0,eu.arrayMap)(t,t=>this.hot.getDataAtCell(e,t.column));for(let t=0;t<this.getNumberOfRowsToSort(i);t+=1)e.push([this.hot.toPhysicalRow(t)].concat(r(t)));let o=(0,eu.arrayMap)(e,t=>t[0]);!function(t,e){let i=dY(e);for(var r=arguments.length,o=Array(r>2?r-2:0),s=2;s<r;s++)o[s-2]=arguments[s];t.sort(i(...o))}(e,this.pluginKey,(0,eu.arrayMap)(t,t=>t.sortOrder),(0,eu.arrayMap)(t,t=>this.getFirstCellSettings(t.column)));for(let t=e.length;t<i;t+=1)e.push([t].concat(r(t)));let s=(0,eu.arrayMap)(e,t=>t[0]),n=new Map((0,eu.arrayMap)(o,(t,e)=>[t,s[e]])),a=(0,eu.arrayMap)(this.hot.rowIndexMapper.getIndexesSequence(),t=>n.has(t)?n.get(t):t);this.hot.rowIndexMapper.setIndexesSequence(a)}sortBySettings(t){if((0,t3.isObject)(t)){this.columnStatesManager.updateAllColumnsProperties(t);let e=t.initialConfig;(Array.isArray(e)||(0,t3.isObject)(e))&&this.sort(e)}else this.hot.render()}updateHeaderClasses(t){if((0,tZ.removeClass)(t,Array.from(dF.values()).concat(d_,dD,dN)),!1!==this.enabled){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];(0,tZ.addClass)(t,function(t,e,i,r){let o=[dN];if(r&&o.push(d_),!1===i)return o.push(dD),o;let s=t.getSortOrderOfColumn(e);return(0,tJ.isDefined)(s)&&o.push(dF.get(s)),o}(...i))}}onUpdateSettings(t){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),(0,tJ.isDefined)(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}wasClickableHeaderClicked(t,e){return this.getFirstCellSettings(e)[this.pluginKey].headerAction&&(0,tZ.hasClass)(t.target,dO)}onAfterOnCellMouseDown(t,e){!1!==dL(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col)),this.sort(this.getColumnNextConfig(e.col)))}destroy(){var t;null===(t=this.columnStatesManager)||void 0===t||t.destroy(),super.destroy()}}function dJ(){let t=this.getAllSavedSortSettings();if((0,t3.isObject)(t))this.sortBySettings(t);else{let t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}function d0(t,e){let i=dI(e);if(!1===dH(t,e)||null===i)return;let r=this.getFirstCellSettings(t)[this.pluginKey],o=r.indicator,s=r.headerAction;if(this.updateHeaderClasses(i,this.columnStatesManager,t,o,s),this.hot.getSettings().ariaTags){let i=this.columnStatesManager.getSortOrderOfColumn(t);(0,tZ.setAttribute)(e,...(0,iq.A11Y_SORT)(i?`${i}ending`:"none"))}}function d1(t){!0===t&&this.hot.view&&dX(dZ,this,dJ).call(this)}function d2(t,e,i,r){!1!==dL(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}tn("1C6fS");var t3=tn("hwT6B");tn("1C6fS"),tn("1hIp0");var eu=tn("ceXML"),t6=tn("jlXkd");function d3(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var d6=class{constructor(t,e){d3(this,"plugin",void 0),d3(this,"hot",void 0),d3(this,"endpoints",[]),d3(this,"settings",void 0),d3(this,"settingsType","array"),d3(this,"currentEndpoint",null),d3(this,"cellsToSetCache",[]),this.plugin=t,this.hot=this.plugin.hot,this.settings=e}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(t){return this.parseSettings(t.call(this))}parseSettings(t){let e=[],i=t;if(!i&&"function"==typeof this.settings){this.settingsType="function";return}return i||(i=this.settings),(0,eu.arrayEach)(i,t=>{let i={};this.assignSetting(t,i,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(t,i,"reversedRowCoords",!1),this.assignSetting(t,i,"destinationRow",Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(t,i,"destinationColumn",Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(t,i,"sourceColumn",t.destinationColumn),this.assignSetting(t,i,"type","sum"),this.assignSetting(t,i,"forceNumeric",!1),this.assignSetting(t,i,"suppressDataTypeErrors",!0),this.assignSetting(t,i,"customFunction",null),this.assignSetting(t,i,"readOnly",!0),this.assignSetting(t,i,"roundFloat",!1),e.push(i)}),e}assignSetting(t,e,i,r){if("ranges"===i&&void 0===t[i]){e[i]=r;return}if("ranges"!==i||0!==t[i].length){if(void 0===t[i]){if(r instanceof Error)throw r;e[i]=r}else"destinationRow"===i&&e.reversedRowCoords?e[i]=this.hot.countRows()-t[i]-1:e[i]=t[i]}}resetSetupBeforeStructureAlteration(t,e,i){if("function"!==this.settingsType)return;let r=t.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();(0,eu.arrayEach)(o,o=>{"row"===r&&o.destinationRow>=e&&("insert_row"===t?o.alterRowOffset=i:"remove_row"===t&&(o.alterRowOffset=-1*i)),"col"===r&&o.destinationColumn>=e&&("insert_col"===t?o.alterColumnOffset=i:"remove_col"===t&&(o.alterColumnOffset=-1*i))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(t,e,i,r,o){let s=!(arguments.length>5)||void 0===arguments[5]||arguments[5];if("function"===this.settingsType){let t=()=>(this.hot.removeHook("beforeViewRender",t),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",t);return}let n=t.indexOf("row")>-1?"row":"col",a=t.indexOf("remove")>-1?-1:1,l=this.getAllEndpoints(),h=0===t.indexOf("move_row");(0,eu.arrayEach)(l,t=>{"row"===n&&t.destinationRow>=e&&(t.alterRowOffset=a*i),"col"===n&&t.destinationColumn>=e&&(t.alterColumnOffset=a*i)}),this.resetAllEndpoints(l,!h),h?(0,eu.arrayEach)(l,t=>{this.extendEndpointRanges(t,e,r[0],r.length),this.recreatePhysicalRanges(t),this.clearOffsetInformation(t)}):(0,eu.arrayEach)(l,t=>{this.shiftEndpointCoordinates(t,e)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}extendEndpointRanges(t,e,i,r){(0,eu.arrayEach)(t.ranges,t=>{t[1]&&(e>=t[0]&&e<=t[1]?i>t[1]?t[1]+=r:i<t[0]&&(t[0]-=r):i>=t[0]&&i<=t[1]&&(t[1]-=r,e<=t[0]&&(t[0]+=1,t[1]+=1)))})}recreatePhysicalRanges(t){let e=t.ranges,i=[],r=[];(0,eu.arrayEach)(e,t=>{let e=[];if(t[1])for(let i=t[0];i<=t[1];i++)e.push(this.hot.toPhysicalRow(i));else e.push(this.hot.toPhysicalRow(t[0]));r.push(e)}),(0,eu.arrayEach)(r,t=>{let e=[];(0,eu.arrayEach)(t,(r,o)=>{0===o?e.push(r):t[o]!==t[o-1]+1&&(e.push(t[o-1]),i.push(e),(e=[]).push(r)),o===t.length-1&&(e.push(r),i.push(e))})}),t.ranges=i}shiftEndpointCoordinates(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,(0,eu.arrayEach)(t.ranges,i=>{(0,eu.arrayEach)(i,(r,o)=>{r>=e&&(i[o]+=t.alterRowOffset||0)})})):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}resetAllEndpoints(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];t.some(t=>{let e=t.alterRowOffset||0,i=t.alterColumnOffset||0;return!!(t.destinationRow+e>=this.hot.countRows()||t.destinationColumn+i>=this.hot.countCols())})||(this.cellsToSetCache=[],(0,eu.arrayEach)(t,t=>{this.resetEndpointValue(t,e)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],(0,eu.arrayEach)(this.getAllEndpoints(),t=>{this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(t){let e=[];this.cellsToSetCache=[],(0,eu.arrayEach)(t,(t,i,r)=>{`${t[2]||""}`!=`${t[3]}`&&(0,eu.arrayEach)(this.getAllEndpoints(),(t,o)=>{this.hot.propToCol(r[i][1])===t.sourceColumn&&-1===e.indexOf(o)&&e.push(o)})}),(0,eu.arrayEach)(e,t=>{this.refreshEndpoint(this.getEndpoint(t))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}resetEndpointValue(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=t.alterRowOffset||0,r=t.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(t.destinationRow+(e?i:0)),this.hot.toVisualColumn(t.destinationColumn+(e?r:0)),""])}setEndpointValue(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}let o=this.hot.toVisualRow(t.destinationRow);if(null!==o){let i=this.hot.getCellMeta(o,t.destinationColumn);("init"===e||i.readOnly!==t.readOnly)&&(i.readOnly=t.readOnly,i.className="columnSummaryResult")}if((!0===t.roundFloat||Number.isInteger(t.roundFloat))&&!isNaN(t.result)){let e=t.roundFloat,i=0;Number.isInteger(e)&&(i=Math.min(Math.max(0,e),100)),t.result=t.result.toFixed(i)}i?this.hot.setDataAtCell(r,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}throwOutOfBoundsWarning(){(0,t6.warn)("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}},iJ=tn("iCsRe");function d4(t){return null==t||isNaN(t)}function d5(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const d9="columnSummary";var d8=new WeakSet;function d7(){this.endpoints.initEndpoints()}function ut(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}function ue(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),iy=tn("7HxIw"),t3=tn("hwT6B");tn("1C6fS");var tZ=tn("gFbQZ");function ui(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class ur{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(t,e){ui(this,"rootDocument",void 0),ui(this,"isRtl",!1),ui(this,"container",null),ui(this,"editor",void 0),ui(this,"editorStyle",void 0),ui(this,"hidden",!0),this.rootDocument=t,this.isRtl=e,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(t,e){this.editorStyle.left=`${t}px`,this.editorStyle.top=`${e}px`}setSize(t,e){if(t&&e){let i=this.getInputElement();i.style.width=`${t}px`,i.style.height=`${e}px`}}getSize(){return{width:(0,tZ.outerWidth)(this.getInputElement()),height:(0,tZ.outerHeight)(this.getInputElement())}}resetSize(){let t=this.getInputElement();t.style.width="",t.style.height=""}setReadOnlyState(t){this.getInputElement().readOnly=t}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return"block"===this.editorStyle.display}setValue(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.getInputElement().value=t||""}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){let t=this.rootDocument.createElement("div"),e=this.rootDocument.createElement("textarea");return t.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),(0,tZ.addClass)(this.container,ur.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),(0,tZ.addClass)(t,ur.CLASS_EDITOR),(0,tZ.addClass)(e,ur.CLASS_INPUT),e.setAttribute("data-hot-input",!0),t.appendChild(e),this.container.appendChild(t),t}getInputElement(){return this.editor.querySelector(`.${ur.CLASS_INPUT}`)}destroy(){let t=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,t&&t.removeChild(this.container)}}tn("1C6fS");var tQ=tn("f3221"),t3=tn("hwT6B");function uo(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class us{constructor(t){uo(this,"wasLastActionShow",!0),uo(this,"showDebounced",null),uo(this,"hidingTimer",null),this.updateDelay(t)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")},250)}show(t){this.wasLastActionShow=!0,this.showDebounced(t)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=(0,tQ.debounce)(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},t)}destroy(){this.clearLocalHooks()}}(0,t3.mixin)(us,sB);var t3=tn("hwT6B"),eu=tn("ceXML");function un(t,e){let i={};return(0,eu.arrayEach)(t,t=>{t.forAll((t,r)=>{t>=0&&r>=0&&(i[t]||(i[t]=[]),i[t][r]=e(t,r))})}),i}function ua(t,e,i,r,o){(0,eu.arrayEach)(t,t=>{t.forAll((t,s)=>{t>=0&&s>=0&&function(t,e,i,r,o,s){let n=o(t,e),a=r;n.className&&(a="vertical"===i?function(t,e){if(-1!==t.indexOf(e))return t;let i=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return`${i} ${e}`}(n.className,r):function(t,e){if(-1!==t.indexOf(e))return t;let i=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return`${i} ${e}`}(n.className,r)),s(t,e,"className",a)}(t,s,e,i,r,o)})})}function ul(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function uh(t,e){let i=!1;return Array.isArray(t)&&(0,eu.arrayEach)(t,t=>(t.forAll((t,r)=>{if(t>=0&&r>=0&&e(t,r))return i=!0,!1}),i)),i}function uc(t,e){let i={top:0,left:0};if(e!==t.ownerDocument){let{frameElement:t}=e.defaultView,{top:r,left:o}=t.getBoundingClientRect();i.top=r,i.left=o}return i}const ud="---------",uu="alignment",ug="clear_column",up="col_left",uf="col_right";var eu=tn("ceXML");const um="make_read_only",uy="redo",uv="remove_col",uw="remove_row",ub="row_above",uC="row_below",uS="no_items",ux="undo",uE=[ub,uC,up,uf,ug,uw,uv,ux,uy,um,uu,ud,uS],uR={[ud]:function(){return{name:ud}},[uS]:function(){return{key:uS,name(){return this.getTranslatedPhrase(nv)},disabled:!0,isCommand:!1}},[ub]:function(){return{key:ub,name(){return this.getTranslatedPhrase(nw)},callback(){let t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()&&t.highlight.row<0)||(this.selection.isSelectedByCorner()?0===this.countRows():this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}},[uC]:function(){return{key:uC,name(){return this.getTranslatedPhrase(nb)},callback(){let t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()&&t.highlight.row<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}},[up]:function(){return{key:up,name(){return this.getTranslatedPhrase(nC)},callback(){let t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()&&t.highlight.col<0)||(this.selection.isSelectedByCorner()?0===this.countCols():this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}},[uf]:function(){return{key:uf,name(){return this.getTranslatedPhrase(nS)},callback(){let t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}},[ug]:function(){return{key:ug,name(){return this.getTranslatedPhrase(nk)},callback(t,e){let i=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,i,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByColumnHeader()}}},[uw]:function(){return{key:uw,name(){let t=this.getSelected(),e=0;if(t){if(t.length>1)e=1;else{let[i,,r]=t[0];i-r!=0&&(e=1)}}return this.getTranslatedPhrase(nx,e)},callback(){this.alter("remove_row",function(t){let e=lC(t.getSelected());if(0===e||1===e)return[];let i=lS(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;(0,eu.arrayEach)(t.getSelected(),t=>{let{from:e,to:o}=i(t),s=Math.max(e.row,0),n=o.row-s+1;(0,eu.arrayEach)(Array.from(Array(n),(t,e)=>s+e),t=>{r.has(t)||r.add(t)})});let o=Array.from(r).sort((t,e)=>t-e);return(0,eu.arrayReduce)(o,(t,e,i,r)=>(0!==i&&e===r[i-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t),[])}(this),1,"ContextMenu.removeRow")},disabled(){let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;let e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden(){return!this.getSettings().allowRemoveRow}}},[uv]:function(){return{key:uv,name(){let t=this.getSelected(),e=0;if(t){if(t.length>1)e=1;else{let[,i,,r]=t[0];i-r!=0&&(e=1)}}return this.getTranslatedPhrase(nE,e)},callback(){this.alter("remove_col",function(t){let e=lC(t.getSelected());if(0===e||1===e)return[];let i=lS(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;(0,eu.arrayEach)(t.getSelected(),t=>{let{from:e,to:o}=i(t),s=Math.max(e.col,0),n=o.col-s+1;(0,eu.arrayEach)(Array.from(Array(n),(t,e)=>s+e),t=>{r.has(t)||r.add(t)})});let o=Array.from(r).sort((t,e)=>t-e);return(0,eu.arrayReduce)(o,(t,e,i,r)=>(0!==i&&e===r[i-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t),[])}(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;let e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}},[ux]:function(){return{key:ux,name(){return this.getTranslatedPhrase(nR)},callback(){this.undo()},hidden(){let t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[uy]:function(){return{key:uy,name(){return this.getTranslatedPhrase(nT)},callback(){this.redo()},hidden(){let t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[um]:function(){return{key:um,name(){let t=this.getTranslatedPhrase(nM);return uh(this.getSelectedRange(),(t,e)=>this.getCellMeta(t,e).readOnly)&&(t=ul(t)),t},callback(){let t=this.getSelectedRange(),e=uh(t,(t,e)=>this.getCellMeta(t,e).readOnly);(0,eu.arrayEach)(t,t=>{t.forAll((t,i)=>{t>=0&&i>=0&&this.setCellMeta(t,i,"readOnly",!e)})}),this.render()},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner())||0===this.countRows()||0===this.countCols()||!this.getSelectedRange()||0===this.getSelectedRange().length}}},[uu]:function(){return{key:uu,name(){return this.getTranslatedPhrase(nV)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader())||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${uu}:left`,name(){let t=this.getTranslatedPhrase(nU);return uh(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htLeft"))return!0})&&(t=ul(t)),t},callback(){let t=this.getSelectedRange(),e=un(t,(t,e)=>this.getCellMeta(t,e).className),i="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,i,r),ua(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${uu}:center`,name(){let t=this.getTranslatedPhrase(nz);return uh(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htCenter"))return!0})&&(t=ul(t)),t},callback(){let t=this.getSelectedRange(),e=un(t,(t,e)=>this.getCellMeta(t,e).className),i="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,i,r),ua(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${uu}:right`,name(){let t=this.getTranslatedPhrase(nY);return uh(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htRight"))return!0})&&(t=ul(t)),t},callback(){let t=this.getSelectedRange(),e=un(t,(t,e)=>this.getCellMeta(t,e).className),i="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,i,r),ua(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${uu}:justify`,name(){let t=this.getTranslatedPhrase(nG);return uh(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htJustify"))return!0})&&(t=ul(t)),t},callback(){let t=this.getSelectedRange(),e=un(t,(t,e)=>this.getCellMeta(t,e).className),i="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,i,r),ua(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{name:ud},{key:`${uu}:top`,name(){let t=this.getTranslatedPhrase(n$);return uh(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htTop"))return!0})&&(t=ul(t)),t},callback(){let t=this.getSelectedRange(),e=un(t,(t,e)=>this.getCellMeta(t,e).className),i="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,i,r),ua(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${uu}:middle`,name(){let t=this.getTranslatedPhrase(nX);return uh(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htMiddle"))return!0})&&(t=ul(t)),t},callback(){let t=this.getSelectedRange(),e=un(t,(t,e)=>this.getCellMeta(t,e).className),i="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,i,r),ua(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${uu}:bottom`,name(){let t=this.getTranslatedPhrase(nq);return uh(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htBottom"))return!0})&&(t=ul(t)),t},callback(){let t=this.getSelectedRange(),e=un(t,(t,e)=>this.getCellMeta(t,e).className),i="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,i,r),ua(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1}]}}}};function uT(){let t={};return(0,t3.objectEach)(uR,(e,i)=>{t[i]=e()}),t}function uM(t,e,i){uk(t,e),e.set(t,i)}function uk(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function uA(t,e,i){return t.set(uP(t,e),i),i}function uO(t,e){return t.get(uP(t,e))}function uP(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const uI="comments",uH="comment",uL="value",uD="style",uN="readOnly",u_=`plugin:${uI}`;var uF=new WeakMap,uj=new WeakMap,uB=new WeakMap,uW=new WeakMap,uV=new WeakMap,uU=new WeakMap,uz=new WeakMap,uY=new WeakSet;function uG(t){if(this.hot.view&&this.hot.view._wt&&!uO(uB,this)&&!this.targetIsCommentTextArea(t)){let e=(0,tZ.closest)(t.target,"TD","TBODY"),i=null;e&&(i=this.hot.getCoords(e)),(!e||this.range.from&&i&&(this.range.from.row!==i.row||this.range.from.col!==i.col))&&this.hide()}}function u$(t){let{rootDocument:e}=this.hot;if(!(uO(uB,this)||uO(uF,this).isFocused()||(0,tZ.hasClass)(t.target,"wtBorder"))&&uO(uU,this)!==t.target&&uO(uF,this)){if(uA(uU,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){let e=this.hot._createCellRange(this.hot.getCoords(t.target));uO(uj,this).show(e)}else(0,tZ.isChildOf)(t.target,e)&&!this.targetIsCommentTextArea(t)&&uO(uj,this).hide()}}function uX(){uA(uB,this,!1)}function uq(t,e){e[uH]&&e[uH][uL]&&(0,tZ.addClass)(t,e.commentedCellClassName)}function uK(){uA(uz,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function uZ(){uA(uz,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(u_)}function uQ(t){uA(uV,this,{width:(0,tZ.outerWidth)(t.target),height:(0,tZ.outerHeight)(t.target)})}function uJ(t){let e=(0,tZ.outerWidth)(t.target),i=(0,tZ.outerHeight)(t.target);(e!==uO(uV,this).width+1||i!==uO(uV,this).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[uD]:{width:e,height:i}})}function u0(t){uO(uF,this).isVisible()&&(0,iy.stopImmediatePropagation)(t)}function u1(){uO(uW,this)||this.hide()}tn("1C6fS");var nd=tn("10euP"),eu=tn("ceXML"),t3=tn("hwT6B");tn("1C6fS"),tn("1hIp0");var tl=tn("hmx0d"),eA=tn("dZoqA"),os=tn("ptmgx"),u2=tn("6BH0Y"),u3={},u6=tn("chuuX"),u4=TypeError;u3=function(t,e){if(!delete t[e])throw new u4("Cannot delete property "+u6(e)+" of "+u6(t))};var u5=tn("6Rnn4");tl({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}()},{unshift:function(t){var e=eA(this),i=os(e),r=arguments.length;if(r){u5(i+r);for(var o=i;o--;){var s=o+r;o in e?e[s]=e[o]:u3(e,s)}for(var n=0;n<r;n++)e[n]=arguments[n]}return u2(e,i+r)}});var eu=tn("ceXML"),t3=tn("hwT6B");function u9(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class u8{constructor(t){u9(this,"hot",void 0),u9(this,"commands",{}),u9(this,"commonCallback",null),this.hot=t}registerCommand(t,e){this.commands[t]=e}setCommonCallback(t){this.commonCallback=t}execute(t){let e;for(var i,r=arguments.length,o=Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];let n=t.split(":"),a=n[0],l=2===n.length?n[1]:null,h=this.commands[a];if(!h)throw Error(`Menu command '${a}' not exists.`);if(l&&h.submenu&&(i=h.submenu.items,(0,eu.arrayEach)(i,t=>{let i=t.key?t.key.split(":"):null;if(Array.isArray(i)&&i[1]===l)return e=t,!1}),h=e),!0===h.disabled||"function"==typeof h.disabled&&!0===h.disabled.call(this.hot)||(0,t3.hasOwnProperty)(h,"submenu"))return;let c=[];"function"==typeof h.callback&&c.push(h.callback),"function"==typeof this.commonCallback&&c.push(this.commonCallback),o.unshift(n.join(":")),(0,eu.arrayEach)(c,t=>t.apply(this.hot,o))}}tn("1C6fS"),tn("1hIp0");var t3=tn("hwT6B"),eu=tn("ceXML");function u7(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class gt{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;u7(this,"hot",void 0),u7(this,"predefinedItems",uT()),u7(this,"defaultOrderPattern",void 0),this.hot=t,this.defaultOrderPattern=e}setPredefinedItems(t){let e={};this.defaultOrderPattern.length=0,(0,t3.objectEach)(t,(t,i)=>{let r="";t.name===ud?(e[ud]=t,r=ud):(isNaN(parseInt(i,10))?(t.key=void 0===t.key?i:t.key,e[i]=t):e[t.key]=t,r=t.key),this.defaultOrderPattern.push(r)}),this.predefinedItems=e}getItems(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],o=t;return o&&o.items?o=o.items:Array.isArray(o)||(o=e),(0,t3.isObject)(o)?(0,t3.objectEach)(o,(t,e)=>{let o=i["string"==typeof t?t:e];o||(o=t),(0,t3.isObject)(t)?(0,t3.extend)(o,t):"string"==typeof o&&(o={name:o}),void 0===o.key&&(o.key=e),r.push(o)}):(0,eu.arrayEach)(o,(t,e)=>{let o=i[t];!o&&uE.indexOf(t)>=0||(o||(o={name:t,key:`${e}`}),(0,t3.isObject)(t)&&(0,t3.extend)(o,t),void 0===o.key&&(o.key=e),r.push(o))}),r}(t,this.defaultOrderPattern,this.predefinedItems)}}function ge(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}tn("1C6fS"),tn("1hIp0"),tn("1C6fS"),tn("1C6fS");class gi{constructor(t,e){let i,r,o,s,n,a;ge(this,"top",void 0),ge(this,"topRelative",void 0),ge(this,"left",void 0),ge(this,"leftRelative",void 0),ge(this,"scrollTop",void 0),ge(this,"scrollLeft",void 0),ge(this,"cellHeight",void 0),ge(this,"cellWidth",void 0);let l=e.scrollY,h=e.scrollX;this.rootWindow=e,this.type=this.getSourceType(t),"literal"===this.type?(i=parseInt(t.top,10),o=parseInt(t.left,10),n=t.height||0,a=t.width||0,r=i,s=o,i+=l,o+=h):"event"===this.type&&(i=parseInt(t.pageY,10),o=parseInt(t.pageX,10),n=t.target.clientHeight,a=t.target.clientWidth,r=i-l,s=o-h),this.top=i,this.topRelative=r,this.left=o,this.leftRelative=s,this.scrollTop=l,this.scrollLeft=h,this.cellHeight=n,this.cellWidth=a}getSourceType(t){let e="literal";return t instanceof Event&&(e="event"),e}fitsAbove(t){return this.topRelative>=t.offsetHeight}fitsBelow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}fitsOnRight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}fitsOnLeft(t){return this.leftRelative>=t.offsetWidth}}function gr(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function go(t,e){return t.get(gn(t,e))}function gs(t,e,i){return t.set(gn(t,e),i),i}function gn(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var ga=new WeakMap,gl=new WeakMap,gh=new WeakMap,gc=new WeakMap,gd=new WeakMap;class gu{constructor(t){gr(this,ga,void 0),gr(this,gl,void 0),gr(this,gh,void 0),gr(this,gc,!1),gr(this,gd,{above:0,below:0,left:0,right:0}),gs(gc,this,t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return go(gd,this)[t]=e,this}setElement(t){return gs(ga,this,t),this}setParentElement(t){return gs(gl,this,t),this}updatePosition(t){gs(gh,this,new gi(t,go(ga,this).ownerDocument.defaultView)),go(gc,this)?(go(gh,this).fitsBelow(go(ga,this))?this.setPositionBelowCursor():go(gh,this).fitsAbove(go(ga,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===go(ga,this).dir?go(gh,this).fitsOnLeft(go(ga,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():go(gh,this).fitsOnRight(go(ga,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let t=go(gd,this).above+go(gh,this).top-go(ga,this).offsetHeight;go(gl,this)&&(t=go(gh,this).top+go(gh,this).cellHeight-go(ga,this).offsetHeight+3),go(ga,this).style.top=`${t}px`}setPositionBelowCursor(){let t=go(gd,this).below+go(gh,this).top+1;go(gl,this)&&(t=go(gh,this).top-1),go(ga,this).style.top=`${t}px`}setPositionOnRightOfCursor(){let t=go(gh,this).left;if(go(gl,this)){let{right:e}=go(gl,this).getBoundingClientRect();t+=go(gh,this).cellWidth+e-(go(gh,this).left+go(gh,this).cellWidth)}else t+=go(gd,this).right;go(ga,this).style.left=`${t}px`}setPositionOnLeftOfCursor(){let t=go(gd,this).left+go(gh,this).left-go(ga,this).offsetWidth;if(go(gl,this)){let{left:e}=go(gl,this).getBoundingClientRect();t-=go(gh,this).left-e}go(ga,this).style.left=`${t}px`}}var eq=tn("guO5N");function gg(t){let{initialPage:e=-1,size:i=()=>0,onItemSelect:r=()=>{},onClear:o=()=>{}}=t,s=new Set,n=(0,eq.clamp)(e,-1,l()-1);function a(t,e){let i=l()-1;return(t<0&&(t=i),t>i&&(t=0),s.has(t))?-1:(s.add(t),!1===r(t,!1)&&(t=a(1===e?++t:--t,e)),t)}function l(){return Math.max(i(),0)}return{setCurrentPage:function(t){t>-1&&t<l()&&!1!==r(t,!0)&&(n=t)},getCurrentPage:function(){return n},toFirstItem:function(){l()>0&&(s.clear(),n=a(0,1))},toLastItem:function(){l()>0&&(s.clear(),n=a(l()-1,-1))},toNextItem:function(){l()>0&&(s.clear(),n=a(++n,1))},toPreviousItem:function(){l()>0&&(s.clear(),n=a(--n,-1))},getSize:l,clear:function(){s.clear(),n=e,o()}}}tn("1hIp0");var eu=tn("ceXML"),t3=tn("hwT6B"),tZ=tn("gFbQZ");function gp(t){return(0,t3.hasOwnProperty)(t,"submenu")}function gf(t){return RegExp(ud,"i").test(t.name)}function gm(t,e){return!0===t.disabled||"function"==typeof t.disabled&&!0===t.disabled.call(e)}function gy(t){return(0,t3.hasOwnProperty)(t,"disableSelection")}function gv(t,e){let i=t.slice(0);for(;0<i.length&&i[0].name===e;)i.shift();return i}tn("1hIp0");const gw="menu";var t2=tn("1k8Ev"),eu=tn("ceXML"),t0=tn("eL8cl"),tZ=tn("gFbQZ"),iy=tn("7HxIw"),tQ=tn("f3221"),tJ=tn("gnaTS"),t3=tn("hwT6B"),tZ=tn("gFbQZ"),iq=(tn("4Pbrh"),tn("4Pbrh"));function gb(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function gC(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function gS(t,e,i){return t.set(gE(t,e),i),i}function gx(t,e){return t.get(gE(t,e))}function gE(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var gR=new WeakMap,gT=new WeakMap;class gM{constructor(t,e){var i=this;gC(this,"hot",void 0),gC(this,"options",void 0),gC(this,"eventManager",new t2.default(this)),gC(this,"container",void 0),gC(this,"positioner",void 0),gC(this,"hotMenu",null),gC(this,"hotSubMenus",{}),gC(this,"parentMenu",void 0),gC(this,"menuItems",null),gC(this,"origOutsideClickDeselects",null),gb(this,gR,void 0),gb(this,gT,void 0),this.hot=t,this.options=e||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new gu(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.parentMenu.runLocalHooks("afterSelectionChange",...e)})}registerEvents(){let t=this.hot.rootWindow;for(;t;)this.eventManager.addEventListener(t.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(t.document,"contextmenu",t=>this.onDocumentContextMenu(t)),t=(0,tZ.getParentWindow)(t)}setMenuItems(t){this.menuItems=t}getNavigator(){return gx(gR,this)}getKeyboardShortcutsCtrl(){return gx(gT,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){var t,e;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";let i=(0,tQ.debounce)(t=>this.openSubMenu(t),300),r=this.options.minWidth||215,o=!1,s=(0,eu.arrayFilter)(this.menuItems,t=>{var e;return t.key===uS&&(o=!0),e=this.hot,!t.hidden||!("function"==typeof t.hidden&&t.hidden.call(e))});if(s.length<1&&!o)s.push(uT()[uS]);else if(0===s.length)return;s=function(t){let e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ud,r=t.slice(0);return(e=(r=gv(r,i)).slice(0)).reverse(),(e=gv(e,i)).reverse(),r=function(t){let e=[];return(0,eu.arrayEach)(t,(t,i)=>{i>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}(r=e)}(s,ud);let n=!1,a={data:s,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:t=>(0,tJ.isDefined)(t)&&t<r?r:t,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(t=this.hot,(e,i,r,o,s,n)=>{if(i.hasAttribute("ghost-table"))return;let a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),h="function"==typeof n?n.call(t):n;if((0,tZ.empty)(i),(0,tZ.addClass)(l,"htItemWrapper"),t.getSettings().ariaTags){let e=!gm(a,t)&&!gy(a)&&!gf(a);(0,tZ.setAttribute)(i,[(0,iq.A11Y_MENU_ITEM)(),(0,iq.A11Y_LABEL)(h),...e?[(0,iq.A11Y_TABINDEX)(-1)]:[],...gm(a,t)?[(0,iq.A11Y_DISABLED)()]:[],...gp(a)?[(0,iq.A11Y_EXPANDED)(!1)]:[]])}i.className="",i.appendChild(l),gf(a)?(0,tZ.addClass)(i,"htSeparator"):"function"==typeof a.renderer?((0,tZ.addClass)(i,"htCustomMenuRenderer"),i.appendChild(a.renderer(e,l,r,o,s,h))):(0,tZ.fastInnerHTML)(l,h),gm(a,t)?(0,tZ.addClass)(i,"htDisabled"):gy(a)?(0,tZ.addClass)(i,"htSelectionDisabled"):gp(a)&&(0,tZ.addClass)(i,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(t,e)=>{gx(gR,this).setCurrentPage(e.row)},afterOnCellMouseOver:(t,e)=>{this.isAllSubMenusClosed()?i(e.row):this.openSubMenu(e.row)},rowHeights:t=>s[t].name===ud?1:23,afterOnCellContextMenu:t=>{t.preventDefault(),(0,t0.isWindowsOS)()&&n&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(t,e,i,r,o)=>{this.hotMenu.view.isMouseDown()&&(o.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:t=>{this.hasSelectedItem()&&(n=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(t))},afterOnCellMouseUp:t=>{(!(0,t0.isWindowsOS)()||!(0,iy.isRightClick)(t))&&n&&this.hasSelectedItem()&&((0,t0.isMobileBrowser)()||(0,t0.isIpadOS)()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,a),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),gS(gR,this,(e=this.hotMenu,gg({size:()=>e.countRows(),onItemSelect(t,i){let r=e.getCell(t,0);if(!r||(0,tZ.hasClass)(r,"htSeparator")||(0,tZ.hasClass)(r,"htDisabled")||(0,tZ.hasClass)(r,"htSelectionDisabled"))return!1;e.selectCell(t,0,...i?[t,0,!1,!1]:[])},onClear(){e.deselectCell()}}))),gS(gT,this,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];function r(t,e){n(e).addShortcuts(t,{group:gw})}function o(t,e){let o=n(e);t.forEach(t=>{let{keys:e}=t;e.forEach(t=>o.removeShortcutsByKeys(t))}),i.push({shortcuts:t,contextName:e}),r(t,e)}function s(t){return t?`${gw}:${t}`:gw}function n(e){var i;let r=t.hotMenu.getShortcutManager(),o=s(e);return null!==(i=r.getContext(o))&&void 0!==i?i:r.addContext(o)}return r(function(t){let{hot:e,hotMenu:i}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,r)=>{let o=e.getSettings(),s="function"==typeof o.tabMoves?o.tabMoves(i):o.tabMoves;r.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{let e=i.getSelectedLast();if(e){let i=t.openSubMenu(e[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{i.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{let r=i.getSelectedLast();r&&(i.getSourceDataAtRow(r[0]).submenu?t.openSubMenu(r[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{i.getSelectedLast()?i.selection.transformStart(-i.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{i.getSelectedLast()?i.selection.transformStart(i.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}(t)),e.forEach(t=>{let{shortcuts:e,contextName:i}=t;o(e,i)}),{addCustomShortcuts:o,getCustomShortcuts:function(){return[...i]},getContext:n,listen:function(e){t.hotMenu.getShortcutManager().setActiveContextName(s(e))}}}(this)),gx(gT,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened()){if(t&&this.isSubMenu())this.parentMenu.close();else if(gx(gR,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){let t=this.parentMenu.hotMenu.getSelectedLast();if(t){let e=this.parentMenu.hotMenu.getCell(t[0],0);(0,tZ.setAttribute)(e,[(0,iq.A11Y_EXPANDED)(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(t){if(!this.hotMenu)return!1;let e=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!e||!(0,tZ.hasClass)(e,"htSubmenu"))return!1;let i=this.hotMenu.getSourceDataAtRow(t),r=new gM(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(e.getBoundingClientRect()),this.hotSubMenus[i.key]=r,this.hot.getSettings().ariaTags&&(0,tZ.setAttribute)(e,[(0,iq.A11Y_EXPANDED)(!0)]),r}closeSubMenu(t){let e=this.hotMenu.getSourceDataAtRow(t),i=this.hotSubMenus[e.key];if(i){i.destroy(),delete this.hotSubMenus[e.key];let r=this.hotMenu.getCell(t,0);this.hot.getSettings().ariaTags&&(0,tZ.setAttribute)(r,[(0,iq.A11Y_EXPANDED)(!1)])}}closeAllSubMenus(){(0,eu.arrayEach)(this.hotMenu.getData(),(t,e)=>this.closeSubMenu(e))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){let t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(t){if(!this.isOpened()||!this.hasSelectedItem())return;let e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),this.isCommandPassive(e))return;let i=this.hot.getSelectedRange(),r=i?(0,eu.arrayMap)(i,t=>({start:t.getTopStartCorner(),end:t.getBottomEndCorner()})):[];this.runLocalHooks("executeCommand",e.key,r,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,r,t)}isCommandPassive(t){return!1===t.isCommand||gf(t)||gm(t,this.hot)||gp(t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(t,e)}setPosition(t){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(t)}createContainer(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this.options.container.ownerDocument,r=e;return r&&((0,tQ.isFunction)(r)&&(r=null===(r=r.call(this.hot))||(0,tJ.isUndefined)(r)?"":r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,t=i.querySelector(`.${this.options.className}.${r}`)),t||(t=i.createElement("div"),(0,tZ.addClass)(t,`htMenu ${this.options.className}`),r&&(0,tZ.addClass)(t,r),this.options.container.appendChild(t)),t}onAfterInit(){let{wtTable:t}=this.hotMenu.view._wt,e=this.hotMenu.getSettings().data,i=t.hider.style,r=t.holder.style,o=parseInt(i.width,10),s=(0,eu.arrayReduce)(e,(t,e)=>t+(e.name===ud?1:26),0);r.width=`${o+3}px`,r.height=`${s+3}px`,i.height=r.height,this.hot.getSettings().ariaTags&&(0,tZ.setAttribute)(this.hotMenu.rootElement,[(0,iq.A11Y_MENU)(),(0,iq.A11Y_TABINDEX)(-1)])}onDocumentMouseDown(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!(0,tZ.isChildOf)(t.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!(0,tZ.isChildOf)(t.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(t){this.isOpened()&&(0,tZ.hasClass)(t.target,"htCore")&&(0,tZ.isChildOf)(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}(0,t3.mixin)(gM,sB);var tZ=tn("gFbQZ");function gk(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function gA(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const gO="contextMenu";(0,nd.default).getSingleton().register("afterContextMenuDefaultOptions"),(0,nd.default).getSingleton().register("beforeContextMenuShow"),(0,nd.default).getSingleton().register("afterContextMenuShow"),(0,nd.default).getSingleton().register("afterContextMenuHide"),(0,nd.default).getSingleton().register("afterContextMenuExecute");var gP=new WeakSet;class gI extends cx{constructor(){super(...arguments),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,gP),gP.add(this),gk(this,"commandExecutor",new u8(this.hot)),gk(this,"itemsFactory",null),gk(this,"menu",null)}static get PLUGIN_KEY(){return gO}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[ub,uC,ud,up,uf,ud,uw,uv,ud,ux,uy,ud,um,ud,uu]}isEnabled(){return!!this.hot.getSettings()[gO]}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[gO];"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new gM(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>gA(gP,this,gL).call(this)),this.menu.addLocalHook("afterOpen",()=>gA(gP,this,gD).call(this)),this.menu.addLocalHook("afterClose",()=>gA(gP,this,gN).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.executeCommand.call(t,...i)}),this.addHook("afterOnCellContextMenu",t=>gA(gP,this,gH).call(this,t)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{let{highlight:t}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();let e=this.hot.getCell(t.row,t.col,!0).getBoundingClientRect(),i=uc(this.menu.container,this.hot.rootDocument);this.open({left:e.left+i.left,top:e.top+i.top-1+e.height},{left:e.width,above:-e.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&!this.menu.isOpened()},group:gO})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gO)}open(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.prepareMenuItems(),this.menu.open(),(0,t3.objectEach)(i,(t,e)=>{this.menu.setOffset(e,t)}),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close(),this.itemsFactory=null}executeCommand(t){null===this.itemsFactory&&this.prepareMenuItems();for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];this.commandExecutor.execute(t,...i)}prepareMenuItems(){this.itemsFactory=new gt(this.hot,gI.DEFAULT_ITEMS);let t=this.hot.getSettings()[gO],e={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",e),this.itemsFactory.setPredefinedItems(e.items);let i=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),(0,eu.arrayEach)(i,t=>this.commandExecutor.registerCommand(t.key,t))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function gH(t){let e=this.hot.getSettings(),i=e.rowHeaders,r=e.colHeaders,o=t.target;if(this.close(),(0,tZ.hasClass)(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(i||r)&&!("TD"===o.nodeName||"TD"===o.parentNode.nodeName)&&!((0,tZ.hasClass)(o,"current")&&(0,tZ.hasClass)(o,"wtBorder"))))return;let s=uc(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function gL(){this.hot.runHooks("beforeContextMenuShow",this)}function gD(){this.hot.runHooks("afterContextMenuShow",this)}function gN(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}gI.SEPARATOR={name:ud},tn("1C6fS"),tn("1hIp0");var nd=tn("10euP"),eu=tn("ceXML"),eX=tn("bO142"),tZ=tn("gFbQZ"),t0=tn("eL8cl"),eq=(tn("guO5N"),tn("guO5N"),tn("guO5N"));class g_{constructor(){this.data={}}setData(t,e){this.data[t]=e}getData(t){return this.data[t]||void 0}}class gF{constructor(){this.clipboardData=new g_}}tn("1C6fS"),tn("1hIp0");var eu=tn("ceXML"),eq=tn("guO5N");function gj(t,e,i){gB(t,e),e.set(t,i)}function gB(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function gW(t,e){return t.get(gU(t,e))}function gV(t,e,i){return t.set(gU(t,e),i),i}function gU(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var gz=new WeakMap,gY=new WeakMap,gG=new WeakMap,g$=new WeakMap,gX=new WeakMap,gq=new WeakMap,gK=new WeakSet;class gZ{constructor(t){let{countRows:e,countColumns:i,rowsLimit:r,columnsLimit:o,countColumnHeaders:s}=t;gB(this,gK),gK.add(this),gj(this,gz,void 0),gj(this,gY,void 0),gj(this,gG,void 0),gj(this,g$,void 0),gj(this,gX,void 0),gj(this,gq,void 0),gV(gY,this,e),gV(gG,this,i),gV(g$,this,r),gV(gX,this,o),gV(gq,this,s)}setSelectedRange(t){gV(gz,this,t)}getCellsRange(){if(0===gW(gY,this).call(this)||0===gW(gG,this).call(this))return null;let{row:t,col:e}=gW(gz,this).getTopStartCorner(),{row:i,col:r}=gW(gz,this).getBottomEndCorner(),o=gU(gK,this,gJ).call(this,t,i),s=gU(gK,this,gQ).call(this,e,r);return{isRangeTrimmed:i!==o||r!==s,startRow:t,startCol:e,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(0===gW(gG,this).call(this)||0===gW(gq,this).call(this))return null;let{col:t}=gW(gz,this).getTopStartCorner(),{col:e}=gW(gz,this).getBottomEndCorner(),i=gU(gK,this,gQ).call(this,t,e);return{isRangeTrimmed:e!==i,startRow:-1,startCol:t,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(0===gW(gG,this).call(this)||0===gW(gq,this).call(this))return null;let{col:t}=gW(gz,this).getTopStartCorner(),{col:e}=gW(gz,this).getBottomEndCorner(),i=gU(gK,this,gQ).call(this,t,e);return{isRangeTrimmed:e!==i,startRow:-gW(gq,this).call(this),startCol:t,endRow:-1,endCol:i}}}function gQ(t,e){return Math.min(e,Math.max(t+gW(gX,this).call(this)-1,t))}function gJ(t,e){return Math.min(e,Math.max(t+gW(g$,this).call(this)-1,t))}function g0(t){let e=[],i=[];return(0,eu.arrayEach)(t,t=>{let r=Math.min(t.startRow,t.endRow),o=Math.max(t.startRow,t.endRow);(0,eq.rangeEach)(r,o,t=>{-1===e.indexOf(t)&&e.push(t)});let s=Math.min(t.startCol,t.endCol),n=Math.max(t.startCol,t.endCol);(0,eq.rangeEach)(s,n,t=>{-1===i.indexOf(t)&&i.push(t)})}),{rows:e,columns:i}}function g1(t,e,i){g2(t,e),e.set(t,i)}function g2(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function g3(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function g6(t,e){return t.get(g5(t,e))}function g4(t,e,i){return t.set(g5(t,e),i),i}function g5(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(0,nd.default).getSingleton().register("afterCopyLimit"),(0,nd.default).getSingleton().register("modifyCopyableRange"),(0,nd.default).getSingleton().register("beforeCut"),(0,nd.default).getSingleton().register("afterCut"),(0,nd.default).getSingleton().register("beforePaste"),(0,nd.default).getSingleton().register("afterPaste"),(0,nd.default).getSingleton().register("beforeCopy"),(0,nd.default).getSingleton().register("afterCopy");const g9="copyPaste",g8=["fragmentSelection"],g7='<meta name="generator" content="Handsontable"/><style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>';var pt=new WeakMap,pe=new WeakMap,pi=new WeakMap,pr=new WeakMap,po=new WeakMap,ps=new WeakMap,pn=new WeakMap,pa=new WeakMap,pl=new WeakSet;function ph(t){if((0,t0.isSafari)()){let e=this.hot.getSelectedRangeLast();if(e){let{row:i,col:r}=e.highlight,o=this.hot.getCell(i,r,!0);o&&(0,tZ.runWithSelectedContendEditableElement)(o,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function pc(t){let{rows:e}=g0(t),i=0;for(let t=0;t<e.length&&!(e[t]>=0);t++)i+=1;return{columnHeadersCount:i}}function pd(){if(this.hot.isListening()){let t=this.hot.getSelectedRangeLast();if(t){let{row:e,col:i}=t.highlight,r=this.hot.getCell(e,i,!0);r&&(0,tZ.makeElementContentEditableAndSelectItsContent)(r)}}}function pu(){if(this.hot.isListening()){let t=this.hot.getSelectedRangeLast();if(t){let{row:e,col:i}=t.highlight,r=this.hot.getCell(e,i,!0);null!=r&&r.hasAttribute("contenteditable")&&(0,tZ.removeContentEditableFromElementAndDeselect)(r)}}}function pg(t){var e,i,r,o,s;t.items.push({name:"---------"},(e=this,{key:"copy",name(){return this.getTranslatedPhrase(nA)},callback(){e.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1})),g6(pt,this)&&t.items.push((i=this,{key:"copy_with_column_headers",name(){let t=this.getSelectedRangeLast(),e=t?(0,eq.clamp)(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(nO,e)},callback(){i.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1})),g6(pe,this)&&t.items.push((r=this,{key:"copy_with_column_group_headers",name(){let t=this.getSelectedRangeLast(),e=t?(0,eq.clamp)(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(nP,e)},callback(){r.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1})),g6(pi,this)&&t.items.push((o=this,{key:"copy_column_headers_only",name(){let t=this.getSelectedRangeLast(),e=t?(0,eq.clamp)(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(nI,e)},callback(){o.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1})),t.items.push((s=this,{key:"cut",name(){return this.getTranslatedPhrase(nH)},callback(){s.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1}))}function pp(t,e,i,r,o){g6(pa,this)&&(o.value=!0),g4(pa,this,!1)}function pf(){!this.isEditorOpened()&&(this.hot.getSettings().fragmentSelection||this.setCopyableText())}function pm(){g5(pl,this,pu).call(this)}function py(){g5(pl,this,pd).call(this)}function pv(){g5(pl,this,pu).call(this)}tn("1C6fS"),tn("1hIp0");var t3=tn("hwT6B"),eq=tn("guO5N"),eu=tn("ceXML"),t3=tn("hwT6B"),tJ=tn("gnaTS"),eu=tn("ceXML");function pw(t,e){return`border_row${t}col${e}`}function pb(){return{width:1,color:"#000"}}function pC(){return{hide:!0}}function pS(t){var e,i;return((0,tJ.isDefined)(t.start)||(0,tJ.isDefined)(t.left))&&(t.start=null!==(e=t.start)&&void 0!==e?e:t.left),((0,tJ.isDefined)(t.end)||(0,tJ.isDefined)(t.right))&&(t.end=null!==(i=t.end)&&void 0!==i?i:t.right),delete t.left,delete t.right,t}function px(t){return(0,tJ.isDefined)(t.start)&&(t.left=t.start),(0,tJ.isDefined)(t.end)&&(t.right=t.end),t}function pE(t,e){return{id:pw(t,e),border:{width:1,color:"#000",cornerVisible:!1},row:t,col:e,top:pC(),bottom:pC(),start:pC(),end:pC()}}function pR(t,e){let i=!1;return(0,eu.arrayEach)(t.getSelectedRange(),r=>{r.forAll((r,o)=>{if(r<0||o<0)return;let s=t.getCellMeta(r,o).borders;if(s&&(!e||!(0,t3.hasOwnProperty)(s[e],"hide")||!1===s[e].hide))return i=!0,!1})}),i}function pT(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}const pM=new Map([["left","start"],["right","end"]]);function pk(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const pA="customBorders";var pO=new WeakSet;function pP(t){if(this.hot.getSettings()[pA]){var e,i,r;t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(nK)},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader())||this.selection.isSelectedByCorner()},submenu:{items:[(e=this,{key:"borders:top",name(){let t=this.getTranslatedPhrase(nZ);return pR(this,"top")&&(t=pT(t)),t},callback(t,i){let r=pR(this,"top");e.prepareBorder(i,"top",r)}}),function(t){let e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(nQ);return pR(this,e)&&(t=pT(t)),t},callback(i,r){let o=pR(this,e);t.prepareBorder(r,e,o)}}}(this),(i=this,{key:"borders:bottom",name(){let t=this.getTranslatedPhrase(nJ);return pR(this,"bottom")&&(t=pT(t)),t},callback(t,e){let r=pR(this,"bottom");i.prepareBorder(e,"bottom",r)}}),function(t){let e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(n0);return pR(this,e)&&(t=pT(t)),t},callback(i,r){let o=pR(this,e);t.prepareBorder(r,e,o)}}}(this),(r=this,{key:"borders:no_borders",name(){return this.getTranslatedPhrase(n1)},callback(t,e){r.prepareBorder(e,"noBorders")},disabled(){return!pR(this)}})]}})}}function pI(){this.changeBorderSettings()}tn("1C6fS");var iy=tn("7HxIw"),tZ=tn("gFbQZ");function pH(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function pL(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const pD="dragToScroll";var pN=new WeakSet;function p_(t){if((0,iy.isRightClick)(t))return;let e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((t,i)=>{var r,o;let s=null!==(r=e.scrollLeft)&&void 0!==r?r:e.scrollX,n=null!==(o=e.scrollTop)&&void 0!==o?o:e.scrollY;e.scroll(s+50*Math.sign(t),n+20*Math.sign(i))}),this.listen()}tn("1C6fS");var eu=tn("ceXML"),t3=tn("hwT6B"),tZ=tn("gFbQZ"),nd=tn("10euP"),iq=tn("4Pbrh");function pF(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function pj(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function pB(t,e,i){return t.set(pW(t,e),i),i}function pW(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(0,nd.default).getSingleton().register("afterDropdownMenuDefaultOptions"),(0,nd.default).getSingleton().register("beforeDropdownMenuShow"),(0,nd.default).getSingleton().register("afterDropdownMenuShow"),(0,nd.default).getSingleton().register("afterDropdownMenuHide"),(0,nd.default).getSingleton().register("afterDropdownMenuExecute");const pV="dropdownMenu",pU="changeType";var pz=new WeakMap,pY=new WeakSet;class pG extends cx{static get PLUGIN_KEY(){return pV}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[up,uf,ud,uv,ud,ug,ud,um,ud,uu]}constructor(t){super(t),pF(this,pY),pY.add(this),pj(this,"commandExecutor",new u8(this.hot)),pj(this,"itemsFactory",null),pj(this,"menu",null),pF(this,pz),pz.set(this,!1),this.hot.addHook("afterGetColHeader",(t,e)=>pW(pY,this,pq).call(this,t,e))}isEnabled(){return this.hot.getSettings()[pV]}enablePlugin(){var t=this;if(this.enabled)return;this.itemsFactory=new gt(this.hot,pG.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pW(pY,t,p1).call(t,...i)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pW(pY,t,p0).call(t,...i)});let e=this.hot.getSettings()[pV],i={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);let r=this.itemsFactory.getItems(e);this.menu&&this.menu.destroy(),this.menu=new gM(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>pW(pY,this,pK).call(this)),this.menu.addLocalHook("afterOpen",()=>pW(pY,this,pZ).call(this)),this.menu.addLocalHook("afterSubmenuOpen",t=>pW(pY,this,pQ).call(this,t)),this.menu.addLocalHook("afterClose",()=>pW(pY,this,pJ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.executeCommand.call(t,...i)}),(0,eu.arrayEach)(r,t=>this.commandExecutor.registerCommand(t.key,t))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){let t=this.hot.getShortcutManager().getContext("grid"),e=()=>{let{highlight:t}=this.hot.getSelectedRangeLast();if((t.isHeader()&&-1===t.row||t.isCell())&&t.col>=0){this.hot.selectColumns(t.col,t.col,-1);let{from:e}=this.hot.getSelectedRangeLast(),i=uc(this.menu.container,this.hot.rootDocument),r=this.hot.getCell(-1,e.col,!0),o=r.getBoundingClientRect();this.open({left:o.left+i.left,top:o.top+r.offsetHeight+i.top},{left:o.width}),this.menu.getNavigator().toFirstItem()}};t.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:e,runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:pV},{keys:[["Shift","Alt","ArrowDown"]],callback:e,runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isCell()&&!this.menu.isOpened()},group:pV}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(pV)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",t=>pW(pY,this,pX).call(this,t))}open(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.menu.open(),(0,t3.objectEach)(i,(t,e)=>{this.menu.setOffset(e,t)}),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close()}executeCommand(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];this.commandExecutor.execute(t,...i)}setListening(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function p$(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function pX(t){if((0,tZ.hasClass)(t.target,pU)){let e=uc(this.menu.container,this.hot.rootDocument),i=t.target.getBoundingClientRect();t.stopPropagation(),pB(pz,this,!1),this.open({left:i.left+e.left,top:i.top+t.target.offsetHeight+3+e.top},{left:i.width})}}function pq(t,e){let i=e.parentNode;if(!i)return;let r=i.parentNode.childNodes,o=Array.prototype.indexOf.call(r,i);if(t<0||o!==r.length-1)return;let s=e.querySelector(`.${pU}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}let n=this.hot.rootDocument.createElement("button");n.className=pU,n.type="button",n.tabIndex=-1,this.hot.getSettings().ariaTags&&((0,tZ.setAttribute)(n,[(0,iq.A11Y_HIDDEN)(),(0,iq.A11Y_LABEL)(" ")]),(0,tZ.setAttribute)(e,[(0,iq.A11Y_HASPOPUP)("menu")])),n.onclick=function(){return!1},e.firstChild.insertBefore(n,e.firstChild.firstChild)}function pK(){this.hot.runHooks("beforeDropdownMenuShow",this)}function pZ(){this.hot.runHooks("afterDropdownMenuShow",this),pW(pY,this,p$).call(this,this.menu)}function pQ(t){pW(pY,this,p$).call(this,t)}function pJ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function p0(t){return pz.get(pW(pz,this))?null:t}function p1(t){(0,tZ.hasClass)(t.target,pU)&&pB(pz,this,!0)}pG.SEPARATOR={name:ud},tn("1C6fS"),tn("1C6fS"),tn("1hIp0");var eq=tn("guO5N");function p2(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var p3=class{constructor(t){p2(this,"hot",void 0),p2(this,"options",{}),this.hot=t}setOptions(t){this.options=t}getData(){let{startRow:t,startCol:e,endRow:i,endCol:r}=this._getDataRange(),o=this.options,s=[];return(0,eq.rangeEach)(t,i,t=>{let i=[];!o.exportHiddenRows&&this._isHiddenRow(t)||((0,eq.rangeEach)(e,r,e=>{!o.exportHiddenColumns&&this._isHiddenColumn(e)||i.push(this.hot.getDataAtCell(t,e))}),s.push(i))}),s}getRowHeaders(){let t=[];if(this.options.rowHeaders){let{startRow:e,endRow:i}=this._getDataRange(),r=this.hot.getRowHeader();(0,eq.rangeEach)(e,i,e=>{!this.options.exportHiddenRows&&this._isHiddenRow(e)||t.push(r[e])})}return t}getColumnHeaders(){let t=[];if(this.options.columnHeaders){let{startCol:e,endCol:i}=this._getDataRange(),r=this.hot.getColHeader();(0,eq.rangeEach)(e,i,e=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(e)||t.push(r[e])})}return t}_getDataRange(){let t=this.hot.countCols()-1,e=this.hot.countRows()-1,[i=0,r=0,o=e,s=t]=this.options.range;return{startRow:i=Math.max(i,0),startCol:r=Math.max(r,0),endRow:o=Math.min(o,e),endCol:s=Math.min(s,t)}}_isHiddenRow(t){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(t))}_isHiddenColumn(t){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(t))}},eu=tn("ceXML"),tJ=tn("gnaTS");tn("1C6fS");var t3=tn("hwT6B"),eX=tn("bO142");function p6(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class p4{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(t,e){p6(this,"dataProvider",void 0),p6(this,"options",void 0),this.dataProvider=t,this.options=this._mergeOptions(e),this.dataProvider.setOptions(this.options)}_mergeOptions(t){let e=(0,t3.clone)(this.constructor.DEFAULT_OPTIONS),i=new Date;return e=(0,t3.extend)((0,t3.clone)(p4.DEFAULT_OPTIONS),e),(e=(0,t3.extend)(e,t)).filename=(0,eX.substitute)(e.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),e}}var p5=p4;const p9={csv:class extends p5{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){let t=this.options,e=this.dataProvider.getData(),i=this.dataProvider.getColumnHeaders(),r=i.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0,n=t.bom?String.fromCharCode(65279):"";return r&&(i=(0,eu.arrayMap)(i,t=>this._escapeCell(t,!0)),s&&(n+=t.columnDelimiter),n+=i.join(t.columnDelimiter)+t.rowDelimiter),(0,eu.arrayEach)(e,(e,i)=>{i>0&&(n+=t.rowDelimiter),s&&(n+=this._escapeCell(o[i])+t.columnDelimiter),n+=e.map(t=>this._escapeCell(t)).join(t.columnDelimiter)}),n}_escapeCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=(0,tJ.stringify)(t);return""!==i&&(e||i.indexOf("\r")>=0||i.indexOf('"')>=0||i.indexOf("\n")>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(RegExp('"',"g"),'""'),i=`"${i}"`),i}}};tn("1C6fS"),tn("1hIp0");var eu=tn("ceXML"),iJ=tn("iCsRe"),t6=tn("jlXkd"),eq=tn("guO5N"),tZ=tn("gFbQZ"),iL=tn("bCtEl");tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),iy=tn("7HxIw"),eu=tn("ceXML"),iL=tn("bCtEl"),t3=tn("hwT6B");tn("1C6fS");var eu=tn("ceXML"),t3=tn("hwT6B");function p8(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class p7{constructor(t,e){let{id:i,stateless:r=!0}=e;p8(this,"hot",void 0),p8(this,"id",void 0),p8(this,"elements",[]),p8(this,"hidden",!1),p8(this,"stateId",""),p8(this,"state",void 0),this.hot=t,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new sZ)}getElements(){return this.elements}reset(){(0,eu.arrayEach)(this.elements,t=>t.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(t){this.state&&this.setState(this.state.getValueAtIndex(t))}setState(){throw Error("The state setting logic is not implemented")}saveState(t){this.state&&this.state.setValueAtIndex(t,this.getState())}getState(){throw Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),(0,eu.arrayEach)(this.elements,t=>t.destroy()),this.state=null,this.elements=null,this.hot=null}}(0,t3.mixin)(p7,sB),tn("1hIp0");var t3=tn("hwT6B"),eu=tn("ceXML");tn("1C6fS");const ft={};function fe(t,e){if(!ft[t])throw Error(`Filter condition "${t}" does not exist.`);let{condition:i,descriptor:r}=ft[t],o=e;return r.inputValuesDecorator&&(o=r.inputValuesDecorator(o)),function(t){return i.apply(t.meta.instance,[].concat([t],[o]))}}function fi(t){if(!ft[t])throw Error(`Filter condition "${t}" does not exist.`);return ft[t].descriptor}function fr(t,e,i){i.key=t,ft[t]={condition:e,descriptor:i}}const fo="none";fr(fo,function(){return!0},{name:at,inputsCount:0,showOperators:!1});var tJ=tn("gnaTS");const fs="empty";fr(fs,function(t){return(0,tJ.isEmpty)(t.value)},{name:ae,inputsCount:0,showOperators:!0});const fn="not_empty";fr(fn,function(t,e){return!fe(fs,e)(t)},{name:ai,inputsCount:0,showOperators:!0});var tJ=tn("gnaTS");fr("eq",function(t,e){let[i]=e;return(0,tJ.stringify)(t.value).toLocaleLowerCase(t.meta.locale)===(0,tJ.stringify)(i)},{name:ar,inputsCount:1,showOperators:!0}),fr("neq",function(t,e){return!fe("eq",e)(t)},{name:ao,inputsCount:1,showOperators:!0}),fr("gt",function(t,e){let[i]=e,r=i;return"numeric"===t.meta.type&&(r=parseFloat(r,10)),t.value>r},{name:ac,inputsCount:1,showOperators:!0}),fr("gte",function(t,e){let[i]=e,r=i;return"numeric"===t.meta.type&&(r=parseFloat(r,10)),t.value>=r},{name:ad,inputsCount:1,showOperators:!0}),fr("lt",function(t,e){let[i]=e,r=i;return"numeric"===t.meta.type&&(r=parseFloat(r,10)),t.value<r},{name:au,inputsCount:1,showOperators:!0}),fr("lte",function(t,e){let[i]=e,r=i;return"numeric"===t.meta.type&&(r=parseFloat(r,10)),t.value<=r},{name:ag,inputsCount:1,showOperators:!0});var ch=tn("45fvw");const fa="date_after";fr(fa,function(t,e){let[i]=e,r=o(ch)(t.value,t.meta.dateFormat),s=o(ch)(i,t.meta.dateFormat);return!!(r.isValid()&&s.isValid())&&r.diff(s)>=0},{name:am,inputsCount:1,showOperators:!0});var ch=tn("45fvw");const fl="date_before";fr(fl,function(t,e){let[i]=e,r=o(ch)(t.value,t.meta.dateFormat),s=o(ch)(i,t.meta.dateFormat);return!!(r.isValid()&&s.isValid())&&0>=r.diff(s)},{name:ay,inputsCount:1,showOperators:!0});const fh="between";fr(fh,function(t,e){let[i,r]=e,o=i,s=r;if("numeric"===t.meta.type){let t=parseFloat(o,10),e=parseFloat(s,10);o=Math.min(t,e),s=Math.max(t,e)}else if("date"===t.meta.type){let e=fe(fl,[s]),i=fe(fa,[o]);return e(t)&&i(t)}return t.value>=o&&t.value<=s},{name:ap,inputsCount:2,showOperators:!0});const fc="not_between";fr(fc,function(t,e){return!fe(fh,e)(t)},{name:af,inputsCount:2,showOperators:!0});var tJ=tn("gnaTS");const fd="begins_with";fr(fd,function(t,e){let[i]=e;return(0,tJ.stringify)(t.value).toLocaleLowerCase(t.meta.locale).startsWith((0,tJ.stringify)(i))},{name:as,inputsCount:1,showOperators:!0});var tJ=tn("gnaTS");const fu="ends_with";fr(fu,function(t,e){let[i]=e;return(0,tJ.stringify)(t.value).toLocaleLowerCase(t.meta.locale).endsWith((0,tJ.stringify)(i))},{name:an,inputsCount:1,showOperators:!0});var tJ=tn("gnaTS");const fg="contains";fr(fg,function(t,e){let[i]=e;return(0,tJ.stringify)(t.value).toLocaleLowerCase(t.meta.locale).indexOf((0,tJ.stringify)(i))>=0},{name:aa,inputsCount:1,showOperators:!0});const fp="not_contains";fr(fp,function(t,e){return!fe(fg,e)(t)},{name:al,inputsCount:1,showOperators:!0});var ch=tn("45fvw");const ff="date_tomorrow";fr(ff,function(t){let e=o(ch)(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(o(ch)().subtract(-1,"days").startOf("day"),"d")},{name:aw,inputsCount:0});var ch=tn("45fvw");const fm="date_today";fr(fm,function(t){let e=o(ch)(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(o(ch)().startOf("day"),"d")},{name:av,inputsCount:0});var ch=tn("45fvw");const fy="date_yesterday";fr(fy,function(t){let e=o(ch)(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(o(ch)().subtract(1,"days").startOf("day"),"d")},{name:ab,inputsCount:0}),tn("1hIp0");var iv=tn("llu1T"),eu=tn("ceXML");(0,iv.getComparisonFunction)();const fv=new Set([1]).has(1),fw=fv&&"function"==typeof Array.from;function fb(t){let e=t;return fv&&(e=new Set(e)),function(t){return fv?e.has(t):!!~e.indexOf(t)}}function fC(t){return null==t?"":t}function fS(t){let e=t;return(e=fw?Array.from(new Set(e)):(0,eu.arrayUnique)(e)).sort((t,e)=>"number"==typeof t&&"number"==typeof e?t-e:t===e?0:t>e?1:-1)}function fx(t,e,i,r){let o;let s=[],n=t===e;return n||(o=fb(e)),(0,eu.arrayEach)(t,t=>{let e,a=!1;(n||o(t))&&(a=!0);let l={checked:a,value:t,visualValue:(""===(e=t)&&(e=`(${i})`),e)};r&&r(l),s.push(l)}),s}const fE="by_value";fr(fE,function(t,e){let[i]=e;return i(t.value)},{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[fb(e)]},showOperators:!1}),tn("1C6fS");const fR={};function fT(t,e,i){fR[t]={name:e,func:i}}const fM="conjunction";fT(fM,ax,function(t,e){return t.every(t=>t.func(e))});const fk="disjunction";fT(fk,aE,function(t,e){return t.some(t=>t.func(e))}),tn("1C6fS");const fA="disjunctionWithExtraCondition";fT(fA,aE,function(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(t=>t.func(e))&&t[t.length-1].func(e)});const fO="text",fP={numeric:[fo,ud,fs,fn,ud,"eq","neq",ud,"gt","gte","lt","lte",fh,fc],[fO]:[fo,ud,fs,fn,ud,"eq","neq",ud,fd,fu,ud,fg,fp],date:[fo,ud,fs,fn,ud,"eq","neq",ud,fl,fa,fh,ud,ff,fm,fy]};tn("1C6fS");var tZ=tn("gFbQZ"),t3=tn("hwT6B");tn("1C6fS");var t3=tn("hwT6B"),t2=tn("1k8Ev"),tZ=tn("gFbQZ"),eu=tn("ceXML");function fI(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const fH="built",fL="building",fD=["click","input","keydown","keypress","keyup","focus","blur","change"];class fN{static get DEFAULTS(){return(0,t3.clone)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(t,e){fI(this,"hot",void 0),fI(this,"eventManager",new t2.default(this)),fI(this,"options",void 0),fI(this,"_element",void 0),fI(this,"buildState",void 0),this.hot=t,this.options=(0,t3.extend)(fN.DEFAULTS,e),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(t){this.options.value=t,this.update()}getValue(){return this.options.value}get element(){return this.buildState===fL||(this.buildState===fH?this.update():(this.buildState=fL,this.build(),this.buildState=fH)),this._element}isBuilt(){return this.buildState===fH}translateIfPossible(t){return"string"==typeof t&&t.startsWith(n8)?this.hot.getTranslatedPhrase(t):t}build(){let t=(t,e)=>{this.eventManager.addEventListener(t,e,t=>this.runLocalHooks(e,t,this))};if(this.buildState||(this.buildState=fL),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&(0,tZ.addClass)(this._element,this.options.className),this.options.children.length)(0,eu.arrayEach)(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){let e=this.hot.rootDocument.createElement(this.options.tagName);e.setAttribute("data-hot-input",!0),(0,t3.objectEach)(this.options,(t,i)=>{void 0!==e[i]&&"className"!==i&&"tagName"!==i&&"children"!==i&&(e[i]=this.translateIfPossible(t))}),this._element.appendChild(e),(0,eu.arrayEach)(fD,i=>t(e,i))}else(0,eu.arrayEach)(fD,e=>t(this._element,e))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}function f_(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function fF(t,e){return t.get(fj(t,e))}function fj(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(0,t3.mixin)(fN,sB);var fB=new WeakMap,fW=new WeakSet;class fV extends fN{static get DEFAULTS(){return(0,t3.clone)({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(t,e){var i;super(t,(0,t3.extend)(fV.DEFAULTS,e)),f_(this,fW),fW.add(this),i=void 0,f_(this,fB),fB.set(this,i),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",t=>fj(fW,this,fU).call(this,t))}build(){var t;super.build();let e=this.hot.rootDocument.createElement("div");t=this._element.firstChild,fB.set(fj(fB,this),t),(0,tZ.addClass)(this._element,"htUIInput"),(0,tZ.addClass)(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(fF(fB,this).type=this.options.type,fF(fB,this).placeholder=this.translateIfPossible(this.options.placeholder),fF(fB,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&fF(fB,this).focus()}}function fU(t){this.options.value=t.target.value}tn("1C6fS");var t3=tn("hwT6B"),eu=tn("ceXML"),tZ=tn("gFbQZ"),iq=tn("4Pbrh");function fz(t,e,i){fY(t,e),e.set(t,i)}function fY(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function fG(t,e,i){return t.set(fX(t,e),i),i}function f$(t,e){return t.get(fX(t,e))}function fX(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var fq=new WeakMap,fK=new WeakMap,fZ=new WeakMap,fQ=new WeakMap,fJ=new WeakMap,f0=new WeakSet;class f1 extends fN{static get DEFAULTS(){return(0,t3.clone)({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(t,e){super(t,(0,t3.extend)(f1.DEFAULTS,e)),fY(this,f0),f0.add(this),fz(this,fq,null),fz(this,fK,[]),fz(this,fZ,void 0),fz(this,fQ,void 0),fz(this,fJ,void 0),this.registerHooks()}getMenu(){return f$(fq,this)}registerHooks(){this.addLocalHook("click",()=>fX(f0,this,f6).call(this))}setItems(t){fG(fK,this,this.translateNames(t)),f$(fq,this)&&f$(fq,this).setMenuItems(f$(fK,this))}translateNames(t){return(0,eu.arrayEach)(t,t=>{t.name=this.translateIfPossible(t.name)}),t}build(){super.build(),fG(fq,this,new gM(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),f$(fq,this).setMenuItems(f$(fK,this));let t=new fN(this.hot,{className:"htUISelectCaption"}),e=new fN(this.hot,{className:"htUISelectDropdown"});fG(fZ,this,t),fG(fQ,this,t.element),fG(fJ,this,e),this.hot.getSettings().ariaTags&&((0,tZ.setAttribute)(e.element,[(0,iq.A11Y_HIDDEN)()]),(0,tZ.setAttribute)(this._element,[(0,iq.A11Y_LISTBOX)()])),(0,eu.arrayEach)([t,e],t=>this._element.appendChild(t.element)),f$(fq,this).addLocalHook("select",t=>fX(f0,this,f2).call(this,t)),f$(fq,this).addLocalHook("afterClose",()=>fX(f0,this,f3).call(this)),this.update()}update(){let t;this.isBuilt()&&(t=this.options.value?this.options.value.name:f$(fq,this).hot.getTranslatedPhrase(at),f$(fQ,this).textContent=t,super.update())}openOptions(){let t=this.element.getBoundingClientRect();f$(fq,this)&&(f$(fq,this).open(),f$(fq,this).setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}),f$(fq,this).getNavigator().toFirstItem(),f$(fq,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){f$(fq,this)&&f$(fq,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){f$(fq,this)&&(f$(fq,this).destroy(),fG(fq,this,null)),f$(fZ,this)&&f$(fZ,this).destroy(),f$(fJ,this)&&f$(fJ,this).destroy(),super.destroy()}}function f2(t){t.name!==ud&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function f3(){this.runLocalHooks("afterClose")}function f6(){this.openOptions()}function f4(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function f5(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var f9=new WeakSet;class f8 extends p7{constructor(t,e){super(t,{id:e.id,stateless:!1}),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,f9),f9.add(this),f4(this,"name",""),f4(this,"addSeparator",!1),this.name=e.name,this.addSeparator=e.addSeparator,this.elements.push(new f1(this.hot,{menuContainer:e.menuContainer})),this.elements.push(new fV(this.hot,{placeholder:aP})),this.elements.push(new fV(this.hot,{placeholder:aI})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",t=>f5(f9,this,f7).call(this,t)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",t=>this.runLocalHooks("selectTabKeydown",t)),(0,eu.arrayEach)(this.getInputElements(),t=>{t.addLocalHook("keydown",t=>f5(f9,this,mt).call(this,t))})}setState(t){if(this.reset(),!t)return;let e=(0,t3.clone)(t.command);e.name.startsWith(n7)&&(e.name=this.hot.getTranslatedPhrase(e.name)),this.getSelectElement().setValue(e),(0,eu.arrayEach)(t.args,(t,i)=>{if(i>e.inputsCount-1)return!1;let r=this.getInputElement(i);r.setValue(t),r[e.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>r.focus(),10)})}getState(){let t=this.getSelectElement().getValue()||fi(fo),e=[];return(0,eu.arrayEach)(this.getInputElements(),(i,r)=>{t.inputsCount>r&&e.push(i.getValue())}),{command:t,args:e}}updateState(t,e){let i=t?fi(t.name):fi(fo);this.state.setValueAtIndex(e,{command:i,args:t?t.args:[]}),t||(0,eu.arrayEach)(this.getInputElements(),t=>t.setValue(null))}getSelectElement(){return this.elements.filter(t=>t instanceof f1)[0]}getInputElement(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}getInputElements(){return this.elements.filter(t=>t instanceof fV)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,i,r,o,s)=>{(0,tZ.addClass)(e.parentNode,"htFiltersMenuCondition"),this.addSeparator&&(0,tZ.addClass)(e.parentNode,"border");let n=this.hot.rootDocument.createElement("div");return(0,tZ.addClass)(n,"htFiltersMenuLabel"),n.textContent=s,e.appendChild(n),(0,eu.arrayEach)(this.elements,t=>e.appendChild(t.element)),e}}}reset(){let t=this.hot.getPlugin("filters").getSelectedColumn(),e=[fi(fo)];if(null!==t){let{visualIndex:i}=t;e=function(t){let e=[],i=t;return fP[i]||(i=fO),(0,eu.arrayEach)(fP[i],t=>{let i;i=t===ud?{name:ud}:(0,t3.clone)(fi(t)),e.push(i)}),e}(this.hot.getDataType(0,i,this.hot.countRows(),i))}(0,eu.arrayEach)(this.getInputElements(),t=>t.hide()),this.getSelectElement().setItems(e),super.reset(),this.getSelectElement().setValue(e[0])}}function f7(t){(0,eu.arrayEach)(this.getInputElements(),(e,i)=>{e[t.inputsCount>i?"show":"hide"](),0===i&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function mt(t){(0,iL.isKey)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,iy.stopImmediatePropagation)(t))}tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),eu=tn("ceXML"),iJ=tn("iCsRe");tn("1C6fS");var t3=tn("hwT6B");function me(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function mi(t,e){return t.get(mo(t,e))}function mr(t,e,i){return t.set(mo(t,e),i),i}function mo(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var ms=new WeakMap,mn=new WeakMap;class ma extends fN{static get DEFAULTS(){return(0,t3.clone)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(t,e){super(t,(0,t3.extend)(ma.DEFAULTS,e)),me(this,ms,void 0),me(this,mn,void 0)}build(){super.build();let t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),mr(mn,this,t),mr(ms,this,this._element.firstChild),mi(ms,this).checked=this.options.checked,this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(mi(mn,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&mi(ms,this).checked}setChecked(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.isBuilt()&&(mi(ms,this).checked=t)}focus(){this.isBuilt()&&mi(ms,this).focus()}}var ml=new WeakSet;class mh extends p7{constructor(t,e){var i,r;super(t,{id:e.id,stateless:!1}),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,ml),ml.add(this),(i="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i="name","string"))?r:r+"")in this?Object.defineProperty(this,i,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[i]="",this.name=e.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>((0,tZ.addClass)(e.parentNode,"htFiltersMenuOperators"),(0,eu.arrayEach)(this.elements,t=>e.appendChild(t.element)),e)}}buildOperatorsElement(){let t=[fM,fk];(0,eu.arrayEach)(t,e=>{let i=new ma(this.hot,{name:"operator",label:{htmlFor:e,textContent:fR[e].name},value:e,checked:e===t[0],id:e});i.addLocalHook("change",t=>(function(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")})(ml,this,mc).call(this,t)),this.elements.push(i)})}setChecked(t){if(this.elements.length<t)throw Error((0,iJ.toSingleLine)`Radio button with index ${t} doesn't exist.`);(0,eu.arrayEach)(this.elements,(e,i)=>{e.setChecked(i===t)})}getActiveOperationId(){let t=this.elements.find(t=>t instanceof ma&&t.isChecked());return t?t.getValue():fM}getState(){return this.getActiveOperationId()}setState(t){this.reset(),t&&this.getActiveOperationId()!==t&&(0,eu.arrayEach)(this.elements,e=>{e.setChecked(e.getValue()===t)})}updateState(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fM,e=arguments.length>1?arguments[1]:void 0,i=t;i===fA&&(i=fk),this.state.setValueAtIndex(e,i)}reset(){this.setChecked(0)}}function mc(t){this.setState(t.target.value)}tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),iy=tn("7HxIw"),eu=tn("ceXML"),iL=tn("bCtEl");tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),t3=tn("hwT6B"),eu=tn("ceXML"),iL=tn("bCtEl"),tQ=tn("f3221"),iy=tn("7HxIw");tn("1C6fS");var t3=tn("hwT6B");function md(t,e){return t.get(mu(t,e))}function mu(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var mg=new WeakMap;class mp extends fN{static get DEFAULTS(){return(0,t3.clone)({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(t,e){var i;super(t,(0,t3.extend)(mp.DEFAULTS,e)),i=void 0,function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,mg),mg.set(this,i)}build(){var t;super.build(),t=this._element.firstChild,mg.set(mu(mg,this),t)}update(){this.isBuilt()&&(md(mg,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&md(mg,this).focus()}activate(){md(mg,this).click()}}function mf(t,e,i){mm(t,e),e.set(t,i)}function mm(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function my(t,e){return t.get(mw(t,e))}function mv(t,e,i){return t.set(mw(t,e),i),i}function mw(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const mb="multipleSelect.itemBox";var mC=new WeakMap,mS=new WeakMap,mx=new WeakMap,mE=new WeakMap,mR=new WeakMap,mT=new WeakMap,mM=new WeakSet;class mk extends fN{static get DEFAULTS(){return(0,t3.clone)({className:"htUIMultipleSelect",value:[]})}constructor(t,e){super(t,(0,t3.extend)(mk.DEFAULTS,e)),mm(this,mM),mM.add(this),mf(this,mC,[]),mf(this,mS,void 0),mf(this,mx,void 0),mf(this,mE,void 0),mf(this,mR,void 0),mf(this,mT,void 0),mv(mE,this,new fV(this.hot,{placeholder:aO,className:"htUIMultipleSelectSearch"})),mv(mR,this,new mp(this.hot,{textContent:aT,className:"htUISelectAll"})),mv(mT,this,new mp(this.hot,{textContent:aM,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return my(mS,this)}registerHooks(){my(mE,this).addLocalHook("keydown",t=>mw(mM,this,mO).call(this,t)),my(mE,this).addLocalHook("input",t=>mw(mM,this,mA).call(this,t)),my(mR,this).addLocalHook("click",t=>mw(mM,this,mP).call(this,t)),my(mT,this).addLocalHook("click",t=>mw(mM,this,mI).call(this,t))}setItems(t){mv(mC,this,t),my(mS,this)&&my(mS,this).loadData(my(mC,this))}setLocale(t){mv(mx,this,t)}getLocale(){return my(mx,this)}getItems(){return[...my(mC,this)]}getValue(){return function(t){let e=[];return(0,eu.arrayEach)(t,t=>{t.checked&&e.push(t.value)}),e}(my(mC,this))}getSearchInputElement(){return my(mE,this)}getSelectAllElement(){return my(mR,this)}getClearAllElement(){return my(mT,this)}isSelectedAllValues(){return my(mC,this).length===this.getValue().length}build(){super.build();let{rootDocument:t}=this.hot,e=t.createElement("div"),i=new fN(this.hot,{className:"htUISelectionControls",children:[my(mR,this),my(mT,this)]});this._element.appendChild(my(mE,this).element),this._element.appendChild(i.element),this._element.appendChild(e);let r=e=>{if(!this._element)return;my(mS,this)&&my(mS,this).destroy(),(0,tZ.addClass)(e,"htUIMultipleSelectHot"),mv(mS,this,new this.hot.constructor(e,{data:my(mC,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(t,e,i,r,o,s)=>{t.title=s.instance.getDataAtRowProp(e,s.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{my(mS,this).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>my(mS,this).container.scrollWidth-(0,tZ.getScrollbarWidth)(t),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),my(mS,this).init();let i=my(mS,this).getShortcutManager().getContext("grid");i.removeShortcutsByKeys(["Tab"]),i.removeShortcutsByKeys(["Shift","Tab"]),i.addShortcut({keys:[["Escape"]],callback:t=>{this.runLocalHooks("keydown",t,this)},group:mb}),i.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:t=>{my(mS,this).deselectCell(),this.runLocalHooks("keydown",t,this),this.runLocalHooks("listTabKeydown",t,this)},group:mb})};r(e),this.hot._registerTimeout(()=>r(e),100)}focus(){this.isBuilt()&&my(mS,this).listen()}reset(){my(mE,this).reset(),my(mR,this).reset(),my(mT,this).reset()}update(){this.isBuilt()&&(my(mS,this).loadData(function(t,e){let i=fb(e);return(0,eu.arrayMap)(t,t=>(t.checked=i(t.value),t))}(my(mC,this),this.options.value)),super.update())}destroy(){my(mS,this)&&my(mS,this).destroy(),my(mE,this).destroy(),my(mT,this).destroy(),my(mR,this).destroy(),mv(mE,this,null),mv(mT,this,null),mv(mR,this,null),mv(mS,this,null),mv(mC,this,null),super.destroy()}}function mA(t){let e;let i=t.target.value.toLocaleLowerCase(this.getLocale());e=""===i?[...my(mC,this)]:(0,eu.arrayFilter)(my(mC,this),t=>`${t.value}`.toLocaleLowerCase(this.getLocale()).indexOf(i)>=0),my(mS,this).loadData(e)}function mO(t){this.runLocalHooks("keydown",t,this),(0,tQ.partial)(iL.isKey,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),(0,iy.stopImmediatePropagation)(t),my(mS,this).listen(),my(mS,this).selectCell(0,0))}function mP(t){let e=[];t.preventDefault(),(0,eu.arrayEach)(my(mS,this).getSourceData(),(t,i)=>{t.checked=!0,e.push(sL(t,i)[0])}),my(mS,this).setSourceDataAtCell(e)}function mI(t){let e=[];t.preventDefault(),(0,eu.arrayEach)(my(mS,this).getSourceData(),(t,i)=>{t.checked=!1,e.push(sL(t,i)[0])}),my(mS,this).setSourceDataAtCell(e)}function mH(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var mL=new WeakSet;class mD extends p7{constructor(t,e){var i,r;super(t,{id:e.id,stateless:!1}),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,mL),mL.add(this),(i="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i="name","string"))?r:r+"")in this?Object.defineProperty(this,i,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[i]="",this.name=e.name,this.elements.push(new mk(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",t=>mH(mL,this,mN).call(this,t)).addLocalHook("listTabKeydown",t=>this.runLocalHooks("listTabKeydown",t)),this.hot.addHook("modifyFiltersMultiSelectValue",(t,e)=>mH(mL,this,mF).call(this,t,e))}getElements(){let t=this.getMultipleSelectElement();return[t.getSearchInputElement(),t.getSelectAllElement(),t.getClearAllElement(),this.getMultipleSelectElement()]}setState(t){if(this.reset(),t&&t.command.key===fE){let e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0]),e.setLocale(t.locale)}}getState(){let t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?fo:fE},args:[t.getValue()],itemsSnapshot:e}}updateState(t){let e=(e,i,r,o,s)=>{let[n]=(0,eu.arrayFilter)(i,t=>t.name===fE),a={},l=this.hot.getTranslatedPhrase(aR);if(n){let i=o(e,s),h=(0,eu.arrayMap)(i,t=>t.value),c=new Map(i.map(t=>[t.value,this.hot.getCellMeta(t.meta.visualRow,t.meta.visualCol)])),d=fS(h);r&&(n.args[0]=r);let u=[],g=fx(d,n.args[0],l,t=>{t.checked&&u.push(t.value),mH(mL,this,m_).call(this,t,c)}),p=t.editedConditionStack.column;a.locale=this.hot.getCellMeta(0,p).locale,a.args=[u],a.command=fi(fE),a.itemsSnapshot=g}else a.args=[],a.command=fi(fo);this.state.setValueAtIndex(e,a)};e(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&e(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(t=>t instanceof mk)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,i,r,o,s)=>{(0,tZ.addClass)(e.parentNode,"htFiltersMenuValue");let n=this.hot.rootDocument.createElement("div");return(0,tZ.addClass)(n,"htFiltersMenuLabel"),n.textContent=s,e.appendChild(n),(0,eu.arrayEach)(this.elements,t=>e.appendChild(t.element)),e}}}reset(){let t=this.hot.getTranslatedPhrase(aR),e=this._getColumnVisibleValues(),i=e.map(t=>t.value),r=new Map(e.map(t=>[t.value,t.meta])),o=fS(i),s=fx(o,o,t,t=>{mH(mL,this,m_).call(this,t,r)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);let n=this.hot.getPlugin("filters").getSelectedColumn();null!==n&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,n.visualIndex).locale)}_getColumnVisibleValues(){let t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:(0,eu.arrayMap)(this.hot.getDataAtCol(t.visualIndex),(e,i)=>({value:fC(e),meta:this.hot.getCellMeta(i,t.visualIndex)}))}}function mN(t){(0,iL.isKey)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,iy.stopImmediatePropagation)(t))}function m_(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function mF(t,e){return"numeric"===e.type?h7(t,e):t}tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),eu=tn("ceXML"),mj=new WeakSet;class mB extends p7{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(t,e){var i,r;super(t,{id:e.id,stateless:!0}),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,mj),mj.add(this),(i="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i="name","string"))?r:r+"")in this?Object.defineProperty(this,i,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[i]="",this.name=e.name,this.elements.push(new fV(this.hot,{type:"button",value:ak,className:"htUIButton htUIButtonOK",identifier:mB.BUTTON_OK})),this.elements.push(new fV(this.hot,{type:"button",value:aA,className:"htUIButton htUIButtonCancel",identifier:mB.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){(0,eu.arrayEach)(this.elements,t=>{t.addLocalHook("click",(t,e)=>(function(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")})(mj,this,mW).call(this,t,e))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>((0,tZ.addClass)(e.parentNode,"htFiltersMenuActionBar"),(0,eu.arrayEach)(this.elements,t=>e.appendChild(t.element)),e)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function mW(t,e){e.options.identifier===mB.BUTTON_OK?this.accept():this.cancel()}tn("1C6fS"),tn("1hIp0");var eu=tn("ceXML"),t3=tn("hwT6B"),iJ=tn("iCsRe"),tJ=tn("gnaTS");function mV(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const mU="ConditionCollection.filteringStates";class mz{constructor(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];mV(this,"hot",void 0),mV(this,"isMapRegistrable",void 0),mV(this,"filteringStates",new sZ),this.hot=t,this.isMapRegistrable=e,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(mU,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(t,e){var i;let r=this.filteringStates.getValueAtIndex(e),o=null!==(i=null==r?void 0:r.conditions)&&void 0!==i?i:[],s=null==r?void 0:r.operation;return this.isMatchInConditions(o,t,s)}isMatchInConditions(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fM;return!t.length||(function(t){if(!fR[t])throw Error(`Operation with id "${t}" does not exist.`);let e=fR[t].func;return function(t,i){return e(t,i)}})(i)(t,e)}addCondition(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fM,r=arguments.length>3?arguments[3]:void 0,o=this.hot.getCellMeta(0,t).locale,s=(0,eu.arrayMap)(e.args,t=>"string"==typeof t?t.toLocaleLowerCase(o):t),n=e.name||e.command.key;this.runLocalHooks("beforeAdd",t);let a=this.getOperation(t);if(a){if(a!==i)throw Error((0,iJ.toSingleLine)`The column of index ${t} has been already applied with a \`${a}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if((0,tJ.isUndefined)(fR[i]))throw Error((0,iJ.toSingleLine)`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);let l=this.getConditions(t);0===l.length?this.filteringStates.setValueAtIndex(t,{operation:i,conditions:[{name:n,args:s,func:fe(n,s)}]},r):l.push({name:n,args:s,func:fe(n,s)}),this.runLocalHooks("afterAdd",t)}getConditions(t){var e,i;return null!==(e=null===(i=this.filteringStates.getValueAtIndex(t))||void 0===i?void 0:i.conditions)&&void 0!==e?e:[]}getOperation(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(t=>{let[e]=t;return e})}getColumnStackPosition(t){return this.getFilteredColumns().indexOf(t)}exportAllConditions(){return(0,eu.arrayReduce)(this.filteringStates.getEntries(),(t,e)=>{let[i,{operation:r,conditions:o}]=e;return t.push({column:i,operation:r,conditions:(0,eu.arrayMap)(o,t=>{let{name:e,args:i}=t;return{name:e,args:i}})}),t},[])}importAllConditions(t){this.clean(),(0,eu.arrayEach)(t,t=>{(0,eu.arrayEach)(t.conditions,e=>this.addCondition(t.column,e))})}removeConditions(t){this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(t,e){let i=this.getConditions(t);return e?i.some(t=>t.name===e):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(mU),this.filteringStates=null,this.clearLocalHooks()}}(0,t3.mixin)(mz,sB),tn("1C6fS"),tn("1hIp0");var eu=tn("ceXML");function mY(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var mG=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];mY(this,"conditionCollection",void 0),mY(this,"columnDataFactory",void 0),this.conditionCollection=t,this.columnDataFactory=e}filter(){let t=[];return(0,eu.arrayEach)(this.conditionCollection.getFilteredColumns(),(e,i)=>{let r=this.columnDataFactory(e);i&&(r=this._getIntersectData(r,t)),t=this.filterByColumn(e,r)}),t}filterByColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];return(0,eu.arrayEach)(e,e=>{void 0!==e&&this.conditionCollection.isMatch(e,t)&&i.push(e)}),i}_getIntersectData(t,e){let i=[];return(0,eu.arrayEach)(e,e=>{let r=e.meta.visualRow;void 0!==t[r]&&(i[r]=t[r])}),i}};tn("1C6fS"),tn("1hIp0");var eu=tn("ceXML"),t3=tn("hwT6B"),tQ=tn("f3221");function m$(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function mX(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var mq=new WeakSet;class mK{constructor(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,mq),mq.add(this),m$(this,"hot",void 0),m$(this,"conditionCollection",void 0),m$(this,"columnDataFactory",void 0),m$(this,"changes",[]),m$(this,"grouping",!1),m$(this,"latestEditedColumnPosition",-1),m$(this,"latestOrderStack",[]),this.hot=t,this.conditionCollection=e,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",t=>mX(mq,this,mZ).call(this,t)),this.conditionCollection.addLocalHook("afterRemove",t=>this.updateStatesAtColumn(t)),this.conditionCollection.addLocalHook("afterAdd",t=>this.updateStatesAtColumn(t)),this.conditionCollection.addLocalHook("beforeClean",()=>mX(mq,this,mQ).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>mX(mq,this,mJ).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,(0,eu.arrayEach)(this.changes,t=>{this.updateStatesAtColumn(t)}),this.changes.length=0}updateStatesAtColumn(t,e){var i=this;if(this.grouping){-1===this.changes.indexOf(t)&&this.changes.push(t);return}let r=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.getColumnStackPosition(t);-1===o&&(o=this.latestEditedColumnPosition);let s=r.slice(0,o),n=r.slice(o);n.length&&n[0].column===t&&n.shift();let a=(0,tQ.curry)(function(t,e){let r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=new mz(i.hot,!1),n=[].concat(t,o);s.importAllConditions(n);let a=i.columnDataFactory(e);r=s.isEmpty()?a:new mG(s,t=>i.columnDataFactory(t)).filter();let l=fb(r=(0,eu.arrayMap)(r,t=>t.meta.visualRow));return s.destroy(),(0,eu.arrayFilter)(a,t=>l(t.meta.visualRow))})(s),l=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:l},dependentConditionStacks:n,filteredRowsFactory:a,conditionArgsChange:e})}destroy(){this.clearLocalHooks(),(0,t3.objectEach)(this,(t,e)=>{this[e]=null})}}function mZ(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function mQ(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function mJ(){(0,eu.arrayEach)(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}(0,t3.mixin)(mK,sB);var tZ=tn("gFbQZ");const m0="filters";function m1(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function m2(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function m3(t,e){return t.get(m6(t,e))}function m6(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const m4="filters";var m5=new WeakMap,m9=new WeakSet;function m8(t){t&&(0,eu.arrayEach)(t,t=>{let[,e]=t,i=this.hot.propToCol(e);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function m7(){this.restoreComponents(Array.from(this.components.values()))}function yt(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function ye(t){t.items.push({name:ud}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function yi(t){var e,i;if("accept"===t){let t=this.getSelectedColumn();if(null===t){null===(i=this.dropdownMenuPlugin)||void 0===i||i.close();return}let{physicalIndex:e}=t,r=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),s=this.components.get("filter_by_value").getState(),n=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,o,s);this.conditionUpdateObserver.groupChanges();let a=this.conditionCollection.getColumnStackPosition(e);-1===a&&(a=void 0),this.conditionCollection.removeConditions(e),r.command.key!==fo&&(this.conditionCollection.addCondition(e,r,n,a),o.command.key!==fo&&this.conditionCollection.addCondition(e,o,n,a)),s.command.key!==fo&&this.conditionCollection.addCondition(e,s,n,a),this.conditionUpdateObserver.flush(),this.components.forEach(t=>t.saveState(e)),this.filtersRowsMap.clear(),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}function yr(t,e){this.updateDependentComponentsVisibility(),t.constructor!==f8||e.inputsCount||this.setListeningDropdownMenu()}function yo(){this.setListeningDropdownMenu()}function ys(t,e){let i=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(i)?(0,tZ.addClass)(e,"htFiltersActive"):(0,tZ.removeClass)(e,"htFiltersActive")}function yn(t){var e;if(!(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled))return;let{editedConditionStack:{conditions:i,column:r}}=t,o=i.filter(t=>t.name===fE),s=i.filter(t=>t.name!==fE);if(o.length>=2||s.length>=3)(0,t6.warn)((0,iJ.toSingleLine)`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{let e=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(e,r),this.components.get("filter_by_value").updateState(t)}}tn("1C6fS"),tn("1hIp0"),tn("euqEx");var e7=tn("lSZ9A"),t6=tn("jlXkd"),eq=tn("guO5N"),tJ=tn("gnaTS");tn("1hIp0");var e7=tn("lSZ9A"),tJ=tn("gnaTS"),iJ=tn("iCsRe"),t6=tn("jlXkd"),t3=tn("hwT6B");const ya="internal-use-in-handsontable",yl={licenseKey:ya,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function yh(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:null===(e=t[yQ])||void 0===e||null===(e=e.language)||void 0===e?void 0:e.langCode}}function yc(t){return Object.keys(t).reduce((e,i)=>("hyperformula"!==i&&(e[i]=t[i]),e),{})}function yd(){let t="engine_relationship",e=(0,e7.default)(yQ);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function yu(){let t="shared_engine_usage",e=(0,e7.default)(yQ);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function yg(t){var e;let i=yd();return new Map((0===i.size?[]:Array.from(null!==(e=i.get(t))&&void 0!==e?e:[])).map(t=>[t.getPlugin("formulas").sheetId,t]))}function yp(t,e){if(t){let i=yd(),r=i.get(t),o=yu(),s=o.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),0===r.length&&i.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),0===s.length&&(o.delete(t),t.destroy()))}}var ch=tn("45fvw");const yf="DD/MM/YYYY";function ym(t){return"string"==typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function yy(t,e){return"string"==typeof t&&"date"===e}function yv(t,e){return o(ch)(t,e,!0).isValid()}function yw(t,e){return o(ch)(t,e,!0).format(yf)}function yb(t,e){let i=new Date(Date.UTC(0,0,t+-1));return o(ch)(i).format(e)}var eX=tn("bO142"),nd=tn("10euP");tn("1C6fS"),tn("1C6fS"),tn("1hIp0");var eX=tn("bO142");function yC(t,e,i){var r;return(r=function(t,e){let i=[];return t.forEach(t=>{let r={from:t,to:e};i.forEach(t=>{let e=t.from>t.to,i=t.to<=r.from;t.from>r.from&&i&&e&&(r.from+=1)}),r.from>=e&&(e+=1),i.push(r)}),i}(t,function(t,e,i){let r=Array.from(Array(i).keys()).filter(e=>!1===t.includes(e));if(0===e){var o;return null!==(o=r[e])&&void 0!==o?o:0}return r[e-1]+1}(t,e,i))).forEach((t,e)=>{r.slice(e+1).forEach(e=>{let i=e.from<e.to;e.from>t.from&&i&&(e.from-=1)})}),r}function yS(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function yx(t,e){return t.get(yR(t,e))}function yE(t,e,i){return t.set(yR(t,e),i),i}function yR(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}tn("1hIp0");var yT=new WeakMap,yM=new WeakMap,yk=new WeakMap,yA=new WeakMap,yO=new WeakMap,yP=new WeakMap,yI=new WeakMap,yH=class{constructor(t,e,i){yS(this,yT,void 0),yS(this,yM,void 0),yS(this,yk,void 0),yS(this,yA,[]),yS(this,yO,[]),yS(this,yP,void 0),yS(this,yI,[]),yE(yT,this,t),yE(yM,this,e),yE(yk,this,i)}setRemovedHfIndexes(t){return yE(yI,this,t.map(t=>{let e=yx(yM,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(e)})),yx(yI,this)}getRemovedHfIndexes(){return yx(yI,this)}getHfIndexFromVisualIndex(t){let e=yx(yM,this).getIndexesSequence(),i=yx(yM,this).getNotTrimmedIndexes();return e.indexOf(i[t])}syncMoves(t){let e=`move${(0,eX.toUpperCaseFirst)(yx(yT,this))}s`;yx(yk,this).getEngine().batch(()=>{t.forEach(t=>{let i=t.from!==t.to,r=t.from+1!==t.to;i&&r&&yx(yk,this).getEngine()[e](yx(yk,this).getSheetId(),t.from,1,t.to)})})}storeMovesInformation(t,e,i){!1!==i&&(yE(yO,this,t.map(t=>this.getHfIndexFromVisualIndex(t))),yE(yP,this,this.getHfIndexFromVisualIndex(e)))}calculateAndSyncMoves(t,e){if(yx(yk,this).isPerformingUndoRedo()||!1===t||!1===e)return;let i=yC(yx(yO,this),yx(yP,this),yx(yM,this).getNumberOfIndexes());null===yx(yk,this).getSheetId()?yx(yk,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){let t=`set${(0,eX.toUpperCaseFirst)(yx(yT,this))}Order`;return e=>{if(yx(yk,this).isPerformingUndoRedo())return;let i=yx(yM,this).getIndexesSequence();if("update"===e&&i.length>0){let e;let r=yx(yA,this).map(t=>i.indexOf(t)),o=yx(yk,this).getEngine().getSheetDimensions(yx(yk,this).getSheetId());e="row"===yx(yT,this)?o.height:o.width;let s=r.length;for(let t=s;t<e;t+=1)r.push(t);yx(yk,this).getEngine()[t](yx(yk,this).getSheetId(),r)}yE(yA,this,i)}}init(){yE(yA,this,yx(yM,this).getIndexesSequence())}};function yL(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function yD(t,e){return t.get(y_(t,e))}function yN(t,e,i){return t.set(y_(t,e),i),i}function y_(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var yF=new WeakMap,yj=new WeakMap,yB=new WeakMap,yW=new WeakMap,yV=new WeakMap,yU=new WeakMap,yz=new WeakMap,yY=class{constructor(t,e,i){yL(this,yF,void 0),yL(this,yj,void 0),yL(this,yB,void 0),yL(this,yW,!1),yL(this,yV,!1),yL(this,yU,null),yL(this,yz,null),yN(yF,this,new yH("row",t,this)),yN(yj,this,new yH("column",e,this)),yN(yB,this,i)}getForAxis(t){return"row"===t?yD(yF,this):yD(yj,this)}setPerformUndo(t){yN(yW,this,t)}setPerformRedo(t){yN(yV,this,t)}isPerformingUndoRedo(){return yD(yW,this)||yD(yV,this)}getSheetId(){return yD(yz,this)}getEngine(){return yD(yU,this)}getPostponeAction(){return yD(yB,this)}setupSyncEndpoint(t,e){yN(yU,this,t),yN(yz,this,e),yD(yF,this).init(),yD(yj,this).init()}};function yG(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function y$(t,e,i){yX(t,e),e.set(t,i)}function yX(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function yq(t,e,i){return t.set(yZ(t,e),i),i}function yK(t,e){return t.get(yZ(t,e))}function yZ(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const yQ="formulas",yJ=["maxRows","maxColumns","language"];(0,nd.default).getSingleton().register("afterNamedExpressionAdded"),(0,nd.default).getSingleton().register("afterNamedExpressionRemoved"),(0,nd.default).getSingleton().register("afterSheetAdded"),(0,nd.default).getSingleton().register("afterSheetRemoved"),(0,nd.default).getSingleton().register("afterSheetRenamed"),(0,nd.default).getSingleton().register("afterFormulasValuesUpdate");const y0=t=>"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t;var y1=new WeakMap,y2=new WeakMap,y3=new WeakMap,y6=new WeakSet;function y4(t,e,i){let r=this.hot.propToCol(i);if(this.isFormulaCellType(e,r)){let t={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},i=this.hot.getCellMeta(e,r),o=this.engine.getCellValue(t);return"date"===i.type&&(0,eq.isNumeric)(o)&&(o=yb(o,i.dateFormat)),"object"==typeof o&&null!==o?o.value:o}return t}function y5(t,e,i){let{row:r,col:s}=e.getTopStartCorner(),{row:n,col:a}=e.getBottomEndCorner(),{row:l,col:h}=i.getTopStartCorner(),{row:c,col:d}=i.getBottomEndCorner(),u={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId}},g={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(d),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(g))return!1;let p=this.engine.getFillRangeData(u,g),{row:f,col:m}=u.start,{row:y,col:w}=u.end,b=y-f+1,C=w-m+1;for(let t=0;t<p.length;t+=1)for(let e=0;e<p[t].length;e+=1){let i=p[t][e],r=t%b,s=e%C,n=this.hot.getCellMeta(r,s);if(yy(i,n.type)){if(i.startsWith("'"))p[t][e]=i.slice(1);else if(!1===this.isFormulaCellType(r,s,this.sheetId)){var S;p[t][e]=(S=n.dateFormat,o(ch)(i,yf,!0).format(S))}}}return p}function y9(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";i.includes((0,eX.toUpperCaseFirst)(yQ))||yq(y2,this,(0,tJ.isUndefined)(this.hot.getSettings().data))}function y8(){let t=this.hot.getSourceDataArray(),e=!1;t.forEach((i,r)=>{i.forEach((i,o)=>{let s=this.hot.getCellMeta(r,o),n=s.dateFormat;yy(i,s.type)&&(e=!0,yv(i,n)?t[r][o]=yw(i,n):!1===this.isFormulaCellType(r,o)&&(t[r][o]=`'${i}`))})}),!0===e&&(yq(y1,this,!0),this.engine.setSheetContent(this.sheetId,t),yq(y1,this,!1))}function y7(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!i.includes((0,eX.toUpperCaseFirst)(yQ))){var r,o;if(this.sheetName=(r=this.engine,o=this.hot.getSettings()[yQ].sheetName,((0,tJ.isUndefined)(o)||!r.doesSheetExist(o))&&(o=r.addSheet(o)),o),yK(y2,this))this.switchSheet(this.sheetName);else{let t=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,t)){yq(y1,this,!0);let e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),yq(y1,this,!1)}}}}function vt(t,e,i,r){if("get"!==r||yK(y1,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;let o=this.hot.toVisualRow(t);if(null===o||null===e)return;if(!this.isFormulaCellType(o,e)&&"ARRAY"!==this.getCellType(o,e)){if(ym(i.value)){var s;i.value=ym(s=i.value)?s.substr(1):s}return}let n={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId},a=this.engine.getCellValue(n),l=this.hot.getCellsMeta().find(t=>t.visualRow===o&&t.visualCol===e);void 0===l&&(l={}),"date"===l.type&&(0,eq.isNumeric)(a)&&(a=yb(a,l.dateFormat));let h="object"==typeof a&&null!==a?a.value:a;i.value=h}function ve(t,e,i,r){if("get"!==r||yK(y1,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;let o=this.hot.toVisualRow(t),s=this.hot.propToCol(e);if(null===o||null===s||!this.isFormulaCellType(o,s)&&"ARRAY"!==this.getCellType(o,s))return;let n=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===n.width&&0===n.height)return;let a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};i.value=this.engine.getCellSerialized(a)}function vi(t,e){if(y0(e))return;let i=[],r=[],o=this.engine.batch(()=>{t.forEach(t=>{let[e,o,,s]=t,n=this.hot.propToCol(o),a=this.hot.toPhysicalRow(e),l=this.hot.toPhysicalColumn(n),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};null!==a&&null!==l?this.syncChangeWithEngine(e,n,s):i.push([e,n,s]),r.push({address:h})})});i.length&&this.hot.addHookOnce("afterChange",()=>{let t=this.engine.batch(()=>{i.forEach(t=>{let[e,i,r]=t;this.syncChangeWithEngine(e,i,r)})});this.renderDependentSheets(t,!0)}),this.renderDependentSheets(o),this.validateDependentCells(o,r)}function vr(t,e){if(y0(e))return;let i=[],r=[];t.forEach(t=>{let[e,o,,s]=t,n=this.hot.propToCol(o);if(!(0,eq.isNumeric)(n))return;let a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(a)){(0,t6.warn)(`Not possible to set source cell data at ${JSON.stringify(a)}`);return}r.push({address:a}),i.push(...this.engine.setCellContents(a,s))}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function vo(t,e){let i=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(i=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[i,e]))return!1}function vs(t,e){let i=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(i=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[i,e]))return!1}function vn(t,e,i){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(i).every(t=>this.engine.isItPossibleToRemoveRows(this.sheetId,[t,1]))&&void 0}function va(t,e,i){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(i).every(t=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[t,1]))&&void 0}function vl(t,e,i){if(y0(i))return;let r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function vh(t,e,i){if(y0(i))return;let r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function vc(t,e,i,r){if(y0(r))return;let o=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),s=this.engine.batch(()=>{o.forEach(t=>{this.engine.removeRows(this.sheetId,[t,1])})});this.renderDependentSheets(s)}function vd(t,e,i,r){if(y0(r))return;let o=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),s=this.engine.batch(()=>{o.forEach(t=>{this.engine.removeColumns(this.sheetId,[t,1])})});this.renderDependentSheets(s)}function vu(t,e,i){var r;yq(y1,this,!0);let o=this.hot.getSourceDataArray(i,0,i+((null===(r=e.__children)||void 0===r?void 0:r.length)||0),this.hot.countSourceCols());yq(y1,this,!1),o.forEach((t,e)=>{t.forEach((t,r)=>{this.engine.setCellContents({col:r,row:i+e,sheet:this.sheetId},[[t]])})})}function vg(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function vp(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function vf(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function vm(t){this.hot.runHooks("afterSheetAdded",t)}function vy(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function vv(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),eq=tn("guO5N"),eu=tn("ceXML"),t3=tn("hwT6B"),tJ=tn("gnaTS"),nd=tn("10euP");tn("1hIp0"),tn("1hIp0");var eu=tn("ceXML");function vw(t,e,i){vb(t,e),e.set(t,i)}function vb(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function vC(t,e){return t.get(vx(t,e))}function vS(t,e,i){return t.set(vx(t,e),i),i}function vx(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(0,nd.default).getSingleton().register("beforeHideColumns"),(0,nd.default).getSingleton().register("afterHideColumns"),(0,nd.default).getSingleton().register("beforeUnhideColumns"),(0,nd.default).getSingleton().register("afterUnhideColumns");const vE="hiddenColumns";var vR=new WeakMap,vT=new WeakMap,vM=new WeakSet;function vk(t,e){return this.isHidden(e)?0:vC(vR,this).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&"number"==typeof t&&this.hot.hasColHeaders()?t+15:void 0}function vA(t,e,i){if(!1===vC(vR,this).copyPasteEnabled&&this.isHidden(e)&&(i.skipColumnOnPaste=!0),this.isHidden(e-1))i.className=i.className||"",-1===i.className.indexOf("afterHiddenColumn")&&(i.className+=" afterHiddenColumn");else if(i.className){let t=i.className.split(" ");if(t.length>0){let e=t.indexOf("afterHiddenColumn");e>-1&&t.splice(e,1),i.className=t.join(" ")}}}function vO(t){if(vC(vR,this).copyPasteEnabled)return t;let e=[],i=(t,i,r,o)=>{e.push({startRow:t,endRow:i,startCol:r,endCol:o})};return(0,eu.arrayEach)(t,t=>{let e=!0,r=0;(0,eq.rangeEach)(t.startCol,t.endCol,o=>{this.isHidden(o)?(e||i(t.startRow,t.endRow,r,o-1),e=!0):(e&&(r=o),o===t.endCol&&i(t.startRow,t.endRow,r,o),e=!1)})}),e}function vP(t,e){if(!vC(vR,this).indicators||t<0)return;let i=[];t>=1&&this.isHidden(t-1)&&i.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&i.push("beforeHiddenColumn"),(0,tZ.addClass)(e,i)}function vI(t){var e;t.items.push({name:ud},(e=this,{key:"hidden_columns_hide",name(){let t=this.getSelectedLast(),e=0;if(Array.isArray(t)){let[,i,,r]=t;i-r!=0&&(e=1)}return this.getTranslatedPhrase(n6,e)},callback(){let{from:t,to:i}=this.getSelectedRangeLast(),r=Math.max(Math.min(t.col,i.col),0),o=Math.max(t.col,i.col),s=[];for(let t=r;t<=o;t+=1)s.push(t);e.hideColumns(s);let n=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(n,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(t){let e=[];return{key:"hidden_columns_show",name(){let t=e.length>1?1:0;return this.getTranslatedPhrase(n4,t)},callback(){var i,r;if(0===e.length)return;let o=e[0],s=e[e.length-1];o=null!==(i=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))&&void 0!==i?i:0,s=null!==(r=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))&&void 0!==r?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),s-o+1!==this.countCols()&&this.selectColumns(o,s)},disabled:!1,hidden(){let i=(0,eu.arrayMap)(t.getHiddenColumns(),t=>this.toPhysicalColumn(t));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;e.length=0;let r=this.getSelectedRangeLast(),o=r.getTopStartCorner().col,s=r.getBottomEndCorner().col,n=this.columnIndexMapper,a=n.getRenderableFromVisualIndex(o),l=n.getRenderableFromVisualIndex(s),h=n.getNotTrimmedIndexes(),c=[];if(o!==s){if(s-o+1>l-a+1){let t=h.slice(o,s+1);c.push(...t.filter(t=>i.includes(t)))}}else if(0===a&&a<o)c.push(...h.slice(0,o));else if(null===a)c.push(...h.slice(0,this.countCols()));else{let t=this.countCols()-1;l===n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(t,-1))&&t>s&&c.push(...h.slice(s+1))}return(0,eu.arrayEach)(c,t=>{e.push(this.toVisualColumn(t))}),0===e.length}}}(this))}function vH(){Array.isArray(vC(vR,this).columns)&&this.hideColumns(vC(vR,this).columns)}tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),eq=tn("guO5N"),eu=tn("ceXML"),t3=tn("hwT6B"),tJ=tn("gnaTS"),nd=tn("10euP");tn("1hIp0"),tn("1hIp0");var eu=tn("ceXML");function vL(t,e,i){vD(t,e),e.set(t,i)}function vD(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function vN(t,e){return t.get(vF(t,e))}function v_(t,e,i){return t.set(vF(t,e),i),i}function vF(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(0,nd.default).getSingleton().register("beforeHideRows"),(0,nd.default).getSingleton().register("afterHideRows"),(0,nd.default).getSingleton().register("beforeUnhideRows"),(0,nd.default).getSingleton().register("afterUnhideRows");const vj="hiddenRows";var vB=new WeakMap,vW=new WeakMap,vV=new WeakSet;function vU(t,e){return this.isHidden(e)?0:t}function vz(t,e,i){if(!1===vN(vB,this).copyPasteEnabled&&this.isHidden(t)&&(i.skipRowOnPaste=!0),this.isHidden(t-1))i.className=i.className||"",-1===i.className.indexOf("afterHiddenRow")&&(i.className+=" afterHiddenRow");else if(i.className){let t=i.className.split(" ");if(t.length>0){let e=t.indexOf("afterHiddenRow");e>-1&&t.splice(e,1),i.className=t.join(" ")}}}function vY(t){if(vN(vB,this).copyPasteEnabled)return t;let e=[],i=(t,i,r,o)=>{e.push({startRow:t,endRow:i,startCol:r,endCol:o})};return(0,eu.arrayEach)(t,t=>{let e=!0,r=0;(0,eq.rangeEach)(t.startRow,t.endRow,o=>{this.isHidden(o)?(e||i(r,o-1,t.startCol,t.endCol),e=!0):(e&&(r=o),o===t.endRow&&i(r,o,t.startCol,t.endCol),e=!1)})}),e}function vG(t,e){if(!vN(vB,this).indicators||t<0)return;let i=[];t>=1&&this.isHidden(t-1)&&i.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&i.push("beforeHiddenRow"),(0,tZ.addClass)(e,i)}function v$(t){var e;t.items.push({name:ud},(e=this,{key:"hidden_rows_hide",name(){let t=this.getSelectedLast(),e=0;if(Array.isArray(t)){let[i,,r]=t;i-r!=0&&(e=1)}return this.getTranslatedPhrase(n5,e)},callback(){let{from:t,to:i}=this.getSelectedRangeLast(),r=Math.max(Math.min(t.row,i.row),0),o=Math.max(t.row,i.row),s=[];for(let t=r;t<=o;t+=1)s.push(t);e.hideRows(s);let n=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(n,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(t){let e=[];return{key:"hidden_rows_show",name(){let t=e.length>1?1:0;return this.getTranslatedPhrase(n9,t)},callback(){var i,r;if(0===e.length)return;let o=e[0],s=e[e.length-1];o=null!==(i=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))&&void 0!==i?i:0,s=null!==(r=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))&&void 0!==r?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),s-o+1!==this.countRows()&&this.selectRows(o,s)},disabled:!1,hidden(){let i=(0,eu.arrayMap)(t.getHiddenRows(),t=>this.toPhysicalRow(t));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;e.length=0;let r=this.getSelectedRangeLast(),o=r.getTopStartCorner().row,s=r.getBottomEndCorner().row,n=this.rowIndexMapper,a=n.getRenderableFromVisualIndex(o),l=n.getRenderableFromVisualIndex(s),h=n.getNotTrimmedIndexes(),c=[];if(o!==s){if(s-o+1>l-a+1){let t=h.slice(o,s+1);c.push(...t.filter(t=>i.includes(t)))}}else if(0===a&&a<o)c.push(...h.slice(0,o));else if(null===a)c.push(...h.slice(0,this.countRows()));else{let t=this.countRows()-1;l===n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(t,-1))&&t>s&&c.push(...h.slice(s+1))}return(0,eu.arrayEach)(c,t=>{e.push(this.toVisualRow(t))}),0===e.length}}}(this))}function vX(){Array.isArray(vN(vB,this).rows)&&this.hideRows(vN(vB,this).rows)}tn("1C6fS"),tn("1hIp0");var nd=tn("10euP");function vq(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function vK(t,e){return t.get(vQ(t,e))}function vZ(t,e,i){return t.set(vQ(t,e),i),i}function vQ(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(0,nd.default).getSingleton().register("beforeColumnFreeze"),(0,nd.default).getSingleton().register("afterColumnFreeze"),(0,nd.default).getSingleton().register("beforeColumnUnfreeze"),(0,nd.default).getSingleton().register("afterColumnUnfreeze");const vJ="manualColumnFreeze";var v0=new WeakMap,v1=new WeakSet;function v2(t){var e,i;t.items.push({name:"---------"},(e=this,{key:"freeze_column",name(){return this.getTranslatedPhrase(nL)},callback(t,i){let[{start:{col:r}}]=i;e.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){let t=this.getSelectedRange(),e=!1;return void 0===t?e=!0:t.length>1?e=!0:(t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(e=!0),e}}),(i=this,{key:"unfreeze_column",name(){return this.getTranslatedPhrase(nD)},callback(t,e){let[{start:{col:r}}]=e;i.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){let t=this.getSelectedRange(),e=!1;return void 0===t?e=!0:t.length>1?e=!0:(t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(e=!0),e}}))}function v3(t,e){if(vK(v0,this)){let i=this.hot.getSettings().fixedColumnsStart;if(e<i||t.some(t=>t<i))return!1}}tn("1C6fS"),tn("1hIp0");var nd=tn("10euP"),eu=tn("ceXML"),tZ=tn("gFbQZ"),iy=tn("7HxIw"),eq=tn("guO5N");tn("1C6fS");var eq=tn("guO5N"),eX=tn("bO142");function v6(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var v4=class{constructor(t){v6(this,"hot",void 0),v6(this,"_element",null),v6(this,"state",0),v6(this,"inlineProperty",void 0),this.hot=t,this.inlineProperty=t.isRtl()?"right":"left"}appendTo(t){t.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(t,e){(0,eq.isNumeric)(t)&&(this._element.style.top=t+"px"),(0,eq.isNumeric)(e)&&(this._element.style[this.inlineProperty]=e+"px")}getPosition(){let t=this._element.style;return{top:t.top?parseInt(t.top,10):0,start:t[this.inlineProperty]?parseInt(t[this.inlineProperty],10):0}}setSize(t,e){(0,eq.isNumeric)(t)&&(this._element.style.width=t+"px"),(0,eq.isNumeric)(e)&&(this._element.style.height=e+"px")}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){(0,eq.isNumeric)(t)&&(this._element.style.marginTop=t+"px"),(0,eq.isNumeric)(e)&&(this._element.style[`margin${(0,eX.toUpperCaseFirst)(this.inlineProperty)}`]=e+"px")}getOffset(){let t=this._element.style,e=`margin${(0,eX.toUpperCaseFirst)(this.inlineProperty)}`;return{top:t.marginTop?parseInt(t.marginTop,10):0,start:t[e]?parseInt(t[e],10):0}}},tZ=tn("gFbQZ"),v5=class extends v4{build(){super.build(),(0,tZ.addClass)(this._element,"ht__manualColumnMove--backlight")}},tZ=tn("gFbQZ"),v9=class extends v4{build(){super.build(),(0,tZ.addClass)(this._element,"ht__manualColumnMove--guideline")}};function v8(t,e,i){v7(t,e),e.set(t,i)}function v7(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function wt(t,e,i){return t.set(wi(t,e),i),i}function we(t,e){return t.get(wi(t,e))}function wi(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(0,nd.default).getSingleton().register("beforeColumnMove"),(0,nd.default).getSingleton().register("afterColumnMove");const wr="manualColumnMove",wo="ht__manualColumnMove",ws="show-ui",wn="on-moving--columns",wa="after-selection--columns";var wl=new WeakMap,wh=new WeakMap,wc=new WeakMap,wd=new WeakMap,wu=new WeakMap,wg=new WeakMap,wp=new WeakMap,wf=new WeakMap,wm=new WeakMap,wy=new WeakMap,wv=new WeakMap,ww=new WeakSet;function wb(t,e,i,r){let o=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),n=this.hot.getSelectedRangeLast(),a=(0,tZ.hasClass)(t.target,"sortAction");if(!n||!s||we(wu,this)||0!==t.button||a){wt(wu,this,!1),we(wc,this).length=0,(0,tZ.removeClass)(this.hot.rootElement,[wn,ws]);return}let l=we(wh,this).isBuilt()&&!we(wh,this).isAppended(),h=we(wl,this).isBuilt()&&!we(wl,this).isAppended();l&&h&&(we(wh,this).appendTo(o.hider),we(wl,this).appendTo(o.hider));let{from:c,to:d}=n,u=Math.min(c.col,d.col),g=Math.max(c.col,d.col);if(e.row<0&&e.col>=u&&e.col<=g){r.column=!0,wt(wu,this,!0);let s=i.firstChild?(0,iy.offsetRelativeTo)(t,i.firstChild).x:t.offsetX;we(wg,this).eventPageX=t.pageX,wt(wf,this,e.col),we(wg,this).TD=i,we(wg,this).col=e.col,wt(wc,this,this.prepareColumnsToMoving(u,g)),wt(wy,this,!!this.hot.getSettings().rowHeaders),wt(wd,this,this.hot.countCols()),wt(wv,this,this.hot.getSettings().fixedColumnsStart),wt(wm,this,(0,tZ.offset)(this.hot.rootElement).left);let n=we(wy,this)?-1:0,a=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,l=e.col<we(wv,this),h=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),c=Math.abs(s-(this.hot.isRtl()?i.offsetWidth:0)),d=this.getColumnsWidth(u,e.col-1)+c,p=this.getColumnsWidth(n,u-1)+(l?h:0)+d;we(wl,this).setPosition(a,p),we(wl,this).setSize(this.getColumnsWidth(u,g),o.hider.offsetHeight-a),we(wl,this).setOffset(null,-d),(0,tZ.addClass)(this.hot.rootElement,wn)}else(0,tZ.removeClass)(this.hot.rootElement,wa),wt(wu,this,!1),we(wc,this).length=0}function wC(t){we(wu,this)&&(we(wg,this).eventPageX=t.pageX,this.refreshPositions())}function wS(t,e,i,r){this.hot.getSelectedRangeLast()&&we(wu,this)&&(we(wc,this).indexOf(e.col)>-1?(0,tZ.removeClass)(this.hot.rootElement,ws):(0,tZ.addClass)(this.hot.rootElement,ws),r.row=!0,r.column=!0,r.cell=!0,wt(wf,this,e.col),we(wg,this).TD=i)}function wx(){let t=we(wg,this).col,e=we(wc,this).length;if(wt(wf,this,void 0),wt(wu,this,!1),(0,tZ.removeClass)(this.hot.rootElement,[wn,ws,wa]),this.hot.selection.isSelectedByColumnHeader()&&(0,tZ.addClass)(this.hot.rootElement,wa),e<1||void 0===t)return;let i=we(wc,this)[0],r=this.hot.toPhysicalColumn(i),o=this.dragColumns(we(wc,this),t);if(we(wc,this).length=0,!0===o){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);let t=this.hot.toVisualColumn(r);this.hot.selectColumns(t,t+e-1)}}function wE(){let t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1+t.holder.scrollTop;we(wl,this).setPosition(e),we(wl,this).setSize(null,t.hider.offsetHeight-e)}function wR(){this.moveBySettingsOrLoad()}tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),eu=tn("ceXML"),eq=tn("guO5N");function wT(t,e,i){wM(t,e),e.set(t,i)}function wM(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function wk(t,e,i){return t.set(wO(t,e),i),i}function wA(t,e){return t.get(wO(t,e))}function wO(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const wP="manualColumnResize",wI="manualColumnWidths";var wH=new WeakMap,wL=new WeakMap,wD=new WeakMap,wN=new WeakMap,w_=new WeakMap,wF=new WeakMap,wj=new WeakMap,wB=new WeakMap,wW=new WeakMap,wV=new WeakMap,wU=new WeakMap,wz=new WeakMap,wY=new WeakMap,wG=new WeakMap,w$=new WeakMap,wX=new WeakMap,wq=new WeakSet;function wK(){let t=this.hot.getSettings()[wP],e=this.loadManualColumnWidths();void 0!==e?this.hot.batchExecution(()=>{e.forEach((t,e)=>{wA(w$,this).setValueAtIndex(e,t)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((t,e)=>{wA(w$,this).setValueAtIndex(e,t)})},!0),wk(wX,this,t)):!0===t&&Array.isArray(wA(wX,this))&&this.hot.batchExecution(()=>{wA(wX,this).forEach((t,e)=>{wA(w$,this).setValueAtIndex(e,t)})},!0)}function wZ(t){if(!(0,tZ.isDetached)(t.target)&&!0!==wA(wz,this)&&this.checkIfColumnHeader(t.target)){let e=this.getClosestTHParent(t.target);if(!e)return;let i=e.getAttribute("colspan");e&&(null===i||"1"===i)&&!wA(wU,this)&&this.setupHandlePosition(e)}}function wQ(t){t.target.parentNode===this.hot.rootElement&&(0,tZ.hasClass)(t.target,"manualColumnResizer")&&(this.setupHandlePosition(wA(wH,this)),this.setupGuidePosition(),wk(wU,this,!0),null===wA(wG,this)&&(wk(wG,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(wA(wG,this))),wk(wY,this,wA(wY,this)+1),this.startX=t.pageX,wk(w_,this,wA(wj,this)))}function wJ(t){if(wA(wU,this)){let e=(t.pageX-this.startX)*this.hot.getDirectionFactor();wk(wN,this,wA(wj,this)+e),(0,eu.arrayEach)(wA(wD,this),t=>{wk(w_,this,this.setManualSize(t,wA(wN,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function w0(){let t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,i)=>{this.hot.runHooks("beforeColumnResize",wA(w_,this),e,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",wA(w_,this),e,!1)};wA(wU,this)&&(this.hideHandleAndGuide(),wk(wU,this,!1),wA(w_,this)!==wA(wj,this)&&(wA(wD,this).length>1?((0,eu.arrayEach)(wA(wD,this),t=>{e(t)}),t()):(0,eu.arrayEach)(wA(wD,this),t=>{e(t,!0)})),this.setupHandlePosition(wA(wH,this)))}function w1(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(wA(wW,this)),this.hot.rootElement.removeChild(wA(wV,this)),wk(wU,this,!1),wk(wz,this,!0),this.hot._registerImmediate(()=>{wk(wz,this,!1)})}function w2(t,e){let i=t;if(this.enabled){let t=this.hot.toPhysicalColumn(e),r=wA(w$,this).getValueAtIndex(t);this.hot.getSettings()[wP]&&r&&(i=r)}return i}function w3(t,e){let i=wA(w$,this).getValueAtIndex(e);return null===i&&(i=t),i}function w6(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}tn("1C6fS"),tn("1hIp0");var nd=tn("10euP"),eu=tn("ceXML"),tZ=tn("gFbQZ"),eq=tn("guO5N");function w4(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}tn("1C6fS");var w5=class{constructor(t){w4(this,"hot",void 0),w4(this,"_element",null),w4(this,"state",0),this.hot=t}appendTo(t){t.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(t,e){void 0!==t&&(this._element.style.top=t+"px"),void 0!==e&&(this._element.style.left=e+"px")}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(t,e){t&&(this._element.style.width=t+"px"),e&&(this._element.style.height=e+"px")}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){t&&(this._element.style.marginTop=t+"px"),e&&(this._element.style.marginLeft=e+"px")}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},tZ=tn("gFbQZ"),w9=class extends w5{build(){super.build(),(0,tZ.addClass)(this._element,"ht__manualRowMove--backlight")}},tZ=tn("gFbQZ"),w8=class extends w5{build(){super.build(),(0,tZ.addClass)(this._element,"ht__manualRowMove--guideline")}};function w7(t,e,i){bt(t,e),e.set(t,i)}function bt(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function be(t,e,i){return t.set(br(t,e),i),i}function bi(t,e){return t.get(br(t,e))}function br(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(0,nd.default).getSingleton().register("beforeRowMove"),(0,nd.default).getSingleton().register("afterRowMove");const bo="manualRowMove",bs="ht__manualRowMove",bn="show-ui",ba="on-moving--rows",bl="after-selection--rows";var bh=new WeakMap,bc=new WeakMap,bd=new WeakMap,bu=new WeakMap,bg=new WeakMap,bp=new WeakMap,bf=new WeakSet;function bm(t,e,i,r){let{wtTable:o,wtViewport:s}=this.hot.view._wt,n=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!n||bi(bu,this)||0!==t.button){be(bu,this,!1),bi(bd,this).length=0,(0,tZ.removeClass)(this.hot.rootElement,[ba,bn]);return}let l=bi(bc,this).isBuilt()&&!bi(bc,this).isAppended(),h=bi(bh,this).isBuilt()&&!bi(bh,this).isAppended();l&&h&&(bi(bc,this).appendTo(o.hider),bi(bh,this).appendTo(o.hider));let{from:c,to:d}=a,u=Math.min(c.row,d.row),g=Math.max(c.row,d.row);if(e.col<0&&e.row>=u&&e.row<=g){r.row=!0,be(bu,this,!0),bi(bg,this).eventPageY=t.pageY,bi(bg,this).coords=e,bi(bg,this).TD=i,be(bd,this,this.prepareRowsToMoving());let n=o.holder.scrollLeft+s.getRowHeaderWidth(),a=this.getRowsHeight(u,e.row-1)+t.offsetY;bi(bh,this).setPosition(null,n),bi(bh,this).setSize(o.hider.offsetWidth-n,this.getRowsHeight(u,g)),bi(bh,this).setOffset(-a,null),(0,tZ.addClass)(this.hot.rootElement,ba),this.refreshPositions()}else(0,tZ.removeClass)(this.hot.rootElement,bl),be(bu,this,!1),bi(bd,this).length=0}function by(t){bi(bu,this)&&(bi(bg,this).eventPageY=t.pageY,this.refreshPositions())}function bv(t,e,i,r){this.hot.getSelectedRangeLast()&&bi(bu,this)&&(bi(bd,this).indexOf(e.row)>-1?(0,tZ.removeClass)(this.hot.rootElement,bn):(0,tZ.addClass)(this.hot.rootElement,bn),r.row=!0,r.column=!0,r.cell=!0,bi(bg,this).coords=e,bi(bg,this).TD=i)}function bw(){let t=bi(bg,this).row,e=bi(bd,this).length;if(be(bu,this,!1),(0,tZ.removeClass)(this.hot.rootElement,[ba,bn,bl]),this.hot.selection.isSelectedByRowHeader()&&(0,tZ.addClass)(this.hot.rootElement,bl),e<1||void 0===t)return;let i=bi(bd,this)[0],r=this.hot.toPhysicalRow(i),o=this.dragRows(bi(bd,this),t);if(bi(bd,this).length=0,!0===o){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);let t=this.hot.toVisualRow(r);this.hot.selectRows(t,t+e-1)}}function bb(){let t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth()+t.holder.scrollLeft;bi(bh,this).setPosition(null,e),bi(bh,this).setSize(t.hider.offsetWidth-e)}function bC(){this.moveBySettingsOrLoad()}tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),eu=tn("ceXML"),eq=tn("guO5N");function bS(t,e,i){bx(t,e),e.set(t,i)}function bx(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function bE(t,e,i){return t.set(bT(t,e),i),i}function bR(t,e){return t.get(bT(t,e))}function bT(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const bM="manualRowResize",bk="manualRowHeights";var bA=new WeakMap,bO=new WeakMap,bP=new WeakMap,bI=new WeakMap,bH=new WeakMap,bL=new WeakMap,bD=new WeakMap,bN=new WeakMap,b_=new WeakMap,bF=new WeakMap,bj=new WeakMap,bB=new WeakMap,bW=new WeakMap,bV=new WeakMap,bU=new WeakMap,bz=new WeakMap,bY=new WeakSet;function bG(t){if(!(0,tZ.isDetached)(t.target)&&!0!==bR(bB,this)&&this.checkIfRowHeader(t.target)){let e=this.getClosestTHParent(t.target);e&&!bR(bj,this)&&this.setupHandlePosition(e)}}function b$(t){(0,tZ.hasClass)(t.target,"manualRowResizer")&&(this.setupHandlePosition(bR(bA,this)),this.setupGuidePosition(),bE(bj,this,!0),null===bR(bV,this)&&(bE(bV,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(bR(bV,this))),bE(bW,this,bR(bW,this)+1),bE(bL,this,t.pageY),bE(bH,this,bR(bD,this)))}function bX(t){bR(bj,this)&&(bE(bI,this,bR(bD,this)+(t.pageY-bR(bL,this))),(0,eu.arrayEach)(bR(bP,this),t=>{bE(bH,this,this.setManualSize(t,bR(bI,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function bq(){let t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!1)};bR(bj,this)&&(this.hideHandleAndGuide(),bE(bj,this,!1),bR(bH,this)!==bR(bD,this)&&(bR(bP,this).length>1?((0,eu.arrayEach)(bR(bP,this),t=>{e(t)}),t()):(0,eu.arrayEach)(bR(bP,this),t=>{e(t,!0)})),this.setupHandlePosition(bR(bA,this)))}function bK(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(bR(b_,this)),this.hot.rootElement.removeChild(bR(bF,this)),bE(bj,this,!1),bE(bB,this,!0),this.hot._registerImmediate(()=>{bE(bB,this,!1)})}function bZ(t,e){let i=t;if(this.enabled){let t=this.hot.toPhysicalRow(e),r=bR(bU,this).getValueAtIndex(t);this.hot.getSettings()[bM]&&r&&(i=r)}return i}function bQ(){let t=this.hot.getSettings()[bM],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{void 0!==e?e.forEach((t,e)=>{bR(bU,this).setValueAtIndex(e,t)}):Array.isArray(t)?(t.forEach((t,e)=>{bR(bU,this).setValueAtIndex(e,t)}),bE(bz,this,t)):!0===t&&Array.isArray(bR(bz,this))&&bR(bz,this).forEach((t,e)=>{bR(bU,this).setValueAtIndex(e,t)})},!0)}tn("1C6fS"),tn("1hIp0");var nd=tn("10euP");tn("1C6fS"),tn("1hIp0"),oa("flatMap"),tn("1C6fS");var iJ=tn("iCsRe");function bJ(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var b0=class{constructor(t,e,i,r,o,s){bJ(this,"row",void 0),bJ(this,"col",void 0),bJ(this,"rowspan",void 0),bJ(this,"colspan",void 0),bJ(this,"removed",!1),bJ(this,"cellCoordsFactory",void 0),bJ(this,"cellRangeFactory",void 0),this.row=t,this.col=e,this.rowspan=i,this.colspan=r,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(t){return(0,iJ.toSingleLine)`The merged cell declared with {row: ${t.row}, col: ${t.col},\x20
      rowspan: ${t.rowspan}, colspan: ${t.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(t){return(0,iJ.toSingleLine)`The merged cell declared at [${t.row}, ${t.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(t){return(0,iJ.toSingleLine)`The merged cell declared at [${t.row}, ${t.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(t){return(0,iJ.toSingleLine)`The merged cell declared at [${t.row}, ${t.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}static isSingleCell(t){return 1===t.colspan&&1===t.rowspan}static containsZeroSpan(t){return 0===t.colspan||0===t.rowspan}static isOutOfBounds(t,e,i){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=i||t.col+t.colspan-1>=i}normalize(t){let e=t.countRows(),i=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col)}includes(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}includesHorizontally(t){return this.col<=t&&this.col+this.colspan-1>=t}includesVertically(t){return this.row<=t&&this.row+this.rowspan-1>=t}shift(t,e){let i=t[0]||t[1],r=e+Math.abs(t[0]||t[1])-1,o=t[0]?"colspan":"rowspan",s=t[0]?"col":"row",n=Math.min(e,r),a=Math.max(e,r),l=this[s],h=this[s]+this[o]-1;if(l>=e&&(this[s]+=i),i>0)e<=h&&e>l&&(this[o]+=i);else if(i<0){if(n<=l&&a>=h)return this.removed=!0,!1;if(l>=n&&l<=a){let t=a-l+1,e=Math.abs(i)-t;this[s]-=e+i,this[o]-=t}else l<=n&&h>=a?this[o]+=i:l<=n&&h>=n&&h<a&&(this[o]-=h-n+1)}return!0}isFarther(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}},eq=tn("guO5N"),t6=tn("jlXkd"),eu=tn("ceXML");function b1(t,e,i,r){e?e.row===i&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}var iJ=tn("iCsRe");function b2(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function b3(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var b6=new WeakSet;class b4{constructor(t){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,b6),b6.add(this),b2(this,"plugin",void 0),b2(this,"mergedCells",[]),b2(this,"hot",void 0),this.plugin=t,this.hot=t.hot}static IS_OVERLAPPING_WARNING(t){return(0,iJ.toSingleLine)`The merged cell declared at [${t.row}, ${t.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(t,e){let i=this.mergedCells,r=!1;return(0,eu.arrayEach)(i,i=>!(i.row<=t)||!(i.row+i.rowspan-1>=t)||!(i.col<=e)||!(i.col+i.colspan-1>=e)||(r=i,!1)),r}getByRange(t){let e=this.mergedCells,i=!1;return(0,eu.arrayEach)(e,e=>!(e.row<=t.from.row)||!(e.row+e.rowspan-1>=t.to.row)||!(e.col<=t.from.col)||!(e.col+e.colspan-1>=t.to.col)||(i=e)),i}getWithinRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.mergedCells,r=[],o=t;if(!o.includesRange){let t=this.hot._createCellCoords(o.from.row,o.from.col),e=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(t,t,e)}return(0,eu.arrayEach)(i,t=>{let i=this.hot._createCellCoords(t.row,t.col),s=this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),n=this.hot._createCellRange(i,i,s);e?o.overlaps(n)&&r.push(t):o.includesRange(n)&&r.push(t)}),!!r.length&&r}add(t){let e=this.mergedCells,i=t.row,r=t.col,o=new b0(i,r,t.rowspan,t.colspan,this.hot._createCellCoords,this.hot._createCellRange),s=this.get(i,r),n=this.isOverlapping(o);return s||n?((0,t6.warn)(b4.IS_OVERLAPPING_WARNING(o)),!1):(this.hot&&o.normalize(this.hot),e.push(o),o)}remove(t,e){let i=this.mergedCells,r=this.get(t,e),o=r?this.mergedCells.indexOf(r):-1;return!!r&&-1!==o&&(i.splice(o,1),r)}clear(){let t=this.mergedCells,e=[],i=[];(0,eu.arrayEach)(t,t=>{let i=this.hot.getCell(t.row,t.col);i&&e.push([i,this.get(t.row,t.col),t.row,t.col])}),this.mergedCells.length=0,(0,eu.arrayEach)(e,(t,r)=>{(0,eq.rangeEach)(0,t.rowspan-1,e=>{(0,eq.rangeEach)(0,t.colspan-1,r=>{if(0!==r||0!==e){let o=this.hot.getCell(t.row+e,t.col+r);o&&i.push([o,null,null,null])}})}),e[r][1]=null}),(0,eu.arrayEach)(e,t=>{b1(...t)}),(0,eu.arrayEach)(i,t=>{b1(...t)})}isOverlapping(t){let e=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1)),i=!1;return(0,eu.arrayEach)(this.mergedCells,t=>!this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1)).overlaps(e)||(i=!0,!1)),i}isFirstRenderableMergedCell(t,e){let i=this.get(t,e);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===e}getFirstRenderableCoords(t,e){let i=this.get(t,e);if(!i||this.isFirstRenderableMergedCell(t,e))return this.hot._createCellCoords(t,e);let r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(r,o)}getStartMostColumnIndex(t,e){let i=b3(b6,this,b5).call(this,t,"col",-1),r=e;for(let t=0;t<i.length;t++)if(i[t]<=e){r=i[t];break}return r}getEndMostColumnIndex(t,e){let i=b3(b6,this,b5).call(this,t,"col",1),r=e;for(let t=0;t<i.length;t++)if(i[t]>=e){r=i[t];break}return r}getTopMostRowIndex(t,e){let i=b3(b6,this,b5).call(this,t,"row",-1),r=e;for(let t=0;t<i.length;t++)if(i[t]<=e){r=i[t];break}return r}getBottomMostRowIndex(t,e){let i=b3(b6,this,b5).call(this,t,"row",1),r=e;for(let t=0;t<i.length;t++)if(i[t]>=e){r=i[t];break}return r}shiftCollections(t,e,i){let r=[0,0];switch(t){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i}(0,eu.arrayEach)(this.mergedCells,t=>{t.shift(r,e)}),(0,eq.rangeEachReverse)(this.mergedCells.length-1,0,t=>{let e=this.mergedCells[t];e&&e.removed&&this.mergedCells.splice(this.mergedCells.indexOf(e),1)})}}function b5(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=new Map,o=1===i?t.getTopStartCorner():t.getBottomEndCorner(),s=1===i?t.getBottomEndCorner():t.getTopStartCorner();for(let t=o.row;1===i?t<=s.row:t>=s.row;t+=i)for(let n=o.col;1===i?n<=s.col:n>=s.col;n+=i){let o="row"===e?t:n,s=this.get(t,n),a=o;s&&(a=1===i?s[e]+s[`${e}span`]-1:s[e]),r.has(o)||r.set(o,new Set),r.get(o).add(a)}return Array.from(new Set(Array.from(r.entries()).filter(t=>{let[,e]=t;return 1===e.size}).flatMap(t=>{let[,e]=t;return Array.from(e)})))}tn("1C6fS");var t3=tn("hwT6B"),eu=tn("ceXML");function b9(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var b8=class{constructor(t){b9(this,"plugin",void 0),b9(this,"mergedCellsCollection",void 0),b9(this,"currentFillData",null),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(t){if(t[0]===t[2]&&t[1]===t[3]){let e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}getDirection(t,e){return e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left"}snapDragArea(t,e,i,r){let o=e.slice(0),s=this.getAutofillSize(t,e,i),[n,a,l,h]=t,c=["up","down"].indexOf(i)>-1?l-n+1:h-a+1,d=Math.floor(s/c)*c,u=s-d,g=this.getFarthestCollection(t,e,i,r);if(g){if("down"===i){let t=g.row+g.rowspan-n-u;o[2]+t>=this.plugin.hot.countRows()?o[2]-=u:o[2]+=u?t:0}else if("right"===i){let t=g.col+g.colspan-a-u;o[3]+t>=this.plugin.hot.countCols()?o[3]-=u:o[3]+=u?t:0}else if("up"===i){let t=l-u-g.row+1;o[0]+t<0?o[0]+=u:o[0]-=u?t:0}else if("left"===i){let t=h-u-g.col+1;o[1]+t<0?o[1]+=u:o[1]-=u?t:0}}return this.updateCurrentFillCache({baseArea:t,dragDirection:i,foundMergedCells:r,fillSize:s,dragArea:o,cycleLength:c}),o}updateCurrentFillCache(t){this.currentFillData||(this.currentFillData={}),(0,t3.extend)(this.currentFillData,t)}getAutofillSize(t,e,i){let[r,o,s,n]=t,[a,l,h,c]=e;switch(i){case"up":return r-a;case"down":return h-s;case"left":return o-l;case"right":return c-n;default:return null}}getDragArea(t,e,i){let[r,o,s,n]=t,[a,l,h,c]=e;switch(i){case"up":return[a,l,r-1,n];case"down":return[s+1,o,h,n];case"left":return[a,l,s,o-1];case"right":return[r,n+1,h,c];default:return null}}getFarthestCollection(t,e,i,r){let[o,s,n,a]=t,l=["up","down"].indexOf(i)>-1,h=l?n:a,c=l?o:s,d=this.getAutofillSize(t,e,i),u=l?n-o+1:a-s+1,g=Math.floor(d/u)*u,p=d-g,f=null,m=null,y=null;switch(i){case"up":f="includesVertically",y=h-p+1;break;case"left":f="includesHorizontally",y=h-p+1;break;case"down":f="includesVertically",y=c+p-1;break;case"right":f="includesHorizontally",y=c+p-1}return(0,eu.arrayEach)(r,t=>{t[f](y)&&t.isFarther(m,i)&&(m=t)}),m}recreateAfterDataPopulation(t){if(!this.currentFillData)return;let e=this.getRangeFromChanges(t),i=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=(t,i)=>{switch(r){case"up":return t.row-i>=e.from.row;case"down":return t.row+t.rowspan-1+i<=e.to.row;case"left":return t.col-i>=e.from.column;case"right":return t.col+t.colspan-1+i<=e.to.column;default:return null}},s=0,n=null,a=1;do for(let t=0;t<i.length;t+=1){if(o(n=i[t],s=a*this.currentFillData.cycleLength))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:n.row-s,rowspan:n.rowspan,col:n.col,colspan:n.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:n.row+s,rowspan:n.rowspan,col:n.col,colspan:n.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:n.row,rowspan:n.rowspan,col:n.col-s,colspan:n.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:n.row,rowspan:n.rowspan,col:n.col+s,colspan:n.colspan})}t===i.length-1&&(a+=1)}while(o(n,s))this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(t){let e={min:null,max:null},i={min:null,max:null};return(0,eu.arrayEach)(t,t=>{let r=t[0],o=this.plugin.hot.propToCol(t[1]);(null===e.min||r<e.min)&&(e.min=r),(null===e.max||r>e.max)&&(e.max=r),(null===i.min||o<i.min)&&(i.min=o),(null===i.max||o>i.max)&&(i.max=o)}),{from:{row:e.min,column:i.min},to:{row:e.max,column:i.max}}}dragAreaOverlapsCollections(t,e,i){let[r,o,s,n]=this.getDragArea(t,e,i),a=this.plugin.hot._createCellCoords(r,o),l=this.plugin.hot._createCellCoords(s,n),h=this.plugin.hot._createCellRange(a,a,l);return!!this.mergedCellsCollection.getWithinRange(h,!0)}};function b7(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}tn("1C6fS"),tn("1hIp0");var Ct=class{constructor(t){b7(this,"plugin",void 0),b7(this,"hot",void 0),b7(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=t,this.hot=t.hot}getSelectedMergedCellClassName(t,e,i,r){let o=Math.min(i[0],i[2]),s=Math.min(i[1],i[3]),n=Math.max(i[0],i[2]),a=Math.max(i[1],i[3]);if(void 0===r||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(t,e))return;let l=this.plugin.mergedCellsCollection.get(t,e);if(!l)return;let h=l.getLastRow(),c=l.getLastColumn();return o<=l.row&&s<=l.col&&n>=h&&a>=c?`${this.fullySelectedMergedCellClassName}-${r}`:this.isMergeCellFullySelected(l,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(t,e){let i=[];if(!e||!t)return!1;for(let e=0;e<t.rowspan;e+=1)for(let r=0;r<t.colspan;r+=1)i.push(this.hot._createCellCoords(t.row+e,t.col+r));for(let t=0;t<i.length;t+=1){let r=[];for(let o=0;o<e.length;o+=1)r[o]=e[o].includes(i[t]);if(!r.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){let t=[];for(let e=0;e<=7;e+=1)t.push(`${this.fullySelectedMergedCellClassName}-${e}`);return t.push(`${this.fullySelectedMergedCellClassName}-multiple`),t}},eu=tn("ceXML"),t3=tn("hwT6B"),t6=tn("jlXkd"),eq=tn("guO5N"),tZ=tn("gFbQZ"),t0=tn("eL8cl");function Ce(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}tn("1C6fS"),tn("1hIp0"),tn("1C6fS");class Ci{constructor(t){Ce(this,"data",void 0),Ce(this,"next",null),Ce(this,"prev",null),this.data=t}}var Cr=class{constructor(){Ce(this,"first",null),Ce(this,"last",null)}push(t){let e=new Ci(t);if(null===this.first)this.first=e,this.last=e;else{let t=this.last;this.last=e,e.prev=t,t.next=e}return e}unshift(t){let e=new Ci(t);if(null===this.first)this.first=e,this.last=e;else{let t=this.first;this.first=e,e.next=t,t.prev=e}}inorder(t){let e=this.first;for(;e;){let i=t(e);if(e===this.last||!0===i)break;e=e.next}}remove(t){let e,i;if(null===this.first)return!1;let r=this.first;for(;r;){if(r.data===t)return e=r.next,i=r.prev,e&&(e.prev=i),i&&(i.next=e),r===this.first&&(this.first=e),r===this.last&&(this.last=i),!0;r=r.next}return!1}hasCycle(){let t=this.first,e=this.first;for(;;){if(null===t||null===(t=t.next))return!1;if((t=t.next)===(e=e.next))return!0}}pop(){if(null===this.last)return null;let t=this.last;return this.last=this.last.prev,t}shift(){if(null===this.first)return null;let t=this.first;return this.first=this.first.next,t}recursiveReverse(){if(!this.first)return;!function t(e,i){i&&(t(i,i.next),i.next=e)}(this.first,this.first.next),this.first.next=null;let t=this.first;this.first=this.last,this.last=t}reverse(){let t;if(!this.first||!this.first.next)return;let e=this.first.next,i=this.first;for(;e;)t=e.next,e.next=i,i.prev=e,i=e,e=t;this.first.next=null,this.last.prev=null,t=this.first,this.first=i,this.last=t}};function Co(t,e,i){Cs(t,e),e.set(t,i)}function Cs(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function Cn(t,e){return t.get(Cl(t,e))}function Ca(t,e,i){return t.set(Cl(t,e),i),i}function Cl(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var Ch=new WeakMap,Cc=new WeakMap,Cd=new WeakMap,Cu=new WeakMap,Cg=new WeakMap,Cp=new WeakMap,Cf=new WeakMap,Cm=new WeakSet;class Cy{constructor(t){let{mergedCellsGetter:e,rowIndexMapper:i,columnIndexMapper:r}=t;Cs(this,Cm),Cm.add(this),Co(this,Ch,new Cr),Co(this,Cc,new Cr),Co(this,Cd,null),Co(this,Cu,null),Co(this,Cg,null),Co(this,Cp,null),Co(this,Cf,null),Ca(Cg,this,e),Ca(Cp,this,i),Ca(Cf,this,r)}getCurrentVerticalNode(){return Cn(Cu,this).data}getFirstVerticalNode(){return Cn(Cc,this).first.data}getNextVerticalNode(){return Cn(Cu,this).next.data}getPrevVerticalNode(){return Cn(Cu,this).prev.data}getCurrentHorizontalNode(){return Cn(Cd,this).data}getFirstHorizontalNode(){return Cn(Ch,this).first.data}getNextHorizontalNode(){return Cn(Cd,this).next.data}getPrevHorizontalNode(){return Cn(Cd,this).prev.data}setPrevNodeAsActive(){Ca(Cu,this,Cn(Cu,this).prev),Ca(Cd,this,Cn(Cd,this).prev)}setNextNodeAsActive(){Ca(Cu,this,Cn(Cu,this).next),Ca(Cd,this,Cn(Cd,this).next)}buildFocusOrder(t){let e=t.getTopStartCorner(),i=t.getBottomEndCorner(),r=new WeakSet;Ca(Ch,this,new Cr);for(let o=e.row;o<=i.row;o++)if(!Cn(Cp,this).isHidden(o))for(let s=e.col;s<=i.col;s++){if(Cn(Cf,this).isHidden(s))continue;let e=Cl(Cm,this,Cv).call(this,t,Cn(Ch,this),r,o,s);e&&Ca(Cd,this,e)}Cn(Ch,this).first&&(Cn(Ch,this).first.prev=Cn(Ch,this).last,Cn(Ch,this).last.next=Cn(Ch,this).first);let o=new WeakSet;Ca(Cc,this,new Cr);for(let r=e.col;r<=i.col;r++)if(!Cn(Cf,this).isHidden(r))for(let s=e.row;s<=i.row;s++){if(Cn(Cp,this).isHidden(s))continue;let e=Cl(Cm,this,Cv).call(this,t,Cn(Cc,this),o,s,r);e&&Ca(Cu,this,e)}Cn(Cc,this).first&&(Cn(Cc,this).first.prev=Cn(Cc,this).last,Cn(Cc,this).last.next=Cn(Cc,this).first)}setActiveNode(t,e){return Cn(Ch,this).inorder(i=>{let{rowStart:r,rowEnd:o,colStart:s,colEnd:n}=i.data;if(t>=r&&t<=o&&e>=s&&e<=n)return Ca(Cd,this,i),!1}),Cn(Cc,this).inorder(i=>{let{rowStart:r,rowEnd:o,colStart:s,colEnd:n}=i.data;if(t>=r&&t<=o&&e>=s&&e<=n)return Ca(Cu,this,i),!1}),this}}function Cv(t,e,i,r,o){let s=t.getTopStartCorner(),n=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=Cn(Cg,this).call(this,r,o);if(l&&i.has(l))return null;let h={colStart:o,colEnd:o,rowStart:r,rowEnd:r};if(l){if(i.add(l),l.row<s.row||l.row+l.rowspan-1>n.row||l.col<s.col||l.col+l.colspan-1>n.col)return null;h.colStart=l.col,h.colEnd=l.col+l.colspan-1,h.rowStart=l.row,h.rowEnd=l.row+l.rowspan-1}let c=e.push(h);return r===a.row&&o===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function Cw(t,e,i){Cb(t,e),e.set(t,i)}function Cb(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function CC(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function CS(t,e,i){return t.set(CE(t,e),i),i}function Cx(t,e){return t.get(CE(t,e))}function CE(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(0,nd.default).getSingleton().register("beforeMergeCells"),(0,nd.default).getSingleton().register("afterMergeCells"),(0,nd.default).getSingleton().register("beforeUnmergeCells"),(0,nd.default).getSingleton().register("afterUnmergeCells");const CR="mergeCells";var CT=new WeakMap,CM=new WeakMap,Ck=new WeakMap,CA=new WeakSet;function CO(){this.generateFromSettings(this.hot.getSettings()[CR]),this.hot.render()}function CP(t){if(t){let t=this.mergedCellsCollection.mergedCells,e=this.hot.getSelectedRangeLast(),i=e.getTopStartCorner(),r=e.getBottomEndCorner();for(let e=0;e<t.length;e+=1)if(i.row===t[e].row&&i.col===t[e].col&&r.row===t[e].row+t[e].rowspan-1&&r.col===t[e].col+t[e].colspan-1)return!1}return t}function CI(t){Cx(CM,this).row=t.row,Cx(CM,this).col=t.col}function CH(t){let{highlight:e}=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:r}=this.hot;Cx(CT,this)&&(null!==r.getRenderableFromVisualIndex(Cx(CT,this).row)&&(e.row=Cx(CT,this).row),null!==i.getRenderableFromVisualIndex(Cx(CT,this).col)&&(e.col=Cx(CT,this).col),CS(CT,this,null));let o=this.mergedCellsCollection.get(e.row,e.col);if(!o)return;let s=o.col,n=o.col+o.colspan-1;if(t.col<0){let r=e.col>=s&&e.col<=n?s-1:n,o=i.getNearestNotHiddenIndex(r,-1);null===o?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(o,e.col)-1,1)}else if(t.col>0){let r=e.col>=s&&e.col<=n?n+1:s,o=i.getNearestNotHiddenIndex(r,1);null===o?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,o)-1,1)}let a=o.row,l=o.row+o.rowspan-1;if(t.row<0){let i=e.row>=a&&e.row<=l?a-1:l,o=r.getNearestNotHiddenIndex(i,-1);null===o?t.row=-this.hot.view.countRenderableRowsInRange(0,e.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(o,e.row)-1,1)}else if(t.row>0){let i=e.row>=a&&e.row<=l?l+1:a,o=r.getNearestNotHiddenIndex(i,1);null===o?t.row=this.hot.view.countRenderableRowsInRange(e.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(e.row,o)-1,1)}}function CL(t){let e=this.hot.getSelectedRangeLast(),i=e.clone(),{to:r}=e,{columnIndexMapper:o,rowIndexMapper:s}=this.hot,n=(t,e)=>{i.expand(this.hot._createCellCoords(t,e));for(let t=0;t<this.mergedCellsCollection.mergedCells.length;t+=1)i.expandByRange(this.mergedCellsCollection.mergedCells[t].getRange())};if(t.col<0){let s=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;n(r.row,s),"E-W"===e.getHorizontalDirection()&&"E-W"===i.getHorizontalDirection()&&(s=i.getTopStartCorner().col);let a=o.getNearestNotHiddenIndex(s,1);null!==a&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,r.col)-1,1))}else if(t.col>0){let s=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;n(r.row,s),"W-E"===e.getHorizontalDirection()&&"W-E"===i.getHorizontalDirection()&&(s=i.getBottomEndCorner().col);let a=o.getNearestNotHiddenIndex(s,-1);null!==a&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,a)-1,1))}if(t.row<0){let o=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;n(o,r.col),"S-N"===e.getVerticalDirection()&&"S-N"===i.getVerticalDirection()&&(o=i.getTopStartCorner().row);let a=s.getNearestNotHiddenIndex(o,1);null!==a&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(a,r.row)-1,1))}else if(t.row>0){let o=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;n(o,r.col),"N-S"===e.getVerticalDirection()&&"N-S"===i.getVerticalDirection()&&(o=i.getBottomStartCorner().row);let a=s.getNearestNotHiddenIndex(o,-1);null!==a&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,a)-1,1))}}function CD(){let t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){CS(CT,this,e.clone());return}for(let e=0;e<this.mergedCellsCollection.mergedCells.length;e+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[e].getRange(),!1);for(let e=0;e<this.mergedCellsCollection.mergedCells.length;e+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[e].getRange(),!1);let i=this.mergedCellsCollection.get(e.row,e.col);CS(CT,this,e.clone()),i&&e.assign(i)}function CN(t,e){if(t<0||e<0)return;let i=this.mergedCellsCollection.get(t,e);if(!i)return;let{row:r,col:o,colspan:s,rowspan:n}=i;return[r,o,r+n-1,o+s-1]}function C_(t){var e;t.items.push({name:"---------"},(e=this,{key:"mergeCells",name(){let t=this.getSelectedLast();if(t){let i=e.mergedCellsCollection.get(t[0],t[1]);if(i.row===t[0]&&i.col===t[1]&&i.row+i.rowspan-1===t[2]&&i.col+i.colspan-1===t[3])return this.getTranslatedPhrase(n_)}return this.getTranslatedPhrase(nN)},callback(){let t=this.getSelectedRangeLast();if(!t)return;t.setDirection(this.isRtl()?"NE-SW":"NW-SE");let{from:i,to:r}=t;e.toggleMerge(t),this.selectCell(i.row,i.col,r.row,r.col,!1)},disabled(){let t=this.getSelectedLast();return!t||b0.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}function CF(t,e,i){let r=this.mergedCellsCollection.get(e,i),o=(0,t3.isObject)(r)?(0,t3.clone)(r):void 0;if((0,t3.isObject)(o)){let{rowIndexMapper:t,columnIndexMapper:r}=this.hot,{row:s,col:n,colspan:a,rowspan:l}=o,[h,c]=this.translateMergedCellToRenderable(s,l,n,a),d=t.getRenderableFromVisualIndex(e),u=r.getRenderableFromVisualIndex(i);o.row=t.getNearestNotHiddenIndex(o.row,1),o.col=r.getNearestNotHiddenIndex(o.col,1),o.rowspan=Math.min(o.rowspan,h-d+1),o.colspan=Math.min(o.colspan,c-u+1)}b1(t,o,e,i)}function Cj(){CS(CT,this,null)}function CB(){if(Cx(CT,this).isCell())return;let t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),i=t.getHorizontalDirection(),r=Cx(CT,this).clone().normalize();Cx(Ck,this).setActiveNode(r.row,r.col),Cx(CM,this).row>0||Cx(CM,this).col>0?Cx(Ck,this).setPrevNodeAsActive():("E-W"===i&&Cx(CM,this).col<0||"S-N"===e&&Cx(CM,this).row<0)&&Cx(Ck,this).setNextNodeAsActive()}function CW(t,e){let i=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:o}=this.hot,s=null,n=null;if(Cx(CM,this).col<0){let{rowEnd:t,colEnd:e}=Cx(Ck,this).getPrevHorizontalNode();n=r.getNearestNotHiddenIndex(e,-1),s=o.getNearestNotHiddenIndex(t,-1)}else if(Cx(CM,this).col>0){let{rowStart:t,colStart:e}=Cx(Ck,this).getNextHorizontalNode();n=r.getNearestNotHiddenIndex(e,1),s=o.getNearestNotHiddenIndex(t,1)}else if(Cx(CM,this).row<0){let{rowEnd:t,colEnd:e}=Cx(Ck,this).getPrevVerticalNode();n=r.getNearestNotHiddenIndex(e,-1),s=o.getNearestNotHiddenIndex(t,-1)}else if(Cx(CM,this).row>0){let{rowStart:t,colStart:e}=Cx(Ck,this).getNextVerticalNode();n=r.getNearestNotHiddenIndex(e,1),s=o.getNearestNotHiddenIndex(t,1)}if(null!==s||null!==n){let r=this.hot._createCellCoords(s,n),o=this.mergedCellsCollection.get(r.row,r.col),a=this.hot.selection.highlight.getFocus();t=r.row,e=r.col,o?i.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)}):i.highlight.assign(r),a.clear(),a.add(r).commit()}Cx(Ck,this).setActiveNode(t,e),CS(CM,this,{row:0,col:0})}function CV(){this.hot.getSelectedRangeLast().isHeader()||Cx(Ck,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function CU(t,e,i){let r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?i.copyable=!1:(i.rowspan=r.rowspan,i.colspan=r.colspan))}function Cz(t){let e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function CY(t){let e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function CG(t,e){this.autofillCalculations.correctSelectionAreaSize(e);let i=this.autofillCalculations.getDirection(e,t),r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,i))return e;let o=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return o?r=this.autofillCalculations.snapDragArea(e,r,i,o):r}function C$(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function CX(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Cq(t,e,i){"auto"!==i&&this.mergedCellsCollection.shiftCollections("down",t,e)}function CK(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function CZ(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}function CQ(t,e){if(e&&"area"===e){let e=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(e);(0,eu.arrayEach)(i,i=>{e.getBottomEndCorner().row===i.getLastRow()&&e.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function CJ(t,e,i,r){if(i)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,i,r)}function C0(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function C1(t,e,i,r){if(!(r instanceof MouseEvent))return;let o=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(o);if(!s)return;let n=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return 0===this.hot.selection.getLayerLevel()&&o.isEqual(this.hot._createCellRange(n,n,a))}tn("1C6fS");var tZ=tn("gFbQZ"),t6=tn("jlXkd"),iJ=tn("iCsRe");function C2(){(0,t6.warn)((0,iJ.toSingleLine)`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}tn("1hIp0");const C3="sort",C6="multiColumnSorting",C4="columnSorting";dz(C6,function(t,e){return function(i,r){let[,...o]=i,[,...s]=r;return function i(r){let n=t[r],a=e[r],l=o[r],h=s[r],c=a.multiColumnSorting,d=(c.compareFunctionFactory?c.compareFunctionFactory:dG(a.type))(n,a,c)(l,h);if(0===d){let t=r+1;if(void 0!==e[t])return i(t)}return d}(0)}}),tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),t0=tn("eL8cl");function C5(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),eq=tn("guO5N"),iJ=tn("iCsRe"),iy=tn("7HxIw"),t6=tn("jlXkd");tn("1C6fS"),tn("1hIp0");var eu=tn("ceXML");tn("1C6fS"),tn("1hIp0");var t3=tn("hwT6B"),eu=tn("ceXML");tn("1hIp0");var eu=tn("ceXML"),t3=tn("hwT6B"),tJ=tn("gnaTS");function C9(){let{label:t="",colspan:e=1,origColspan:i=1,collapsible:r=!1,crossHiddenColumns:o=[],isCollapsed:s=!1,isHidden:n=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:t,colspan:e,origColspan:i,collapsible:r,isCollapsed:s,crossHiddenColumns:o,isHidden:n,isRoot:a,isPlaceholder:l}}function C8(){return{label:"",isPlaceholder:!0}}function C7(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function St(t,e){return t.get(Si(t,e))}function Se(t,e,i){return t.set(Si(t,e),i),i}function Si(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const Sr=["label","collapsible"];var So=new WeakMap,Ss=new WeakMap,Sn=new WeakMap;class Sa{constructor(){C7(this,So,[]),C7(this,Ss,0),C7(this,Sn,1/0)}setColumnsLimit(t){Se(Sn,this,t)}setData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Se(So,this,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,i=[];if(0===e)return i;(0,eu.arrayEach)(t,t=>{let r=[],o=0;i.push(r),(0,eu.arrayEach)(t,t=>{let i=C9();if((0,t3.isObject)(t)){let{label:e,colspan:r}=t;i.label=(0,tJ.stringify)(e),"number"==typeof r&&r>1&&(i.colspan=r,i.origColspan=r)}else i.label=(0,tJ.stringify)(t);o+=i.origColspan;let s=!1;if(o>=e&&(i.colspan=i.origColspan-(o-e),i.origColspan=i.colspan,s=!0),r.push(i),i.colspan>1)for(let t=0;t<i.colspan-1;t++)r.push(C8());return!s})});let r=Math.max(...(0,eu.arrayMap)(i,t=>t.length));return(0,eu.arrayEach)(i,t=>{if(t.length<r){let e=(0,eu.arrayMap)(Array(r-t.length),()=>C9());t.splice(t.length,0,...e)}}),i}(t,St(Sn,this))),Se(Ss,this,St(So,this).length)}getData(){return St(So,this)}mergeWith(t){(0,eu.arrayEach)(t,t=>{let{row:e,col:i,...r}=t,o=this.getHeaderSettings(e,i);null!==o&&(0,t3.extend)(o,r,Sr)})}map(t){(0,eu.arrayEach)(St(So,this),e=>{(0,eu.arrayEach)(e,e=>{let i=t({...e});(0,t3.isObject)(i)&&(0,t3.extend)(e,i,Sr)})})}getHeaderSettings(t,e){var i;if(t>=St(Ss,this)||t<0)return null;let r=St(So,this)[t];return!1===Array.isArray(r)||e>=r.length?null:null!==(i=r[e])&&void 0!==i?i:null}getHeadersSettings(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=[];if(t>=St(Ss,this)||t<0)return r;let o=St(So,this)[t],s=0;for(let t=e;t<o.length;t++){let e=o[t];if(e.isPlaceholder)throw Error("The first column settings cannot overlap the other header layers");if(s+=e.colspan,r.push(e),e.colspan>1&&(t+=e.colspan-1),s===i)break;if(s>i)throw Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return St(Ss,this)}getColumnsCount(){return St(Ss,this)>0?St(So,this)[0].length:0}clear(){Se(So,this,[]),Se(Ss,this,0)}}tn("1C6fS");var eu=tn("ceXML");function Sl(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}tn("1C6fS"),tn("1hIp0");const Sh="DF-pre-order",Sc=new Map([[Sh,function t(e,i){let r=e.call(i,this);for(let o=0;o<this.childs.length;o++){if(!1===r)return!1;r=t.call(this.childs[o],e,i)}return r}],["DF-post-order",function t(e,i){for(let r=0;r<this.childs.length;r++)if(!1===t.call(this.childs[r],e,i))return!1;return e.call(i,this)}],["BF",function(t,e){let i=[this];!function r(){if(0===i.length)return;let o=i.shift();i.push(...o.childs),!1!==t.call(e,o)&&r()}()}]]);class Sd{constructor(t){Sl(this,"data",{}),Sl(this,"parent",null),Sl(this,"childs",[]),this.data=t}addChild(t){t.parent=this,this.childs.push(t)}cloneTree(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,e=new Sd({...t.data});for(let i=0;i<t.childs.length;i++)e.addChild(this.cloneTree(t.childs[i]));return e}replaceTreeWith(t){this.data={...t.data},this.childs=[];for(let e=0;e<t.childs.length;e++)this.addChild(t.childs[e])}walkDown(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!Sc.has(e))throw Error(`Traversal strategy "${e}" does not exist`);Sc.get(e).call(this,t,this)}walkUp(t){let e=this,i=r=>{!1!==t.call(e,r)&&null!==r.parent&&i(r.parent)};i(this)}}function Su(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function Sg(t,e){return t.get(Sp(t,e))}function Sp(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var Sf=new WeakMap,Sm=new WeakMap,Sy=new WeakMap;class Sv{constructor(t){Su(this,Sf,new Map),Su(this,Sm,new Map),Su(this,Sy,null),Sy.set(Sp(Sy,this),t)}getRoots(){return Array.from(Sg(Sf,this).values())}getRootByColumn(t){let e;return Sg(Sm,this).has(t)&&(e=Sg(Sf,this).get(Sg(Sm,this).get(t))),e}getNode(t,e){let i;let r=this.getRootByColumn(e);if(!r)return;let o=e-Sg(Sm,this).get(e),s=0;return r.walkDown(r=>{let{data:{origColspan:n,headerLevel:a}}=r;if(t===a){if(o>=s&&o<=s+n-1)return(i=r).data.isRoot=e===i.data.columnIndex,!1;s+=n}}),i}rebuildTreeIndex(){let t=0;Sg(Sm,this).clear(),(0,eu.arrayEach)(Sg(Sf,this),e=>{let[,{data:{colspan:i}}]=e;for(let e=t;e<t+i;e++)Sg(Sm,this).set(e,t);t+=i})}buildTree(){this.clear();let t=Sg(Sy,this).getColumnsCount(),e=0;for(;e<t;){let t=Sg(Sy,this).getHeaderSettings(0,e),i=new Sd;Sg(Sf,this).set(e,i),this.buildLeaves(i,e,0,t.origColspan),e+=t.origColspan}this.rebuildTreeIndex()}buildLeaves(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=Sg(Sy,this).getHeadersSettings(i,e,r);i+=1,(0,eu.arrayEach)(o,r=>{let o;let s={...r,headerLevel:i-1,columnIndex:e};1===i?(t.data=s,o=t):(o=new Sd(s),t.addChild(o)),i<Sg(Sy,this).getLayersCount()&&this.buildLeaves(o,e,i,r.origColspan),e+=r.origColspan})}clear(){Sg(Sf,this).clear(),Sg(Sm,this).clear()}}tn("1C6fS");var eu=(tn("ceXML"),tn("ceXML"));function Sw(t,e){t.walkDown(t=>{let{data:i,childs:r}=t;if(!i.isHidden&&(e(i.columnIndex),0===r.length))for(let t=1;t<i.colspan;t++)e(i.columnIndex+t)})}function Sb(t,e){let{childs:i}=t;if(0!==i.length)return i[0].data[e]}function SC(t){return Sb(t,"origColspan")===t.data.origColspan}function SS(t){let{data:e,childs:i}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(SC(t))return SS(i[0]);e.isCollapsed=!1;let r=i.slice(1),o=new Set,s=0;if(r.length>0)(0,eu.arrayEach)(r,t=>{t.replaceTreeWith(t.data.clonedTree),t.data.clonedTree=null;let e=t.data;s+=e.colspan,Sw(t,t=>{o.add(t)})});else{let{colspan:t,origColspan:i,columnIndex:r}=e;s=i-t;for(let t=1;t<i;t++)o.add(r+t)}return t.walkUp(t=>{let{data:e}=t;e.colspan+=s,e.colspan>=e.origColspan?(e.colspan=e.origColspan,e.isCollapsed=!1):SC(t)&&(e.isCollapsed=Sb(t,"isCollapsed"))}),{rollbackModification:()=>Sx(t),affectedColumns:Array.from(o),colspanCompensation:s}}function Sx(t){var e;let{data:i,childs:r}=t;if(i.isCollapsed||i.isHidden||i.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(SC(t))return Sx(r[0]);i.isCollapsed=!0;let o=r.slice(1),s=new Set;if(o.length>0)(0,eu.arrayEach)(o,t=>{Sw(t,t=>{s.add(t)}),t.data.clonedTree=t.cloneTree(),t.walkDown(t=>{let{data:e}=t;e.isHidden=!0})});else{let{origColspan:t,columnIndex:e}=i;for(let i=1;i<t;i++){let t=e+i;s.add(t)}}let n=i.colspan-(null!==(e=Sb(t,"colspan"))&&void 0!==e?e:1);return t.walkUp(t=>{let{data:e}=t;e.colspan-=n,e.colspan<=1?(e.colspan=1,e.isCollapsed=!0):SC(t)&&(e.isCollapsed=Sb(t,"isCollapsed"))}),{rollbackModification:()=>SS(t),affectedColumns:Array.from(s),colspanCompensation:n}}tn("1C6fS"),tn("1hIp0");var iJ=tn("iCsRe");tn("1C6fS");var iJ=tn("iCsRe");const SE=new Map([["collapse",Sx],["expand",SS],["hide-column",function(t,e){if(!Number.isInteger(e))throw Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw Error((0,iJ.toSingleLine)`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);let{crossHiddenColumns:i}=t.data;if(i.includes(e))return;let r=!1;t.walkUp(t=>{let{data:{collapsible:e}}=t;if(e)return r=!0,!1}),r||t.walkUp(t=>{let{data:i}=t;i.crossHiddenColumns.push(e),i.colspan>1?i.colspan-=1:i.isHidden=!0})}],["show-column",function(t,e){if(!Number.isInteger(e))throw Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw Error((0,iJ.toSingleLine)`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);let{crossHiddenColumns:i}=t.data;if(!i.includes(e))return;let r=!1;t.walkUp(t=>{let{data:{collapsible:e}}=t;if(e)return r=!0,!1}),r||t.walkUp(t=>{let{data:i}=t;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(e),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}]]);tn("1hIp0");var eu=tn("ceXML");function SR(t){let e=[];return(0,eu.arrayEach)(t,t=>{t.walkDown(t=>{let i;let r=t.data,{origColspan:o,columnIndex:s,headerLevel:n,crossHiddenColumns:a}=r,l=(Array.isArray(e[n])?i=e[n]:(i=[],e[n]=i),i),h=!1;for(let t=s;t<s+o;t++)if(a.includes(t)||h)l.push(C8(r));else{let t=function(t){let{crossHiddenColumns:e,...i}=C9(t);return i}(r);t.isRoot=!0,l.push(t),h=!0}})}),e}function ST(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function SM(t,e,i){return t.set(SA(t,e),i),i}function Sk(t,e){return t.get(SA(t,e))}function SA(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var SO=new WeakMap,SP=new WeakMap,SI=new WeakMap;class SH{constructor(){ST(this,SO,new Sa),ST(this,SP,new Sv(Sk(SO,this))),ST(this,SI,[[]])}setState(t){Sk(SO,this).setData(t);let e=!1;try{Sk(SP,this).buildTree()}catch(t){Sk(SP,this).clear(),Sk(SO,this).clear(),e=!0}return SM(SI,this,SR(Sk(SP,this).getRoots())),e}setColumnsLimit(t){Sk(SO,this).setColumnsLimit(t)}mergeStateWith(t){let e=(0,eu.arrayMap)(t,t=>{let{row:e,...i}=t;return{row:e<0?this.rowCoordsToLevel(e):e,...i}});Sk(SO,this).mergeWith(e),Sk(SP,this).buildTree(),SM(SI,this,SR(Sk(SP,this).getRoots()))}mapState(t){Sk(SO,this).map(t),Sk(SP,this).buildTree(),SM(SI,this,SR(Sk(SP,this).getRoots()))}mapNodes(t){return(0,eu.arrayReduce)(Sk(SP,this).getRoots(),(e,i)=>(i.walkDown(i=>{let r=t(i.data);void 0!==r&&e.push(r)}),e),[])}triggerNodeModification(t,e,i){let r;e<0&&(e=this.rowCoordsToLevel(e));let o=Sk(SP,this).getNode(e,i);return o&&(r=function(t,e,i){if(!SE.has(t))throw Error(`The node modifier action ("${t}") does not exist.`);return SE.get(t)(e,i)}(t,o,i),SM(SI,this,SR(Sk(SP,this).getRoots()))),r}triggerColumnModification(t,e){return this.triggerNodeModification(t,-1,e)}rowCoordsToLevel(t){if(t>=0)return null;let e=t+Math.max(this.getLayersCount(),1);return e<0?null:e}levelToRowCoords(t){if(t<0)return null;let e=t-Math.max(this.getLayersCount(),1);return e>=0?null:e}getHeaderSettings(t,e){var i,r;return(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())?null:null!==(i=null===(r=Sk(SI,this)[t])||void 0===r?void 0:r[e])&&void 0!==i?i:null}getHeaderTreeNodeData(t,e){let i=this.getHeaderTreeNode(t,e);return i?{...i.data}:null}getHeaderTreeNode(t,e){return(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())?null:Sk(SP,this).getNode(t,e)||null}findTopMostEntireHeaderLevel(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=i-t+1,o=!1,s=null;for(let e=t;e<=i;e++){let n=Sk(SP,this).getRootByColumn(e);if(!n)break;o=!0,n.walkDown(e=>{let{columnIndex:o,headerLevel:n,origColspan:a,isHidden:l}=e.data;!l&&a<=r&&o>=t&&o+a-1<=i&&(null===s||n<s)&&(s=n)},Sh)}return o&&null===s?-1:this.levelToRowCoords(null!==(e=s)&&void 0!==e?e:0)}findLeftMostColumnIndex(t,e){var i,r;let{isRoot:o}=null!==(i=this.getHeaderSettings(t,e))&&void 0!==i?i:{isRoot:!0};if(o)return e;let s=e-1;for(;s>=0;){let{isRoot:e}=null!==(r=this.getHeaderSettings(t,s))&&void 0!==r?r:{isRoot:!0};if(e)break;s-=1}return s}findRightMostColumnIndex(t,e){var i,r;let{isRoot:o,origColspan:s}=null!==(i=this.getHeaderSettings(t,e))&&void 0!==i?i:{isRoot:!0,origColspan:1};if(o)return e+s-1;let n=e+1;for(;n<this.getColumnsCount();){let{isRoot:e}=null!==(r=this.getHeaderSettings(t,n))&&void 0!==r?r:{isRoot:!0};if(e)break;n+=1}return n-1}getLayersCount(){return Sk(SO,this).getLayersCount()}getColumnsCount(){return Sk(SO,this).getColumnsCount()}clear(){SM(SI,this,[]),Sk(SO,this).clear(),Sk(SP,this).clear()}}tn("1C6fS");var tZ=tn("gFbQZ");function SL(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var SD=class{constructor(t,e){SL(this,"hot",void 0),SL(this,"nestedHeaderSettingsGetter",void 0),SL(this,"layersCount",0),SL(this,"container",void 0),SL(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=e,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(t){return this.layersCount=t,this}getWidth(t){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);let t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length;this.widthsMap.clear();for(let i=0;i<e;i++){let e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),r=this.hot.toPhysicalColumn(e);this.widthsMap.setValueAtIndex(r,t[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(t){let{rootDocument:e,columnIndexMapper:i}=this.hot,r=e.createDocumentFragment(),o=e.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,n=i.getRenderableIndexesLength();for(let t=0;t<this.layersCount;t++){let r=e.createElement("tr");for(let o=0;o<n;o++){let n=i.getVisualFromRenderableIndex(o);null===n&&(n=o);let a=e.createElement("th"),l=this.nestedHeaderSettingsGetter(t,n);if(l&&(!l.isPlaceholder||l.isHidden)){let t=l.label;s&&(t+='<button class="changeType"></button>'),(0,tZ.fastInnerHTML)(a,t),a.colSpan=l.colspan,r.appendChild(a)}}o.appendChild(r)}r.appendChild(o),t.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}};function SN(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function S_(t,e,i){SF(t,e),e.set(t,i)}function SF(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function Sj(t,e,i){return t.set(SW(t,e),i),i}function SB(t,e){return t.get(SW(t,e))}function SW(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const SV="nestedHeaders";var SU=new WeakMap,Sz=new WeakMap,SY=new WeakMap,SG=new WeakMap,S$=new WeakSet;function SX(){var t;let e=null===(t=this.hot)||void 0===t?void 0:t.getSelectedRangeLast();if(!e)return;let{highlight:i}=e;if(i.isHeader()&&i.col>=0){let t=SB(SU,this).findLeftMostColumnIndex(i.row,i.col),e=this.hot.selection.highlight.getFocus();e.visualCellRange.highlight.col=t,e.visualCellRange.from.col=t,e.visualCellRange.to.col=t,e.commit()}}function Sq(t){let e=this.hot.getSelectedRangeLast();if(!e)return t;let{highlight:i}=e;if(!(i.isHeader()&&i.col>=0))return t;let r=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=SB(SU,this).findLeftMostColumnIndex(i.row,i.col),n=SB(SU,this).findRightMostColumnIndex(i.row,i.col);return s<r&&n>o?t:s<r?s:n}function SK(t,e,i){let r=SB(SU,this).getHeaderTreeNodeData(e,t);if(!r)return t;let{columnCursor:o,selectionType:s,selectionWidth:n}=i,{isRoot:a,colspan:l}=SB(SU,this).getHeaderSettings(e,t);if(s===aG){if(!a)return r.columnIndex}else if(s===aY&&(l>n-o||!a))return null;return t}function SZ(t,e,i){let{columnHeadersCount:r}=i;if(0!==r)for(let i=0;i<e.length;i++){let{startRow:r,startCol:s,endRow:n,endCol:a}=e[i],l=n-r+1,h=s-a+1;if(r>=0||1===h)break;for(let e=s;e<=a;e++)for(let i=r;i<=n;i++){var o;let r=l+i,n=e-s;0!==n&&!1===(null===(o=SB(SU,this).getHeaderTreeNodeData(i,e))||void 0===o?void 0:o.isRoot)&&(t[r][n]="")}}}function SQ(t,e,i,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function SJ(t,e){let i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;Sj(SY,this,e.clone()),Sj(SG,this,!0);let{selection:r}=this.hot,o=r.isSelected()?r.getSelectedRange().current():null,s=[],{columnIndex:n,origColspan:a}=i,l=!r.inInSelection(e);t.shiftKey&&o?e.col<o.from.col?s.push(o.getTopEndCorner().col,n,e.row):e.col>o.from.col?s.push(o.getTopStartCorner().col,n+a-1,e.row):s.push(n,n+a-1,e.row):((0,iy.isLeftClick)(t)||(0,iy.isRightClick)(t)&&l)&&s.push(n,n+a-1,e.row),r.selectColumns(...s)}function S0(t,e,i,r){if(!this.hot.view.isMouseDown())return;let o=this._getHeaderTreeNodeDataByCoords(e);if(!o)return;let{columnIndex:s,origColspan:n}=o,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),h=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;let d=[],u=(0,eq.clamp)(e.row,-1/0,-1);e.col<c.col?d.push(h.col,s,u):e.col>c.col?d.push(l.col,s+n-1,u):d.push(s,s+n-1,u),this.hot.selection.selectColumns(...d)}function S1(){Sj(SG,this,!1)}function S2(){let{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!SB(SG,this)||!t)return;let e=this.hot.getSelectedRangeLast(),i=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:o,origColspan:s}=SB(SU,this).getHeaderTreeNodeData(SB(SY,this).row,SB(SY,this).col);if(e.setHighlight(SB(SY,this)),s>e.getWidth()||o<i||o+s-1>r){let t=SB(SU,this).findTopMostEntireHeaderLevel((0,eq.clamp)(i,o,o+s-1),(0,eq.clamp)(r,o,o+s-1));e.highlight.row=t,e.highlight.col=e.from.col}}function S3(t){let{highlight:e}=this.hot.getSelectedRangeLast(),i=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(i.isHeader()&&i.col>=0))return;let r=SB(SU,this).findLeftMostColumnIndex(i.row,i.col),o=SB(SU,this).findRightMostColumnIndex(i.row,i.col);if(t.col<0){let i=e.col>=r&&e.col<=o?r-1:o,s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i,-1);null===s?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(s,e.col)-1,1)}else if(t.col>0){let i=e.col>=r&&e.col<=o?o+1:r,s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i,1);null===s?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,s)-1,1)}}function S6(t,e){let i=t.row,r=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function S4(t){t.length=0;for(let e=0;e<SB(SU,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function S5(t){let e=SB(SU,this).getLayersCount(),i=t.startColumn,r=!!e;for(let o=0;o<e;o++){let e=SB(SU,this).findLeftMostColumnIndex(o,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(e);if(e>=0&&(r=!1),(0,eq.isNumeric)(s)&&s<t.startColumn){i=s;break}}t.startColumn=r?SB(SU,this).getHeaderTreeNodeData(0,i).columnIndex:i}function S9(t,e){let i=this.ghostTable.getWidth(e);return t>i?t:i}function S8(t,e,i){var r;let{label:o}=null!==(r=SB(SU,this).getHeaderTreeNodeData(i,e))&&void 0!==r?r:{label:""};return o}function S7(t,e){if(t<0)return this.hot.getCell(t,SB(SU,this).findLeftMostColumnIndex(t,e),!0)}function xt(){this.updatePlugin()}function xe(t,e){e||this.updatePlugin()}tn("1C6fS"),tn("1hIp0"),tn("1C6fS"),tn("1hIp0");var eq=tn("guO5N"),t3=tn("hwT6B"),eu=tn("ceXML");function xi(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var xr=class{constructor(t,e){xi(this,"hot",void 0),xi(this,"data",null),xi(this,"plugin",void 0),xi(this,"parentReference",new WeakMap),xi(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=e,this.plugin=t}setData(t){this.data=t}getData(){return this.data}getRawSourceData(){let t=null;return this.plugin.disableCoreAPIModifiers(),t=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),t}updateWithData(t){this.setData(t),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},(0,eq.rangeEach)(0,this.data.length-1,t=>{this.cacheNode(this.data[t],0,null)})}cacheNode(t,e,i){this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:i,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&(0,eu.arrayEach)(t.__children,i=>{this.cacheNode(i,e+1,t)})}getDataObject(t){return null==t?null:this.cache.rows[t]}readTreeNodes(t,e,i,r){let o=!1,s=e;if(isNaN(s)&&s.end)return s;let n=t;return(n||(n={__children:this.data},o=!0,s-=1),null!=i&&s===i)?{result:n,end:!0}:null!=r&&n===r?{result:s,end:!0}:(s+=1,n.__children&&(0,eu.arrayEach)(n.__children,t=>{if(this.parentReference.set(t,o?null:n),isNaN(s=this.readTreeNodes(t,s,i,r))&&s.end)return!1}),s)}mockParent(){let t=this.mockNode();return t.__children=this.data,t}mockNode(){let t={};return(0,t3.objectEach)(this.data[0],(e,i)=>{t[i]=null}),t}getRowIndex(t){return null==t?null:this.cache.nodeInfo.get(t).row}getRowIndexWithinParent(t){let e=null;e=isNaN(t)?t:this.getDataObject(t);let i=this.getRowParent(t);return null==i?this.data.indexOf(e):i.__children.indexOf(e)}countAllRows(){let t={__children:this.data};return this.countChildren(t)}countChildren(t){let e=0,i=t;return(isNaN(i)||(i=this.getDataObject(i)),i&&i.__children)?((0,eu.arrayEach)(i.__children,t=>{e+=1,t.__children&&(e+=this.countChildren(t))}),e):0}getRowParent(t){let e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}getRowObjectParent(t){return t&&"object"==typeof t?this.cache.nodeInfo.get(t).parent:null}getRowLevel(t){let e=null;return(e=isNaN(t)?t:this.getDataObject(t))?this.getRowObjectLevel(e):null}getRowObjectLevel(t){return null==t?null:this.cache.nodeInfo.get(t).level}hasChildren(t){let e=t;return isNaN(e)||(e=this.getDataObject(e)),!!(e.__children&&e.__children.length)}isChild(t){return null!==this.getRowParent(t)}getChild(t,e){var i;return(null===(i=t.__children)||void 0===i?void 0:i[e])||null}isRowHighestLevel(t){return!this.isChild(t)}isParent(t){var e;let i=t;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&(null===(e=i.__children)||void 0===e?void 0:e.length)!==0}addChild(t,e){let i=e;this.hot.runHooks("beforeAddChild",t,i);let r=null;t&&(r=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(t)+1,1);let o=t;t||(o=this.mockParent()),o.__children||(o.__children=[]),i||(i=this.mockNode()),o.__children.push(i),this.rewriteCache();let s=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",t,i)}addChildAtIndex(t,e,i){let r,o=i;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",t,o,e),t){let i=this.getRowIndex(t)+e+1;this.hot.runHooks("beforeCreateRow",i,1),t.__children.splice(e,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(i,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",i,1),r=i}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",e,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[e]);o=this.getDataObject(r),this.hot.runHooks("afterAddChild",t,o,e)}addSibling(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",i=this.translateTrimmedRow(t),r=this.getRowParent(i),o=this.getRowIndexWithinParent(i);switch(e){case"below":this.addChildAtIndex(r,o+1,null);break;case"above":this.addChildAtIndex(r,o,null)}}detachFromParent(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=null,r=[];Array.isArray(t)?((0,eq.rangeEach)(t[0],t[2],t=>{let e=this.translateTrimmedRow(t);r.push(this.getDataObject(e))}),(0,eq.rangeEach)(0,r.length-2,t=>{this.detachFromParent(r[t],!1)}),i=r[r.length-1]):i=t;let o=this.getRowIndex(i),s=this.countChildren(i),n=this.getRowIndexWithinParent(i),a=this.getRowParent(i),l=this.getRowParent(a),h=this.getRowIndex(l),c=null;if(this.hot.runHooks("beforeDetachChild",a,i),null!=n){let t=Array.from(Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,t,this.plugin.pluginName),a.__children.splice(n,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,t,this.plugin.pluginName),l){c=h+this.countChildren(l);let t=this.getChild(l,this.countChildren(l)-1),e=this.getRowIndex(t);this.hot.runHooks("beforeCreateRow",e+1,s+1,this.plugin.pluginName),l.__children.push(i)}else c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",c-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",a,i,this.getRowIndex(i)),e&&this.hot.render()}filterData(t,e,i){let r=[];(0,eu.arrayEach)(i,t=>{r.push(this.getDataObject(t))}),(0,eu.arrayEach)(r,t=>{let e=this.getRowIndexWithinParent(t),i=this.getRowParent(t);null===i?this.data.splice(e,1):i.__children.splice(e,1)}),this.rewriteCache()}spliceData(t,e,i){let r=this.getDataObject(t-1),o=null,s=t;r&&r.__children&&0===r.__children.length?(o=r,s=0):t<this.countAllRows()&&(o=this.getRowParent(t),s=this.getRowIndexWithinParent(t)),o?i?o.__children.splice(s,e,...i):o.__children.splice(s,e):i?this.data.splice(s,e,...i):this.data.splice(s,e),this.rewriteCache()}syncRowWithRawSource(t){let e=t,i=null;do null!==(i=this.getRowParent(i))&&(e=i);while(null!==i)this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(e),"__children",e.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(t,e,i,r){let o=e===this.hot.countRows(),s=this.getRowParent(t),n=this.getRowIndexWithinParent(t),a=s.__children.slice(n,n+1),l=t>e,h=o?this.getRowParent(e-1):this.getRowParent(e);null==h&&(h=this.getRowParent(e-1)),null==h&&(h=this.getDataObject(e-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(e)).__children=[];let c=o||i||r?h.__children.length:this.getRowIndexWithinParent(e),d=s===h;h.__children.splice(c,0,a[0]),s.__children.splice(n+(l&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(h)}translateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}untranslateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(t):t}};tn("1hIp0");var iy=tn("7HxIw"),eu=tn("ceXML"),eq=tn("guO5N"),tZ=tn("gFbQZ");function xo(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}tn("1C6fS");var xs=class{constructor(t,e){xo(this,"hot",void 0),xo(this,"plugin",void 0),this.hot=e,this.plugin=t}},eu=tn("ceXML"),eq=tn("guO5N"),tZ=tn("gFbQZ"),iq=tn("4Pbrh");class xn extends xs{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(t,e){super(t,e),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(t,e){let i=this.hot.toPhysicalRow(t),r=this.dataManager.getRowLevel(i),o=this.dataManager.getDataObject(i),s=e.getElementsByTagName("DIV")[0],n=s.querySelector("span.rowHeader"),a=s.querySelectorAll('[class^="ht_nesting"]'),l=this.hot.getSettings().ariaTags;if((0,eu.arrayEach)(a,t=>{t&&s.removeChild(t)}),(0,tZ.addClass)(e,xn.CSS_CLASSES.indicatorContainer),r){let{rootDocument:t}=this.hot,e=n.cloneNode(!0);s.innerHTML="",(0,eq.rangeEach)(0,r-1,()=>{let e=t.createElement("SPAN");(0,tZ.addClass)(e,xn.CSS_CLASSES.emptyIndicator),s.appendChild(e)}),s.appendChild(e)}if(this.dataManager.hasChildren(o)){let t=this.hot.rootDocument.createElement("DIV");l&&(0,tZ.setAttribute)(t,[(0,iq.A11Y_HIDDEN)()]),(0,tZ.addClass)(e,xn.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?((0,tZ.addClass)(t,`${xn.CSS_CLASSES.button} ${xn.CSS_CLASSES.expandButton}`),l&&(0,tZ.setAttribute)(e,[(0,iq.A11Y_EXPANDED)(!1)])):((0,tZ.addClass)(t,`${xn.CSS_CLASSES.button} ${xn.CSS_CLASSES.collapseButton}`),l&&(0,tZ.setAttribute)(e,[(0,iq.A11Y_EXPANDED)(!0)])),s.appendChild(t)}}updateRowHeaderWidth(t){let e=t;e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}var xa=class extends xs{constructor(t,e){var i;super(t,e),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,t)},shiftStash:function(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==e&&(e=1/0),(0,eu.arrayEach)(i.lastCollapsedRows,(o,s)=>{o>=t&&o<e&&(i.lastCollapsedRows[s]=o+r)})},applyStash:function(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];i.collapseMultipleChildren(i.lastCollapsedRows,t),i.lastCollapsedRows=void 0},trimStash:(t,e)=>{(0,eq.rangeEach)(t,t+e-1,t=>{let e=this.lastCollapsedRows.indexOf(t);e>-1&&this.lastCollapsedRows.splice(e,1)})}}}collapseChildren(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=[],o=null,s=null,n=null;return isNaN(t)?(o=t,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(t),s=t),this.dataManager.hasChildren(o)&&(0,eu.arrayEach)(o.__children,t=>{r.push(this.dataManager.getRowIndex(t))}),n=this.collapseRows(r,!0,!1),i&&this.trimRows(n),e&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(s)&&this.collapsedRows.push(s),n}collapseMultipleChildren(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=[];(0,eu.arrayEach)(t,t=>{r.push(...this.collapseChildren(t,!1,!1))}),i&&this.trimRows(r),e&&this.renderAndAdjust()}collapseRow(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.collapseRows([t],e)}collapseRows(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];return(0,eu.arrayEach)(t,t=>{r.push(t),e&&this.collapseChildRows(t,r)}),i&&this.trimRows(r),r}collapseChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];arguments.length>2&&arguments[2];let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){let i=this.dataManager.getDataObject(t);(0,eu.arrayEach)(i.__children,t=>{let i=this.dataManager.getRowIndex(t);e.push(i),this.collapseChildRows(i,e)})}i&&this.trimRows(e)}expandRow(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.expandRows([t],e)}expandRows(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];return(0,eu.arrayEach)(t,t=>{r.push(t),e&&this.expandChildRows(t,r)}),i&&this.untrimRows(r),r}expandChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];arguments.length>2&&arguments[2];let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){let i=this.dataManager.getDataObject(t);(0,eu.arrayEach)(i.__children,t=>{if(!this.isAnyParentCollapsed(t)){let i=this.dataManager.getRowIndex(t);e.push(i),this.expandChildRows(i,e)}})}i&&this.untrimRows(e)}expandChildren(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=[],o=null,s=null,n=null;return isNaN(t)?(o=t,s=this.dataManager.getRowIndex(t)):(o=this.dataManager.getDataObject(t),s=t),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&(0,eu.arrayEach)(o.__children,t=>{let e=this.dataManager.getRowIndex(t);r.push(e)}),n=this.expandRows(r,!0,!1),i&&this.untrimRows(n),e&&this.renderAndAdjust(),n}expandMultipleChildren(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=[];(0,eu.arrayEach)(t,t=>{r.push(...this.expandChildren(t,!1,!1))}),i&&this.untrimRows(r),e&&this.renderAndAdjust()}collapseAll(){let t=this.dataManager.getData(),e=[];(0,eu.arrayEach)(t,t=>{this.dataManager.hasChildren(t)&&e.push(t)}),this.collapseMultipleChildren(e),this.renderAndAdjust()}expandAll(){let t=this.dataManager.getData(),e=[];(0,eu.arrayEach)(t,t=>{this.dataManager.hasChildren(t)&&e.push(t)}),this.expandMultipleChildren(e),this.renderAndAdjust()}trimRows(t){this.hot.batchExecution(()=>{(0,eu.arrayEach)(t,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(t){this.hot.batchExecution(()=>{(0,eu.arrayEach)(t,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(t){let e=isNaN(t)?t:this.dataManager.getDataObject(t),i=!0;return null===e&&(e={__children:this.dataManager.data}),this.dataManager.hasChildren(e)&&(0,eu.arrayEach)(e.__children,t=>{let e=this.dataManager.getRowIndex(t);if(!this.plugin.collapsedRowsMap.getValueAtIndex(e))return i=!1,!1}),i}isAnyParentCollapsed(t){let e=t;for(;null!==e;){e=this.dataManager.getRowParent(e);let t=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(t)>-1)return!0}return!1}toggleState(t,e){if(e.col>=0)return;let i=this.translateTrimmedRow(e.row);(0,tZ.hasClass)(t.target,xn.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),(0,iy.stopImmediatePropagation)(t))}translateTrimmedRow(t){return this.hot.toPhysicalRow(t)}untranslateTrimmedRow(t){return this.hot.toVisualRow(t)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}};tn("1C6fS");var eq=tn("guO5N"),eu=tn("ceXML"),xl=new WeakMap,xh=class extends xs{constructor(){var t,e,i,r;super(...arguments),t="dataManager",e=this.plugin.dataManager,(t="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string"))?r:r+"")in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e,i={row_above:(t,e)=>{let i=e[e.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(t,e)=>{let i=e[e.length-1];this.dataManager.addSibling(i.start.row,"below")}},function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,xl),xl.set(this,i)}appendOptions(t){let e=[{key:"add_child",name(){return this.getTranslatedPhrase(n2)},callback:()=>{let t=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),e=this.dataManager.getDataObject(t);this.dataManager.addChild(e)},disabled:()=>{let t=this.hot.getSelectedLast();return!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(n3)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{let t=this.hot.getSelectedLast(),e=this.dataManager.translateTrimmedRow(t[0]);return!this.dataManager.getRowParent(e)||!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return(0,eq.rangeEach)(0,t.items.length-1,i=>{if(0===i)return(0,eu.arrayEach)(e,(e,r)=>{t.items.splice(i+r,0,e)}),!1}),this.modifyRowInsertingOptions(t)}modifyRowInsertingOptions(t){return(0,eq.rangeEach)(0,t.items.length-1,e=>{let i=xl.get(function(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(xl,this))[t.items[e].key];null!=i&&(t.items[e].callback=i)}),t}},t6=tn("jlXkd");tn("1C6fS"),tn("1hIp0");var tJ=tn("gnaTS"),t6=tn("jlXkd"),iJ=tn("iCsRe");function xc(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class xd{constructor(t){xc(this,"plugin",void 0),xc(this,"hot",void 0),xc(this,"dataManager",void 0),xc(this,"collapsingUI",void 0),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}onBeforeRowMove(t,e,i,r){if(this.displayAPICompatibilityWarning({rows:t,finalIndex:e,dropIndex:i,movePossible:r}))return!1;this.movedToCollapsed=!1;let o=i===this.hot.countRows(),s=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i),n=!0,a=t.map(t=>{if(!n)return!1;let e=this.dataManager.translateTrimmedRow(t);return n=this.shouldAllowMoving(e,s),e}),l=-1===a.indexOf(s);if(!n||!l)return!1;let h=this.getBaseParent(a),c=this.getTargetParent(o,s),d=h===c;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(c),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(a,s,d),this.moveRows(a,s,c),this.dataManager.rewriteCache(),this.moveCellsMeta(a,s),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",t,e,i,r,r&&this.isRowOrderChanged(t,e)),this.hot.render(),this.selectCells(t,i),!1}displayAPICompatibilityWarning(t){let{rows:e,finalIndex:i,dropIndex:r,movePossible:o}=t,s=!1;return(0,tJ.isUndefined)(r)&&((0,t6.warn)((0,iJ.toSingleLine)`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",e,i,r,o,!1),s=!0),s}shouldAllowMoving(t,e){return!(this.dataManager.isParent(t)||this.dataManager.isRowHighestLevel(t)||t===e||0===e)}getBaseParent(t){return this.dataManager.getRowParent(t[0])}getTargetParent(t,e){let i=this.dataManager.getRowParent(t?e-1:e);return null==i&&(i=this.dataManager.getRowParent(e-1)),i}shiftCollapsibleParentsLocations(t,e,i){i||(Math.max(...t)<=e?this.collapsingUI.collapsedRowsStash.shiftStash(t[0],e,-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(e,t[0],t.length))}moveRows(t,e,i){let r=e===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{t.forEach(t=>{this.dataManager.moveRow(t,e,this.movedToCollapsed,r)})})}moveCellsMeta(t,e){let i=[],r=Math.max(...t)<e;t.forEach(t=>{i.push(this.hot.getCellMetaAtRow(t))}),this.hot.spliceCellsMeta(t[0],t.length),this.hot.spliceCellsMeta(e-(r?i.length:0),0,...i)}selectCells(t,e){let i=t.length,r=0,o=0,s=null,n=null;if(this.movedToCollapsed){let s=null;s=t[i-1]<e?this.dataManager.translateTrimmedRow(e-i):this.dataManager.translateTrimmedRow(e);let n=this.dataManager.getRowParent(null===s?this.hot.countSourceRows()-1:s-1),a=this.dataManager.getRowIndex(n);o=r=this.dataManager.untranslateTrimmedRow(a)}else t[i-1]<e?r=(o=e-1)-i+1:o=(r=e)+i-1;s=this.hot.selection,n=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(r,0)),s.setRangeEnd(this.hot._createCellCoords(o,n),!0)}isRowOrderChanged(t,e){return t.some((t,i)=>t-i!==e)}}function xu(t,e,i){xg(t,e),e.set(t,i)}function xg(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function xp(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function xf(t,e){return t.get(xy(t,e))}function xm(t,e,i){return t.set(xy(t,e),i),i}function xy(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const xv="nestedRows";var xw=new WeakMap,xb=new WeakMap,xC=new WeakSet;function xS(t,e,i,r){return this.rowMoveController.onBeforeRowMove(t,e,i,r)}function xx(t,e,i){this.collapsingUI.toggleState(t,e,i)}function xE(t,e,i){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(i[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(i[0],null,-1*e),this.dataManager.filterData(t,e,i),xm(xw,this,!0),this.dataManager.getData().slice()}function xR(t){return this.contextMenuUI.appendOptions(t)}function xT(t,e){this.headersUI.appendLevelIndicators(t,e)}function xM(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function xk(t,e,i,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{xm(xw,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function xA(t,e,i){let r=Array.from(i.reduce((t,e)=>{if(this.dataManager.isParent(e)){let i=this.dataManager.getDataObject(e).__children;return t.add(e),Array.isArray(i)&&i.forEach(e=>t.add(this.dataManager.getRowIndex(e))),t}return t.add(e)},new Set));i.length=0,i.push(...r)}function xO(){this.collapsingUI.collapsedRowsStash.stash()}function xP(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function xI(){this.collapsingUI.collapsedRowsStash.stash()}function xH(t,e,i){this.collapsingUI.collapsedRowsStash.shiftStash(i,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function xL(){this.dataManager.rewriteCache()}function xD(){this.headersUI.updateRowHeaderWidth()}function xN(t,e){xf(xw,this)&&(e.skipRender=!0)}function x_(t){if(!s_(t)){(0,t6.error)("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[xv]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}tn("1C6fS"),tn("1C6fS"),tn("1hIp0"),tn("euqEx");var eu=tn("ceXML");function xF(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var xj=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;xF(this,"rootWindow",void 0),xF(this,"prefix",void 0),xF(this,"savedKeys",[]),this.rootWindow=e,this.prefix=t,this.loadSavedKeys()}saveValue(t,e){this.rootWindow.localStorage.setItem(`${this.prefix}_${t}`,JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}loadValue(t,e){let i=this.rootWindow.localStorage.getItem(`${this.prefix}_${void 0===t?e:t}`);return null===i?void 0:JSON.parse(i)}reset(t){this.rootWindow.localStorage.removeItem(`${this.prefix}_${t}`)}resetAll(){(0,eu.arrayEach)(this.savedKeys,(t,e)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[e]}`)}),this.clearSavedKeys()}loadSavedKeys(){let t=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),e="string"==typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}},nd=tn("10euP");(0,nd.default).getSingleton().register("persistentStateSave"),(0,nd.default).getSingleton().register("persistentStateLoad"),(0,nd.default).getSingleton().register("persistentStateReset");const xB="persistentState";tn("1C6fS"),tn("1hIp0");var t3=tn("hwT6B"),eq=tn("guO5N"),tJ=tn("gnaTS");function xW(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function xV(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}const xU="search",xz=function(t,e,i,r,o){t.getCellMeta(e,i).isSearchResult=o},xY=function(t,e,i){return!((0,tJ.isUndefined)(t)||null===t||!t.toLocaleLowerCase||0===t.length||(0,tJ.isUndefined)(e)||null===e)&&-1!==e.toString().toLocaleLowerCase(i.locale).indexOf(t.toLocaleLowerCase(i.locale))};var xG=new WeakSet;function x$(t,e,i,r,o,s){let n=s.className||[],a=[];"string"==typeof n?a=n.split(" "):a.push(...n),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}tn("1C6fS"),tn("1hIp0");var tZ=tn("gFbQZ"),eu=tn("ceXML"),iv=tn("llu1T");function xX(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function xq(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var xK=new WeakSet;function xZ(){if(this.lockedCollection)return;let{topOverlay:t,bottomOverlay:e,inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(i),r&&this.scrollbars.push(r),o&&o.clone&&this.scrollbars.push(o),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),o&&o.clone&&this.clones.push(o.clone.wtTable.holder.parentNode)}function xQ(){this.freezeOverlays=!0,(0,eu.arrayEach)(this.clones,t=>{(0,tZ.addClass)(t,"hide-tween")})}function xJ(){this.freezeOverlays=!1,(0,eu.arrayEach)(this.clones,t=>{(0,tZ.removeClass)(t,"hide-tween"),(0,tZ.addClass)(t,"show-tween")}),this.hot._registerTimeout(()=>{(0,eu.arrayEach)(this.clones,t=>{(0,tZ.removeClass)(t,"show-tween")})},400),(0,eu.arrayEach)(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}tn("1C6fS"),tn("1hIp0");var eu=tn("ceXML");const x0="trimRows";var x1=new WeakSet;function x2(){let t=this.hot.getSettings()[x0];Array.isArray(t)&&this.hot.batchExecution(()=>{(0,eu.arrayEach)(t,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0)}tn("1hIp0");var tl=tn("hmx0d"),x3={},ep=tn("bGtV7"),eT=tn("hc2VB"),u6=tn("chuuX"),x6={},ew=tn("blCy8"),x4={};x4={};var x5=ew("iterator"),x9=Array.prototype;x6=function(t){return void 0!==t&&(x4.Array===t||x9[x5]===t)};var os=tn("ptmgx"),eE=tn("5Ef1u"),x8={},ep=tn("bGtV7"),tm=tn("eXHxq"),eT=tn("hc2VB"),u6=tn("chuuX"),x7={},Et=tn("f9qXf"),eS=tn("kdzTk"),em=tn("aIKND"),ew=tn("blCy8"),Ee=ew("iterator");x7=function(t){if(!em(t))return eS(t,Ee)||eS(t,"@@iterator")||x4[Et(t)]};var Ei=TypeError;x8=function(t,e){var i=arguments.length<2?x7(t):e;if(tm(i))return eT(ep(i,t));throw new Ei(u6(t)+" is not iterable")};var Er={},ep=tn("bGtV7"),eT=tn("hc2VB"),eS=tn("kdzTk");Er=function(t,e,i){var r,o;eT(t);try{if(!(r=eS(t,"return"))){if("throw"===e)throw i;return i}r=ep(r,t)}catch(t){o=!0,r=t}if("throw"===e)throw i;if(o)throw r;return eT(r),i};var Eo=TypeError,Es=function(t,e){this.stopped=t,this.result=e},En=Es.prototype;x3=function(t,e,i){var r,o,s,n,a,l,h,c=i&&i.that,d=!!(i&&i.AS_ENTRIES),u=!!(i&&i.IS_RECORD),g=!!(i&&i.IS_ITERATOR),p=!!(i&&i.INTERRUPTED),f=tu(e,c),m=function(t){return r&&Er(r,"normal",t),new Es(!0,t)},y=function(t){return d?(eT(t),p?f(t[0],t[1],m):f(t[0],t[1])):p?f(t,m):f(t)};if(u)r=t.iterator;else if(g)r=t;else{if(!(o=x7(t)))throw new Eo(u6(t)+" is not iterable");if(x6(o)){for(s=0,n=os(t);n>s;s++)if((a=y(t[s]))&&eE(En,a))return a;return new Es(!1)}r=x8(t,o)}for(l=u?t.next:r.next;!(h=ep(l,r)).done;){try{a=y(h.value)}catch(t){Er(r,"throw",t)}if("object"==typeof a&&a&&eE(En,a))return a}return new Es(!1)};var Ea={},oh=tn("kxexm"),od=tn("3RKYQ"),El=tn("fEYls");Ea=function(t,e,i){oh?od.f(t,e,El(0,i)):t[e]=i},tl({target:"Object",stat:!0},{fromEntries:function(t){var e={};return x3(t,function(t,i){Ea(e,t,i)},{AS_ENTRIES:!0}),e}});var nd=tn("10euP"),eu=tn("ceXML"),eq=tn("guO5N"),t3=tn("hwT6B");const Eh="undoRedo";function Ec(t){let e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(i,r){let o=i&&i.length;o&&i.find(t=>{let[,,e,i]=t;return e!==i})&&e.done(()=>{let e=i.reduce((t,e)=>(t.push([...e]),t),[]);(0,eu.arrayEach)(e,e=>{e[1]=t.propToCol(e[1])});let r=o>1?this.getSelected():[[e[0][0],e[0][1]]];return new Ec.ChangeAction(e,r)},r)}),t.addHook("afterCreateRow",(t,i,r)=>{e.done(()=>new Ec.CreateRowAction(t,i),r)});let i=(e,i,r,o)=>{let s=["visualRow","visualCol","row","col","prop"],n=s.length,a=[];return(0,eq.rangeEach)(r,o,r=>{(0,eq.rangeEach)(e,i,e=>{let i=t.getCellMeta(e,r);if(Object.keys(i).length!==n){let t=Object.fromEntries(Object.entries(i).filter(t=>{let[e]=t;return!1===s.includes(e)}));a.push([i.visualRow,i.visualCol,t])}})}),a};t.addHook("beforeRemoveRow",(r,o,s,n)=>{e.done(()=>{let s=t.toPhysicalRow(r),n=s+o-1,a=(0,t3.deepClone)(e.instance.getSourceData(s,0,s+o-1,e.instance.countSourceCols()-1));return new Ec.RemoveRowAction(s,a,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),i(s,n,0,t.countCols()-1))},n)}),t.addHook("afterCreateCol",(t,i,r)=>{e.done(()=>new Ec.CreateColumnAction(t,i),r)}),t.addHook("beforeRemoveCol",(r,o,s,n)=>{e.done(()=>{let s=e.instance.getSourceDataArray(),n=(e.instance.countCols()+r)%e.instance.countCols(),a=n+o-1,l=[],h=[],c=[];(0,eq.rangeEach)(s.length-1,e=>{let i=[],r=s[e];(0,eq.rangeEach)(n,a,e=>{i.push(r[t.toPhysicalColumn(e)])}),l.push(i)}),(0,eq.rangeEach)(o-1,e=>{c.push(t.toPhysicalColumn(n+e))}),Array.isArray(t.getSettings().colHeaders)&&(0,eq.rangeEach)(o-1,e=>{h.push(t.getSettings().colHeaders[t.toPhysicalColumn(n+e)]||null)});let d=t.columnIndexMapper.getIndexesSequence(),u=t.rowIndexMapper.getIndexesSequence();return new Ec.RemoveColumnAction(n,c,l,h,d,u,t.getSettings().fixedColumnsStart,i(0,t.countRows(),n,a))},n)}),t.addHook("beforeCellAlignment",(t,i,r,o)=>{e.done(()=>new Ec.CellAlignmentAction(t,i,r,o))}),t.addHook("beforeFilter",t=>{e.done(()=>new Ec.FiltersAction(t))}),t.addHook("beforeRowMove",(t,i)=>{!1!==t&&e.done(()=>new Ec.RowMoveAction(t,i))}),t.addHook("beforeColumnMove",(t,i)=>{!1!==t&&e.done(()=>new Ec.ColumnMoveAction(t,i))}),t.addHook("beforeMergeCells",(i,r)=>{r||e.done(()=>new Ec.MergeCellsAction(t,i))}),t.addHook("afterUnmergeCells",(i,r)=>{r||e.done(()=>new Ec.UnmergeCellsAction(t,i))}),t.addHook("afterInit",()=>{e.init()})}Ec.prototype.done=function(t,e){if(this.ignoreNewActions||"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e)return;let i=this.doneActions.slice();if(!1===this.instance.runHooks("beforeUndoStackChange",i,e))return;let r=t(),o=this.undoneActions.slice();this.doneActions.push(r),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())},Ec.prototype.undo=function(){if(this.isUndoAvailable()){let t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);let e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());let i=(0,t3.deepClone)(e);if(!1===this.instance.runHooks("beforeUndo",i))return;this.ignoreNewActions=!0;let r=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{r.ignoreNewActions=!1,r.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",i)}},Ec.prototype.redo=function(){if(this.isRedoAvailable()){let t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);let e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());let i=(0,t3.deepClone)(e);if(!1===this.instance.runHooks("beforeRedo",i))return;this.ignoreNewActions=!0;let r=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{r.ignoreNewActions=!1,r.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",i)}},Ec.prototype.isUndoAvailable=function(){return this.doneActions.length>0},Ec.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},Ec.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},Ec.prototype.isEnabled=function(){return this.enabled},Ec.prototype.enable=function(){if(this.isEnabled())return;let t=this.instance;this.enabled=!0,t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()},this.registerShortcuts(),t.addHook("afterChange",Eg)},Ec.prototype.disable=function(){if(!this.isEnabled())return;let t=this.instance;this.enabled=!1,delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo,this.unregisterShortcuts(),t.removeHook("afterChange",Eg)},Ec.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},Ec.Action=function(){},Ec.Action.prototype.undo=function(){},Ec.Action.prototype.redo=function(){},Ec.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"},(0,t3.inherit)(Ec.ChangeAction,Ec.Action),Ec.ChangeAction.prototype.undo=function(t,e){let i=(0,t3.deepClone)(this.changes),r=t.countEmptyRows(!0),o=t.countEmptyCols(!0);for(let t=0,e=i.length;t<e;t++)i[t].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(i,null,null,"UndoRedo.undo");for(let e=0,s=i.length;e<s;e++){let[s,n]=i[e];t.getSettings().minSpareRows&&s+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(s+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&n+1+t.getSettings().minSpareCols===t.countCols()&&o===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(n+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}let s=t.getSelectedLast();if(void 0!==s){let[e,r]=i[0],[o,n]=s,a=t.view.getFirstFullyVisibleRow(),l=t.view.getFirstFullyVisibleColumn(),h=e>=a,c=r>=l,d=o!==e||n!==r;if(!1===(h&&c)&&!0===d){let i={row:e,col:r};!1===h&&(i.verticalSnap="top"),!1===c&&(i.horizontalSnap="start"),t.scrollViewportTo(i)}}t.selectCells(this.selected,!1,!1)},Ec.ChangeAction.prototype.redo=function(t,e){let i=(0,t3.deepClone)(this.changes);for(let t=0,e=i.length;t<e;t++)i[t].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(i,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)},Ec.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},(0,t3.inherit)(Ec.CreateRowAction,Ec.Action),Ec.CreateRowAction.prototype.undo=function(t,e){let i=t.countRows(),r=t.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},Ec.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},Ec.RemoveRowAction=function(t,e,i,r,o,s){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=i,this.fixedRowsTop=r,this.rowIndexesSequence=o,this.removedCellMetas=s},(0,t3.inherit)(Ec.RemoveRowAction,Ec.Action),Ec.RemoveRowAction.prototype.undo=function(t,e){let i=t.getSettings(),r=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((t,e)=>{Object.keys(t).forEach(i=>{let o=parseInt(i,10);r.push([this.index+e,isNaN(o)?i:o,t[i]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(e=>{let[i,r,o]=e;t.setCellMetaObject(i,r,o)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},Ec.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},Ec.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},(0,t3.inherit)(Ec.CreateColumnAction,Ec.Action),Ec.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},Ec.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},Ec.RemoveColumnAction=function(t,e,i,r,o,s,n,a){this.index=t,this.indexes=e,this.data=i,this.amount=this.data[0].length,this.headers=r,this.columnPositions=o.slice(0),this.rowPositions=s.slice(0),this.actionType="remove_col",this.fixedColumnsStart=n,this.removedCellMetas=a},(0,t3.inherit)(Ec.RemoveColumnAction,Ec.Action),Ec.RemoveColumnAction.prototype.undo=function(t,e){t.getSettings().fixedColumnsStart=this.fixedColumnsStart;let i=this.indexes.slice(0).sort(),r=(t,e,r)=>r[this.indexes.indexOf(i[e])],o=this.data.length,s=[];for(let t=0;t<o;t++)s.push((0,eu.arrayMap)(this.data[t],r));let n=(0,eu.arrayMap)(this.headers,r),a=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),(0,eu.arrayEach)(t.getSourceDataArray(),(t,e)=>{(0,eu.arrayEach)(i,(i,r)=>{t[i]=s[e][r],a.push([e,i,t[i]])})}),t.setSourceDataAtCell(a,void 0,void 0,"UndoRedo.undo"),void 0!==this.headers&&(0,eu.arrayEach)(n,(e,r)=>{t.getSettings().colHeaders[i[r]]=e}),this.removedCellMetas.forEach(e=>{let[i,r,o]=e;t.setCellMetaObject(i,r,o)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()},Ec.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},Ec.CellAlignmentAction=function(t,e,i,r){this.stateBefore=t,this.range=e,this.type=i,this.alignment=r},Ec.CellAlignmentAction.prototype.undo=function(t,e){(0,eu.arrayEach)(this.range,e=>{e.forAll((e,i)=>{e>=0&&i>=0&&t.setCellMeta(e,i,"className",this.stateBefore[e][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()},Ec.CellAlignmentAction.prototype.redo=function(t,e){ua(this.range,this.type,this.alignment,(e,i)=>t.getCellMeta(e,i),(e,i,r,o)=>t.setCellMeta(e,i,r,o)),t.addHookOnce("afterViewRender",e),t.render()},Ec.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},(0,t3.inherit)(Ec.FiltersAction,Ec.Action),Ec.FiltersAction.prototype.undo=function(t,e){let i=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),i.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),i.filter()},Ec.FiltersAction.prototype.redo=function(t,e){let i=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),i.conditionCollection.importAllConditions(this.conditionsStack),i.filter()};class Ed extends Ec.Action{constructor(t,e){super(),this.cellRange=e;let i=this.cellRange.getTopStartCorner(),r=this.cellRange.getBottomEndCorner();this.rangeData=t.getData(i.row,i.col,r.row,r.col)}undo(t,e){let i=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),i.unmergeRange(this.cellRange,!0);let r=this.cellRange.getTopStartCorner();t.populateFromArray(r.row,r.col,this.rangeData,void 0,void 0,"MergeCells")}redo(t,e){let i=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),i.mergeRange(this.cellRange)}}Ec.MergeCellsAction=Ed;class Eu extends Ec.Action{constructor(t,e){super(),this.cellRange=e}undo(t,e){let i=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),i.mergeRange(this.cellRange,!0)}redo(t,e){let i=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),i.unmergeRange(this.cellRange,!0),t.render()}}function Eg(t,e){if("loadData"===e)return this.undoRedo.clear()}Ec.UnmergeCellsAction=Eu,Ec.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalRowIndex=e,this.actionType="row_move"},(0,t3.inherit)(Ec.RowMoveAction,Ec.Action),Ec.RowMoveAction.prototype.undo=function(t,e){let i=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),yC(this.rows,this.finalRowIndex,t.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(t=>{let{from:e,to:r}=t;e<r&&(r-=1),i.moveRow(r,e)}),t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},Ec.RowMoveAction.prototype.redo=function(t,e){let i=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),i.moveRows(this.rows.slice(),this.finalRowIndex),t.render(),t.deselectCell(),t.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)},Ec.ColumnMoveAction=function(t,e){this.columns=t.slice(),this.finalColumnIndex=e,this.actionType="col_move"},(0,t3.inherit)(Ec.ColumnMoveAction,Ec.Action),Ec.ColumnMoveAction.prototype.undo=function(t,e){let i=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),yC(this.columns,this.finalColumnIndex,t.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(t=>{let{from:e,to:r}=t;e<r&&(r-=1),i.moveColumn(r,e)}),t.render(),t.deselectCell(),t.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)},Ec.ColumnMoveAction.prototype.redo=function(t,e){let i=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),i.moveColumns(this.columns.slice(),this.finalColumnIndex),t.render(),t.deselectCell(),t.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)},Ec.prototype.init=function(){let t=this.instance.getSettings().undo;this.instance.undoRedo||(this.instance.undoRedo=this),void 0===t||t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},Ec.prototype.registerShortcuts=function(){this.instance.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],{runOnlyIf:t=>!t.altKey,group:Eh})},Ec.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(Eh)};const Ep=(0,nd.default).getSingleton();Ep.add("afterUpdateSettings",function(){var t;null===(t=this.getPlugin("undoRedo"))||void 0===t||t.init()}),Ep.register("beforeUndo"),Ep.register("afterUndo"),Ep.register("beforeRedo"),Ep.register("afterRedo"),Ec.PLUGIN_KEY="undoRedo",Ec.SETTING_KEYS=!0;var t2=tn("1k8Ev");tn("1C6fS");var eu=tn("ceXML"),t0=tn("eL8cl"),Ef=tn("7cVHX"),iv=tn("llu1T"),tQ=tn("f3221"),tJ=tn("gnaTS"),eq=tn("guO5N"),t3=tn("hwT6B"),eX=tn("bO142"),iL=tn("bCtEl"),tZ=tn("gFbQZ"),iy=tn("7HxIw"),il=tn("jxqWV");(0,il.registerEditor)(hL.BaseEditor),(0,il.registerEditor)(hW),(0,il.registerEditor)(hV),(0,il.registerEditor)(hU.DateEditor),(0,il.registerEditor)(hz),(0,il.registerEditor)(h_),(0,il.registerEditor)(hY),(0,il.registerEditor)(hG),(0,il.registerEditor)(hq),(0,il.registerEditor)(hO.TextEditor),(0,il.registerEditor)(hK),ia(hQ),ia(hP),ia(h4),ia(hJ),ia(h9),ia(hZ),ia(ct),ia(ce),ia(ci),ia(hI),ia(cr),im(co),im(ca),im(cn.dateValidator),im(cl),im(cd),lY({CELL_TYPE:"autocomplete",editor:hW,renderer:hQ,validator:co}),lY({CELL_TYPE:"checkbox",editor:hV,renderer:h4}),lY(cg),lY({CELL_TYPE:"dropdown",editor:hz,renderer:hJ,validator:ca}),lY({CELL_TYPE:"handsontable",editor:h_,renderer:h9}),lY({CELL_TYPE:"numeric",editor:hY,renderer:ct,validator:cl,dataType:"number"}),lY({CELL_TYPE:"password",editor:hG,renderer:ce,copyable:!1}),lY({CELL_TYPE:"select",editor:hq,renderer:ci}),lY(hH),lY({CELL_TYPE:"time",editor:hK,renderer:cr,validator:cd}),e8(cN),e8(class extends cx{constructor(){super(...arguments),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,cX),cX.add(this),cz(this,"addingStarted",!1),cz(this,"mouseDownOnCellCorner",!1),cz(this,"mouseDragOutside",!1),cz(this,"handleDraggedCells",0),cz(this,"directions",[]),cz(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return cG}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[cG,...c$]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",t=>cY(cX,this,cK).call(this,t)),this.addHook("afterOnCellCornerDblClick",t=>cY(cX,this,cq).call(this,t)),this.addHook("beforeOnCellMouseOver",(t,e)=>cY(cX,this,cZ).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let t=this.hot.getSelectedRangeLast(),{row:e,col:i}=t.getTopStartCorner(),{row:r,col:o}=t.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:e,startCol:i,endRow:r,endCol:o}]),n=[],a=[],l=[];return(0,eu.arrayEach)(s,t=>{for(let e=t.startRow;e<=t.endRow;e+=1)-1===n.indexOf(e)&&n.push(e);for(let e=t.startCol;e<=t.endCol;e+=1)-1===a.indexOf(e)&&a.push(e)}),(0,eu.arrayEach)(n,t=>{let e=[];(0,eu.arrayEach)(a,i=>{e.push(this.hot.getCopyableData(t,i))}),l.push(e)}),l}fillIn(){var t;let e,i,r;if(this.hot.selection.highlight.getFill().isEmpty())return!1;let[o,s,n,a]=this.hot.selection.highlight.getFill().getVisualCorners(),l=this.hot.getSelectedRangeLast(),h=l.getTopStartCorner(),c=l.getBottomEndCorner();this.resetSelectionOfDraggedArea();let d=[h.row,h.col,c.row,c.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,o),Math.min(h.col,s),Math.max(c.row,n),Math.max(c.col,a)],d),{directionOfDrag:g,startOfDragCoords:p,endOfDragCoords:f}=(t=(t,e)=>this.hot._createCellCoords(t,e),u[0]===d[0]&&u[1]<d[1]?(r="left",e=t(u[0],u[1]),i=t(u[2],d[1]-1)):u[2]===d[2]&&u[0]===d[0]&&u[3]>d[3]?(r="right",e=t(u[0],d[3]+1),i=t(u[2],u[3])):u[0]<d[0]&&u[1]===d[1]?(r="up",e=t(u[0],u[1]),i=t(d[0]-1,u[3])):u[2]>d[2]&&u[1]===d[1]&&(r="down",e=t(d[2]+1,u[1]),i=t(u[2],u[3])),e&&e.normalize(),i&&i.normalize(),{directionOfDrag:r,startOfDragCoords:e,endOfDragCoords:i});if(p&&p.row>-1&&p.col>-1){let t=this.getSelectionData(),e=l.clone(),i=this.hot._createCellRange(p,p,f),r=this.hot.runHooks("beforeAutofill",t,e,i,g);if(!1===r)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let o=r;if(["up","left"].indexOf(g)>-1&&!(1===r.length&&0===r[0].length)){if(o=[],"up"===g){let t=f.row-p.row+1,e=t%r.length;for(let i=0;i<t;i++)o.push(r[(i+(r.length-e))%r.length])}else{let t=f.col-p.col+1,e=t%r[0].length;for(let i=0;i<r.length;i++){o.push([]);for(let s=0;s<t;s++)o[i].push(r[i][(s+(r[i].length-e))%r[i].length])}}}this.hot.populateFromArray(p.row,p.col,o,f.row,f.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",o,e,i,g),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}getCoordsOfDragAndDropBorders(t){let e=this.hot.getSelectedRangeLast(),i=e.getBottomEndCorner(),r=t;if(this.directions.includes(cU.vertical)&&this.directions.includes(cU.horizontal)){let o=e.getTopStartCorner();(i.col<=t.col||o.col>=t.col)&&(r=this.hot._createCellCoords(i.row,t.col)),(i.row<t.row||o.row>t.row)&&(r=this.hot._createCellCoords(t.row,i.col))}else if(this.directions.includes(cU.vertical))r=this.hot._createCellCoords(t.row,i.col);else{if(!this.directions.includes(cU.horizontal))return;r=this.hot._createCellCoords(i.row,t.col)}return this.reduceSelectionAreaIfNeeded(r)}showBorder(t){let e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){let t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();t[2]<i-1&&e[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(t){let e;let i=this.hot.getData(),r=this.hot.countRows();for(let o=t[2]+1;o<r;o++){for(let e=t[1];e<=t[3];e++){let t=i[o][e];if(!(0,tJ.isEmpty)(t))return -1}let r=i[o][t[1]-1],s=i[o][t[3]+1];(0,tJ.isEmpty)(r)&&(0,tJ.isEmpty)(s)||(e=o)}return e}addSelectionFromStartAreaToSpecificRowIndex(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}setSelection(t){this.hot.selectCell(...(0,eu.arrayMap)(t,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){let t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return -1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(t){let{documentElement:e}=this.hot.rootDocument,i=(0,tZ.offset)(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+(0,tZ.outerHeight)(this.hot.table),r=(0,tZ.offset)(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+(0,tZ.outerWidth)(this.hot.table);return t.clientY>i&&t.clientX<=r}registerEvents(){let{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseup",()=>cY(cX,this,cQ).call(this)),this.eventManager.addEventListener(t,"mousemove",t=>cY(cX,this,cJ).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){let t=function(t){let e={};return!0===t?(e.directions=Object.keys(cU),e.autoInsertRow=!0):(0,t3.isObject)(t)?((0,tJ.isDefined)(t.autoInsertRow)?t.direction===cU.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,(0,tJ.isDefined)(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(cU)):"string"==typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}destroy(){super.destroy()}}),e8(c6),e8(class extends cx{constructor(){var t,e;super(...arguments),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,dc),dc.add(this),(t="symbol"==typeof(e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="headerIndexes","string"))?e:e+"")in this?Object.defineProperty(this,t,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[t]=null}static get PLUGIN_KEY(){return dl}static get PLUGIN_PRIORITY(){return 210}isEnabled(){return!!this.hot.getSettings()[dl]}enablePlugin(){if(this.enabled)return;let t=this.hot.getSettings()[dl];"string"!=typeof t&&(t="loose");let e=dh.get(t);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new e),this.addHook("modifyRowHeader",t=>(function(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")})(dc,this,dd).call(this,t)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}),e8(class extends cx{constructor(){super(...arguments),du(this,dC),dC.add(this),dg(this,"nestedHeadersPlugin",null),dg(this,"headerStateManager",null),du(this,db),db.set(this,null)}static get PLUGIN_KEY(){return dm}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[dm,...dy]}isEnabled(){return!!this.hot.getSettings()[dm]}enablePlugin(){var t=this;if(this.enabled)return;let{nestedHeaders:e}=this.hot.getSettings();e||(0,t6.warn)("You need to configure the Nested Headers plugin in order to use collapsible headers."),dp(db,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>df(dC,this,dE).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return df(dC,t,dR).call(t,...i)}),this.addHook("afterGetColHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return df(dC,t,dS).call(t,...i)}),this.addHook("beforeOnCellMouseDown",(t,e,i)=>df(dC,this,dx).call(this,t,e,i)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){let{collapsibleColumns:t}=this.hot.getSettings();"boolean"==typeof t?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(t)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(t))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),dp(db,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var t;let{row:e,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:r,isCollapsed:o,columnIndex:s}=null!==(t=this.headerStateManager.getHeaderTreeNodeData(e,i))&&void 0!==t?t:{};if(r)return o?this.expandSection({row:e,col:s}):this.collapseSection({row:e,col:s}),!1},runOnlyIf:()=>{var t,e;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isHeader())},group:dm,relativeToGroup:hs,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dm)}clearButtons(){if(!this.hot.view)return;let t=this.hot.view._wt.getSetting("columnHeaders").length,e=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(t){t&&t.parentNode.removeChild(t)};(0,eq.rangeEach)(0,t-1,t=>{let s=e.childNodes[t],n=i.childNodes[t],a=r?r.childNodes[t]:null;(0,eq.rangeEach)(0,s.childNodes.length-1,t=>{let e=s.childNodes[t].querySelector(`.${dv}`);o(e),n&&n.childNodes[t]&&o(e=n.childNodes[t].querySelector(`.${dv}`)),r&&a&&a.childNodes[t]&&o(e=a.childNodes[t].querySelector(`.${dv}`))})},!0)}expandSection(t){this.toggleCollapsibleSection([t],"expand")}collapseSection(t){this.toggleCollapsibleSection([t],"collapse")}toggleAllCollapsibleSections(t){let e=this.headerStateManager.mapNodes(e=>{let{collapsible:i,origColspan:r,headerLevel:o,columnIndex:s,isCollapsed:n}=e;if(!0===i&&r>1&&(n&&"expand"===t||!n&&"collapse"===t))return{row:this.headerStateManager.levelToRowCoords(o),col:s}});this.toggleCollapsibleSection(e,t)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(t,e){if(!dw.has(e))throw Error(`Unsupported action is passed (${e}).`);if(!Array.isArray(t))return;let i=(0,eu.arrayFilter)(t,t=>{let{row:e}=t;return e<0}),r=i.length>0;(0,eu.arrayEach)(i,t=>{var i;let{row:o,col:s}=t,{collapsible:n,isCollapsed:a}=null!==(i=this.headerStateManager.getHeaderSettings(o,s))&&void 0!==i?i:{};if(!n||a&&"collapse"===e||!a&&"expand"===e)return r=!1,!1});let o=[],s=[];r&&(0,eu.arrayEach)(i,t=>{let{row:i,col:r}=t,{colspanCompensation:n,affectedColumns:a,rollbackModification:l}=this.headerStateManager.triggerNodeModification(e,i,r);n>0&&(s.push(...a),o.push(l))});let n=this.getCollapsedColumns(),a=[];"collapse"===e?a=(0,eu.arrayUnique)([...n,...s]):"expand"===e&&(a=(0,eu.arrayFilter)(n,t=>!s.includes(t)));let l=dw.get(e);if(!1===this.hot.runHooks(l.beforeHook,n,a,r)){(0,eu.arrayEach)(o,t=>{t()});return}this.hot.batchExecution(()=>{(0,eu.arrayEach)(s,t=>{db.get(df(db,this)).setValueAtIndex(this.hot.toPhysicalColumn(t),l.hideColumn)})},!0);let h=this.getCollapsedColumns().length!==n.length,c=this.hot.getSelectedRangeLast();if("collapse"===e&&h&&c){let{row:t,col:e}=c.highlight;if((this.hot.rowIndexMapper.isHidden(t)||this.hot.columnIndexMapper.isHidden(e))&&s.includes(e)){let i=t>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(t,1,!0):t,r=e>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(e,1,!0):e;null!==i&&null!==r&&this.hot.selectCell(i,r)}}this.hot.runHooks(l.afterHook,n,a,r,h),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return db.get(df(db,this)).getHiddenIndexes()}destroy(){dp(db,this,null),super.destroy()}}),e8(dQ),e8(class extends cx{constructor(){var t,e;super(...arguments),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,d8),d8.add(this),(t="symbol"==typeof(e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="endpoints","string"))?e:e+"")in this?Object.defineProperty(this,t,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[t]=null}static get PLUGIN_KEY(){return d9}static get PLUGIN_PRIORITY(){return 220}isEnabled(){return!!this.hot.getSettings()[d9]}enablePlugin(){var t=this;this.enabled||(this.settings=this.hot.getSettings()[d9],this.endpoints=new d6(this,this.settings),this.addHook("afterInit",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return d5(d8,t,d7).call(t,...i)}),this.addHook("afterChange",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return d5(d8,t,ut).call(t,...i)}),this.addHook("beforeCreateRow",(t,e,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,e,null,i)),this.addHook("beforeCreateCol",(t,e,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,e,null,i)),this.addHook("beforeRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(t,e,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,e,null,i)),this.addHook("afterCreateCol",(t,e,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,e,null,i)),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return d5(d8,t,ue).call(t,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t)}}calculateSum(t){let e=0;return(0,t3.objectEach)(t.ranges,i=>{e+=this.getPartialSum(i,t.sourceColumn)}),e}getPartialSum(t,e){let i=0,r=t[1]||t[0],o=null,s=0;do{if(null!==(o=d4(o=this.getCellValue(r,e))?null:o)){let t=(`${o}`.split(".")[1]||[]).length||1;t>s&&(s=t)}i+=o||0,r-=1}while(r>=t[0])return Math.round(i*10**s)/10**s}calculateMinMax(t,e){let i=null;return(0,t3.objectEach)(t.ranges,r=>{let o=this.getPartialMinMax(r,t.sourceColumn,e);if(null===i&&null!==o&&(i=o),null!==o)switch(e){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o)}}),null===i?"Not enough data":i}getPartialMinMax(t,e,i){let r,o=null,s=t[1]||t[0];do{if(r=d4(r=this.getCellValue(s,e))?null:r,null===o)o=r;else if(null!==r)switch(i){case"min":o=Math.min(o,r);break;case"max":o=Math.max(o,r)}s-=1}while(s>=t[0])return o}countEmpty(t,e){let i;let r=0,o=t[1]||t[0];do null===(i=d4(i=this.getCellValue(o,e))?null:i)&&(r+=1),o-=1;while(o>=t[0])return r}countEntries(t){let e=0,i=t.ranges;return(0,t3.objectEach)(i,i=>{let r=void 0===i[1]?1:i[1]-i[0]+1,o=this.countEmpty(i,t.sourceColumn);e+=r,e-=o}),e}calculateAverage(t){return this.calculateSum(t)/this.countEntries(t)}getCellValue(t,e){let i=this.hot.toVisualRow(t),r=this.hot.toVisualColumn(e),o=this.hot.getSourceDataAtCell(t,e),s="";if(null!==i&&null!==r&&(s=this.hot.getCellMeta(i,r).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof o&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw Error((0,iJ.toSingleLine)`ColumnSummary plugin: cell at (${t}, ${e}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}),e8(class extends cx{constructor(){var t,e,i;super(...arguments),uk(this,uY),uY.add(this),e={},(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="range","string"))?i:i+"")in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e,uM(this,uF,null),uM(this,uj,null),uM(this,uB,!1),uM(this,uW,!1),uM(this,uV,{}),uM(this,uU,null),uM(this,uz,"")}static get PLUGIN_KEY(){return uI}static get PLUGIN_PRIORITY(){return 60}isEnabled(){return!!this.hot.getSettings()[uI]}enablePlugin(){this.enabled||(uO(uF,this)||uA(uF,this,new ur(this.hot.rootDocument,this.hot.isRtl())),uO(uj,this)||uA(uj,this,new us(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",t=>this.addToContextMenu(t)),this.addHook("afterRenderer",(t,e,i,r,o,s)=>uP(uY,this,uq).call(this,t,s)),this.addHook("afterScroll",()=>uP(uY,this,u1).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",t=>uP(uY,this,u0).call(this,t)),uO(uj,this).addLocalHook("hide",()=>this.hide()),uO(uj,this).addLocalHook("show",(t,e)=>this.showAtCell(t,e)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){uO(uj,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){let t=this.hot.getShortcutManager(),e=t.getContext("grid"),i=t.addContext(u_);e.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{let e=this.hot.getSelectedRangeLast();uA(uW,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(e),this.show(),this.focusEditor(),t.setActiveContextName(u_),this.hot._registerTimeout(()=>{uA(uW,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&!uO(uF,this).isVisible()},group:uI}),i.addShortcut({keys:[["Escape"]],callback:()=>{uO(uF,this).setValue(uO(uz,this)),this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&uO(uF,this).isVisible()},group:uI}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&uO(uF,this).isVisible()},group:uI})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uI)}registerListeners(){let{rootDocument:t}=this.hot,e=this.getEditorInputElement();this.eventManager.addEventListener(t,"mouseover",t=>uP(uY,this,u$).call(this,t)),this.eventManager.addEventListener(t,"mousedown",t=>uP(uY,this,uG).call(this,t)),this.eventManager.addEventListener(t,"mouseup",()=>uP(uY,this,uX).call(this)),this.eventManager.addEventListener(e,"focus",()=>uP(uY,this,uZ).call(this)),this.eventManager.addEventListener(e,"blur",()=>uP(uY,this,uK).call(this)),this.eventManager.addEventListener(e,"mousedown",t=>uP(uY,this,uQ).call(this,t)),this.eventManager.addEventListener(e,"mouseup",t=>uP(uY,this,uJ).call(this,t))}setRange(t){this.range=t}clearRange(){this.range={}}targetIsCellWithComment(t){let e=(0,tZ.closest)(t.target,"TD","TBODY");return!!(e&&(0,tZ.hasClass)(e,"htCommentCell")&&(0,tZ.closest)(e,[this.hot.rootElement]))}targetIsCommentTextArea(t){return this.getEditorInputElement()===t.target}setComment(t){if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');let e=uO(uF,this).getValue(),i="";null!=t?i=t:null!=e&&(i=e);let r=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(r,o,{[uL]:i}),this.hot.render()}setCommentAtCell(t,e,i){this.setRange({from:this.hot._createCellCoords(t,e)}),this.setComment(i)}removeComment(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,uH),t&&this.hot.render(),this.hide()}removeCommentAtCell(t,e){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];this.setRange({from:this.hot._createCellCoords(t,e)}),this.removeComment(i)}getComment(){let t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,uL)}getCommentAtCell(t,e){return this.getCommentMeta(t,e,uL)}show(){var t;if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');let{from:{row:e,col:i}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;let r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return uO(uj,this).cancelHiding(),uO(uF,this).setValue(null!==(t=r[uH]?r[uH][uL]:null)&&void 0!==t?t:""),uO(uF,this).show(),this.refreshEditor(!0),!0}showAtCell(t,e){return this.setRange({from:this.hot._createCellCoords(t,e)}),this.show()}hide(){uO(uF,this).hide()}refreshEditor(){var t,e;let i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!i&&(!this.range.from||!uO(uF,this).isVisible()))return;let{rowIndexMapper:r,columnIndexMapper:o}=this.hot,{row:s,col:n}=this.range.from,a=r.getRenderableFromVisualIndex(s),l=o.getRenderableFromVisualIndex(n),h=null===a;uO(uF,this).setPosition(0,0),null===a&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,-1))),null===l&&(l=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1)));let c=null===a,d=null===l;a=null!==(t=a)&&void 0!==t?t:0,l=null!==(e=l)&&void 0!==e?e:0;let{rootWindow:u,view:{_wt:g}}=this.hot,{wtTable:p}=g,f=g.getCell({row:a,col:l},!0),m=this.getCommentMeta(s,n,uD);m?uO(uF,this).setSize(m.width,m.height):uO(uF,this).resetSize();let y=d?0:p.getStretchedColumnWidth(l),w=h&&!c?(0,tZ.outerHeight)(f):0,{left:b,top:C,width:S,height:x}=f.getBoundingClientRect(),{width:E,height:R}=uO(uF,this).getSize(),{innerWidth:T,innerHeight:M}=this.hot.rootWindow,k=this.hot.rootDocument.documentElement,A=b+u.scrollX+y,O=C+u.scrollY+w;this.hot.isRtl()&&(A-=E+y),this.hot.isLtr()&&b+S+E>T?A=b+u.scrollX-E-1:this.hot.isRtl()&&A<-(k.scrollWidth-k.clientWidth)&&(A=b+u.scrollX+y+1),C+R>M&&(O-=R-x+1),uO(uF,this).setPosition(A,O),uO(uF,this).setReadOnlyState(this.getCommentMeta(s,n,uN))}focusEditor(){uO(uF,this).focus()}updateCommentMeta(t,e,i){let r;let o=this.hot.getCellMeta(t,e)[uH];o?(r=(0,t3.deepClone)(o),(0,t3.deepExtend)(r,i)):r=i,this.hot.setCellMeta(t,e,uH,r)}getCommentMeta(t,e,i){let r=this.hot.getCellMeta(t,e);if(r[uH])return r[uH][i]}addToContextMenu(t){var e,i,r;t.items.push({name:ud},(e=this,{key:"commentsAddEdit",name(){var t;let i=null===(t=this.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return null!=i&&i.isCell()&&e.getCommentAtCell(i.row,i.col)?this.getTranslatedPhrase(nj):this.getTranslatedPhrase(nF)},callback(){let t=this.getSelectedRangeLast();this.deselectCell(),e.setRange(t),e.show(),e.focusEditor()},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected())||0===this.countRenderedRows()||0===this.countRenderedCols()}}),(i=this,{key:"commentsRemove",name(){return this.getTranslatedPhrase(nB)},callback(){this.getSelectedRangeLast().forAll((t,e)=>{t>=0&&e>=0&&i.removeCommentAtCell(t,e,!1)}),this.render()},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected())||0===this.countRenderedRows()||0===this.countRenderedCols()}}),(r=this,{key:"commentsReadOnly",name(){let t=this.getTranslatedPhrase(nW);return uh(this.getSelectedRange(),(t,e)=>r.getCommentMeta(t,e,uN))?ul(t):t},callback(){this.getSelectedRangeLast().forAll((t,e)=>{if(t>=0&&e>=0){let i=!!r.getCommentMeta(t,e,uN);r.updateCommentMeta(t,e,{[uN]:!i})}})},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||!r.getCommentAtCell(t.highlight.row,t.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected())||0===this.countRenderedRows()||0===this.countRenderedCols()}}))}getDisplayDelaySetting(){let t=this.hot.getSettings()[uI];if((0,t3.isObject)(t))return t.displayDelay}getEditorInputElement(){return uO(uF,this).getInputElement()}destroy(){uO(uF,this)&&uO(uF,this).destroy(),uO(uj,this)&&uO(uj,this).destroy(),super.destroy()}}),e8(gI),e8(class extends cx{constructor(){super(...arguments),g2(this,pl),pl.add(this),g3(this,"columnsLimit",1/0),g3(this,"rowsLimit",1/0),g3(this,"pasteMode","overwrite"),g3(this,"uiContainer",this.hot.rootDocument.body),g1(this,pt,!1),g1(this,pe,!1),g1(this,pi,!1),g1(this,pr,"cells-only"),g1(this,po,!1),g1(this,ps,!1),g1(this,pn,new gZ({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),g1(this,pa,!1),g3(this,"copyableRanges",[])}static get PLUGIN_KEY(){return g9}static get SETTING_KEYS(){return[g9,...g8]}static get PLUGIN_PRIORITY(){return 80}isEnabled(){return!!this.hot.getSettings()[g9]}enablePlugin(){var t,e,i=this;if(this.enabled)return;let{[g9]:r}=this.hot.getSettings();"object"==typeof r&&(this.pasteMode=null!==(t=r.pasteMode)&&void 0!==t?t:this.pasteMode,this.rowsLimit=isNaN(r.rowsLimit)?this.rowsLimit:r.rowsLimit,this.columnsLimit=isNaN(r.columnsLimit)?this.columnsLimit:r.columnsLimit,g4(pt,this,!!r.copyColumnHeaders),g4(pe,this,!!r.copyColumnGroupHeaders),g4(pi,this,!!r.copyColumnHeadersOnly),this.uiContainer=null!==(e=r.uiContainer)&&void 0!==e?e:this.uiContainer),this.addHook("afterContextMenuDefaultOptions",t=>g5(pl,this,pg).call(this,t)),this.addHook("afterSelection",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return g5(pl,i,pp).call(i,...e)}),this.addHook("afterSelectionEnd",()=>g5(pl,this,pf).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),(0,t0.isSafari)()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return g5(pl,i,pm).call(i,...e)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return g5(pl,i,py).call(i,...e)}),this.addHook("afterSelection",()=>g5(pl,this,pv).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only";g4(pr,this,t),g4(po,this,!0),g5(pl,this,ph).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){g4(ps,this,!0),g5(pl,this,ph).call(this,"cut")}getRangedCopyableData(t){return ht(this.getRangedData(t))}getRangedData(t){let e=[],{rows:i,columns:r}=g0(t);return(0,eu.arrayEach)(i,t=>{let i=[];(0,eu.arrayEach)(r,e=>{t<0?i.push(this.hot.getColHeader(e,t)):i.push(this.hot.getCopyableData(t,e))}),e.push(i)}),e}paste(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t&&!e)return;let i=new gF;t&&i.clipboardData.setData("text/plain",t),e&&i.clipboardData.setData("text/html",e),this.onPaste(i)}setCopyableText(){let t=this.hot.getSelectedRangeLast();if(!t)return;if(t.isSingleHeader()){this.copyableRanges=[];return}g6(pn,this).setSelectedRange(t);let e=new Map([["headers",null],["cells",null]]);"column-headers-only"===g6(pr,this)?e.set("headers",g6(pn,this).getMostBottomColumnHeadersRange()):("with-column-headers"===g6(pr,this)?e.set("headers",g6(pn,this).getMostBottomColumnHeadersRange()):"with-column-group-headers"===g6(pr,this)&&e.set("headers",g6(pn,this).getAllColumnHeadersRange()),e.set("cells",g6(pn,this).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter(t=>null!==t).map(t=>{let{startRow:e,startCol:i,endRow:r,endCol:o}=t;return{startRow:e,startCol:i,endRow:r,endCol:o}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);let i=e.get("cells");if(null!==i&&i.isRangeTrimmed){let{startRow:t,startCol:e,endRow:r,endCol:o}=i;this.hot.runHooks("afterCopyLimit",r-t+1,o-e+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}populateValues(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!t.length)return;let i=t.length,r=t[0].length,o=[],{row:s,col:n}=e.getTopStartCorner(),{row:a,col:l}=e.getBottomEndCorner(),h=s,c=n,d=s,u=n;for(;o.length<i||h<=a;){let{skipRowOnPaste:e,visualRow:a}=this.hot.getCellMeta(h,n);if(h=a+1,!0===e)continue;d=a,c=n;let g=[],p=o.length%i;for(;g.length<r||c<=l;){let{skipColumnOnPaste:e,visualCol:i}=this.hot.getCellMeta(s,c);if(c=i+1,!0===e)continue;u=i;let o=g.length%r;g.push(t[p][o])}o.push(g)}return g4(pa,this,!0),this.hot.populateFromArray(s,n,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,n,d,u]}onCopy(t){if(!this.hot.isListening()&&!g6(po,this)||this.isEditorOpened())return;this.setCopyableText(),g4(po,this,!1);let e=this.getRangedData(this.copyableRanges),i=g5(pl,this,pc).call(this,this.copyableRanges);if(this.hot.runHooks("beforeCopy",e,this.copyableRanges,i)){let r=ht(e);if(t&&t.clipboardData){let i=eG(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",r),t.clipboardData.setData("text/html",[g7,i].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.runHooks("afterCopy",e,this.copyableRanges,i)}g4(pr,this,"cells-only"),t.preventDefault()}onCut(t){if(!this.hot.isListening()&&!g6(ps,this)||this.isEditorOpened())return;this.setCopyableText(),g4(ps,this,!1);let e=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",e,this.copyableRanges)){let i=ht(e);if(t&&t.clipboardData){let r=eG(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",i),t.clipboardData.setData("text/html",[g7,r].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",e,this.copyableRanges)}t.preventDefault()}onPaste(t){let e;if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;if(t&&t.preventDefault&&t.preventDefault(),t&&void 0!==t.clipboardData){let i=(0,eX.sanitize)(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});e=i&&/(<table)|(<TABLE)/g.test(i)?e$(i,this.hot.rootDocument).data:t.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof e&&(e=function(t){let e;let i=[[""]];if(0===t.length)return i;let r=0,o=0;for(;t.length>0&&e!==t.length;)if(e=t.length,t.match(l7))t=t.replace(l7,""),r+=1,i[o][r]="";else if(t.match(l9))t=t.replace(l9,""),r=0,i[o+=1]=[""];else{let e="";if(t.startsWith('"')){let i=0,r=!0;for(;r;){let o=t.slice(0,1);'"'===o&&(i+=1),e+=o,(0===(t=t.slice(1)).length||t.match(/^[\t\r\n]/)&&i%2==0)&&(r=!1)}e=e.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,t=>Array(Math.floor(t.length/2)).fill('"').join(""))}else{let i=t.match(l8);e=i?i[0]:"",t=t.slice(e.length)}i[o][r]=e}return i}(e)),void 0===e||e&&0===e.length||!1===this.hot.runHooks("beforePaste",e,this.copyableRanges))return;let[i,r,o,s]=this.populateValues(e);this.hot.selectCell(i,r,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",e,this.copyableRanges)}destroy(){super.destroy()}}),e8(class extends cx{constructor(){var t,e,i;super(...arguments),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,pO),pO.add(this),e=[],(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="savedBorders","string"))?i:i+"")in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e}static get PLUGIN_KEY(){return pA}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[pA]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",t=>pk(pO,this,pP).call(this,t)),this.addHook("init",()=>pk(pO,this,pI).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(t,e){let i=["top","bottom","start","end"],r=null;e&&(this.checkSettingsCohesion([e]),i=Object.keys(e),r=pS(e));let o=lS(lC(t),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});(0,eu.arrayEach)(t,t=>{o(t).forAll((t,e)=>{(0,eu.arrayEach)(i,i=>{var o;this.prepareBorderFromCustomAdded(t,e,r,null!==(o=pM.get(i))&&void 0!==o?o:i)})})}),this.hot.view.render()}getBorders(t){if(!Array.isArray(t))return this.savedBorders;let e=lS(lC(t),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return(0,eu.arrayEach)(t,t=>{e(t).forAll((t,e)=>{(0,eu.arrayEach)(this.savedBorders,r=>{r.row===t&&r.col===e&&i.push(px(r))})})}),i}clearBorders(t){t?this.setBorders(t):((0,eu.arrayEach)(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(t,e){this.checkSavedBorders(t)||this.savedBorders.push(t);let i=this.hot._createCellRange(this.hot._createCellCoords(t.row,t.col));this.checkCustomSelections(t,i,e)||this.hot.selection.highlight.addCustomSelection({border:t,visualCellRange:i})}prepareBorderFromCustomAdded(t,e,i,r){let o=this.hot.countRows(),s=this.hot.countCols();if(t>=o||e>=s)return;let n=pE(t,e);if(i){var a;a=n,(0,t3.hasOwnProperty)(i,"border")&&i.border&&(a.border=i.border),(0,t3.hasOwnProperty)(i,"top")&&(0,tJ.isDefined)(i.top)&&(i.top?(0,t3.isObject)(i.top)||(i.top=pb()):i.top=pC(),a.top=i.top),(0,t3.hasOwnProperty)(i,"bottom")&&(0,tJ.isDefined)(i.bottom)&&(i.bottom?(0,t3.isObject)(i.bottom)||(i.bottom=pb()):i.bottom=pC(),a.bottom=i.bottom),(0,t3.hasOwnProperty)(i,"start")&&(0,tJ.isDefined)(i.start)&&(i.start?(0,t3.isObject)(i.start)||(i.start=pb()):i.start=pC(),a.start=i.start),(0,t3.hasOwnProperty)(i,"end")&&(0,tJ.isDefined)(i.end)&&(i.end?(0,t3.isObject)(i.end)||(i.end=pb()):i.end=pC(),a.end=i.end),n=a,(0,eu.arrayEach)(this.hot.selection.highlight.customSelections,t=>{if(n.id===t.settings.id)return Object.assign(t.settings,i),n.id=t.settings.id,n.top=t.settings.top,n.bottom=t.settings.bottom,n.start=t.settings.start,n.end=t.settings.end,!1})}this.hot.setCellMeta(t,e,"borders",px(n)),this.insertBorderIntoSettings(n,r)}prepareBorderFromCustomAddedRange(t,e){let i=Math.min(t.to.row,this.hot.countRows()-1),r=Math.min(t.to.col,this.hot.countCols()-1);(0,eq.rangeEach)(t.from.row,i,i=>{(0,eq.rangeEach)(t.from.col,r,r=>{let o=pE(i,r),s=0;i===t.from.row&&(0,t3.hasOwnProperty)(e,"top")&&(s+=1,o.top=e.top),i===t.to.row&&(0,t3.hasOwnProperty)(e,"bottom")&&(s+=1,o.bottom=e.bottom),r===t.from.col&&(0,t3.hasOwnProperty)(e,"start")&&(s+=1,o.start=e.start),r===t.to.col&&(0,t3.hasOwnProperty)(e,"end")&&(s+=1,o.end=e.end),s>0&&(this.hot.setCellMeta(i,r,"borders",px(o)),this.insertBorderIntoSettings(o))})})}removeAllBorders(t,e){let i=pw(t,e);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}setBorder(t,e,i,r){let o=this.hot.getCellMeta(t,e).borders;o=o&&void 0!==o.border?pS(o):pE(t,e),r?(o[i]=pC(),4===this.countHide(o)?this.removeAllBorders(t,e):(this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(t,e,"borders",px(o)))):(o[i]=pb(),this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(t,e,"borders",px(o)))}prepareBorder(t,e,i){(0,eu.arrayEach)(t,t=>{let{start:r,end:o}=t;if(r.row===o.row&&r.col===o.col)"noBorders"===e?this.removeAllBorders(r.row,r.col):this.setBorder(r.row,r.col,e,i);else switch(e){case"noBorders":(0,eq.rangeEach)(r.col,o.col,t=>{(0,eq.rangeEach)(r.row,o.row,e=>{this.removeAllBorders(e,t)})});break;case"top":(0,eq.rangeEach)(r.col,o.col,t=>{this.setBorder(r.row,t,e,i)});break;case"bottom":(0,eq.rangeEach)(r.col,o.col,t=>{this.setBorder(o.row,t,e,i)});break;case"start":(0,eq.rangeEach)(r.row,o.row,t=>{this.setBorder(t,r.col,e,i)});break;case"end":(0,eq.rangeEach)(r.row,o.row,t=>{this.setBorder(t,o.col,e,i)})}})}createCustomBorders(t){(0,eu.arrayEach)(t,t=>{let e=pS(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,e):this.prepareBorderFromCustomAdded(t.row,t.col,e)})}countHide(t){let{top:e,bottom:i,start:r,end:o}=t;return(0,eu.arrayReduce)([e,i,r,o],(t,e)=>{let i=t;return e&&e.hide&&(i+=1),i},0)}clearBordersFromSelectionSettings(t){let e=(0,eu.arrayMap)(this.hot.selection.highlight.customSelections,t=>t.settings.id).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear()}clearNullCellRange(){(0,eu.arrayEach)(this.hot.selection.highlight.customSelections,(t,e)=>{if(null===t.cellRange)return this.hot.selection.highlight.customSelections[e].destroy(),this.hot.selection.highlight.customSelections.splice(e,1),!1})}hideBorders(){(0,eu.arrayEach)(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange()})}spliceBorder(t){let e=(0,eu.arrayMap)(this.savedBorders,t=>t.id).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}checkSavedBorders(t){let e=!1;return 4===this.countHide(t)?(this.spliceBorder(t.id),e=!0):(0,eu.arrayEach)(this.savedBorders,(i,r)=>{if(t.id===i.id)return this.savedBorders[r]=t,e=!0,!1}),e}checkCustomSelectionsFromContextMenu(t,e,i){let r=!1;return(0,eu.arrayEach)(this.hot.selection.highlight.customSelections,o=>{if(t.id===o.settings.id){let t=this.hot.view._wt.selectionManager.getBorderInstances(o);return(0,eu.arrayEach)(t,t=>{t.toggleHiddenClass(e,i)}),r=!0,!1}}),r}checkCustomSelections(t,e,i){let r=this.countHide(t),o=!1;return 4===r?(this.removeAllBorders(t.row,t.col),o=!0):(0,eu.arrayEach)(this.hot.selection.highlight.customSelections,r=>{if(t.id===r.settings.id){if(r.visualCellRange=e,r.commit(),i){let e=this.hot.view._wt.selectionManager.getBorderInstances(r);(0,eu.arrayEach)(e,e=>{e.changeBorderStyle(i,t)})}return o=!0,!1}}),o}changeBorderSettings(){let t=this.hot.getSettings()[pA];if(Array.isArray(t)){let e=(0,t3.deepClone)(t);this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)}else void 0!==t&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(t){let e=t.some(t=>(0,tJ.isDefined)(t.left)||(0,tJ.isDefined)(t.right)),i=t.some(t=>(0,tJ.isDefined)(t.start)||(0,tJ.isDefined)(t.end));if(e&&i)throw Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&e)throw Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}),e8(class extends cx{constructor(){super(...arguments),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,pN),pN.add(this),pH(this,"boundaries",null),pH(this,"callback",null),pH(this,"listening",!1)}static get PLUGIN_KEY(){return pD}static get PLUGIN_PRIORITY(){return 100}isEnabled(){return!!this.hot.getSettings()[pD]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",t=>pL(pN,this,p_).call(this,t)),this.addHook("afterOnCellCornerMouseDown",t=>pL(pN,this,p_).call(this,t)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=t}setCallback(t){this.callback=t}check(t,e){let i=0,r=0;e<this.boundaries.top?r=e-this.boundaries.top:e>this.boundaries.bottom&&(r=e-this.boundaries.bottom),t<this.boundaries.left?i=t-this.boundaries.left:t>this.boundaries.right&&(i=t-this.boundaries.right),this.callback(i,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){let{rootWindow:t}=this.hot,e=t;for(;e;)this.eventManager.addEventListener(e.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(e.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(e.document,"mousemove",t=>this.onMouseMove(t)),e=(0,tZ.getParentWindow)(e)}unregisterEvents(){this.eventManager.clear()}onMouseMove(t){this.isListening()&&this.check(t.clientX,t.clientY)}destroy(){super.destroy()}}),e8(pG),e8(class extends cx{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}exportAsBlob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}downloadFile(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{rootDocument:i,rootWindow:r}=this.hot,o=this._createTypeFormatter(t,e),s=this._createBlob(o),n=r.URL||r.webkitURL,a=i.createElement("a"),l=`${o.options.filename}.${o.options.fileExtension}`;if(void 0!==a.download){let t=n.createObjectURL(s);a.style.display="none",a.setAttribute("href",t),a.setAttribute("download",l),i.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),i.body.removeChild(a),setTimeout(()=>{n.revokeObjectURL(t)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,l)}_createTypeFormatter(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!p9[t])throw Error(`Export format type "${t}" is not supported.`);return e=new p3(this.hot),"function"==typeof p9[t]?new p9[t](e,i):null}_createBlob(t){let e=null;return"undefined"!=typeof Blob&&(e=new Blob([t.export()],{type:`${t.options.mimeType};charset=${t.options.encoding}`})),e}}),e8(class extends cx{static get PLUGIN_KEY(){return m4}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(t){var e;super(t),m1(this,m9),m9.add(this),m2(this,"dropdownMenuPlugin",null),m2(this,"conditionCollection",null),m2(this,"conditionUpdateObserver",null),m2(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),m2(this,"filtersRowsMap",null),e=void 0,m1(this,m5),m5.set(this,e),this.hot.addHook("afterGetColHeader",(t,e)=>m6(m9,this,ys).call(this,t,e))}isEnabled(){return!!this.hot.getSettings()[m4]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new sQ),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");let t=this.hot.getSettings().dropdownMenu,e=t&&t.uiContainer||this.hot.rootDocument.body,i=t=>(t.addLocalHook("accept",()=>m6(m9,this,yi).call(this,"accept")),t.addLocalHook("cancel",()=>m6(m9,this,yi).call(this,"cancel")),t.addLocalHook("change",e=>m6(m9,this,yr).call(this,t,e)),t);if(!this.components.get("filter_by_condition")){let t=new f8(this.hot,{id:"filter_by_condition",name:()=>`${this.hot.getTranslatedPhrase(aC)}:`,addSeparator:!1,menuContainer:e});t.addLocalHook("afterClose",()=>m6(m9,this,yo).call(this)),this.components.set("filter_by_condition",i(t))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new mh(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){let t=new f8(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:e});t.addLocalHook("afterClose",()=>m6(m9,this,yo).call(this)),this.components.set("filter_by_condition2",i(t))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new mD(this.hot,{id:"filter_by_value",name:()=>`${this.hot.getTranslatedPhrase(aS)}:`}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new mB(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new mz(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new mK(this.hot,this.conditionCollection,t=>this.getDataMapAtColumn(t)),this.conditionUpdateObserver.addLocalHook("update",t=>m6(m9,this,yn).call(this,t))),this.components.forEach(t=>t.show()),this.addHook("afterDropdownMenuDefaultOptions",t=>m6(m9,this,ye).call(this,t)),this.addHook("afterDropdownMenuShow",()=>m6(m9,this,m7).call(this)),this.addHook("afterDropdownMenuHide",()=>m6(m9,this,yt).call(this)),this.addHook("afterChange",t=>m6(m9,this,m8).call(this,t)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!m3(m5,this)&&this.dropdownMenuPlugin.enabled){var r;let t=this.dropdownMenuPlugin.menu,e=[{focus:()=>{let e=t.getNavigator(),i=m3(m5,this).getLastMenuPage();t.focus(),i>0?e.setCurrentPage(i):e.toFirstItem()}},...Array.from(this.components).map(t=>{let[,e]=t;return e.getElements()}).flat()];r=function(t,e){let i=-1,r=gg({initialPage:0,size:()=>e.length,onItemSelect:(t,i)=>{let r=e[t];return r instanceof mk?i:(!r.element||!!(0,tZ.isVisible)(r.element))&&void r.focus()}}),o=i=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(m0),r.setCurrentPage(e.indexOf(i))};function s(o){let s=t.getKeyboardShortcutsCtrl(),n=o.getKeyboardShortcutsCtrl();r.clear(),n.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:s.getContext(m0),callback:()=>{o.isSubMenu()&&o.close(),s.listen(m0)}}]),o.isSubMenu()||s.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{let o=t.getNavigator();o.getCurrentPage()>-1&&(i=o.getCurrentPage()),o.clear(),e.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:t=>{let i=e[r.getCurrentPage()];i instanceof f1&&(i.openOptions(),t.preventDefault()),i instanceof mp&&(i.activate(),t.preventDefault()),i instanceof fN||t.preventDefault()}}],m0)}return e.forEach(t=>{t instanceof fN&&(t.addLocalHook("click",o(t)),t.addLocalHook("focus",o(t)),t.addLocalHook("afterClose",o(t)))}),t.addLocalHook("afterSelectionChange",t=>{t.key.startsWith("filter_")||r.clear()}),t.addLocalHook("afterSubmenuOpen",s),t.addLocalHook("afterOpen",s),{...r,listen:function(){t.focus(),t.getKeyboardShortcutsCtrl().listen(m0)},getLastMenuPage:function(){return i}}}(t,e),m5.set(m6(m5,this),r);let i=t=>{m3(m5,this).listen(),t.preventDefault(),(0,iL.isKey)(t.keyCode,"TAB")&&(t.shiftKey?m3(m5,this).toPreviousItem():m3(m5,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",i),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",i)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var t;null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,e)=>{t.destroy(),this.components.set(e,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{let t=this.hot.getSelected();this.clearConditions(),this.filter(),t&&this.hot.selectCells(t)},group:m4})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(m4)}addCondition(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:fM,o=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(o,{command:{key:e},args:i},r)}removeConditions(t){let e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}clearConditions(t){if(void 0===t)this.conditionCollection.clean();else{let e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}filter(){let{navigableHeaders:t}=this.hot.getSettings(),e=this._createDataFilter(),i=!this.conditionCollection.isEmpty(),r=[],o=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",o)){if(i){let i=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear();let t=fb(r=(0,eu.arrayMap)(e.filter(),t=>t.meta.visualRow));(0,eq.rangeEach)(this.hot.countSourceRows()-1,e=>{t(e)||i.push(e)}),(0,eu.arrayEach)(i,t=>{this.filtersRowsMap.setValueAtIndex(t,!0)})},!0),t||r.length||this.hot.deselectCell()}else this.filtersRowsMap.clear()}this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(t?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}getDataMapAtColumn(t){let e=this.hot.toVisualColumn(t),i=[];return(0,eu.arrayEach)(this.hot.getSourceDataAtCol(e),(t,r)=>{var o;let{row:s,col:n,visualCol:a,visualRow:l,type:h,instance:c,dateFormat:d,locale:u}=this.hot.getCellMeta(r,e),g=null!==(o=this.hot.getDataAtCell(this.hot.toVisualRow(r),e))&&void 0!==o?o:t;i.push({meta:{row:s,col:n,visualCol:a,visualRow:l,type:h,instance:c,dateFormat:d,locale:u},value:fC(g)})}),i}updateValueComponentCondition(t){let e=fS(this.hot.getDataAtCol(t));this.conditionUpdateObserver.updateStatesAtColumn(t,e)}restoreComponents(t){var e;let i=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach(t=>{t.isHidden()||t.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(t,e,i,r){let o=t;return o===fk&&e.command.key!==fo&&i.command.key!==fo&&r.command.key!==fo?o=fA:r.command.key!==fo&&(e.command.key===fo||i.command.key===fo)&&(o=fM),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){let{command:t}=this.components.get("filter_by_condition").getState(),e=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...e):this.hideComponents(...e)}_createDataFilter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new mG(t,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){let t=[];if(!this.dropdownMenuPlugin)return t;let e=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];return(0,eu.arrayEach)(r,i=>{(0,eu.arrayEach)(e.menuItems,(e,r)=>{e.key===i.getMenuItemDescriptor().key&&t.push(r)})}),t}changeComponentsVisibility(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!this.dropdownMenuPlugin)return;let e=this.dropdownMenuPlugin.menu.hotMenu,i=e.getPlugin("hiddenRows");for(var r=arguments.length,o=Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];let n=this.getIndexesOfComponents(...o);t?i.showRows(n):i.hideRows(n),e.render()}hideComponents(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.changeComponentsVisibility(!1,...e)}showComponents(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.changeComponentsVisibility(!0,...e)}destroy(){this.enabled&&(this.components.forEach((t,e)=>{null!==t&&(t.destroy(),this.components.set(e,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}),e8(class extends cx{constructor(){var t;super(...arguments),t=this,yX(this,y6),y6.add(this),y$(this,y1,!1),y$(this,y2,!1),y$(this,y3,[["valuesUpdated",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return yZ(y6,t,vg).call(t,...i)}],["namedExpressionAdded",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return yZ(y6,t,vp).call(t,...i)}],["namedExpressionRemoved",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return yZ(y6,t,vf).call(t,...i)}],["sheetAdded",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return yZ(y6,t,vm).call(t,...i)}],["sheetRenamed",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return yZ(y6,t,vy).call(t,...i)}],["sheetRemoved",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return yZ(y6,t,vv).call(t,...i)}]]),yG(this,"staticRegister",(0,e7.default)("formulas")),yG(this,"engine",null),yG(this,"sheetName",null),yG(this,"indexSyncer",null),yG(this,"rowAxisSyncer",null),yG(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return yQ}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[yQ,...yJ]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[yQ]}enablePlugin(){var t,e=this;if(!this.enabled){if(this.engine=null!==(t=function(t){let e=t.getSettings(),i=e[yQ],r=null==i?void 0:i.engine;if(!0===i||(0,tJ.isUndefined)(r))return null;if("function"==typeof r.hyperformula||"function"==typeof r){var o;return function(t,e,i){var r,o;let s=e[yQ],n=function(t){var e;let i=t[yQ],r=yc(null!=i&&null!==(e=i.engine)&&void 0!==e&&e.hyperformula?i.engine:{}),o=yh(t);return{...yl,...r,...o}}(e),a=yd(),l=yu();(r=s.functions)&&r.forEach(e=>{let{name:i,plugin:r,translations:o}=e;try{t.registerFunction(i,r,o)}catch(t){(0,t6.warn)(t.message)}}),function(t,e){if(e){let{langCode:i}=e;try{t.registerLanguage(i,e)}catch(t){(0,t6.warn)(t.message)}}}(t,s.language);let h=t.buildEmpty(n);return a.set(h,[i]),l.set(h,[i.guid]),(o=s.namedExpressions)&&(h.suspendEvaluation(),o.forEach(t=>{let{name:e,expression:i,scope:r,options:o}=t;try{h.addNamedExpression(e,i,r,o)}catch(t){(0,t6.warn)(t.message)}}),h.resumeEvaluation()),h.on("sheetAdded",()=>{h.rebuildAndRecalculate()}),h.on("sheetRemoved",()=>{h.rebuildAndRecalculate()}),h}(null!==(o=r.hyperformula)&&void 0!==o?o:r,e,t)}if("object"==typeof r&&(0,tJ.isUndefined)(r.hyperformula)){let e=yd(),i=yu().get(r);return e.has(r)||e.set(r,[]),e.get(r).push(t),i&&i.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:ya}),(r.getConfig().leapYear1900!==yl.leapYear1900||!1===(0,t3.isObjectEqual)(r.getConfig().nullDate,yl.nullDate))&&(0,t6.warn)((0,iJ.toSingleLine)`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}(this.hot))&&void 0!==t?t:this.engine,!this.engine){(0,t6.warn)("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){let t=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==t&&(this.sheetName=t)}this.addHook("beforeLoadData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,y9).call(e,...i)}),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,y7).call(e,...i)}),this.addHook("beforeUpdateData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,y9).call(e,...i)}),this.addHook("afterUpdateData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,y7).call(e,...i)}),this.addHook("modifyData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,vt).call(e,...i)}),this.addHook("modifySourceData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,ve).call(e,...i)}),this.addHook("beforeValidate",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,y4).call(e,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,vr).call(e,...i)}),this.addHook("afterSetDataAtCell",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,vi).call(e,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,vi).call(e,...i)}),this.addHook("beforeCreateRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,vo).call(e,...i)}),this.addHook("beforeCreateCol",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,vs).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,vl).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,vh).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,vn).call(e,...i)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,va).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,vc).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,vd).call(e,...i)}),this.indexSyncer=new yY(this.hot.rowIndexMapper,this.hot.columnIndexMapper,t=>{this.hot.addHookOnce("init",()=>{t()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(t,e,i,r)=>{this.rowAxisSyncer.storeMovesInformation(t,e,r)}),this.hot.addHook("beforeColumnMove",(t,e,i,r)=>{this.columnAxisSyncer.storeMovesInformation(t,e,r)}),this.hot.addHook("afterRowMove",(t,e,i,r,o)=>{this.rowAxisSyncer.calculateAndSyncMoves(r,o)}),this.hot.addHook("afterColumnMove",(t,e,i,r,o)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,o)}),this.hot.addHook("beforeColumnFreeze",(t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart,e)}),this.hot.addHook("afterColumnFreeze",(t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)}),this.hot.addHook("beforeColumnUnfreeze",(t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart-1,e)}),this.hot.addHook("afterColumnUnfreeze",(t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)}),this.addHook("afterCellMetaReset",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,y8).call(e,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,vu).call(e,...i)}),this.addHook("beforeAutofill",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return yZ(y6,e,y5).call(e,...i)}),yK(y3,this).forEach(t=>{let[e,i]=t;return this.engine.on(e,i)}),super.enablePlugin()}}disablePlugin(){yK(y3,this).forEach(t=>{let[e,i]=t;return this.engine.off(e,i)}),yp(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(t){var e;let i=function(t){var e;let i=t[yQ],r=yc(null!=i&&null!==(e=i.engine)&&void 0!==e&&e.hyperformula?i.engine:{}),o=yh(t);return{...r,...o}}(this.hot.getSettings());e=this.engine.getConfig(),Object.keys(i).some(t=>void 0!==i[t]&&i[t]!==e[t])&&this.engine.updateConfig(i);let r=this.hot.getSettings()[yQ];if((0,tJ.isDefined)(r)&&(0,tJ.isDefined)(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!t.data&&null===this.sheetName){let t=this.hot.getSettings()[yQ].sheetName;t&&this.engine.doesSheetExist(t)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=t?t:void 0,this.hot.getSourceDataArray())}super.updatePlugin(t)}destroy(){yK(y3,this).forEach(t=>{var e;let[i,r]=t;return null===(e=this.engine)||void 0===e?void 0:e.off(i,r)}),yq(y3,this,null),yp(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(t,e){if((0,tJ.isDefined)(e)&&!sN(e))return(0,t6.warn)("The provided data should be an array of arrays."),!1;if(null!=t&&this.engine.doesSheetExist(t))return(0,t6.warn)("Sheet with the provided name already exists."),!1;try{let i=this.engine.addSheet(null!=t?t:void 0);return e&&this.engine.setSheetContent(this.engine.getSheetId(i),e),i}catch(t){return(0,t6.warn)(t.message),!1}}switchSheet(t){if(!this.engine.doesSheetExist(t)){(0,t6.error)(`The sheet named \`${t}\` does not exist, switch aborted.`);return}this.sheetName=t;let e=this.engine.getSheetSerialized(this.sheetId);e.length>0&&this.hot.loadData(e,`${(0,eX.toUpperCaseFirst)(yQ)}.switchSheet`)}getCellType(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(e);return null!==r&&null!==o?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)}):"EMPTY"}isFormulaCellType(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)})}renderDependentSheets(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=new Set;t.forEach(t=>{var e;let r=null==t||null===(e=t.address)||void 0===e?void 0:e.sheet;void 0===r||i.has(r)||i.add(r)}),yg(this.engine).forEach((t,r)=>{if((e||r!==this.sheetId)&&i.has(r)){var o;t.render(),null===(o=t.view)||void 0===o||o.adjustElementsSize()}})}validateDependentCells(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=t=>{var e;let{row:i,col:r,sheet:o}=null!==(e=null==t?void 0:t.address)&&void 0!==e?e:{};return(0,tJ.isDefined)(o)?`${o}:${i}x${r}`:""},r=new Set(e.map(t=>i(t)));t.forEach(t=>{var e,o;let{row:s,col:n}=null!==(e=t.address)&&void 0!==e?e:{};if(!1===(0,tJ.isDefined)(s)||!1===(0,tJ.isDefined)(n)||s>=this.hot.countRows()||n>=this.hot.countCols())return;let a=null==t||null===(o=t.address)||void 0===o?void 0:o.sheet,l=i(t);if(void 0!==a&&!r.has(l)){let t=yg(this.engine).get(a);if(!t)return;t.validateCell(t.getDataAtCell(s,n),t.getCellMeta(s,n),()=>{})}})}syncChangeWithEngine(t,e,i){let r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r)){(0,t6.warn)(`Not possible to set cell data at ${JSON.stringify(r)}`);return}let o=this.hot.getCellMeta(t,e);if(yy(i,o.type)){if(yv(i,o.dateFormat))i=yw(i,o.dateFormat);else{var s;!1===("string"==typeof(s=i)&&s.startsWith("="))&&(i=`'${i}`)}}return this.engine.setCellContents(r,i)}}),e8(class extends cx{constructor(){super(...arguments),vb(this,vM),vM.add(this),vw(this,vR,{}),vw(this,vT,null)}static get PLUGIN_KEY(){return vE}static get PLUGIN_PRIORITY(){return 310}isEnabled(){return!!this.hot.getSettings()[vE]}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[vE];(0,t3.isObject)(e)&&(vS(vR,this,e),(0,tJ.isUndefined)(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),vS(vT,this,new sG),vC(vT,this).addLocalHook("init",()=>vx(vM,this,vH).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,vC(vT,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return vx(vM,t,vI).call(t,...i)}),this.addHook("afterGetCellMeta",(t,e,i)=>vx(vM,this,vA).call(this,t,e,i)),this.addHook("modifyColWidth",(t,e)=>vx(vM,this,vk).call(this,t,e)),this.addHook("afterGetColHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return vx(vM,t,vP).call(t,...i)}),this.addHook("modifyCopyableRange",t=>vx(vM,this,vO).call(this,t)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),vS(vR,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(t){let e=this.getHiddenColumns(),i=this.isValidConfig(t),r=e,o=vC(vT,this).getValues().slice(),s=t.length>0;if(i&&s){let e=t.map(t=>this.hot.toPhysicalColumn(t));(0,eu.arrayEach)(e,t=>{o[t]=!1}),r=(0,eu.arrayReduce)(o,(t,e,i)=>(e&&t.push(this.hot.toVisualColumn(i)),t),[])}!1!==this.hot.runHooks("beforeUnhideColumns",e,r,i&&s)&&(i&&s&&vC(vT,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",e,r,i&&s,i&&r.length<e.length))}showColumn(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.showColumns(e)}hideColumns(t){let e=this.getHiddenColumns(),i=this.isValidConfig(t),r=e;i&&(r=Array.from(new Set(e.concat(t)))),!1!==this.hot.runHooks("beforeHideColumns",e,r,i)&&(i&&this.hot.batchExecution(()=>{(0,eu.arrayEach)(t,t=>{vC(vT,this).setValueAtIndex(this.hot.toPhysicalColumn(t),!0)})},!0),this.hot.runHooks("afterHideColumns",e,r,i,i&&r.length>e.length))}hideColumn(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.hideColumns(e)}getHiddenColumns(){return(0,eu.arrayMap)(vC(vT,this).getHiddenIndexes(),t=>this.hot.toVisualColumn(t))}isHidden(t){return vC(vT,this).getValueAtIndex(this.hot.toPhysicalColumn(t))||!1}isValidConfig(t){let e=this.hot.countCols();return!!Array.isArray(t)&&t.length>0&&t.every(t=>Number.isInteger(t)&&t>=0&&t<e)}resetCellsMeta(){(0,eu.arrayEach)(this.hot.getCellsMeta(),t=>{t&&(t.skipColumnOnPaste=!1)})}destroy(){vS(vR,this,null),vS(vT,this,null),super.destroy()}}),e8(class extends cx{constructor(){super(...arguments),vD(this,vV),vV.add(this),vL(this,vB,{}),vL(this,vW,null)}static get PLUGIN_KEY(){return vj}static get PLUGIN_PRIORITY(){return 320}isEnabled(){return!!this.hot.getSettings()[vj]}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[vj];(0,t3.isObject)(e)&&(v_(vB,this,e),(0,tJ.isUndefined)(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),v_(vW,this,new sG),vN(vW,this).addLocalHook("init",()=>vF(vV,this,vX).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,vN(vW,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return vF(vV,t,v$).call(t,...i)}),this.addHook("afterGetCellMeta",(t,e,i)=>vF(vV,this,vz).call(this,t,e,i)),this.addHook("modifyRowHeight",(t,e)=>vF(vV,this,vU).call(this,t,e)),this.addHook("afterGetRowHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return vF(vV,t,vG).call(t,...i)}),this.addHook("modifyCopyableRange",t=>vF(vV,this,vY).call(this,t)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),v_(vB,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(t){let e=this.getHiddenRows(),i=this.isValidConfig(t),r=e,o=vN(vW,this).getValues().slice(),s=t.length>0;if(i&&s){let e=t.map(t=>this.hot.toPhysicalRow(t));(0,eu.arrayEach)(e,t=>{o[t]=!1}),r=(0,eu.arrayReduce)(o,(t,e,i)=>(e&&t.push(this.hot.toVisualRow(i)),t),[])}!1!==this.hot.runHooks("beforeUnhideRows",e,r,i&&s)&&(i&&s&&vN(vW,this).setValues(o),this.hot.runHooks("afterUnhideRows",e,r,i&&s,i&&r.length<e.length))}showRow(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.showRows(e)}hideRows(t){let e=this.getHiddenRows(),i=this.isValidConfig(t),r=e;i&&(r=Array.from(new Set(e.concat(t)))),!1!==this.hot.runHooks("beforeHideRows",e,r,i)&&(i&&this.hot.batchExecution(()=>{(0,eu.arrayEach)(t,t=>{vN(vW,this).setValueAtIndex(this.hot.toPhysicalRow(t),!0)})},!0),this.hot.runHooks("afterHideRows",e,r,i,i&&r.length>e.length))}hideRow(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.hideRows(e)}getHiddenRows(){return(0,eu.arrayMap)(vN(vW,this).getHiddenIndexes(),t=>this.hot.toVisualRow(t))}isHidden(t){return vN(vW,this).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}isValidConfig(t){let e=this.hot.countRows();return!!Array.isArray(t)&&t.length>0&&t.every(t=>Number.isInteger(t)&&t>=0&&t<e)}resetCellsMeta(){(0,eu.arrayEach)(this.hot.getCellsMeta(),t=>{t&&(t.skipRowOnPaste=!1)})}destroy(){v_(vB,this,null),v_(vW,this,null),super.destroy()}}),e8(class extends cx{constructor(){super(...arguments),vq(this,v1),v1.add(this),vq(this,v0),v0.set(this,!1)}static get PLUGIN_KEY(){return vJ}static get PLUGIN_PRIORITY(){return 110}isEnabled(){return!!this.hot.getSettings()[vJ]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",t=>vQ(v1,this,v2).call(this,t)),this.addHook("beforeColumnMove",(t,e)=>vQ(v1,this,v3).call(this,t,e)),super.enablePlugin())}disablePlugin(){vZ(v0,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(t){let e=this.hot.getSettings(),i=e.fixedColumnsStart<this.hot.countCols()&&t>e.fixedColumnsStart-1;vK(v0,this)||vZ(v0,this,!0),!1!==this.hot.runHooks("beforeColumnFreeze",t,i)&&(i&&(this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart),e._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",t,i))}unfreezeColumn(t){let e=this.hot.getSettings(),i=e.fixedColumnsStart>0&&t<=e.fixedColumnsStart-1;vK(v0,this)||vZ(v0,this,!0),!1!==this.hot.runHooks("beforeColumnUnfreeze",t,i)&&(i&&(e._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",t,i))}}),e8(class extends cx{constructor(){super(...arguments),v7(this,ww),ww.add(this),v8(this,wl,new v5(this.hot)),v8(this,wh,new v9(this.hot)),v8(this,wc,[]),v8(this,wd,0),v8(this,wu,!1),v8(this,wg,{}),v8(this,wp,void 0),v8(this,wf,void 0),v8(this,wm,void 0),v8(this,wy,void 0),v8(this,wv,void 0)}static get PLUGIN_KEY(){return wr}static get PLUGIN_PRIORITY(){return 120}isEnabled(){return!!this.hot.getSettings()[wr]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wi(ww,t,wb).call(t,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wi(ww,t,wS).call(t,...i)}),this.addHook("afterScrollVertically",()=>wi(ww,this,wE).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wi(ww,t,wR).call(t,...i)}),this.buildPluginUI(),this.registerEvents(),(0,tZ.addClass)(this.hot.rootElement,wo),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,tZ.removeClass)(this.hot.rootElement,wo),this.unregisterEvents(),we(wl,this).destroy(),we(wh,this).destroy(),super.disablePlugin()}moveColumn(t,e){return this.moveColumns([t],e)}moveColumns(t,e){let i=we(wp,this),r=this.isMovePossible(t,e),o=this.hot.runHooks("beforeColumnMove",t,e,i,r);if(wt(wp,this,void 0),!1===o)return;r&&this.hot.columnIndexMapper.moveIndexes(t,e);let s=r&&this.isColumnOrderChanged(t,e);return this.hot.runHooks("afterColumnMove",t,e,i,r,s),s}dragColumn(t,e){return this.dragColumns([t],e)}dragColumns(t,e){let i=this.countFinalIndex(t,e);return wt(wp,this,e),this.moveColumns(t,i)}isMovePossible(t,e){let i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=t.length+e>i,o=t.some(t=>t<0),s=t.some(t=>t>=i);return!r&&!(e<0)&&!o&&!s}isColumnOrderChanged(t,e){return t.some((t,i)=>t-i!==e)}countFinalIndex(t,e){let i=(0,eu.arrayReduce)(t,(t,i)=>(i<e&&(t+=1),t),0);return e-i}getColumnsWidth(t,e){let i=this.hot.columnIndexMapper,r=0;for(let o=t;o<=e;o+=1){let t=i.getRenderableFromVisualIndex(o);o<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==t&&(r+=this.hot.view._wt.wtTable.getStretchedColumnWidth(t)||0)}return r}moveBySettingsOrLoad(){let t=this.hot.getSettings()[wr];if(Array.isArray(t))this.moveColumns(t,0);else if(void 0!==t){let t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(t){return t<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){let t={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value?t.value:[]}prepareColumnsToMoving(t,e){let i=[];return(0,eq.rangeEach)(t,e,t=>{i.push(t)}),i}refreshPositions(){let t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(we(wf,this))&&t>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1)});let e=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,r="number"==typeof i.scrollX?i.scrollX:i.scrollLeft,o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,we(wf,this)-1),s=e.hider.offsetWidth,n=e.TBODY.offsetLeft,a=we(wl,this).getOffset().start,l=we(wl,this).getSize().width,h=0,c=0;if(this.hot.isRtl()){let t=this.hot.rootWindow,e=(0,tZ.outerWidth)(this.hot.rootElement),o=t.innerWidth-we(wm,this)-e;c=t.innerWidth-we(wg,this).eventPageX-o-(void 0===i.scrollX?r:0)}else c=we(wg,this).eventPageX-(we(wm,this)-(void 0===i.scrollX?r:0));if(we(wy,this)&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(we(wf,this))&&(o+=r),o+=h,0>we(wf,this))we(wv,this)>0?we(wg,this).col=0:we(wg,this).col=t>0?t-1:t;else if(we(wg,this).TD.offsetWidth/2+o<=c){let t=we(wf,this)>=we(wd,this)?we(wd,this)-1:we(wf,this);we(wg,this).col=t+1,o+=we(wg,this).TD.offsetWidth}else we(wg,this).col=we(wf,this);let d=c,u=o;c+l+a>=s?d=s-l-a:c+a<n+h&&(d=n+h+Math.abs(a)),o>=s-1?u=s-1:0===u?u=1:void 0!==i.scrollX&&we(wf,this)<we(wv,this)&&(u-=we(wm,this)<=i.scrollX?we(wm,this):0),we(wl,this).setPosition(null,d),we(wh,this).setPosition(null,u)}registerEvents(){let{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",t=>wi(ww,this,wC).call(this,t)),this.eventManager.addEventListener(t,"mouseup",()=>wi(ww,this,wx).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){we(wl,this).build(),we(wh,this).build()}destroy(){we(wl,this).destroy(),we(wh,this).destroy(),super.destroy()}}),e8(class extends cx{static get PLUGIN_KEY(){return wP}static get PLUGIN_PRIORITY(){return 130}constructor(t){super(t),wM(this,wq),wq.add(this),wT(this,wH,null),wT(this,wL,null),wT(this,wD,[]),wT(this,wN,null),wT(this,w_,null),wT(this,wF,null),wT(this,wj,null),wT(this,wB,null),wT(this,wW,this.hot.rootDocument.createElement("DIV")),wT(this,wV,this.hot.rootDocument.createElement("DIV")),wT(this,wU,null),wT(this,wz,!1),wT(this,wY,0),wT(this,wG,null),wT(this,w$,void 0),wT(this,wX,void 0),(0,tZ.addClass)(wA(wW,this),"manualColumnResizer"),(0,tZ.addClass)(wA(wV,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[wP]}enablePlugin(){this.enabled||(wk(w$,this,new sY),wA(w$,this).addLocalHook("init",()=>wO(wq,this,wK).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,wA(w$,this)),this.addHook("modifyColWidth",(t,e)=>wO(wq,this,w2).call(this,t,e)),this.addHook("beforeStretchingColumnWidth",(t,e)=>wO(wq,this,w3).call(this,t,e)),this.addHook("beforeColumnResize",(t,e,i)=>wO(wq,this,w6).call(this,t,e,i)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){wk(wX,this,wA(w$,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",wI,wA(w$,this).getValues())}loadManualColumnWidths(){let t={};return this.hot.runHooks("persistentStateLoad",wI,t),t.value}setManualSize(t,e){let i=Math.max(e,20),r=this.hot.toPhysicalColumn(t);return wA(w$,this).setValueAtIndex(r,i),i}clearManualSize(t){let e=this.hot.toPhysicalColumn(t);wA(w$,this).setValueAtIndex(e,null)}setupHandlePosition(t){let e;if(!t.parentNode)return;wk(wH,this,t);let{_wt:i}=this.hot.view,r=i.wtTable.getCoords(wA(wH,this)),o=r.col;if(o<0)return;let s=(0,tZ.outerHeight)(wA(wH,this)),n=wA(wH,this).getBoundingClientRect();o<i.getSetting("fixedColumnsStart")&&(e=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(wA(wH,this),r.row,r.col)),e||(e=i.wtOverlays.topOverlay.getRelativeCellPosition(wA(wH,this),r.row,r.col)),wk(wL,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)),wk(wD,this,[]);let a=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&a){let t=this.hot.getSelectedRange();(0,eu.arrayEach)(t,t=>{let e=t.getTopStartCorner().col,i=t.getBottomEndCorner().col;(0,eq.rangeEach)(e,i,t=>{wA(wD,this).includes(t)||wA(wD,this).push(t)})})}wA(wD,this).includes(wA(wL,this))||wk(wD,this,[wA(wL,this)]),wk(wB,this,e.start-6),wk(wj,this,parseInt(n.width,10)),wA(wW,this).style.top=`${e.top}px`,wA(wW,this).style[this.inlineDir]=`${wA(wB,this)+wA(wj,this)}px`,wA(wW,this).style.height=`${s}px`,this.hot.rootElement.appendChild(wA(wW,this))}refreshHandlePosition(){wA(wW,this).style[this.inlineDir]=`${wA(wB,this)+wA(wN,this)}px`}setupGuidePosition(){let t=parseInt((0,tZ.outerHeight)(wA(wW,this)),10),e=parseInt(wA(wW,this).style.top,10)+t,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);(0,tZ.addClass)(wA(wW,this),"active"),(0,tZ.addClass)(wA(wV,this),"active"),wA(wV,this).style.top=`${e}px`,this.refreshGuidePosition(),wA(wV,this).style.height=`${i-t}px`,this.hot.rootElement.appendChild(wA(wV,this))}refreshGuidePosition(){wA(wV,this).style[this.inlineDir]=wA(wW,this).style[this.inlineDir]}hideHandleAndGuide(){(0,tZ.removeClass)(wA(wW,this),"active"),(0,tZ.removeClass)(wA(wV,this),"active")}checkIfColumnHeader(t){let e=(0,tZ.closest)(t,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}afterMouseDownTimeout(){let t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,i)=>{let r=this.hot.runHooks("beforeColumnResize",wA(w_,this),e,!0);void 0!==r&&wk(w_,this,r),"all"===this.hot.getSettings().stretchH?this.clearManualSize(e):this.setManualSize(e,wA(w_,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",wA(w_,this),e,!0),i&&t()};wA(wY,this)>=2&&(wA(wD,this).length>1?((0,eu.arrayEach)(wA(wD,this),t=>{e(t)}),t()):(0,eu.arrayEach)(wA(wD,this),t=>{e(t,!0)})),wk(wY,this,0),wk(wG,this,null)}bindEvents(){let{rootWindow:t,rootElement:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",t=>wO(wq,this,wZ).call(this,t)),this.eventManager.addEventListener(e,"mousedown",t=>wO(wq,this,wQ).call(this,t)),this.eventManager.addEventListener(t,"mousemove",t=>wO(wq,this,wJ).call(this,t)),this.eventManager.addEventListener(t,"mouseup",()=>wO(wq,this,w0).call(this)),this.eventManager.addEventListener(wA(wW,this),"contextmenu",()=>wO(wq,this,w1).call(this))}destroy(){super.destroy()}}),e8(class extends cx{constructor(){super(...arguments),bt(this,bf),bf.add(this),w7(this,bh,new w9(this.hot)),w7(this,bc,new w8(this.hot)),w7(this,bd,[]),w7(this,bu,void 0),w7(this,bg,{}),w7(this,bp,void 0)}static get PLUGIN_KEY(){return bo}static get PLUGIN_PRIORITY(){return 140}isEnabled(){return!!this.hot.getSettings()[bo]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return br(bf,t,bm).call(t,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return br(bf,t,bv).call(t,...i)}),this.addHook("afterScrollHorizontally",()=>br(bf,this,bb).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return br(bf,t,bC).call(t,...i)}),this.buildPluginUI(),this.registerEvents(),(0,tZ.addClass)(this.hot.rootElement,bs),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,tZ.removeClass)(this.hot.rootElement,bs),this.unregisterEvents(),bi(bh,this).destroy(),bi(bc,this).destroy(),super.disablePlugin()}moveRow(t,e){return this.moveRows([t],e)}moveRows(t,e){let i=bi(bp,this),r=this.isMovePossible(t,e),o=this.hot.runHooks("beforeRowMove",t,e,i,r);if(be(bp,this,void 0),!1===o)return;r&&this.hot.rowIndexMapper.moveIndexes(t,e);let s=r&&this.isRowOrderChanged(t,e);return this.hot.runHooks("afterRowMove",t,e,i,r,s),s}dragRow(t,e){return this.dragRows([t],e)}dragRows(t,e){let i=this.countFinalIndex(t,e);return be(bp,this,e),this.moveRows(t,i)}isMovePossible(t,e){let i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=t.length+e>i,o=t.some(t=>t<0),s=t.some(t=>t>=i);return!r&&!(e<0)&&!o&&!s}isRowOrderChanged(t,e){return t.some((t,i)=>t-i!==e)}countFinalIndex(t,e){let i=(0,eu.arrayReduce)(t,(t,i)=>(i<e&&(t+=1),t),0);return e-i}getRowsHeight(t,e){let i=this.hot.rowIndexMapper,r=0;for(let o=t;o<=e;o++){let t=i.getRenderableFromVisualIndex(o);null!==t&&(r+=this.hot.view._wt.wtTable.getRowHeight(t)||23)}return r}moveBySettingsOrLoad(){let t=this.hot.getSettings()[bo];if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){let t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(t){return t<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(t){return t>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){let t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}prepareRowsToMoving(){let t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;let{from:i,to:r}=t,o=Math.min(i.row,r.row),s=Math.max(i.row,r.row);return(0,eq.rangeEach)(o,s,t=>{e.push(t)}),e}refreshPositions(){let t=bi(bg,this).coords,e=this.hot.view.getFirstFullyVisibleRow(),i=this.hot.view.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(t.row)&&e>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(e-1,-1)),this.isFixedRowBottom(t.row)&&i<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);let o=this.hot.view._wt.wtTable,s=bi(bg,this).TD,n=this.hot.rootElement,a=(0,tZ.offset)(n),l=(0,tZ.getTrimmingContainer)(n),h=o.holder.scrollTop,c=this.hot.rootWindow!==l?l.scrollTop:0,d=a.top-c,u=bi(bg,this).eventPageY-d+h,g=o.hider.offsetHeight,p=o.TBODY.offsetTop,f=bi(bh,this).getOffset().top,m=bi(bh,this).getSize().height,y=s.offsetHeight/2,w=s.offsetHeight,b=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1),C=u>=b+y;this.isFixedRowTop(t.row)&&(b+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),t.row<0?bi(bg,this).row=e>0?e-1:e:C?(bi(bg,this).row=t.row+1,b+=0===t.row?w-1:w):bi(bg,this).row=t.row;let S=u,x=b;u+m+f>=g?S=g-m-f:u+f<p&&(S=p+Math.abs(f)),b>=g-1&&(x=g-1),bi(bh,this).setPosition(S),bi(bc,this).setPosition(x)}registerEvents(){let{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",t=>br(bf,this,by).call(this,t)),this.eventManager.addEventListener(t,"mouseup",()=>br(bf,this,bw).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){bi(bh,this).build(),bi(bc,this).build()}destroy(){bi(bh,this).destroy(),bi(bc,this).destroy(),super.destroy()}}),e8(class extends cx{static get PLUGIN_KEY(){return bM}static get PLUGIN_PRIORITY(){return 30}constructor(t){super(t),bx(this,bY),bY.add(this),bS(this,bA,null),bS(this,bO,null),bS(this,bP,[]),bS(this,bI,null),bS(this,bH,null),bS(this,bL,null),bS(this,bD,null),bS(this,bN,null),bS(this,b_,this.hot.rootDocument.createElement("DIV")),bS(this,bF,this.hot.rootDocument.createElement("DIV")),bS(this,bj,!1),bS(this,bB,!1),bS(this,bW,0),bS(this,bV,null),bS(this,bU,void 0),bS(this,bz,void 0),(0,tZ.addClass)(bR(b_,this),"manualRowResizer"),(0,tZ.addClass)(bR(bF,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[bM]}enablePlugin(){this.enabled||(bE(bU,this,new sY),bR(bU,this).addLocalHook("init",()=>bT(bY,this,bQ).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,bR(bU,this)),this.addHook("modifyRowHeight",(t,e)=>bT(bY,this,bZ).call(this,t,e)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){bE(bz,this,bR(bU,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",bk,bR(bU,this).getValues())}loadManualRowHeights(){let t={};return this.hot.runHooks("persistentStateLoad",bk,t),t.value}setManualSize(t,e){let i=this.hot.toPhysicalRow(t),r=Math.max(e,oF.DEFAULT_HEIGHT);return bR(bU,this).setValueAtIndex(i,r),r}setupHandlePosition(t){let e;bE(bA,this,t);let{view:i}=this.hot,{_wt:r}=i,o=r.wtTable.getCoords(bR(bA,this)),s=o.row;if(s<0)return;let n=(0,tZ.outerWidth)(bR(bA,this)),a=bR(bA,this).getBoundingClientRect(),l=s<r.getSetting("fixedRowsTop"),h=s>=i.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");l?e=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(bR(bA,this),o.row,o.col):h&&(e=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(bR(bA,this),o.row,o.col)),e||(e=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(bR(bA,this),o.row,o.col)),bE(bO,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),bE(bP,this,[]);let c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&c){let t=this.hot.getSelectedRange();(0,eu.arrayEach)(t,t=>{let e=t.getTopStartCorner().row,i=t.getBottomStartCorner().row;(0,eq.rangeEach)(e,i,t=>{bR(bP,this).includes(t)||bR(bP,this).push(t)})})}bR(bP,this).includes(bR(bO,this))||bE(bP,this,[bR(bO,this)]),bE(bN,this,e.top-6),bE(bD,this,parseInt(a.height,10)),bR(b_,this).style.top=`${bR(bN,this)+bR(bD,this)}px`,bR(b_,this).style[this.inlineDir]=`${e.start}px`,bR(b_,this).style.width=`${n}px`,this.hot.rootElement.appendChild(bR(b_,this))}refreshHandlePosition(){bR(b_,this).style.top=`${bR(bN,this)+bR(bI,this)}px`}setupGuidePosition(){let t=parseInt((0,tZ.outerWidth)(bR(b_,this)),10),e=parseInt(bR(b_,this).style[this.inlineDir],10)+t,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);(0,tZ.addClass)(bR(b_,this),"active"),(0,tZ.addClass)(bR(bF,this),"active"),bR(bF,this).style.top=bR(b_,this).style.top,bR(bF,this).style[this.inlineDir]=`${e}px`,bR(bF,this).style.width=`${i-t}px`,this.hot.rootElement.appendChild(bR(bF,this))}refreshGuidePosition(){bR(bF,this).style.top=bR(b_,this).style.top}hideHandleAndGuide(){(0,tZ.removeClass)(bR(b_,this),"active"),(0,tZ.removeClass)(bR(bF,this),"active")}checkIfRowHeader(t){let e=(0,tZ.closest)(t,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,r.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}getActualRowHeight(t){let e=this.hot.view._wt.wtTable.getRowHeight(t);return void 0!==e&&bR(bH,this)<e?e:bR(bH,this)}afterMouseDownTimeout(){let t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,i)=>{let r=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!0);void 0!==r&&bE(bH,this,r),this.setManualSize(e,bR(bH,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!0),i&&t()};bR(bW,this)>=2&&(bR(bP,this).length>1?((0,eu.arrayEach)(bR(bP,this),t=>{e(t)}),t()):(0,eu.arrayEach)(bR(bP,this),t=>{e(t,!0)})),bE(bW,this,0),bE(bV,this,null)}bindEvents(){let{rootElement:t,rootWindow:e}=this.hot;this.eventManager.addEventListener(t,"mouseover",t=>bT(bY,this,bG).call(this,t)),this.eventManager.addEventListener(t,"mousedown",t=>bT(bY,this,b$).call(this,t)),this.eventManager.addEventListener(e,"mousemove",t=>bT(bY,this,bX).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>bT(bY,this,bq).call(this)),this.eventManager.addEventListener(bR(b_,this),"contextmenu",()=>bT(bY,this,bK).call(this))}destroy(){super.destroy()}}),e8(class extends cx{constructor(){super(...arguments),Cb(this,CA),CA.add(this),CC(this,"mergedCellsCollection",null),CC(this,"autofillCalculations",null),CC(this,"selectionCalculations",null),Cw(this,CT,null),Cw(this,CM,{row:0,col:0}),Cw(this,Ck,new Cy({mergedCellsGetter:(t,e)=>this.mergedCellsCollection.get(t,e),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper}))}static get PLUGIN_KEY(){return CR}static get PLUGIN_PRIORITY(){return 150}isEnabled(){return!!this.hot.getSettings()[CR]}enablePlugin(){var t=this;this.enabled||(this.mergedCellsCollection=new b4(this),this.autofillCalculations=new b8(this),this.selectionCalculations=new Ct(this),this.addHook("afterInit",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CO).call(t,...i)}),this.addHook("modifyTransformFocus",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CI).call(t,...i)}),this.addHook("modifyTransformStart",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CH).call(t,...i)}),this.addHook("modifyTransformEnd",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CL).call(t,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CD).call(t,...i)}),this.addHook("beforeSetRangeStart",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,Cj).call(t,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,Cj).call(t,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CB).call(t,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CW).call(t,...i)}),this.addHook("afterSelectionEnd",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CV).call(t,...i)}),this.addHook("modifyGetCellCoords",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CN).call(t,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CP).call(t,...i)}),this.addHook("afterRenderer",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CF).call(t,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,C_).call(t,...i)}),this.addHook("afterGetCellMeta",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CU).call(t,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,Cz).call(t,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CY).call(t,...i)}),this.addHook("modifyAutofillRange",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CG).call(t,...i)}),this.addHook("afterCreateCol",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,C$).call(t,...i)}),this.addHook("afterRemoveCol",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CX).call(t,...i)}),this.addHook("afterCreateRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,Cq).call(t,...i)}),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CK).call(t,...i)}),this.addHook("afterChange",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CZ).call(t,...i)}),this.addHook("beforeDrawBorders",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CQ).call(t,...i)}),this.addHook("afterDrawSelection",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,CJ).call(t,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,C0).call(t,...i)}),this.addHook("beforeBeginEditing",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return CE(CA,t,C1).call(t,...i)}),this.addHook("beforeUndoStackChange",(t,e)=>{if("MergeCells"===e)return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){let t=this.hot.getSettings()[CR];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),super.updatePlugin()}ifChromeForceRepaint(){if(!(0,t0.isChrome)())return;let t=[],e=[];this.mergedCellsCollection.mergedCells.forEach(t=>{let{row:i,rowspan:r}=t;for(let t=i+1;t<i+r;t++)e.push(t)}),(e=[...new Set(e)]).forEach(e=>{let i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(e);this.hot.view._wt.wtOverlays.getOverlays(!0).map(t=>(null==t?void 0:t.name)==="master"?t:t.clone.wtTable).forEach(e=>{let r=e.getRow(i);r&&(r.style.background=(0,tZ.getStyle)(r,"backgroundColor").replace(")",", 0.99)"),t.push(r))})}),this.hot._registerTimeout(()=>{t.forEach(t=>{t.style.background=(0,tZ.getStyle)(t,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(t){let e=!0;return!!t&&(b0.containsNegativeValues(t)?((0,t6.warn)(b0.NEGATIVE_VALUES_WARNING(t)),e=!1):b0.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?((0,t6.warn)(b0.IS_OUT_OF_BOUNDS_WARNING(t)),e=!1):b0.isSingleCell(t)?((0,t6.warn)(b0.IS_SINGLE_CELL(t)),e=!1):b0.containsZeroSpan(t)&&((0,t6.warn)(b0.ZERO_SPAN_WARNING(t)),e=!1),e)}generateFromSettings(t){if(Array.isArray(t)){let e=[];(0,eu.arrayEach)(t,t=>{if(!this.validateSetting(t))return;let i=this.hot._createCellCoords(t.row,t.col),r=this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),o=this.hot._createCellRange(i,i,r);this.mergeRange(o,!0,!0),(0,eq.rangeEach)(t.row,t.row+t.rowspan-1,i=>{(0,eq.rangeEach)(t.col,t.col+t.colspan-1,r=>{!1==(i===t.row&&r===t.col)&&e.push([i,r,null])})})}),0!==e.length&&this.hot.setDataAtCell(e,void 0,void 0,this.pluginName)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!e||this.validateSetting(t)}mergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");let{from:e,to:i}=t;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,i.row,i.col,!1)}unmergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;let{from:e,to:i}=t;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,i.row,i.col,!1)}mergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.getTopStartCorner(),o=t.getBottomEndCorner(),s={row:r.row,col:r.col,rowspan:o.row-r.row+1,colspan:o.col-r.col+1},n=[],a=null;return!!this.canMergeRange(s,e)&&(this.hot.runHooks("beforeMergeCells",t,e),(0,eq.rangeEach)(0,s.rowspan-1,t=>{(0,eq.rangeEach)(0,s.colspan-1,e=>{let i=null;n[t]||(n[t]=[]),0===t&&0===e?i=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+t,s.col+e,"hidden",!0),n[t][e]=i})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),!this.mergedCellsCollection.add(s)||(i?a=[s.row,s.col,n]:this.hot.populateFromArray(s.row,s.col,n,void 0,void 0,this.pluginName),e||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",t,s,e),a))}unmergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.mergedCellsCollection.getWithinRange(t);i&&(this.hot.runHooks("beforeUnmergeCells",t,e),(0,eu.arrayEach)(i,t=>{this.mergedCellsCollection.remove(t.row,t.col),(0,eq.rangeEach)(0,t.rowspan-1,e=>{(0,eq.rangeEach)(0,t.colspan-1,i=>{this.hot.removeCellMeta(t.row+e,t.col+i,"hidden"),this.hot.removeCellMeta(t.row+e,t.col+i,"copyable")})}),this.hot.removeCellMeta(t.row,t.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",t,e),this.hot.render())}toggleMerge(t){let e=this.mergedCellsCollection.get(t.from.row,t.from.col);e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col?this.unmergeRange(t):this.mergeSelection(t)}merge(t,e,i,r){let o=this.hot._createCellCoords(t,e),s=this.hot._createCellCoords(i,r);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(t,e,i,r){let o=this.hot._createCellCoords(t,e),s=this.hot._createCellCoords(i,r);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{let t=this.hot.getSelectedRangeLast();t&&!t.isSingleHeader()&&(this.toggleMerge(t),this.hot.render())},runOnlyIf:t=>!t.altKey,group:CR})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(CR)}modifyViewportRowStart(t,e){let i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(t.startRow);for(let o=0;o<e;o+=1){let s=this.mergedCellsCollection.get(r,o);if((0,t3.isObject)(s)){let r=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s.row,1));if(r<t.startRow){t.startRow=r,this.modifyViewportRowStart(t,e);return}}}}modifyViewportRowEnd(t,e){let i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(t.endRow);for(let o=0;o<e;o+=1){let s=this.mergedCellsCollection.get(r,o);if((0,t3.isObject)(s)){let r=s.row+s.rowspan-1,o=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1));if(o>t.endRow){t.endRow=o,this.modifyViewportRowEnd(t,e);return}}}}modifyViewportColumnStart(t,e){let i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(t.startColumn);for(let o=0;o<e;o+=1){let s=this.mergedCellsCollection.get(o,r);if((0,t3.isObject)(s)){let r=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s.col,1));if(r<t.startColumn){t.startColumn=r,this.modifyViewportColumnStart(t,e);return}}}}modifyViewportColumnEnd(t,e){let i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(t.endColumn);for(let o=0;o<e;o+=1){let s=this.mergedCellsCollection.get(o,r);if((0,t3.isObject)(s)){let r=s.col+s.colspan-1,o=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1));if(o>t.endColumn){t.endColumn=o,this.modifyViewportColumnEnd(t,e);return}}}}translateMergedCellToRenderable(t,e,i,r){let o,s;let{rowIndexMapper:n,columnIndexMapper:a}=this.hot;return o=0===e?n.getNearestNotHiddenIndex(t,1):n.getNearestNotHiddenIndex(t+e-1,-1),s=0===r?a.getNearestNotHiddenIndex(i,1):a.getNearestNotHiddenIndex(i+r-1,-1),[t>=0?n.getRenderableFromVisualIndex(o):t,i>=0?a.getRenderableFromVisualIndex(s):i]}}),e8(class extends dQ{constructor(){var t,e;super(...arguments),(t="symbol"==typeof(e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="pluginKey","string"))?e:e+"")in this?Object.defineProperty(this,t,{value:C6,enumerable:!0,configurable:!0,writable:!0}):this[t]=C6}static get PLUGIN_KEY(){return C6}static get PLUGIN_PRIORITY(){return 170}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[C4]&&C2(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{let{highlight:t}=this.hot.getSelectedRangeLast();return -1===t.row&&t.col>=0&&this.sort(this.getNextSortConfig(t.col,dK)),!1},runOnlyIf:()=>{var t,e;let i=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return i&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:hs,position:"before",group:C6})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(C6)}sort(t){super.sort(t)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(t){return super.getSortConfig(t)}setSortConfig(t){super.setSortConfig(t)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}updateHeaderClasses(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];super.updateHeaderClasses(t,...i),(0,tZ.removeClass)(t,function(t){let e=t.className.split(" "),i=RegExp(`^${C3}-[0-9]{1,2}$`);return e.filter(t=>i.test(t))}(t)),!1!==this.enabled&&(0,tZ.addClass)(t,function(t,e,i){let r=[];return!1===i||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${C3}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}(...i))}onUpdateSettings(t){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[C4]&&C2(),super.onUpdateSettings(t)}onAfterOnCellMouseDown(t,e){!1!==dL(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,dK))):this.sort(this.getColumnNextConfig(e.col)))}}),e8(class extends cx{constructor(){super(...arguments),C5(this,"dragged",[]),C5(this,"lastSetCell",null)}static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}isEnabled(){return(0,t0.isMobileBrowser)()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){let t=this,{rootElement:e}=this.hot;function i(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;let i=t.dragged.indexOf(e);if(-1===i)return!1;0===i?t.dragged=t.dragged.slice(0,1):1===i&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(e,"touchstart",e=>{let i;return(0,tZ.hasClass)(e.target,"topSelectionHandle-HitArea")?(i=t.hot.getSelectedRangeLast(),t.dragged.push("top"),t.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},e.preventDefault(),!1):(0,tZ.hasClass)(e.target,"bottomSelectionHandle-HitArea")?(i=t.hot.getSelectedRangeLast(),t.dragged.push("bottom"),t.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},e.preventDefault(),!1):void 0}),this.eventManager.addEventListener(e,"touchend",e=>(0,tZ.hasClass)(e.target,"topSelectionHandle-HitArea")?(i.call(t,"top"),t.touchStartRange=void 0,e.preventDefault(),!1):(0,tZ.hasClass)(e.target,"bottomSelectionHandle-HitArea")?(i.call(t,"bottom"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0),this.eventManager.addEventListener(e,"touchmove",e=>{let i,r,o,s,n,a;let{rootDocument:l}=this.hot;if(0===t.dragged.length)return;let h=l.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY);h&&h!==t.lastSetCell&&(("TD"===h.nodeName||"TH"===h.nodeName)&&(-1===(i=t.hot.getCoords(h)).col&&(i.col=0),o=(r=t.hot.getSelectedRangeLast()).getWidth(),s=r.getHeight(),n=r.getDirection(),1===o&&1===s&&t.hot.selection.setRangeEnd(i),null!==(a=t.getCurrentRangeCoords(r,i,t.touchStartRange.direction,n,t.dragged[0])).start&&t.hot.selection.setRangeStart(a.start),t.hot.selection.setRangeEnd(a.end),t.lastSetCell=h),e.preventDefault())})}getCurrentRangeCoords(t,e,i,r,o){let s=t.getTopStartCorner(),n=t.getBottomEndCorner(),a=t.getBottomStartCorner(),l=t.getTopEndCorner(),h={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":h="top"===o?{start:this.hot._createCellCoords(e.row,t.highlight.col),end:this.hot._createCellCoords(a.row,e.col)}:{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,s.col)};break;case"SE-NW":"bottom"===o&&(h={start:this.hot._createCellCoords(n.row,e.col),end:this.hot._createCellCoords(e.row,s.col)})}break;case"NW-SE":switch(r){case"NE-SW":"top"===o?h={start:e,end:a}:h.end=e;break;case"NW-SE":"top"===o?h={start:e,end:n}:h.end=e;break;case"SE-NW":"top"===o?h={start:e,end:s}:h.end=e;break;case"SW-NE":"top"===o?h={start:e,end:l}:h.end=e}break;case"SW-NE":switch(r){case"NW-SE":h="bottom"===o?{start:this.hot._createCellCoords(e.row,s.col),end:this.hot._createCellCoords(a.row,e.col)}:{start:this.hot._createCellCoords(s.row,e.col),end:this.hot._createCellCoords(e.row,n.col)};break;case"SW-NE":h="top"===o?{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,n.col)}:{start:this.hot._createCellCoords(e.row,s.col),end:this.hot._createCellCoords(s.row,e.col)};break;case"SE-NW":"bottom"===o?h={start:this.hot._createCellCoords(e.row,l.col),end:this.hot._createCellCoords(s.row,e.col)}:"top"===o&&(h={start:a,end:e})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"top"===o&&(h.end=e);break;case"SE-NW":"top"===o?h.end=e:h={start:e,end:s}}}return h}isDragged(){return this.dragged.length>0}}),e8(class extends cx{constructor(){super(...arguments),SF(this,S$),S$.add(this),S_(this,SU,new SH),S_(this,Sz,null),S_(this,SY,null),S_(this,SG,!1),SN(this,"ghostTable",new SD(this.hot,(t,e)=>this.getHeaderSettings(t,e))),SN(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return SV}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[SV]}enablePlugin(){var t=this;if(this.enabled)return;let{nestedHeaders:e}=this.hot.getSettings();Array.isArray(e)&&Array.isArray(e[0])||(0,t6.warn)((0,iJ.toSingleLine)`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>SW(S$,this,xt).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return SW(S$,t,xe).call(t,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return SW(S$,t,SQ).call(t,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return SW(S$,t,SJ).call(t,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return SW(S$,t,S0).call(t,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return SW(S$,t,S1).call(t,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return SW(S$,t,S2).call(t,...i)}),this.addHook("modifyTransformStart",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return SW(S$,t,S3).call(t,...i)}),this.addHook("afterSelection",()=>SW(S$,this,SX).call(this)),this.addHook("afterSelectionFocusSet",()=>SW(S$,this,SX).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return SW(S$,t,Sq).call(t,...i)}),this.addHook("afterGetColumnHeaderRenderers",t=>SW(S$,this,S4).call(this,t)),this.addHook("modifyColWidth",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return SW(S$,t,S9).call(t,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return SW(S$,t,S8).call(t,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return SW(S$,t,SK).call(t,...i)}),this.addHook("beforeCopy",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return SW(S$,t,SZ).call(t,...i)}),this.addHook("beforeSelectColumns",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return SW(S$,t,S6).call(t,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return SW(S$,t,S5).call(t,...i)}),this.addHook("modifyFocusedElement",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return SW(S$,t,S7).call(t,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>SW(S$,this,SX).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>SW(S$,this,SX).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;let{nestedHeaders:t}=this.hot.getSettings();SB(SU,this).setColumnsLimit(this.hot.countCols()),Array.isArray(t)&&(this.detectedOverlappedHeaders=SB(SU,this).setState(t)),this.detectedOverlappedHeaders&&(0,t6.warn)((0,iJ.toSingleLine)`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,e)=>{SB(SU,this).triggerColumnModification(!0===t?"hide-column":"show-column",e)}),!SB(Sz,this)&&this.enabled&&Sj(Sz,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(t=>{let{op:e,index:i,newValue:r}=t;"replace"===e&&SB(SU,this).triggerColumnModification(!0===r?"hide-column":"show-column",i)}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),SB(SU,this).clear(),SB(Sz,this).unsubscribe(),Sj(Sz,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return SB(SU,this)}getLayersCount(){return SB(SU,this).getLayersCount()}getHeaderSettings(t,e){return SB(SU,this).getHeaderSettings(t,e)}clearColspans(){if(!this.hot.view)return;let{_wt:t}=this.hot.view,e=t.getSetting("columnHeaders").length,i=t.wtTable.THEAD,r=t.wtOverlays.topOverlay.clone.wtTable.THEAD,o=t.wtOverlays.topInlineStartCornerOverlay?t.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let t=0;t<e;t++){let e=i.childNodes[t];if(!e)break;let s=r.childNodes[t],n=o?o.childNodes[t]:null;for(let t=0,i=e.childNodes.length;t<i;t++)e.childNodes[t].removeAttribute("colspan"),(0,tZ.removeClass)(e.childNodes[t],"hiddenHeader"),s&&s.childNodes[t]&&(s.childNodes[t].removeAttribute("colspan"),(0,tZ.removeClass)(s.childNodes[t],"hiddenHeader")),o&&n&&n.childNodes[t]&&(n.childNodes[t].removeAttribute("colspan"),(0,tZ.removeClass)(n.childNodes[t],"hiddenHeader"))}}headerRendererFactory(t){var e=this;let i=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,o)=>{var s,n,a;let{columnIndexMapper:l,view:h}=this.hot,c=l.getVisualFromRenderableIndex(r);null===c&&(c=r),o.removeAttribute("colspan"),(0,tZ.removeClass)(o,"hiddenHeader");let{colspan:d,isHidden:u,isPlaceholder:g}=null!==(s=SB(SU,this).getHeaderSettings(t,c))&&void 0!==s?s:{label:""};if(g||u)(0,tZ.addClass)(o,"hiddenHeader");else if(d>1){let{wtOverlays:t}=h._wt,e=null===(n=t.topInlineStartCornerOverlay)||void 0===n?void 0:n.clone.wtTable.THEAD.contains(o),s=null===(a=t.inlineStartOverlay)||void 0===a?void 0:a.clone.wtTable.THEAD.contains(o),l=e||s?Math.min(d,i-r):d;l>1&&o.setAttribute("colspan",l)}this.hot.view.appendColHeader(c,o,function(){return e.getColumnHeaderValue(...arguments)},t)}}getColumnHeaderValue(t,e){var i;let{isHidden:r,isPlaceholder:o}=null!==(i=SB(SU,this).getHeaderSettings(e,t))&&void 0!==i?i:{};return o||r?"":this.hot.getColHeader(t,e)}destroy(){Sj(SU,this,null),null!==SB(Sz,this)&&(SB(Sz,this).unsubscribe(),Sj(Sz,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(t){if(!(t.row>=0)&&!(t.col<0))return SB(SU,this).getHeaderTreeNodeData(t.row,t.col)}}),e8(class extends cx{constructor(){super(...arguments),xg(this,xC),xC.add(this),xp(this,"dataManager",null),xp(this,"headersUI",null),xp(this,"collapsedRowsMap",null),xu(this,xw,!1),xu(this,xb,!1)}static get PLUGIN_KEY(){return xv}static get PLUGIN_PRIORITY(){return 300}isEnabled(){return!!this.hot.getSettings()[xv]}enablePlugin(){var t=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new sQ),this.dataManager=new xr(this,this.hot),this.collapsingUI=new xa(this,this.hot),this.headersUI=new xn(this,this.hot),this.contextMenuUI=new xh(this,this.hot),this.rowMoveController=new xd(this),this.addHook("afterInit",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xy(xC,t,xD).call(t,...i)}),this.addHook("beforeViewRender",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xy(xC,t,xN).call(t,...i)}),this.addHook("modifyRowData",function(){return t.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return t.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return t.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xy(xC,t,xE).call(t,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xy(xC,t,xR).call(t,...i)}),this.addHook("afterGetRowHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xy(xC,t,xT).call(t,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xy(xC,t,xx).call(t,...i)}),this.addHook("beforeRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xy(xC,t,xA).call(t,...i)}),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xy(xC,t,xk).call(t,...i)}),this.addHook("beforeAddChild",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xy(xC,t,xO).call(t,...i)}),this.addHook("afterAddChild",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xy(xC,t,xP).call(t,...i)}),this.addHook("beforeDetachChild",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xy(xC,t,xI).call(t,...i)}),this.addHook("afterDetachChild",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xy(xC,t,xH).call(t,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xy(xC,t,xM).call(t,...i)}),this.addHook("afterCreateRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xy(xC,t,xL).call(t,...i)}),this.addHook("beforeRowMove",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xy(xC,t,xS).call(t,...i)}),this.addHook("beforeLoadData",t=>xy(xC,this,x_).call(this,t)),this.addHook("beforeUpdateData",t=>xy(xC,this,x_).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();let t=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(t),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{let{highlight:t}=this.hot.getSelectedRangeLast(),e=this.collapsingUI.translateTrimmedRow(t.row);return this.collapsingUI.areChildrenCollapsed(e)?this.collapsingUI.expandChildren(e):this.collapsingUI.collapseChildren(e),!1},runOnlyIf:()=>{var t,e;let i=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return i&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(i)&&-1===i.col&&i.row>=0},group:xv,relativeToGroup:hs,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(xv)}disableCoreAPIModifiers(){xm(xb,this,!0)}enableCoreAPIModifiers(){xm(xb,this,!1)}onModifyRowData(t){if(!xf(xb,this))return this.dataManager.getDataObject(t)}onModifySourceLength(){if(!xf(xb,this))return this.dataManager.countAllRows()}onBeforeDataSplice(t,e,i){return!!(xf(xb,this)||this.dataManager.isRowHighestLevel(t))||(this.dataManager.spliceData(t,e,i),!1)}destroy(){super.destroy()}}),e8(class extends cx{constructor(){var t,e,i;super(...arguments),e=void 0,(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="storage","string"))?i:i+"")in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e}static get PLUGIN_KEY(){return xB}static get PLUGIN_PRIORITY(){return 0}isEnabled(){return!!this.hot.getSettings()[xB]}enablePlugin(){this.enabled||(this.storage||(this.storage=new xj(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(t,e)=>this.saveValue(t,e)),this.addHook("persistentStateLoad",(t,e)=>this.loadValue(t,e)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(t,e){e.value=this.storage.loadValue(t)}saveValue(t,e){this.storage.saveValue(t,e)}resetValue(t){void 0===t?this.storage.resetAll():this.storage.reset(t)}destroy(){super.destroy()}}),e8(class extends cx{constructor(){super(...arguments),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,xG),xG.add(this),xW(this,"callback",xz),xW(this,"queryMethod",xY),xW(this,"searchResultClass","htSearchResult")}static get PLUGIN_KEY(){return xU}static get PLUGIN_PRIORITY(){return 190}isEnabled(){return this.hot.getSettings()[xU]}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[xU];this.updatePluginSettings(e),this.addHook("beforeRenderer",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xV(xG,t,x$).call(t,...i)}),super.enablePlugin()}disablePlugin(){var t=this;let e=function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return xV(xG,t,x$).call(t,...i)};this.hot.addHook("beforeRenderer",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",e)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod(),r=this.hot.countRows(),o=this.hot.countCols(),s=[],n=this.hot;return(0,eq.rangeEach)(0,r-1,r=>{(0,eq.rangeEach)(0,o-1,o=>{let a=this.hot.getDataAtCell(r,o),l=this.hot.getCellMeta(r,o),h=l.search.callback||e,c=(l.search.queryMethod||i)(t,a,l);c&&s.push({row:r,col:o,data:a}),h&&h(n,r,o,a,c)})}),s}getCallback(){return this.callback}setCallback(t){this.callback=t}getQueryMethod(){return this.queryMethod}setQueryMethod(t){this.queryMethod=t}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(t){this.searchResultClass=t}updatePluginSettings(t){(0,t3.isObject)(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}destroy(){super.destroy()}}),e8(class extends cx{constructor(){super(...arguments),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,xK),xK.add(this),xX(this,"scrollbars",[]),xX(this,"clones",[]),xX(this,"lockedCollection",!1),xX(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}isEnabled(){return(0,iv.isTouchSupported)()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>xq(xK,this,xZ).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>xq(xK,this,xQ).call(this)),this.addHook("afterMomentumScroll",()=>xq(xK,this,xJ).call(this))}}),e8(class extends cx{constructor(){var t,e;super(...arguments),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,x1),x1.add(this),(t="symbol"==typeof(e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="trimmedRowsMap","string"))?e:e+"")in this?Object.defineProperty(this,t,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[t]=null}static get PLUGIN_KEY(){return x0}static get PLUGIN_PRIORITY(){return 330}isEnabled(){return!!this.hot.getSettings()[x0]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new sQ),this.trimmedRowsMap.addLocalHook("init",()=>(function(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")})(x1,this,x2).call(this)),super.enablePlugin())}updatePlugin(){let t=this.hot.getSettings()[x0];Array.isArray(t)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),(0,eu.arrayEach)(t,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(t){let e=this.getTrimmedRows(),i=this.isValidConfig(t),r=e;i&&(r=Array.from(new Set(e.concat(t)))),!1!==this.hot.runHooks("beforeTrimRow",e,r,i)&&(i&&this.hot.batchExecution(()=>{(0,eu.arrayEach)(t,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),this.hot.runHooks("afterTrimRow",e,r,i,i&&r.length>e.length))}trimRow(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.trimRows(e)}untrimRows(t){let e=this.getTrimmedRows(),i=this.isValidConfig(t),r=e,o=this.trimmedRowsMap.getValues().slice(),s=t.length>0;i&&s&&((0,eu.arrayEach)(t,t=>{o[t]=!1}),r=(0,eu.arrayReduce)(o,(t,e,i)=>(e&&t.push(i),t),[])),!1!==this.hot.runHooks("beforeUntrimRow",e,r,i&&s)&&(i&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",e,r,i&&s,i&&r.length<e.length))}untrimRow(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.untrimRows(e)}isTrimmed(t){return this.trimmedRowsMap.getValueAtIndex(t)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(t){let e=this.hot.countSourceRows();return t.every(t=>Number.isInteger(t)&&t>=0&&t<e)}destroy(){super.destroy()}}),e8(Ec),function(t){let e="undefined"!=typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){let i;let r=this.first(),o=r.data("handsontable");if("string"!=typeof e){let i=e||{};return o?o.updateSettings(i):(o=new t.Core(r[0],i),r.data("handsontable",o),o.init()),r}if(o){if(void 0!==o[e]){for(var s=arguments.length,n=Array(s>1?s-1:0),a=1;a<s;a++)n[a-1]=arguments[a];i=o[e].call(o,...n),"destroy"===e&&r.removeData()}else throw Error(`Handsontable do not provide action: ${e}`)}return i})}(hD),hD.__GhostTable=cT,hD._getListenersCounter=t2.getListenersCounter,hD._getRegisteredMapsCounter=function(){return s1},hD.EventManager=t2.default;const Em=[eu,t0,sT,Ef,iv,tQ,tJ,eq,t3,eX,iL,eg],Ey=[tZ,iy];hD.helper={},hD.dom={},eu.arrayEach(Em,t=>{eu.arrayEach(Object.getOwnPropertyNames(t),e=>{"_"!==e.charAt(0)&&(hD.helper[e]=t[e])})}),eu.arrayEach(Ey,t=>{eu.arrayEach(Object.getOwnPropertyNames(t),e=>{"_"!==e.charAt(0)&&(hD.dom[e]=t[e])})}),hD.cellTypes=null!==(K=hD.cellTypes)&&void 0!==K?K:{},eu.arrayEach(lV(),t=>{hD.cellTypes[t]=lz(t)}),hD.cellTypes.registerCellType=lY,hD.cellTypes.getCellType=lz,hD.editors=null!==(Z=hD.editors)&&void 0!==Z?Z:{},eu.arrayEach((0,il.getRegisteredEditorNames)(),t=>{hD.editors[`${eX.toUpperCaseFirst(t)}Editor`]=(0,il.getEditor)(t)}),hD.editors.registerEditor=il.registerEditor,hD.editors.getEditor=il.getEditor,hD.renderers=null!==(Q=hD.renderers)&&void 0!==Q?Q:{},eu.arrayEach(ir(),t=>{let e=is(t);"base"===t&&(hD.renderers.cellDecorator=e),hD.renderers[`${eX.toUpperCaseFirst(t)}Renderer`]=e}),hD.renderers.registerRenderer=ia,hD.renderers.getRenderer=is,hD.validators=null!==(J=hD.validators)&&void 0!==J?J:{},eu.arrayEach(iu(),t=>{hD.validators[`${eX.toUpperCaseFirst(t)}Validator`]=ip(t)}),hD.validators.registerValidator=im,hD.validators.getValidator=ip,hD.plugins=null!==(tt=hD.plugins)&&void 0!==tt?tt:{},eu.arrayEach(e5(),t=>{hD.plugins[t]=e9(t)}),hD.plugins[`${eX.toUpperCaseFirst(cx.PLUGIN_KEY)}Plugin`]=cx,hD.plugins.registerPlugin=e8,hD.plugins.getPlugin=e9;var Ev={};O={},P={refPrefix:"`",refIntBase:96,refIntFloorCode:32,refIntCeilCode:void 0,maxStringDistance:void 0,minStringLength:5,maxStringLength:void 0,defaultWindow:144,maxWindow:void 0,windowLength:void 0},I=function(t){(P=L(P,t=t||{})).refIntCeilCode=P.refIntFloorCode+P.refIntBase-1,P.maxStringDistance=Math.pow(P.refIntBase,2)-1,P.maxStringLength=Math.pow(P.refIntBase,1)-1+P.minStringLength,P.maxWindow=P.maxStringDistance+P.minStringLength},H=function(t,e,i){var r={};if(null!==t){if(Array.prototype.forEach&&t.forEach===Array.prototype.forEach)t.forEach(e,i);else if(t.length===+t.length){for(var o=0,s=t.length;o<s;o++)if(e.call(i,t[o],o,t)===r)return}else for(var n in t)if(t.hasOwnProperty(n)&&e.call(i,t[n],n,t)===r)return}},L=function(t){return H(Array.prototype.slice.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},D=function(t,e){if(t>=0&&t<Math.pow(P.refIntBase,e)-1){for(var i="";t>0;)i=String.fromCharCode(t%P.refIntBase+P.refIntFloorCode)+i,t=Math.floor(t/P.refIntBase);for(var r=e-i.length,o=0;o<r;o++)i=String.fromCharCode(P.refIntFloorCode)+i;return i}throw"Reference int out of range: "+t+" (width = "+e+")"},N=function(t,e){for(var i,r=0,o=0;o<e;o++)if(r*=P.refIntBase,(i=t.charCodeAt(o))>=P.refIntFloorCode&&i<=P.refIntCeilCode)r+=i-P.refIntFloorCode;else throw"Invalid char code in reference int: "+i;return r},O.compress=function(t,e){if("[object String]"!==Object.prototype.toString.call(t))throw"Input must be a string";I(e);var i=P.windowLength||P.defaultWindow;if(i>P.maxWindow)throw"Window length too large";for(var r="",o=0,s=t.length-P.minStringLength;o<s;){for(var n,a=Math.max(o-i,0),l=P.minStringLength,h=!1,c={distance:P.maxStringDistance,length:0},d=null;a+l<o;)t.substr(a,l)===t.substr(o,l)&&l<P.maxStringLength?(l++,h=!0):(n=l-1,h&&n>c.length&&(c.distance=o-a-n,c.length=n),l=P.minStringLength,a++,h=!1);c.length?(d=P.refPrefix+D(c.distance,2)+D(c.length-P.minStringLength,1),o+=c.length):(d=t.charAt(o)!==P.refPrefix?t.charAt(o):P.refPrefix+P.refPrefix,o++),r+=d}return r+t.slice(o).replace(/`/g,"``")},O.decompress=function(t,e){if("[object String]"!==Object.prototype.toString.call(t))throw"Input must be a string";var i,r,o,s="",n=0;for(I(e);n<t.length;)(i=t.charAt(n))!==P.refPrefix?(s+=i,n++):t.charAt(n+1)!==P.refPrefix?(r=N(t.substr(n+1,2),2),o=N(t.charAt(n+3),1)+P.minStringLength,s+=s.substr(s.length-r-o,o),n+=P.minStringLength-1):(s+=P.refPrefix,n+=2);return s},"undefined"!=typeof define&&define.amd?define([],function(){return O}):Ev?Ev=O:void 0!==window&&(window.LZ77=O);var Ew={};_="undefined"!=typeof window?window:Ew,F=function(t){var e={};function i(e,i,r,o){e.hasOwnProperty(i)||(e[i]=o.apply(null,r),"function"==typeof CustomEvent&&t.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:i,module:e[i]}})))}return i(e,"Core/Globals.js",[],function(){var e,i;return(i=e||(e={})).SVG_NS="http://www.w3.org/2000/svg",i.product="Highcharts",i.version="11.4.1",i.win=void 0!==t?t:{},i.doc=i.win.document,i.svg=i.doc&&i.doc.createElementNS&&!!i.doc.createElementNS(i.SVG_NS,"svg").createSVGRect,i.userAgent=i.win.navigator&&i.win.navigator.userAgent||"",i.isChrome=-1!==i.userAgent.indexOf("Chrome"),i.isFirefox=-1!==i.userAgent.indexOf("Firefox"),i.isMS=/(edge|msie|trident)/i.test(i.userAgent)&&!i.win.opera,i.isSafari=!i.isChrome&&-1!==i.userAgent.indexOf("Safari"),i.isTouchDevice=/(Mobile|Android|Windows Phone)/.test(i.userAgent),i.isWebKit=-1!==i.userAgent.indexOf("AppleWebKit"),i.deg2rad=2*Math.PI/360,i.hasBidiBug=i.isFirefox&&4>parseInt(i.userAgent.split("Firefox/")[1],10),i.marginNames=["plotTop","marginRight","marginBottom","plotLeft"],i.noop=function(){},i.supportsPassiveEvents=function(){let t=!1;if(!i.isMS){let e=Object.defineProperty({},"passive",{get:function(){t=!0}});i.win.addEventListener&&i.win.removeEventListener&&(i.win.addEventListener("testPassive",i.noop,e),i.win.removeEventListener("testPassive",i.noop,e))}return t}(),i.charts=[],i.composed=[],i.dateFormats={},i.seriesTypes={},i.symbolSizes={},i.chartCount=0,e}),i(e,"Core/Utilities.js",[e["Core/Globals.js"]],function(t){let e,i,r;let{charts:o,doc:s,win:n}=t;function a(e,i,r,o){let s=i?"Highcharts error":"Highcharts warning";32===e&&(e=`${s}: Deprecated member`);let l=p(e),h=l?`${s} #${e}: www.highcharts.com/errors/${e}/`:e.toString();if(void 0!==o){let t="";l&&(h+="?"),R(o,function(e,i){t+=`
 - ${i}: ${e}`,l&&(h+=encodeURI(i)+"="+encodeURI(e))}),h+=t}M(t,"displayError",{chart:r,code:e,message:h,params:o},function(){if(i)throw Error(h);n.console&&-1===a.messages.indexOf(h)&&console.warn(h)}),a.messages.push(h)}function l(t,e){return parseInt(t,e||10)}function h(t){return"string"==typeof t}function c(t){let e=Object.prototype.toString.call(t);return"[object Array]"===e||"[object Array Iterator]"===e}function d(t,e){return!!t&&"object"==typeof t&&(!e||!c(t))}function u(t){return d(t)&&"number"==typeof t.nodeType}function g(t){let e=t&&t.constructor;return!!(d(t,!0)&&!u(t)&&e&&e.name&&"Object"!==e.name)}function p(t){return"number"==typeof t&&!isNaN(t)&&t<1/0&&t>-1/0}function f(t){return null!=t}function m(t,e,i){let r;let o=h(e)&&!f(i),s=(e,i)=>{f(e)?t.setAttribute(i,e):o?(r=t.getAttribute(i))||"class"!==i||(r=t.getAttribute(i+"Name")):t.removeAttribute(i)};return h(e)?s(i,e):R(e,s),r}function y(t){return c(t)?t:[t]}function w(t,e){let i;for(i in t||(t={}),e)t[i]=e[i];return t}function b(){let t=arguments,e=t.length;for(let i=0;i<e;i++){let e=t[i];if(null!=e)return e}}function C(t,e){w(t.style,e)}function S(t){return Math.pow(10,Math.floor(Math.log(t)/Math.LN10))}function x(t,e){return t>1e14?t:parseFloat(t.toPrecision(e||14))}(a||(a={})).messages=[],Math.easeInOutSine=function(t){return -.5*(Math.cos(Math.PI*t)-1)};let E=Array.prototype.find?function(t,e){return t.find(e)}:function(t,e){let i;let r=t.length;for(i=0;i<r;i++)if(e(t[i],i))return t[i]};function R(t,e,i){for(let r in t)Object.hasOwnProperty.call(t,r)&&e.call(i||t[r],t[r],r,t)}function T(t,e,i){function r(e,i){let r=t.removeEventListener;r&&r.call(t,e,i,!1)}function o(i){let o,s;t.nodeName&&(e?(o={})[e]=!0:o=i,R(o,function(t,e){if(i[e])for(s=i[e].length;s--;)r(e,i[e][s].fn)}))}let s="function"==typeof t&&t.prototype||t;if(Object.hasOwnProperty.call(s,"hcEvents")){let t=s.hcEvents;if(e){let s=t[e]||[];i?(t[e]=s.filter(function(t){return i!==t.fn}),r(e,i)):(o(t),t[e]=[])}else o(t),delete s.hcEvents}}function M(e,i,r,o){if(r=r||{},s.createEvent&&(e.dispatchEvent||e.fireEvent&&e!==t)){let t=s.createEvent("Events");t.initEvent(i,!0,!0),r=w(t,r),e.dispatchEvent?e.dispatchEvent(r):e.fireEvent(i,r)}else if(e.hcEvents){r.target||w(r,{preventDefault:function(){r.defaultPrevented=!0},target:e,type:i});let t=[],o=e,s=!1;for(;o.hcEvents;)Object.hasOwnProperty.call(o,"hcEvents")&&o.hcEvents[i]&&(t.length&&(s=!0),t.unshift.apply(t,o.hcEvents[i])),o=Object.getPrototypeOf(o);s&&t.sort((t,e)=>t.order-e.order),t.forEach(t=>{!1===t.fn.call(e,r)&&r.preventDefault()})}o&&!r.defaultPrevented&&o.call(e,r)}R({map:"map",each:"forEach",grep:"filter",reduce:"reduce",some:"some"},function(e,i){t[i]=function(t){return a(32,!1,void 0,{[`Highcharts.${i}`]:`use Array.${e}`}),Array.prototype[e].apply(t,[].slice.call(arguments,1))}});let k=(i=Math.random().toString(36).substring(2,9)+"-",r=0,function(){return"highcharts-"+(e?"":i)+r++});return n.jQuery&&(n.jQuery.fn.highcharts=function(){let e=[].slice.call(arguments);if(this[0])return e[0]?(new t[h(e[0])?e.shift():"Chart"](this[0],e[0],e[1]),this):o[m(this[0],"data-highcharts-chart")]}),{addEvent:function(e,i,r,o={}){let s="function"==typeof e&&e.prototype||e;Object.hasOwnProperty.call(s,"hcEvents")||(s.hcEvents={});let n=s.hcEvents;t.Point&&e instanceof t.Point&&e.series&&e.series.chart&&(e.series.chart.runTrackerClick=!0);let a=e.addEventListener;a&&a.call(e,i,r,!!t.supportsPassiveEvents&&{passive:void 0===o.passive?-1!==i.indexOf("touch"):o.passive,capture:!1}),n[i]||(n[i]=[]);let l={fn:r,order:"number"==typeof o.order?o.order:1/0};return n[i].push(l),n[i].sort((t,e)=>t.order-e.order),function(){T(e,i,r)}},arrayMax:function(t){let e=t.length,i=t[0];for(;e--;)t[e]>i&&(i=t[e]);return i},arrayMin:function(t){let e=t.length,i=t[0];for(;e--;)t[e]<i&&(i=t[e]);return i},attr:m,clamp:function(t,e,i){return t>e?t<i?t:i:e},clearTimeout:function(t){f(t)&&clearTimeout(t)},correctFloat:x,createElement:function(t,e,i,r,o){let n=s.createElement(t);return e&&w(n,e),o&&C(n,{padding:"0",border:"none",margin:"0"}),i&&C(n,i),r&&r.appendChild(n),n},css:C,defined:f,destroyObjectProperties:function(t,e,i){R(t,function(r,o){r!==e&&r?.destroy&&r.destroy(),(r?.destroy||!i)&&delete t[o]})},diffObjects:function(t,e,i,r){let o={};return function t(e,o,s,n){let a=i?o:e;R(e,function(i,l){if(!n&&r&&r.indexOf(l)>-1&&o[l]){i=y(i),s[l]=[];for(let e=0;e<Math.max(i.length,o[l].length);e++)o[l][e]&&(void 0===i[e]?s[l][e]=o[l][e]:(s[l][e]={},t(i[e],o[l][e],s[l][e],n+1)))}else d(i,!0)&&!i.nodeType?(s[l]=c(i)?[]:{},t(i,o[l]||{},s[l],n+1),0!==Object.keys(s[l]).length||"colorAxis"===l&&0===n||delete s[l]):(e[l]!==o[l]||l in e&&!(l in o))&&"__proto__"!==l&&"constructor"!==l&&(s[l]=a[l])})}(t,e,o,0),o},discardElement:function(t){t&&t.parentElement&&t.parentElement.removeChild(t)},erase:function(t,e){let i=t.length;for(;i--;)if(t[i]===e){t.splice(i,1);break}},error:a,extend:w,extendClass:function(t,e){let i=function(){};return i.prototype=new t,w(i.prototype,e),i},find:E,fireEvent:M,getClosestDistance:function(t,e){let i,r,o,s;let n=!e;return t.forEach(t=>{if(t.length>1)for(s=r=t.length-1;s>0;s--)(o=t[s]-t[s-1])<0&&!n?(e?.(),e=void 0):o&&(void 0===i||o<i)&&(i=o)}),i},getMagnitude:S,getNestedProperty:function(t,e){let i=t.split(".");for(;i.length&&f(e);){let t=i.shift();if(void 0===t||"__proto__"===t)return;if("this"===t){let t;return d(e)&&(t=e["@this"]),t??e}let r=e[t];if(!f(r)||"function"==typeof r||"number"==typeof r.nodeType||r===n)return;e=r}return e},getStyle:function t(e,i,r){let o;if("width"===i){let i=Math.min(e.offsetWidth,e.scrollWidth),r=e.getBoundingClientRect&&e.getBoundingClientRect().width;return r<i&&r>=i-1&&(i=Math.floor(r)),Math.max(0,i-(t(e,"padding-left",!0)||0)-(t(e,"padding-right",!0)||0))}if("height"===i)return Math.max(0,Math.min(e.offsetHeight,e.scrollHeight)-(t(e,"padding-top",!0)||0)-(t(e,"padding-bottom",!0)||0));let s=n.getComputedStyle(e,void 0);return s&&(o=s.getPropertyValue(i),b(r,"opacity"!==i)&&(o=l(o))),o},inArray:function(t,e,i){return a(32,!1,void 0,{"Highcharts.inArray":"use Array.indexOf"}),e.indexOf(t,i)},insertItem:function(t,e){let i;let r=t.options.index,o=e.length;for(i=t.options.isInternal?o:0;i<o+1;i++)if(!e[i]||p(r)&&r<b(e[i].options.index,e[i]._i)||e[i].options.isInternal){e.splice(i,0,t);break}return i},isArray:c,isClass:g,isDOMElement:u,isFunction:function(t){return"function"==typeof t},isNumber:p,isObject:d,isString:h,keys:function(t){return a(32,!1,void 0,{"Highcharts.keys":"use Object.keys"}),Object.keys(t)},merge:function(){let t,e=arguments,i={},r=function(t,e){return"object"!=typeof t&&(t={}),R(e,function(i,o){"__proto__"!==o&&"constructor"!==o&&(!d(i,!0)||g(i)||u(i)?t[o]=e[o]:t[o]=r(t[o]||{},i))}),t};!0===e[0]&&(i=e[1],e=Array.prototype.slice.call(e,2));let o=e.length;for(t=0;t<o;t++)i=r(i,e[t]);return i},normalizeTickInterval:function(t,e,i,r,o){let s,n=t;i=b(i,S(t));let a=t/i;for(!e&&(e=o?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],!1===r&&(1===i?e=e.filter(function(t){return t%1==0}):i<=.1&&(e=[1/i]))),s=0;s<e.length&&(n=e[s],(!o||!(n*i>=t))&&(o||!(a<=(e[s]+(e[s+1]||e[s]))/2)));s++);return x(n*i,-Math.round(Math.log(.001)/Math.LN10))},objectEach:R,offset:function(t){let e=s.documentElement,i=t.parentElement||t.parentNode?t.getBoundingClientRect():{top:0,left:0,width:0,height:0};return{top:i.top+(n.pageYOffset||e.scrollTop)-(e.clientTop||0),left:i.left+(n.pageXOffset||e.scrollLeft)-(e.clientLeft||0),width:i.width,height:i.height}},pad:function(t,e,i){return Array((e||2)+1-String(t).replace("-","").length).join(i||"0")+t},pick:b,pInt:l,pushUnique:function(t,e){return 0>t.indexOf(e)&&!!t.push(e)},relativeLength:function(t,e,i){return/%$/.test(t)?e*parseFloat(t)/100+(i||0):parseFloat(t)},removeEvent:T,replaceNested:function(t,...e){let i,r;do for(r of(i=t,e))t=t.replace(r[0],r[1]);while(t!==i)return t},splat:y,stableSort:function(t,e){let i,r;let o=t.length;for(r=0;r<o;r++)t[r].safeI=r;for(t.sort(function(t,r){return 0===(i=e(t,r))?t.safeI-r.safeI:i}),r=0;r<o;r++)delete t[r].safeI},syncTimeout:function(t,e,i){return e>0?setTimeout(t,e,i):(t.call(0,i),-1)},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},uniqueKey:k,useSerialIds:function(t){return e=b(t,e)},wrap:function(t,e,i){let r=t[e];t[e]=function(){let t=arguments,e=this;return i.apply(this,[function(){return r.apply(e,arguments.length?arguments:t)}].concat([].slice.call(arguments)))}}}}),i(e,"Core/Chart/ChartDefaults.js",[],function(){return{alignThresholds:!1,panning:{enabled:!1,type:"x"},styledMode:!1,borderRadius:0,colorCount:10,allowMutatingData:!0,ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{},position:{}},reflow:!0,type:"line",zooming:{singleTouch:!1,resetButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}}},width:null,height:null,borderColor:"#334eff",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"}}),i(e,"Core/Color/Palettes.js",[],function(){return{colors:["#2caffe","#544fc5","#00e272","#fe6a35","#6b8abc","#d568fb","#2ee0ca","#fa4b42","#feb56a","#91e8e1"]}}),i(e,"Core/Time.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(t,e){let{win:i}=t,{defined:r,error:o,extend:s,isNumber:n,isObject:a,merge:l,objectEach:h,pad:c,pick:d,splat:u,timeUnits:g}=e,p=t.isSafari&&i.Intl&&i.Intl.DateTimeFormat.prototype.formatRange,f=t.isSafari&&i.Intl&&!i.Intl.DateTimeFormat.prototype.formatRange;class m{constructor(t){this.options={},this.useUTC=!1,this.variableTimezone=!1,this.Date=i.Date,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.update(t)}get(t,e){if(this.variableTimezone||this.timezoneOffset){let i=e.getTime(),r=i-this.getTimezoneOffset(e);e.setTime(r);let o=e["getUTC"+t]();return e.setTime(i),o}return this.useUTC?e["getUTC"+t]():e["get"+t]()}set(t,e,i){if(this.variableTimezone||this.timezoneOffset){if("Milliseconds"===t||"Seconds"===t||"Minutes"===t&&this.getTimezoneOffset(e)%36e5==0)return e["setUTC"+t](i);let r=this.getTimezoneOffset(e),o=e.getTime()-r;e.setTime(o),e["setUTC"+t](i);let s=this.getTimezoneOffset(e);return o=e.getTime()+s,e.setTime(o)}return this.useUTC||p&&"FullYear"===t?e["setUTC"+t](i):e["set"+t](i)}update(t={}){let e=d(t.useUTC,!0);this.options=t=l(!0,this.options,t),this.Date=t.Date||i.Date||Date,this.useUTC=e,this.timezoneOffset=e&&t.timezoneOffset||void 0,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.variableTimezone=e&&!!(t.getTimezoneOffset||t.timezone)}makeTime(t,e,i,r,o,s){let n,a,l;return this.useUTC?(n=this.Date.UTC.apply(0,arguments),a=this.getTimezoneOffset(n),n+=a,a!==(l=this.getTimezoneOffset(n))?n+=l-a:a-36e5!==this.getTimezoneOffset(n-36e5)||f||(n-=36e5)):n=new this.Date(t,e,d(i,1),d(r,0),d(o,0),d(s,0)).getTime(),n}timezoneOffsetFunction(){let t=this,e=this.options,i=e.getTimezoneOffset;return this.useUTC?e.timezone?t=>{try{let i=`shortOffset,${e.timezone||""}`,[r,o,s,a,l=0]=(m.formatCache[i]=m.formatCache[i]||Intl.DateTimeFormat("en",{timeZone:e.timezone,timeZoneName:"shortOffset"})).format(t).split(/(GMT|:)/).map(Number),h=-(36e5*(s+l/60));if(n(h))return h}catch(t){o(34)}return 0}:this.useUTC&&i?t=>6e4*i(t.valueOf()):()=>6e4*(t.timezoneOffset||0):t=>6e4*new Date(t.toString()).getTimezoneOffset()}dateFormat(e,i,o){if(!r(i)||isNaN(i))return t.defaultOptions.lang&&t.defaultOptions.lang.invalidDate||"";e=d(e,"%Y-%m-%d %H:%M:%S");let n=this,a=new this.Date(i),l=this.get("Hours",a),u=this.get("Day",a),g=this.get("Date",a),p=this.get("Month",a),f=this.get("FullYear",a),m=t.defaultOptions.lang,y=m&&m.weekdays,w=m&&m.shortWeekdays;return h(s({a:w?w[u]:y[u].substr(0,3),A:y[u],d:c(g),e:c(g,2," "),w:u,b:m.shortMonths[p],B:m.months[p],m:c(p+1),o:p+1,y:f.toString().substr(2,2),Y:f,H:c(l),k:l,I:c(l%12||12),l:l%12||12,M:c(this.get("Minutes",a)),p:l<12?"AM":"PM",P:l<12?"am":"pm",S:c(this.get("Seconds",a)),L:c(Math.floor(i%1e3),3)},t.dateFormats),function(t,r){for(;-1!==e.indexOf("%"+r);)e=e.replace("%"+r,"function"==typeof t?t.call(n,i):t)}),o?e.substr(0,1).toUpperCase()+e.substr(1):e}resolveDTLFormat(t){return a(t,!0)?t:{main:(t=u(t))[0],from:t[1],to:t[2]}}getTimeTicks(t,e,i,o){let n,a,l,h;let c=this,u=c.Date,p=[],f={},m=new u(e),y=t.unitRange,w=t.count||1;if(o=d(o,1),r(e)){c.set("Milliseconds",m,y>=g.second?0:w*Math.floor(c.get("Milliseconds",m)/w)),y>=g.second&&c.set("Seconds",m,y>=g.minute?0:w*Math.floor(c.get("Seconds",m)/w)),y>=g.minute&&c.set("Minutes",m,y>=g.hour?0:w*Math.floor(c.get("Minutes",m)/w)),y>=g.hour&&c.set("Hours",m,y>=g.day?0:w*Math.floor(c.get("Hours",m)/w)),y>=g.day&&c.set("Date",m,y>=g.month?1:Math.max(1,w*Math.floor(c.get("Date",m)/w))),y>=g.month&&(c.set("Month",m,y>=g.year?0:w*Math.floor(c.get("Month",m)/w)),a=c.get("FullYear",m)),y>=g.year&&(a-=a%w,c.set("FullYear",m,a)),y===g.week&&(h=c.get("Day",m),c.set("Date",m,c.get("Date",m)-h+o+(h<o?-7:0))),a=c.get("FullYear",m);let t=c.get("Month",m),s=c.get("Date",m),d=c.get("Hours",m);e=m.getTime(),(c.variableTimezone||!c.useUTC)&&r(i)&&(l=i-e>4*g.month||c.getTimezoneOffset(e)!==c.getTimezoneOffset(i));let u=m.getTime();for(n=1;u<i;)p.push(u),y===g.year?u=c.makeTime(a+n*w,0):y===g.month?u=c.makeTime(a,t+n*w):l&&(y===g.day||y===g.week)?u=c.makeTime(a,t,s+n*w*(y===g.day?1:7)):l&&y===g.hour&&w>1?u=c.makeTime(a,t,s,d+n*w):u+=y*w,n++;p.push(u),y<=g.hour&&p.length<1e4&&p.forEach(function(t){t%18e5==0&&"000000000"===c.dateFormat("%H%M%S%L",t)&&(f[t]="day")})}return p.info=s(t,{higherRanks:f,totalRange:y*w}),p}getDateFormat(t,e,i,r){let o=this.dateFormat("%m-%d %H:%M:%S.%L",e),s="01-01 00:00:00.000",n={millisecond:15,second:12,minute:9,hour:6,day:3},a="millisecond",l=a;for(a in g){if(t===g.week&&+this.dateFormat("%w",e)===i&&o.substr(6)===s.substr(6)){a="week";break}if(g[a]>t){a=l;break}if(n[a]&&o.substr(n[a])!==s.substr(n[a]))break;"week"!==a&&(l=a)}return this.resolveDTLFormat(r[a]).main}}return m.formatCache={},m}),i(e,"Core/Defaults.js",[e["Core/Chart/ChartDefaults.js"],e["Core/Globals.js"],e["Core/Color/Palettes.js"],e["Core/Time.js"],e["Core/Utilities.js"]],function(t,e,i,r,o){let{isTouchDevice:s,svg:n}=e,{merge:a}=o,l={colors:i.colors,symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{},time:{Date:void 0,getTimezoneOffset:void 0,timezone:void 0,timezoneOffset:0,useUTC:!0},chart:t,title:{style:{color:"#333333",fontWeight:"bold"},text:"Chart title",align:"center",margin:15,widthAdjust:-44},subtitle:{style:{color:"#666666",fontSize:"0.8em"},text:"",align:"center",widthAdjust:-44},caption:{margin:15,style:{color:"#666666",fontSize:"0.8em"},text:"",align:"left",verticalAlign:"bottom"},plotOptions:{},legend:{enabled:!0,align:"center",alignColumns:!0,className:"highcharts-no-tooltip",layout:"horizontal",itemMarginBottom:2,itemMarginTop:2,labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{style:{fontSize:"0.8em"},activeColor:"#0022ff",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",cursor:"pointer",fontSize:"0.8em",textDecoration:"none",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#666666",textDecoration:"line-through"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontSize:"0.8em",fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:n,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %e %b, %H:%M:%S.%L",second:"%A, %e %b, %H:%M:%S",minute:"%A, %e %b, %H:%M",hour:"%A, %e %b, %H:%M",day:"%A, %e %b %Y",week:"Week from %A, %e %b %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerShape:"callout",hideDelay:500,padding:8,shape:"callout",shared:!1,snap:s?25:10,headerFormat:'<span style="font-size: 0.8em">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}"></span> {series.name}: <b>{point.y}</b><br/>',backgroundColor:"#ffffff",borderWidth:void 0,shadow:!0,stickOnContact:!1,style:{color:"#333333",cursor:"default",fontSize:"0.8em"},useHTML:!1},credits:{enabled:!0,href:"https://www.highcharts.com?credits",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"0.6em"},text:"Highcharts.com"}};l.chart.styledMode=!1;let h=new r(l.time);return{defaultOptions:l,defaultTime:h,getOptions:function(){return l},setOptions:function(t){return a(!0,l,t),(t.time||t.global)&&(e.time?e.time.update(a(l.global,l.time,t.global,t.time)):e.time=h),l}}}),i(e,"Core/Color/Color.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(t,e){let{isNumber:i,merge:r,pInt:o}=e;class s{static parse(t){return t?new s(t):s.None}constructor(e){let i,r,o,n;this.rgba=[NaN,NaN,NaN,NaN],this.input=e;let a=t.Color;if(a&&a!==s)return new a(e);if("object"==typeof e&&void 0!==e.stops)this.stops=e.stops.map(t=>new s(t[1]));else if("string"==typeof e){if(this.input=e=s.names[e.toLowerCase()]||e,"#"===e.charAt(0)){let t=e.length,i=parseInt(e.substr(1),16);7===t?r=[(16711680&i)>>16,(65280&i)>>8,255&i,1]:4===t&&(r=[(3840&i)>>4|(3840&i)>>8,(240&i)>>4|240&i,(15&i)<<4|15&i,1])}if(!r)for(o=s.parsers.length;o--&&!r;)(i=(n=s.parsers[o]).regex.exec(e))&&(r=n.parse(i))}r&&(this.rgba=r)}get(t){let e=this.input,o=this.rgba;if("object"==typeof e&&void 0!==this.stops){let i=r(e);return i.stops=[].slice.call(i.stops),this.stops.forEach((e,r)=>{i.stops[r]=[i.stops[r][0],e.get(t)]}),i}return o&&i(o[0])?"rgb"!==t&&(t||1!==o[3])?"a"===t?`${o[3]}`:"rgba("+o.join(",")+")":"rgb("+o[0]+","+o[1]+","+o[2]+")":e}brighten(t){let e=this.rgba;if(this.stops)this.stops.forEach(function(e){e.brighten(t)});else if(i(t)&&0!==t)for(let i=0;i<3;i++)e[i]+=o(255*t),e[i]<0&&(e[i]=0),e[i]>255&&(e[i]=255);return this}setOpacity(t){return this.rgba[3]=t,this}tweenTo(t,e){let r=this.rgba,o=t.rgba;if(!i(r[0])||!i(o[0]))return t.input||"none";let s=1!==o[3]||1!==r[3];return(s?"rgba(":"rgb(")+Math.round(o[0]+(r[0]-o[0])*(1-e))+","+Math.round(o[1]+(r[1]-o[1])*(1-e))+","+Math.round(o[2]+(r[2]-o[2])*(1-e))+(s?","+(o[3]+(r[3]-o[3])*(1-e)):"")+")"}}return s.names={white:"#ffffff",black:"#000000"},s.parsers=[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(t){return[o(t[1]),o(t[2]),o(t[3]),parseFloat(t[4],10)]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(t){return[o(t[1]),o(t[2]),o(t[3]),1]}}],s.None=new s(""),s}),i(e,"Core/Animation/Fx.js",[e["Core/Color/Color.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(t,e,i){let{parse:r}=t,{win:o}=e,{isNumber:s,objectEach:n}=i;class a{constructor(t,e,i){this.pos=NaN,this.options=e,this.elem=t,this.prop=i}dSetter(){let t=this.paths,e=t&&t[0],i=t&&t[1],r=this.now||0,o=[];if(1!==r&&e&&i){if(e.length===i.length&&r<1)for(let t=0;t<i.length;t++){let n=e[t],a=i[t],l=[];for(let t=0;t<a.length;t++){let e=n[t],i=a[t];s(e)&&s(i)&&!("A"===a[0]&&(4===t||5===t))?l[t]=e+r*(i-e):l[t]=i}o.push(l)}else o=i}else o=this.toD||[];this.elem.attr("d",o,void 0,!0)}update(){let t=this.elem,e=this.prop,i=this.now,r=this.options.step;this[e+"Setter"]?this[e+"Setter"]():t.attr?t.element&&t.attr(e,i,null,!0):t.style[e]=i+this.unit,r&&r.call(t,i,this)}run(t,e,i){let r=this,s=r.options,n=function(t){return!n.stopped&&r.step(t)},l=o.requestAnimationFrame||function(t){setTimeout(t,13)},h=function(){for(let t=0;t<a.timers.length;t++)a.timers[t]()||a.timers.splice(t--,1);a.timers.length&&l(h)};t!==e||this.elem["forceAnimate:"+this.prop]?(this.startTime=+new Date,this.start=t,this.end=e,this.unit=i,this.now=this.start,this.pos=0,n.elem=this.elem,n.prop=this.prop,n()&&1===a.timers.push(n)&&l(h)):(delete s.curAnim[this.prop],s.complete&&0===Object.keys(s.curAnim).length&&s.complete.call(this.elem))}step(t){let e,i;let r=+new Date,o=this.options,s=this.elem,a=o.complete,l=o.duration,h=o.curAnim;return s.attr&&!s.element?e=!1:t||r>=l+this.startTime?(this.now=this.end,this.pos=1,this.update(),h[this.prop]=!0,i=!0,n(h,function(t){!0!==t&&(i=!1)}),i&&a&&a.call(s),e=!1):(this.pos=o.easing((r-this.startTime)/l),this.now=this.start+(this.end-this.start)*this.pos,this.update(),e=!0),e}initPath(t,e,i){let r=t.startX,o=t.endX,n=i.slice(),a=t.isArea,l=a?2:1,h,c,d,u,g=e&&e.slice();if(!g)return[n,n];function p(t,e){for(;t.length<c;){let i=t[0],r=e[c-t.length];if(r&&"M"===i[0]&&("C"===r[0]?t[0]=["C",i[1],i[2],i[1],i[2],i[1],i[2]]:t[0]=["L",i[1],i[2]]),t.unshift(i),a){let e=t.pop();t.push(t[t.length-1],e)}}}function f(t){for(;t.length<c;){let e=t[Math.floor(t.length/l)-1].slice();if("C"===e[0]&&(e[1]=e[5],e[2]=e[6]),a){let i=t[Math.floor(t.length/l)].slice();t.splice(t.length/2,0,e,i)}else t.push(e)}}if(r&&o&&o.length){for(d=0;d<r.length;d++){if(r[d]===o[0]){h=d;break}if(r[0]===o[o.length-r.length+d]){h=d,u=!0;break}if(r[r.length-1]===o[o.length-r.length+d]){h=r.length-d;break}}void 0===h&&(g=[])}return g.length&&s(h)&&(c=n.length+h*l,u?(p(g,n),f(n)):(p(n,g),f(g))),[g,n]}fillSetter(){a.prototype.strokeSetter.apply(this,arguments)}strokeSetter(){this.elem.attr(this.prop,r(this.start).tweenTo(r(this.end),this.pos),void 0,!0)}}return a.timers=[],a}),i(e,"Core/Animation/AnimationUtilities.js",[e["Core/Animation/Fx.js"],e["Core/Utilities.js"]],function(t,e){let{defined:i,getStyle:r,isArray:o,isNumber:s,isObject:n,merge:a,objectEach:l,pick:h}=e;function c(t){return n(t)?a({duration:500,defer:0},t):{duration:t?500:0,defer:0}}function d(e,i){let r=t.timers.length;for(;r--;)t.timers[r].elem!==e||i&&i!==t.timers[r].prop||(t.timers[r].stopped=!0)}return{animate:function(e,i,h){let c,u="",g,p,f;n(h)||(f=arguments,h={duration:f[2],easing:f[3],complete:f[4]}),s(h.duration)||(h.duration=400),h.easing="function"==typeof h.easing?h.easing:Math[h.easing]||Math.easeInOutSine,h.curAnim=a(i),l(i,function(s,n){d(e,n),p=new t(e,h,n),g=void 0,"d"===n&&o(i.d)?(p.paths=p.initPath(e,e.pathArray,i.d),p.toD=i.d,c=0,g=1):e.attr?c=e.attr(n):(c=parseFloat(r(e,n))||0,"opacity"!==n&&(u="px")),g||(g=s),"string"==typeof g&&g.match("px")&&(g=g.replace(/px/g,"")),p.run(c,g,u)})},animObject:c,getDeferredAnimation:function(t,e,r){let o=c(e),s=r?[r]:t.series,a=0,l=0;return s.forEach(t=>{let r=c(t.options.animation);a=n(e)&&i(e.defer)?o.defer:Math.max(a,r.duration+r.defer),l=Math.min(o.duration,r.duration)}),t.renderer.forExport&&(a=0),{defer:Math.max(0,a-l),duration:Math.min(a,l)}},setAnimation:function(t,e){e.renderer.globalAnimation=h(t,e.options.chart.animation,!0)},stop:d}}),i(e,"Core/Renderer/HTML/AST.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(t,e){let{SVG_NS:i,win:r}=t,{attr:o,createElement:s,css:n,error:a,isFunction:l,isString:h,objectEach:c,splat:d}=e,{trustedTypes:u}=r,g=u&&l(u.createPolicy)&&u.createPolicy("highcharts",{createHTML:t=>t}),p=g?g.createHTML(""):"",f=function(){try{return!!new DOMParser().parseFromString(p,"text/html")}catch(t){return!1}}();class m{static filterUserAttributes(t){return c(t,(e,i)=>{let r=!0;-1===m.allowedAttributes.indexOf(i)&&(r=!1),-1!==["background","dynsrc","href","lowsrc","src"].indexOf(i)&&(r=h(e)&&m.allowedReferences.some(t=>0===e.indexOf(t))),r||(a(33,!1,void 0,{"Invalid attribute in config":`${i}`}),delete t[i]),h(e)&&t[i]&&(t[i]=e.replace(/</g,"&lt;"))}),t}static parseStyle(t){return t.split(";").reduce((t,e)=>{let i=e.split(":").map(t=>t.trim()),r=i.shift();return r&&i.length&&(t[r.replace(/-([a-z])/g,t=>t[1].toUpperCase())]=i.join(":")),t},{})}static setElementHTML(t,e){t.innerHTML=m.emptyHTML,e&&new m(e).addToDOM(t)}constructor(t){this.nodes="string"==typeof t?this.parseMarkup(t):t}addToDOM(e){return function e(r,s){let l;return d(r).forEach(function(r){let h;let d=r.tagName,u=r.textContent?t.doc.createTextNode(r.textContent):void 0,g=m.bypassHTMLFiltering;if(d){if("#text"===d)h=u;else if(-1!==m.allowedTags.indexOf(d)||g){let a="svg"===d?i:s.namespaceURI||i,l=t.doc.createElementNS(a,d),p=r.attributes||{};c(r,function(t,e){"tagName"!==e&&"attributes"!==e&&"children"!==e&&"style"!==e&&"textContent"!==e&&(p[e]=t)}),o(l,g?p:m.filterUserAttributes(p)),r.style&&n(l,r.style),u&&l.appendChild(u),e(r.children||[],l),h=l}else a(33,!1,void 0,{"Invalid tagName in config":d})}h&&s.appendChild(h),l=h}),l}(this.nodes,e)}parseMarkup(t){let e;let i=[];if(t=t.trim().replace(/ style=(["'])/g," data-style=$1"),f)e=new DOMParser().parseFromString(g?g.createHTML(t):t,"text/html");else{let i=s("div");i.innerHTML=t,e={body:i}}let r=(t,e)=>{let i=t.nodeName.toLowerCase(),o={tagName:i};"#text"===i&&(o.textContent=t.textContent||"");let s=t.attributes;if(s){let t={};[].forEach.call(s,e=>{"data-style"===e.name?o.style=m.parseStyle(e.value):t[e.name]=e.value}),o.attributes=t}if(t.childNodes.length){let e=[];[].forEach.call(t.childNodes,t=>{r(t,e)}),e.length&&(o.children=e)}e.push(o)};return[].forEach.call(e.body.childNodes,t=>r(t,i)),i}}return m.allowedAttributes=["alt","aria-controls","aria-describedby","aria-expanded","aria-haspopup","aria-hidden","aria-label","aria-labelledby","aria-live","aria-pressed","aria-readonly","aria-roledescription","aria-selected","class","clip-path","color","colspan","cx","cy","d","dx","dy","disabled","fill","filterUnits","flood-color","flood-opacity","height","href","id","in","markerHeight","markerWidth","offset","opacity","orient","padding","paddingLeft","paddingRight","patternUnits","r","refX","refY","role","scope","slope","src","startOffset","stdDeviation","stroke","stroke-linecap","stroke-width","style","tableValues","result","rowspan","summary","target","tabindex","text-align","text-anchor","textAnchor","textLength","title","type","valign","width","x","x1","x2","xlink:href","y","y1","y2","zIndex"],m.allowedReferences=["https://","http://","mailto:","/","../","./","#"],m.allowedTags=["a","abbr","b","br","button","caption","circle","clipPath","code","dd","defs","div","dl","dt","em","feComponentTransfer","feDropShadow","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feOffset","feMerge","feMergeNode","filter","h1","h2","h3","h4","h5","h6","hr","i","img","li","linearGradient","marker","ol","p","path","pattern","pre","rect","small","span","stop","strong","style","sub","sup","svg","table","text","textPath","thead","title","tbody","tspan","td","th","tr","u","ul","#text"],m.emptyHTML=p,m.bypassHTMLFiltering=!1,m}),i(e,"Core/Templating.js",[e["Core/Defaults.js"],e["Core/Utilities.js"]],function(t,e){let{defaultOptions:i,defaultTime:r}=t,{extend:o,getNestedProperty:s,isArray:n,isNumber:a,isObject:l,pick:h,pInt:c}=e,d={add:(t,e)=>t+e,divide:(t,e)=>0!==e?t/e:"",eq:(t,e)=>t==e,each:function(t){let e=arguments[arguments.length-1];return!!n(t)&&t.map((i,r)=>u(e.body,o(l(i)?i:{"@this":i},{"@index":r,"@first":0===r,"@last":r===t.length-1}))).join("")},ge:(t,e)=>t>=e,gt:(t,e)=>t>e,if:t=>!!t,le:(t,e)=>t<=e,lt:(t,e)=>t<e,multiply:(t,e)=>t*e,ne:(t,e)=>t!=e,subtract:(t,e)=>t-e,unless:t=>!t};function u(t="",e,o){let n=/\{([a-zA-Z0-9\:\.\,;\-\/<>%_@"'= #\(\)]+)\}/g,a=/\(([a-zA-Z0-9\:\.\,;\-\/<>%_@"'= ]+)\)/g,l=[],c=/f$/,p=/\.([0-9])/,f=i.lang,m=o&&o.time||r,y=o&&o.numberFormatter||g,w=(t="")=>{let i;return"true"===t||"false"!==t&&((i=Number(t)).toString()===t?i:s(t,e))},b,C,S=0,x;for(;null!==(b=n.exec(t));){let i=a.exec(b[1]);i&&(b=i,x=!0),C&&C.isBlock||(C={ctx:e,expression:b[1],find:b[0],isBlock:"#"===b[1].charAt(0),start:b.index,startInner:b.index+b[0].length,length:b[0].length});let r=b[1].split(" ")[0].replace("#","");d[r]&&(C.isBlock&&r===C.fn&&S++,C.fn||(C.fn=r));let o="else"===b[1];if(C.isBlock&&C.fn&&(b[1]===`/${C.fn}`||o)){if(S)!o&&S--;else{let e=C.startInner,i=t.substr(e,b.index-e);void 0===C.body?(C.body=i,C.startInner=b.index+b[0].length):C.elseBody=i,C.find+=i+b[0],o||(l.push(C),C=void 0)}}else C.isBlock||l.push(C);if(i&&!C?.isBlock)break}return l.forEach(i=>{let r,o;let{body:s,elseBody:n,expression:a,fn:l}=i;if(l){let t=[i],h=a.split(" ");for(o=d[l].length;o--;)t.unshift(w(h[o+1]));r=d[l].apply(e,t),i.isBlock&&"boolean"==typeof r&&(r=u(r?s:n,e))}else{let t=a.split(":");if(r=w(t.shift()||""),t.length&&"number"==typeof r){let e=t.join(":");if(c.test(e)){let t=parseInt((e.match(p)||["","-1"])[1],10);null!==r&&(r=y(r,t,f.decimalPoint,e.indexOf(",")>-1?f.thousandsSep:""))}else r=m.dateFormat(e,r)}}t=t.replace(i.find,h(r,""))}),x?u(t,e,o):t}function g(t,e,r,o){let s,n;t=+t||0,e=+e;let l=i.lang,d=(t.toString().split(".")[1]||"").split("e")[0].length,u=t.toString().split("e"),g=e;-1===e?e=Math.min(d,20):a(e)?e&&u[1]&&u[1]<0&&((n=e+ +u[1])>=0?(u[0]=(+u[0]).toExponential(n).split("e")[0],e=n):(u[0]=u[0].split(".")[0]||0,t=e<20?(u[0]*Math.pow(10,u[1])).toFixed(e):0,u[1]=0)):e=2;let p=(Math.abs(u[1]?u[0]:t)+Math.pow(10,-Math.max(e,d)-1)).toFixed(e),f=String(c(p)),m=f.length>3?f.length%3:0;return r=h(r,l.decimalPoint),o=h(o,l.thousandsSep),s=(t<0?"-":"")+(m?f.substr(0,m)+o:""),0>+u[1]&&!g?s="0":s+=f.substr(m).replace(/(\d{3})(?=\d)/g,"$1"+o),e&&(s+=r+p.slice(-e)),u[1]&&0!=+s&&(s+="e"+u[1]),s}return{dateFormat:function(t,e,i){return r.dateFormat(t,e,i)},format:u,helpers:d,numberFormat:g}}),i(e,"Core/Renderer/RendererRegistry.js",[e["Core/Globals.js"]],function(t){var e,i;let r;return(i=e||(e={})).rendererTypes={},i.getRendererType=function(t=r){return i.rendererTypes[t]||i.rendererTypes[r]},i.registerRendererType=function(e,o,s){i.rendererTypes[e]=o,(!r||s)&&(r=e,t.Renderer=o)},e}),i(e,"Core/Renderer/RendererUtilities.js",[e["Core/Utilities.js"]],function(t){var e;let{clamp:i,pick:r,pushUnique:o,stableSort:s}=t;return(e||(e={})).distribute=function t(e,n,a){let l=e,h=l.reducedLen||n,c=(t,e)=>t.target-e.target,d=[],u=e.length,g=[],p=d.push,f,m,y,w=!0,b,C,S=0,x;for(f=u;f--;)S+=e[f].size;if(S>h){for(s(e,(t,e)=>(e.rank||0)-(t.rank||0)),y=(x=e[0].rank===e[e.length-1].rank)?u/2:-1,m=x?y:u-1;y&&S>h;)b=e[f=Math.floor(m)],o(g,f)&&(S-=b.size),m+=y,x&&m>=e.length&&(y/=2,m=y);g.sort((t,e)=>e-t).forEach(t=>p.apply(d,e.splice(t,1)))}for(s(e,c),e=e.map(t=>({size:t.size,targets:[t.target],align:r(t.align,.5)}));w;){for(f=e.length;f--;)b=e[f],C=(Math.min.apply(0,b.targets)+Math.max.apply(0,b.targets))/2,b.pos=i(C-b.size*b.align,0,n-b.size);for(f=e.length,w=!1;f--;)f>0&&e[f-1].pos+e[f-1].size>e[f].pos&&(e[f-1].size+=e[f].size,e[f-1].targets=e[f-1].targets.concat(e[f].targets),e[f-1].align=.5,e[f-1].pos+e[f-1].size>n&&(e[f-1].pos=n-e[f-1].size),e.splice(f,1),w=!0)}return p.apply(l,d),f=0,e.some(e=>{let i=0;return(e.targets||[]).some(()=>(l[f].pos=e.pos+i,void 0!==a&&Math.abs(l[f].pos-l[f].target)>a)?(l.slice(0,f+1).forEach(t=>delete t.pos),l.reducedLen=(l.reducedLen||n)-.1*n,l.reducedLen>.1*n&&t(l,n,a),!0):(i+=l[f].size,f++,!1))}),s(l,c),l},e}),i(e,"Core/Renderer/SVG/SVGElement.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Color/Color.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(t,e,i,r){let{animate:o,animObject:s,stop:n}=t,{deg2rad:a,doc:l,svg:h,SVG_NS:c,win:d}=i,{addEvent:u,attr:g,createElement:p,css:f,defined:m,erase:y,extend:w,fireEvent:b,isArray:C,isFunction:S,isObject:x,isString:E,merge:R,objectEach:T,pick:M,pInt:k,replaceNested:A,syncTimeout:O,uniqueKey:P}=r;class I{_defaultGetter(t){let e=M(this[t+"Value"],this[t],this.element?this.element.getAttribute(t):null,0);return/^[\-0-9\.]+$/.test(e)&&(e=parseFloat(e)),e}_defaultSetter(t,e,i){i.setAttribute(e,t)}add(t){let e;let i=this.renderer,r=this.element;return t&&(this.parentGroup=t),void 0!==this.textStr&&"text"===this.element.nodeName&&i.buildText(this),this.added=!0,(!t||t.handleZ||this.zIndex)&&(e=this.zIndexSetter()),e||(t?t.element:i.box).appendChild(r),this.onAdd&&this.onAdd(),this}addClass(t,e){let i=e?"":this.attr("class")||"";return(t=(t||"").split(/ /g).reduce(function(t,e){return -1===i.indexOf(e)&&t.push(e),t},i?[i]:[]).join(" "))!==i&&this.attr("class",t),this}afterSetters(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)}align(t,e,i,r=!0){let o,s,n,a,l;let h={},c=this.renderer,d=c.alignedObjects;t?(this.alignOptions=t,this.alignByTranslate=e,(!i||E(i))&&(this.alignTo=n=i||"renderer",y(d,this),d.push(this),i=void 0)):(t=this.alignOptions,e=this.alignByTranslate,n=this.alignTo),i=M(i,c[n],c);let u=t.align,g=t.verticalAlign;return o=(i.x||0)+(t.x||0),s=(i.y||0)+(t.y||0),"right"===u?a=1:"center"===u&&(a=2),a&&(o+=(i.width-(t.width||0))/a),h[e?"translateX":"x"]=Math.round(o),"bottom"===g?l=1:"middle"===g&&(l=2),l&&(s+=(i.height-(t.height||0))/l),h[e?"translateY":"y"]=Math.round(s),r&&(this[this.placed?"animate":"attr"](h),this.placed=!0),this.alignAttr=h,this}alignSetter(t){let e={left:"start",center:"middle",right:"end"};e[t]&&(this.alignValue=t,this.element.setAttribute("text-anchor",e[t]))}animate(t,e,i){let r=s(M(e,this.renderer.globalAnimation,!0)),n=r.defer;return l.hidden&&(r.duration=0),0!==r.duration?(i&&(r.complete=i),O(()=>{this.element&&o(this,t,r)},n)):(this.attr(t,void 0,i||r.complete),T(t,function(t,e){r.step&&r.step.call(this,t,{prop:e,pos:1,elem:this})},this)),this}applyTextOutline(t){let e=this.element;-1!==t.indexOf("contrast")&&(t=t.replace(/contrast/g,this.renderer.getContrast(e.style.fill)));let r=t.split(" "),o=r[r.length-1],s=r[0];if(s&&"none"!==s&&i.svg){this.fakeTS=!0,s=s.replace(/(^[\d\.]+)(.*?)$/g,function(t,e,i){return 2*Number(e)+i}),this.removeTextOutline();let t=l.createElementNS(c,"tspan");g(t,{class:"highcharts-text-outline",fill:o,stroke:o,"stroke-width":s,"stroke-linejoin":"round"});let i=e.querySelector("textPath")||e;[].forEach.call(i.childNodes,e=>{let i=e.cloneNode(!0);i.removeAttribute&&["fill","stroke","stroke-width","stroke"].forEach(t=>i.removeAttribute(t)),t.appendChild(i)});let r=0;[].forEach.call(i.querySelectorAll("text tspan"),t=>{r+=Number(t.getAttribute("dy"))});let n=l.createElementNS(c,"tspan");n.textContent="",g(n,{x:Number(e.getAttribute("x")),dy:-r}),t.appendChild(n),i.insertBefore(t,i.firstChild)}}attr(t,e,i,r){let o=this.element,s=I.symbolCustomAttribs,a,l,h=this,c;return"string"==typeof t&&void 0!==e&&(a=t,(t={})[a]=e),"string"==typeof t?h=(this[t+"Getter"]||this._defaultGetter).call(this,t,o):(T(t,function(e,i){c=!1,r||n(this,i),this.symbolName&&-1!==s.indexOf(i)&&(l||(this.symbolAttr(t),l=!0),c=!0),this.rotation&&("x"===i||"y"===i)&&(this.doTransform=!0),c||(this[i+"Setter"]||this._defaultSetter).call(this,e,i,o)},this),this.afterSetters()),i&&i.call(this),h}clip(t){if(t&&!t.clipPath){let e=P()+"-",i=this.renderer.createElement("clipPath").attr({id:e}).add(this.renderer.defs);w(t,{clipPath:i,id:e,count:0}),t.add(i)}return this.attr("clip-path",t?`url(${this.renderer.url}#${t.id})`:"none")}crisp(t,e){let i=Math.round(e=e||t.strokeWidth||0)%2/2;return t.x=Math.floor(t.x||this.x||0)+i,t.y=Math.floor(t.y||this.y||0)+i,t.width=Math.floor((t.width||this.width||0)-2*i),t.height=Math.floor((t.height||this.height||0)-2*i),m(t.strokeWidth)&&(t.strokeWidth=e),t}complexColor(t,i,r){let o=this.renderer,s,n,a,l,h,c,d,u,g,p,f=[],y;b(this.renderer,"complexColor",{args:arguments},function(){if(t.radialGradient?n="radialGradient":t.linearGradient&&(n="linearGradient"),n){if(a=t[n],h=o.gradients,c=t.stops,g=r.radialReference,C(a)&&(t[n]=a={x1:a[0],y1:a[1],x2:a[2],y2:a[3],gradientUnits:"userSpaceOnUse"}),"radialGradient"===n&&g&&!m(a.gradientUnits)&&(l=a,a=R(a,o.getRadialAttr(g,l),{gradientUnits:"userSpaceOnUse"})),T(a,function(t,e){"id"!==e&&f.push(e,t)}),T(c,function(t){f.push(t)}),h[f=f.join(",")])p=h[f].attr("id");else{a.id=p=P();let t=h[f]=o.createElement(n).attr(a).add(o.defs);t.radAttr=l,t.stops=[],c.forEach(function(i){0===i[1].indexOf("rgba")?(d=(s=e.parse(i[1])).get("rgb"),u=s.get("a")):(d=i[1],u=1);let r=o.createElement("stop").attr({offset:i[0],"stop-color":d,"stop-opacity":u}).add(t);t.stops.push(r)})}y="url("+o.url+"#"+p+")",r.setAttribute(i,y),r.gradient=f,t.toString=function(){return y}}})}css(t){let e=this.styles,i={},r=this.element,o,s=!e;if(e&&T(t,function(t,r){e&&e[r]!==t&&(i[r]=t,s=!0)}),s){e&&(t=w(e,i)),null===t.width||"auto"===t.width?delete this.textWidth:"text"===r.nodeName.toLowerCase()&&t.width&&(o=this.textWidth=k(t.width)),w(this.styles,t),o&&!h&&this.renderer.forExport&&delete t.width;let s=R(t);r.namespaceURI===this.SVG_NS&&(["textOutline","textOverflow","width"].forEach(t=>s&&delete s[t]),s.color&&(s.fill=s.color)),f(r,s)}return this.added&&("text"===this.element.nodeName&&this.renderer.buildText(this),t.textOutline&&this.applyTextOutline(t.textOutline)),this}dashstyleSetter(t){let e,i=this["stroke-width"];if("inherit"===i&&(i=1),t=t&&t.toLowerCase()){let r=t.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(e=r.length;e--;)r[e]=""+k(r[e])*M(i,NaN);t=r.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",t)}}destroy(){let t=this,e=t.element||{},i=t.renderer,r=e.ownerSVGElement,o="SPAN"===e.nodeName&&t.parentGroup||void 0,s,a;if(e.onclick=e.onmouseout=e.onmouseover=e.onmousemove=e.point=null,n(t),t.clipPath&&r){let e=t.clipPath;[].forEach.call(r.querySelectorAll("[clip-path],[CLIP-PATH]"),function(t){t.getAttribute("clip-path").indexOf(e.element.id)>-1&&t.removeAttribute("clip-path")}),t.clipPath=e.destroy()}if(t.connector=t.connector?.destroy(),t.stops){for(a=0;a<t.stops.length;a++)t.stops[a].destroy();t.stops.length=0,t.stops=void 0}for(t.safeRemoveChild(e);o&&o.div&&0===o.div.childNodes.length;)s=o.parentGroup,t.safeRemoveChild(o.div),delete o.div,o=s;t.alignTo&&y(i.alignedObjects,t),T(t,function(e,i){t[i]&&t[i].parentGroup===t&&t[i].destroy&&t[i].destroy(),delete t[i]})}dSetter(t,e,i){C(t)&&("string"==typeof t[0]&&(t=this.renderer.pathToSegments(t)),this.pathArray=t,t=t.reduce((t,e,i)=>e&&e.join?(i?t+" ":"")+e.join(" "):(e||"").toString(),"")),/(NaN| {2}|^$)/.test(t)&&(t="M 0 0"),this[e]!==t&&(i.setAttribute(e,t),this[e]=t)}fillSetter(t,e,i){"string"==typeof t?i.setAttribute(e,t):t&&this.complexColor(t,e,i)}hrefSetter(t,e,i){i.setAttributeNS("http://www.w3.org/1999/xlink",e,t)}getBBox(t,e){let i,r,o,s;let{alignValue:n,element:a,renderer:l,styles:h,textStr:c}=this,{cache:d,cacheKeys:u}=l,g=a.namespaceURI===this.SVG_NS,p=M(e,this.rotation,0),y=l.styledMode?a&&I.prototype.getStyle.call(a,"font-size"):h.fontSize;if(m(c)&&(-1===(s=c.toString()).indexOf("<")&&(s=s.replace(/[0-9]/g,"0")),s+=["",l.rootFontSize,y,p,this.textWidth,n,h.textOverflow,h.fontWeight].join(",")),s&&!t&&(i=d[s]),!i){if(g||l.forExport){try{o=this.fakeTS&&function(t){let e=a.querySelector(".highcharts-text-outline");e&&f(e,{display:t})},S(o)&&o("none"),i=a.getBBox?w({},a.getBBox()):{width:a.offsetWidth,height:a.offsetHeight,x:0,y:0},S(o)&&o("")}catch(t){}(!i||i.width<0)&&(i={x:0,y:0,width:0,height:0})}else i=this.htmlGetBBox();r=i.height,g&&(i.height=r=({"11px,17":14,"13px,20":16})[`${y||""},${Math.round(r)}`]||r),p&&(i=this.getRotatedBox(i,p))}if(s&&(""===c||i.height>0)){for(;u.length>250;)delete d[u.shift()];d[s]||u.push(s),d[s]=i}return i}getRotatedBox(t,e){let{x:i,y:r,width:o,height:s}=t,{alignValue:n,translateY:l,rotationOriginX:h=0,rotationOriginY:c=0}=this,d={right:1,center:.5}[n||0]||0,u=Number(this.element.getAttribute("y")||0)-(l?0:r),g=e*a,p=(e-90)*a,f=Math.cos(g),m=Math.sin(g),y=o*f,w=o*m,b=Math.cos(p),C=Math.sin(p),[[S,x],[E,R]]=[h,c].map(t=>[t-t*f,t*m]),T=i+d*(o-y)+S+R+u*b,M=T+y,k=M-s*b,A=k-y,O=r+u-d*w-x+E+u*C,P=O+w,I=P-s*C,H=I-w,L=Math.min(T,M,k,A),D=Math.min(O,P,I,H),N=Math.max(T,M,k,A)-L,_=Math.max(O,P,I,H)-D;return{x:L,y:D,width:N,height:_}}getStyle(t){return d.getComputedStyle(this.element||this,"").getPropertyValue(t)}hasClass(t){return -1!==(""+this.attr("class")).split(" ").indexOf(t)}hide(){return this.attr({visibility:"hidden"})}htmlGetBBox(){return{height:0,width:0,x:0,y:0}}constructor(t,e){this.onEvents={},this.opacity=1,this.SVG_NS=c,this.element="span"===e||"body"===e?p(e):l.createElementNS(this.SVG_NS,e),this.renderer=t,this.styles={},b(this,"afterInit")}on(t,e){let{onEvents:i}=this;return i[t]&&i[t](),i[t]=u(this.element,t,e),this}opacitySetter(t,e,i){let r=Number(Number(t).toFixed(3));this.opacity=r,i.setAttribute(e,r)}removeClass(t){return this.attr("class",(""+this.attr("class")).replace(E(t)?RegExp(`(^| )${t}( |$)`):t," ").replace(/ +/g," ").trim())}removeTextOutline(){let t=this.element.querySelector("tspan.highcharts-text-outline");t&&this.safeRemoveChild(t)}safeRemoveChild(t){let e=t.parentNode;e&&e.removeChild(t)}setRadialReference(t){let e=this.element.gradient&&this.renderer.gradients[this.element.gradient];return this.element.radialReference=t,e&&e.radAttr&&e.animate(this.renderer.getRadialAttr(t,e.radAttr)),this}setTextPath(t,e){e=R(!0,{enabled:!0,attributes:{dy:-5,startOffset:"50%",textAnchor:"middle"}},e);let i=this.renderer.url,r=this.text||this,o=r.textPath,{attributes:s,enabled:n}=e;if(t=t||o&&o.path,o&&o.undo(),t&&n){let e=u(r,"afterModifyTree",e=>{if(t&&n){let o=t.attr("id");o||t.attr("id",o=P());let n={x:0,y:0};m(s.dx)&&(n.dx=s.dx,delete s.dx),m(s.dy)&&(n.dy=s.dy,delete s.dy),r.attr(n),this.attr({transform:""}),this.box&&(this.box=this.box.destroy());let a=e.nodes.slice(0);e.nodes.length=0,e.nodes[0]={tagName:"textPath",attributes:w(s,{"text-anchor":s.textAnchor,href:`${i}#${o}`}),children:a}}});r.textPath={path:t,undo:e}}else r.attr({dx:0,dy:0}),delete r.textPath;return this.added&&(r.textCache="",this.renderer.buildText(r)),this}shadow(t){let{renderer:e}=this,i=R(this.parentGroup?.rotation===90?{offsetX:-1,offsetY:-1}:{},x(t)?t:{}),r=e.shadowDefinition(i);return this.attr({filter:t?`url(${e.url}#${r})`:"none"})}show(t=!0){return this.attr({visibility:t?"inherit":"visible"})}"stroke-widthSetter"(t,e,i){this[e]=t,i.setAttribute(e,t)}strokeWidth(){if(!this.renderer.styledMode)return this["stroke-width"]||0;let t=this.getStyle("stroke-width"),e=0,i;return/px$/.test(t)?e=k(t):""!==t&&(g(i=l.createElementNS(c,"rect"),{width:t,"stroke-width":0}),this.element.parentNode.appendChild(i),e=i.getBBox().width,i.parentNode.removeChild(i)),e}symbolAttr(t){let e=this;I.symbolCustomAttribs.forEach(function(i){e[i]=M(t[i],e[i])}),e.attr({d:e.renderer.symbols[e.symbolName](e.x,e.y,e.width,e.height,e)})}textSetter(t){t!==this.textStr&&(delete this.textPxLength,this.textStr=t,this.added&&this.renderer.buildText(this))}titleSetter(t){let e=this.element,i=e.getElementsByTagName("title")[0]||l.createElementNS(this.SVG_NS,"title");e.insertBefore?e.insertBefore(i,e.firstChild):e.appendChild(i),i.textContent=A(M(t,""),[/<[^>]*>/g,""]).replace(/&lt;/g,"<").replace(/&gt;/g,">")}toFront(){let t=this.element;return t.parentNode.appendChild(t),this}translate(t,e){return this.attr({translateX:t,translateY:e})}updateTransform(t="transform"){let{element:e,matrix:i,rotation:r=0,rotationOriginX:o,rotationOriginY:s,scaleX:n,scaleY:a,translateX:l=0,translateY:h=0}=this,c=["translate("+l+","+h+")"];m(i)&&c.push("matrix("+i.join(",")+")"),r&&(c.push("rotate("+r+" "+M(o,e.getAttribute("x"),0)+" "+M(s,e.getAttribute("y")||0)+")"),this.text?.element.tagName==="SPAN"&&this.text.attr({rotation:r,rotationOriginX:(o||0)-this.padding,rotationOriginY:(s||0)-this.padding})),(m(n)||m(a))&&c.push("scale("+M(n,1)+" "+M(a,1)+")"),c.length&&!(this.text||this).textPath&&e.setAttribute(t,c.join(" "))}visibilitySetter(t,e,i){"inherit"===t?i.removeAttribute(e):this[e]!==t&&i.setAttribute(e,t),this[e]=t}xGetter(t){return"circle"===this.element.nodeName&&("x"===t?t="cx":"y"===t&&(t="cy")),this._defaultGetter(t)}zIndexSetter(t,e){let i=this.renderer,r=this.parentGroup,o=(r||i).element||i.box,s=this.element,n=o===i.box,a,l,h,c=!1,d,u=this.added,g;if(m(t)?(s.setAttribute("data-z-index",t),t=+t,this[e]===t&&(u=!1)):m(this[e])&&s.removeAttribute("data-z-index"),this[e]=t,u){for((t=this.zIndex)&&r&&(r.handleZ=!0),g=(a=o.childNodes).length-1;g>=0&&!c;g--)d=!m(h=(l=a[g]).getAttribute("data-z-index")),l!==s&&(t<0&&d&&!n&&!g?(o.insertBefore(s,a[g]),c=!0):(k(h)<=t||d&&(!m(t)||t>=0))&&(o.insertBefore(s,a[g+1]),c=!0));c||(o.insertBefore(s,a[n?3:0]),c=!0)}return c}}return I.symbolCustomAttribs=["anchorX","anchorY","clockwise","end","height","innerR","r","start","width","x","y"],I.prototype.strokeSetter=I.prototype.fillSetter,I.prototype.yGetter=I.prototype.xGetter,I.prototype.matrixSetter=I.prototype.rotationOriginXSetter=I.prototype.rotationOriginYSetter=I.prototype.rotationSetter=I.prototype.scaleXSetter=I.prototype.scaleYSetter=I.prototype.translateXSetter=I.prototype.translateYSetter=I.prototype.verticalAlignSetter=function(t,e){this[e]=t,this.doTransform=!0},I}),i(e,"Core/Renderer/SVG/SVGLabel.js",[e["Core/Renderer/SVG/SVGElement.js"],e["Core/Utilities.js"]],function(t,e){let{defined:i,extend:r,isNumber:o,merge:s,pick:n,removeEvent:a}=e;class l extends t{constructor(t,e,i,r,o,s,n,a,h,c){let d;super(t,"g"),this.paddingLeftSetter=this.paddingSetter,this.paddingRightSetter=this.paddingSetter,this.textStr=e,this.x=i,this.y=r,this.anchorX=s,this.anchorY=n,this.baseline=h,this.className=c,this.addClass("button"===c?"highcharts-no-tooltip":"highcharts-label"),c&&this.addClass("highcharts-"+c),this.text=t.text(void 0,0,0,a).attr({zIndex:1}),"string"==typeof o&&((d=/^url\((.*?)\)$/.test(o))||this.renderer.symbols[o])&&(this.symbolKey=o),this.bBox=l.emptyBBox,this.padding=3,this.baselineOffset=0,this.needsBox=t.styledMode||d,this.deferredAttr={},this.alignFactor=0}alignSetter(t){let e={left:0,center:.5,right:1}[t];e!==this.alignFactor&&(this.alignFactor=e,this.bBox&&o(this.xSetting)&&this.attr({x:this.xSetting}))}anchorXSetter(t,e){this.anchorX=t,this.boxAttr(e,Math.round(t)-this.getCrispAdjust()-this.xSetting)}anchorYSetter(t,e){this.anchorY=t,this.boxAttr(e,t-this.ySetting)}boxAttr(t,e){this.box?this.box.attr(t,e):this.deferredAttr[t]=e}css(e){if(e){let t={};e=s(e),l.textProps.forEach(i=>{void 0!==e[i]&&(t[i]=e[i],delete e[i])}),this.text.css(t),"fontSize"in t||"fontWeight"in t?this.updateTextPadding():("width"in t||"textOverflow"in t)&&this.updateBoxSize()}return t.prototype.css.call(this,e)}destroy(){a(this.element,"mouseenter"),a(this.element,"mouseleave"),this.text&&this.text.destroy(),this.box&&(this.box=this.box.destroy()),t.prototype.destroy.call(this)}fillSetter(t,e){t&&(this.needsBox=!0),this.fill=t,this.boxAttr(e,t)}getBBox(t,e){this.textStr&&0===this.bBox.width&&0===this.bBox.height&&this.updateBoxSize();let{padding:i,height:r=0,translateX:o=0,translateY:s=0,width:a=0}=this,l=n(this.paddingLeft,i),h=e??(this.rotation||0),c={width:a,height:r,x:o+this.bBox.x-l,y:s+this.bBox.y-i+this.baselineOffset};return h&&(c=this.getRotatedBox(c,h)),c}getCrispAdjust(){return this.renderer.styledMode&&this.box?this.box.strokeWidth()%2/2:(this["stroke-width"]?parseInt(this["stroke-width"],10):0)%2/2}heightSetter(t){this.heightSetting=t}onAdd(){this.text.add(this),this.attr({text:n(this.textStr,""),x:this.x||0,y:this.y||0}),this.box&&i(this.anchorX)&&this.attr({anchorX:this.anchorX,anchorY:this.anchorY})}paddingSetter(t,e){o(t)?t!==this[e]&&(this[e]=t,this.updateTextPadding()):this[e]=void 0}rSetter(t,e){this.boxAttr(e,t)}strokeSetter(t,e){this.stroke=t,this.boxAttr(e,t)}"stroke-widthSetter"(t,e){t&&(this.needsBox=!0),this["stroke-width"]=t,this.boxAttr(e,t)}"text-alignSetter"(t){this.textAlign=t}textSetter(t){void 0!==t&&this.text.attr({text:t}),this.updateTextPadding()}updateBoxSize(){let t;let e=this.text,s={},n=this.padding,a=this.bBox=(!o(this.widthSetting)||!o(this.heightSetting)||this.textAlign)&&i(e.textStr)?e.getBBox(void 0,0):l.emptyBBox;this.width=this.getPaddedWidth(),this.height=(this.heightSetting||a.height||0)+2*n;let h=this.renderer.fontMetrics(e);if(this.baselineOffset=n+Math.min((this.text.firstLineMetrics||h).b,a.height||1/0),this.heightSetting&&(this.baselineOffset+=(this.heightSetting-h.h)/2),this.needsBox&&!e.textPath){if(!this.box){let t=this.box=this.symbolKey?this.renderer.symbol(this.symbolKey):this.renderer.rect();t.addClass(("button"===this.className?"":"highcharts-label-box")+(this.className?" highcharts-"+this.className+"-box":"")),t.add(this)}t=this.getCrispAdjust(),s.x=t,s.y=(this.baseline?-this.baselineOffset:0)+t,s.width=Math.round(this.width),s.height=Math.round(this.height),this.box.attr(r(s,this.deferredAttr)),this.deferredAttr={}}}updateTextPadding(){let t=this.text;if(!t.textPath){this.updateBoxSize();let e=this.baseline?0:this.baselineOffset,r=n(this.paddingLeft,this.padding);i(this.widthSetting)&&this.bBox&&("center"===this.textAlign||"right"===this.textAlign)&&(r+=({center:.5,right:1})[this.textAlign]*(this.widthSetting-this.bBox.width)),(r!==t.x||e!==t.y)&&(t.attr("x",r),t.hasBoxWidthChanged&&(this.bBox=t.getBBox(!0)),void 0!==e&&t.attr("y",e)),t.x=r,t.y=e}}widthSetter(t){this.widthSetting=o(t)?t:void 0}getPaddedWidth(){let t=this.padding,e=n(this.paddingLeft,t),i=n(this.paddingRight,t);return(this.widthSetting||this.bBox.width||0)+e+i}xSetter(t){this.x=t,this.alignFactor&&(t-=this.alignFactor*this.getPaddedWidth(),this["forceAnimate:x"]=!0),this.xSetting=Math.round(t),this.attr("translateX",this.xSetting)}ySetter(t){this.ySetting=this.y=Math.round(t),this.attr("translateY",this.ySetting)}}return l.emptyBBox={width:0,height:0,x:0,y:0},l.textProps=["color","direction","fontFamily","fontSize","fontStyle","fontWeight","lineHeight","textAlign","textDecoration","textOutline","textOverflow","whiteSpace","width"],l}),i(e,"Core/Renderer/SVG/Symbols.js",[e["Core/Utilities.js"]],function(t){let{defined:e,isNumber:i,pick:r}=t;function o(t,i,o,s,n){let a=[];if(n){let l=n.start||0,h=r(n.r,o),c=r(n.r,s||o),d=.001>Math.abs((n.end||0)-l-2*Math.PI),u=(n.end||0)-.001,g=n.innerR,p=r(n.open,d),f=Math.cos(l),m=Math.sin(l),y=Math.cos(u),w=Math.sin(u),b=r(n.longArc,u-l-Math.PI<.001?0:1),C=["A",h,c,0,b,r(n.clockwise,1),t+h*y,i+c*w];C.params={start:l,end:u,cx:t,cy:i},a.push(["M",t+h*f,i+c*m],C),e(g)&&((C=["A",g,g,0,b,e(n.clockwise)?1-n.clockwise:0,t+g*f,i+g*m]).params={start:u,end:l,cx:t,cy:i},a.push(p?["M",t+g*y,i+g*w]:["L",t+g*y,i+g*w],C)),p||a.push(["Z"])}return a}function s(t,e,i,r,o){return o&&o.r?n(t,e,i,r,o):[["M",t,e],["L",t+i,e],["L",t+i,e+r],["L",t,e+r],["Z"]]}function n(t,e,i,r,o){let s=o?.r||0;return[["M",t+s,e],["L",t+i-s,e],["A",s,s,0,0,1,t+i,e+s],["L",t+i,e+r-s],["A",s,s,0,0,1,t+i-s,e+r],["L",t+s,e+r],["A",s,s,0,0,1,t,e+r-s],["L",t,e+s],["A",s,s,0,0,1,t+s,e],["Z"]]}return{arc:o,callout:function(t,e,r,o,s){let a=Math.min(s&&s.r||0,r,o),l=a+6,h=s&&s.anchorX,c=s&&s.anchorY||0,d=n(t,e,r,o,{r:a});if(!i(h)||h<r&&h>0&&c<o&&c>0)return d;if(t+h>r-l){if(c>e+l&&c<e+o-l)d.splice(3,1,["L",t+r,c-6],["L",t+r+6,c],["L",t+r,c+6],["L",t+r,e+o-a]);else if(h<r){let i=c<e+l,s=i?e:e+o;d.splice(i?2:5,0,["L",h,c],["L",t+r-a,s])}else d.splice(3,1,["L",t+r,o/2],["L",h,c],["L",t+r,o/2],["L",t+r,e+o-a])}else if(t+h<l){if(c>e+l&&c<e+o-l)d.splice(7,1,["L",t,c+6],["L",t-6,c],["L",t,c-6],["L",t,e+a]);else if(h>0){let i=c<e+l,r=i?e:e+o;d.splice(i?1:6,0,["L",h,c],["L",t+a,r])}else d.splice(7,1,["L",t,o/2],["L",h,c],["L",t,o/2],["L",t,e+a])}else c>o&&h<r-l?d.splice(5,1,["L",h+6,e+o],["L",h,e+o+6],["L",h-6,e+o],["L",t+a,e+o]):c<0&&h>l&&d.splice(1,1,["L",h-6,e],["L",h,e-6],["L",h+6,e],["L",r-a,e]);return d},circle:function(t,e,i,r){return o(t+i/2,e+r/2,i/2,r/2,{start:.5*Math.PI,end:2.5*Math.PI,open:!1})},diamond:function(t,e,i,r){return[["M",t+i/2,e],["L",t+i,e+r/2],["L",t+i/2,e+r],["L",t,e+r/2],["Z"]]},rect:s,roundedRect:n,square:s,triangle:function(t,e,i,r){return[["M",t+i/2,e],["L",t+i,e+r],["L",t,e+r],["Z"]]},"triangle-down":function(t,e,i,r){return[["M",t,e],["L",t+i,e],["L",t+i/2,e+r],["Z"]]}}}),i(e,"Core/Renderer/SVG/TextBuilder.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(t,e,i){let{doc:r,SVG_NS:o,win:s}=e,{attr:n,extend:a,fireEvent:l,isString:h,objectEach:c,pick:d}=i;return class{constructor(t){let e=t.styles;this.renderer=t.renderer,this.svgElement=t,this.width=t.textWidth,this.textLineHeight=e&&e.lineHeight,this.textOutline=e&&e.textOutline,this.ellipsis=!!(e&&"ellipsis"===e.textOverflow),this.noWrap=!!(e&&"nowrap"===e.whiteSpace)}buildSVG(){let e=this.svgElement,i=e.element,o=e.renderer,s=d(e.textStr,"").toString(),n=-1!==s.indexOf("<"),a=i.childNodes,l=!e.added&&o.box,c=[s,this.ellipsis,this.noWrap,this.textLineHeight,this.textOutline,e.getStyle("font-size"),this.width].join(",");if(c!==e.textCache){e.textCache=c,delete e.actualWidth;for(let t=a.length;t--;)i.removeChild(a[t]);if(n||this.ellipsis||this.width||e.textPath||-1!==s.indexOf(" ")&&(!this.noWrap||/<br.*?>/g.test(s))){if(""!==s){l&&l.appendChild(i);let r=new t(s);this.modifyTree(r.nodes),r.addToDOM(i),this.modifyDOM(),this.ellipsis&&-1!==(i.textContent||"").indexOf("")&&e.attr("title",this.unescapeEntities(e.textStr||"",["&lt;","&gt;"])),l&&l.removeChild(i)}}else i.appendChild(r.createTextNode(this.unescapeEntities(s)));h(this.textOutline)&&e.applyTextOutline&&e.applyTextOutline(this.textOutline)}}modifyDOM(){let t;let e=this.svgElement,i=n(e.element,"x");for(e.firstLineMetrics=void 0;t=e.element.firstChild;)if(/^[\s\u200B]*$/.test(t.textContent||" "))e.element.removeChild(t);else break;[].forEach.call(e.element.querySelectorAll("tspan.highcharts-br"),(t,r)=>{t.nextSibling&&t.previousSibling&&(0===r&&1===t.previousSibling.nodeType&&(e.firstLineMetrics=e.renderer.fontMetrics(t.previousSibling)),n(t,{dy:this.getLineHeight(t.nextSibling),x:i}))});let a=this.width||0;if(!a)return;let l=(t,s)=>{let l=t.textContent||"",h=l.replace(/([^\^])-/g,"$1- ").split(" "),c=!this.noWrap&&(h.length>1||e.element.childNodes.length>1),d=this.getLineHeight(s),u=0,g=e.actualWidth;if(this.ellipsis)l&&this.truncate(t,l,void 0,0,Math.max(0,a-.8*d),(t,e)=>t.substring(0,e)+"");else if(c){let l=[],c=[];for(;s.firstChild&&s.firstChild!==t;)c.push(s.firstChild),s.removeChild(s.firstChild);for(;h.length;)h.length&&!this.noWrap&&u>0&&(l.push(t.textContent||""),t.textContent=h.join(" ").replace(/- /g,"-")),this.truncate(t,void 0,h,0===u&&g||0,a,(t,e)=>h.slice(0,e).join(" ").replace(/- /g,"-")),g=e.actualWidth,u++;c.forEach(e=>{s.insertBefore(e,t)}),l.forEach(e=>{s.insertBefore(r.createTextNode(e),t);let a=r.createElementNS(o,"tspan");a.textContent="",n(a,{dy:d,x:i}),s.insertBefore(a,t)})}},h=t=>{[].slice.call(t.childNodes).forEach(i=>{i.nodeType===s.Node.TEXT_NODE?l(i,t):(-1!==i.className.baseVal.indexOf("highcharts-br")&&(e.actualWidth=0),h(i))})};h(e.element)}getLineHeight(t){let e=t.nodeType===s.Node.TEXT_NODE?t.parentElement:t;return this.textLineHeight?parseInt(this.textLineHeight.toString(),10):this.renderer.fontMetrics(e||this.svgElement.element).h}modifyTree(t){let e=(i,r)=>{let{attributes:o={},children:s,style:n={},tagName:l}=i,h=this.renderer.styledMode;if("b"===l||"strong"===l?h?o.class="highcharts-strong":n.fontWeight="bold":("i"===l||"em"===l)&&(h?o.class="highcharts-emphasized":n.fontStyle="italic"),n&&n.color&&(n.fill=n.color),"br"===l){o.class="highcharts-br",i.textContent="";let e=t[r+1];e&&e.textContent&&(e.textContent=e.textContent.replace(/^ +/gm,""))}else"a"===l&&s&&s.some(t=>"#text"===t.tagName)&&(i.children=[{children:s,tagName:"tspan"}]);"#text"!==l&&"a"!==l&&(i.tagName="tspan"),a(i,{attributes:o,style:n}),s&&s.filter(t=>"#text"!==t.tagName).forEach(e)};t.forEach(e),l(this.svgElement,"afterModifyTree",{nodes:t})}truncate(t,e,i,r,o,s){let n,a;let l=this.svgElement,{rotation:h}=l,c=[],d=i?1:0,u=(e||i||"").length,g=u,p=function(e,o){let s=o||e,n=t.parentNode;if(n&&void 0===c[s]&&n.getSubStringLength)try{c[s]=r+n.getSubStringLength(0,i?s+1:s)}catch(t){}return c[s]};if(l.rotation=0,r+(a=p(t.textContent.length))>o){for(;d<=u;)g=Math.ceil((d+u)/2),i&&(n=s(i,g)),a=p(g,n&&n.length-1),d===u?d=u+1:a>o?u=g-1:d=g;0===u?t.textContent="":e&&u===e.length-1||(t.textContent=n||s(e||i,g))}i&&i.splice(0,g),l.actualWidth=a,l.rotation=h}unescapeEntities(t,e){return c(this.renderer.escapes,function(i,r){e&&-1!==e.indexOf(i)||(t=t.toString().replace(RegExp(i,"g"),r))}),t}}}),i(e,"Core/Renderer/SVG/SVGRenderer.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Color/Color.js"],e["Core/Globals.js"],e["Core/Renderer/RendererRegistry.js"],e["Core/Renderer/SVG/SVGElement.js"],e["Core/Renderer/SVG/SVGLabel.js"],e["Core/Renderer/SVG/Symbols.js"],e["Core/Renderer/SVG/TextBuilder.js"],e["Core/Utilities.js"]],function(t,e,i,r,o,s,n,a,l){let h;let{charts:c,deg2rad:d,doc:u,isFirefox:g,isMS:p,isWebKit:f,noop:m,SVG_NS:y,symbolSizes:w,win:b}=i,{addEvent:C,attr:S,createElement:x,css:E,defined:R,destroyObjectProperties:T,extend:M,isArray:k,isNumber:A,isObject:O,isString:P,merge:I,pick:H,pInt:L,replaceNested:D,uniqueKey:N}=l;class _{constructor(t,e,i,r,o,s,n){let a,l;let h=this.createElement("svg").attr({version:"1.1",class:"highcharts-root"}),c=h.element;n||h.css(this.getStyle(r||{})),t.appendChild(c),S(t,"dir","ltr"),-1===t.innerHTML.indexOf("xmlns")&&S(c,"xmlns",this.SVG_NS),this.box=c,this.boxWrapper=h,this.alignedObjects=[],this.url=this.getReferenceURL(),this.createElement("desc").add().element.appendChild(u.createTextNode("Created with Highcharts 11.4.1")),this.defs=this.createElement("defs").add(),this.allowHTML=s,this.forExport=o,this.styledMode=n,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.rootFontSize=h.getStyle("font-size"),this.setSize(e,i,!1),g&&t.getBoundingClientRect&&((a=function(){E(t,{left:0,top:0}),l=t.getBoundingClientRect(),E(t,{left:Math.ceil(l.left)-l.left+"px",top:Math.ceil(l.top)-l.top+"px"})})(),this.unSubPixelFix=C(b,"resize",a))}definition(e){return new t([e]).addToDOM(this.defs.element)}getReferenceURL(){if((g||f)&&u.getElementsByTagName("base").length){if(!R(h)){let e=N(),i=new t([{tagName:"svg",attributes:{width:8,height:8},children:[{tagName:"defs",children:[{tagName:"clipPath",attributes:{id:e},children:[{tagName:"rect",attributes:{width:4,height:4}}]}]},{tagName:"rect",attributes:{id:"hitme",width:8,height:8,"clip-path":`url(#${e})`,fill:"rgba(0,0,0,0.001)"}}]}]).addToDOM(u.body);E(i,{position:"fixed",top:0,left:0,zIndex:9e5});let r=u.elementFromPoint(6,6);h="hitme"===(r&&r.id),u.body.removeChild(i)}if(h)return D(b.location.href.split("#")[0],[/<[^>]*>/g,""],[/([\('\)])/g,"\\$1"],[/ /g,"%20"])}return""}getStyle(t){return this.style=M({fontFamily:"Helvetica, Arial, sans-serif",fontSize:"1rem"},t),this.style}setStyle(t){this.boxWrapper.css(this.getStyle(t))}isHidden(){return!this.boxWrapper.getBBox().width}destroy(){let t=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),T(this.gradients||{}),this.gradients=null,this.defs=t.destroy(),this.unSubPixelFix&&this.unSubPixelFix(),this.alignedObjects=null,null}createElement(t){return new this.Element(this,t)}getRadialAttr(t,e){return{cx:t[0]-t[2]/2+(e.cx||0)*t[2],cy:t[1]-t[2]/2+(e.cy||0)*t[2],r:(e.r||0)*t[2]}}shadowDefinition(t){let e=[`highcharts-drop-shadow-${this.chartIndex}`,...Object.keys(t).map(e=>`${e}-${t[e]}`)].join("-").toLowerCase().replace(/[^a-z0-9\-]/g,""),i=I({color:"#000000",offsetX:1,offsetY:1,opacity:.15,width:5},t);return this.defs.element.querySelector(`#${e}`)||this.definition({tagName:"filter",attributes:{id:e,filterUnits:i.filterUnits},children:[{tagName:"feDropShadow",attributes:{dx:i.offsetX,dy:i.offsetY,"flood-color":i.color,"flood-opacity":Math.min(5*i.opacity,1),stdDeviation:i.width/2}}]}),e}buildText(t){new a(t).buildSVG()}getContrast(t){let i=e.parse(t).rgba.map(t=>{let e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}),r=.2126*i[0]+.7152*i[1]+.0722*i[2];return 1.05/(r+.05)>(r+.05)/.05?"#FFFFFF":"#000000"}button(e,i,r,o,s={},n,a,l,h,c){let d,u,g;let f=this.label(e,i,r,h,void 0,void 0,c,void 0,"button"),m=this.styledMode,y=s.states||{},w=0;s=I(s),delete s.states;let b=I({color:"#333333",cursor:"pointer",fontSize:"0.8em",fontWeight:"normal"},s.style);delete s.style;let S=t.filterUserAttributes(s);return f.attr(I({padding:8,r:2},S)),m||(S=I({fill:"#f7f7f7",stroke:"#cccccc","stroke-width":1},S),d=(n=I(S,{fill:"#e6e6e6"},t.filterUserAttributes(n||y.hover||{}))).style,delete n.style,u=(a=I(S,{fill:"#e6e9ff",style:{color:"#000000",fontWeight:"bold"}},t.filterUserAttributes(a||y.select||{}))).style,delete a.style,g=(l=I(S,{style:{color:"#cccccc"}},t.filterUserAttributes(l||y.disabled||{}))).style,delete l.style),C(f.element,p?"mouseover":"mouseenter",function(){3!==w&&f.setState(1)}),C(f.element,p?"mouseout":"mouseleave",function(){3!==w&&f.setState(w)}),f.setState=function(t){if(1!==t&&(f.state=w=t),f.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][t||0]),!m){f.attr([S,n,a,l][t||0]);let e=[b,d,u,g][t||0];O(e)&&f.css(e)}},!m&&(f.attr(S).css(M({cursor:"default"},b)),c&&f.text.css({pointerEvents:"none"})),f.on("touchstart",t=>t.stopPropagation()).on("click",function(t){3!==w&&o.call(f,t)})}crispLine(t,e,i="round"){let r=t[0],o=t[1];return R(r[1])&&r[1]===o[1]&&(r[1]=o[1]=Math[i](r[1])-e%2/2),R(r[2])&&r[2]===o[2]&&(r[2]=o[2]=Math[i](r[2])+e%2/2),t}path(t){let e=this.styledMode?{}:{fill:"none"};return k(t)?e.d=t:O(t)&&M(e,t),this.createElement("path").attr(e)}circle(t,e,i){let r=O(t)?t:void 0===t?{}:{x:t,y:e,r:i},o=this.createElement("circle");return o.xSetter=o.ySetter=function(t,e,i){i.setAttribute("c"+e,t)},o.attr(r)}arc(t,e,i,r,o,s){let n;O(t)?(e=(n=t).y,i=n.r,r=n.innerR,o=n.start,s=n.end,t=n.x):n={innerR:r,start:o,end:s};let a=this.symbol("arc",t,e,i,i,n);return a.r=i,a}rect(t,e,i,r,o,s){let n=O(t)?t:void 0===t?{}:{x:t,y:e,r:o,width:Math.max(i||0,0),height:Math.max(r||0,0)},a=this.createElement("rect");return this.styledMode||(void 0!==s&&(n["stroke-width"]=s,M(n,a.crisp(n))),n.fill="none"),a.rSetter=function(t,e,i){a.r=t,S(i,{rx:t,ry:t})},a.rGetter=function(){return a.r||0},a.attr(n)}roundedRect(t){return this.symbol("roundedRect").attr(t)}setSize(t,e,i){this.width=t,this.height=e,this.boxWrapper.animate({width:t,height:e},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:H(i,!0)?void 0:0}),this.alignElements()}g(t){let e=this.createElement("g");return t?e.attr({class:"highcharts-"+t}):e}image(t,e,i,r,o,s){let n={preserveAspectRatio:"none"};A(e)&&(n.x=e),A(i)&&(n.y=i),A(r)&&(n.width=r),A(o)&&(n.height=o);let a=this.createElement("image").attr(n),l=function(e){a.attr({href:t}),s.call(a,e)};if(s){a.attr({href:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="});let e=new b.Image;C(e,"load",l),e.src=t,e.complete&&l({})}else a.attr({href:t});return a}symbol(t,e,i,r,o,s){let n,a,l,h;let d=this,g=/^url\((.*?)\)$/,p=g.test(t),f=!p&&(this.symbols[t]?t:"circle"),m=f&&this.symbols[f];if(m)"number"==typeof e&&(a=m.call(this.symbols,Math.round(e||0),Math.round(i||0),r||0,o||0,s)),n=this.path(a),d.styledMode||n.attr("fill","none"),M(n,{symbolName:f||void 0,x:e,y:i,width:r,height:o}),s&&M(n,s);else if(p){l=t.match(g)[1];let r=n=this.image(l);r.imgwidth=H(s&&s.width,w[l]&&w[l].width),r.imgheight=H(s&&s.height,w[l]&&w[l].height),h=t=>t.attr({width:t.width,height:t.height}),["width","height"].forEach(t=>{r[`${t}Setter`]=function(t,e){this[e]=t;let{alignByTranslate:i,element:r,width:o,height:n,imgwidth:a,imgheight:l}=this,h="width"===e?a:l,c=1;s&&"within"===s.backgroundSize&&o&&n&&a&&l?(c=Math.min(o/a,n/l),S(r,{width:Math.round(a*c),height:Math.round(l*c)})):r&&h&&r.setAttribute(e,h),!i&&a&&l&&this.translate(((o||0)-a*c)/2,((n||0)-l*c)/2)}}),R(e)&&r.attr({x:e,y:i}),r.isImg=!0,R(r.imgwidth)&&R(r.imgheight)?h(r):(r.attr({width:0,height:0}),x("img",{onload:function(){let t=c[d.chartIndex];0===this.width&&(E(this,{position:"absolute",top:"-999em"}),u.body.appendChild(this)),w[l]={width:this.width,height:this.height},r.imgwidth=this.width,r.imgheight=this.height,r.element&&h(r),this.parentNode&&this.parentNode.removeChild(this),d.imgCount--,d.imgCount||!t||t.hasLoaded||t.onload()},src:l}),this.imgCount++)}return n}clipRect(t,e,i,r){return this.rect(t,e,i,r,0)}text(t,e,i,r){let o={};if(r&&(this.allowHTML||!this.forExport))return this.html(t,e,i);o.x=Math.round(e||0),i&&(o.y=Math.round(i)),R(t)&&(o.text=t);let s=this.createElement("text").attr(o);return r&&(!this.forExport||this.allowHTML)||(s.xSetter=function(t,e,i){let r=i.getElementsByTagName("tspan"),o=i.getAttribute(e);for(let i=0,s;i<r.length;i++)(s=r[i]).getAttribute(e)===o&&s.setAttribute(e,t);i.setAttribute(e,t)}),s}fontMetrics(t){let e=L(o.prototype.getStyle.call(t,"font-size")||0),i=e<24?e+3:Math.round(1.2*e),r=Math.round(.8*i);return{h:i,b:r,f:e}}rotCorr(t,e,i){let r=t;return e&&i&&(r=Math.max(r*Math.cos(e*d),4)),{x:-t/3*Math.sin(e*d),y:r}}pathToSegments(t){let e=[],i=[],r={A:8,C:7,H:2,L:3,M:3,Q:5,S:5,T:3,V:2};for(let o=0;o<t.length;o++)P(i[0])&&A(t[o])&&i.length===r[i[0].toUpperCase()]&&t.splice(o,0,i[0].replace("M","L").replace("m","l")),"string"==typeof t[o]&&(i.length&&e.push(i.slice(0)),i.length=0),i.push(t[o]);return e.push(i.slice(0)),e}label(t,e,i,r,o,n,a,l,h){return new s(this,t,e,i,r,o,n,a,l,h)}alignElements(){this.alignedObjects.forEach(t=>t.align())}}return M(_.prototype,{Element:o,SVG_NS:y,escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},symbols:n,draw:m}),r.registerRendererType("svg",_,!0),_}),i(e,"Core/Renderer/HTML/HTMLElement.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Globals.js"],e["Core/Renderer/SVG/SVGElement.js"],e["Core/Utilities.js"]],function(t,e,i,r){let{composed:o}=e,{attr:s,css:n,createElement:a,defined:l,extend:h,pInt:c,pushUnique:d}=r;function u(t,e,r){let o=this.div?.style||r.style;i.prototype[`${e}Setter`].call(this,t,e,r),o&&(o[e]=t)}let g=(t,e)=>{if(!t.div){let r=s(t.element,"class"),o=t.css,n=a("div",r?{className:r}:void 0,{position:"absolute",left:`${t.translateX||0}px`,top:`${t.translateY||0}px`,...t.styles,display:t.display,opacity:t.opacity,visibility:t.visibility},t.parentGroup?.div||e);t.classSetter=(t,e,i)=>{i.setAttribute("class",t),n.className=t},t.translateXSetter=t.translateYSetter=(e,i)=>{t[i]=e,n.style["translateX"===i?"left":"top"]=`${e}px`,t.doTransform=!0},t.opacitySetter=t.visibilitySetter=u,t.css=e=>(o.call(t,e),e.cursor&&(n.style.cursor=e.cursor),e.pointerEvents&&(n.style.pointerEvents=e.pointerEvents),t),t.on=function(){return i.prototype.on.apply({element:n,onEvents:t.onEvents},arguments),t},t.div=n}return t.div};class p extends i{static compose(t){d(o,this.compose)&&(t.prototype.html=function(t,e,i){return new p(this,"span").attr({text:t,x:Math.round(e),y:Math.round(i)})})}constructor(t,e){super(t,e),this.css({position:"absolute",...t.styledMode?{}:{fontFamily:t.style.fontFamily,fontSize:t.style.fontSize}}),this.element.style.whiteSpace="nowrap"}getSpanCorrection(t,e,i){this.xCorr=-t*i,this.yCorr=-e}css(t){let e;let{element:i}=this,r="SPAN"===i.tagName&&t&&"width"in t,o=r&&t.width;return r&&(delete t.width,this.textWidth=c(o)||void 0,e=!0),t?.textOverflow==="ellipsis"&&(t.whiteSpace="nowrap",t.overflow="hidden"),h(this.styles,t),n(i,t),e&&this.updateTransform(),this}htmlGetBBox(){let{element:t}=this;return{x:t.offsetLeft,y:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight}}updateTransform(){if(!this.added){this.alignOnAdd=!0;return}let{element:t,renderer:e,rotation:i,rotationOriginX:r,rotationOriginY:o,styles:s,textAlign:a="left",textWidth:h,translateX:c=0,translateY:d=0,x:u=0,y:g=0}=this,p=s.whiteSpace;if(n(t,{marginLeft:`${c}px`,marginTop:`${d}px`}),"SPAN"===t.tagName){let s=[i,a,t.innerHTML,h,this.textAlign].join(","),c=-(this.parentGroup?.padding*1)||0,d,f=!1;if(h!==this.oldTextWidth){let e=this.textPxLength?this.textPxLength:(n(t,{width:"",whiteSpace:p||"nowrap"}),t.offsetWidth),r=h||0;(r>this.oldTextWidth||e>r)&&(/[ \-]/.test(t.textContent||t.innerText)||"ellipsis"===t.style.textOverflow)&&(n(t,{width:e>r||i?h+"px":"auto",display:"block",whiteSpace:p||"normal"}),this.oldTextWidth=h,f=!0)}this.hasBoxWidthChanged=f,s!==this.cTT&&(d=e.fontMetrics(t).b,l(i)&&(i!==(this.oldRotation||0)||a!==this.oldAlign)&&this.setSpanRotation(i,c,c),this.getSpanCorrection(!l(i)&&this.textPxLength||t.offsetWidth,d,{left:0,center:.5,right:1}[a]));let{xCorr:m=0,yCorr:y=0}=this,w=(r??u)-m-u-c,b=(o??g)-y-g-c;n(t,{left:`${u+m}px`,top:`${g+y}px`,transformOrigin:`${w}px ${b}px`}),this.cTT=s,this.oldRotation=i,this.oldAlign=a}}setSpanRotation(t,e,i){n(this.element,{transform:`rotate(${t}deg)`,transformOrigin:`${e}% ${i}px`})}add(t){let e;let i=this.renderer.box.parentNode,r=[];if(this.parentGroup=t,t&&!(e=t.div)){let o=t;for(;o;)r.push(o),o=o.parentGroup;for(let t of r.reverse())e=g(t,i)}return(e||i).appendChild(this.element),this.added=!0,this.alignOnAdd&&this.updateTransform(),this}textSetter(e){e!==this.textStr&&(delete this.bBox,delete this.oldTextWidth,t.setElementHTML(this.element,e??""),this.textStr=e,this.doTransform=!0)}alignSetter(t){this.alignValue=this.textAlign=t,this.doTransform=!0}xSetter(t,e){this[e]=t,this.doTransform=!0}}let f=p.prototype;return f.visibilitySetter=f.opacitySetter=u,f.ySetter=f.rotationSetter=f.rotationOriginXSetter=f.rotationOriginYSetter=f.xSetter,p}),i(e,"Core/Axis/AxisDefaults.js",[],function(){var t,e;return(e=t||(t={})).xAxis={alignTicks:!0,allowDecimals:void 0,panningEnabled:!0,zIndex:2,zoomEnabled:!0,dateTimeLabelFormats:{millisecond:{main:"%H:%M:%S.%L",range:!1},second:{main:"%H:%M:%S",range:!1},minute:{main:"%H:%M",range:!1},hour:{main:"%H:%M",range:!1},day:{main:"%e %b"},week:{main:"%e %b"},month:{main:"%b '%y"},year:{main:"%Y"}},endOnTick:!1,gridLineDashStyle:"Solid",gridZIndex:1,labels:{autoRotationLimit:80,distance:15,enabled:!0,indentation:10,overflow:"justify",padding:5,reserveSpace:void 0,rotation:void 0,staggerLines:0,step:0,useHTML:!1,zIndex:7,style:{color:"#333333",cursor:"default",fontSize:"0.8em"}},maxPadding:.01,minorGridLineDashStyle:"Solid",minorTickLength:2,minorTickPosition:"outside",minorTicksPerMajor:5,minPadding:.01,offset:void 0,reversed:void 0,reversedStacks:!1,showEmpty:!0,showFirstLabel:!0,showLastLabel:!0,startOfWeek:1,startOnTick:!1,tickLength:10,tickPixelInterval:100,tickmarkPlacement:"between",tickPosition:"outside",title:{align:"middle",useHTML:!1,x:0,y:0,style:{color:"#666666",fontSize:"0.8em"}},type:"linear",uniqueNames:!0,visible:!0,minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#333333",lineWidth:1,gridLineColor:"#e6e6e6",gridLineWidth:void 0,tickColor:"#333333"},e.yAxis={reversedStacks:!0,endOnTick:!0,maxPadding:.05,minPadding:.05,tickPixelInterval:72,showLastLabel:!0,labels:{x:void 0},startOnTick:!0,title:{text:"Values"},stackLabels:{animation:{},allowOverlap:!1,enabled:!1,crop:!0,overflow:"justify",formatter:function(){let{numberFormatter:t}=this.axis.chart;return t(this.total||0,-1)},style:{color:"#000000",fontSize:"0.7em",fontWeight:"bold",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0},t}),i(e,"Core/Foundation.js",[e["Core/Utilities.js"]],function(t){var e;let{addEvent:i,isFunction:r,objectEach:o,removeEvent:s}=t;return(e||(e={})).registerEventOptions=function(t,e){t.eventOptions=t.eventOptions||{},o(e.events,function(e,o){t.eventOptions[o]!==e&&(t.eventOptions[o]&&(s(t,o,t.eventOptions[o]),delete t.eventOptions[o]),r(e)&&(t.eventOptions[o]=e,i(t,o,e,{order:0})))})},e}),i(e,"Core/Axis/Tick.js",[e["Core/Templating.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(t,e,i){let{deg2rad:r}=e,{clamp:o,correctFloat:s,defined:n,destroyObjectProperties:a,extend:l,fireEvent:h,isNumber:c,merge:d,objectEach:u,pick:g}=i;return class{constructor(t,e,i,r,o){this.isNew=!0,this.isNewLabel=!0,this.axis=t,this.pos=e,this.type=i||"",this.parameters=o||{},this.tickmarkOffset=this.parameters.tickmarkOffset,this.options=this.parameters.options,h(this,"init"),i||r||this.addLabel()}addLabel(){let e=this,i=e.axis,r=i.options,o=i.chart,a=i.categories,d=i.logarithmic,u=i.names,p=e.pos,f=g(e.options&&e.options.labels,r.labels),m=i.tickPositions,y=p===m[0],w=p===m[m.length-1],b=(!f.step||1===f.step)&&1===i.tickInterval,C=m.info,S=e.label,x,E,R,T=this.parameters.category||(a?g(a[p],u[p],p):p);d&&c(T)&&(T=s(d.lin2log(T))),i.dateTime&&(C?x=(E=o.time.resolveDTLFormat(r.dateTimeLabelFormats[!r.grid&&C.higherRanks[p]||C.unitName])).main:c(T)&&(x=i.dateTime.getXDateFormat(T,r.dateTimeLabelFormats||{}))),e.isFirst=y,e.isLast=w;let M={axis:i,chart:o,dateTimeLabelFormat:x,isFirst:y,isLast:w,pos:p,tick:e,tickPositionInfo:C,value:T};h(this,"labelFormat",M);let k=e=>f.formatter?f.formatter.call(e,e):f.format?(e.text=i.defaultLabelFormatter.call(e),t.format(f.format,e,o)):i.defaultLabelFormatter.call(e),A=k.call(M,M),O=E&&E.list;O?e.shortenLabel=function(){for(R=0;R<O.length;R++)if(l(M,{dateTimeLabelFormat:O[R]}),S.attr({text:k.call(M,M)}),S.getBBox().width<i.getSlotWidth(e)-2*f.padding)return;S.attr({text:""})}:e.shortenLabel=void 0,b&&i._addedPlotLB&&e.moveLabel(A,f),n(S)||e.movedLabel?S&&S.textStr!==A&&!b&&(!S.textWidth||f.style.width||S.styles.width||S.css({width:null}),S.attr({text:A}),S.textPxLength=S.getBBox().width):(e.label=S=e.createLabel(A,f),e.rotation=0)}createLabel(t,e,i){let r=this.axis,o=r.chart,s=n(t)&&e.enabled?o.renderer.text(t,i?.x,i?.y,e.useHTML).add(r.labelGroup):void 0;return s&&(o.styledMode||s.css(d(e.style)),s.textPxLength=s.getBBox().width),s}destroy(){a(this,this.axis)}getPosition(t,e,i,r){let n=this.axis,a=n.chart,l=r&&a.oldChartHeight||a.chartHeight,c={x:t?s(n.translate(e+i,void 0,void 0,r)+n.transB):n.left+n.offset+(n.opposite?(r&&a.oldChartWidth||a.chartWidth)-n.right-n.left:0),y:t?l-n.bottom+n.offset-(n.opposite?n.height:0):s(l-n.translate(e+i,void 0,void 0,r)-n.transB)};return c.y=o(c.y,-1e5,1e5),h(this,"afterGetPosition",{pos:c}),c}getLabelPosition(t,e,i,o,s,a,l,c){let d,u;let p=this.axis,f=p.transA,m=p.isLinked&&p.linkedParent?p.linkedParent.reversed:p.reversed,y=p.staggerLines,w=p.tickRotCorr||{x:0,y:0},b=o||p.reserveSpaceDefault?0:-p.labelOffset*("center"===p.labelAlign?.5:1),C=s.distance,S={};return d=0===p.side?i.rotation?-C:-i.getBBox().height:2===p.side?w.y+C:Math.cos(i.rotation*r)*(w.y-i.getBBox(!1,0).height/2),n(s.y)&&(d=0===p.side&&p.horiz?s.y+d:s.y),t=t+g(s.x,[0,1,0,-1][p.side]*C)+b+w.x-(a&&o?a*f*(m?-1:1):0),e=e+d-(a&&!o?a*f*(m?1:-1):0),y&&(u=l/(c||1)%y,p.opposite&&(u=y-u-1),e+=p.labelOffset/y*u),S.x=t,S.y=Math.round(e),h(this,"afterGetLabelPosition",{pos:S,tickmarkOffset:a,index:l}),S}getLabelSize(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0}getMarkPath(t,e,i,r,o,s){return s.crispLine([["M",t,e],["L",t+(o?0:-i),e+(o?i:0)]],r)}handleOverflow(t){let e=this.axis,i=e.options.labels,o=t.x,s=e.chart.chartWidth,n=e.chart.spacing,a=g(e.labelLeft,Math.min(e.pos,n[3])),l=g(e.labelRight,Math.max(e.isRadial?0:e.pos+e.len,s-n[1])),h=this.label,c=this.rotation,d={left:0,center:.5,right:1}[e.labelAlign||h.attr("align")],u=h.getBBox().width,p=e.getSlotWidth(this),f={},m=p,y=1,w,b,C;c||"justify"!==i.overflow?c<0&&o-d*u<a?C=Math.round(o/Math.cos(c*r)-a):c>0&&o+d*u>l&&(C=Math.round((s-o)/Math.cos(c*r))):(w=o-d*u,b=o+(1-d)*u,w<a?m=t.x+m*(1-d)-a:b>l&&(m=l-t.x+m*d,y=-1),(m=Math.min(p,m))<p&&"center"===e.labelAlign&&(t.x+=y*(p-m-d*(p-Math.min(u,m)))),(u>m||e.autoRotation&&(h.styles||{}).width)&&(C=m)),C&&(this.shortenLabel?this.shortenLabel():(f.width=Math.floor(C)+"px",(i.style||{}).textOverflow||(f.textOverflow="ellipsis"),h.css(f)))}moveLabel(t,e){let i=this,r=i.label,o=i.axis,s=!1,n;r&&r.textStr===t?(i.movedLabel=r,s=!0,delete i.label):u(o.ticks,function(e){s||e.isNew||e===i||!e.label||e.label.textStr!==t||(i.movedLabel=e.label,s=!0,e.labelPos=i.movedLabel.xy,delete e.label)}),!s&&(i.labelPos||r)&&(n=i.labelPos||r.xy,i.movedLabel=i.createLabel(t,e,n),i.movedLabel&&i.movedLabel.attr({opacity:0}))}render(t,e,i){let r=this.axis,o=r.horiz,n=this.pos,a=g(this.tickmarkOffset,r.tickmarkOffset),l=this.getPosition(o,n,a,e),c=l.x,d=l.y,u=r.pos,p=u+r.len,f=o&&c===p||!o&&d===u?-1:1,m=o?c:d;!r.chart.polar&&this.isNew&&(s(m)<u||m>p)&&(i=0);let y=g(i,this.label&&this.label.newOpacity,1);i=g(i,1),this.isActive=!0,this.renderGridLine(e,i,f),this.renderMark(l,i,f),this.renderLabel(l,e,y,t),this.isNew=!1,h(this,"afterRender")}renderGridLine(t,e,i){let r=this.axis,o=r.options,s={},n=this.pos,a=this.type,l=g(this.tickmarkOffset,r.tickmarkOffset),h=r.chart.renderer,c=this.gridLine,d,u=o.gridLineWidth,p=o.gridLineColor,f=o.gridLineDashStyle;"minor"===this.type&&(u=o.minorGridLineWidth,p=o.minorGridLineColor,f=o.minorGridLineDashStyle),c||(r.chart.styledMode||(s.stroke=p,s["stroke-width"]=u||0,s.dashstyle=f),a||(s.zIndex=1),t&&(e=0),this.gridLine=c=h.path().attr(s).addClass("highcharts-"+(a?a+"-":"")+"grid-line").add(r.gridGroup)),c&&(d=r.getPlotLinePath({value:n+l,lineWidth:c.strokeWidth()*i,force:"pass",old:t,acrossPanes:!1}))&&c[t||this.isNew?"attr":"animate"]({d:d,opacity:e})}renderMark(t,e,i){let r=this.axis,o=r.options,s=r.chart.renderer,n=this.type,a=r.tickSize(n?n+"Tick":"tick"),l=t.x,h=t.y,c=g(o["minor"!==n?"tickWidth":"minorTickWidth"],!n&&r.isXAxis?1:0),d=o["minor"!==n?"tickColor":"minorTickColor"],u=this.mark,p=!u;a&&(r.opposite&&(a[0]=-a[0]),u||(this.mark=u=s.path().addClass("highcharts-"+(n?n+"-":"")+"tick").add(r.axisGroup),r.chart.styledMode||u.attr({stroke:d,"stroke-width":c})),u[p?"attr":"animate"]({d:this.getMarkPath(l,h,a[0],u.strokeWidth()*i,r.horiz,s),opacity:e}))}renderLabel(t,e,i,r){let o=this.axis,s=o.horiz,n=o.options,a=this.label,l=n.labels,h=l.step,d=g(this.tickmarkOffset,o.tickmarkOffset),u=t.x,p=t.y,f=!0;a&&c(u)&&(a.xy=t=this.getLabelPosition(u,p,a,s,l,d,r,h),(!this.isFirst||this.isLast||n.showFirstLabel)&&(!this.isLast||this.isFirst||n.showLastLabel)?!s||l.step||l.rotation||e||0===i||this.handleOverflow(t):f=!1,h&&r%h&&(f=!1),f&&c(t.y)?(t.opacity=i,a[this.isNewLabel?"attr":"animate"](t).show(!0),this.isNewLabel=!1):(a.hide(),this.isNewLabel=!0))}replaceMovedLabel(){let t=this.label,e=this.axis;t&&!this.isNew&&(t.animate({opacity:0},void 0,t.destroy),delete this.label),e.isDirty=!0,this.label=this.movedLabel,delete this.movedLabel}}}),i(e,"Core/Axis/Axis.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Axis/AxisDefaults.js"],e["Core/Color/Color.js"],e["Core/Defaults.js"],e["Core/Foundation.js"],e["Core/Globals.js"],e["Core/Axis/Tick.js"],e["Core/Utilities.js"]],function(t,e,i,r,o,s,n,a){let{animObject:l}=t,{xAxis:h,yAxis:c}=e,{defaultOptions:d}=r,{registerEventOptions:u}=o,{deg2rad:g}=s,{arrayMax:p,arrayMin:f,clamp:m,correctFloat:y,defined:w,destroyObjectProperties:b,erase:C,error:S,extend:x,fireEvent:E,getClosestDistance:R,insertItem:T,isArray:M,isNumber:k,isString:A,merge:O,normalizeTickInterval:P,objectEach:I,pick:H,relativeLength:L,removeEvent:D,splat:N,syncTimeout:_}=a,F=(t,e)=>P(e,void 0,void 0,H(t.options.allowDecimals,e<.5||void 0!==t.tickAmount),!!t.tickAmount);x(d,{xAxis:h,yAxis:O(h,c)});class j{constructor(t,e,i){this.init(t,e,i)}init(t,e,i=this.coll){let r="xAxis"===i,o=this.isZAxis||(t.inverted?!r:r);this.chart=t,this.horiz=o,this.isXAxis=r,this.coll=i,E(this,"init",{userOptions:e}),this.opposite=H(e.opposite,this.opposite),this.side=H(e.side,this.side,o?this.opposite?0:2:this.opposite?1:3),this.setOptions(e);let s=this.options,n=s.labels,a=s.type;this.userOptions=e,this.minPixelPadding=0,this.reversed=H(s.reversed,this.reversed),this.visible=s.visible,this.zoomEnabled=s.zoomEnabled,this.hasNames="category"===a||!0===s.categories,this.categories=M(s.categories)&&s.categories||(this.hasNames?[]:void 0),this.names||(this.names=[],this.names.keys={}),this.plotLinesAndBandsGroups={},this.positiveValuesOnly=!!this.logarithmic,this.isLinked=w(s.linkedTo),this.ticks={},this.labelEdge=[],this.minorTicks={},this.plotLinesAndBands=[],this.alternateBands={},this.len=0,this.minRange=this.userMinRange=s.minRange||s.maxZoom,this.range=s.range,this.offset=s.offset||0,this.max=void 0,this.min=void 0;let l=H(s.crosshair,N(t.options.tooltip.crosshairs)[r?0:1]);this.crosshair=!0===l?{}:l,-1===t.axes.indexOf(this)&&(r?t.axes.splice(t.xAxis.length,0,this):t.axes.push(this),T(this,t[this.coll])),t.orderItems(this.coll),this.series=this.series||[],t.inverted&&!this.isZAxis&&r&&!w(this.reversed)&&(this.reversed=!0),this.labelRotation=k(n.rotation)?n.rotation:void 0,u(this,s),E(this,"afterInit")}setOptions(t){let e=this.horiz?{labels:{autoRotation:[-45]},margin:15}:{title:{rotation:90*this.side}};this.options=O(e,d[this.coll],t),E(this,"afterSetOptions",{userOptions:t})}defaultLabelFormatter(){let t=this.axis,{numberFormatter:e}=this.chart,i=k(this.value)?this.value:NaN,r=t.chart.time,o=t.categories,s=this.dateTimeLabelFormat,n=d.lang,a=n.numericSymbols,l=n.numericSymbolMagnitude||1e3,h=t.logarithmic?Math.abs(i):t.tickInterval,c=a&&a.length,u,g;if(o)g=`${this.value}`;else if(s)g=r.dateFormat(s,i);else if(c&&a&&h>=1e3)for(;c--&&void 0===g;)h>=(u=Math.pow(l,c+1))&&10*i%u==0&&null!==a[c]&&0!==i&&(g=e(i/u,-1)+a[c]);return void 0===g&&(g=Math.abs(i)>=1e4?e(i,-1):e(i,-1,void 0,"")),g}getSeriesExtremes(){let t;let e=this;E(this,"getSeriesExtremes",null,function(){e.hasVisibleSeries=!1,e.dataMin=e.dataMax=e.threshold=void 0,e.softThreshold=!e.isXAxis,e.series.forEach(i=>{if(i.reserveSpace()){let r=i.options,o,s=r.threshold,n,a;if(e.hasVisibleSeries=!0,e.positiveValuesOnly&&0>=(s||0)&&(s=void 0),e.isXAxis)(o=i.xData)&&o.length&&(o=e.logarithmic?o.filter(t=>t>0):o,n=(t=i.getXExtremes(o)).min,a=t.max,k(n)||n instanceof Date||(o=o.filter(k),n=(t=i.getXExtremes(o)).min,a=t.max),o.length&&(e.dataMin=Math.min(H(e.dataMin,n),n),e.dataMax=Math.max(H(e.dataMax,a),a)));else{let t=i.applyExtremes();k(t.dataMin)&&(n=t.dataMin,e.dataMin=Math.min(H(e.dataMin,n),n)),k(t.dataMax)&&(a=t.dataMax,e.dataMax=Math.max(H(e.dataMax,a),a)),w(s)&&(e.threshold=s),(!r.softThreshold||e.positiveValuesOnly)&&(e.softThreshold=!1)}}})}),E(this,"afterGetSeriesExtremes")}translate(t,e,i,r,o,s){let n=this.linkedParent||this,a=r&&n.old?n.old.min:n.min;if(!k(a))return NaN;let l=n.minPixelPadding,h=(n.isOrdinal||n.brokenAxis?.hasBreaks||n.logarithmic&&o)&&n.lin2val,c=1,d=0,u=r&&n.old?n.old.transA:n.transA,g=0;if(u||(u=n.transA),i&&(c*=-1,d=n.len),n.reversed&&(c*=-1,d-=c*(n.sector||n.len)),e)g=(t=t*c+d-l)/u+a,h&&(g=n.lin2val(g));else{h&&(t=n.val2lin(t));let e=c*(t-a)*u;g=(n.isRadial?e:y(e))+d+c*l+(k(s)?u*s:0)}return g}toPixels(t,e){return this.translate(t,!1,!this.horiz,void 0,!0)+(e?0:this.pos)}toValue(t,e){return this.translate(t-(e?0:this.pos),!0,!this.horiz,void 0,!0)}getPlotLinePath(t){let e=this,i=e.chart,r=e.left,o=e.top,s=t.old,n=t.value,a=t.lineWidth,l=s&&i.oldChartHeight||i.chartHeight,h=s&&i.oldChartWidth||i.chartWidth,c=e.transB,d=t.translatedValue,u=t.force,g,p,f,y,w;function b(t,e,i){return"pass"!==u&&(t<e||t>i)&&(u?t=m(t,e,i):w=!0),t}let C={value:n,lineWidth:a,old:s,force:u,acrossPanes:t.acrossPanes,translatedValue:d};return E(this,"getPlotLinePath",C,function(t){g=f=Math.round((d=m(d=H(d,e.translate(n,void 0,void 0,s)),-1e5,1e5))+c),p=y=Math.round(l-d-c),k(d)?e.horiz?(p=o,y=l-e.bottom+(i.scrollablePixelsY||0),g=f=b(g,r,r+e.width)):(g=r,f=h-e.right+(i.scrollablePixelsX||0),p=y=b(p,o,o+e.height)):(w=!0,u=!1),t.path=w&&!u?void 0:i.renderer.crispLine([["M",g,p],["L",f,y]],a||1)}),C.path}getLinearTickPositions(t,e,i){let r,o,s;let n=y(Math.floor(e/t)*t),a=y(Math.ceil(i/t)*t),l=[];if(y(n+t)===n&&(s=20),this.single)return[e];for(r=n;r<=a&&(l.push(r),(r=y(r+t,s))!==o);)o=r;return l}getMinorTickInterval(){let{minorTicks:t,minorTickInterval:e}=this.options;return!0===t?H(e,"auto"):!1!==t?e:void 0}getMinorTickPositions(){let t=this.options,e=this.tickPositions,i=this.minorTickInterval,r=this.pointRangePadding||0,o=(this.min||0)-r,s=(this.max||0)+r,n=s-o,a=[],l;if(n&&n/i<this.len/3){let r=this.logarithmic;if(r)this.paddedTicks.forEach(function(t,e,o){e&&a.push.apply(a,r.getLogTickPositions(i,o[e-1],o[e],!0))});else if(this.dateTime&&"auto"===this.getMinorTickInterval())a=a.concat(this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(i),o,s,t.startOfWeek));else for(l=o+(e[0]-o)%i;l<=s&&l!==a[0];l+=i)a.push(l)}return 0!==a.length&&this.trimTicks(a),a}adjustForMinRange(){let t=this.options,e=this.logarithmic,{max:i,min:r,minRange:o}=this,s,n,a,l;this.isXAxis&&void 0===o&&!e&&(o=w(t.min)||w(t.max)||w(t.floor)||w(t.ceiling)?null:Math.min(5*(R(this.series.map(t=>(t.xIncrement?t.xData?.slice(0,2):t.xData)||[]))||0),this.dataMax-this.dataMin)),k(i)&&k(r)&&k(o)&&i-r<o&&(n=this.dataMax-this.dataMin>=o,s=(o-i+r)/2,a=[r-s,H(t.min,r-s)],n&&(a[2]=e?e.log2lin(this.dataMin):this.dataMin),l=[(r=p(a))+o,H(t.max,r+o)],n&&(l[2]=e?e.log2lin(this.dataMax):this.dataMax),(i=f(l))-r<o&&(a[0]=i-o,a[1]=H(t.min,i-o),r=p(a))),this.minRange=o,this.min=r,this.max=i}getClosest(){let t,e;if(this.categories)e=1;else{let i=[];this.series.forEach(function(t){let r=t.closestPointRange;t.xData?.length===1?i.push(t.xData[0]):!t.noSharedTooltip&&w(r)&&t.reserveSpace()&&(e=w(e)?Math.min(e,r):r)}),i.length&&(i.sort((t,e)=>t-e),t=R([i]))}return t&&e?Math.min(t,e):t||e}nameToX(t){let e=M(this.options.categories),i=e?this.categories:this.names,r=t.options.x,o;return t.series.requireSorting=!1,w(r)||(r=this.options.uniqueNames&&i?e?i.indexOf(t.name):H(i.keys[t.name],-1):t.series.autoIncrement()),-1===r?!e&&i&&(o=i.length):o=r,void 0!==o?(this.names[o]=t.name,this.names.keys[t.name]=o):t.x&&(o=t.x),o}updateNames(){let t=this,e=this.names;e.length>0&&(Object.keys(e.keys).forEach(function(t){delete e.keys[t]}),e.length=0,this.minRange=this.userMinRange,(this.series||[]).forEach(e=>{e.xIncrement=null,(!e.points||e.isDirtyData)&&(t.max=Math.max(t.max,e.xData.length-1),e.processData(),e.generatePoints()),e.data.forEach(function(i,r){let o;i?.options&&void 0!==i.name&&void 0!==(o=t.nameToX(i))&&o!==i.x&&(i.x=o,e.xData[r]=o)})}))}setAxisTranslation(){let t=this,e=t.max-t.min,i=t.linkedParent,r=!!t.categories,o=t.isXAxis,s=t.axisPointRange||0,n,a=0,l=0,h,c=t.transA;(o||r||s)&&(n=t.getClosest(),i?(a=i.minPointOffset,l=i.pointRangePadding):t.series.forEach(function(e){let i=r?1:o?H(e.options.pointRange,n,0):t.axisPointRange||0,h=e.options.pointPlacement;if(s=Math.max(s,i),!t.single||r){let t=e.is("xrange")?!o:o;a=Math.max(a,t&&A(h)?0:i/2),l=Math.max(l,t&&"on"===h?0:i)}}),h=t.ordinal&&t.ordinal.slope&&n?t.ordinal.slope/n:1,t.minPointOffset=a*=h,t.pointRangePadding=l*=h,t.pointRange=Math.min(s,t.single&&r?1:e),o&&n&&(t.closestPointRange=n)),t.translationSlope=t.transA=c=t.staticScale||t.len/(e+l||1),t.transB=t.horiz?t.left:t.bottom,t.minPixelPadding=c*a,E(this,"afterSetAxisTranslation")}minFromRange(){let{max:t,min:e}=this;return k(t)&&k(e)&&t-e||void 0}setTickInterval(t){let{categories:e,chart:i,dataMax:r,dataMin:o,dateTime:s,isXAxis:n,logarithmic:a,options:l,softThreshold:h}=this,c=k(this.threshold)?this.threshold:void 0,d=this.minRange||0,{ceiling:u,floor:g,linkedTo:p,softMax:f,softMin:m}=l,b=k(p)&&i[this.coll]?.[p],C=l.tickPixelInterval,x=l.maxPadding,R=l.minPadding,T=0,M,A=k(l.tickInterval)&&l.tickInterval>=0?l.tickInterval:void 0,O,P,I,L;if(s||e||b||this.getTickAmount(),I=H(this.userMin,l.min),L=H(this.userMax,l.max),b?(this.linkedParent=b,M=b.getExtremes(),this.min=H(M.min,M.dataMin),this.max=H(M.max,M.dataMax),l.type!==b.options.type&&S(11,!0,i)):(h&&w(c)&&k(r)&&k(o)&&(o>=c?(O=c,R=0):r<=c&&(P=c,x=0)),this.min=H(I,O,o),this.max=H(L,P,r)),k(this.max)&&k(this.min)&&(a&&(this.positiveValuesOnly&&!t&&0>=Math.min(this.min,H(o,this.min))&&S(10,!0,i),this.min=y(a.log2lin(this.min),16),this.max=y(a.log2lin(this.max),16)),this.range&&k(o)&&(this.userMin=this.min=I=Math.max(o,this.minFromRange()||0),this.userMax=L=this.max,this.range=void 0)),E(this,"foundExtremes"),this.adjustForMinRange(),k(this.min)&&k(this.max)){if(!k(this.userMin)&&k(m)&&m<this.min&&(this.min=I=m),!k(this.userMax)&&k(f)&&f>this.max&&(this.max=L=f),e||this.axisPointRange||this.stacking?.usePercentage||b||!(T=this.max-this.min)||(!w(I)&&R&&(this.min-=T*R),w(L)||!x||(this.max+=T*x)),!k(this.userMin)&&k(g)&&(this.min=Math.max(this.min,g)),!k(this.userMax)&&k(u)&&(this.max=Math.min(this.max,u)),h&&k(o)&&k(r)){let t=c||0;!w(I)&&this.min<t&&o>=t?this.min=l.minRange?Math.min(t,this.max-d):t:!w(L)&&this.max>t&&r<=t&&(this.max=l.minRange?Math.max(t,this.min+d):t)}!i.polar&&this.min>this.max&&(w(l.min)?this.max=this.min:w(l.max)&&(this.min=this.max)),T=this.max-this.min}if(this.min!==this.max&&k(this.min)&&k(this.max)?b&&!A&&C===b.options.tickPixelInterval?this.tickInterval=A=b.tickInterval:this.tickInterval=H(A,this.tickAmount?T/Math.max(this.tickAmount-1,1):void 0,e?1:T*C/Math.max(this.len,C)):this.tickInterval=1,n&&!t){let t=this.min!==this.old?.min||this.max!==this.old?.max;this.series.forEach(function(e){e.forceCrop=e.forceCropping?.(),e.processData(t)}),E(this,"postProcessData",{hasExtremesChanged:t})}this.setAxisTranslation(),E(this,"initialAxisTranslation"),this.pointRange&&!A&&(this.tickInterval=Math.max(this.pointRange,this.tickInterval));let D=H(l.minTickInterval,s&&!this.series.some(t=>t.noSharedTooltip)?this.closestPointRange:0);!A&&this.tickInterval<D&&(this.tickInterval=D),s||a||A||(this.tickInterval=F(this,this.tickInterval)),this.tickAmount||(this.tickInterval=this.unsquish()),this.setTickPositions()}setTickPositions(){let t=this.options,e=t.tickPositions,i=t.tickPositioner,r=this.getMinorTickInterval(),o=!this.isPanning,s=o&&t.startOnTick,n=o&&t.endOnTick,a=[],l;if(this.tickmarkOffset=this.categories&&"between"===t.tickmarkPlacement&&1===this.tickInterval?.5:0,this.minorTickInterval="auto"===r&&this.tickInterval?this.tickInterval/t.minorTicksPerMajor:r,this.single=this.min===this.max&&w(this.min)&&!this.tickAmount&&(this.min%1==0||!1!==t.allowDecimals),e)a=e.slice();else if(k(this.min)&&k(this.max)){if(!this.ordinal?.positions&&(this.max-this.min)/this.tickInterval>Math.max(2*this.len,200))a=[this.min,this.max],S(19,!1,this.chart);else if(this.dateTime)a=this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(this.tickInterval,t.units),this.min,this.max,t.startOfWeek,this.ordinal?.positions,this.closestPointRange,!0);else if(this.logarithmic)a=this.logarithmic.getLogTickPositions(this.tickInterval,this.min,this.max);else{let t=this.tickInterval,e=t;for(;e<=2*t;)if(a=this.getLinearTickPositions(this.tickInterval,this.min,this.max),this.tickAmount&&a.length>this.tickAmount)this.tickInterval=F(this,e*=1.1);else break}a.length>this.len&&(a=[a[0],a[a.length-1]])[0]===a[1]&&(a.length=1),i&&(this.tickPositions=a,(l=i.apply(this,[this.min,this.max]))&&(a=l))}this.tickPositions=a,this.paddedTicks=a.slice(0),this.trimTicks(a,s,n),!this.isLinked&&k(this.min)&&k(this.max)&&(this.single&&a.length<2&&!this.categories&&!this.series.some(t=>t.is("heatmap")&&"between"===t.options.pointPlacement)&&(this.min-=.5,this.max+=.5),e||l||this.adjustTickAmount()),E(this,"afterSetTickPositions")}trimTicks(t,e,i){let r=t[0],o=t[t.length-1],s=!this.isOrdinal&&this.minPointOffset||0;if(E(this,"trimTicks"),!this.isLinked){if(e&&r!==-1/0)this.min=r;else for(;this.min-s>t[0];)t.shift();if(i)this.max=o;else for(;this.max+s<t[t.length-1];)t.pop();0===t.length&&w(r)&&!this.options.tickPositions&&t.push((o+r)/2)}}alignToOthers(){let t;let e=this,i=e.chart,r=[this],o=e.options,s=i.options.chart,n="yAxis"===this.coll&&s.alignThresholds,a=[];if(e.thresholdAlignment=void 0,(!1!==s.alignTicks&&o.alignTicks||n)&&!1!==o.startOnTick&&!1!==o.endOnTick&&!e.logarithmic){let o=t=>{let{horiz:e,options:i}=t;return[e?i.left:i.top,i.width,i.height,i.pane].join(",")},s=o(this);i[this.coll].forEach(function(i){let{series:n}=i;n.length&&n.some(t=>t.visible)&&i!==e&&o(i)===s&&(t=!0,r.push(i))})}if(t&&n){r.forEach(t=>{let i=t.getThresholdAlignment(e);k(i)&&a.push(i)});let t=a.length>1?a.reduce((t,e)=>t+=e,0)/a.length:void 0;r.forEach(e=>{e.thresholdAlignment=t})}return t}getThresholdAlignment(t){if((!k(this.dataMin)||this!==t&&this.series.some(t=>t.isDirty||t.isDirtyData))&&this.getSeriesExtremes(),k(this.threshold)){let t=m((this.threshold-(this.dataMin||0))/((this.dataMax||0)-(this.dataMin||0)),0,1);return this.options.reversed&&(t=1-t),t}}getTickAmount(){let t=this.options,e=t.tickPixelInterval,i=t.tickAmount;w(t.tickInterval)||i||!(this.len<e)||this.isRadial||this.logarithmic||!t.startOnTick||!t.endOnTick||(i=2),!i&&this.alignToOthers()&&(i=Math.ceil(this.len/e)+1),i<4&&(this.finalTickAmt=i,i=5),this.tickAmount=i}adjustTickAmount(){let t=this,{finalTickAmt:e,max:i,min:r,options:o,tickPositions:s,tickAmount:n,thresholdAlignment:a}=t,l=s?.length,h=H(t.threshold,t.softThreshold?0:null),c,d,u=t.tickInterval,g,p=()=>s.push(y(s[s.length-1]+u)),f=()=>s.unshift(y(s[0]-u));if(k(a)&&(g=a<.5?Math.ceil(a*(n-1)):Math.floor(a*(n-1)),o.reversed&&(g=n-1-g)),t.hasData()&&k(r)&&k(i)){let a=()=>{t.transA*=(l-1)/(n-1),t.min=o.startOnTick?s[0]:Math.min(r,s[0]),t.max=o.endOnTick?s[s.length-1]:Math.max(i,s[s.length-1])};if(k(g)&&k(t.threshold)){for(;s[g]!==h||s.length!==n||s[0]>r||s[s.length-1]<i;){for(s.length=0,s.push(t.threshold);s.length<n;)void 0===s[g]||s[g]>t.threshold?f():p();if(u>8*t.tickInterval)break;u*=2}a()}else if(l<n){for(;s.length<n;)s.length%2||r===h?p():f();a()}if(w(e)){for(d=c=s.length;d--;)(3===e&&d%2==1||e<=2&&d>0&&d<c-1)&&s.splice(d,1);t.finalTickAmt=void 0}}}setScale(){let{coll:t,stacking:e}=this,i=!1,r=!1;this.series.forEach(t=>{i=i||t.isDirtyData||t.isDirty,r=r||t.xAxis&&t.xAxis.isDirty||!1}),this.setAxisSize();let o=this.len!==(this.old&&this.old.len);o||i||r||this.isLinked||this.forceRedraw||this.userMin!==(this.old&&this.old.userMin)||this.userMax!==(this.old&&this.old.userMax)||this.alignToOthers()?(e&&"yAxis"===t&&e.buildStacks(),this.forceRedraw=!1,this.userMinRange||(this.minRange=void 0),this.getSeriesExtremes(),this.setTickInterval(),e&&"xAxis"===t&&e.buildStacks(),this.isDirty||(this.isDirty=o||this.min!==this.old?.min||this.max!==this.old?.max)):e&&e.cleanStacks(),i&&delete this.allExtremes,E(this,"afterSetScale")}setExtremes(t,e,i=!0,r,o){this.series.forEach(t=>{delete t.kdTree}),E(this,"setExtremes",o=x(o,{min:t,max:e}),t=>{this.userMin=t.min,this.userMax=t.max,this.eventArgs=t,i&&this.chart.redraw(r)})}setAxisSize(){let t=this.chart,e=this.options,i=e.offsets||[0,0,0,0],r=this.horiz,o=this.width=Math.round(L(H(e.width,t.plotWidth-i[3]+i[1]),t.plotWidth)),s=this.height=Math.round(L(H(e.height,t.plotHeight-i[0]+i[2]),t.plotHeight)),n=this.top=Math.round(L(H(e.top,t.plotTop+i[0]),t.plotHeight,t.plotTop)),a=this.left=Math.round(L(H(e.left,t.plotLeft+i[3]),t.plotWidth,t.plotLeft));this.bottom=t.chartHeight-s-n,this.right=t.chartWidth-o-a,this.len=Math.max(r?o:s,0),this.pos=r?a:n}getExtremes(){let t=this.logarithmic;return{min:t?y(t.lin2log(this.min)):this.min,max:t?y(t.lin2log(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}}getThreshold(t){let e=this.logarithmic,i=e?e.lin2log(this.min):this.min,r=e?e.lin2log(this.max):this.max;return null===t||t===-1/0?t=i:t===1/0?t=r:i>t?t=i:r<t&&(t=r),this.translate(t,0,1,0,1)}autoLabelAlign(t){let e=(H(t,0)-90*this.side+720)%360,i={align:"center"};return E(this,"autoLabelAlign",i,function(t){e>15&&e<165?t.align="right":e>195&&e<345&&(t.align="left")}),i.align}tickSize(t){let e=this.options,i=H(e["tick"===t?"tickWidth":"minorTickWidth"],"tick"===t&&this.isXAxis&&!this.categories?1:0),r=e["tick"===t?"tickLength":"minorTickLength"],o;i&&r&&("inside"===e[t+"Position"]&&(r=-r),o=[r,i]);let s={tickSize:o};return E(this,"afterTickSize",s),s.tickSize}labelMetrics(){let t=this.chart.renderer,e=this.ticks,i=e[Object.keys(e)[0]]||{};return this.chart.renderer.fontMetrics(i.label||i.movedLabel||t.box)}unsquish(){let t=this.options.labels,e=this.horiz,i=this.tickInterval,r=this.len/(((this.categories?1:0)+this.max-this.min)/i),o=t.rotation,s=this.labelMetrics().h,n=Math.max(this.max-this.min,0),a=function(t){let e=t/(r||1);return(e=e>1?Math.ceil(e):1)*i>n&&t!==1/0&&r!==1/0&&n&&(e=Math.ceil(n/i)),y(e*i)},l=i,h,c=Number.MAX_VALUE,d;if(e){if(!t.staggerLines&&(k(o)?d=[o]:r<t.autoRotationLimit&&(d=t.autoRotation)),d){let t,e;for(let i of d)(i===o||i&&i>=-90&&i<=90)&&(e=(t=a(Math.abs(s/Math.sin(g*i))))+Math.abs(i/360))<c&&(c=e,h=i,l=t)}}else l=a(.75*s);return this.autoRotation=d,this.labelRotation=H(h,k(o)?o:0),t.step?i:l}getSlotWidth(t){let e=this.chart,i=this.horiz,r=this.options.labels,o=Math.max(this.tickPositions.length-(this.categories?0:1),1),s=e.margin[3];if(t&&k(t.slotWidth))return t.slotWidth;if(i&&r.step<2)return r.rotation?0:(this.staggerLines||1)*this.len/o;if(!i){let t=r.style.width;if(void 0!==t)return parseInt(String(t),10);if(s)return s-e.spacing[3]}return .33*e.chartWidth}renderUnsquish(){let t=this.chart,e=t.renderer,i=this.tickPositions,r=this.ticks,o=this.options.labels,s=o.style,n=this.horiz,a=this.getSlotWidth(),l=Math.max(1,Math.round(a-2*o.padding)),h={},c=this.labelMetrics(),d=s.textOverflow,u,g,p=0,f,m;if(A(o.rotation)||(h.rotation=o.rotation||0),i.forEach(function(t){let e=r[t];e.movedLabel&&e.replaceMovedLabel(),e&&e.label&&e.label.textPxLength>p&&(p=e.label.textPxLength)}),this.maxLabelLength=p,this.autoRotation)p>l&&p>c.h?h.rotation=this.labelRotation:this.labelRotation=0;else if(a&&(u=l,!d))for(g="clip",m=i.length;!n&&m--;)(f=r[i[m]].label)&&("ellipsis"===f.styles.textOverflow?f.css({textOverflow:"clip"}):f.textPxLength>a&&f.css({width:a+"px"}),f.getBBox().height>this.len/i.length-(c.h-c.f)&&(f.specificTextOverflow="ellipsis"));h.rotation&&(u=p>.5*t.chartHeight?.33*t.chartHeight:p,d||(g="ellipsis")),this.labelAlign=o.align||this.autoLabelAlign(this.labelRotation),this.labelAlign&&(h.align=this.labelAlign),i.forEach(function(t){let e=r[t],i=e&&e.label,o=s.width,n={};i&&(i.attr(h),e.shortenLabel?e.shortenLabel():u&&!o&&"nowrap"!==s.whiteSpace&&(u<i.textPxLength||"SPAN"===i.element.tagName)?(n.width=u+"px",d||(n.textOverflow=i.specificTextOverflow||g),i.css(n)):!i.styles.width||n.width||o||i.css({width:null}),delete i.specificTextOverflow,e.rotation=h.rotation)},this),this.tickRotCorr=e.rotCorr(c.b,this.labelRotation||0,0!==this.side)}hasData(){return this.series.some(function(t){return t.hasData()})||this.options.showEmpty&&w(this.min)&&w(this.max)}addTitle(t){let e;let i=this.chart.renderer,r=this.horiz,o=this.opposite,s=this.options.title,n=this.chart.styledMode;this.axisTitle||((e=s.textAlign)||(e=(r?{low:"left",middle:"center",high:"right"}:{low:o?"right":"left",middle:"center",high:o?"left":"right"})[s.align]),this.axisTitle=i.text(s.text||"",0,0,s.useHTML).attr({zIndex:7,rotation:s.rotation||0,align:e}).addClass("highcharts-axis-title"),n||this.axisTitle.css(O(s.style)),this.axisTitle.add(this.axisGroup),this.axisTitle.isNew=!0),n||s.style.width||this.isRadial||this.axisTitle.css({width:this.len+"px"}),this.axisTitle[t?"show":"hide"](t)}generateTick(t){let e=this.ticks;e[t]?e[t].addLabel():e[t]=new n(this,t)}createGroups(){let{axisParent:t,chart:e,coll:i,options:r}=this,o=e.renderer,s=(e,s,n)=>o.g(e).attr({zIndex:n}).addClass(`highcharts-${i.toLowerCase()}${s} `+(this.isRadial?`highcharts-radial-axis${s} `:"")+(r.className||"")).add(t);this.axisGroup||(this.gridGroup=s("grid","-grid",r.gridZIndex),this.axisGroup=s("axis","",r.zIndex),this.labelGroup=s("axis-labels","-labels",r.labels.zIndex))}getOffset(){let t=this,{chart:e,horiz:i,options:r,side:o,ticks:s,tickPositions:n,coll:a}=t,l=e.inverted&&!t.isZAxis?[1,0,3,2][o]:o,h=t.hasData(),c=r.title,d=r.labels,u=k(r.crossing),g=e.axisOffset,p=e.clipOffset,f=[-1,1,1,-1][o],m,y=0,b,C=0,S=0,x,R;if(t.showAxis=m=h||r.showEmpty,t.staggerLines=t.horiz&&d.staggerLines||void 0,t.createGroups(),h||t.isLinked?(n.forEach(function(e){t.generateTick(e)}),t.renderUnsquish(),t.reserveSpaceDefault=0===o||2===o||({1:"left",3:"right"})[o]===t.labelAlign,H(d.reserveSpace,!u&&null,"center"===t.labelAlign||null,t.reserveSpaceDefault)&&n.forEach(function(t){S=Math.max(s[t].getLabelSize(),S)}),t.staggerLines&&(S*=t.staggerLines),t.labelOffset=S*(t.opposite?-1:1)):I(s,function(t,e){t.destroy(),delete s[e]}),c?.text&&!1!==c.enabled&&(t.addTitle(m),m&&!u&&!1!==c.reserveSpace&&(t.titleOffset=y=t.axisTitle.getBBox()[i?"height":"width"],C=w(b=c.offset)?0:H(c.margin,i?5:10))),t.renderLine(),t.offset=f*H(r.offset,g[o]?g[o]+(r.margin||0):0),t.tickRotCorr=t.tickRotCorr||{x:0,y:0},R=0===o?-t.labelMetrics().h:2===o?t.tickRotCorr.y:0,x=Math.abs(S)+C,S&&(x-=R,x+=f*(i?H(d.y,t.tickRotCorr.y+f*d.distance):H(d.x,f*d.distance))),t.axisTitleMargin=H(b,x),t.getMaxLabelDimensions&&(t.maxLabelDimensions=t.getMaxLabelDimensions(s,n)),"colorAxis"!==a){let e=this.tickSize("tick");g[o]=Math.max(g[o],(t.axisTitleMargin||0)+y+f*t.offset,x,n&&n.length&&e?e[0]+f*t.offset:0);let i=!t.axisLine||r.offset?0:2*Math.floor(t.axisLine.strokeWidth()/2);p[l]=Math.max(p[l],i)}E(this,"afterGetOffset")}getLinePath(t){let e=this.chart,i=this.opposite,r=this.offset,o=this.horiz,s=this.left+(i?this.width:0)+r,n=e.chartHeight-this.bottom-(i?this.height:0)+r;return i&&(t*=-1),e.renderer.crispLine([["M",o?this.left:s,o?n:this.top],["L",o?e.chartWidth-this.right:s,o?n:e.chartHeight-this.bottom]],t)}renderLine(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.chart.styledMode||this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))}getTitlePosition(t){let e=this.horiz,i=this.left,r=this.top,o=this.len,s=this.options.title,n=e?i:r,a=this.opposite,l=this.offset,h=s.x,c=s.y,d=this.chart.renderer.fontMetrics(t),u=t?Math.max(t.getBBox(!1,0).height-d.h-1,0):0,g={low:n+(e?0:o),middle:n+o/2,high:n+(e?o:0)}[s.align],p=(e?r+this.height:i)+(e?1:-1)*(a?-1:1)*(this.axisTitleMargin||0)+[-u,u,d.f,-u][this.side],f={x:e?g+h:p+(a?this.width:0)+l+h,y:e?p+c-(a?this.height:0)+l:g+c};return E(this,"afterGetTitlePosition",{titlePosition:f}),f}renderMinorTick(t,e){let i=this.minorTicks;i[t]||(i[t]=new n(this,t,"minor")),e&&i[t].isNew&&i[t].render(null,!0),i[t].render(null,!1,1)}renderTick(t,e,i){let r=this.isLinked,o=this.ticks;(!r||t>=this.min&&t<=this.max||this.grid&&this.grid.isColumn)&&(o[t]||(o[t]=new n(this,t)),i&&o[t].isNew&&o[t].render(e,!0,-1),o[t].render(e))}render(){let t,e;let i=this,r=i.chart,o=i.logarithmic,a=r.renderer,h=i.options,c=i.isLinked,d=i.tickPositions,u=i.axisTitle,g=i.ticks,p=i.minorTicks,f=i.alternateBands,m=h.stackLabels,y=h.alternateGridColor,w=h.crossing,b=i.tickmarkOffset,C=i.axisLine,S=i.showAxis,x=l(a.globalAnimation);if(i.labelEdge.length=0,i.overlap=!1,[g,p,f].forEach(function(t){I(t,function(t){t.isActive=!1})}),k(w)){let t=this.isXAxis?r.yAxis[0]:r.xAxis[0],e=[1,-1,-1,1][this.side];if(t){let r=t.toPixels(w,!0);i.horiz&&(r=t.len-r),i.offset=e*r}}if(i.hasData()||c){let a=i.chart.hasRendered&&i.old&&k(i.old.min);i.minorTickInterval&&!i.categories&&i.getMinorTickPositions().forEach(function(t){i.renderMinorTick(t,a)}),d.length&&(d.forEach(function(t,e){i.renderTick(t,e,a)}),b&&(0===i.min||i.single)&&(g[-1]||(g[-1]=new n(i,-1,null,!0)),g[-1].render(-1))),y&&d.forEach(function(n,a){e=void 0!==d[a+1]?d[a+1]+b:i.max-b,a%2==0&&n<i.max&&e<=i.max+(r.polar?-b:b)&&(f[n]||(f[n]=new s.PlotLineOrBand(i,{})),t=n+b,f[n].options={from:o?o.lin2log(t):t,to:o?o.lin2log(e):e,color:y,className:"highcharts-alternate-grid"},f[n].render(),f[n].isActive=!0)}),i._addedPlotLB||(i._addedPlotLB=!0,(h.plotLines||[]).concat(h.plotBands||[]).forEach(function(t){i.addPlotBandOrLine(t)}))}[g,p,f].forEach(function(t){let e=[],i=x.duration;I(t,function(t,i){t.isActive||(t.render(i,!1,0),t.isActive=!1,e.push(i))}),_(function(){let i=e.length;for(;i--;)t[e[i]]&&!t[e[i]].isActive&&(t[e[i]].destroy(),delete t[e[i]])},t!==f&&r.hasRendered&&i?i:0)}),C&&(C[C.isPlaced?"animate":"attr"]({d:this.getLinePath(C.strokeWidth())}),C.isPlaced=!0,C[S?"show":"hide"](S)),u&&S&&(u[u.isNew?"attr":"animate"](i.getTitlePosition(u)),u.isNew=!1),m&&m.enabled&&i.stacking&&i.stacking.renderStackTotals(),i.old={len:i.len,max:i.max,min:i.min,transA:i.transA,userMax:i.userMax,userMin:i.userMin},i.isDirty=!1,E(this,"afterRender")}redraw(){this.visible&&(this.render(),this.plotLinesAndBands.forEach(function(t){t.render()})),this.series.forEach(function(t){t.isDirty=!0})}getKeepProps(){return this.keepProps||j.keepProps}destroy(t){let e=this,i=e.plotLinesAndBands,r=this.eventOptions;if(E(this,"destroy",{keepEvents:t}),t||D(e),[e.ticks,e.minorTicks,e.alternateBands].forEach(function(t){b(t)}),i){let t=i.length;for(;t--;)i[t].destroy()}for(let t in["axisLine","axisTitle","axisGroup","gridGroup","labelGroup","cross","scrollbar"].forEach(function(t){e[t]&&(e[t]=e[t].destroy())}),e.plotLinesAndBandsGroups)e.plotLinesAndBandsGroups[t]=e.plotLinesAndBandsGroups[t].destroy();I(e,function(t,i){-1===e.getKeepProps().indexOf(i)&&delete e[i]}),this.eventOptions=r}drawCrosshair(t,e){let r=this.crosshair,o=H(r&&r.snap,!0),s=this.chart,n,a,l,h=this.cross,c;if(E(this,"drawCrosshair",{e:t,point:e}),t||(t=this.cross&&this.cross.e),r&&!1!==(w(e)||!o)){if(o?w(e)&&(a=H("colorAxis"!==this.coll?e.crosshairPos:null,this.isXAxis?e.plotX:this.len-e.plotY)):a=t&&(this.horiz?t.chartX-this.pos:this.len-t.chartY+this.pos),w(a)&&(c={value:e&&(this.isXAxis?e.x:H(e.stackY,e.y)),translatedValue:a},s.polar&&x(c,{isCrosshair:!0,chartX:t&&t.chartX,chartY:t&&t.chartY,point:e}),n=this.getPlotLinePath(c)||null),!w(n)){this.hideCrosshair();return}l=this.categories&&!this.isRadial,h||(this.cross=h=s.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(l?"category ":"thin ")+(r.className||"")).attr({zIndex:H(r.zIndex,2)}).add(),!s.styledMode&&(h.attr({stroke:r.color||(l?i.parse("#ccd3ff").setOpacity(.25).get():"#cccccc"),"stroke-width":H(r.width,1)}).css({"pointer-events":"none"}),r.dashStyle&&h.attr({dashstyle:r.dashStyle}))),h.show().attr({d:n}),l&&!r.width&&h.attr({"stroke-width":this.transA}),this.cross.e=t}else this.hideCrosshair();E(this,"afterDrawCrosshair",{e:t,point:e})}hideCrosshair(){this.cross&&this.cross.hide(),E(this,"afterHideCrosshair")}update(t,e){let i=this.chart;t=O(this.userOptions,t),this.destroy(!0),this.init(i,t),i.isDirtyBox=!0,H(e,!0)&&i.redraw()}remove(t){let e=this.chart,i=this.coll,r=this.series,o=r.length;for(;o--;)r[o]&&r[o].remove(!1);C(e.axes,this),C(e[i]||[],this),e.orderItems(i),this.destroy(),e.isDirtyBox=!0,H(t,!0)&&e.redraw()}setTitle(t,e){this.update({title:t},e)}setCategories(t,e){this.update({categories:t},e)}}return j.keepProps=["coll","extKey","hcEvents","names","series","userMax","userMin"],j}),i(e,"Core/Axis/DateTimeAxis.js",[e["Core/Utilities.js"]],function(t){var e;let{addEvent:i,getMagnitude:r,normalizeTickInterval:o,timeUnits:s}=t;return function(t){function e(){return this.chart.time.getTimeTicks.apply(this.chart.time,arguments)}function n(){if("datetime"!==this.options.type){this.dateTime=void 0;return}this.dateTime||(this.dateTime=new a(this))}t.compose=function(t){return t.keepProps.includes("dateTime")||(t.keepProps.push("dateTime"),t.prototype.getTimeTicks=e,i(t,"afterSetOptions",n)),t};class a{constructor(t){this.axis=t}normalizeTimeTickInterval(t,e){let i=e||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],n=i[i.length-1],a=s[n[0]],l=n[1],h;for(h=0;h<i.length&&(a=s[(n=i[h])[0]],l=n[1],!i[h+1]||!(t<=(a*l[l.length-1]+s[i[h+1][0]])/2));h++);a===s.year&&t<5*a&&(l=[1,2,5]);let c=o(t/a,l,"year"===n[0]?Math.max(r(t/a),1):1);return{unitRange:a,count:c,unitName:n[0]}}getXDateFormat(t,e){let{axis:i}=this,r=i.chart.time;return i.closestPointRange?r.getDateFormat(i.closestPointRange,t,i.options.startOfWeek,e)||r.resolveDTLFormat(e.year).main:r.resolveDTLFormat(e.day).main}}t.Additions=a}(e||(e={})),e}),i(e,"Core/Axis/LogarithmicAxis.js",[e["Core/Utilities.js"]],function(t){var e;let{addEvent:i,normalizeTickInterval:r,pick:o}=t;return function(t){function e(t){let e=t.userOptions,i=this.logarithmic;"logarithmic"!==e.type?this.logarithmic=void 0:i||(i=this.logarithmic=new n(this))}function s(){let t=this.logarithmic;t&&(this.lin2val=function(e){return t.lin2log(e)},this.val2lin=function(e){return t.log2lin(e)})}t.compose=function(t){return t.keepProps.includes("logarithmic")||(t.keepProps.push("logarithmic"),i(t,"init",e),i(t,"afterInit",s)),t};class n{constructor(t){this.axis=t}getLogTickPositions(t,e,i,s){let n=this.axis,a=n.len,l=n.options,h=[];if(s||(this.minorAutoInterval=void 0),t>=.5)t=Math.round(t),h=n.getLinearTickPositions(t,e,i);else if(t>=.08){let r,o,n,a,l,c,d;let u=Math.floor(e);for(r=t>.3?[1,2,4]:t>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9],o=u;o<i+1&&!d;o++)for(n=0,a=r.length;n<a&&!d;n++)(l=this.log2lin(this.lin2log(o)*r[n]))>e&&(!s||c<=i)&&void 0!==c&&h.push(c),c>i&&(d=!0),c=l}else{let c=this.lin2log(e),d=this.lin2log(i),u=s?n.getMinorTickInterval():l.tickInterval,g=l.tickPixelInterval/(s?5:1),p=s?a/n.tickPositions.length:a;t=r(t=o("auto"===u?null:u,this.minorAutoInterval,(d-c)*g/(p||1))),h=n.getLinearTickPositions(t,c,d).map(this.log2lin),s||(this.minorAutoInterval=t/5)}return s||(n.tickInterval=t),h}lin2log(t){return Math.pow(10,t)}log2lin(t){return Math.log(t)/Math.LN10}}t.Additions=n}(e||(e={})),e}),i(e,"Core/Axis/PlotLineOrBand/PlotLineOrBandAxis.js",[e["Core/Utilities.js"]],function(t){var e;let{erase:i,extend:r,isNumber:o}=t;return function(t){let e;function s(t){return this.addPlotBandOrLine(t,"plotBands")}function n(t,i){let r=this.userOptions,o=new e(this,t);if(this.visible&&(o=o.render()),o){if(this._addedPlotLB||(this._addedPlotLB=!0,(r.plotLines||[]).concat(r.plotBands||[]).forEach(t=>{this.addPlotBandOrLine(t)})),i){let e=r[i]||[];e.push(t),r[i]=e}this.plotLinesAndBands.push(o)}return o}function a(t){return this.addPlotBandOrLine(t,"plotLines")}function l(t,e,i){i=i||this.options;let r=this.getPlotLinePath({value:e,force:!0,acrossPanes:i.acrossPanes}),s=[],n=this.horiz,a=!o(this.min)||!o(this.max)||t<this.min&&e<this.min||t>this.max&&e>this.max,l=this.getPlotLinePath({value:t,force:!0,acrossPanes:i.acrossPanes}),h,c=1,d;if(l&&r)for(a&&(d=l.toString()===r.toString(),c=0),h=0;h<l.length;h+=2){let t=l[h],e=l[h+1],i=r[h],o=r[h+1];("M"===t[0]||"L"===t[0])&&("M"===e[0]||"L"===e[0])&&("M"===i[0]||"L"===i[0])&&("M"===o[0]||"L"===o[0])&&(n&&i[1]===t[1]?(i[1]+=c,o[1]+=c):n||i[2]!==t[2]||(i[2]+=c,o[2]+=c),s.push(["M",t[1],t[2]],["L",e[1],e[2]],["L",o[1],o[2]],["L",i[1],i[2]],["Z"])),s.isFlat=d}return s}function h(t){this.removePlotBandOrLine(t)}function c(t){let e=this.plotLinesAndBands,r=this.options,o=this.userOptions;if(e){let s=e.length;for(;s--;)e[s].id===t&&e[s].destroy();[r.plotLines||[],o.plotLines||[],r.plotBands||[],o.plotBands||[]].forEach(function(e){for(s=e.length;s--;)(e[s]||{}).id===t&&i(e,e[s])})}}function d(t){this.removePlotBandOrLine(t)}t.compose=function(t,i){let o=i.prototype;return o.addPlotBand||(e=t,r(o,{addPlotBand:s,addPlotLine:a,addPlotBandOrLine:n,getPlotBandPath:l,removePlotBand:h,removePlotLine:d,removePlotBandOrLine:c})),i}}(e||(e={})),e}),i(e,"Core/Axis/PlotLineOrBand/PlotLineOrBand.js",[e["Core/Axis/PlotLineOrBand/PlotLineOrBandAxis.js"],e["Core/Utilities.js"]],function(t,e){let{arrayMax:i,arrayMin:r,defined:o,destroyObjectProperties:s,erase:n,fireEvent:a,merge:l,objectEach:h,pick:c}=e;class d{static compose(e){return t.compose(d,e)}constructor(t,e){this.axis=t,this.options=e,this.id=e.id}render(){a(this,"render");let{axis:t,options:e}=this,{horiz:i,logarithmic:r}=t,{color:s,events:n,zIndex:d=0}=e,u={},g=t.chart.renderer,p=e.to,f=e.from,m=e.value,y=e.borderWidth,w=e.label,{label:b,svgElem:C}=this,S=[],x,E=o(f)&&o(p),R=o(m),T=!C,M={class:"highcharts-plot-"+(E?"band ":"line ")+(e.className||"")},k=E?"bands":"lines";if(!t.chart.styledMode&&(R?(M.stroke=s||"#999999",M["stroke-width"]=c(e.width,1),e.dashStyle&&(M.dashstyle=e.dashStyle)):E&&(M.fill=s||"#e6e9ff",y&&(M.stroke=e.borderColor,M["stroke-width"]=y))),u.zIndex=d,k+="-"+d,(x=t.plotLinesAndBandsGroups[k])||(t.plotLinesAndBandsGroups[k]=x=g.g("plot-"+k).attr(u).add()),C||(this.svgElem=C=g.path().attr(M).add(x)),o(m))S=t.getPlotLinePath({value:r?.log2lin(m)??m,lineWidth:C.strokeWidth(),acrossPanes:e.acrossPanes});else{if(!(o(f)&&o(p)))return;S=t.getPlotBandPath(r?.log2lin(f)??f,r?.log2lin(p)??p,e)}return!this.eventsAdded&&n&&(h(n,(t,e)=>{C?.on(e,t=>{n[e].apply(this,[t])})}),this.eventsAdded=!0),(T||!C.d)&&S?.length?C.attr({d:S}):C&&(S?(C.show(),C.animate({d:S})):C.d&&(C.hide(),b&&(this.label=b=b.destroy()))),w&&(o(w.text)||o(w.formatter))&&S?.length&&t.width>0&&t.height>0&&!S.isFlat?(w=l({align:i&&E?"center":void 0,x:i?!E&&4:10,verticalAlign:!i&&E?"middle":void 0,y:i?E?16:10:E?6:-4,rotation:i&&!E?90:0},w),this.renderLabel(w,S,E,d)):b&&b.hide(),this}renderLabel(t,e,o,s){let n=this.axis,a=n.chart.renderer,h=this.label;h||(this.label=h=a.text(this.getLabelText(t),0,0,t.useHTML).attr({align:t.textAlign||t.align,rotation:t.rotation,class:"highcharts-plot-"+(o?"band":"line")+"-label "+(t.className||""),zIndex:s}),n.chart.styledMode||h.css(l({fontSize:"0.8em",textOverflow:"ellipsis"},t.style)),h.add());let c=e.xBounds||[e[0][1],e[1][1],o?e[2][1]:e[0][1]],d=e.yBounds||[e[0][2],e[1][2],o?e[2][2]:e[0][2]],u=r(c),g=r(d);if(h.align(t,!1,{x:u,y:g,width:i(c)-u,height:i(d)-g}),!h.alignValue||"left"===h.alignValue){let e=t.clip?n.width:n.chart.chartWidth;h.css({width:(90===h.rotation?n.height-(h.alignAttr.y-n.top):e-(h.alignAttr.x-n.left))+"px"})}h.show(!0)}getLabelText(t){return o(t.formatter)?t.formatter.call(this):t.text}destroy(){n(this.axis.plotLinesAndBands,this),delete this.axis,s(this)}}return d}),i(e,"Core/Tooltip.js",[e["Core/Templating.js"],e["Core/Globals.js"],e["Core/Renderer/RendererUtilities.js"],e["Core/Renderer/RendererRegistry.js"],e["Core/Utilities.js"]],function(t,e,i,r,o){var s;let{format:n}=t,{composed:a,doc:l,isSafari:h}=e,{distribute:c}=i,{addEvent:d,clamp:u,css:g,discardElement:p,extend:f,fireEvent:m,isArray:y,isNumber:w,isString:b,merge:C,pick:S,pushUnique:x,splat:E,syncTimeout:R}=o;class T{constructor(t,e,i){this.allowShared=!0,this.crosshairs=[],this.distance=0,this.isHidden=!0,this.isSticky=!1,this.now={},this.options={},this.outside=!1,this.chart=t,this.init(t,e),this.pointer=i}bodyFormatter(t){return t.map(function(t){let e=t.series.tooltipOptions;return(e[(t.point.formatPrefix||"point")+"Formatter"]||t.point.tooltipFormatter).call(t.point,e[(t.point.formatPrefix||"point")+"Format"]||"")})}cleanSplit(t){this.chart.series.forEach(function(e){let i=e&&e.tt;i&&(!i.isActive||t?e.tt=i.destroy():i.isActive=!1)})}defaultFormatter(t){let e;let i=this.points||E(this);return(e=(e=[t.tooltipFooterHeaderFormatter(i[0])]).concat(t.bodyFormatter(i))).push(t.tooltipFooterHeaderFormatter(i[0],!0)),e}destroy(){this.label&&(this.label=this.label.destroy()),this.split&&(this.cleanSplit(!0),this.tt&&(this.tt=this.tt.destroy())),this.renderer&&(this.renderer=this.renderer.destroy(),p(this.container)),o.clearTimeout(this.hideTimer),o.clearTimeout(this.tooltipTimeout)}getAnchor(t,e){let i;let{chart:r,pointer:o}=this,s=r.inverted,n=r.plotTop,a=r.plotLeft;if((t=E(t))[0].series&&t[0].series.yAxis&&!t[0].series.yAxis.options.reversedStacks&&(t=t.slice().reverse()),this.followPointer&&e)void 0===e.chartX&&(e=o.normalize(e)),i=[e.chartX-a,e.chartY-n];else if(t[0].tooltipPos)i=t[0].tooltipPos;else{let r=0,o=0;t.forEach(function(t){let e=t.pos(!0);e&&(r+=e[0],o+=e[1])}),r/=t.length,o/=t.length,this.shared&&t.length>1&&e&&(s?r=e.chartX:o=e.chartY),i=[r-a,o-n]}return i.map(Math.round)}getClassName(t,e,i){let r=this.options,o=t.series,s=o.options;return[r.className,"highcharts-label",i&&"highcharts-tooltip-header",e?"highcharts-tooltip-box":"highcharts-tooltip",!i&&"highcharts-color-"+S(t.colorIndex,o.colorIndex),s&&s.className].filter(b).join(" ")}getLabel(){let t=this,i=this.chart.styledMode,o=this.options,s=this.split&&this.allowShared,n=this.container,a=this.chart.renderer;if(this.label){let t=!this.label.hasClass("highcharts-label");(!s&&t||s&&!t)&&this.destroy()}if(!this.label){if(this.outside){let t=this.chart.options.chart.style,i=r.getRendererType();this.container=n=e.doc.createElement("div"),n.className="highcharts-tooltip-container",g(n,{position:"absolute",top:"1px",pointerEvents:"none",zIndex:Math.max(this.options.style.zIndex||0,(t&&t.zIndex||0)+3)}),this.renderer=a=new i(n,0,0,t,void 0,void 0,a.styledMode)}if(s?this.label=a.g("tooltip"):(this.label=a.label("",0,0,o.shape,void 0,void 0,o.useHTML,void 0,"tooltip").attr({padding:o.padding,r:o.borderRadius}),i||this.label.attr({fill:o.backgroundColor,"stroke-width":o.borderWidth||0}).css(o.style).css({pointerEvents:o.style.pointerEvents||(this.shouldStickOnContact()?"auto":"none")})),t.outside){let e=this.label,{xSetter:i,ySetter:r}=e;e.xSetter=function(r){i.call(e,t.distance),n&&(n.style.left=r+"px")},e.ySetter=function(i){r.call(e,t.distance),n&&(n.style.top=i+"px")}}this.label.attr({zIndex:8}).shadow(o.shadow).add()}return n&&!n.parentElement&&e.doc.body.appendChild(n),this.label}getPlayingField(){let{body:t,documentElement:e}=l,{chart:i,distance:r,outside:o}=this;return{width:o?Math.max(t.scrollWidth,e.scrollWidth,t.offsetWidth,e.offsetWidth,e.clientWidth)-2*r:i.chartWidth,height:o?Math.max(t.scrollHeight,e.scrollHeight,t.offsetHeight,e.offsetHeight,e.clientHeight):i.chartHeight}}getPosition(t,e,i){let{distance:r,chart:o,outside:s,pointer:n}=this,{inverted:a,plotLeft:l,plotTop:h,polar:c}=o,{plotX:d=0,plotY:u=0}=i,g={},p=a&&i.h||0,{height:f,width:m}=this.getPlayingField(),y=n.getChartPosition(),w=t=>t*y.scaleX,b=t=>t*y.scaleY,C=i=>{let n="x"===i;return[i,n?m:f,n?t:e].concat(s?[n?w(t):b(e),n?y.left-r+w(d+l):y.top-r+b(u+h),0,n?m:f]:[n?t:e,n?d+l:u+h,n?l:h,n?l+o.plotWidth:h+o.plotHeight])},x=C("y"),E=C("x"),R,T=!!i.negative;!c&&o.hoverSeries?.yAxis?.reversed&&(T=!T);let M=!this.followPointer&&S(i.ttBelow,!c&&!a===T),k=function(t,e,i,o,n,a,l){let h=s?"y"===t?b(r):w(r):r,c=(i-o)/2,d=o<n-r,u=n+r+o<e,f=n-h-i+c,m=n+h-c;if(M&&u)g[t]=m;else if(!M&&d)g[t]=f;else if(d)g[t]=Math.min(l-o,f-p<0?f:f-p);else{if(!u)return!1;g[t]=Math.max(a,m+p+i>e?m:m+p)}},A=function(t,e,i,o,s){if(s<r||s>e-r)return!1;s<i/2?g[t]=1:s>e-o/2?g[t]=e-o-2:g[t]=s-i/2},O=function(t){[x,E]=[E,x],R=t},P=()=>{!1!==k.apply(0,x)?!1!==A.apply(0,E)||R||(O(!0),P()):R?g.x=g.y=0:(O(!0),P())};return(a&&!c||this.len>1)&&O(),P(),g}hide(t){let e=this;o.clearTimeout(this.hideTimer),t=S(t,this.options.hideDelay),this.isHidden||(this.hideTimer=R(function(){let i=e.getLabel();e.getLabel().animate({opacity:0},{duration:t?150:t,complete:()=>{i.hide(),e.container&&e.container.remove()}}),e.isHidden=!0},t))}init(t,e){this.chart=t,this.options=e,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.split=e.split&&!t.inverted&&!t.polar,this.shared=e.shared||this.split,this.outside=S(e.outside,!!(t.scrollablePixelsX||t.scrollablePixelsY))}shouldStickOnContact(t){return!!(!this.followPointer&&this.options.stickOnContact&&(!t||this.pointer.inClass(t.target,"highcharts-tooltip")))}move(t,e,i,r){let s=this,n=s.now,a=!1!==s.options.animation&&!s.isHidden&&(Math.abs(t-n.x)>1||Math.abs(e-n.y)>1),l=s.followPointer||s.len>1;f(n,{x:a?(2*n.x+t)/3:t,y:a?(n.y+e)/2:e,anchorX:l?void 0:a?(2*n.anchorX+i)/3:i,anchorY:l?void 0:a?(n.anchorY+r)/2:r}),s.getLabel().attr(n),s.drawTracker(),a&&(o.clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){s&&s.move(t,e,i,r)},32))}refresh(t,e){let{chart:i,options:r,pointer:s,shared:a}=this,l=E(t),h=l[0],c=[],d=r.format,u=r.formatter||this.defaultFormatter,g=i.styledMode,p={};if(!r.enabled||!h.series)return;o.clearTimeout(this.hideTimer),this.allowShared=!(!y(t)&&t.series&&t.series.noSharedTooltip),this.followPointer=!this.split&&h.series.tooltipOptions.followPointer;let f=this.getAnchor(t,e),w=f[0],C=f[1];a&&this.allowShared?(s.applyInactiveState(l),l.forEach(function(t){t.setState("hover"),c.push(t.getLabelConfig())}),(p=h.getLabelConfig()).points=c):p=h.getLabelConfig(),this.len=c.length;let x=b(d)?n(d,p,i):u.call(p,this),R=h.series;if(this.distance=S(R.tooltipOptions.distance,16),!1===x)this.hide();else{if(this.split&&this.allowShared)this.renderSplit(x,l);else{let t=w,o=C;if(e&&s.isDirectTouch&&(t=e.chartX-i.plotLeft,o=e.chartY-i.plotTop),i.polar||!1===R.options.clip||l.some(e=>s.isDirectTouch||e.series.shouldShowTooltip(t,o))){let t=this.getLabel();(!r.style.width||g)&&t.css({width:(this.outside?this.getPlayingField():i.spacingBox).width+"px"}),t.attr({text:x&&x.join?x.join(""):x}),t.addClass(this.getClassName(h),!0),g||t.attr({stroke:r.borderColor||h.color||R.color||"#666666"}),this.updatePosition({plotX:w,plotY:C,negative:h.negative,ttBelow:h.ttBelow,h:f[2]||0})}else{this.hide();return}}this.isHidden&&this.label&&this.label.attr({opacity:1}).show(),this.isHidden=!1}m(this,"refresh")}renderSplit(t,e){let i=this,{chart:r,chart:{chartWidth:o,chartHeight:s,plotHeight:n,plotLeft:a,plotTop:d,scrollablePixelsY:g=0,scrollablePixelsX:p,styledMode:m},distance:y,options:w,options:{positioner:C},pointer:x}=i,{scrollLeft:E=0,scrollTop:R=0}=r.scrollablePlotArea?.scrollingContainer||{},T=i.outside&&"number"!=typeof p?l.documentElement.getBoundingClientRect():{left:E,right:E+o,top:R,bottom:R+s},M=i.getLabel(),k=this.renderer||r.renderer,A=!!(r.xAxis[0]&&r.xAxis[0].opposite),{left:O,top:P}=x.getChartPosition(),I=d+R,H=0,L=n-g;function D(t,e,r,o,s=!0){let n,a;return r?(n=A?0:L,a=u(t-o/2,T.left,T.right-o-(i.outside?O:0))):(n=e-I,a=u(a=s?t-o-y:t+y,s?a:T.left,T.right)),{x:a,y:n}}b(t)&&(t=[!1,t]);let N=t.slice(0,e.length+1).reduce(function(t,r,o){if(!1!==r&&""!==r){let s=e[o-1]||{isHeader:!0,plotX:e[0].plotX,plotY:n,series:{}},l=s.isHeader,h=l?i:s.series,c=h.tt=function(t,e,r){let o=t,{isHeader:s,series:n}=e;if(!o){let t={padding:w.padding,r:w.borderRadius};m||(t.fill=w.backgroundColor,t["stroke-width"]=w.borderWidth??1),o=k.label("",0,0,w[s?"headerShape":"shape"],void 0,void 0,w.useHTML).addClass(i.getClassName(e,!0,s)).attr(t).add(M)}return o.isActive=!0,o.attr({text:r}),m||o.css(w.style).attr({stroke:w.borderColor||e.color||n.color||"#333333"}),o}(h.tt,s,r.toString()),g=c.getBBox(),p=g.width+c.strokeWidth();l&&(H=g.height,L+=H,A&&(I-=H));let{anchorX:f,anchorY:b}=function(t){let e,i;let{isHeader:r,plotX:o=0,plotY:s=0,series:l}=t;if(r)e=Math.max(a+o,a),i=d+n/2;else{let{xAxis:t,yAxis:r}=l;e=t.pos+u(o,-y,t.len+y),l.shouldShowTooltip(0,r.pos-d+s,{ignoreX:!0})&&(i=r.pos+s)}return{anchorX:e=u(e,T.left-y,T.right+y),anchorY:i}}(s);if("number"==typeof b){let e=g.height+1,r=C?C.call(i,p,e,s):D(f,b,l,p);t.push({align:C?0:void 0,anchorX:f,anchorY:b,boxWidth:p,point:s,rank:S(r.rank,l?1:0),size:e,target:r.y,tt:c,x:r.x})}else c.isActive=!1}return t},[]);!C&&N.some(t=>{let{outside:e}=i,r=(e?O:0)+t.anchorX;return r<T.left&&r+t.boxWidth<T.right||r<O-T.left+t.boxWidth&&T.right-r>r})&&(N=N.map(t=>{let{x:e,y:i}=D(t.anchorX,t.anchorY,t.point.isHeader,t.boxWidth,!1);return f(t,{target:i,x:e})})),i.cleanSplit(),c(N,L);let _={left:O,right:O};N.forEach(function(t){let{x:e,boxWidth:r,isHeader:o}=t;!o&&(i.outside&&O+e<_.left&&(_.left=O+e),!o&&i.outside&&_.left+r>_.right&&(_.right=O+e))}),N.forEach(function(t){let{x:e,anchorX:r,anchorY:o,pos:s,point:{isHeader:n}}=t,a={visibility:void 0===s?"hidden":"inherit",x:e,y:(s||0)+I,anchorX:r,anchorY:o};if(i.outside&&e<r){let t=O-_.left;t>0&&(n||(a.x=e+t,a.anchorX=r+t),n&&(a.x=(_.right-_.left)/2,a.anchorX=r+t))}t.tt.attr(a)});let{container:F,outside:j,renderer:B}=i;if(j&&F&&B){let{width:t,height:e,x:i,y:r}=M.getBBox();B.setSize(t+i,e+r,!1),F.style.left=_.left+"px",F.style.top=P+"px"}h&&M.attr({opacity:1===M.opacity?.999:1})}drawTracker(){if(!this.shouldStickOnContact()){this.tracker&&(this.tracker=this.tracker.destroy());return}let t=this.chart,e=this.label,i=this.shared?t.hoverPoints:t.hoverPoint;if(!e||!i)return;let r={x:0,y:0,width:0,height:0},o=this.getAnchor(i),s=e.getBBox();o[0]+=t.plotLeft-(e.translateX||0),o[1]+=t.plotTop-(e.translateY||0),r.x=Math.min(0,o[0]),r.y=Math.min(0,o[1]),r.width=o[0]<0?Math.max(Math.abs(o[0]),s.width-o[0]):Math.max(Math.abs(o[0]),s.width),r.height=o[1]<0?Math.max(Math.abs(o[1]),s.height-Math.abs(o[1])):Math.max(Math.abs(o[1]),s.height),this.tracker?this.tracker.attr(r):(this.tracker=e.renderer.rect(r).addClass("highcharts-tracker").add(e),t.styledMode||this.tracker.attr({fill:"rgba(0,0,0,0)"}))}styledModeFormat(t){return t.replace('style="font-size: 0.8em"','class="highcharts-header"').replace(/style="color:{(point|series)\.color}"/g,'class="highcharts-color-{$1.colorIndex} {series.options.className} {point.options.className}"')}tooltipFooterHeaderFormatter(t,e){let i=t.series,r=i.tooltipOptions,o=i.xAxis,s=o&&o.dateTime,a={isFooter:e,labelConfig:t},l=r.xDateFormat,h=r[e?"footerFormat":"headerFormat"];return m(this,"headerFormatter",a,function(e){s&&!l&&w(t.key)&&(l=s.getXDateFormat(t.key,r.dateTimeLabelFormats)),s&&l&&(t.point&&t.point.tooltipDateKeys||["key"]).forEach(function(t){h=h.replace("{point."+t+"}","{point."+t+":"+l+"}")}),i.chart.styledMode&&(h=this.styledModeFormat(h)),e.text=n(h,{point:t,series:i},this.chart)}),a.text}update(t){this.destroy(),this.init(this.chart,C(!0,this.options,t))}updatePosition(t){let{chart:e,container:i,distance:r,options:o,pointer:s,renderer:n}=this,{height:a=0,width:l=0}=this.getLabel(),{left:h,top:c,scaleX:d,scaleY:u}=s.getChartPosition(),p=(o.positioner||this.getPosition).call(this,l,a,t),f=(t.plotX||0)+e.plotLeft,m=(t.plotY||0)+e.plotTop,y;n&&i&&(o.positioner&&(p.x+=h-r,p.y+=c-r),y=(o.borderWidth||0)+2*r+2,n.setSize(l+y,a+y,!1),(1!==d||1!==u)&&(g(i,{transform:`scale(${d}, ${u})`}),f*=d,m*=u),f+=h-p.x,m+=c-p.y),this.move(Math.round(p.x),Math.round(p.y||0),f,m)}}return(s=T||(T={})).compose=function(t){x(a,"Core.Tooltip")&&d(t,"afterInit",function(){let t=this.chart;t.options.tooltip&&(t.tooltip=new s(t,t.options.tooltip,this))})},T}),i(e,"Core/Series/Point.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Animation/AnimationUtilities.js"],e["Core/Defaults.js"],e["Core/Templating.js"],e["Core/Utilities.js"]],function(t,e,i,r,o){let{animObject:s}=e,{defaultOptions:n}=i,{format:a}=r,{addEvent:l,erase:h,extend:c,fireEvent:d,getNestedProperty:u,isArray:g,isFunction:p,isNumber:f,isObject:m,merge:y,pick:w,syncTimeout:b,removeEvent:C,uniqueKey:S}=o;class x{animateBeforeDestroy(){let t=this,e={x:t.startXPos,opacity:0},i=t.getGraphicalProps();i.singular.forEach(function(i){t[i]=t[i].animate("dataLabel"===i?{x:t[i].startXPos,y:t[i].startYPos,opacity:0}:e)}),i.plural.forEach(function(e){t[e].forEach(function(e){e.element&&e.animate(c({x:t.startXPos},e.startYPos?{x:e.startXPos,y:e.startYPos}:{}))})})}applyOptions(t,e){let i=this.series,r=i.options.pointValKey||i.pointValKey;return c(this,t=x.prototype.optionsToObject.call(this,t)),this.options=this.options?c(this.options,t):t,t.group&&delete this.group,t.dataLabels&&delete this.dataLabels,r&&(this.y=x.prototype.getNestedProperty.call(this,r)),this.selected&&(this.state="select"),"name"in this&&void 0===e&&i.xAxis&&i.xAxis.hasNames&&(this.x=i.xAxis.nameToX(this)),void 0===this.x&&i?void 0===e?this.x=i.autoIncrement():this.x=e:f(t.x)&&i.options.relativeXValue&&(this.x=i.autoIncrement(t.x)),this.isNull=this.isValid&&!this.isValid(),this.formatPrefix=this.isNull?"null":"point",this}destroy(){if(!this.destroyed){let t=this,e=t.series,i=e.chart,r=e.options.dataSorting,o=i.hoverPoints,n=s(t.series.chart.renderer.globalAnimation),a=()=>{for(let e in(t.graphic||t.graphics||t.dataLabel||t.dataLabels)&&(C(t),t.destroyElements()),t)delete t[e]};t.legendItem&&i.legend.destroyItem(t),o&&(t.setState(),h(o,t),o.length||(i.hoverPoints=null)),t===i.hoverPoint&&t.onMouseOut(),r&&r.enabled?(this.animateBeforeDestroy(),b(a,n.duration)):a(),i.pointCount--}this.destroyed=!0}destroyElements(t){let e=this,i=e.getGraphicalProps(t);i.singular.forEach(function(t){e[t]=e[t].destroy()}),i.plural.forEach(function(t){e[t].forEach(function(t){t&&t.element&&t.destroy()}),delete e[t]})}firePointEvent(t,e,i){let r=this,o=this.series.options;r.manageEvent(t),"click"===t&&o.allowPointSelect&&(i=function(t){!r.destroyed&&r.select&&r.select(null,t.ctrlKey||t.metaKey||t.shiftKey)}),d(r,t,e,i)}getClassName(){return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(void 0!==this.colorIndex?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+(this.zone&&this.zone.className?" "+this.zone.className.replace("highcharts-negative",""):"")}getGraphicalProps(t){let e,i;let r=this,o=[],s={singular:[],plural:[]};for((t=t||{graphic:1,dataLabel:1}).graphic&&o.push("graphic","connector"),t.dataLabel&&o.push("dataLabel","dataLabelPath","dataLabelUpper"),i=o.length;i--;)r[e=o[i]]&&s.singular.push(e);return["graphic","dataLabel"].forEach(function(e){let i=e+"s";t[e]&&r[i]&&s.plural.push(i)}),s}getLabelConfig(){return{x:this.category,y:this.y,color:this.color,colorIndex:this.colorIndex,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}}getNestedProperty(t){return t?0===t.indexOf("custom.")?u(t,this.options):this[t]:void 0}getZone(){let t=this.series,e=t.zones,i=t.zoneAxis||"y",r,o=0;for(r=e[0];this[i]>=r.value;)r=e[++o];return this.nonZonedColor||(this.nonZonedColor=this.color),r&&r.color&&!this.options.color?this.color=r.color:this.color=this.nonZonedColor,r}hasNewShapeType(){return(this.graphic&&(this.graphic.symbolName||this.graphic.element.nodeName))!==this.shapeType}constructor(t,e,i){this.formatPrefix="point",this.visible=!0,this.series=t,this.applyOptions(e,i),this.id??(this.id=S()),this.resolveColor(),t.chart.pointCount++,d(this,"afterInit")}isValid(){return(f(this.x)||this.x instanceof Date)&&f(this.y)}optionsToObject(t){let e=this.series,i=e.options.keys,r=i||e.pointArrayMap||["y"],o=r.length,s={},n,a=0,l=0;if(f(t)||null===t)s[r[0]]=t;else if(g(t))for(!i&&t.length>o&&("string"==(n=typeof t[0])?s.name=t[0]:"number"===n&&(s.x=t[0]),a++);l<o;)i&&void 0===t[a]||(r[l].indexOf(".")>0?x.prototype.setNestedProperty(s,t[a],r[l]):s[r[l]]=t[a]),a++,l++;else"object"==typeof t&&(s=t,t.dataLabels&&(e.hasDataLabels=()=>!0),t.marker&&(e._hasPointMarkers=!0));return s}pos(t,e=this.plotY){if(!this.destroyed){let{plotX:i,series:r}=this,{chart:o,xAxis:s,yAxis:n}=r,a=0,l=0;if(f(i)&&f(e))return t&&(a=s?s.pos:o.plotLeft,l=n?n.pos:o.plotTop),o.inverted&&s&&n?[n.len-e+l,s.len-i+a]:[i+a,e+l]}}resolveColor(){let t=this.series,e=t.chart.options.chart,i=t.chart.styledMode,r,o,s=e.colorCount,n;delete this.nonZonedColor,t.options.colorByPoint?(i||(r=(o=t.options.colors||t.chart.options.colors)[t.colorCounter],s=o.length),n=t.colorCounter,t.colorCounter++,t.colorCounter===s&&(t.colorCounter=0)):(i||(r=t.color),n=t.colorIndex),this.colorIndex=w(this.options.colorIndex,n),this.color=w(this.options.color,r)}setNestedProperty(t,e,i){return i.split(".").reduce(function(t,i,r,o){let s=o.length-1===r;return t[i]=s?e:m(t[i],!0)?t[i]:{},t[i]},t),t}shouldDraw(){return!this.isNull}tooltipFormatter(t){let e=this.series,i=e.tooltipOptions,r=w(i.valueDecimals,""),o=i.valuePrefix||"",s=i.valueSuffix||"";return e.chart.styledMode&&(t=e.chart.tooltip.styledModeFormat(t)),(e.pointArrayMap||["y"]).forEach(function(e){e="{point."+e,(o||s)&&(t=t.replace(RegExp(e+"}","g"),o+e+"}"+s)),t=t.replace(RegExp(e+"}","g"),e+":,."+r+"f}")}),a(t,{point:this,series:this.series},e.chart)}update(t,e,i,r){let o;let s=this,n=s.series,a=s.graphic,l=n.chart,h=n.options;function c(){s.applyOptions(t);let r=a&&s.hasMockGraphic,c=null===s.y?!r:r;a&&c&&(s.graphic=a.destroy(),delete s.hasMockGraphic),m(t,!0)&&(a&&a.element&&t&&t.marker&&void 0!==t.marker.symbol&&(s.graphic=a.destroy()),t?.dataLabels&&s.dataLabel&&(s.dataLabel=s.dataLabel.destroy())),o=s.index,n.updateParallelArrays(s,o),h.data[o]=m(h.data[o],!0)||m(t,!0)?s.options:w(t,h.data[o]),n.isDirty=n.isDirtyData=!0,!n.fixedBox&&n.hasCartesianSeries&&(l.isDirtyBox=!0),"point"===h.legendType&&(l.isDirtyLegend=!0),e&&l.redraw(i)}e=w(e,!0),!1===r?c():s.firePointEvent("update",{options:t},c)}remove(t,e){this.series.removePoint(this.series.data.indexOf(this),t,e)}select(t,e){let i=this,r=i.series,o=r.chart;t=w(t,!i.selected),this.selectedStaging=t,i.firePointEvent(t?"select":"unselect",{accumulate:e},function(){i.selected=i.options.selected=t,r.options.data[r.data.indexOf(i)]=i.options,i.setState(t&&"select"),e||o.getSelectedPoints().forEach(function(t){let e=t.series;t.selected&&t!==i&&(t.selected=t.options.selected=!1,e.options.data[e.data.indexOf(t)]=t.options,t.setState(o.hoverPoints&&e.options.inactiveOtherPoints?"inactive":""),t.firePointEvent("unselect"))})}),delete this.selectedStaging}onMouseOver(t){let{inverted:e,pointer:i}=this.series.chart;i&&(t=t?i.normalize(t):i.getChartCoordinatesFromPoint(this,e),i.runPointActions(t,this))}onMouseOut(){let t=this.series.chart;this.firePointEvent("mouseOut"),this.series.options.inactiveOtherPoints||(t.hoverPoints||[]).forEach(function(t){t.setState()}),t.hoverPoints=t.hoverPoint=null}manageEvent(t){let e=y(this.series.options.point,this.options),i=e.events?.[t];p(i)&&(!this.hcEvents?.[t]||this.hcEvents?.[t]?.map(t=>t.fn).indexOf(i)===-1)?(l(this,t,i),this.hasImportedEvents=!0):this.hasImportedEvents&&!i&&this.hcEvents?.[t]&&(C(this,t),delete this.hcEvents[t],Object.keys(this.hcEvents)||(this.hasImportedEvents=!1))}setState(e,i){let r=this.series,o=this.state,s=r.options.states[e||"normal"]||{},a=n.plotOptions[r.type].marker&&r.options.marker,l=a&&!1===a.enabled,h=a&&a.states&&a.states[e||"normal"]||{},u=!1===h.enabled,g=this.marker||{},p=r.chart,m=a&&r.markerAttribs,y=r.halo,b,C,S,x=r.stateMarkerGraphic,E;if((e=e||"")===this.state&&!i||this.selected&&"select"!==e||!1===s.enabled||e&&(u||l&&!1===h.enabled)||e&&g.states&&g.states[e]&&!1===g.states[e].enabled)return;if(this.state=e,m&&(b=r.markerAttribs(this,e)),this.graphic&&!this.hasMockGraphic){if(o&&this.graphic.removeClass("highcharts-point-"+o),e&&this.graphic.addClass("highcharts-point-"+e),!p.styledMode){C=r.pointAttribs(this,e),S=w(p.options.chart.animation,s.animation);let t=C.opacity;r.options.inactiveOtherPoints&&f(t)&&(this.dataLabels||[]).forEach(function(e){e&&!e.hasClass("highcharts-data-label-hidden")&&(e.animate({opacity:t},S),e.connector&&e.connector.animate({opacity:t},S))}),this.graphic.animate(C,S)}b&&this.graphic.animate(b,w(p.options.chart.animation,h.animation,a.animation)),x&&x.hide()}else e&&h&&(E=g.symbol||r.symbol,x&&x.currentSymbol!==E&&(x=x.destroy()),b&&(x?x[i?"animate":"attr"]({x:b.x,y:b.y}):E&&(r.stateMarkerGraphic=x=p.renderer.symbol(E,b.x,b.y,b.width,b.height).add(r.markerGroup),x.currentSymbol=E)),!p.styledMode&&x&&"inactive"!==this.state&&x.attr(r.pointAttribs(this,e))),x&&(x[e&&this.isInside?"show":"hide"](),x.element.point=this,x.addClass(this.getClassName(),!0));let R=s.halo,T=this.graphic||x,M=T&&T.visibility||"inherit";R&&R.size&&T&&"hidden"!==M&&!this.isCluster?(y||(r.halo=y=p.renderer.path().add(T.parentGroup)),y.show()[i?"animate":"attr"]({d:this.haloPath(R.size)}),y.attr({class:"highcharts-halo highcharts-color-"+w(this.colorIndex,r.colorIndex)+(this.className?" "+this.className:""),visibility:M,zIndex:-1}),y.point=this,p.styledMode||y.attr(c({fill:this.color||r.color,"fill-opacity":R.opacity},t.filterUserAttributes(R.attributes||{})))):y&&y.point&&y.point.haloPath&&y.animate({d:y.point.haloPath(0)},null,y.hide),d(this,"afterSetState",{state:e})}haloPath(t){let e=this.pos();return e?this.series.chart.renderer.symbols.circle(Math.floor(e[0])-t,e[1]-t,2*t,2*t):[]}}return x}),i(e,"Core/Pointer.js",[e["Core/Color/Color.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(t,e,i){var r;let{parse:o}=t,{charts:s,composed:n,isTouchDevice:a}=e,{addEvent:l,attr:h,css:c,extend:d,find:u,fireEvent:g,isNumber:p,isObject:f,objectEach:m,offset:y,pick:w,pushUnique:b,splat:C}=i;class S{applyInactiveState(t){let e=[],i;(t||[]).forEach(function(t){i=t.series,e.push(i),i.linkedParent&&e.push(i.linkedParent),i.linkedSeries&&(e=e.concat(i.linkedSeries)),i.navigatorSeries&&e.push(i.navigatorSeries)}),this.chart.series.forEach(function(t){-1===e.indexOf(t)?t.setState("inactive",!0):t.options.inactiveOtherPoints&&t.setAllPointsToState("inactive")})}destroy(){let t=this;this.eventsToUnbind.forEach(t=>t()),this.eventsToUnbind=[],!e.chartCount&&(S.unbindDocumentMouseUp&&(S.unbindDocumentMouseUp=S.unbindDocumentMouseUp()),S.unbindDocumentTouchEnd&&(S.unbindDocumentTouchEnd=S.unbindDocumentTouchEnd())),clearInterval(t.tooltipTimeout),m(t,function(e,i){t[i]=void 0})}getSelectionMarkerAttrs(t,e){let i={args:{chartX:t,chartY:e},attrs:{},shapeType:"rect"};return g(this,"getSelectionMarkerAttrs",i,i=>{let r;let{chart:o,zoomHor:s,zoomVert:n}=this,{mouseDownX:a=0,mouseDownY:l=0}=o,h=i.attrs;h.x=o.plotLeft,h.y=o.plotTop,h.width=s?1:o.plotWidth,h.height=n?1:o.plotHeight,s&&(r=t-a,h.width=Math.max(1,Math.abs(r)),h.x=(r>0?0:r)+a),n&&(r=e-l,h.height=Math.max(1,Math.abs(r)),h.y=(r>0?0:r)+l)}),i}drag(t){let{chart:e}=this,{mouseDownX:i=0,mouseDownY:r=0}=e,{panning:s,panKey:n,selectionMarkerFill:a}=e.options.chart,l=e.plotLeft,h=e.plotTop,c=e.plotWidth,d=e.plotHeight,u=f(s)?s.enabled:s,g=n&&t[`${n}Key`],p=t.chartX,m=t.chartY,y,w=this.selectionMarker;if((!w||!w.touch)&&(p<l?p=l:p>l+c&&(p=l+c),m<h?m=h:m>h+d&&(m=h+d),this.hasDragged=Math.sqrt(Math.pow(i-p,2)+Math.pow(r-m,2)),this.hasDragged>10)){y=e.isInsidePlot(i-l,r-h,{visiblePlotOnly:!0});let{shapeType:n,attrs:c}=this.getSelectionMarkerAttrs(p,m);(e.hasCartesianSeries||e.mapView)&&this.hasZoom&&y&&!g&&!w&&(this.selectionMarker=w=e.renderer[n](),w.attr({class:"highcharts-selection-marker",zIndex:7}).add(),e.styledMode||w.attr({fill:a||o("#334eff").setOpacity(.25).get()})),w&&w.attr(c),y&&!w&&u&&e.pan(t,s)}}dragStart(t){let e=this.chart;e.mouseIsDown=t.type,e.cancelClick=!1,e.mouseDownX=t.chartX,e.mouseDownY=t.chartY}getSelectionBox(t){let e={args:{marker:t},result:t.getBBox()};return g(this,"getSelectionBox",e),e.result}drop(t){let e;let{chart:i,selectionMarker:r}=this;for(let t of i.axes)t.isPanning&&(t.isPanning=!1,(t.options.startOnTick||t.options.endOnTick||t.series.some(t=>t.boosted))&&(t.forceRedraw=!0,t.setExtremes(t.userMin,t.userMax,!1),e=!0));if(e&&i.redraw(),r&&t){if(this.hasDragged){let e=this.getSelectionBox(r);i.transform({axes:i.axes.filter(t=>t.zoomEnabled&&("xAxis"===t.coll&&this.zoomX||"yAxis"===t.coll&&this.zoomY)),selection:{originalEvent:t,xAxis:[],yAxis:[],...e},from:e})}p(i.index)&&(this.selectionMarker=r.destroy())}i&&p(i.index)&&(c(i.container,{cursor:i._cursor}),i.cancelClick=this.hasDragged>10,i.mouseIsDown=!1,this.hasDragged=0,this.pinchDown=[])}findNearestKDPoint(t,e,i){let r;return t.forEach(function(t){var o;let s,n,a,l=!(t.noSharedTooltip&&e)&&0>t.options.findNearestPointBy.indexOf("y"),h=t.searchPoint(i,l);f(h,!0)&&h.series&&(!f(r,!0)||(s=(o=r).distX-h.distX,n=o.dist-h.dist,a=h.series.group?.zIndex-o.series.group?.zIndex,(0!==s&&e?s:0!==n?n:0!==a?a:o.series.index>h.series.index?-1:1)>0))&&(r=h)}),r}getChartCoordinatesFromPoint(t,e){let{xAxis:i,yAxis:r}=t.series,o=t.shapeArgs;if(i&&r){let s=t.clientX??t.plotX??0,n=t.plotY||0;return t.isNode&&o&&p(o.x)&&p(o.y)&&(s=o.x,n=o.y),e?{chartX:r.len+r.pos-n,chartY:i.len+i.pos-s}:{chartX:s+i.pos,chartY:n+r.pos}}if(o&&o.x&&o.y)return{chartX:o.x,chartY:o.y}}getChartPosition(){if(this.chartPosition)return this.chartPosition;let{container:t}=this.chart,e=y(t);this.chartPosition={left:e.left,top:e.top,scaleX:1,scaleY:1};let{offsetHeight:i,offsetWidth:r}=t;return r>2&&i>2&&(this.chartPosition.scaleX=e.width/r,this.chartPosition.scaleY=e.height/i),this.chartPosition}getCoordinates(t){let e={xAxis:[],yAxis:[]};for(let i of this.chart.axes)e[i.isXAxis?"xAxis":"yAxis"].push({axis:i,value:i.toValue(t[i.horiz?"chartX":"chartY"])});return e}getHoverData(t,e,i,r,o,s){let n=[],a=function(t){return t.visible&&!(!o&&t.directTouch)&&w(t.options.enableMouseTracking,!0)},l=e,h,c={chartX:s?s.chartX:void 0,chartY:s?s.chartY:void 0,shared:o};g(this,"beforeGetHoverData",c),h=l&&!l.stickyTracking?[l]:i.filter(t=>t.stickyTracking&&(c.filter||a)(t));let d=r&&t||!s?t:this.findNearestKDPoint(h,o,s);return l=d&&d.series,d&&(o&&!l.noSharedTooltip?(h=i.filter(function(t){return c.filter?c.filter(t):a(t)&&!t.noSharedTooltip})).forEach(function(t){let e=u(t.points,function(t){return t.x===d.x&&!t.isNull});f(e)&&(t.boosted&&t.boost&&(e=t.boost.getPoint(e)),n.push(e))}):n.push(d)),g(this,"afterGetHoverData",c={hoverPoint:d}),{hoverPoint:c.hoverPoint,hoverSeries:l,hoverPoints:n}}getPointFromEvent(t){let e=t.target,i;for(;e&&!i;)i=e.point,e=e.parentNode;return i}onTrackerMouseOut(t){let e=this.chart,i=t.relatedTarget,r=e.hoverSeries;this.isDirectTouch=!1,!r||!i||r.stickyTracking||this.inClass(i,"highcharts-tooltip")||this.inClass(i,"highcharts-series-"+r.index)&&this.inClass(i,"highcharts-tracker")||r.onMouseOut()}inClass(t,e){let i=t,r;for(;i;){if(r=h(i,"class")){if(-1!==r.indexOf(e))return!0;if(-1!==r.indexOf("highcharts-container"))return!1}i=i.parentElement}}constructor(t,e){this.hasDragged=0,this.pointerCaptureEventsToUnbind=[],this.eventsToUnbind=[],this.options=e,this.chart=t,this.runChartClick=!!e.chart.events?.click,this.pinchDown=[],this.setDOMEvents(),g(this,"afterInit")}normalize(t,e){let i=t.touches,r=i?i.length?i.item(0):w(i.changedTouches,t.changedTouches)[0]:t;e||(e=this.getChartPosition());let o=r.pageX-e.left,s=r.pageY-e.top;return d(t,{chartX:Math.round(o/=e.scaleX),chartY:Math.round(s/=e.scaleY)})}onContainerClick(t){let e=this.chart,i=e.hoverPoint,r=this.normalize(t),o=e.plotLeft,s=e.plotTop;!e.cancelClick&&(i&&this.inClass(r.target,"highcharts-tracker")?(g(i.series,"click",d(r,{point:i})),e.hoverPoint&&i.firePointEvent("click",r)):(d(r,this.getCoordinates(r)),e.isInsidePlot(r.chartX-o,r.chartY-s,{visiblePlotOnly:!0})&&g(e,"click",r)))}onContainerMouseDown(t){let i=(1&(t.buttons||t.button))==1;t=this.normalize(t),e.isFirefox&&0!==t.button&&this.onContainerMouseMove(t),(void 0===t.button||i)&&(this.zoomOption(t),i&&t.preventDefault?.(),this.dragStart(t))}onContainerMouseLeave(t){let{pointer:e}=s[w(S.hoverChartIndex,-1)]||{};t=this.normalize(t),this.onContainerMouseMove(t),e&&t.relatedTarget&&!this.inClass(t.relatedTarget,"highcharts-tooltip")&&(e.reset(),e.chartPosition=void 0)}onContainerMouseEnter(){delete this.chartPosition}onContainerMouseMove(t){let e=this.chart,i=e.tooltip,r=this.normalize(t);this.setHoverChartIndex(t),("mousedown"===e.mouseIsDown||this.touchSelect(r))&&this.drag(r),!e.openMenu&&(this.inClass(r.target,"highcharts-tracker")||e.isInsidePlot(r.chartX-e.plotLeft,r.chartY-e.plotTop,{visiblePlotOnly:!0}))&&!(i&&i.shouldStickOnContact(r))&&(this.inClass(r.target,"highcharts-no-tooltip")?this.reset(!1,0):this.runPointActions(r))}onDocumentTouchEnd(t){this.onDocumentMouseUp(t)}onContainerTouchMove(t){this.touchSelect(t)?this.onContainerMouseMove(t):this.touch(t)}onContainerTouchStart(t){this.touchSelect(t)?this.onContainerMouseDown(t):(this.zoomOption(t),this.touch(t,!0))}onDocumentMouseMove(t){let e=this.chart,i=e.tooltip,r=this.chartPosition,o=this.normalize(t,r);!r||e.isInsidePlot(o.chartX-e.plotLeft,o.chartY-e.plotTop,{visiblePlotOnly:!0})||i&&i.shouldStickOnContact(o)||this.inClass(o.target,"highcharts-tracker")||this.reset()}onDocumentMouseUp(t){s[w(S.hoverChartIndex,-1)]?.pointer?.drop(t)}pinch(t){let e=this,{chart:i,hasZoom:r,lastTouches:o}=e,s=[].map.call(t.touches||[],t=>e.normalize(t)),n=s.length,a=1===n&&(e.inClass(t.target,"highcharts-tracker")&&i.runTrackerClick||e.runChartClick),l=i.tooltip,h=1===n&&w(l?.options.followTouchMove,!0);n>1?e.initiated=!0:h&&(e.initiated=!1),r&&e.initiated&&!a&&!1!==t.cancelable&&t.preventDefault(),"touchstart"===t.type?(e.pinchDown=s,e.res=!0):h?this.runPointActions(e.normalize(t)):o&&(g(i,"touchpan",{originalEvent:t,touches:s},()=>{let e=t=>{let e=t[0],i=t[1]||e;return{x:e.chartX,y:e.chartY,width:i.chartX-e.chartX,height:i.chartY-e.chartY}};i.transform({axes:i.axes.filter(t=>t.zoomEnabled&&(this.zoomHor&&t.horiz||this.zoomVert&&!t.horiz)),to:e(s),from:e(o),trigger:t.type})}),e.res&&(e.res=!1,this.reset(!1,0))),e.lastTouches=s}reset(t,e){let i=this.chart,r=i.hoverSeries,o=i.hoverPoint,s=i.hoverPoints,n=i.tooltip,a=n&&n.shared?s:o;t&&a&&C(a).forEach(function(e){e.series.isCartesian&&void 0===e.plotX&&(t=!1)}),t?n&&a&&C(a).length&&(n.refresh(a),n.shared&&s?s.forEach(function(t){t.setState(t.state,!0),t.series.isCartesian&&(t.series.xAxis.crosshair&&t.series.xAxis.drawCrosshair(null,t),t.series.yAxis.crosshair&&t.series.yAxis.drawCrosshair(null,t))}):o&&(o.setState(o.state,!0),i.axes.forEach(function(t){t.crosshair&&o.series[t.coll]===t&&t.drawCrosshair(null,o)}))):(o&&o.onMouseOut(),s&&s.forEach(function(t){t.setState()}),r&&r.onMouseOut(),n&&n.hide(e),this.unDocMouseMove&&(this.unDocMouseMove=this.unDocMouseMove()),i.axes.forEach(function(t){t.hideCrosshair()}),i.hoverPoints=i.hoverPoint=void 0)}runPointActions(t,e,i){let r=this.chart,o=r.series,n=r.tooltip&&r.tooltip.options.enabled?r.tooltip:void 0,a=!!n&&n.shared,h=e||r.hoverPoint,c=h&&h.series||r.hoverSeries,d=(!t||"touchmove"!==t.type)&&(!!e||c&&c.directTouch&&this.isDirectTouch),g=this.getHoverData(h,c,o,d,a,t);h=g.hoverPoint,c=g.hoverSeries;let p=g.hoverPoints,f=c&&c.tooltipOptions.followPointer&&!c.tooltipOptions.split,m=a&&c&&!c.noSharedTooltip;if(h&&(i||h!==r.hoverPoint||n&&n.isHidden)){if((r.hoverPoints||[]).forEach(function(t){-1===p.indexOf(t)&&t.setState()}),r.hoverSeries!==c&&c.onMouseOver(),this.applyInactiveState(p),(p||[]).forEach(function(t){t.setState("hover")}),r.hoverPoint&&r.hoverPoint.firePointEvent("mouseOut"),!h.series)return;r.hoverPoints=p,r.hoverPoint=h,h.firePointEvent("mouseOver",void 0,()=>{n&&h&&n.refresh(m?p:h,t)})}else if(f&&n&&!n.isHidden){let e=n.getAnchor([{}],t);r.isInsidePlot(e[0],e[1],{visiblePlotOnly:!0})&&n.updatePosition({plotX:e[0],plotY:e[1]})}this.unDocMouseMove||(this.unDocMouseMove=l(r.container.ownerDocument,"mousemove",t=>s[S.hoverChartIndex??-1]?.pointer?.onDocumentMouseMove(t)),this.eventsToUnbind.push(this.unDocMouseMove)),r.axes.forEach(function(e){let i;let o=w((e.crosshair||{}).snap,!0);!o||(i=r.hoverPoint)&&i.series[e.coll]===e||(i=u(p,t=>t.series&&t.series[e.coll]===e)),i||!o?e.drawCrosshair(t,i):e.hideCrosshair()})}setDOMEvents(){let t=this.chart.container,e=t.ownerDocument;t.onmousedown=this.onContainerMouseDown.bind(this),t.onmousemove=this.onContainerMouseMove.bind(this),t.onclick=this.onContainerClick.bind(this),this.eventsToUnbind.push(l(t,"mouseenter",this.onContainerMouseEnter.bind(this)),l(t,"mouseleave",this.onContainerMouseLeave.bind(this))),S.unbindDocumentMouseUp||(S.unbindDocumentMouseUp=l(e,"mouseup",this.onDocumentMouseUp.bind(this)));let i=this.chart.renderTo.parentElement;for(;i&&"BODY"!==i.tagName;)this.eventsToUnbind.push(l(i,"scroll",()=>{delete this.chartPosition})),i=i.parentElement;this.eventsToUnbind.push(l(t,"touchstart",this.onContainerTouchStart.bind(this),{passive:!1}),l(t,"touchmove",this.onContainerTouchMove.bind(this),{passive:!1})),S.unbindDocumentTouchEnd||(S.unbindDocumentTouchEnd=l(e,"touchend",this.onDocumentTouchEnd.bind(this),{passive:!1})),this.setPointerCapture(),l(this.chart,"redraw",this.setPointerCapture.bind(this))}setPointerCapture(){if(!a)return;let t=this.pointerCaptureEventsToUnbind,e=this.chart,i=e.container,r=w(e.options.tooltip?.followTouchMove,!0)&&e.series.some(t=>t.options.findNearestPointBy.indexOf("y")>-1);!this.hasPointerCapture&&r?(t.push(l(i,"pointerdown",t=>{t.target?.hasPointerCapture(t.pointerId)&&t.target?.releasePointerCapture(t.pointerId)}),l(i,"pointermove",t=>{e.pointer?.getPointFromEvent(t)?.onMouseOver(t)})),e.styledMode||c(i,{"touch-action":"none"}),i.className+=" highcharts-no-touch-action",this.hasPointerCapture=!0):this.hasPointerCapture&&!r&&(t.forEach(t=>t()),t.length=0,e.styledMode||c(i,{"touch-action":w(e.options.chart.style?.["touch-action"],"manipulation")}),i.className=i.className.replace(" highcharts-no-touch-action",""),this.hasPointerCapture=!1)}setHoverChartIndex(t){let i=this.chart,r=e.charts[w(S.hoverChartIndex,-1)];r&&r!==i&&r.pointer?.onContainerMouseLeave(t||{relatedTarget:i.container}),r&&r.mouseIsDown||(S.hoverChartIndex=i.index)}touch(t,e){let i;let{chart:r,pinchDown:o=[]}=this;this.setHoverChartIndex(),1===t.touches.length?(t=this.normalize(t),r.isInsidePlot(t.chartX-r.plotLeft,t.chartY-r.plotTop,{visiblePlotOnly:!0})&&!r.openMenu?(e&&this.runPointActions(t),"touchmove"===t.type&&(i=!!o[0]&&Math.pow(o[0].chartX-t.chartX,2)+Math.pow(o[0].chartY-t.chartY,2)>=16),w(i,!0)&&this.pinch(t)):e&&this.reset()):2===t.touches.length&&this.pinch(t)}touchSelect(t){return!!(this.chart.zooming.singleTouch&&t.touches&&1===t.touches.length)}zoomOption(t){let e=this.chart,i=e.inverted,r=e.zooming.type||"",o,s;/touch/.test(t.type)&&(r=w(e.zooming.pinchType,r)),this.zoomX=o=/x/.test(r),this.zoomY=s=/y/.test(r),this.zoomHor=o&&!i||s&&i,this.zoomVert=s&&!i||o&&i,this.hasZoom=o||s}}return(r=S||(S={})).compose=function(t){b(n,"Core.Pointer")&&l(t,"beforeRender",function(){this.pointer=new r(this,this.options)})},S}),i(e,"Core/Legend/Legend.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Templating.js"],e["Core/Globals.js"],e["Core/Series/Point.js"],e["Core/Renderer/RendererUtilities.js"],e["Core/Utilities.js"]],function(t,e,i,r,o,s){var n;let{animObject:a,setAnimation:l}=t,{format:h}=e,{composed:c,marginNames:d}=i,{distribute:u}=o,{addEvent:g,createElement:p,css:f,defined:m,discardElement:y,find:w,fireEvent:b,isNumber:C,merge:S,pick:x,pushUnique:E,relativeLength:R,stableSort:T,syncTimeout:M}=s;class k{constructor(t,e){this.allItems=[],this.initialItemY=0,this.itemHeight=0,this.itemMarginBottom=0,this.itemMarginTop=0,this.itemX=0,this.itemY=0,this.lastItemY=0,this.lastLineHeight=0,this.legendHeight=0,this.legendWidth=0,this.maxItemWidth=0,this.maxLegendWidth=0,this.offsetWidth=0,this.padding=0,this.pages=[],this.symbolHeight=0,this.symbolWidth=0,this.titleHeight=0,this.totalItemWidth=0,this.widthOption=0,this.chart=t,this.setOptions(e),e.enabled&&(this.render(),g(this.chart,"endResize",function(){this.legend.positionCheckboxes()})),g(this.chart,"render",()=>{this.options.enabled&&this.proximate&&(this.proximatePositions(),this.positionItems())})}setOptions(t){let e=x(t.padding,8);this.options=t,this.chart.styledMode||(this.itemStyle=t.itemStyle,this.itemHiddenStyle=S(this.itemStyle,t.itemHiddenStyle)),this.itemMarginTop=t.itemMarginTop,this.itemMarginBottom=t.itemMarginBottom,this.padding=e,this.initialItemY=e-5,this.symbolWidth=x(t.symbolWidth,16),this.pages=[],this.proximate="proximate"===t.layout&&!this.chart.inverted,this.baseline=void 0}update(t,e){let i=this.chart;this.setOptions(S(!0,this.options,t)),this.destroy(),i.isDirtyLegend=i.isDirtyBox=!0,x(e,!0)&&i.redraw(),b(this,"afterUpdate",{redraw:e})}colorizeItem(t,e){let{area:i,group:r,label:o,line:s,symbol:n}=t.legendItem||{};if(r?.[e?"removeClass":"addClass"]("highcharts-legend-item-hidden"),!this.chart.styledMode){let{itemHiddenStyle:r={}}=this,a=r.color,{fillColor:l,fillOpacity:h,lineColor:c,marker:d}=t.options,u=t=>(!e&&(t.fill&&(t.fill=a),t.stroke&&(t.stroke=a)),t);o?.css(S(e?this.itemStyle:r)),s?.attr(u({stroke:c||t.color})),n&&n.attr(u(d&&n.isMarker?t.pointAttribs():{fill:t.color})),i?.attr(u({fill:l||t.color,"fill-opacity":l?1:h??.75}))}b(this,"afterColorizeItem",{item:t,visible:e})}positionItems(){this.allItems.forEach(this.positionItem,this),this.chart.isResizing||this.positionCheckboxes()}positionItem(t){let{group:e,x:i=0,y:r=0}=t.legendItem||{},o=this.options,s=o.symbolPadding,n=!o.rtl,a=t.checkbox;if(e&&e.element){let o={translateX:n?i:this.legendWidth-i-2*s-4,translateY:r};e[m(e.translateY)?"animate":"attr"](o,void 0,()=>{b(this,"afterPositionItem",{item:t})})}a&&(a.x=i,a.y=r)}destroyItem(t){let e=t.checkbox,i=t.legendItem||{};for(let t of["group","label","line","symbol"])i[t]&&(i[t]=i[t].destroy());e&&y(e),t.legendItem=void 0}destroy(){for(let t of this.getAllItems())this.destroyItem(t);for(let t of["clipRect","up","down","pager","nav","box","title","group"])this[t]&&(this[t]=this[t].destroy());this.display=null}positionCheckboxes(){let t;let e=this.group&&this.group.alignAttr,i=this.clipHeight||this.legendHeight,r=this.titleHeight;e&&(t=e.translateY,this.allItems.forEach(function(o){let s;let n=o.checkbox;n&&(s=t+r+n.y+(this.scrollOffset||0)+3,f(n,{left:e.translateX+o.checkboxOffset+n.x-20+"px",top:s+"px",display:this.proximate||s>t-6&&s<t+i-6?"":"none"}))},this))}renderTitle(){let t=this.options,e=this.padding,i=t.title,r,o=0;i.text&&(this.title||(this.title=this.chart.renderer.label(i.text,e-3,e-4,void 0,void 0,void 0,t.useHTML,void 0,"legend-title").attr({zIndex:1}),this.chart.styledMode||this.title.css(i.style),this.title.add(this.group)),i.width||this.title.css({width:this.maxLegendWidth+"px"}),o=(r=this.title.getBBox()).height,this.offsetWidth=r.width,this.contentGroup.attr({translateY:o})),this.titleHeight=o}setText(t){let e=this.options;t.legendItem.label.attr({text:e.labelFormat?h(e.labelFormat,t,this.chart):e.labelFormatter.call(t)})}renderItem(t){let e=t.legendItem=t.legendItem||{},i=this.chart,r=i.renderer,o=this.options,s="horizontal"===o.layout,n=this.symbolWidth,a=o.symbolPadding||0,l=this.itemStyle,h=this.itemHiddenStyle,c=s?x(o.itemDistance,20):0,d=!o.rtl,u=!t.series,g=!u&&t.series.drawLegendSymbol?t.series:t,p=g.options,f=!!this.createCheckboxForItem&&p&&p.showCheckbox,m=o.useHTML,y=t.options.className,w=e.label,b=n+a+c+(f?20:0);!w&&(e.group=r.g("legend-item").addClass("highcharts-"+g.type+"-series highcharts-color-"+t.colorIndex+(y?" "+y:"")+(u?" highcharts-series-"+t.index:"")).attr({zIndex:1}).add(this.scrollGroup),e.label=w=r.text("",d?n+a:-a,this.baseline||0,m),i.styledMode||w.css(S(t.visible?l:h)),w.attr({align:d?"left":"right",zIndex:2}).add(e.group),!this.baseline&&(this.fontMetrics=r.fontMetrics(w),this.baseline=this.fontMetrics.f+3+this.itemMarginTop,w.attr("y",this.baseline),this.symbolHeight=x(o.symbolHeight,this.fontMetrics.f),o.squareSymbol&&(this.symbolWidth=x(o.symbolWidth,Math.max(this.symbolHeight,16)),b=this.symbolWidth+a+c+(f?20:0),d&&w.attr("x",this.symbolWidth+a))),g.drawLegendSymbol(this,t),this.setItemEvents&&this.setItemEvents(t,w,m)),f&&!t.checkbox&&this.createCheckboxForItem&&this.createCheckboxForItem(t),this.colorizeItem(t,t.visible),(i.styledMode||!l.width)&&w.css({width:(o.itemWidth||this.widthOption||i.spacingBox.width)-b+"px"}),this.setText(t);let C=w.getBBox(),E=this.fontMetrics&&this.fontMetrics.h||0;t.itemWidth=t.checkboxOffset=o.itemWidth||e.labelWidth||C.width+b,this.maxItemWidth=Math.max(this.maxItemWidth,t.itemWidth),this.totalItemWidth+=t.itemWidth,this.itemHeight=t.itemHeight=Math.round(e.labelHeight||(C.height>1.5*E?C.height:E))}layoutItem(t){let e=this.options,i=this.padding,r="horizontal"===e.layout,o=t.itemHeight,s=this.itemMarginBottom,n=this.itemMarginTop,a=r?x(e.itemDistance,20):0,l=this.maxLegendWidth,h=e.alignColumns&&this.totalItemWidth>l?this.maxItemWidth:t.itemWidth,c=t.legendItem||{};r&&this.itemX-i+h>l&&(this.itemX=i,this.lastLineHeight&&(this.itemY+=n+this.lastLineHeight+s),this.lastLineHeight=0),this.lastItemY=n+this.itemY+s,this.lastLineHeight=Math.max(o,this.lastLineHeight),c.x=this.itemX,c.y=this.itemY,r?this.itemX+=h:(this.itemY+=n+o+s,this.lastLineHeight=o),this.offsetWidth=this.widthOption||Math.max((r?this.itemX-i-(t.checkbox?0:a):h)+i,this.offsetWidth)}getAllItems(){let t=[];return this.chart.series.forEach(function(e){let i=e&&e.options;e&&x(i.showInLegend,!m(i.linkedTo)&&void 0,!0)&&(t=t.concat((e.legendItem||{}).labels||("point"===i.legendType?e.data:e)))}),b(this,"afterGetAllItems",{allItems:t}),t}getAlignment(){let t=this.options;return this.proximate?t.align.charAt(0)+"tv":t.floating?"":t.align.charAt(0)+t.verticalAlign.charAt(0)+t.layout.charAt(0)}adjustMargins(t,e){let i=this.chart,r=this.options,o=this.getAlignment();o&&[/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/].forEach(function(s,n){s.test(o)&&!m(t[n])&&(i[d[n]]=Math.max(i[d[n]],i.legend[(n+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][n]*r[n%2?"x":"y"]+x(r.margin,12)+e[n]+(i.titleOffset[n]||0)))})}proximatePositions(){let t;let e=this.chart,i=[],r="left"===this.options.align;for(let o of(this.allItems.forEach(function(t){let o,s,n=r,a,l;t.yAxis&&(t.xAxis.options.reversed&&(n=!n),t.points&&(o=w(n?t.points:t.points.slice(0).reverse(),function(t){return C(t.plotY)})),s=this.itemMarginTop+t.legendItem.label.getBBox().height+this.itemMarginBottom,l=t.yAxis.top-e.plotTop,a=t.visible?(o?o.plotY:t.yAxis.height)+(l-.3*s):l+t.yAxis.height,i.push({target:a,size:s,item:t}))},this),u(i,e.plotHeight)))t=o.item.legendItem||{},C(o.pos)&&(t.y=e.plotTop-e.spacing[0]+o.pos)}render(){let t=this.chart,e=t.renderer,i=this.options,r=this.padding,o=this.getAllItems(),s,n,a,l=this.group,h,c=this.box;this.itemX=r,this.itemY=this.initialItemY,this.offsetWidth=0,this.lastItemY=0,this.widthOption=R(i.width,t.spacingBox.width-r),h=t.spacingBox.width-2*r-i.x,["rm","lm"].indexOf(this.getAlignment().substring(0,2))>-1&&(h/=2),this.maxLegendWidth=this.widthOption||h,l||(this.group=l=e.g("legend").addClass(i.className||"").attr({zIndex:7}).add(),this.contentGroup=e.g().attr({zIndex:1}).add(l),this.scrollGroup=e.g().add(this.contentGroup)),this.renderTitle(),T(o,(t,e)=>(t.options&&t.options.legendIndex||0)-(e.options&&e.options.legendIndex||0)),i.reversed&&o.reverse(),this.allItems=o,this.display=s=!!o.length,this.lastLineHeight=0,this.maxItemWidth=0,this.totalItemWidth=0,this.itemHeight=0,o.forEach(this.renderItem,this),o.forEach(this.layoutItem,this),n=(this.widthOption||this.offsetWidth)+r,a=this.lastItemY+this.lastLineHeight+this.titleHeight,a=this.handleOverflow(a)+r,c||(this.box=c=e.rect().addClass("highcharts-legend-box").attr({r:i.borderRadius}).add(l)),t.styledMode||c.attr({stroke:i.borderColor,"stroke-width":i.borderWidth||0,fill:i.backgroundColor||"none"}).shadow(i.shadow),n>0&&a>0&&c[c.placed?"animate":"attr"](c.crisp.call({},{x:0,y:0,width:n,height:a},c.strokeWidth())),l[s?"show":"hide"](),t.styledMode&&"none"===l.getStyle("display")&&(n=a=0),this.legendWidth=n,this.legendHeight=a,s&&this.align(),this.proximate||this.positionItems(),b(this,"afterRender")}align(t=this.chart.spacingBox){let e=this.chart,i=this.options,r=t.y;/(lth|ct|rth)/.test(this.getAlignment())&&e.titleOffset[0]>0?r+=e.titleOffset[0]:/(lbh|cb|rbh)/.test(this.getAlignment())&&e.titleOffset[2]>0&&(r-=e.titleOffset[2]),r!==t.y&&(t=S(t,{y:r})),e.hasRendered||(this.group.placed=!1),this.group.align(S(i,{width:this.legendWidth,height:this.legendHeight,verticalAlign:this.proximate?"top":i.verticalAlign}),!0,t)}handleOverflow(t){let e=this,i=this.chart,r=i.renderer,o=this.options,s=o.y,n="top"===o.verticalAlign,a=this.padding,l=o.maxHeight,h=o.navigation,c=x(h.animation,!0),d=h.arrowSize||12,u=this.pages,g=this.allItems,p=function(t){"number"==typeof t?S.attr({height:t}):S&&(e.clipRect=S.destroy(),e.contentGroup.clip()),e.contentGroup.div&&(e.contentGroup.div.style.clip=t?"rect("+a+"px,9999px,"+(a+t)+"px,0)":"auto")},f=function(t){return e[t]=r.circle(0,0,1.3*d).translate(d/2,d/2).add(C),i.styledMode||e[t].attr("fill","rgba(0,0,0,0.0001)"),e[t]},m,y,w,b=i.spacingBox.height+(n?-s:s)-a,C=this.nav,S=this.clipRect;return"horizontal"!==o.layout||"middle"===o.verticalAlign||o.floating||(b/=2),l&&(b=Math.min(b,l)),u.length=0,t&&b>0&&t>b&&!1!==h.enabled?(this.clipHeight=m=Math.max(b-20-this.titleHeight-a,0),this.currentPage=x(this.currentPage,1),this.fullHeight=t,g.forEach((t,e)=>{let i=(w=t.legendItem||{}).y||0,r=Math.round(w.label.getBBox().height),o=u.length;(!o||i-u[o-1]>m&&(y||i)!==u[o-1])&&(u.push(y||i),o++),w.pageIx=o-1,y&&((g[e-1].legendItem||{}).pageIx=o-1),e===g.length-1&&i+r-u[o-1]>m&&i>u[o-1]&&(u.push(i),w.pageIx=o),i!==y&&(y=i)}),S||(S=e.clipRect=r.clipRect(0,a-2,9999,0),e.contentGroup.clip(S)),p(m),C||(this.nav=C=r.g().attr({zIndex:1}).add(this.group),this.up=r.symbol("triangle",0,0,d,d).add(C),f("upTracker").on("click",function(){e.scroll(-1,c)}),this.pager=r.text("",15,10).addClass("highcharts-legend-navigation"),!i.styledMode&&h.style&&this.pager.css(h.style),this.pager.add(C),this.down=r.symbol("triangle-down",0,0,d,d).add(C),f("downTracker").on("click",function(){e.scroll(1,c)})),e.scroll(0),t=b):C&&(p(),this.nav=C.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),t}scroll(t,e){let i=this.chart,r=this.pages,o=r.length,s=this.clipHeight,n=this.options.navigation,h=this.pager,c=this.padding,d=this.currentPage+t;d>o&&(d=o),d>0&&(void 0!==e&&l(e,i),this.nav.attr({translateX:c,translateY:s+this.padding+7+this.titleHeight,visibility:"inherit"}),[this.up,this.upTracker].forEach(function(t){t.attr({class:1===d?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})}),h.attr({text:d+"/"+o}),[this.down,this.downTracker].forEach(function(t){t.attr({x:18+this.pager.getBBox().width,class:d===o?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})},this),i.styledMode||(this.up.attr({fill:1===d?n.inactiveColor:n.activeColor}),this.upTracker.css({cursor:1===d?"default":"pointer"}),this.down.attr({fill:d===o?n.inactiveColor:n.activeColor}),this.downTracker.css({cursor:d===o?"default":"pointer"})),this.scrollOffset=-r[d-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=d,this.positionCheckboxes(),M(()=>{b(this,"afterScroll",{currentPage:d})},a(x(e,i.renderer.globalAnimation,!0)).duration))}setItemEvents(t,e,i){let o=this,s=t.legendItem||{},n=o.chart.renderer.boxWrapper,a=t instanceof r,l="highcharts-legend-"+(a?"point":"series")+"-active",h=o.chart.styledMode,c=i?[e,s.symbol]:[s.group],d=e=>{o.allItems.forEach(i=>{t!==i&&[i].concat(i.linkedSeries||[]).forEach(t=>{t.setState(e,!a)})})};for(let i of c)i&&i.on("mouseover",function(){t.visible&&d("inactive"),t.setState("hover"),t.visible&&n.addClass(l),h||e.css(o.options.itemHoverStyle)}).on("mouseout",function(){o.chart.styledMode||e.css(S(t.visible?o.itemStyle:o.itemHiddenStyle)),d(""),n.removeClass(l),t.setState()}).on("click",function(e){let i="legendItemClick",r=function(){t.setVisible&&t.setVisible(),d(t.visible?"inactive":"")};n.removeClass(l),e={browserEvent:e},t.firePointEvent?t.firePointEvent(i,e,r):b(t,i,e,r)})}createCheckboxForItem(t){t.checkbox=p("input",{type:"checkbox",className:"highcharts-legend-checkbox",checked:t.selected,defaultChecked:t.selected},this.options.itemCheckboxStyle,this.chart.container),g(t.checkbox,"click",function(e){let i=e.target;b(t.series||t,"checkboxClick",{checked:i.checked,item:t},function(){t.select()})})}}return(n=k||(k={})).compose=function(t){E(c,"Core.Legend")&&g(t,"beforeMargins",function(){this.legend=new n(this,this.options.legend)})},k}),i(e,"Core/Legend/LegendSymbol.js",[e["Core/Utilities.js"]],function(t){var e;let{extend:i,merge:r,pick:o}=t;return function(t){function e(t,e,s){let n=this.legendItem=this.legendItem||{},{chart:a,options:l}=this,{baseline:h=0,symbolWidth:c,symbolHeight:d}=t,u=this.symbol||"circle",g=d/2,p=a.renderer,f=n.group,m=h-Math.round(d*(s?.4:.3)),y={},w,b=l.marker,C=0;if(a.styledMode||(y["stroke-width"]=Math.min(l.lineWidth||0,24),l.dashStyle?y.dashstyle=l.dashStyle:"square"===l.linecap||(y["stroke-linecap"]="round")),n.line=p.path().addClass("highcharts-graph").attr(y).add(f),s&&(n.area=p.path().addClass("highcharts-area").add(f)),y["stroke-linecap"]&&(C=Math.min(n.line.strokeWidth(),c)/2),c){let t=[["M",C,m],["L",c-C,m]];n.line.attr({d:t}),n.area?.attr({d:[...t,["L",c-C,h],["L",C,h]]})}if(b&&!1!==b.enabled&&c){let t=Math.min(o(b.radius,g),g);0===u.indexOf("url")&&(b=r(b,{width:d,height:d}),t=0),n.symbol=w=p.symbol(u,c/2-t,m-t,2*t,2*t,i({context:"legend"},b)).addClass("highcharts-point").add(f),w.isMarker=!0}}t.areaMarker=function(t,i){e.call(this,t,i,!0)},t.lineMarker=e,t.rectangle=function(t,e){let i=e.legendItem||{},r=t.options,s=t.symbolHeight,n=r.squareSymbol,a=n?s:t.symbolWidth;i.symbol=this.chart.renderer.rect(n?(t.symbolWidth-s)/2:0,t.baseline-s+1,a,s,o(t.options.symbolRadius,s/2)).addClass("highcharts-point").attr({zIndex:3}).add(i.group)}}(e||(e={})),e}),i(e,"Core/Series/SeriesDefaults.js",[],function(){return{lineWidth:2,allowPointSelect:!1,crisp:!0,showCheckbox:!1,animation:{duration:1e3},enableMouseTracking:!0,events:{},marker:{enabledThreshold:2,lineColor:"#ffffff",lineWidth:0,radius:4,states:{normal:{animation:!0},hover:{animation:{duration:150},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{animation:{},align:"center",borderWidth:0,defer:!0,formatter:function(){let{numberFormatter:t}=this.series.chart;return"number"!=typeof this.y?"":t(this.y,-1)},padding:5,style:{fontSize:"0.7em",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0},cropThreshold:300,opacity:1,pointRange:0,softThreshold:!0,states:{normal:{animation:!0},hover:{animation:{duration:150},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{animation:{duration:0}},inactive:{animation:{duration:150},opacity:.2}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"}}),i(e,"Core/Series/SeriesRegistry.js",[e["Core/Globals.js"],e["Core/Defaults.js"],e["Core/Series/Point.js"],e["Core/Utilities.js"]],function(t,e,i,r){var o;let{defaultOptions:s}=e,{extend:n,extendClass:a,merge:l}=r;return function(e){function r(t,r){let o=s.plotOptions||{},n=r.defaultOptions,a=r.prototype;return a.type=t,a.pointClass||(a.pointClass=i),!e.seriesTypes[t]&&(n&&(o[t]=n),e.seriesTypes[t]=r,!0)}e.seriesTypes=t.seriesTypes,e.registerSeriesType=r,e.seriesType=function(t,o,h,c,d){let u=s.plotOptions||{};if(o=o||"",u[t]=l(u[o],h),delete e.seriesTypes[t],r(t,a(e.seriesTypes[o]||function(){},c)),e.seriesTypes[t].prototype.type=t,d){class r extends i{}n(r.prototype,d),e.seriesTypes[t].prototype.pointClass=r}return e.seriesTypes[t]}}(o||(o={})),o}),i(e,"Core/Series/Series.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Defaults.js"],e["Core/Foundation.js"],e["Core/Globals.js"],e["Core/Legend/LegendSymbol.js"],e["Core/Series/Point.js"],e["Core/Series/SeriesDefaults.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Renderer/SVG/SVGElement.js"],e["Core/Utilities.js"]],function(t,e,i,r,o,s,n,a,l,h){let{animObject:c,setAnimation:d}=t,{defaultOptions:u}=e,{registerEventOptions:g}=i,{svg:p,win:f}=r,{seriesTypes:m}=a,{arrayMax:y,arrayMin:w,clamp:b,correctFloat:C,defined:S,destroyObjectProperties:x,diffObjects:E,erase:R,error:T,extend:M,find:k,fireEvent:A,getClosestDistance:O,getNestedProperty:P,insertItem:I,isArray:H,isNumber:L,isString:D,merge:N,objectEach:_,pick:F,removeEvent:j,splat:B,syncTimeout:W}=h;class V{constructor(){this.zoneAxis="y"}init(t,e){let i;A(this,"init",{options:e});let r=this,o=t.series;this.eventsToUnbind=[],r.chart=t,r.options=r.setOptions(e);let s=r.options,n=!1!==s.visible;r.linkedSeries=[],r.bindAxes(),M(r,{name:s.name,state:"",visible:n,selected:!0===s.selected}),g(this,s);let a=s.events;(a&&a.click||s.point&&s.point.events&&s.point.events.click||s.allowPointSelect)&&(t.runTrackerClick=!0),r.getColor(),r.getSymbol(),r.parallelArrays.forEach(function(t){r[t+"Data"]||(r[t+"Data"]=[])}),r.isCartesian&&(t.hasCartesianSeries=!0),o.length&&(i=o[o.length-1]),r._i=F(i&&i._i,-1)+1,r.opacity=r.options.opacity,t.orderItems("series",I(this,o)),s.dataSorting&&s.dataSorting.enabled?r.setDataSortingOptions():r.points||r.data||r.setData(s.data,!1),A(this,"afterInit")}is(t){return m[t]&&this instanceof m[t]}bindAxes(){let t;let e=this,i=e.options,r=e.chart;A(this,"bindAxes",null,function(){(e.axisTypes||[]).forEach(function(o){(r[o]||[]).forEach(function(r){t=r.options,(F(i[o],0)===r.index||void 0!==i[o]&&i[o]===t.id)&&(I(e,r.series),e[o]=r,r.isDirty=!0)}),e[o]||e.optionalAxis===o||T(18,!0,r)})}),A(this,"afterBindAxes")}updateParallelArrays(t,e,i){let r=t.series,o=L(e)?function(i){let o="y"===i&&r.toYData?r.toYData(t):t[i];r[i+"Data"][e]=o}:function(t){Array.prototype[e].apply(r[t+"Data"],i)};r.parallelArrays.forEach(o)}hasData(){return this.visible&&void 0!==this.dataMax&&void 0!==this.dataMin||this.visible&&this.yData&&this.yData.length>0}hasMarkerChanged(t,e){let i=t.marker,r=e.marker||{};return i&&(r.enabled&&!i.enabled||r.symbol!==i.symbol||r.height!==i.height||r.width!==i.width)}autoIncrement(t){let e=this.options,i=e.pointIntervalUnit,r=e.relativeXValue,o=this.chart.time,s=this.xIncrement,n,a;return(s=F(s,e.pointStart,0),this.pointInterval=a=F(this.pointInterval,e.pointInterval,1),r&&L(t)&&(a*=t),i&&(n=new o.Date(s),"day"===i?o.set("Date",n,o.get("Date",n)+a):"month"===i?o.set("Month",n,o.get("Month",n)+a):"year"===i&&o.set("FullYear",n,o.get("FullYear",n)+a),a=n.getTime()-s),r&&L(t))?s+a:(this.xIncrement=s+a,s)}setDataSortingOptions(){let t=this.options;M(this,{requireSorting:!1,sorted:!1,enabledDataSorting:!0,allowDG:!1}),S(t.pointRange)||(t.pointRange=1)}setOptions(t){let e;let i=this.chart,r=i.options.plotOptions,o=i.userOptions||{},s=N(t),n=i.styledMode,a={plotOptions:r,userOptions:s};A(this,"setOptions",a);let l=a.plotOptions[this.type],h=o.plotOptions||{},c=h.series||{},d=u.plotOptions[this.type]||{},g=h[this.type]||{};this.userOptions=a.userOptions;let p=N(l,r.series,g,s);this.tooltipOptions=N(u.tooltip,u.plotOptions.series?.tooltip,d?.tooltip,i.userOptions.tooltip,h.series?.tooltip,g.tooltip,s.tooltip),this.stickyTracking=F(s.stickyTracking,g.stickyTracking,c.stickyTracking,!!this.tooltipOptions.shared&&!this.noSharedTooltip||p.stickyTracking),null===l.marker&&delete p.marker,this.zoneAxis=p.zoneAxis||"y";let f=this.zones=(p.zones||[]).map(t=>({...t}));return(p.negativeColor||p.negativeFillColor)&&!p.zones&&(e={value:p[this.zoneAxis+"Threshold"]||p.threshold||0,className:"highcharts-negative"},n||(e.color=p.negativeColor,e.fillColor=p.negativeFillColor),f.push(e)),f.length&&S(f[f.length-1].value)&&f.push(n?{}:{color:this.color,fillColor:this.fillColor}),A(this,"afterSetOptions",{options:p}),p}getName(){return F(this.options.name,"Series "+(this.index+1))}getCyclic(t,e,i){let r,o;let s=this.chart,n=`${t}Index`,a=`${t}Counter`,l=i?.length||s.options.chart.colorCount;!e&&(S(o=F("color"===t?this.options.colorIndex:void 0,this[n]))?r=o:(s.series.length||(s[a]=0),r=s[a]%l,s[a]+=1),i&&(e=i[r])),void 0!==r&&(this[n]=r),this[t]=e}getColor(){this.chart.styledMode?this.getCyclic("color"):this.options.colorByPoint?this.color="#cccccc":this.getCyclic("color",this.options.color||u.plotOptions[this.type].color,this.chart.options.colors)}getPointsCollection(){return(this.hasGroupedData?this.points:this.data)||[]}getSymbol(){let t=this.options.marker;this.getCyclic("symbol",t.symbol,this.chart.options.symbols)}findPointIndex(t,e){let i,r,o;let n=t.id,a=t.x,l=this.points,h=this.options.dataSorting;if(n){let t=this.chart.get(n);t instanceof s&&(i=t)}else if(this.linkedParent||this.enabledDataSorting||this.options.relativeXValue){let e=e=>!e.touched&&e.index===t.index;if(h&&h.matchByName?e=e=>!e.touched&&e.name===t.name:this.options.relativeXValue&&(e=e=>!e.touched&&e.options.x===t.x),!(i=k(l,e)))return}return i&&void 0!==(o=i&&i.index)&&(r=!0),void 0===o&&L(a)&&(o=this.xData.indexOf(a,e)),-1!==o&&void 0!==o&&this.cropped&&(o=o>=this.cropStart?o-this.cropStart:o),!r&&L(o)&&l[o]&&l[o].touched&&(o=void 0),o}updateData(t,e){let i=this.options,r=i.dataSorting,o=this.points,s=[],n=this.requireSorting,a=t.length===o.length,l,h,c,d,u=!0;if(this.xIncrement=null,t.forEach(function(t,e){let h;let c=S(t)&&this.pointClass.prototype.optionsToObject.call({series:this},t)||{},u=c.x;c.id||L(u)?(-1===(h=this.findPointIndex(c,d))||void 0===h?s.push(t):o[h]&&t!==i.data[h]?(o[h].update(t,!1,null,!1),o[h].touched=!0,n&&(d=h+1)):o[h]&&(o[h].touched=!0),(!a||e!==h||r&&r.enabled||this.hasDerivedData)&&(l=!0)):s.push(t)},this),l)for(h=o.length;h--;)(c=o[h])&&!c.touched&&c.remove&&c.remove(!1,e);else!a||r&&r.enabled?u=!1:(t.forEach(function(t,e){t===o[e].y||o[e].destroyed||o[e].update(t,!1,null,!1)}),s.length=0);return o.forEach(function(t){t&&(t.touched=!1)}),!!u&&(s.forEach(function(t){this.addPoint(t,!1,null,null,!1)},this),null===this.xIncrement&&this.xData&&this.xData.length&&(this.xIncrement=y(this.xData),this.autoIncrement()),!0)}setData(t,e=!0,i,r){let o=this,s=o.points,n=s&&s.length||0,a=o.options,l=o.chart,h=a.dataSorting,c=o.xAxis,d=a.turboThreshold,u=this.xData,g=this.yData,p=o.pointArrayMap,f=p&&p.length,m=a.keys,y,w,b,C=0,S=1,x=null,E;l.options.chart.allowMutatingData||(a.data&&delete o.options.data,o.userOptions.data&&delete o.userOptions.data,E=N(!0,t));let R=(t=E||t||[]).length;if(h&&h.enabled&&(t=this.sortData(t)),l.options.chart.allowMutatingData&&!1!==r&&R&&n&&!o.cropped&&!o.hasGroupedData&&o.visible&&!o.boosted&&(b=this.updateData(t,i)),!b){if(o.xIncrement=null,o.colorCounter=0,this.parallelArrays.forEach(function(t){o[t+"Data"].length=0}),d&&R>d){if(L(x=o.getFirstValidPoint(t)))for(y=0;y<R;y++)u[y]=this.autoIncrement(),g[y]=t[y];else if(H(x)){if(f){if(x.length===f)for(y=0;y<R;y++)u[y]=this.autoIncrement(),g[y]=t[y];else for(y=0;y<R;y++)w=t[y],u[y]=w[0],g[y]=w.slice(1,f+1)}else if(m&&(C=m.indexOf("x"),S=m.indexOf("y"),C=C>=0?C:0,S=S>=0?S:1),1===x.length&&(S=0),C===S)for(y=0;y<R;y++)u[y]=this.autoIncrement(),g[y]=t[y][S];else for(y=0;y<R;y++)w=t[y],u[y]=w[C],g[y]=w[S]}else T(12,!1,l)}else for(y=0;y<R;y++)w={series:o},o.pointClass.prototype.applyOptions.apply(w,[t[y]]),o.updateParallelArrays(w,y);for(g&&D(g[0])&&T(14,!0,l),o.data=[],o.options.data=o.userOptions.data=t,y=n;y--;)s[y]?.destroy();c&&(c.minRange=c.userMinRange),o.isDirty=l.isDirtyBox=!0,o.isDirtyData=!!s,i=!1}"point"===a.legendType&&(this.processData(),this.generatePoints()),e&&l.redraw(i)}sortData(t){let e=this,i=e.options.dataSorting.sortKey||"y",r=function(t,e){return S(e)&&t.pointClass.prototype.optionsToObject.call({series:t},e)||{}};return t.forEach(function(i,o){t[o]=r(e,i),t[o].index=o},this),t.concat().sort((t,e)=>{let r=P(i,t),o=P(i,e);return o<r?-1:o>r?1:0}).forEach(function(t,e){t.x=e},this),e.linkedSeries&&e.linkedSeries.forEach(function(e){let i=e.options,o=i.data;i.dataSorting&&i.dataSorting.enabled||!o||(o.forEach(function(i,s){o[s]=r(e,i),t[s]&&(o[s].x=t[s].x,o[s].index=s)}),e.setData(o,!1))}),t}getProcessedData(t){let e=this,i=e.xAxis,r=e.options,o=r.cropThreshold,s=t||e.getExtremesFromAll||r.getExtremesFromAll,n=i?.logarithmic,a=e.isCartesian,l,h,c=0,d,u,g,p=e.xData,f=e.yData,m=!1,y=p.length;i&&(u=(d=i.getExtremes()).min,g=d.max,m=!!(i.categories&&!i.names.length)),a&&e.sorted&&!s&&(!o||y>o||e.forceCrop)&&(p[y-1]<u||p[0]>g?(p=[],f=[]):e.yData&&(p[0]<u||p[y-1]>g)&&(p=(l=this.cropData(e.xData,e.yData,u,g)).xData,f=l.yData,c=l.start,h=!0));let w=O([n?p.map(n.log2lin):p],()=>e.requireSorting&&!m&&T(15,!1,e.chart));return{xData:p,yData:f,cropped:h,cropStart:c,closestPointRange:w}}processData(t){let e=this.xAxis;if(this.isCartesian&&!this.isDirty&&!e.isDirty&&!this.yAxis.isDirty&&!t)return!1;let i=this.getProcessedData();this.cropped=i.cropped,this.cropStart=i.cropStart,this.processedXData=i.xData,this.processedYData=i.yData,this.closestPointRange=this.basePointRange=i.closestPointRange,A(this,"afterProcessData")}cropData(t,e,i,r){let o=t.length,s,n,a=0,l=o;for(s=0;s<o;s++)if(t[s]>=i){a=Math.max(0,s-1);break}for(n=s;n<o;n++)if(t[n]>r){l=n+1;break}return{xData:t.slice(a,l),yData:e.slice(a,l),start:a,end:l}}generatePoints(){let t=this.options,e=this.processedData||t.data,i=this.processedXData,r=this.processedYData,o=this.pointClass,s=i.length,n=this.cropStart||0,a=this.hasGroupedData,l=t.keys,h=[],c=t.dataGrouping&&t.dataGrouping.groupAll?n:0,d,u,g,p,f=this.data;if(!f&&!a){let t=[];t.length=e.length,f=this.data=t}for(l&&a&&(this.options.keys=!1),p=0;p<s;p++)u=n+p,a?((g=new o(this,[i[p]].concat(B(r[p])))).dataGroup=this.groupMap[c+p],g.dataGroup.options&&(g.options=g.dataGroup.options,M(g,g.dataGroup.options),delete g.dataLabels)):(g=f[u])||void 0===e[u]||(f[u]=g=new o(this,e[u],i[p])),g&&(g.index=a?c+p:u,h[p]=g);if(this.options.keys=l,f&&(s!==(d=f.length)||a))for(p=0;p<d;p++)p!==n||a||(p+=s),f[p]&&(f[p].destroyElements(),f[p].plotX=void 0);this.data=f,this.points=h,A(this,"afterGeneratePoints")}getXExtremes(t){return{min:w(t),max:y(t)}}getExtremes(t,e){let i=this.xAxis,r=this.yAxis,o=this.processedXData||this.xData,s=[],n=this.requireSorting&&!this.is("column")?1:0,a=!!r&&r.positiveValuesOnly,l,h,c,d,u,g,p,f=0,m=0,b=0,C=(t=t||this.stackedYData||this.processedYData||[]).length;for(i&&(f=(l=i.getExtremes()).min,m=l.max),g=0;g<C;g++)if(d=o[g],h=(L(u=t[g])||H(u))&&((L(u)?u>0:u.length)||!a),c=e||this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||!i||(o[g+n]||d)>=f&&(o[g-n]||d)<=m,h&&c){if(p=u.length)for(;p--;)L(u[p])&&(s[b++]=u[p]);else s[b++]=u}let S={activeYData:s,dataMin:w(s),dataMax:y(s)};return A(this,"afterGetExtremes",{dataExtremes:S}),S}applyExtremes(){let t=this.getExtremes();return this.dataMin=t.dataMin,this.dataMax=t.dataMax,t}getFirstValidPoint(t){let e=t.length,i=0,r=null;for(;null===r&&i<e;)r=t[i],i++;return r}translate(){this.processedXData||this.processData(),this.generatePoints();let t=this.options,e=t.stacking,i=this.xAxis,r=i.categories,o=this.enabledDataSorting,s=this.yAxis,n=this.points,a=n.length,l=this.pointPlacementToXValue(),h=!!l,c=t.threshold,d=t.startFromThreshold?c:0,u,g,p,f,m=Number.MAX_VALUE;function y(t){return b(t,-1e5,1e5)}for(u=0;u<a;u++){let t;let a=n[u],w=a.x,b,x,E=a.y,R=a.low,T=e&&s.stacking?.stacks[(this.negStacks&&E<(d?0:c)?"-":"")+this.stackKey];g=i.translate(w,!1,!1,!1,!0,l),a.plotX=L(g)?C(y(g)):void 0,e&&this.visible&&T&&T[w]&&(f=this.getStackIndicator(f,w,this.index),!a.isNull&&f.key&&(x=(b=T[w]).points[f.key]),b&&H(x)&&(R=x[0],E=x[1],R===d&&f.key===T[w].base&&(R=F(L(c)?c:s.min)),s.positiveValuesOnly&&S(R)&&R<=0&&(R=void 0),a.total=a.stackTotal=F(b.total),a.percentage=S(a.y)&&b.total?a.y/b.total*100:void 0,a.stackY=E,this.irregularWidths||b.setOffset(this.pointXOffset||0,this.barW||0,void 0,void 0,void 0,this.xAxis))),a.yBottom=S(R)?y(s.translate(R,!1,!0,!1,!0)):void 0,this.dataModify&&(E=this.dataModify.modifyValue(E,u)),L(E)&&void 0!==a.plotX&&(t=L(t=s.translate(E,!1,!0,!1,!0))?y(t):void 0),a.plotY=t,a.isInside=this.isPointInside(a),a.clientX=h?C(i.translate(w,!1,!1,!1,!0,l)):g,a.negative=(a.y||0)<(c||0),a.category=F(r&&r[a.x],a.x),a.isNull||!1===a.visible||(void 0!==p&&(m=Math.min(m,Math.abs(g-p))),p=g),a.zone=this.zones.length?a.getZone():void 0,!a.graphic&&this.group&&o&&(a.isNew=!0)}this.closestPointRangePx=m,A(this,"afterTranslate")}getValidPoints(t,e,i){let r=this.chart;return(t||this.points||[]).filter(function(t){let{plotX:o,plotY:s}=t;return!!((i||!t.isNull&&L(s))&&(!e||r.isInsidePlot(o,s,{inverted:r.inverted})))&&!1!==t.visible})}getClipBox(){let{chart:t,xAxis:e,yAxis:i}=this,{x:r,y:o,width:s,height:n}=N(t.clipBox);return e&&e.len!==t.plotSizeX&&(s=e.len),i&&i.len!==t.plotSizeY&&(n=i.len),t.inverted&&!this.invertible&&([s,n]=[n,s]),{x:r,y:o,width:s,height:n}}getSharedClipKey(){return this.sharedClipKey=(this.options.xAxis||0)+","+(this.options.yAxis||0),this.sharedClipKey}setClip(){let{chart:t,group:e,markerGroup:i}=this,r=t.sharedClips,o=t.renderer,s=this.getClipBox(),n=this.getSharedClipKey(),a=r[n];a?a.animate(s):r[n]=a=o.clipRect(s),e&&e.clip(!1===this.options.clip?void 0:a),i&&i.clip()}animate(t){let{chart:e,group:i,markerGroup:r}=this,o=e.inverted,s=c(this.options.animation),n=[this.getSharedClipKey(),s.duration,s.easing,s.defer].join(","),a=e.sharedClips[n],l=e.sharedClips[n+"m"];if(t&&i){let t=this.getClipBox();if(a)a.attr("height",t.height);else{t.width=0,o&&(t.x=e.plotHeight),a=e.renderer.clipRect(t),e.sharedClips[n]=a;let i={x:-99,y:-99,width:o?e.plotWidth+199:99,height:o?99:e.plotHeight+199};l=e.renderer.clipRect(i),e.sharedClips[n+"m"]=l}i.clip(a),r?.clip(l)}else if(a&&!a.hasClass("highcharts-animating")){let t=this.getClipBox(),i=s.step;(r?.element.childNodes.length||e.series.length>1)&&(s.step=function(t,e){i&&i.apply(e,arguments),"width"===e.prop&&l?.element&&l.attr(o?"height":"width",t+99)}),a.addClass("highcharts-animating").animate(t,s)}}afterAnimate(){this.setClip(),_(this.chart.sharedClips,(t,e,i)=>{t&&!this.chart.container.querySelector(`[clip-path="url(#${t.id})"]`)&&(t.destroy(),delete i[e])}),this.finishedAnimating=!0,A(this,"afterAnimate")}drawPoints(t=this.points){let e,i,r,o,s,n,a;let l=this.chart,h=l.styledMode,{colorAxis:c,options:d}=this,u=d.marker,g=this[this.specialGroup||"markerGroup"],p=this.xAxis,f=F(u.enabled,!p||!!p.isRadial||null,this.closestPointRangePx>=u.enabledThreshold*u.radius);if(!1!==u.enabled||this._hasPointMarkers)for(e=0;e<t.length;e++)if(o=(r=(i=t[e]).graphic)?"animate":"attr",s=i.marker||{},n=!!i.marker,(f&&void 0===s.enabled||s.enabled)&&!i.isNull&&!1!==i.visible){let t=F(s.symbol,this.symbol,"rect");a=this.markerAttribs(i,i.selected&&"select"),this.enabledDataSorting&&(i.startXPos=p.reversed?-(a.width||0):p.width);let e=!1!==i.isInside;if(!r&&e&&((a.width||0)>0||i.hasImage)&&(i.graphic=r=l.renderer.symbol(t,a.x,a.y,a.width,a.height,n?s:u).add(g),this.enabledDataSorting&&l.hasRendered&&(r.attr({x:i.startXPos}),o="animate")),r&&"animate"===o&&r[e?"show":"hide"](e).animate(a),r){let t=this.pointAttribs(i,h||!i.selected?void 0:"select");h?c&&r.css({fill:t.fill}):r[o](t)}r&&r.addClass(i.getClassName(),!0)}else r&&(i.graphic=r.destroy())}markerAttribs(t,e){let i=this.options,r=i.marker,o=t.marker||{},s=o.symbol||r.symbol,n={},a,l,h=F(o.radius,r&&r.radius);e&&(a=r.states[e],h=F((l=o.states&&o.states[e])&&l.radius,a&&a.radius,h&&h+(a&&a.radiusPlus||0))),t.hasImage=s&&0===s.indexOf("url"),t.hasImage&&(h=0);let c=t.pos();return L(h)&&c&&(n.x=c[0]-h,n.y=c[1]-h,i.crisp&&(n.x=Math.floor(n.x))),h&&(n.width=n.height=2*h),n}pointAttribs(t,e){let i=this.options.marker,r=t&&t.options,o=r&&r.marker||{},s=r&&r.color,n=t&&t.color,a=t&&t.zone&&t.zone.color,l,h,c=this.color,d,u,g=F(o.lineWidth,i.lineWidth),p=1;return c=s||a||n||c,d=o.fillColor||i.fillColor||c,u=o.lineColor||i.lineColor||c,e=e||"normal",l=i.states[e]||{},g=F((h=o.states&&o.states[e]||{}).lineWidth,l.lineWidth,g+F(h.lineWidthPlus,l.lineWidthPlus,0)),d=h.fillColor||l.fillColor||d,{stroke:u=h.lineColor||l.lineColor||u,"stroke-width":g,fill:d,opacity:p=F(h.opacity,l.opacity,p)}}destroy(t){let e,i,r;let o=this,s=o.chart,n=/AppleWebKit\/533/.test(f.navigator.userAgent),a=o.data||[];for(A(o,"destroy",{keepEventsForUpdate:t}),this.removeEvents(t),(o.axisTypes||[]).forEach(function(t){(r=o[t])&&r.series&&(R(r.series,o),r.isDirty=r.forceRedraw=!0)}),o.legendItem&&o.chart.legend.destroyItem(o),e=a.length;e--;)(i=a[e])&&i.destroy&&i.destroy();for(let t of o.zones)x(t,void 0,!0);h.clearTimeout(o.animationTimeout),_(o,function(t,e){t instanceof l&&!t.survive&&t[n&&"group"===e?"hide":"destroy"]()}),s.hoverSeries===o&&(s.hoverSeries=void 0),R(s.series,o),s.orderItems("series"),_(o,function(e,i){t&&"hcEvents"===i||delete o[i]})}applyZones(){let{area:t,chart:e,graph:i,zones:r,points:o,xAxis:s,yAxis:n,zoneAxis:a}=this,{inverted:l,renderer:h}=e,c=this[`${a}Axis`],{isXAxis:d,len:u=0}=c||{},g=(i?.strokeWidth()||0)/2+1,p=(t,e=0,i=0)=>{l&&(i=u-i);let{translated:r=0,lineClip:o}=t,s=i-r;o?.push(["L",e,Math.abs(s)<g?i-g*(s<=0?-1:1):r])};if(r.length&&(i||t)&&c&&L(c.min)){let e=c.getExtremes().max,g=t=>{t.forEach((e,i)=>{("M"===e[0]||"L"===e[0])&&(t[i]=[e[0],d?u-e[1]:e[1],d?e[2]:u-e[2]])})};if(r.forEach(t=>{t.lineClip=[],t.translated=b(c.toPixels(F(t.value,e),!0)||0,0,u)}),i&&!this.showLine&&i.hide(),t&&t.hide(),"y"===a&&o.length<s.len)for(let t of o){let{plotX:e,plotY:i,zone:o}=t,s=o&&r[r.indexOf(o)-1];o&&p(o,e,i),s&&p(s,e,i)}let f=[],m=c.toPixels(c.getExtremes().min,!0);r.forEach(e=>{let r=e.lineClip||[],o=Math.round(e.translated||0);s.reversed&&r.reverse();let{clip:a,simpleClip:c}=e,u=0,p=0,y=s.len,w=n.len;d?(u=o,y=m):(p=o,w=m);let b=[["M",u,p],["L",y,p],["L",y,w],["L",u,w],["Z"]],C=[b[0],...r,b[1],b[2],...f,b[3],b[4]];f=r.reverse(),m=o,l&&(g(C),t&&g(b)),a?(a.animate({d:C}),c?.animate({d:b})):(a=e.clip=h.path(C),t&&(c=e.simpleClip=h.path(b))),i&&e.graph?.clip(a),t&&e.area?.clip(c)})}else this.visible&&(i&&i.show(),t&&t.show())}plotGroup(t,e,i,r,o){let s=this[t],n=!s,a={visibility:i,zIndex:r||.1};return S(this.opacity)&&!this.chart.styledMode&&"inactive"!==this.state&&(a.opacity=this.opacity),s||(this[t]=s=this.chart.renderer.g().add(o)),s.addClass("highcharts-"+e+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(S(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(s.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0),s.attr(a)[n?"attr":"animate"](this.getPlotBox(e)),s}getPlotBox(t){let e=this.xAxis,i=this.yAxis,r=this.chart,o=r.inverted&&!r.polar&&e&&this.invertible&&"series"===t;return r.inverted&&(e=i,i=this.xAxis),{translateX:e?e.left:r.plotLeft,translateY:i?i.top:r.plotTop,rotation:o?90:0,rotationOriginX:o?(e.len-i.len)/2:0,rotationOriginY:o?(e.len+i.len)/2:0,scaleX:o?-1:1,scaleY:1}}removeEvents(t){let{eventsToUnbind:e}=this;t||j(this),e.length&&(e.forEach(t=>{t()}),e.length=0)}render(){let t=this,{chart:e,options:i,hasRendered:r}=t,o=c(i.animation),s=t.visible?"inherit":"hidden",n=i.zIndex,a=e.seriesGroup,l=t.finishedAnimating?0:o.duration;A(this,"render"),t.plotGroup("group","series",s,n,a),t.markerGroup=t.plotGroup("markerGroup","markers",s,n,a),!1!==i.clip&&t.setClip(),l&&t.animate?.(!0),t.drawGraph&&(t.drawGraph(),t.applyZones()),t.visible&&t.drawPoints(),t.drawDataLabels?.(),t.redrawPoints?.(),i.enableMouseTracking&&t.drawTracker?.(),l&&t.animate?.(),r||(l&&o.defer&&(l+=o.defer),t.animationTimeout=W(()=>{t.afterAnimate()},l||0)),t.isDirty=!1,t.hasRendered=!0,A(t,"afterRender")}redraw(){let t=this.isDirty||this.isDirtyData;this.translate(),this.render(),t&&delete this.kdTree}reserveSpace(){return this.visible||!this.chart.options.chart.ignoreHiddenSeries}searchPoint(t,e){let{xAxis:i,yAxis:r}=this,o=this.chart.inverted;return this.searchKDTree({clientX:o?i.len-t.chartY+i.pos:t.chartX-i.pos,plotY:o?r.len-t.chartX+r.pos:t.chartY-r.pos},e,t)}buildKDTree(t){this.buildingKdTree=!0;let e=this,i=e.options.findNearestPointBy.indexOf("y")>-1?2:1;delete e.kdTree,W(function(){e.kdTree=function t(i,r,o){let s,n;let a=i?.length;if(a)return s=e.kdAxisArray[r%o],i.sort((t,e)=>(t[s]||0)-(e[s]||0)),{point:i[n=Math.floor(a/2)],left:t(i.slice(0,n),r+1,o),right:t(i.slice(n+1),r+1,o)}}(e.getValidPoints(void 0,!e.directTouch),i,i),e.buildingKdTree=!1},e.options.kdNow||t?.type==="touchstart"?0:1)}searchKDTree(t,e,i){let r=this,[o,s]=this.kdAxisArray,n=e?"distX":"dist",a=(r.options.findNearestPointBy||"").indexOf("y")>-1?2:1,l=!!r.isBubble;if(this.kdTree||this.buildingKdTree||this.buildKDTree(i),this.kdTree)return function t(e,i,a,h){let c,d,u,g,p,f,m,y=i.point,w=r.kdAxisArray[a%h],b,C,x=y;c=e[o],d=y[o],u=S(c)&&S(d)?c-d:null,g=e[s],p=y[s],f=S(g)&&S(p)?g-p:0,m=l&&y.marker?.radius||0,y.dist=Math.sqrt((u&&u*u||0)+f*f)-m,y.distX=S(u)?Math.abs(u)-m:Number.MAX_VALUE;let E=(e[w]||0)-(y[w]||0)+(l&&y.marker?.radius||0),R=E<0?"left":"right",T=E<0?"right":"left";return i[R]&&(x=(b=t(e,i[R],a+1,h))[n]<x[n]?b:y),i[T]&&Math.sqrt(E*E)<x[n]&&(x=(C=t(e,i[T],a+1,h))[n]<x[n]?C:x),x}(t,this.kdTree,a,a)}pointPlacementToXValue(){let{options:t,xAxis:e}=this,i=t.pointPlacement;return"between"===i&&(i=e.reversed?-.5:.5),L(i)?i*(t.pointRange||e.pointRange):0}isPointInside(t){let{chart:e,xAxis:i,yAxis:r}=this,{plotX:o=-1,plotY:s=-1}=t;return s>=0&&s<=(r?r.len:e.plotHeight)&&o>=0&&o<=(i?i.len:e.plotWidth)}drawTracker(){let t=this,e=t.options,i=e.trackByArea,r=[].concat((i?t.areaPath:t.graphPath)||[]),o=t.chart,s=o.pointer,n=o.renderer,a=o.options.tooltip?.snap||0,l=()=>{e.enableMouseTracking&&o.hoverSeries!==t&&t.onMouseOver()},h="rgba(192,192,192,"+(p?1e-4:.002)+")",c=t.tracker;c?c.attr({d:r}):t.graph&&(t.tracker=c=n.path(r).attr({visibility:t.visible?"inherit":"hidden",zIndex:2}).addClass(i?"highcharts-tracker-area":"highcharts-tracker-line").add(t.group),o.styledMode||c.attr({"stroke-linecap":"round","stroke-linejoin":"round",stroke:h,fill:i?h:"none","stroke-width":t.graph.strokeWidth()+(i?0:2*a)}),[t.tracker,t.markerGroup,t.dataLabelsGroup].forEach(t=>{t&&(t.addClass("highcharts-tracker").on("mouseover",l).on("mouseout",t=>{s?.onTrackerMouseOut(t)}),e.cursor&&!o.styledMode&&t.css({cursor:e.cursor}),t.on("touchstart",l))})),A(this,"afterDrawTracker")}addPoint(t,e,i,r,o){let s,n;let a=this.options,l=this.data,h=this.chart,c=this.xAxis,d=c&&c.hasNames&&c.names,u=a.data,g=this.xData;e=F(e,!0);let p={series:this};this.pointClass.prototype.applyOptions.apply(p,[t]);let f=p.x;if(n=g.length,this.requireSorting&&f<g[n-1])for(s=!0;n&&g[n-1]>f;)n--;this.updateParallelArrays(p,"splice",[n,0,0]),this.updateParallelArrays(p,n),d&&p.name&&(d[f]=p.name),u.splice(n,0,t),(s||this.processedData)&&(this.data.splice(n,0,null),this.processData()),"point"===a.legendType&&this.generatePoints(),i&&(l[0]&&l[0].remove?l[0].remove(!1):(l.shift(),this.updateParallelArrays(p,"shift"),u.shift())),!1!==o&&A(this,"addPoint",{point:p}),this.isDirty=!0,this.isDirtyData=!0,e&&h.redraw(r)}removePoint(t,e,i){let r=this,o=r.data,s=o[t],n=r.points,a=r.chart,l=function(){n&&n.length===o.length&&n.splice(t,1),o.splice(t,1),r.options.data.splice(t,1),r.updateParallelArrays(s||{series:r},"splice",[t,1]),s&&s.destroy(),r.isDirty=!0,r.isDirtyData=!0,e&&a.redraw()};d(i,a),e=F(e,!0),s?s.firePointEvent("remove",null,l):l()}remove(t,e,i,r){let o=this,s=o.chart;function n(){o.destroy(r),s.isDirtyLegend=s.isDirtyBox=!0,s.linkSeries(r),F(t,!0)&&s.redraw(e)}!1!==i?A(o,"remove",null,n):n()}update(t,e){A(this,"update",{options:t=E(t,this.userOptions)});let i=this,r=i.chart,o=i.userOptions,s=i.initialType||i.type,n=r.options.plotOptions,a=m[s].prototype,l=i.finishedAnimating&&{animation:!1},h={},c,d,u=["colorIndex","eventOptions","navigatorSeries","symbolIndex","baseSeries"],g=t.type||o.type||r.options.chart.type,p=!(this.hasDerivedData||g&&g!==this.type||void 0!==t.pointStart||void 0!==t.pointInterval||void 0!==t.relativeXValue||t.joinBy||t.mapData||["dataGrouping","pointStart","pointInterval","pointIntervalUnit","keys"].some(t=>i.hasOptionChanged(t)));g=g||s,p&&(u.push("data","isDirtyData","isDirtyCanvas","points","processedData","processedXData","processedYData","xIncrement","cropped","_hasPointMarkers","hasDataLabels","nodes","layout","level","mapMap","mapData","minY","maxY","minX","maxX","transformGroups"),!1!==t.visible&&u.push("area","graph"),i.parallelArrays.forEach(function(t){u.push(t+"Data")}),t.data&&(t.dataSorting&&M(i.options.dataSorting,t.dataSorting),this.setData(t.data,!1))),t=N(o,{index:void 0===o.index?i.index:o.index,pointStart:n?.series?.pointStart??o.pointStart??i.xData?.[0]},!p&&{data:i.options.data},t,l),p&&t.data&&(t.data=i.options.data),(u=["group","markerGroup","dataLabelsGroup","transformGroup"].concat(u)).forEach(function(t){u[t]=i[t],delete i[t]});let f=!1;if(m[g]){if(f=g!==i.type,i.remove(!1,!1,!1,!0),f){if(r.propFromSeries(),Object.setPrototypeOf)Object.setPrototypeOf(i,m[g].prototype);else{let t=Object.hasOwnProperty.call(i,"hcEvents")&&i.hcEvents;for(d in a)i[d]=void 0;M(i,m[g].prototype),t?i.hcEvents=t:delete i.hcEvents}}}else T(17,!0,r,{missingModuleFor:g});if(u.forEach(function(t){i[t]=u[t]}),i.init(r,t),p&&this.points)for(let t of(!1===(c=i.options).visible?(h.graphic=1,h.dataLabel=1):(this.hasMarkerChanged(c,o)&&(h.graphic=1),i.hasDataLabels?.()||(h.dataLabel=1)),this.points))t&&t.series&&(t.resolveColor(),Object.keys(h).length&&t.destroyElements(h),!1===c.showInLegend&&t.legendItem&&r.legend.destroyItem(t));i.initialType=s,r.linkSeries(),r.setSortedData(),f&&i.linkedSeries.length&&(i.isDirtyData=!0),A(this,"afterUpdate"),F(e,!0)&&r.redraw(!!p&&void 0)}setName(t){this.name=this.options.name=this.userOptions.name=t,this.chart.isDirtyLegend=!0}hasOptionChanged(t){let e=this.chart,i=this.options[t],r=e.options.plotOptions,o=this.userOptions[t],s=F(r?.[this.type]?.[t],r?.series?.[t]);return o&&!S(s)?i!==o:i!==F(s,i)}onMouseOver(){let t=this.chart,e=t.hoverSeries,i=t.pointer;i?.setHoverChartIndex(),e&&e!==this&&e.onMouseOut(),this.options.events.mouseOver&&A(this,"mouseOver"),this.setState("hover"),t.hoverSeries=this}onMouseOut(){let t=this.options,e=this.chart,i=e.tooltip,r=e.hoverPoint;e.hoverSeries=null,r&&r.onMouseOut(),this&&t.events.mouseOut&&A(this,"mouseOut"),i&&!this.stickyTracking&&(!i.shared||this.noSharedTooltip)&&i.hide(),e.series.forEach(function(t){t.setState("",!0)})}setState(t,e){let i=this,r=i.options,o=i.graph,s=r.inactiveOtherPoints,n=r.states,a=F(n[t||"normal"]&&n[t||"normal"].animation,i.chart.options.chart.animation),l=r.lineWidth,h=r.opacity;if(t=t||"",i.state!==t&&([i.group,i.markerGroup,i.dataLabelsGroup].forEach(function(e){e&&(i.state&&e.removeClass("highcharts-series-"+i.state),t&&e.addClass("highcharts-series-"+t))}),i.state=t,!i.chart.styledMode)){if(n[t]&&!1===n[t].enabled)return;if(t&&(l=n[t].lineWidth||l+(n[t].lineWidthPlus||0),h=F(n[t].opacity,h)),o&&!o.dashstyle&&L(l))for(let t of[o,...this.zones.map(t=>t.graph)])t?.animate({"stroke-width":l},a);s||[i.group,i.markerGroup,i.dataLabelsGroup,i.labelBySeries].forEach(function(t){t&&t.animate({opacity:h},a)})}e&&s&&i.points&&i.setAllPointsToState(t||void 0)}setAllPointsToState(t){this.points.forEach(function(e){e.setState&&e.setState(t)})}setVisible(t,e){let i=this,r=i.chart,o=r.options.chart.ignoreHiddenSeries,s=i.visible;i.visible=t=i.options.visible=i.userOptions.visible=void 0===t?!s:t;let n=t?"show":"hide";["group","dataLabelsGroup","markerGroup","tracker","tt"].forEach(t=>{i[t]?.[n]()}),(r.hoverSeries===i||r.hoverPoint?.series===i)&&i.onMouseOut(),i.legendItem&&r.legend.colorizeItem(i,t),i.isDirty=!0,i.options.stacking&&r.series.forEach(t=>{t.options.stacking&&t.visible&&(t.isDirty=!0)}),i.linkedSeries.forEach(e=>{e.setVisible(t,!1)}),o&&(r.isDirtyBox=!0),A(i,n),!1!==e&&r.redraw()}show(){this.setVisible(!0)}hide(){this.setVisible(!1)}select(t){this.selected=t=this.options.selected=void 0===t?!this.selected:t,this.checkbox&&(this.checkbox.checked=t),A(this,t?"select":"unselect")}shouldShowTooltip(t,e,i={}){return i.series=this,i.visiblePlotOnly=!0,this.chart.isInsidePlot(t,e,i)}drawLegendSymbol(t,e){o[this.options.legendSymbol||"rectangle"]?.call(this,t,e)}}return V.defaultOptions=n,V.types=a.seriesTypes,V.registerType=a.registerSeriesType,M(V.prototype,{axisTypes:["xAxis","yAxis"],coll:"series",colorCounter:0,directTouch:!1,invertible:!0,isCartesian:!0,kdAxisArray:["clientX","plotY"],parallelArrays:["x","y"],pointClass:s,requireSorting:!0,sorted:!0}),a.series=V,V}),i(e,"Core/Chart/Chart.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Axis/Axis.js"],e["Core/Defaults.js"],e["Core/Templating.js"],e["Core/Foundation.js"],e["Core/Globals.js"],e["Core/Renderer/RendererRegistry.js"],e["Core/Series/Series.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Renderer/SVG/SVGRenderer.js"],e["Core/Time.js"],e["Core/Utilities.js"],e["Core/Renderer/HTML/AST.js"],e["Core/Axis/Tick.js"]],function(t,e,i,r,o,s,n,a,l,h,c,d,u,g){let{animate:p,animObject:f,setAnimation:m}=t,{defaultOptions:y,defaultTime:w}=i,{numberFormat:b}=r,{registerEventOptions:C}=o,{charts:S,doc:x,marginNames:E,svg:R,win:T}=s,{seriesTypes:M}=l,{addEvent:k,attr:A,createElement:O,css:P,defined:I,diffObjects:H,discardElement:L,erase:D,error:N,extend:_,find:F,fireEvent:j,getStyle:B,isArray:W,isNumber:V,isObject:U,isString:z,merge:Y,objectEach:G,pick:$,pInt:X,relativeLength:q,removeEvent:K,splat:Z,syncTimeout:Q,uniqueKey:J}=d;class tt{static chart(t,e,i){return new tt(t,e,i)}constructor(t,e,i){this.sharedClips={};let r=[...arguments];(z(t)||t.nodeName)&&(this.renderTo=r.shift()),this.init(r[0],r[1])}setZoomOptions(){let t=this.options.chart,e=t.zooming;this.zooming={...e,type:$(t.zoomType,e.type),key:$(t.zoomKey,e.key),pinchType:$(t.pinchType,e.pinchType),singleTouch:$(t.zoomBySingleTouch,e.singleTouch,!1),resetButton:Y(e.resetButton,t.resetZoomButton)}}init(t,e){j(this,"init",{args:arguments},function(){let i=Y(y,t),r=i.chart;this.userOptions=_({},t),this.margin=[],this.spacing=[],this.labelCollectors=[],this.callback=e,this.isResizing=0,this.options=i,this.axes=[],this.series=[],this.time=t.time&&Object.keys(t.time).length?new c(t.time):s.time,this.numberFormatter=r.numberFormatter||b,this.styledMode=r.styledMode,this.hasCartesianSeries=r.showAxes,this.index=S.length,S.push(this),s.chartCount++,C(this,r),this.xAxis=[],this.yAxis=[],this.pointCount=this.colorCounter=this.symbolCounter=0,this.setZoomOptions(),j(this,"afterInit"),this.firstRender()})}initSeries(t){let e=this.options.chart,i=t.type||e.type,r=M[i];r||N(17,!0,this,{missingModuleFor:i});let o=new r;return"function"==typeof o.init&&o.init(this,t),o}setSortedData(){this.getSeriesOrderByLinks().forEach(function(t){t.points||t.data||!t.enabledDataSorting||t.setData(t.options.data,!1)})}getSeriesOrderByLinks(){return this.series.concat().sort(function(t,e){return t.linkedSeries.length||e.linkedSeries.length?e.linkedSeries.length-t.linkedSeries.length:0})}orderItems(t,e=0){let i=this[t],r=this.options[t]=Z(this.options[t]).slice(),o=this.userOptions[t]=this.userOptions[t]?Z(this.userOptions[t]).slice():[];if(this.hasRendered&&(r.splice(e),o.splice(e)),i)for(let t=e,s=i.length;t<s;++t){let e=i[t];e&&(e.index=t,e instanceof a&&(e.name=e.getName()),e.options.isInternal||(r[t]=e.options,o[t]=e.userOptions))}}isInsidePlot(t,e,i={}){let{inverted:r,plotBox:o,plotLeft:s,plotTop:n,scrollablePlotBox:a}=this,{scrollLeft:l=0,scrollTop:h=0}=i.visiblePlotOnly&&this.scrollablePlotArea?.scrollingContainer||{},c=i.series,d=i.visiblePlotOnly&&a||o,u=i.inverted?e:t,g=i.inverted?t:e,p={x:u,y:g,isInsidePlot:!0,options:i};if(!i.ignoreX){let t=c&&(r&&!this.polar?c.yAxis:c.xAxis)||{pos:s,len:1/0},e=i.paneCoordinates?t.pos+u:s+u;e>=Math.max(l+s,t.pos)&&e<=Math.min(l+s+d.width,t.pos+t.len)||(p.isInsidePlot=!1)}if(!i.ignoreY&&p.isInsidePlot){let t=!r&&i.axis&&!i.axis.isXAxis&&i.axis||c&&(r?c.xAxis:c.yAxis)||{pos:n,len:1/0},e=i.paneCoordinates?t.pos+g:n+g;e>=Math.max(h+n,t.pos)&&e<=Math.min(h+n+d.height,t.pos+t.len)||(p.isInsidePlot=!1)}return j(this,"afterIsInsidePlot",p),p.isInsidePlot}redraw(t){j(this,"beforeRedraw");let e=this.hasCartesianSeries?this.axes:this.colorAxis||[],i=this.series,r=this.pointer,o=this.legend,s=this.userOptions.legend,n=this.renderer,a=n.isHidden(),l=[],h,c,d,u=this.isDirtyBox,g=this.isDirtyLegend,p;for(n.rootFontSize=n.boxWrapper.getStyle("font-size"),this.setResponsive&&this.setResponsive(!1),m(!!this.hasRendered&&t,this),a&&this.temporaryDisplay(),this.layOutTitles(!1),d=i.length;d--;)if(((p=i[d]).options.stacking||p.options.centerInCategory)&&(c=!0,p.isDirty)){h=!0;break}if(h)for(d=i.length;d--;)(p=i[d]).options.stacking&&(p.isDirty=!0);i.forEach(function(t){t.isDirty&&("point"===t.options.legendType?("function"==typeof t.updateTotals&&t.updateTotals(),g=!0):s&&(s.labelFormatter||s.labelFormat)&&(g=!0)),t.isDirtyData&&j(t,"updatedData")}),g&&o&&o.options.enabled&&(o.render(),this.isDirtyLegend=!1),c&&this.getStacks(),e.forEach(function(t){t.updateNames(),t.setScale()}),this.getMargins(),e.forEach(function(t){t.isDirty&&(u=!0)}),e.forEach(function(t){let e=t.min+","+t.max;t.extKey!==e&&(t.extKey=e,l.push(function(){j(t,"afterSetExtremes",_(t.eventArgs,t.getExtremes())),delete t.eventArgs})),(u||c)&&t.redraw()}),u&&this.drawChartBox(),j(this,"predraw"),i.forEach(function(t){(u||t.isDirty)&&t.visible&&t.redraw(),t.isDirtyData=!1}),r&&r.reset(!0),n.draw(),j(this,"redraw"),j(this,"render"),a&&this.temporaryDisplay(!0),l.forEach(function(t){t.call()})}get(t){let e=this.series;function i(e){return e.id===t||e.options&&e.options.id===t}let r=F(this.axes,i)||F(this.series,i);for(let t=0;!r&&t<e.length;t++)r=F(e[t].points||[],i);return r}getAxes(){let t=this.userOptions;for(let i of(j(this,"getAxes"),["xAxis","yAxis"]))for(let r of t[i]=Z(t[i]||{}))new e(this,r,i);j(this,"afterGetAxes")}getSelectedPoints(){return this.series.reduce((t,e)=>(e.getPointsCollection().forEach(e=>{$(e.selectedStaging,e.selected)&&t.push(e)}),t),[])}getSelectedSeries(){return this.series.filter(function(t){return t.selected})}setTitle(t,e,i){this.applyDescription("title",t),this.applyDescription("subtitle",e),this.applyDescription("caption",void 0),this.layOutTitles(i)}applyDescription(t,e){let i=this,r=this.options[t]=Y(this.options[t],e),o=this[t];o&&e&&(this[t]=o=o.destroy()),r&&!o&&((o=this.renderer.text(r.text,0,0,r.useHTML).attr({align:r.align,class:"highcharts-"+t,zIndex:r.zIndex||4}).add()).update=function(e,r){i.applyDescription(t,e),i.layOutTitles(r)},this.styledMode||o.css(_("title"===t?{fontSize:this.options.isStock?"1em":"1.2em"}:{},r.style)),this[t]=o)}layOutTitles(t=!0){let e=[0,0,0],i=this.renderer,r=this.spacingBox;["title","subtitle","caption"].forEach(function(t){let o=this[t],s=this.options[t],n=s.verticalAlign||"top",a="title"===t?"top"===n?-3:0:"top"===n?e[0]+2:0;if(o){o.css({width:(s.width||r.width+(s.widthAdjust||0))+"px"});let t=i.fontMetrics(o).b,l=Math.round(o.getBBox(s.useHTML).height);o.align(_({y:"bottom"===n?t:a+t,height:l},s),!1,"spacingBox"),s.floating||("top"===n?e[0]=Math.ceil(e[0]+l):"bottom"===n&&(e[2]=Math.ceil(e[2]+l)))}},this),e[0]&&"top"===(this.options.title.verticalAlign||"top")&&(e[0]+=this.options.title.margin),e[2]&&"bottom"===this.options.caption.verticalAlign&&(e[2]+=this.options.caption.margin);let o=!this.titleOffset||this.titleOffset.join(",")!==e.join(",");this.titleOffset=e,j(this,"afterLayOutTitles"),!this.isDirtyBox&&o&&(this.isDirtyBox=this.isDirtyLegend=o,this.hasRendered&&t&&this.isDirtyBox&&this.redraw())}getContainerBox(){return{width:B(this.renderTo,"width",!0)||0,height:B(this.renderTo,"height",!0)||0}}getChartSize(){let t=this.options.chart,e=t.width,i=t.height,r=this.getContainerBox();this.chartWidth=Math.max(0,e||r.width||600),this.chartHeight=Math.max(0,q(i,this.chartWidth)||(r.height>1?r.height:400)),this.containerBox=r}temporaryDisplay(t){let e=this.renderTo,i;if(t)for(;e&&e.style;)e.hcOrigStyle&&(P(e,e.hcOrigStyle),delete e.hcOrigStyle),e.hcOrigDetached&&(x.body.removeChild(e),e.hcOrigDetached=!1),e=e.parentNode;else for(;e&&e.style&&(x.body.contains(e)||e.parentNode||(e.hcOrigDetached=!0,x.body.appendChild(e)),("none"===B(e,"display",!1)||e.hcOricDetached)&&(e.hcOrigStyle={display:e.style.display,height:e.style.height,overflow:e.style.overflow},i={display:"block",overflow:"hidden"},e!==this.renderTo&&(i.height=0),P(e,i),e.offsetWidth||e.style.setProperty("display","block","important")),(e=e.parentNode)!==x.body););}setClassName(t){this.container.className="highcharts-container "+(t||"")}getContainer(){let t=this.options,e=t.chart,i="data-highcharts-chart",r=J(),o,s=this.renderTo;s||(this.renderTo=s=e.renderTo),z(s)&&(this.renderTo=s=x.getElementById(s)),s||N(13,!0,this);let a=X(A(s,i));V(a)&&S[a]&&S[a].hasRendered&&S[a].destroy(),A(s,i,this.index),s.innerHTML=u.emptyHTML,e.skipClone||s.offsetWidth||this.temporaryDisplay(),this.getChartSize();let l=this.chartHeight,c=this.chartWidth;P(s,{overflow:"hidden"}),this.styledMode||(o=_({position:"relative",overflow:"hidden",width:c+"px",height:l+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)",userSelect:"none","touch-action":"manipulation",outline:"none"},e.style||{}));let d=O("div",{id:r},o,s);this.container=d,this.getChartSize(),c===this.chartWidth||(c=this.chartWidth,this.styledMode||P(d,{width:$(e.style?.width,c+"px")})),this.containerBox=this.getContainerBox(),this._cursor=d.style.cursor;let g=e.renderer||!R?n.getRendererType(e.renderer):h;if(this.renderer=new g(d,c,l,void 0,e.forExport,t.exporting&&t.exporting.allowHTML,this.styledMode),m(void 0,this),this.setClassName(e.className),this.styledMode)for(let e in t.defs)this.renderer.definition(t.defs[e]);else this.renderer.setStyle(e.style);this.renderer.chartIndex=this.index,j(this,"afterGetContainer")}getMargins(t){let{spacing:e,margin:i,titleOffset:r}=this;this.resetMargins(),r[0]&&!I(i[0])&&(this.plotTop=Math.max(this.plotTop,r[0]+e[0])),r[2]&&!I(i[2])&&(this.marginBottom=Math.max(this.marginBottom,r[2]+e[2])),this.legend&&this.legend.display&&this.legend.adjustMargins(i,e),j(this,"getMargins"),t||this.getAxisMargins()}getAxisMargins(){let t=this,e=t.axisOffset=[0,0,0,0],i=t.colorAxis,r=t.margin,o=function(t){t.forEach(function(t){t.visible&&t.getOffset()})};t.hasCartesianSeries?o(t.axes):i&&i.length&&o(i),E.forEach(function(i,o){I(r[o])||(t[i]+=e[o])}),t.setChartSize()}getOptions(){return H(this.userOptions,y)}reflow(t){let e=this,i=e.containerBox,r=e.getContainerBox();delete e.pointer?.chartPosition,!e.isPrinting&&!e.isResizing&&i&&r.width&&((r.width!==i.width||r.height!==i.height)&&(d.clearTimeout(e.reflowTimeout),e.reflowTimeout=Q(function(){e.container&&e.setSize(void 0,void 0,!1)},t?100:0)),e.containerBox=r)}setReflow(){let t=this,e=e=>{t.options?.chart.reflow&&t.hasLoaded&&t.reflow(e)};if("function"==typeof ResizeObserver)new ResizeObserver(e).observe(t.renderTo);else{let t=k(T,"resize",e);k(this,"destroy",t)}}setSize(t,e,i){let r=this,o=r.renderer;r.isResizing+=1,m(i,r);let s=o.globalAnimation;r.oldChartHeight=r.chartHeight,r.oldChartWidth=r.chartWidth,void 0!==t&&(r.options.chart.width=t),void 0!==e&&(r.options.chart.height=e),r.getChartSize();let{chartWidth:n,chartHeight:a,scrollablePixelsX:l=0,scrollablePixelsY:h=0}=r;(r.isDirtyBox||n!==r.oldChartWidth||a!==r.oldChartHeight)&&(r.styledMode||(s?p:P)(r.container,{width:`${n+l}px`,height:`${a+h}px`},s),r.setChartSize(!0),o.setSize(n,a,s),r.axes.forEach(function(t){t.isDirty=!0,t.setScale()}),r.isDirtyLegend=!0,r.isDirtyBox=!0,r.layOutTitles(),r.getMargins(),r.redraw(s),r.oldChartHeight=void 0,j(r,"resize"),setTimeout(()=>{r&&j(r,"endResize")},f(s).duration)),r.isResizing-=1}setChartSize(t){let e,i,r,o;let s=this.inverted,n=this.renderer,a=this.chartWidth,l=this.chartHeight,h=this.options.chart,c=this.spacing,d=this.clipOffset;this.plotLeft=e=Math.round(this.plotLeft),this.plotTop=i=Math.round(this.plotTop),this.plotWidth=r=Math.max(0,Math.round(a-e-this.marginRight)),this.plotHeight=o=Math.max(0,Math.round(l-i-this.marginBottom)),this.plotSizeX=s?o:r,this.plotSizeY=s?r:o,this.plotBorderWidth=h.plotBorderWidth||0,this.spacingBox=n.spacingBox={x:c[3],y:c[0],width:a-c[3]-c[1],height:l-c[0]-c[2]},this.plotBox=n.plotBox={x:e,y:i,width:r,height:o};let u=2*Math.floor(this.plotBorderWidth/2),g=Math.ceil(Math.max(u,d[3])/2),p=Math.ceil(Math.max(u,d[0])/2);this.clipBox={x:g,y:p,width:Math.floor(this.plotSizeX-Math.max(u,d[1])/2-g),height:Math.max(0,Math.floor(this.plotSizeY-Math.max(u,d[2])/2-p))},t||(this.axes.forEach(function(t){t.setAxisSize(),t.setAxisTranslation()}),n.alignElements()),j(this,"afterSetChartSize",{skipAxes:t})}resetMargins(){j(this,"resetMargins");let t=this,e=t.options.chart;["margin","spacing"].forEach(function(i){let r=e[i],o=U(r)?r:[r,r,r,r];["Top","Right","Bottom","Left"].forEach(function(r,s){t[i][s]=$(e[i+r],o[s])})}),E.forEach(function(e,i){t[e]=$(t.margin[i],t.spacing[i])}),t.axisOffset=[0,0,0,0],t.clipOffset=[0,0,0,0]}drawChartBox(){let t=this.options.chart,e=this.renderer,i=this.chartWidth,r=this.chartHeight,o=this.styledMode,s=this.plotBGImage,n=t.backgroundColor,a=t.plotBackgroundColor,l=t.plotBackgroundImage,h=this.plotLeft,c=this.plotTop,d=this.plotWidth,u=this.plotHeight,g=this.plotBox,p=this.clipRect,f=this.clipBox,m=this.chartBackground,y=this.plotBackground,w=this.plotBorder,b,C,S,x="animate";m||(this.chartBackground=m=e.rect().addClass("highcharts-background").add(),x="attr"),o?b=C=m.strokeWidth():(C=(b=t.borderWidth||0)+(t.shadow?8:0),S={fill:n||"none"},(b||m["stroke-width"])&&(S.stroke=t.borderColor,S["stroke-width"]=b),m.attr(S).shadow(t.shadow)),m[x]({x:C/2,y:C/2,width:i-C-b%2,height:r-C-b%2,r:t.borderRadius}),x="animate",y||(x="attr",this.plotBackground=y=e.rect().addClass("highcharts-plot-background").add()),y[x](g),!o&&(y.attr({fill:a||"none"}).shadow(t.plotShadow),l&&(s?(l!==s.attr("href")&&s.attr("href",l),s.animate(g)):this.plotBGImage=e.image(l,h,c,d,u).add())),p?p.animate({width:f.width,height:f.height}):this.clipRect=e.clipRect(f),x="animate",w||(x="attr",this.plotBorder=w=e.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),o||w.attr({stroke:t.plotBorderColor,"stroke-width":t.plotBorderWidth||0,fill:"none"}),w[x](w.crisp({x:h,y:c,width:d,height:u},-w.strokeWidth())),this.isDirtyBox=!1,j(this,"afterDrawChartBox")}propFromSeries(){let t,e,i;let r=this,o=r.options.chart,s=r.options.series;["inverted","angular","polar"].forEach(function(n){for(e=M[o.type],i=o[n]||e&&e.prototype[n],t=s&&s.length;!i&&t--;)(e=M[s[t].type])&&e.prototype[n]&&(i=!0);r[n]=i})}linkSeries(t){let e=this,i=e.series;i.forEach(function(t){t.linkedSeries.length=0}),i.forEach(function(t){let{linkedTo:i}=t.options;if(z(i)){let r;(r=":previous"===i?e.series[t.index-1]:e.get(i))&&r.linkedParent!==t&&(r.linkedSeries.push(t),t.linkedParent=r,r.enabledDataSorting&&t.setDataSortingOptions(),t.visible=$(t.options.visible,r.options.visible,t.visible))}}),j(this,"afterLinkSeries",{isUpdating:t})}renderSeries(){this.series.forEach(function(t){t.translate(),t.render()})}render(){let t=this.axes,e=this.colorAxis,i=this.renderer,r=this.options.chart.axisLayoutRuns||2,o=t=>{t.forEach(t=>{t.visible&&t.render()})},s=0,n=!0,a,l=0;for(let e of(this.setTitle(),j(this,"beforeMargins"),this.getStacks?.(),this.getMargins(!0),this.setChartSize(),t)){let{options:t}=e,{labels:i}=t;if(e.horiz&&e.visible&&i.enabled&&e.series.length&&"colorAxis"!==e.coll&&!this.polar){s=t.tickLength,e.createGroups();let r=new g(e,0,"",!0),o=r.createLabel("x",i);if(r.destroy(),o&&$(i.reserveSpace,!V(t.crossing))&&(s=o.getBBox().height+i.distance+Math.max(t.offset||0,0)),s){o?.destroy();break}}}for(this.plotHeight=Math.max(this.plotHeight-s,0);(n||a||r>1)&&l<r;){let e=this.plotWidth,i=this.plotHeight;for(let e of t)0===l?e.setScale():(e.horiz&&n||!e.horiz&&a)&&e.setTickInterval(!0);0===l?this.getAxisMargins():this.getMargins(),n=e/this.plotWidth>(l?1:1.1),a=i/this.plotHeight>(l?1:1.05),l++}this.drawChartBox(),this.hasCartesianSeries?o(t):e&&e.length&&o(e),this.seriesGroup||(this.seriesGroup=i.g("series-group").attr({zIndex:3}).shadow(this.options.chart.seriesGroupShadow).add()),this.renderSeries(),this.addCredits(),this.setResponsive&&this.setResponsive(),this.hasRendered=!0}addCredits(t){let e=this,i=Y(!0,this.options.credits,t);i.enabled&&!this.credits&&(this.credits=this.renderer.text(i.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){i.href&&(T.location.href=i.href)}).attr({align:i.position.align,zIndex:8}),e.styledMode||this.credits.css(i.style),this.credits.add().align(i.position),this.credits.update=function(t){e.credits=e.credits.destroy(),e.addCredits(t)})}destroy(){let t;let e=this,i=e.axes,r=e.series,o=e.container,n=o&&o.parentNode;for(j(e,"destroy"),e.renderer.forExport?D(S,e):S[e.index]=void 0,s.chartCount--,e.renderTo.removeAttribute("data-highcharts-chart"),K(e),t=i.length;t--;)i[t]=i[t].destroy();for(this.scroller&&this.scroller.destroy&&this.scroller.destroy(),t=r.length;t--;)r[t]=r[t].destroy();["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","rangeSelector","legend","resetZoomButton","tooltip","renderer"].forEach(function(t){let i=e[t];i&&i.destroy&&(e[t]=i.destroy())}),o&&(o.innerHTML=u.emptyHTML,K(o),n&&L(o)),G(e,function(t,i){delete e[i]})}firstRender(){let t=this,e=t.options;t.getContainer(),t.resetMargins(),t.setChartSize(),t.propFromSeries(),t.getAxes();let i=W(e.series)?e.series:[];e.series=[],i.forEach(function(e){t.initSeries(e)}),t.linkSeries(),t.setSortedData(),j(t,"beforeRender"),t.render(),t.pointer?.getChartPosition(),t.renderer.imgCount||t.hasLoaded||t.onload(),t.temporaryDisplay(!0)}onload(){this.callbacks.concat([this.callback]).forEach(function(t){t&&void 0!==this.index&&t.apply(this,[this])},this),j(this,"load"),j(this,"render"),I(this.index)&&this.setReflow(),this.warnIfA11yModuleNotLoaded(),this.hasLoaded=!0}warnIfA11yModuleNotLoaded(){let{options:t,title:e}=this;!t||this.accessibility||(this.renderer.boxWrapper.attr({role:"img","aria-label":(e&&e.element.textContent||"").replace(/</g,"&lt;")}),t.accessibility&&!1===t.accessibility.enabled||N('Highcharts warning: Consider including the "accessibility.js" module to make your chart more usable for people with disabilities. Set the "accessibility.enabled" option to false to remove this warning. See https://www.highcharts.com/docs/accessibility/accessibility-module.',!1,this))}addSeries(t,e,i){let r;let o=this;return t&&(e=$(e,!0),j(o,"addSeries",{options:t},function(){r=o.initSeries(t),o.isDirtyLegend=!0,o.linkSeries(),r.enabledDataSorting&&r.setData(t.data,!1),j(o,"afterAddSeries",{series:r}),e&&o.redraw(i)})),r}addAxis(t,e,i,r){return this.createAxis(e?"xAxis":"yAxis",{axis:t,redraw:i,animation:r})}addColorAxis(t,e,i){return this.createAxis("colorAxis",{axis:t,redraw:e,animation:i})}createAxis(t,i){let r=new e(this,i.axis,t);return $(i.redraw,!0)&&this.redraw(i.animation),r}showLoading(t){let e=this,i=e.options,r=i.loading,o=function(){s&&P(s,{left:e.plotLeft+"px",top:e.plotTop+"px",width:e.plotWidth+"px",height:e.plotHeight+"px"})},s=e.loadingDiv,n=e.loadingSpan;s||(e.loadingDiv=s=O("div",{className:"highcharts-loading highcharts-loading-hidden"},null,e.container)),n||(e.loadingSpan=n=O("span",{className:"highcharts-loading-inner"},null,s),k(e,"redraw",o)),s.className="highcharts-loading",u.setElementHTML(n,$(t,i.lang.loading,"")),e.styledMode||(P(s,_(r.style,{zIndex:10})),P(n,r.labelStyle),e.loadingShown||(P(s,{opacity:0,display:""}),p(s,{opacity:r.style.opacity||.5},{duration:r.showDuration||0}))),e.loadingShown=!0,o()}hideLoading(){let t=this.options,e=this.loadingDiv;e&&(e.className="highcharts-loading highcharts-loading-hidden",this.styledMode||p(e,{opacity:0},{duration:t.loading.hideDuration||100,complete:function(){P(e,{display:"none"})}})),this.loadingShown=!1}update(t,e,i,r){let o,s,n;let a=this,l={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"},h=t.isResponsiveOptions,d=[];j(a,"update",{options:t}),h||a.setResponsive(!1,!0),t=H(t,a.options),a.userOptions=Y(a.userOptions,t);let u=t.chart;u&&(Y(!0,a.options.chart,u),this.setZoomOptions(),"className"in u&&a.setClassName(u.className),("inverted"in u||"polar"in u||"type"in u)&&(a.propFromSeries(),o=!0),"alignTicks"in u&&(o=!0),"events"in u&&C(this,u),G(u,function(t,e){-1!==a.propsRequireUpdateSeries.indexOf("chart."+e)&&(s=!0),-1!==a.propsRequireDirtyBox.indexOf(e)&&(a.isDirtyBox=!0),-1===a.propsRequireReflow.indexOf(e)||(a.isDirtyBox=!0,h||(n=!0))}),!a.styledMode&&u.style&&a.renderer.setStyle(a.options.chart.style||{})),!a.styledMode&&t.colors&&(this.options.colors=t.colors),t.time&&(this.time===w&&(this.time=new c(t.time)),Y(!0,a.options.time,t.time)),G(t,function(e,i){a[i]&&"function"==typeof a[i].update?a[i].update(e,!1):"function"==typeof a[l[i]]?a[l[i]](e):"colors"!==i&&-1===a.collectionsWithUpdate.indexOf(i)&&Y(!0,a.options[i],t[i]),"chart"!==i&&-1!==a.propsRequireUpdateSeries.indexOf(i)&&(s=!0)}),this.collectionsWithUpdate.forEach(function(e){t[e]&&(Z(t[e]).forEach(function(t,r){let o;let s=I(t.id);s&&(o=a.get(t.id)),!o&&a[e]&&(o=a[e][$(t.index,r)])&&(s&&I(o.options.id)||o.options.isInternal)&&(o=void 0),o&&o.coll===e&&(o.update(t,!1),i&&(o.touched=!0)),!o&&i&&a.collectionsWithInit[e]&&(a.collectionsWithInit[e][0].apply(a,[t].concat(a.collectionsWithInit[e][1]||[]).concat([!1])).touched=!0)}),i&&a[e].forEach(function(t){t.touched||t.options.isInternal?delete t.touched:d.push(t)}))}),d.forEach(function(t){t.chart&&t.remove&&t.remove(!1)}),o&&a.axes.forEach(function(t){t.update({},!1)}),s&&a.getSeriesOrderByLinks().forEach(function(t){t.chart&&t.update({},!1)},this);let g=u&&u.width,p=u&&(z(u.height)?q(u.height,g||a.chartWidth):u.height);n||V(g)&&g!==a.chartWidth||V(p)&&p!==a.chartHeight?a.setSize(g,p,r):$(e,!0)&&a.redraw(r),j(a,"afterUpdate",{options:t,redraw:e,animation:r})}setSubtitle(t,e){this.applyDescription("subtitle",t),this.layOutTitles(e)}setCaption(t,e){this.applyDescription("caption",t),this.layOutTitles(e)}showResetZoom(){let t=this,e=y.lang,i=t.zooming.resetButton,r=i.theme,o="chart"===i.relativeTo||"spacingBox"===i.relativeTo?null:"plotBox";function s(){t.zoomOut()}j(this,"beforeShowResetZoom",null,function(){t.resetZoomButton=t.renderer.button(e.resetZoom,null,null,s,r).attr({align:i.position.align,title:e.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(i.position,!1,o)}),j(this,"afterShowResetZoom")}zoomOut(){j(this,"selection",{resetSelection:!0},()=>this.transform({reset:!0,trigger:"zoom"}))}pan(t,e){let i=this,r="object"==typeof e?e:{enabled:e,type:"x"},o=r.type,s=o&&i[({x:"xAxis",xy:"axes",y:"yAxis"})[o]].filter(t=>t.options.panningEnabled&&!t.options.isInternal),n=i.options.chart;n?.panning&&(n.panning=r),j(this,"pan",{originalEvent:t},()=>{i.transform({axes:s,event:t,to:{x:t.chartX-(i.mouseDownX||0),y:t.chartY-(i.mouseDownY||0)},trigger:"pan"}),P(i.container,{cursor:"move"})})}transform(t){let{axes:e=this.axes,event:i,from:r={},reset:o,selection:s,to:n={},trigger:a}=t,{inverted:l}=this,h=!1,c;for(let t of(this.hoverPoints?.forEach(t=>t.setState()),e)){let{horiz:e,len:d,minPointOffset:u=0,options:g,reversed:p}=t,f=e?"width":"height",m=e?"x":"y",y=n[f]||t.len,w=r[f]||t.len,b=10>Math.abs(y)?1:y/w,C=(r[m]||0)+w/2-t.pos,S=C-((n[m]??t.pos)+y/2-t.pos)/b,x=p&&!l||!p&&l?-1:1;if(!o&&(C<0||C>t.len))continue;let E=t.toValue(S,!0)+(s?0:u*x),R=t.toValue(S+d/b,!0)-(s?0:u*x||0),T=t.allExtremes;if(E>R&&([E,R]=[R,E]),1===b&&!o&&"yAxis"===t.coll&&!T){for(let e of t.series){let t=e.getExtremes(e.getProcessedData(!0).yData,!0);T??(T={dataMin:Number.MAX_VALUE,dataMax:-Number.MAX_VALUE}),V(t.dataMin)&&V(t.dataMax)&&(T.dataMin=Math.min(t.dataMin,T.dataMin),T.dataMax=Math.max(t.dataMax,T.dataMax))}t.allExtremes=T}let{dataMin:M,dataMax:k,min:A,max:O}=_(t.getExtremes(),T||{}),P=M??g.min,H=k??g.max,L=R-E,D=t.categories?0:Math.min(L,H-P),N=P-D*(I(g.min)?0:g.minPadding),F=H+D*(I(g.max)?0:g.maxPadding),j=t.allowZoomOutside||1===b||"zoom"!==a&&b>1,B=Math.min(g.min??N,N,j?A:N),W=Math.max(g.max??F,F,j?O:F);(!t.isOrdinal||1!==b||o)&&(E<B&&(E=B,b>=1&&(R=E+L)),R>W&&(R=W,b>=1&&(E=R-L)),(o||t.series.length&&(E!==A||R!==O)&&E>=B&&R<=W)&&(s?s[t.coll].push({axis:t,min:E,max:R}):(t.isPanning="zoom"!==a,t.setExtremes(o?void 0:E,o?void 0:R,!1,!1,{move:S,trigger:a,scale:b}),!o&&(E>B||R<W)&&"mousewheel"!==a&&(c=!0)),h=!0),i&&(this[e?"mouseDownX":"mouseDownY"]=i[e?"chartX":"chartY"]))}return h&&(s?j(this,"selection",s,()=>{delete t.selection,t.trigger="zoom",this.transform(t)}):(c&&!this.resetZoomButton?this.showResetZoom():!c&&this.resetZoomButton&&(this.resetZoomButton=this.resetZoomButton.destroy()),this.redraw("zoom"===a&&(this.options.chart.animation??this.pointCount<100)))),h}}return _(tt.prototype,{callbacks:[],collectionsWithInit:{xAxis:[tt.prototype.addAxis,[!0]],yAxis:[tt.prototype.addAxis,[!1]],series:[tt.prototype.addSeries]},collectionsWithUpdate:["xAxis","yAxis","series"],propsRequireDirtyBox:["backgroundColor","borderColor","borderWidth","borderRadius","plotBackgroundColor","plotBackgroundImage","plotBorderColor","plotBorderWidth","plotShadow","shadow"],propsRequireReflow:["margin","marginTop","marginRight","marginBottom","marginLeft","spacing","spacingTop","spacingRight","spacingBottom","spacingLeft"],propsRequireUpdateSeries:["chart.inverted","chart.polar","chart.ignoreHiddenSeries","chart.type","colors","plotOptions","time","tooltip"]}),tt}),i(e,"Extensions/ScrollablePlotArea.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Globals.js"],e["Core/Renderer/RendererRegistry.js"],e["Core/Utilities.js"]],function(t,e,i,r){let{stop:o}=t,{composed:s}=e,{addEvent:n,createElement:a,css:l,defined:h,merge:c,pushUnique:d}=r;function u(){let t=this.scrollablePlotArea;(this.scrollablePixelsX||this.scrollablePixelsY)&&!t&&(this.scrollablePlotArea=t=new p(this)),t?.applyFixed()}function g(){this.chart.scrollablePlotArea&&(this.chart.scrollablePlotArea.isDirty=!0)}class p{static compose(t,e,i){d(s,this.compose)&&(n(t,"afterInit",g),n(e,"afterSetChartSize",t=>this.afterSetSize(t.target,t)),n(e,"render",u),n(i,"show",g))}static afterSetSize(t,e){let i,r,o;let{minWidth:s,minHeight:n}=t.options.chart.scrollablePlotArea||{},{clipBox:a,plotBox:l,inverted:d,renderer:u}=t;if(!u.forExport&&(s?(t.scrollablePixelsX=i=Math.max(0,s-t.chartWidth),i&&(t.scrollablePlotBox=c(t.plotBox),l.width=t.plotWidth+=i,a[d?"height":"width"]+=i,o=!0)):n&&(t.scrollablePixelsY=r=Math.max(0,n-t.chartHeight),h(r)&&(t.scrollablePlotBox=c(t.plotBox),l.height=t.plotHeight+=r,a[d?"width":"height"]+=r,o=!1)),h(o)&&!e.skipAxes))for(let e of t.axes)e.horiz===o&&(e.setAxisSize(),e.setAxisTranslation())}constructor(t){let e;let r=t.options.chart,o=i.getRendererType(),s=r.scrollablePlotArea||{},h=this.moveFixedElements.bind(this),c={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};t.scrollablePixelsX&&(c.overflowX="auto"),t.scrollablePixelsY&&(c.overflowY="auto"),this.chart=t;let d=this.parentDiv=a("div",{className:"highcharts-scrolling-parent"},{position:"relative"},t.renderTo),u=this.scrollingContainer=a("div",{className:"highcharts-scrolling"},c,d),g=this.innerContainer=a("div",{className:"highcharts-inner-container"},void 0,u),p=this.fixedDiv=a("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:(r.style?.zIndex||0)+2,top:0},void 0,!0),f=this.fixedRenderer=new o(p,t.chartWidth,t.chartHeight,r.style);this.mask=f.path().attr({fill:r.backgroundColor||"#fff","fill-opacity":s.opacity??.85,zIndex:-1}).addClass("highcharts-scrollable-mask").add(),u.parentNode.insertBefore(p,u),l(t.renderTo,{overflow:"visible"}),n(t,"afterShowResetZoom",h),n(t,"afterApplyDrilldown",h),n(t,"afterLayOutTitles",h),n(u,"scroll",()=>{let{pointer:i,hoverPoint:r}=t;i&&(delete i.chartPosition,r&&(e=r),i.runPointActions(void 0,e,!0))}),g.appendChild(t.container)}applyFixed(){let{chart:t,fixedRenderer:e,isDirty:i,scrollingContainer:r}=this,{axisOffset:s,chartWidth:n,chartHeight:a,container:c,plotHeight:d,plotLeft:u,plotTop:g,plotWidth:p,scrollablePixelsX:f=0,scrollablePixelsY:m=0}=t,{scrollPositionX:y=0,scrollPositionY:w=0}=t.options.chart.scrollablePlotArea||{},b=n+f,C=a+m;e.setSize(n,a),(i??!0)&&(this.isDirty=!1,this.moveFixedElements()),o(t.container),l(c,{width:`${b}px`,height:`${C}px`}),t.renderer.boxWrapper.attr({width:b,height:C,viewBox:[0,0,b,C].join(" ")}),t.chartBackground?.attr({width:b,height:C}),l(r,{width:`${n}px`,height:`${a}px`}),h(i)||(r.scrollLeft=f*y,r.scrollTop=m*w);let S=g-s[0]-1,x=u-s[3]-1,E=g+d+s[2]+1,R=u+p+s[1]+1,T=u+p-f,M=g+d-m,k=[["M",0,0]];f?k=[["M",0,S],["L",u-1,S],["L",u-1,E],["L",0,E],["Z"],["M",T,S],["L",n,S],["L",n,E],["L",T,E],["Z"]]:m&&(k=[["M",x,0],["L",x,g-1],["L",R,g-1],["L",R,0],["Z"],["M",x,M],["L",x,a],["L",R,a],["L",R,M],["Z"]]),"adjustHeight"!==t.redrawTrigger&&this.mask.attr({d:k})}moveFixedElements(){let t;let{container:e,inverted:i,scrollablePixelsX:r,scrollablePixelsY:o}=this.chart,s=this.fixedRenderer,n=[".highcharts-breadcrumbs-group",".highcharts-contextbutton",".highcharts-caption",".highcharts-credits",".highcharts-legend",".highcharts-legend-checkbox",".highcharts-navigator-series",".highcharts-navigator-xaxis",".highcharts-navigator-yaxis",".highcharts-navigator",".highcharts-reset-zoom",".highcharts-drillup-button",".highcharts-scrollbar",".highcharts-subtitle",".highcharts-title"];for(let a of(r&&!i?t=".highcharts-yaxis":r&&i?t=".highcharts-xaxis":o&&!i?t=".highcharts-xaxis":o&&i&&(t=".highcharts-yaxis"),t&&n.push(`${t}:not(.highcharts-radial-axis)`,`${t}-labels:not(.highcharts-radial-axis-labels)`),n))[].forEach.call(e.querySelectorAll(a),t=>{(t.namespaceURI===s.SVG_NS?s.box:s.box.parentNode).appendChild(t),t.style.pointerEvents="auto"})}}return p}),i(e,"Core/Axis/Stacking/StackItem.js",[e["Core/Templating.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(t,e,i){let{format:r}=t,{series:o}=e,{destroyObjectProperties:s,fireEvent:n,isNumber:a,pick:l}=i;return class{constructor(t,e,i,r,o){let s=t.chart.inverted,n=t.reversed;this.axis=t;let a=this.isNegative=!!i!=!!n;this.options=e=e||{},this.x=r,this.total=null,this.cumulative=null,this.points={},this.hasValidPoints=!1,this.stack=o,this.leftCliff=0,this.rightCliff=0,this.alignOptions={align:e.align||(s?a?"left":"right":"center"),verticalAlign:e.verticalAlign||(s?"middle":a?"bottom":"top"),y:e.y,x:e.x},this.textAlign=e.textAlign||(s?a?"right":"left":"center")}destroy(){s(this,this.axis)}render(t){let e=this.axis.chart,i=this.options,o=i.format,s=o?r(o,this,e):i.formatter.call(this);if(this.label)this.label.attr({text:s,visibility:"hidden"});else{this.label=e.renderer.label(s,null,void 0,i.shape,void 0,void 0,i.useHTML,!1,"stack-labels");let r={r:i.borderRadius||0,text:s,padding:l(i.padding,5),visibility:"hidden"};e.styledMode||(r.fill=i.backgroundColor,r.stroke=i.borderColor,r["stroke-width"]=i.borderWidth,this.label.css(i.style||{})),this.label.attr(r),this.label.added||this.label.add(t)}this.label.labelrank=e.plotSizeY,n(this,"afterRender")}setOffset(t,e,i,r,s,h){let{alignOptions:c,axis:d,label:u,options:g,textAlign:p}=this,f=d.chart,m=this.getStackBox({xOffset:t,width:e,boxBottom:i,boxTop:r,defaultX:s,xAxis:h}),{verticalAlign:y}=c;if(u&&m){let t=u.getBBox(void 0,0),e=u.padding,i="justify"===l(g.overflow,"justify"),r;c.x=g.x||0,c.y=g.y||0;let{x:s,y:n}=this.adjustStackPosition({labelBox:t,verticalAlign:y,textAlign:p});m.x-=s,m.y-=n,u.align(c,!1,m),(r=f.isInsidePlot(u.alignAttr.x+c.x+s,u.alignAttr.y+c.y+n))||(i=!1),i&&o.prototype.justifyDataLabel.call(d,u,c,u.alignAttr,t,m),u.attr({x:u.alignAttr.x,y:u.alignAttr.y,rotation:g.rotation,rotationOriginX:t.width*({left:0,center:.5,right:1})[g.textAlign||"center"],rotationOriginY:t.height/2}),l(!i&&g.crop,!0)&&(r=a(u.x)&&a(u.y)&&f.isInsidePlot(u.x-e+(u.width||0),u.y)&&f.isInsidePlot(u.x+e,u.y)),u[r?"show":"hide"]()}n(this,"afterSetOffset",{xOffset:t,width:e})}adjustStackPosition({labelBox:t,verticalAlign:e,textAlign:i}){let r={bottom:0,middle:1,top:2,right:1,center:0,left:-1},o=r[e],s=r[i];return{x:t.width/2+t.width/2*s,y:t.height/2*o}}getStackBox(t){let e=this.axis,i=e.chart,{boxTop:r,defaultX:o,xOffset:s,width:n,boxBottom:h}=t,c=e.stacking.usePercentage?100:l(r,this.total,0),d=e.toPixels(c),u=t.xAxis||i.xAxis[0],g=l(o,u.translate(this.x))+s,p=Math.abs(d-e.toPixels(h||a(e.min)&&e.logarithmic&&e.logarithmic.lin2log(e.min)||0)),f=i.inverted,m=this.isNegative;return f?{x:(m?d:d-p)-i.plotLeft,y:u.height-g-n,width:p,height:n}:{x:g+u.transB-i.plotLeft,y:(m?d-p:d)-i.plotTop,width:n,height:p}}}}),i(e,"Core/Axis/Stacking/StackingAxis.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Axis/Axis.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Axis/Stacking/StackItem.js"],e["Core/Utilities.js"]],function(t,e,i,r,o){var s;let{getDeferredAnimation:n}=t,{series:{prototype:a}}=i,{addEvent:l,correctFloat:h,defined:c,destroyObjectProperties:d,fireEvent:u,isArray:g,isNumber:p,objectEach:f,pick:m}=o;function y(){let t=this.inverted;this.axes.forEach(t=>{t.stacking&&t.stacking.stacks&&t.hasVisibleSeries&&(t.stacking.oldStacks=t.stacking.stacks)}),this.series.forEach(e=>{let i=e.xAxis&&e.xAxis.options||{};e.options.stacking&&e.reserveSpace()&&(e.stackKey=[e.type,m(e.options.stack,""),t?i.top:i.left,t?i.height:i.width].join(","))})}function w(){let t=this.stacking;if(t){let e=t.stacks;f(e,(t,i)=>{d(t),delete e[i]}),t.stackTotalGroup?.destroy()}}function b(){this.stacking||(this.stacking=new T(this))}function C(t,e,i,r){return!c(t)||t.x!==e||r&&t.stackKey!==r?t={x:e,index:0,key:r,stackKey:r}:t.index++,t.key=[i,e,t.index].join(","),t}function S(){let t;let e=this,i=e.yAxis,r=e.stackKey||"",o=i.stacking.stacks,s=e.processedXData,n=e.options.stacking,a=e[n+"Stacker"];a&&[r,"-"+r].forEach(i=>{let r=s.length,n,l,h;for(;r--;)n=s[r],t=e.getStackIndicator(t,n,e.index,i),l=o[i]?.[n],(h=l?.points[t.key||""])&&a.call(e,h,l,r)})}function x(t,e,i){let r=e.total?100/e.total:0;t[0]=h(t[0]*r),t[1]=h(t[1]*r),this.stackedYData[i]=t[1]}function E(t){(this.is("column")||this.is("columnrange"))&&(this.options.centerInCategory&&!this.options.stacking&&this.chart.series.length>1?a.setStackedPoints.call(this,t,"group"):t.stacking.resetStacks())}function R(t,e){let i,o,s,n,a,l,d,u,p;let f=e||this.options.stacking;if(!f||!this.reserveSpace()||(({group:"xAxis"})[f]||"yAxis")!==t.coll)return;let y=this.processedXData,w=this.processedYData,b=[],C=w.length,S=this.options,x=S.threshold||0,E=S.startFromThreshold?x:0,R=S.stack,T=e?`${this.type},${f}`:this.stackKey||"",M="-"+T,k=this.negStacks,A=t.stacking,O=A.stacks,P=A.oldStacks;for(A.stacksTouched+=1,d=0;d<C;d++){u=y[d],p=w[d],l=(i=this.getStackIndicator(i,u,this.index)).key||"",O[a=(o=k&&p<(E?0:x))?M:T]||(O[a]={}),O[a][u]||(P[a]?.[u]?(O[a][u]=P[a][u],O[a][u].total=null):O[a][u]=new r(t,t.options.stackLabels,!!o,u,R)),s=O[a][u],null!==p?(s.points[l]=s.points[this.index]=[m(s.cumulative,E)],c(s.cumulative)||(s.base=l),s.touched=A.stacksTouched,i.index>0&&!1===this.singleStacks&&(s.points[l][0]=s.points[this.index+","+u+",0"][0])):(delete s.points[l],delete s.points[this.index]);let e=s.total||0;"percent"===f?(n=o?T:M,e=k&&O[n]?.[u]?(n=O[n][u]).total=Math.max(n.total||0,e)+Math.abs(p)||0:h(e+(Math.abs(p)||0))):"group"===f?(g(p)&&(p=p[0]),null!==p&&e++):e=h(e+(p||0)),"group"===f?s.cumulative=(e||1)-1:s.cumulative=h(m(s.cumulative,E)+(p||0)),s.total=e,null!==p&&(s.points[l].push(s.cumulative),b[d]=s.cumulative,s.hasValidPoints=!0)}"percent"===f&&(A.usePercentage=!0),"group"!==f&&(this.stackedYData=b),A.oldStacks={}}class T{constructor(t){this.oldStacks={},this.stacks={},this.stacksTouched=0,this.axis=t}buildStacks(){let t,e;let i=this.axis,r=i.series,o="xAxis"===i.coll,s=i.options.reversedStacks,n=r.length;for(this.resetStacks(),this.usePercentage=!1,e=n;e--;)t=r[s?e:n-e-1],o&&t.setGroupedPoints(i),t.setStackedPoints(i);if(!o)for(e=0;e<n;e++)r[e].modifyStacks();u(i,"afterBuildStacks")}cleanStacks(){this.oldStacks&&(this.stacks=this.oldStacks,f(this.stacks,t=>{f(t,t=>{t.cumulative=t.total})}))}resetStacks(){f(this.stacks,t=>{f(t,(e,i)=>{p(e.touched)&&e.touched<this.stacksTouched?(e.destroy(),delete t[i]):(e.total=null,e.cumulative=null)})})}renderStackTotals(){let t=this.axis,e=t.chart,i=e.renderer,r=this.stacks,o=n(e,t.options.stackLabels?.animation||!1),s=this.stackTotalGroup=this.stackTotalGroup||i.g("stack-labels").attr({zIndex:6,opacity:0}).add();s.translate(e.plotLeft,e.plotTop),f(r,t=>{f(t,t=>{t.render(s)})}),s.animate({opacity:1},o)}}return(s||(s={})).compose=function(t,e,i){let r=e.prototype,o=i.prototype;r.getStacks||(l(t,"init",b),l(t,"destroy",w),r.getStacks=y,o.getStackIndicator=C,o.modifyStacks=S,o.percentStacker=x,o.setGroupedPoints=E,o.setStackedPoints=R)},s}),i(e,"Series/Line/LineSeries.js",[e["Core/Series/Series.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(t,e,i){let{defined:r,merge:o,isObject:s}=i;class n extends t{drawGraph(){let t=this.options,e=(this.gappedPath||this.getGraphPath).call(this),i=this.chart.styledMode;[this,...this.zones].forEach((r,n)=>{let a,l=r.graph,h=l?"animate":"attr",c=r.dashStyle||t.dashStyle;l?(l.endX=this.preventGraphAnimation?null:e.xMap,l.animate({d:e})):e.length&&(r.graph=l=this.chart.renderer.path(e).addClass("highcharts-graph"+(n?` highcharts-zone-graph-${n-1} `:" ")+(n&&r.className||"")).attr({zIndex:1}).add(this.group)),l&&!i&&(a={stroke:!n&&t.lineColor||r.color||this.color||"#cccccc","stroke-width":t.lineWidth||0,fill:this.fillGraph&&this.color||"none"},c?a.dashstyle=c:"square"!==t.linecap&&(a["stroke-linecap"]=a["stroke-linejoin"]="round"),l[h](a).shadow(n<2&&t.shadow&&o({filterUnits:"userSpaceOnUse"},s(t.shadow)?t.shadow:{}))),l&&(l.startX=e.xMap,l.isArea=e.isArea)})}getGraphPath(t,e,i){let o=this,s=o.options,n=[],a=[],l,h=s.step,c=(t=t||o.points).reversed;return c&&t.reverse(),(h=({right:1,center:2})[h]||h&&3)&&c&&(h=4-h),(t=this.getValidPoints(t,!1,!(s.connectNulls&&!e&&!i))).forEach(function(c,d){let u;let g=c.plotX,p=c.plotY,f=t[d-1],m=c.isNull||"number"!=typeof p;(c.leftCliff||f&&f.rightCliff)&&!i&&(l=!0),m&&!r(e)&&d>0?l=!s.connectNulls:m&&!e?l=!0:(0===d||l?u=[["M",c.plotX,c.plotY]]:o.getPointSpline?u=[o.getPointSpline(t,c,d)]:h?(u=1===h?[["L",f.plotX,p]]:2===h?[["L",(f.plotX+g)/2,f.plotY],["L",(f.plotX+g)/2,p]]:[["L",g,f.plotY]]).push(["L",g,p]):u=[["L",g,p]],a.push(c.x),h&&(a.push(c.x),2===h&&a.push(c.x)),n.push.apply(n,u),l=!1)}),n.xMap=a,o.graphPath=n,n}}return n.defaultOptions=o(t.defaultOptions,{legendSymbol:"lineMarker"}),e.registerSeriesType("line",n),n}),i(e,"Series/Area/AreaSeries.js",[e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(t,e){let{seriesTypes:{line:i}}=t,{extend:r,merge:o,objectEach:s,pick:n}=e;class a extends i{drawGraph(){this.areaPath=[],super.drawGraph.apply(this);let{areaPath:t,options:e}=this;[this,...this.zones].forEach((i,r)=>{let o={},s=i.fillColor||e.fillColor,n=i.area,a=n?"animate":"attr";n?(n.endX=this.preventGraphAnimation?null:t.xMap,n.animate({d:t})):(o.zIndex=0,(n=i.area=this.chart.renderer.path(t).addClass("highcharts-area"+(r?` highcharts-zone-area-${r-1} `:" ")+(r&&i.className||"")).add(this.group)).isArea=!0),this.chart.styledMode||(o.fill=s||i.color||this.color,o["fill-opacity"]=s?1:e.fillOpacity??.75,n.css({pointerEvents:this.stickyTracking?"none":"auto"})),n[a](o),n.startX=t.xMap,n.shiftUnit=e.step?2:1})}getGraphPath(t){let e,r,o;let s=i.prototype.getGraphPath,a=this.options,l=a.stacking,h=this.yAxis,c=[],d=[],u=this.index,g=h.stacking.stacks[this.stackKey],p=a.threshold,f=Math.round(h.getThreshold(a.threshold)),m=n(a.connectNulls,"percent"===l),y=function(i,r,o){let s=t[i],n=l&&g[s.x].points[u],a=s[o+"Null"]||0,m=s[o+"Cliff"]||0,y,w,b=!0;m||a?(y=(a?n[0]:n[1])+m,w=n[0]+m,b=!!a):!l&&t[r]&&t[r].isNull&&(y=w=p),void 0!==y&&(d.push({plotX:e,plotY:null===y?f:h.getThreshold(y),isNull:b,isCliff:!0}),c.push({plotX:e,plotY:null===w?f:h.getThreshold(w),doCurve:!1}))};t=t||this.points,l&&(t=this.getStackPoints(t));for(let i=0,s=t.length;i<s;++i)l||(t[i].leftCliff=t[i].rightCliff=t[i].leftNull=t[i].rightNull=void 0),r=t[i].isNull,e=n(t[i].rectPlotX,t[i].plotX),o=l?n(t[i].yBottom,f):f,r&&!m||(m||y(i,i-1,"left"),r&&!l&&m||(d.push(t[i]),c.push({x:i,plotX:e,plotY:o})),m||y(i,i+1,"right"));let w=s.call(this,d,!0,!0);c.reversed=!0;let b=s.call(this,c,!0,!0),C=b[0];C&&"M"===C[0]&&(b[0]=["L",C[1],C[2]]);let S=w.concat(b);S.length&&S.push(["Z"]);let x=s.call(this,d,!1,m);return S.xMap=w.xMap,this.areaPath=S,x}getStackPoints(t){let e=this,i=[],r=[],o=this.xAxis,a=this.yAxis,l=a.stacking.stacks[this.stackKey],h={},c=a.series,d=c.length,u=a.options.reversedStacks?1:-1,g=c.indexOf(e);if(t=t||this.points,this.options.stacking){for(let e=0;e<t.length;e++)t[e].leftNull=t[e].rightNull=void 0,h[t[e].x]=t[e];s(l,function(t,e){null!==t.total&&r.push(e)}),r.sort(function(t,e){return t-e});let p=c.map(t=>t.visible);r.forEach(function(t,s){let f=0,m,y;if(h[t]&&!h[t].isNull)i.push(h[t]),[-1,1].forEach(function(i){let o=1===i?"rightNull":"leftNull",n=l[r[s+i]],a=0;if(n){let i=g;for(;i>=0&&i<d;){let r=c[i].index;!(m=n.points[r])&&(r===e.index?h[t][o]=!0:p[i]&&(y=l[t].points[r])&&(a-=y[1]-y[0])),i+=u}}h[t][1===i?"rightCliff":"leftCliff"]=a});else{let e=g;for(;e>=0&&e<d;){let i=c[e].index;if(m=l[t].points[i]){f=m[1];break}e+=u}f=n(f,0),f=a.translate(f,0,1,0,1),i.push({isNull:!0,plotX:o.translate(t,0,0,0,1),x:t,plotY:f,yBottom:f})}})}return i}}return a.defaultOptions=o(i.defaultOptions,{threshold:0,legendSymbol:"areaMarker"}),r(a.prototype,{singleStacks:!1}),t.registerSeriesType("area",a),a}),i(e,"Series/Spline/SplineSeries.js",[e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(t,e){let{line:i}=t.seriesTypes,{merge:r,pick:o}=e;class s extends i{getPointSpline(t,e,i){let r,s,n,a;let l=e.plotX||0,h=e.plotY||0,c=t[i-1],d=t[i+1];function u(t){return t&&!t.isNull&&!1!==t.doCurve&&!e.isCliff}if(u(c)&&u(d)){let t=c.plotX||0,i=c.plotY||0,o=d.plotX||0,u=d.plotY||0,g=0;r=(1.5*l+t)/2.5,s=(1.5*h+i)/2.5,n=(1.5*l+o)/2.5,a=(1.5*h+u)/2.5,n!==r&&(g=(a-s)*(n-l)/(n-r)+h-a),s+=g,a+=g,s>i&&s>h?(s=Math.max(i,h),a=2*h-s):s<i&&s<h&&(s=Math.min(i,h),a=2*h-s),a>u&&a>h?(a=Math.max(u,h),s=2*h-a):a<u&&a<h&&(a=Math.min(u,h),s=2*h-a),e.rightContX=n,e.rightContY=a,e.controlPoints={low:[r,s],high:[n,a]}}let g=["C",o(c.rightContX,c.plotX,0),o(c.rightContY,c.plotY,0),o(r,l,0),o(s,h,0),l,h];return c.rightContX=c.rightContY=void 0,g}}return s.defaultOptions=r(i.defaultOptions),t.registerSeriesType("spline",s),s}),i(e,"Series/AreaSpline/AreaSplineSeries.js",[e["Series/Spline/SplineSeries.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(t,e,i){let{area:r,area:{prototype:o}}=e.seriesTypes,{extend:s,merge:n}=i;class a extends t{}return a.defaultOptions=n(t.defaultOptions,r.defaultOptions),s(a.prototype,{getGraphPath:o.getGraphPath,getStackPoints:o.getStackPoints,drawGraph:o.drawGraph}),e.registerSeriesType("areaspline",a),a}),i(e,"Series/Column/ColumnSeriesDefaults.js",[],function(){return{borderRadius:3,centerInCategory:!1,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:void 0,verticalAlign:void 0,y:void 0},startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"}}),i(e,"Series/Column/ColumnSeries.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Color/Color.js"],e["Series/Column/ColumnSeriesDefaults.js"],e["Core/Globals.js"],e["Core/Series/Series.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(t,e,i,r,o,s,n){let{animObject:a}=t,{parse:l}=e,{noop:h}=r,{clamp:c,defined:d,extend:u,fireEvent:g,isArray:p,isNumber:f,merge:m,pick:y,objectEach:w}=n;class b extends o{animate(t){let e,i;let r=this,o=this.yAxis,s=o.pos,n=r.options,l=this.chart.inverted,h={},d=l?"translateX":"translateY";t?(h.scaleY=.001,i=c(o.toPixels(n.threshold),s,s+o.len),l?h.translateX=i-o.len:h.translateY=i,r.clipBox&&r.setClip(),r.group.attr(h)):(e=Number(r.group.attr(d)),r.group.animate({scaleY:1},u(a(r.options.animation),{step:function(t,i){r.group&&(h[d]=e+i.pos*(s-e),r.group.attr(h))}})))}init(t,e){super.init.apply(this,arguments);let i=this;(t=i.chart).hasRendered&&t.series.forEach(function(t){t.type===i.type&&(t.isDirty=!0)})}getColumnMetrics(){let t=this,e=t.options,i=t.xAxis,r=t.yAxis,o=i.options.reversedStacks,s=i.reversed&&!o||!i.reversed&&o,n={},a,l=0;!1===e.grouping?l=1:t.chart.series.forEach(function(e){let i;let o=e.yAxis,s=e.options;e.type===t.type&&e.reserveSpace()&&r.len===o.len&&r.pos===o.pos&&(s.stacking&&"group"!==s.stacking?(void 0===n[a=e.stackKey]&&(n[a]=l++),i=n[a]):!1!==s.grouping&&(i=l++),e.columnIndex=i)});let h=Math.min(Math.abs(i.transA)*(!i.brokenAxis?.hasBreaks&&i.ordinal?.slope||e.pointRange||i.closestPointRange||i.tickInterval||1),i.len),c=h*e.groupPadding,d=(h-2*c)/(l||1),u=Math.min(e.maxPointWidth||i.len,y(e.pointWidth,d*(1-2*e.pointPadding))),g=(t.columnIndex||0)+(s?1:0);return t.columnMetrics={width:u,offset:(d-u)/2+(c+g*d-h/2)*(s?-1:1),paddedWidth:d,columnCount:l},t.columnMetrics}crispCol(t,e,i,r){let o=this.borderWidth,s=-(o%2?.5:0),n=o%2?.5:1;this.options.crisp&&(i=Math.round(t+i)+s-(t=Math.round(t)+s));let a=Math.round(e+r)+n,l=.5>=Math.abs(e)&&a>.5;return r=a-(e=Math.round(e)+n),l&&r&&(e-=1,r+=1),{x:t,y:e,width:i,height:r}}adjustForMissingColumns(t,e,i,r){if(!i.isNull&&r.columnCount>1){let o=this.xAxis.series.filter(t=>t.visible).map(t=>t.index),s=0,n=0;w(this.xAxis.stacking?.stacks,t=>{if("number"==typeof i.x){let e=t[i.x.toString()];if(e&&p(e.points[this.index])){let t=Object.keys(e.points).filter(t=>!t.match(",")&&e.points[t]&&e.points[t].length>1).map(parseFloat).filter(t=>-1!==o.indexOf(t)).sort((t,e)=>e-t);s=t.indexOf(this.index),n=t.length}}}),s=this.xAxis.reversed?n-1-s:s;let a=(n-1)*r.paddedWidth+e;t=(i.plotX||0)+a/2-e-s*r.paddedWidth}return t}translate(){let t=this,e=t.chart,i=t.options,r=t.dense=t.closestPointRange*t.xAxis.transA<2,s=t.borderWidth=y(i.borderWidth,r?0:1),n=t.xAxis,a=t.yAxis,l=i.threshold,h=y(i.minPointLength,5),u=t.getColumnMetrics(),p=u.width,m=t.pointXOffset=u.offset,w=t.dataMin,b=t.dataMax,C=t.barW=Math.max(p,1+2*s),S=t.translatedThreshold=a.getThreshold(l);e.inverted&&(S-=.5),i.pointPadding&&(C=Math.ceil(C)),o.prototype.translate.apply(t),t.points.forEach(function(r){let o=y(r.yBottom,S),s=999+Math.abs(o),g=r.plotX||0,x=c(r.plotY,-s,a.len+s),E,R=Math.min(x,o),T=Math.max(x,o)-R,M=p,k=g+m,A=C;h&&Math.abs(T)<h&&(T=h,E=!a.reversed&&!r.negative||a.reversed&&r.negative,f(l)&&f(b)&&r.y===l&&b<=l&&(a.min||0)<l&&(w!==b||(a.max||0)<=l)&&(E=!E,r.negative=!r.negative),R=Math.abs(R-S)>h?o-h:S-(E?h:0)),d(r.options.pointWidth)&&(k-=Math.round(((M=A=Math.ceil(r.options.pointWidth))-p)/2)),i.centerInCategory&&!i.stacking&&(k=t.adjustForMissingColumns(k,M,r,u)),r.barX=k,r.pointWidth=M,r.tooltipPos=e.inverted?[c(a.len+a.pos-e.plotLeft-x,a.pos-e.plotLeft,a.len+a.pos-e.plotLeft),n.len+n.pos-e.plotTop-k-A/2,T]:[n.left-e.plotLeft+k+A/2,c(x+a.pos-e.plotTop,a.pos-e.plotTop,a.len+a.pos-e.plotTop),T],r.shapeType=t.pointClass.prototype.shapeType||"roundedRect",r.shapeArgs=t.crispCol(k,r.isNull?S:R,A,r.isNull?0:T)}),g(this,"afterColumnTranslate")}drawGraph(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")}pointAttribs(t,e){let i=this.options,r=this.pointAttrToOptions||{},o=r.stroke||"borderColor",s=r["stroke-width"]||"borderWidth",n,a,h,c=t&&t.color||this.color,d=t&&t[o]||i[o]||c,u=t&&t.options.dashStyle||i.dashStyle,g=t&&t[s]||i[s]||this[s]||0,p=y(t&&t.opacity,i.opacity,1);t&&this.zones.length&&(a=t.getZone(),c=t.options.color||a&&(a.color||t.nonZonedColor)||this.color,a&&(d=a.borderColor||d,u=a.dashStyle||u,g=a.borderWidth||g)),e&&t&&(h=(n=m(i.states[e],t.options.states&&t.options.states[e]||{})).brightness,c=n.color||void 0!==h&&l(c).brighten(n.brightness).get()||c,d=n[o]||d,g=n[s]||g,u=n.dashStyle||u,p=y(n.opacity,p));let f={fill:c,stroke:d,"stroke-width":g,opacity:p};return u&&(f.dashstyle=u),f}drawPoints(t=this.points){let e;let i=this,r=this.chart,o=i.options,s=r.renderer,n=o.animationLimit||250;t.forEach(function(t){let a=t.plotY,l=t.graphic,h=!!l,c=l&&r.pointCount<n?"animate":"attr";f(a)&&null!==t.y?(e=t.shapeArgs,l&&t.hasNewShapeType()&&(l=l.destroy()),i.enabledDataSorting&&(t.startXPos=i.xAxis.reversed?-(e&&e.width||0):i.xAxis.width),!l&&(t.graphic=l=s[t.shapeType](e).add(t.group||i.group),l&&i.enabledDataSorting&&r.hasRendered&&r.pointCount<n&&(l.attr({x:t.startXPos}),h=!0,c="animate")),l&&h&&l[c](m(e)),r.styledMode||l[c](i.pointAttribs(t,t.selected&&"select")).shadow(!1!==t.allowShadow&&o.shadow),l&&(l.addClass(t.getClassName(),!0),l.attr({visibility:t.visible?"inherit":"hidden"}))):l&&(t.graphic=l.destroy())})}drawTracker(t=this.points){let e;let i=this,r=i.chart,o=r.pointer,s=function(t){let e=o?.getPointFromEvent(t);o&&e&&i.options.enableMouseTracking&&(o.isDirectTouch=!0,e.onMouseOver(t))};t.forEach(function(t){e=p(t.dataLabels)?t.dataLabels:t.dataLabel?[t.dataLabel]:[],t.graphic&&(t.graphic.element.point=t),e.forEach(function(e){(e.div||e.element).point=t})}),i._hasTracking||(i.trackerGroups.forEach(function(t){i[t]&&(i[t].addClass("highcharts-tracker").on("mouseover",s).on("mouseout",function(t){o?.onTrackerMouseOut(t)}).on("touchstart",s),!r.styledMode&&i.options.cursor&&i[t].css({cursor:i.options.cursor}))}),i._hasTracking=!0),g(this,"afterDrawTracker")}remove(){let t=this,e=t.chart;e.hasRendered&&e.series.forEach(function(e){e.type===t.type&&(e.isDirty=!0)}),o.prototype.remove.apply(t,arguments)}}return b.defaultOptions=m(o.defaultOptions,i),u(b.prototype,{directTouch:!0,getSymbol:h,negStacks:!0,trackerGroups:["group","dataLabelsGroup"]}),s.registerSeriesType("column",b),b}),i(e,"Core/Series/DataLabel.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Templating.js"],e["Core/Utilities.js"]],function(t,e,i){var r;let{getDeferredAnimation:o}=t,{format:s}=e,{defined:n,extend:a,fireEvent:l,isArray:h,isString:c,merge:d,objectEach:u,pick:g,pInt:p,splat:f}=i;return function(t){function e(){return C(this).some(t=>t?.enabled)}function i(t,e,i,r,o){let s=this.chart,l=this.isCartesian&&s.inverted,h=this.enabledDataSorting,c=t.plotX,u=t.plotY,p=i.rotation||0,f=n(c)&&n(u)&&s.isInsidePlot(c,Math.round(u),{inverted:l,paneCoordinates:!0,series:this}),m=0===p&&"justify"===g(i.overflow,h?"none":"justify"),y=this.visible&&!1!==t.visible&&n(c)&&(t.series.forceDL||h&&!m||f||g(i.inside,!!this.options.stacking)&&r&&s.isInsidePlot(c,l?r.x+1:r.y+r.height-1,{inverted:l,paneCoordinates:!0,series:this})),w=t.pos();if(y&&w){var b;let n=e.getBBox(),l=e.getBBox(void 0,0),c={right:1,center:.5}[i.align||0]||0,u={bottom:1,middle:.5}[i.verticalAlign||0]||0;if(r=a({x:w[0],y:Math.round(w[1]),width:0,height:0},r||{}),a(i,{width:n.width,height:n.height}),b=r,h&&this.xAxis&&!m&&this.setDataLabelStartPos(t,e,o,f,b),e.align(d(i,{width:l.width,height:l.height}),!1,r,!1),e.alignAttr.x+=c*(l.width-n.width),e.alignAttr.y+=u*(l.height-n.height),e[e.placed?"animate":"attr"]({x:e.alignAttr.x+(n.width-l.width)/2,y:e.alignAttr.y+(n.height-l.height)/2,rotationOriginX:(e.width||0)/2,rotationOriginY:(e.height||0)/2}),m&&r.height>=0)this.justifyDataLabel(e,i,e.alignAttr,n,r,o);else if(g(i.crop,!0)){let{x:t,y:i}=e.alignAttr;y=s.isInsidePlot(t,i,{paneCoordinates:!0,series:this})&&s.isInsidePlot(t+n.width-1,i+n.height-1,{paneCoordinates:!0,series:this})}i.shape&&!p&&e[o?"attr":"animate"]({anchorX:w[0],anchorY:w[1]})}o&&h&&(e.placed=!1),y||h&&!m?(e.show(),e.placed=!0):(e.hide(),e.placed=!1)}function r(){return this.plotGroup("dataLabelsGroup","data-labels",this.hasRendered?"inherit":"hidden",this.options.dataLabels.zIndex||6)}function m(t){let e=this.hasRendered||0,i=this.initDataLabelsGroup().attr({opacity:+e});return!e&&i&&(this.visible&&i.show(),this.options.animation?i.animate({opacity:1},t):i.attr({opacity:1})),i}function y(t){let e;t=t||this.points;let i=this,r=i.chart,a=i.options,h=r.renderer,{backgroundColor:d,plotBackgroundColor:m}=r.options.chart,y=h.getContrast(c(m)&&m||c(d)&&d||"#000000"),w=C(i),{animation:S,defer:x}=w[0],E=x?o(r,S,i):{defer:0,duration:0};l(this,"drawDataLabels"),i.hasDataLabels?.()&&(e=this.initDataLabels(E),t.forEach(t=>{let o=t.dataLabels||[];f(b(w,t.dlOptions||t.options?.dataLabels)).forEach((l,d)=>{let f=l.enabled&&(t.visible||t.dataLabelOnHidden)&&(!t.isNull||t.dataLabelOnNull)&&function(t,e){let i=e.filter;if(i){let e=i.operator,r=t[i.property],o=i.value;return">"===e&&r>o||"<"===e&&r<o||">="===e&&r>=o||"<="===e&&r<=o||"=="===e&&r==o||"==="===e&&r===o||"!="===e&&r!=o||"!=="===e&&r!==o}return!0}(t,l),{backgroundColor:m,borderColor:w,distance:b,style:C={}}=l,S,x,E,R,T={},M=o[d],k=!M,A;if(f&&(x=g(l[t.formatPrefix+"Format"],l.format),S=t.getLabelConfig(),E=n(x)?s(x,S,r):(l[t.formatPrefix+"Formatter"]||l.formatter).call(S,l),R=l.rotation,!r.styledMode&&(C.color=g(l.color,C.color,c(i.color)?i.color:void 0,"#000000"),"contrast"===C.color?("none"!==m&&(A=m),t.contrastColor=h.getContrast("auto"!==A&&A||t.color||i.color),C.color=A||!n(b)&&l.inside||0>p(b||0)||a.stacking?t.contrastColor:y):delete t.contrastColor,a.cursor&&(C.cursor=a.cursor)),T={r:l.borderRadius||0,rotation:R,padding:l.padding,zIndex:1},r.styledMode||(T.fill="auto"===m?t.color:m,T.stroke="auto"===w?t.color:w,T["stroke-width"]=l.borderWidth),u(T,(t,e)=>{void 0===t&&delete T[e]})),!M||f&&n(E)&&!!M.div==!!l.useHTML&&(M.rotation&&l.rotation||M.rotation===l.rotation)||(M=void 0,k=!0),f&&n(E)&&(M?T.text=E:(M=h.label(E,0,0,l.shape,void 0,void 0,l.useHTML,void 0,"data-label")).addClass(" highcharts-data-label-color-"+t.colorIndex+" "+(l.className||"")+(l.useHTML?" highcharts-tracker":"")),M)){M.options=l,M.attr(T),r.styledMode||M.css(C).shadow(l.shadow);let s=l[t.formatPrefix+"TextPath"]||l.textPath;s&&!l.useHTML&&(M.setTextPath(t.getDataLabelPath?.(M)||t.graphic,s),t.dataLabelPath&&!s.enabled&&(t.dataLabelPath=t.dataLabelPath.destroy())),M.added||M.add(e),i.alignDataLabel(t,M,l,void 0,k),M.isActive=!0,o[d]&&o[d]!==M&&o[d].destroy(),o[d]=M}});let l=o.length;for(;l--;)o[l]&&o[l].isActive?o[l].isActive=!1:(o[l]?.destroy(),o.splice(l,1));t.dataLabel=o[0],t.dataLabels=o})),l(this,"afterDrawDataLabels")}function w(t,e,i,r,o,s){let n=this.chart,a=e.align,l=e.verticalAlign,h=t.box?0:t.padding||0,{x:c=0,y:d=0}=e,u,g;return(u=(i.x||0)+h)<0&&("right"===a&&c>=0?(e.align="left",e.inside=!0):c-=u,g=!0),(u=(i.x||0)+r.width-h)>n.plotWidth&&("left"===a&&c<=0?(e.align="right",e.inside=!0):c+=n.plotWidth-u,g=!0),(u=i.y+h)<0&&("bottom"===l&&d>=0?(e.verticalAlign="top",e.inside=!0):d-=u,g=!0),(u=(i.y||0)+r.height-h)>n.plotHeight&&("top"===l&&d<=0?(e.verticalAlign="bottom",e.inside=!0):d+=n.plotHeight-u,g=!0),g&&(e.x=c,e.y=d,t.placed=!s,t.align(e,void 0,o)),g}function b(t,e){let i=[],r;if(h(t)&&!h(e))i=t.map(function(t){return d(t,e)});else if(h(e)&&!h(t))i=e.map(function(e){return d(t,e)});else if(h(t)||h(e)){if(h(t)&&h(e))for(r=Math.max(t.length,e.length);r--;)i[r]=d(t[r],e[r])}else i=d(t,e);return i}function C(t){let e=t.chart.options.plotOptions;return f(b(b(e?.series?.dataLabels,e?.[t.type]?.dataLabels),t.options.dataLabels))}function S(t,e,i,r,o){let s=this.chart,n=s.inverted,a=this.xAxis,l=a.reversed,h=((n?e.height:e.width)||0)/2,c=t.pointWidth,d=c?c/2:0;e.startXPos=n?o.x:l?-h-d:a.width-h+d,e.startYPos=n?l?this.yAxis.height-h+d:-h-d:o.y,r?"hidden"===e.visibility&&(e.show(),e.attr({opacity:0}).animate({opacity:1})):e.attr({opacity:1}).animate({opacity:0},void 0,e.hide),s.hasRendered&&(i&&e.attr({x:e.startXPos,y:e.startYPos}),e.placed=!0)}t.compose=function(t){let o=t.prototype;o.initDataLabels||(o.initDataLabels=m,o.initDataLabelsGroup=r,o.alignDataLabel=i,o.drawDataLabels=y,o.justifyDataLabel=w,o.setDataLabelStartPos=S,o.hasDataLabels=e)}}(r||(r={})),r}),i(e,"Series/Column/ColumnDataLabel.js",[e["Core/Series/DataLabel.js"],e["Core/Globals.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(t,e,i,r){var o;let{composed:s}=e,{series:n}=i,{merge:a,pick:l,pushUnique:h}=r;return function(e){function i(t,e,i,r,o){let s=this.chart.inverted,h=t.series,c=(h.xAxis?h.xAxis.len:this.chart.plotSizeX)||0,d=(h.yAxis?h.yAxis.len:this.chart.plotSizeY)||0,u=t.dlBox||t.shapeArgs,g=l(t.below,t.plotY>l(this.translatedThreshold,d)),p=l(i.inside,!!this.options.stacking);if(u){if(r=a(u),!("allow"===i.overflow&&!1===i.crop)){r.y<0&&(r.height+=r.y,r.y=0);let t=r.y+r.height-d;t>0&&t<r.height&&(r.height-=t)}s&&(r={x:d-r.y-r.height,y:c-r.x-r.width,width:r.height,height:r.width}),p||(s?(r.x+=g?0:r.width,r.width=0):(r.y+=g?r.height:0,r.height=0))}i.align=l(i.align,!s||p?"center":g?"right":"left"),i.verticalAlign=l(i.verticalAlign,s||p?"middle":g?"top":"bottom"),n.prototype.alignDataLabel.call(this,t,e,i,r,o),i.inside&&t.contrastColor&&e.css({color:t.contrastColor})}e.compose=function(e){t.compose(n),h(s,"ColumnDataLabel")&&(e.prototype.alignDataLabel=i)}}(o||(o={})),o}),i(e,"Series/Bar/BarSeries.js",[e["Series/Column/ColumnSeries.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(t,e,i){let{extend:r,merge:o}=i;class s extends t{}return s.defaultOptions=o(t.defaultOptions,{}),r(s.prototype,{inverted:!0}),e.registerSeriesType("bar",s),s}),i(e,"Series/Scatter/ScatterSeriesDefaults.js",[],function(){return{lineWidth:0,findNearestPointBy:"xy",jitter:{x:0,y:0},marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}"></span> <span style="font-size: 0.8em"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}}}),i(e,"Series/Scatter/ScatterSeries.js",[e["Series/Scatter/ScatterSeriesDefaults.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(t,e,i){let{column:r,line:o}=e.seriesTypes,{addEvent:s,extend:n,merge:a}=i;class l extends o{applyJitter(){let t=this,e=this.options.jitter,i=this.points.length;e&&this.points.forEach(function(r,o){["x","y"].forEach(function(s,n){if(e[s]&&!r.isNull){let a=`plot${s.toUpperCase()}`,l=t[`${s}Axis`],h=e[s]*l.transA;if(l&&!l.logarithmic){let t,e=Math.max(0,(r[a]||0)-h),c=Math.min(l.len,(r[a]||0)+h);r[a]=e+(c-e)*((t=1e4*Math.sin(o+n*i))-Math.floor(t)),"x"===s&&(r.clientX=r.plotX)}}})})}drawGraph(){this.options.lineWidth?super.drawGraph():this.graph&&(this.graph=this.graph.destroy())}}return l.defaultOptions=a(o.defaultOptions,t),n(l.prototype,{drawTracker:r.prototype.drawTracker,sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"]}),s(l,"afterTranslate",function(){this.applyJitter()}),e.registerSeriesType("scatter",l),l}),i(e,"Series/CenteredUtilities.js",[e["Core/Globals.js"],e["Core/Series/Series.js"],e["Core/Utilities.js"]],function(t,e,i){var r,o;let{deg2rad:s}=t,{fireEvent:n,isNumber:a,pick:l,relativeLength:h}=i;return(o=r||(r={})).getCenter=function(){let t=this.options,i=this.chart,r=2*(t.slicedOffset||0),o=i.plotWidth-2*r,s=i.plotHeight-2*r,c=t.center,d=Math.min(o,s),u=t.thickness,g,p=t.size,f=t.innerSize||0,m,y;"string"==typeof p&&(p=parseFloat(p)),"string"==typeof f&&(f=parseFloat(f));let w=[l(c[0],"50%"),l(c[1],"50%"),l(p&&p<0?void 0:t.size,"100%"),l(f&&f<0?void 0:t.innerSize||0,"0%")];for(!i.angular||this instanceof e||(w[3]=0),m=0;m<4;++m)y=w[m],g=m<2||2===m&&/%$/.test(y),w[m]=h(y,[o,s,d,w[2]][m])+(g?r:0);return w[3]>w[2]&&(w[3]=w[2]),a(u)&&2*u<w[2]&&u>0&&(w[3]=w[2]-2*u),n(this,"afterGetCenter",{positions:w}),w},o.getStartAndEndRadians=function(t,e){let i=a(t)?t:0,r=a(e)&&e>i&&e-i<360?e:i+360;return{start:s*(i+-90),end:s*(r+-90)}},r}),i(e,"Series/Pie/PiePoint.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Series/Point.js"],e["Core/Utilities.js"]],function(t,e,i){let{setAnimation:r}=t,{addEvent:o,defined:s,extend:n,isNumber:a,pick:l,relativeLength:h}=i;class c extends e{getConnectorPath(t){let e=t.dataLabelPosition,i=t.options||{},r=i.connectorShape,o=this.connectorShapes[r]||r;return e&&o.call(this,{...e.computed,alignment:e.alignment},e.connectorPosition,i)||[]}getTranslate(){return this.sliced&&this.slicedTranslation||{translateX:0,translateY:0}}haloPath(t){let e=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(e.x,e.y,e.r+t,e.r+t,{innerR:e.r-1,start:e.start,end:e.end,borderRadius:e.borderRadius})}constructor(t,e,i){super(t,e,i),this.half=0,this.name??(this.name="Slice");let r=t=>{this.slice("select"===t.type)};o(this,"select",r),o(this,"unselect",r)}isValid(){return a(this.y)&&this.y>=0}setVisible(t,e=!0){t!==this.visible&&this.update({visible:t??!this.visible},e,void 0,!1)}slice(t,e,i){let o=this.series;r(i,o.chart),e=l(e,!0),this.sliced=this.options.sliced=t=s(t)?t:!this.sliced,o.options.data[o.data.indexOf(this)]=this.options,this.graphic&&this.graphic.animate(this.getTranslate())}}return n(c.prototype,{connectorShapes:{fixedOffset:function(t,e,i){let r=e.breakAt,o=e.touchingSliceAt,s=i.softConnector?["C",t.x+("left"===t.alignment?-5:5),t.y,2*r.x-o.x,2*r.y-o.y,r.x,r.y]:["L",r.x,r.y];return[["M",t.x,t.y],s,["L",o.x,o.y]]},straight:function(t,e){let i=e.touchingSliceAt;return[["M",t.x,t.y],["L",i.x,i.y]]},crookedLine:function(t,e,i){let{breakAt:r,touchingSliceAt:o}=e,{series:s}=this,[n,a,l]=s.center,c=l/2,{plotLeft:d,plotWidth:u}=s.chart,g="left"===t.alignment,{x:p,y:f}=t,m=r.x;if(i.crookDistance){let t=h(i.crookDistance,1);m=g?n+c+(u+d-n-c)*(1-t):d+(n-c)*t}else m=n+(a-f)*Math.tan((this.angle||0)-Math.PI/2);let y=[["M",p,f]];return(g?m<=p&&m>=r.x:m>=p&&m<=r.x)&&y.push(["L",m,f]),y.push(["L",r.x,r.y],["L",o.x,o.y]),y}}}),c}),i(e,"Series/Pie/PieSeriesDefaults.js",[],function(){return{borderRadius:3,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{connectorPadding:5,connectorShape:"crookedLine",crookDistance:void 0,distance:30,enabled:!0,formatter:function(){return this.point.isNull?void 0:this.point.name},softConnector:!0,x:0},fillColor:void 0,ignoreHiddenPoint:!0,inactiveOtherPoints:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,lineWidth:void 0,states:{hover:{brightness:.1}}}}),i(e,"Series/Pie/PieSeries.js",[e["Series/CenteredUtilities.js"],e["Series/Column/ColumnSeries.js"],e["Core/Globals.js"],e["Series/Pie/PiePoint.js"],e["Series/Pie/PieSeriesDefaults.js"],e["Core/Series/Series.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Renderer/SVG/Symbols.js"],e["Core/Utilities.js"]],function(t,e,i,r,o,s,n,a,l){let{getStartAndEndRadians:h}=t,{noop:c}=i,{clamp:d,extend:u,fireEvent:g,merge:p,pick:f}=l;class m extends s{animate(t){let e=this,i=e.points,r=e.startAngleRad;t||i.forEach(function(t){let i=t.graphic,o=t.shapeArgs;i&&o&&(i.attr({r:f(t.startR,e.center&&e.center[3]/2),start:r,end:r}),i.animate({r:o.r,start:o.start,end:o.end},e.options.animation))})}drawEmpty(){let t,e;let i=this.startAngleRad,r=this.endAngleRad,o=this.options;0===this.total&&this.center?(t=this.center[0],e=this.center[1],this.graph||(this.graph=this.chart.renderer.arc(t,e,this.center[1]/2,0,i,r).addClass("highcharts-empty-series").add(this.group)),this.graph.attr({d:a.arc(t,e,this.center[2]/2,0,{start:i,end:r,innerR:this.center[3]/2})}),this.chart.styledMode||this.graph.attr({"stroke-width":o.borderWidth,fill:o.fillColor||"none",stroke:o.color||"#cccccc"})):this.graph&&(this.graph=this.graph.destroy())}drawPoints(){let t=this.chart.renderer;this.points.forEach(function(e){e.graphic&&e.hasNewShapeType()&&(e.graphic=e.graphic.destroy()),e.graphic||(e.graphic=t[e.shapeType](e.shapeArgs).add(e.series.group),e.delayedRendering=!0)})}generatePoints(){super.generatePoints(),this.updateTotals()}getX(t,e,i,r){let o=this.center,s=this.radii?this.radii[i.index]||0:o[2]/2,n=r.dataLabelPosition,a=n?.distance||0,l=Math.asin(d((t-o[1])/(s+a),-1,1));return o[0]+Math.cos(l)*(s+a)*(e?-1:1)+(a>0?(e?-1:1)*(r.padding||0):0)}hasData(){return!!this.processedXData.length}redrawPoints(){let t,e,i,r;let o=this,s=o.chart;this.drawEmpty(),o.group&&!s.styledMode&&o.group.shadow(o.options.shadow),o.points.forEach(function(n){let a={};e=n.graphic,!n.isNull&&e?(r=n.shapeArgs,t=n.getTranslate(),s.styledMode||(i=o.pointAttribs(n,n.selected&&"select")),n.delayedRendering?(e.setRadialReference(o.center).attr(r).attr(t),s.styledMode||e.attr(i).attr({"stroke-linejoin":"round"}),n.delayedRendering=!1):(e.setRadialReference(o.center),s.styledMode||p(!0,a,i),p(!0,a,r,t),e.animate(a)),e.attr({visibility:n.visible?"inherit":"hidden"}),e.addClass(n.getClassName(),!0)):e&&(n.graphic=e.destroy())})}sortByAngle(t,e){t.sort(function(t,i){return void 0!==t.angle&&(i.angle-t.angle)*e})}translate(t){g(this,"translate"),this.generatePoints();let e=this.options,i=e.slicedOffset,r=h(e.startAngle,e.endAngle),o=this.startAngleRad=r.start,s=(this.endAngleRad=r.end)-o,n=this.points,a=e.ignoreHiddenPoint,l=n.length,c,d,u,p,f,m,y,w=0;for(t||(this.center=t=this.getCenter()),m=0;m<l;m++){y=n[m],c=o+w*s,y.isValid()&&(!a||y.visible)&&(w+=y.percentage/100),d=o+w*s;let e={x:t[0],y:t[1],r:t[2]/2,innerR:t[3]/2,start:Math.round(1e3*c)/1e3,end:Math.round(1e3*d)/1e3};y.shapeType="arc",y.shapeArgs=e,(u=(d+c)/2)>1.5*Math.PI?u-=2*Math.PI:u<-Math.PI/2&&(u+=2*Math.PI),y.slicedTranslation={translateX:Math.round(Math.cos(u)*i),translateY:Math.round(Math.sin(u)*i)},p=Math.cos(u)*t[2]/2,f=Math.sin(u)*t[2]/2,y.tooltipPos=[t[0]+.7*p,t[1]+.7*f],y.half=u<-Math.PI/2||u>Math.PI/2?1:0,y.angle=u}g(this,"afterTranslate")}updateTotals(){let t=this.points,e=t.length,i=this.options.ignoreHiddenPoint,r,o,s=0;for(r=0;r<e;r++)(o=t[r]).isValid()&&(!i||o.visible)&&(s+=o.y);for(r=0,this.total=s;r<e;r++)(o=t[r]).percentage=s>0&&(o.visible||!i)?o.y/s*100:0,o.total=s}}return m.defaultOptions=p(s.defaultOptions,o),u(m.prototype,{axisTypes:[],directTouch:!0,drawGraph:void 0,drawTracker:e.prototype.drawTracker,getCenter:t.getCenter,getSymbol:c,invertible:!1,isCartesian:!1,noSharedTooltip:!0,pointAttribs:e.prototype.pointAttribs,pointClass:r,requireSorting:!1,searchPoint:c,trackerGroups:["group","dataLabelsGroup"]}),n.registerSeriesType("pie",m),m}),i(e,"Series/Pie/PieDataLabel.js",[e["Core/Series/DataLabel.js"],e["Core/Globals.js"],e["Core/Renderer/RendererUtilities.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(t,e,i,r,o){var s;let{composed:n,noop:a}=e,{distribute:l}=i,{series:h}=r,{arrayMax:c,clamp:d,defined:u,pick:g,pushUnique:p,relativeLength:f}=o;return function(e){let i={radialDistributionY:function(t,e){return(e.dataLabelPosition?.top||0)+t.distributeBox.pos},radialDistributionX:function(t,e,i,r,o){let s=o.dataLabelPosition;return t.getX(i<(s?.top||0)+2||i>(s?.bottom||0)-2?r:i,e.half,e,o)},justify:function(t,e,i,r){return r[0]+(t.half?-1:1)*(i+(e.dataLabelPosition?.distance||0))},alignToPlotEdges:function(t,e,i,r){let o=t.getBBox().width;return e?o+r:i-o-r},alignToConnectors:function(t,e,i,r){let o=0,s;return t.forEach(function(t){(s=t.dataLabel.getBBox().width)>o&&(o=s)}),e?o+r:i-o-r}};function r(t,e){let{center:i,options:r}=this,o=i[2]/2,s=t.angle||0,n=Math.cos(s),a=Math.sin(s),l=i[0]+n*o,h=i[1]+a*o,c=Math.min((r.slicedOffset||0)+(r.borderWidth||0),e/5);return{natural:{x:l+n*e,y:h+a*e},computed:{},alignment:e<0?"center":t.half?"right":"left",connectorPosition:{breakAt:{x:l+n*c,y:h+a*c},touchingSliceAt:{x:l,y:h}},distance:e}}function o(){let t=this,e=t.points,i=t.chart,r=i.plotWidth,o=i.plotHeight,s=i.plotLeft,n=Math.round(i.chartWidth/3),a=t.center,d=a[2]/2,p=a[1],m=[[],[]],y=[0,0,0,0],w=t.dataLabelPositioners,b,C,S,x=0;t.visible&&t.hasDataLabels?.()&&(e.forEach(t=>{(t.dataLabels||[]).forEach(t=>{t.shortened&&(t.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),t.shortened=!1)})}),h.prototype.drawDataLabels.apply(t),e.forEach(t=>{(t.dataLabels||[]).forEach((e,i)=>{let r=a[2]/2,o=e.options,s=f(o?.distance||0,r);0===i&&m[t.half].push(t),!u(o?.style?.width)&&e.getBBox().width>n&&(e.css({width:Math.round(.7*n)+"px"}),e.shortened=!0),e.dataLabelPosition=this.getDataLabelPosition(t,s),x=Math.max(x,s)})}),m.forEach((e,n)=>{let h=e.length,c=[],f,m,b=0,E;h&&(t.sortByAngle(e,n-.5),x>0&&(f=Math.max(0,p-d-x),m=Math.min(p+d+x,i.plotHeight),e.forEach(t=>{(t.dataLabels||[]).forEach(e=>{let r=e.dataLabelPosition;r&&r.distance>0&&(r.top=Math.max(0,p-d-r.distance),r.bottom=Math.min(p+d+r.distance,i.plotHeight),b=e.getBBox().height||21,t.distributeBox={target:(e.dataLabelPosition?.natural.y||0)-r.top+b/2,size:b,rank:t.y},c.push(t.distributeBox))})}),l(c,E=m+b-f,E/5)),e.forEach(i=>{(i.dataLabels||[]).forEach(l=>{let h=l.options||{},p=i.distributeBox,f=l.dataLabelPosition,m=f?.natural.y||0,b=h.connectorPadding||0,x=0,E=m,R="inherit";if(f){if(c&&u(p)&&f.distance>0&&(void 0===p.pos?R="hidden":(S=p.size,E=w.radialDistributionY(i,l))),h.justify)x=w.justify(i,l,d,a);else switch(h.alignTo){case"connectors":x=w.alignToConnectors(e,n,r,s);break;case"plotEdges":x=w.alignToPlotEdges(l,n,r,s);break;default:x=w.radialDistributionX(t,i,E,m,l)}if(f.attribs={visibility:R,align:f.alignment},f.posAttribs={x:x+(h.x||0)+(({left:b,right:-b})[f.alignment]||0),y:E+(h.y||0)-l.getBBox().height/2},f.computed.x=x,f.computed.y=E,g(h.crop,!0)){let t;x-(C=l.getBBox().width)<b&&1===n?(t=Math.round(C-x+b),y[3]=Math.max(t,y[3])):x+C>r-b&&0===n&&(t=Math.round(x+C-r+b),y[1]=Math.max(t,y[1])),E-S/2<0?y[0]=Math.max(Math.round(-E+S/2),y[0]):E+S/2>o&&(y[2]=Math.max(Math.round(E+S/2-o),y[2])),f.sideOverflow=t}}})}))}),(0===c(y)||this.verifyDataLabelOverflow(y))&&(this.placeDataLabels(),this.points.forEach(e=>{(e.dataLabels||[]).forEach(r=>{let{connectorColor:o,connectorWidth:s=1}=r.options||{},n=r.dataLabelPosition;if(s){let a;b=r.connector,n&&n.distance>0?(a=!b,b||(r.connector=b=i.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+e.colorIndex+(e.className?" "+e.className:"")).add(t.dataLabelsGroup)),i.styledMode||b.attr({"stroke-width":s,stroke:o||e.color||"#666666"}),b[a?"attr":"animate"]({d:e.getConnectorPath(r)}),b.attr({visibility:n.attribs?.visibility})):b&&(r.connector=b.destroy())}})})))}function s(){this.points.forEach(t=>{(t.dataLabels||[]).forEach(t=>{let e=t.dataLabelPosition;e?(e.sideOverflow&&(t.css({width:Math.max(t.getBBox().width-e.sideOverflow,0)+"px",textOverflow:(t.options?.style||{}).textOverflow||"ellipsis"}),t.shortened=!0),t.attr(e.attribs),t[t.moved?"animate":"attr"](e.posAttribs),t.moved=!0):t&&t.attr({y:-9999})}),delete t.distributeBox},this)}function m(t){let e=this.center,i=this.options,r=i.center,o=i.minSize||80,s=o,n=null!==i.size;return!n&&(null!==r[0]?s=Math.max(e[2]-Math.max(t[1],t[3]),o):(s=Math.max(e[2]-t[1]-t[3],o),e[0]+=(t[3]-t[1])/2),null!==r[1]?s=d(s,o,e[2]-Math.max(t[0],t[2])):(s=d(s,o,e[2]-t[0]-t[2]),e[1]+=(t[0]-t[2])/2),s<e[2]?(e[2]=s,e[3]=Math.min(i.thickness?Math.max(0,s-2*i.thickness):Math.max(0,f(i.innerSize||0,s)),s),this.translate(e),this.drawDataLabels&&this.drawDataLabels()):n=!0),n}e.compose=function(e){if(t.compose(h),p(n,"PieDataLabel")){let t=e.prototype;t.dataLabelPositioners=i,t.alignDataLabel=a,t.drawDataLabels=o,t.getDataLabelPosition=r,t.placeDataLabels=s,t.verifyDataLabelOverflow=m}}}(s||(s={})),s}),i(e,"Extensions/OverlappingDataLabels.js",[e["Core/Utilities.js"]],function(t){let{addEvent:e,fireEvent:i,objectEach:r,pick:o}=t;function s(t){let e=t.length,r=(t,e)=>!(e.x>=t.x+t.width||e.x+e.width<=t.x||e.y>=t.y+t.height||e.y+e.height<=t.y),o,s,a,l,h,c=!1;for(let i=0;i<e;i++)(o=t[i])&&(o.oldOpacity=o.opacity,o.newOpacity=1,o.absoluteBox=function(t){if(t&&(!t.alignAttr||t.placed)){let e=t.box?0:t.padding||0,i=t.alignAttr||{x:t.attr("x"),y:t.attr("y")},r=t.getBBox();return t.width=r.width,t.height=r.height,{x:i.x+(t.parentGroup?.translateX||0)+e,y:i.y+(t.parentGroup?.translateY||0)+e,width:(t.width||0)-2*e,height:(t.height||0)-2*e}}}(o));t.sort((t,e)=>(e.labelrank||0)-(t.labelrank||0));for(let i=0;i<e;++i){l=(s=t[i])&&s.absoluteBox;for(let o=i+1;o<e;++o)h=(a=t[o])&&a.absoluteBox,l&&h&&s!==a&&0!==s.newOpacity&&0!==a.newOpacity&&"hidden"!==s.visibility&&"hidden"!==a.visibility&&r(l,h)&&((s.labelrank<a.labelrank?s:a).newOpacity=0)}for(let e of t)n(e,this)&&(c=!0);c&&i(this,"afterHideAllOverlappingLabels")}function n(t,e){let r,o,s=!1;return t&&(o=t.newOpacity,t.oldOpacity!==o&&(t.hasClass("highcharts-data-label")?(t[o?"removeClass":"addClass"]("highcharts-data-label-hidden"),r=function(){e.styledMode||t.css({pointerEvents:o?"auto":"none"})},s=!0,t[t.isOld?"animate":"attr"]({opacity:o},void 0,r),i(e,"afterHideOverlappingLabel")):t.attr({opacity:o})),t.isOld=!0),s}function a(){let t=this,e=[];for(let i of t.labelCollectors||[])e=e.concat(i());for(let i of t.yAxis||[])i.stacking&&i.options.stackLabels&&!i.options.stackLabels.allowOverlap&&r(i.stacking.stacks,t=>{r(t,t=>{t.label&&e.push(t.label)})});for(let i of t.series||[])if(i.visible&&i.hasDataLabels?.()){let r=i=>{for(let r of i)r.visible&&(r.dataLabels||[]).forEach(i=>{let s=i.options||{};i.labelrank=o(s.labelrank,r.labelrank,r.shapeArgs?.height),s.allowOverlap??Number(s.distance)>0?(i.oldOpacity=i.opacity,i.newOpacity=1,n(i,t)):e.push(i)})};r(i.nodes||[]),r(i.points)}this.hideOverlappingLabels(e)}return{compose:function(t){let i=t.prototype;i.hideOverlappingLabels||(i.hideOverlappingLabels=s,e(t,"render",a))}}}),i(e,"Extensions/BorderRadius.js",[e["Core/Defaults.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(t,e,i){let{defaultOptions:r}=t,{noop:o}=e,{addEvent:s,extend:n,isObject:a,merge:l,relativeLength:h}=i,c={radius:0,scope:"stack",where:void 0},d=o,u=o;function g(t,e,i,r,o={}){let s=d(t,e,i,r,o),{innerR:n=0,r:a=i,start:l=0,end:c=0}=o;if(o.open||!o.borderRadius)return s;let u=c-l,g=Math.sin(u/2),p=Math.max(Math.min(h(o.borderRadius||0,a-n),(a-n)/2,a*g/(1+g)),0),f=Math.min(p,u/Math.PI*2*n),m=s.length-1;for(;m--;)!function(t,e,i){let r,o,s;let n=t[e],a=t[e+1];if("Z"===a[0]&&(a=t[0]),("M"===n[0]||"L"===n[0])&&"A"===a[0]?(r=n,o=a,s=!0):"A"===n[0]&&("M"===a[0]||"L"===a[0])&&(r=a,o=n),r&&o&&o.params){let n=o[1],a=o[5],l=o.params,{start:h,end:c,cx:d,cy:u}=l,g=a?n-i:n+i,p=g?Math.asin(i/g):0,f=a?p:-p,m=Math.cos(p)*g;s?(l.start=h+f,r[1]=d+m*Math.cos(h),r[2]=u+m*Math.sin(h),t.splice(e+1,0,["A",i,i,0,0,1,d+n*Math.cos(l.start),u+n*Math.sin(l.start)])):(l.end=c-f,o[6]=d+n*Math.cos(l.end),o[7]=u+n*Math.sin(l.end),t.splice(e+1,0,["A",i,i,0,0,1,d+m*Math.cos(c),u+m*Math.sin(c)])),o[4]=Math.abs(l.end-l.start)<Math.PI?0:1}}(s,m,m>1?f:p);return s}function p(){if(this.options.borderRadius&&!(this.chart.is3d&&this.chart.is3d())){let{options:t,yAxis:e}=this,i="percent"===t.stacking,o=r.plotOptions?.[this.type]?.borderRadius,s=f(t.borderRadius,a(o)?o:{}),l=e.options.reversed;for(let r of this.points){let{shapeArgs:o}=r;if("roundedRect"===r.shapeType&&o){let{width:a=0,height:c=0,y:d=0}=o,u=d,g=c;if("stack"===s.scope&&r.stackTotal){let o=e.translate(i?100:r.stackTotal,!1,!0,!1,!0),s=e.translate(t.threshold||0,!1,!0,!1,!0),n=this.crispCol(0,Math.min(o,s),0,Math.abs(o-s));u=n.y,g=n.height}let p=(r.negative?-1:1)*(l?-1:1)==-1,f=s.where;!f&&this.is("waterfall")&&Math.abs((r.yBottom||0)-(this.translatedThreshold||0))>this.borderWidth&&(f="all"),f||(f="end");let m=Math.min(h(s.radius,a),a/2,"all"===f?c/2:1/0)||0;"end"===f&&(p&&(u-=m),g+=m),n(o,{brBoxHeight:g,brBoxY:u,r:m})}}}}function f(t,e){return a(t)||(t={radius:t||0}),l(c,e,t)}function m(){let t=f(this.options.borderRadius);for(let e of this.points){let i=e.shapeArgs;i&&(i.borderRadius=h(t.radius,(i.r||0)-(i.innerR||0)))}}function y(t,e,i,r,o={}){let s=u(t,e,i,r,o),{r:n=0,brBoxHeight:a=r,brBoxY:l=e}=o,h=e-l,c=l+a-(e+r),d=h-n>-.1?0:n,g=c-n>-.1?0:n,p=Math.max(d&&h,0),f=Math.max(g&&c,0),m=[t+d,e],y=[t+i-d,e],w=[t+i,e+d],b=[t+i,e+r-g],C=[t+i-g,e+r],S=[t+g,e+r],x=[t,e+r-g],E=[t,e+d],R=(t,e)=>Math.sqrt(Math.pow(t,2)-Math.pow(e,2));if(p){let t=R(d,d-p);m[0]-=t,y[0]+=t,w[1]=E[1]=e+d-p}if(r<d-p){let o=R(d,d-p-r);w[0]=b[0]=t+i-d+o,C[0]=Math.min(w[0],C[0]),S[0]=Math.max(b[0],S[0]),x[0]=E[0]=t+d-o,w[1]=E[1]=e+r}if(f){let t=R(g,g-f);C[0]+=t,S[0]-=t,b[1]=x[1]=e+r-g+f}if(r<g-f){let o=R(g,g-f-r);w[0]=b[0]=t+i-g+o,y[0]=Math.min(w[0],y[0]),m[0]=Math.max(b[0],m[0]),x[0]=E[0]=t+g-o,b[1]=x[1]=e}return s.length=0,s.push(["M",...m],["L",...y],["A",d,d,0,0,1,...w],["L",...b],["A",g,g,0,0,1,...C],["L",...S],["A",g,g,0,0,1,...x],["L",...E],["A",d,d,0,0,1,...m],["Z"]),s}return{compose:function(t,e,i){let r=t.types.pie;if(!e.symbolCustomAttribs.includes("borderRadius")){let o=i.prototype.symbols;s(t,"afterColumnTranslate",p,{order:9}),s(r,"afterTranslate",m),e.symbolCustomAttribs.push("borderRadius","brBoxHeight","brBoxY"),d=o.arc,u=o.roundedRect,o.arc=g,o.roundedRect=y}},optionsToObject:f}}),i(e,"Core/Responsive.js",[e["Core/Utilities.js"]],function(t){var e;let{diffObjects:i,extend:r,find:o,merge:s,pick:n,uniqueKey:a}=t;return function(t){function e(t,e){let i=t.condition;(i.callback||function(){return this.chartWidth<=n(i.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=n(i.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=n(i.minWidth,0)&&this.chartHeight>=n(i.minHeight,0)}).call(this)&&e.push(t._id)}function l(t,e){let r=this.options.responsive,n=this.currentResponsive,l=[],h;!e&&r&&r.rules&&r.rules.forEach(t=>{void 0===t._id&&(t._id=a()),this.matchResponsiveRule(t,l)},this);let c=s(...l.map(t=>o((r||{}).rules||[],e=>e._id===t)).map(t=>t&&t.chartOptions));c.isResponsiveOptions=!0,l=l.toString()||void 0;let d=n&&n.ruleIds;l!==d&&(n&&this.update(n.undoOptions,t,!0),l?((h=i(c,this.options,!0,this.collectionsWithUpdate)).isResponsiveOptions=!0,this.currentResponsive={ruleIds:l,mergedOptions:c,undoOptions:h},this.update(c,t,!0)):this.currentResponsive=void 0)}t.compose=function(t){let i=t.prototype;return i.matchResponsiveRule||r(i,{matchResponsiveRule:e,setResponsive:l}),t}}(e||(e={})),e}),i(e,"masters/highcharts.src.js",[e["Core/Globals.js"],e["Core/Utilities.js"],e["Core/Defaults.js"],e["Core/Animation/Fx.js"],e["Core/Animation/AnimationUtilities.js"],e["Core/Renderer/HTML/AST.js"],e["Core/Templating.js"],e["Core/Renderer/RendererRegistry.js"],e["Core/Renderer/RendererUtilities.js"],e["Core/Renderer/SVG/SVGElement.js"],e["Core/Renderer/SVG/SVGRenderer.js"],e["Core/Renderer/HTML/HTMLElement.js"],e["Core/Axis/Axis.js"],e["Core/Axis/DateTimeAxis.js"],e["Core/Axis/LogarithmicAxis.js"],e["Core/Axis/PlotLineOrBand/PlotLineOrBand.js"],e["Core/Axis/Tick.js"],e["Core/Tooltip.js"],e["Core/Series/Point.js"],e["Core/Pointer.js"],e["Core/Legend/Legend.js"],e["Core/Legend/LegendSymbol.js"],e["Core/Chart/Chart.js"],e["Extensions/ScrollablePlotArea.js"],e["Core/Axis/Stacking/StackingAxis.js"],e["Core/Axis/Stacking/StackItem.js"],e["Core/Series/Series.js"],e["Core/Series/SeriesRegistry.js"],e["Series/Column/ColumnDataLabel.js"],e["Series/Pie/PieDataLabel.js"],e["Core/Series/DataLabel.js"],e["Extensions/OverlappingDataLabels.js"],e["Extensions/BorderRadius.js"],e["Core/Responsive.js"],e["Core/Color/Color.js"],e["Core/Time.js"]],function(t,e,i,r,o,s,n,a,l,h,c,d,u,g,p,f,m,y,w,b,C,S,x,E,R,T,M,k,A,O,P,I,H,L,D,N){return t.AST=s,t.Axis=u,t.Chart=x,t.Color=D,t.DataLabel=P,t.Fx=r,t.HTMLElement=d,t.Legend=C,t.LegendSymbol=S,t.OverlappingDataLabels=t.OverlappingDataLabels||I,t.PlotLineOrBand=f,t.Point=w,t.Pointer=b,t.RendererRegistry=a,t.Series=M,t.SeriesRegistry=k,t.StackItem=T,t.SVGElement=h,t.SVGRenderer=c,t.Templating=n,t.Tick=m,t.Time=N,t.Tooltip=y,t.animate=o.animate,t.animObject=o.animObject,t.chart=x.chart,t.color=D.parse,t.dateFormat=n.dateFormat,t.defaultOptions=i.defaultOptions,t.distribute=l.distribute,t.format=n.format,t.getDeferredAnimation=o.getDeferredAnimation,t.getOptions=i.getOptions,t.numberFormat=n.numberFormat,t.seriesType=k.seriesType,t.setAnimation=o.setAnimation,t.setOptions=i.setOptions,t.stop=o.stop,t.time=i.defaultTime,t.timers=r.timers,H.compose(t.Series,t.SVGElement,t.SVGRenderer),A.compose(t.Series.types.column),P.compose(t.Series),g.compose(t.Axis),d.compose(t.SVGRenderer),C.compose(t.Chart),p.compose(t.Axis),I.compose(t.Chart),O.compose(t.Series.types.pie),f.compose(t.Axis),b.compose(t.Chart),L.compose(t.Chart),E.compose(t.Axis,t.Chart,t.Series),R.compose(t.Axis,t.Chart,t.Series),y.compose(t.Pointer),e.extend(t,e),t}),e["masters/highcharts.src.js"]._modules=e,e["masters/highcharts.src.js"]},Ew?(F.default=F,Ew=_&&_.document?F(_):F):"function"==typeof define&&define.amd?define("highcharts/highcharts",function(){return F(_)}):(_.Highcharts&&_.Highcharts.error(16,!0),_.Highcharts=F(_));var Eb={};j=function(t){var e=t?t._modules:{};function i(t,e,i,r){t.hasOwnProperty(e)||(t[e]=r.apply(null,i),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}i(e,"Core/Chart/ChartNavigationComposition.js",[],function(){var t;return function(t){t.compose=function(t){return t.navigation||(t.navigation=new e(t)),t};class e{constructor(t){this.updates=[],this.chart=t}addUpdate(t){this.chart.navigation.updates.push(t)}update(t,e){this.updates.forEach(i=>{i.call(this.chart,t,e)})}}t.Additions=e}(t||(t={})),t}),i(e,"Extensions/Exporting/ExportingDefaults.js",[e["Core/Globals.js"]],function(t){let{isTouchDevice:e}=t;return{exporting:{allowTableSorting:!0,type:"image/png",url:"https://export.highcharts.com/",pdfFont:{normal:void 0,bold:void 0,bolditalic:void 0,italic:void 0},printMaxWidth:780,scale:2,buttons:{contextButton:{className:"highcharts-contextbutton",menuClassName:"highcharts-contextmenu",symbol:"menu",titleKey:"contextButtonTitle",menuItems:["viewFullscreen","printChart","separator","downloadPNG","downloadJPEG","downloadPDF","downloadSVG"]}},menuItemDefinitions:{viewFullscreen:{textKey:"viewFullscreen",onclick:function(){this.fullscreen&&this.fullscreen.toggle()}},printChart:{textKey:"printChart",onclick:function(){this.print()}},separator:{separator:!0},downloadPNG:{textKey:"downloadPNG",onclick:function(){this.exportChart()}},downloadJPEG:{textKey:"downloadJPEG",onclick:function(){this.exportChart({type:"image/jpeg"})}},downloadPDF:{textKey:"downloadPDF",onclick:function(){this.exportChart({type:"application/pdf"})}},downloadSVG:{textKey:"downloadSVG",onclick:function(){this.exportChart({type:"image/svg+xml"})}}}},lang:{viewFullscreen:"View in full screen",exitFullscreen:"Exit from full screen",printChart:"Print chart",downloadPNG:"Download PNG image",downloadJPEG:"Download JPEG image",downloadPDF:"Download PDF document",downloadSVG:"Download SVG vector image",contextButtonTitle:"Chart context menu"},navigation:{buttonOptions:{symbolSize:14,symbolX:14.5,symbolY:13.5,align:"right",buttonSpacing:3,height:28,verticalAlign:"top",width:28,symbolFill:"#666666",symbolStroke:"#666666",symbolStrokeWidth:3,theme:{padding:5}},menuStyle:{border:"none",borderRadius:"3px",background:"#ffffff",padding:"0.5em"},menuItemStyle:{background:"none",borderRadius:"3px",color:"#333333",padding:"0.5em",fontSize:e?"0.9em":"0.8em",transition:"background 250ms, color 250ms"},menuItemHoverStyle:{background:"#f2f2f2"}}}}),i(e,"Extensions/Exporting/ExportingSymbols.js",[],function(){var t;return function(t){let e=[];function i(t,e,i,r){return[["M",t,e+2.5],["L",t+i,e+2.5],["M",t,e+r/2+.5],["L",t+i,e+r/2+.5],["M",t,e+r-1.5],["L",t+i,e+r-1.5]]}function r(t,e,i,r){let o=r/3-2;return[].concat(this.circle(i-o,e,o,o),this.circle(i-o,e+o+4,o,o),this.circle(i-o,e+2*(o+4),o,o))}t.compose=function(t){if(-1===e.indexOf(t)){e.push(t);let o=t.prototype.symbols;o.menu=i,o.menuball=r.bind(o)}}}(t||(t={})),t}),i(e,"Extensions/Exporting/Fullscreen.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(t,e,i){let{composed:r}=e,{addEvent:o,fireEvent:s,pushUnique:n}=i;function a(){this.fullscreen=new l(this)}class l{static compose(t){n(r,"Fullscreen")&&o(t,"beforeRender",a)}constructor(t){this.chart=t,this.isOpen=!1;let e=t.renderTo;!this.browserProps&&("function"==typeof e.requestFullscreen?this.browserProps={fullscreenChange:"fullscreenchange",requestFullscreen:"requestFullscreen",exitFullscreen:"exitFullscreen"}:e.mozRequestFullScreen?this.browserProps={fullscreenChange:"mozfullscreenchange",requestFullscreen:"mozRequestFullScreen",exitFullscreen:"mozCancelFullScreen"}:e.webkitRequestFullScreen?this.browserProps={fullscreenChange:"webkitfullscreenchange",requestFullscreen:"webkitRequestFullScreen",exitFullscreen:"webkitExitFullscreen"}:e.msRequestFullscreen&&(this.browserProps={fullscreenChange:"MSFullscreenChange",requestFullscreen:"msRequestFullscreen",exitFullscreen:"msExitFullscreen"}))}close(){let t=this,e=t.chart,i=e.options.chart;s(e,"fullscreenClose",null,function(){t.isOpen&&t.browserProps&&e.container.ownerDocument instanceof Document&&e.container.ownerDocument[t.browserProps.exitFullscreen](),t.unbindFullscreenEvent&&(t.unbindFullscreenEvent=t.unbindFullscreenEvent()),e.setSize(t.origWidth,t.origHeight,!1),t.origWidth=void 0,t.origHeight=void 0,i.width=t.origWidthOption,i.height=t.origHeightOption,t.origWidthOption=void 0,t.origHeightOption=void 0,t.isOpen=!1,t.setButtonText()})}open(){let t=this,e=t.chart,i=e.options.chart;s(e,"fullscreenOpen",null,function(){if(i&&(t.origWidthOption=i.width,t.origHeightOption=i.height),t.origWidth=e.chartWidth,t.origHeight=e.chartHeight,t.browserProps){let i=o(e.container.ownerDocument,t.browserProps.fullscreenChange,function(){t.isOpen?(t.isOpen=!1,t.close()):(e.setSize(null,null,!1),t.isOpen=!0,t.setButtonText())}),r=o(e,"destroy",i);t.unbindFullscreenEvent=()=>{i(),r()};let s=e.renderTo[t.browserProps.requestFullscreen]();s&&s.catch(function(){alert("Full screen is not supported inside a frame.")})}})}setButtonText(){let e=this.chart,i=e.exportDivElements,r=e.options.exporting,o=r&&r.buttons&&r.buttons.contextButton.menuItems,s=e.options.lang;if(r&&r.menuItemDefinitions&&s&&s.exitFullscreen&&s.viewFullscreen&&o&&i){let e=i[o.indexOf("viewFullscreen")];e&&t.setElementHTML(e,this.isOpen?s.exitFullscreen:r.menuItemDefinitions.viewFullscreen.text||s.viewFullscreen)}}toggle(){this.isOpen?this.close():this.open()}}return l}),i(e,"Core/HttpUtilities.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(t,e){let{win:i}=t,{discardElement:r,objectEach:o}=e,s={ajax:function(t){let e={json:"application/json",xml:"application/xml",text:"text/plain",octet:"application/octet-stream"},i=new XMLHttpRequest;function r(e,i){t.error&&t.error(e,i)}if(!t.url)return!1;i.open((t.type||"get").toUpperCase(),t.url,!0),t.headers&&t.headers["Content-Type"]||i.setRequestHeader("Content-Type",e[t.dataType||"json"]||e.text),o(t.headers,function(t,e){i.setRequestHeader(e,t)}),t.responseType&&(i.responseType=t.responseType),i.onreadystatechange=function(){let e;if(4===i.readyState){if(200===i.status){if("blob"!==t.responseType&&(e=i.responseText,"json"===t.dataType))try{e=JSON.parse(e)}catch(t){if(t instanceof Error)return r(i,t)}return t.success&&t.success(e,i)}r(i,i.responseText)}},t.data&&"string"!=typeof t.data&&(t.data=JSON.stringify(t.data)),i.send(t.data)},getJSON:function(t,e){s.ajax({url:t,success:e,dataType:"json",headers:{"Content-Type":"text/plain"}})},post:function(t,e,s){let n=new i.FormData;o(e,function(t,e){n.append(e,t)}),n.append("b64","true");let{filename:a,type:l}=e;return i.fetch(t,{method:"POST",body:n,...s}).then(t=>{t.ok&&t.text().then(t=>{let e=document.createElement("a");e.href=`data:${l};base64,${t}`,e.download=a,e.click(),r(e)})})}};return s}),i(e,"Extensions/Exporting/Exporting.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Chart/Chart.js"],e["Core/Chart/ChartNavigationComposition.js"],e["Core/Defaults.js"],e["Extensions/Exporting/ExportingDefaults.js"],e["Extensions/Exporting/ExportingSymbols.js"],e["Extensions/Exporting/Fullscreen.js"],e["Core/Globals.js"],e["Core/HttpUtilities.js"],e["Core/Utilities.js"]],function(t,e,i,r,o,s,n,a,l,h){var c;let{defaultOptions:d}=r,{doc:u,SVG_NS:g,win:p}=a,{addEvent:f,css:m,createElement:y,discardElement:w,extend:b,find:C,fireEvent:S,isObject:x,merge:E,objectEach:R,pick:T,removeEvent:M,uniqueKey:k}=h;return function(e){let r;let c=[/-/,/^(clipPath|cssText|d|height|width)$/,/^font$/,/[lL]ogical(Width|Height)$/,/^parentRule$/,/^(cssRules|ownerRules)$/,/perspective/,/TapHighlightColor/,/^transition/,/^length$/,/^[0-9]+$/],A=["fill","stroke","strokeLinecap","strokeLinejoin","strokeWidth","textAnchor","x","y"];e.inlineAllowlist=[];let O=["clipPath","defs","desc"];function P(t){let e,i;let r=this,o=r.renderer,s=E(r.options.navigation.buttonOptions,t),n=s.onclick,a=s.menuItems,l=s.symbolSize||12;if(r.btnCount||(r.btnCount=0),r.exportDivElements||(r.exportDivElements=[],r.exportSVGElements=[]),!1===s.enabled||!s.theme)return;let h=s.theme;r.styledMode||(h.fill=T(h.fill,"#ffffff"),h.stroke=T(h.stroke,"none")),n?i=function(t){t&&t.stopPropagation(),n.call(r,t)}:a&&(i=function(t){t&&t.stopPropagation(),r.contextMenu(c.menuClassName,a,c.translateX||0,c.translateY||0,c.width||0,c.height||0,c),c.setState(2)}),s.text&&s.symbol?h.paddingLeft=T(h.paddingLeft,30):s.text||b(h,{width:s.width,height:s.height,padding:0}),r.styledMode||(h["stroke-linecap"]="round",h.fill=T(h.fill,"#ffffff"),h.stroke=T(h.stroke,"none"));let c=o.button(s.text,0,0,i,h,void 0,void 0,void 0,void 0,s.useHTML).addClass(t.className).attr({title:T(r.options.lang[s._titleKey||s.titleKey],"")});c.menuClassName=t.menuClassName||"highcharts-menu-"+r.btnCount++,s.symbol&&(e=o.symbol(s.symbol,s.symbolX-l/2,s.symbolY-l/2,l,l,{width:l,height:l}).addClass("highcharts-button-symbol").attr({zIndex:1}).add(c),r.styledMode||e.attr({stroke:s.symbolStroke,fill:s.symbolFill,"stroke-width":s.symbolStrokeWidth||1})),c.add(r.exportingGroup).align(b(s,{width:c.width,x:T(s.x,r.buttonOffset)}),!0,"spacingBox"),r.buttonOffset+=((c.width||0)+s.buttonSpacing)*("right"===s.align?-1:1),r.exportSVGElements.push(c,e)}function I(){if(!this.printReverseInfo)return;let{childNodes:t,origDisplay:e,resetParams:i}=this.printReverseInfo;this.moveContainers(this.renderTo),[].forEach.call(t,function(t,i){1===t.nodeType&&(t.style.display=e[i]||"")}),this.isPrinting=!1,i&&this.setSize.apply(this,i),delete this.printReverseInfo,r=void 0,S(this,"afterPrint")}function H(){let t=u.body,e=this.options.exporting.printMaxWidth,i={childNodes:t.childNodes,origDisplay:[],resetParams:void 0};this.isPrinting=!0,this.pointer?.reset(void 0,0),S(this,"beforePrint"),e&&this.chartWidth>e&&(i.resetParams=[this.options.chart.width,void 0,!1],this.setSize(e,void 0,!1)),[].forEach.call(i.childNodes,function(t,e){1===t.nodeType&&(i.origDisplay[e]=t.style.display,t.style.display="none")}),this.moveContainers(t),this.printReverseInfo=i}function L(t){t.renderExporting(),f(t,"redraw",t.renderExporting),f(t,"destroy",t.destroyExport)}function D(e,i,r,o,s,n,a){let l=this,c=l.options.navigation,d=l.chartWidth,g=l.chartHeight,w="cache-"+e,C=Math.max(s,n),E,R=l[w];R||(l.exportContextMenu=l[w]=R=y("div",{className:e},{position:"absolute",zIndex:1e3,padding:C+"px",pointerEvents:"auto",...l.renderer.style},l.scrollablePlotArea?.fixedDiv||l.container),E=y("ul",{className:"highcharts-menu"},l.styledMode?{}:{listStyle:"none",margin:0,padding:0},R),l.styledMode||m(E,b({MozBoxShadow:"3px 3px 10px #888",WebkitBoxShadow:"3px 3px 10px #888",boxShadow:"3px 3px 10px #888"},c.menuStyle)),R.hideMenu=function(){m(R,{display:"none"}),a&&a.setState(0),l.openMenu=!1,m(l.renderTo,{overflow:"hidden"}),m(l.container,{overflow:"hidden"}),h.clearTimeout(R.hideTimer),S(l,"exportMenuHidden")},l.exportEvents.push(f(R,"mouseleave",function(){R.hideTimer=p.setTimeout(R.hideMenu,500)}),f(R,"mouseenter",function(){h.clearTimeout(R.hideTimer)}),f(u,"mouseup",function(t){l.pointer?.inClass(t.target,e)||R.hideMenu()}),f(R,"click",function(){l.openMenu&&R.hideMenu()})),i.forEach(function(e){if("string"==typeof e&&(e=l.options.exporting.menuItemDefinitions[e]),x(e,!0)){let i;e.separator?i=y("hr",void 0,void 0,E):("viewData"===e.textKey&&l.isDataTableVisible&&(e.textKey="hideData"),i=y("li",{className:"highcharts-menu-item",onclick:function(t){t&&t.stopPropagation(),R.hideMenu(),"string"!=typeof e&&e.onclick&&e.onclick.apply(l,arguments)}},void 0,E),t.setElementHTML(i,e.text||l.options.lang[e.textKey]),l.styledMode||(i.onmouseover=function(){m(this,c.menuItemHoverStyle)},i.onmouseout=function(){m(this,c.menuItemStyle)},m(i,b({cursor:"pointer"},c.menuItemStyle||{})))),l.exportDivElements.push(i)}}),l.exportDivElements.push(E,R),l.exportMenuWidth=R.offsetWidth,l.exportMenuHeight=R.offsetHeight);let T={display:"block"};r+l.exportMenuWidth>d?T.right=d-r-s-C+"px":T.left=r-C+"px",o+n+l.exportMenuHeight>g&&"top"!==a.alignOptions.verticalAlign?T.bottom=g-o-C+"px":T.top=o+n-C+"px",m(R,T),m(l.renderTo,{overflow:""}),m(l.container,{overflow:""}),l.openMenu=!0,S(l,"exportMenuShown")}function N(t){let e;let i=t?t.target:this,r=i.exportSVGElements,o=i.exportDivElements,s=i.exportEvents;r&&(r.forEach((t,o)=>{t&&(t.onclick=t.ontouchstart=null,i[e="cache-"+t.menuClassName]&&delete i[e],r[o]=t.destroy())}),r.length=0),i.exportingGroup&&(i.exportingGroup.destroy(),delete i.exportingGroup),o&&(o.forEach(function(t,e){t&&(h.clearTimeout(t.hideTimer),M(t,"mouseleave"),o[e]=t.onmouseout=t.onmouseover=t.ontouchstart=t.onclick=null,w(t))}),o.length=0),s&&(s.forEach(function(t){t()}),s.length=0)}function _(t,e){let i=this.getSVGForExport(t,e);t=E(this.options.exporting,t),l.post(t.url,{filename:t.filename?t.filename.replace(/\//g,"-"):this.getFilename(),type:t.type,width:t.width,scale:t.scale,svg:i},t.fetchOptions)}function F(){return this.styledMode&&this.inlineStyles(),this.container.innerHTML}function j(){let t=this.userOptions.title&&this.userOptions.title.text,e=this.options.exporting.filename;return e?e.replace(/\//g,"-"):("string"==typeof t&&(e=t.toLowerCase().replace(/<\/?[^>]+(>|$)/g,"").replace(/[\s_]+/g,"-").replace(/[^a-z0-9\-]/g,"").replace(/^[\-]+/g,"").replace(/[\-]+/g,"-").substr(0,24).replace(/[\-]+$/g,"")),(!e||e.length<5)&&(e="chart"),e)}function B(t){let e,i,r=E(this.options,t);r.plotOptions=E(this.userOptions.plotOptions,t&&t.plotOptions),r.time=E(this.userOptions.time,t&&t.time);let o=y("div",null,{position:"absolute",top:"-9999em",width:this.chartWidth+"px",height:this.chartHeight+"px"},u.body),s=this.renderTo.style.width,n=this.renderTo.style.height,a=r.exporting.sourceWidth||r.chart.width||/px$/.test(s)&&parseInt(s,10)||(r.isGantt?800:600),l=r.exporting.sourceHeight||r.chart.height||/px$/.test(n)&&parseInt(n,10)||400;b(r.chart,{animation:!1,renderTo:o,forExport:!0,renderer:"SVGRenderer",width:a,height:l}),r.exporting.enabled=!1,delete r.data,r.series=[],this.series.forEach(function(t){(i=E(t.userOptions,{animation:!1,enableMouseTracking:!1,showCheckbox:!1,visible:t.visible})).isInternal||r.series.push(i)});let h={};this.axes.forEach(function(t){t.userOptions.internalKey||(t.userOptions.internalKey=k()),t.options.isInternal||(h[t.coll]||(h[t.coll]=!0,r[t.coll]=[]),r[t.coll].push(E(t.userOptions,{visible:t.visible})))}),r.colorAxis=this.userOptions.colorAxis;let c=new this.constructor(r,this.callback);return t&&["xAxis","yAxis","series"].forEach(function(e){let i={};t[e]&&(i[e]=t[e],c.update(i))}),this.axes.forEach(function(t){let e=C(c.axes,function(e){return e.options.internalKey===t.userOptions.internalKey}),i=t.getExtremes(),r=i.userMin,o=i.userMax;e&&(void 0!==r&&r!==e.min||void 0!==o&&o!==e.max)&&e.setExtremes(r,o,!0,!1)}),e=c.getChartHTML(),S(this,"getSVG",{chartCopy:c}),e=this.sanitizeSVG(e,r),r=null,c.destroy(),w(o),e}function W(t,e){let i=this.options.exporting;return this.getSVG(E({chart:{borderRadius:0}},i.chartOptions,e,{exporting:{sourceWidth:t&&t.sourceWidth||i.sourceWidth,sourceHeight:t&&t.sourceHeight||i.sourceHeight}}))}function V(){let t;let i=e.inlineAllowlist,r={},o=u.createElement("iframe");m(o,{width:"1px",height:"1px",visibility:"hidden"}),u.body.appendChild(o);let s=o.contentWindow&&o.contentWindow.document;s&&s.body.appendChild(s.createElementNS(g,"svg")),function e(o){let n,l,h,d,u,g;let f={};if(s&&1===o.nodeType&&-1===O.indexOf(o.nodeName)){if(n=p.getComputedStyle(o,null),l="svg"===o.nodeName?{}:p.getComputedStyle(o.parentNode,null),!r[o.nodeName]){t=s.getElementsByTagName("svg")[0],h=s.createElementNS(o.namespaceURI,o.nodeName),t.appendChild(h);let e=p.getComputedStyle(h,null),i={};for(let t in e)"string"!=typeof e[t]||/^[0-9]+$/.test(t)||(i[t]=e[t]);r[o.nodeName]=i,"text"===o.nodeName&&delete r.text.fill,t.removeChild(h)}for(let t in n)(a.isFirefox||a.isMS||a.isSafari||Object.hasOwnProperty.call(n,t))&&function(t,e){if(d=u=!1,i.length){for(g=i.length;g--&&!u;)u=i[g].test(e);d=!u}for("transform"===e&&"none"===t&&(d=!0),g=c.length;g--&&!d;)d=c[g].test(e)||"function"==typeof t;!d&&(l[e]!==t||"svg"===o.nodeName)&&r[o.nodeName][e]!==t&&(A&&-1===A.indexOf(e)?f[e]=t:t&&o.setAttribute(e.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()}),t))}(n[t],t);if(m(o,f),"svg"===o.nodeName&&o.setAttribute("stroke-width","1px"),"text"===o.nodeName)return;[].forEach.call(o.children||o.childNodes,e)}}(this.container.querySelector("svg")),t.parentNode.removeChild(t),o.parentNode.removeChild(o)}function U(t){let{scrollablePlotArea:e}=this;(e?[e.fixedDiv,e.scrollingContainer]:[this.container]).forEach(function(e){t.appendChild(e)})}function z(){let t=this,e=(e,i,r)=>{t.isDirtyExporting=!0,E(!0,t.options[e],i),T(r,!0)&&t.redraw()};t.exporting={update:function(t,i){e("exporting",t,i)}},i.compose(t).navigation.addUpdate((t,i)=>{e("navigation",t,i)})}function Y(){let t=this;t.isPrinting||(r=t,a.isSafari||t.beforePrint(),setTimeout(()=>{p.focus(),p.print(),a.isSafari||setTimeout(()=>{t.afterPrint()},1e3)},1))}function G(){let t=this,e=t.options.exporting,i=e.buttons,r=t.isDirtyExporting||!t.exportSVGElements;t.buttonOffset=0,t.isDirtyExporting&&t.destroyExport(),r&&!1!==e.enabled&&(t.exportEvents=[],t.exportingGroup=t.exportingGroup||t.renderer.g("exporting-group").attr({zIndex:3}).add(),R(i,function(e){t.addButton(e)}),t.isDirtyExporting=!1)}function $(t,e){let i=t.indexOf("</svg>")+6,r=t.substr(i);return t=t.substr(0,i),e&&e.exporting&&e.exporting.allowHTML&&r&&(r='<foreignObject x="0" y="0" width="'+e.chart.width+'" height="'+e.chart.height+'"><body xmlns="http://www.w3.org/1999/xhtml">'+r.replace(/(<(?:img|br).*?(?=\>))>/g,"$1 />")+"</body></foreignObject>",t=t.replace("</svg>",r+"</svg>")),t=t.replace(/zIndex="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery[0-9]+="[^"]+"/g,"").replace(/url\(("|&quot;)(.*?)("|&quot;)\;?\)/g,"url($2)").replace(/url\([^#]+#/g,"url(#").replace(/<svg /,'<svg xmlns:xlink="http://www.w3.org/1999/xlink" ').replace(/ (|NS[0-9]+\:)href=/g," xlink:href=").replace(/\n+/g," ").replace(/(fill|stroke)="rgba\(([ 0-9]+,[ 0-9]+,[ 0-9]+),([ 0-9\.]+)\)"/g,'$1="rgb($2)" $1-opacity="$3"').replace(/&nbsp;/g,"").replace(/&shy;/g,"")}e.compose=function(t,e){s.compose(e),n.compose(t);let i=t.prototype;i.exportChart||(i.afterPrint=I,i.exportChart=_,i.inlineStyles=V,i.print=Y,i.sanitizeSVG=$,i.getChartHTML=F,i.getSVG=B,i.getSVGForExport=W,i.getFilename=j,i.moveContainers=U,i.beforePrint=H,i.contextMenu=D,i.addButton=P,i.destroyExport=N,i.renderExporting=G,i.callbacks.push(L),f(t,"init",z),a.isSafari&&p.matchMedia("print").addListener(function(t){r&&(t.matches?r.beforePrint():r.afterPrint())}),d.exporting=E(o.exporting,d.exporting),d.lang=E(o.lang,d.lang),d.navigation=E(o.navigation,d.navigation))}}(c||(c={})),c}),i(e,"masters/modules/exporting.src.js",[e["Core/Globals.js"],e["Extensions/Exporting/Exporting.js"],e["Core/HttpUtilities.js"]],function(t,e,i){return t.HttpUtilities=t.HttpUtilities||i,t.ajax=t.HttpUtilities.ajax,t.getJSON=t.HttpUtilities.getJSON,t.post=t.HttpUtilities.post,e.compose(t.Chart,t.Renderer),t})},Eb?(j.default=j,Eb=j):"function"==typeof define&&define.amd?define("highcharts/modules/exporting",["highcharts"],function(t){return j(t),j.Highcharts=t,j}):j("undefined"!=typeof Highcharts?Highcharts:void 0);var EC={};B=function(t){var e=t?t._modules:{};function i(t,e,i,r){t.hasOwnProperty(e)||(t[e]=r.apply(null,i),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}i(e,"Extensions/DownloadURL.js",[e["Core/Globals.js"]],function(t){let{isSafari:e,win:i,win:{document:r}}=t,o=i.URL||i.webkitURL||i;function s(t){let e=t.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);if(e&&e.length>3&&i.atob&&i.ArrayBuffer&&i.Uint8Array&&i.Blob&&o.createObjectURL){let t=i.atob(e[3]),r=new i.ArrayBuffer(t.length),s=new i.Uint8Array(r);for(let e=0;e<s.length;++e)s[e]=t.charCodeAt(e);return o.createObjectURL(new i.Blob([s],{type:e[1]}))}}return{dataURLtoBlob:s,downloadURL:function(t,o){let n=i.navigator,a=r.createElement("a");if("string"!=typeof t&&!(t instanceof String)&&n.msSaveOrOpenBlob){n.msSaveOrOpenBlob(t,o);return}t=""+t;let l=/Edge\/\d+/.test(n.userAgent);if((e&&"string"==typeof t&&0===t.indexOf("data:application/pdf")||l||t.length>2e6)&&!(t=s(t)||""))throw Error("Failed to convert to blob");if(void 0!==a.download)a.href=t,a.download=o,r.body.appendChild(a),a.click(),r.body.removeChild(a);else try{if(!i.open(t,"chart"))throw Error("Failed to open window")}catch{i.location.href=t}}}}),i(e,"Extensions/OfflineExporting/OfflineExportingDefaults.js",[],function(){return{libURL:"https://code.highcharts.com/11.4.1/lib/",menuItemDefinitions:{downloadPNG:{textKey:"downloadPNG",onclick:function(){this.exportChartLocal()}},downloadJPEG:{textKey:"downloadJPEG",onclick:function(){this.exportChartLocal({type:"image/jpeg"})}},downloadSVG:{textKey:"downloadSVG",onclick:function(){this.exportChartLocal({type:"image/svg+xml"})}},downloadPDF:{textKey:"downloadPDF",onclick:function(){this.exportChartLocal({type:"application/pdf"})}}}}}),i(e,"Extensions/OfflineExporting/OfflineExporting.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Chart/Chart.js"],e["Core/Defaults.js"],e["Extensions/DownloadURL.js"],e["Extensions/Exporting/Exporting.js"],e["Core/Globals.js"],e["Core/HttpUtilities.js"],e["Extensions/OfflineExporting/OfflineExportingDefaults.js"],e["Core/Utilities.js"]],function(t,e,i,r,o,s,n,a,l){var h;let{defaultOptions:c}=i,{downloadURL:d}=r,{doc:u,win:g}=s,{ajax:p}=n,{addEvent:f,error:m,extend:y,fireEvent:w,merge:b}=l;return t.allowedAttributes.push("data-z-index","fill-opacity","filter","rx","ry","stroke-dasharray","stroke-linejoin","stroke-opacity","text-anchor","transform","version","viewBox","visibility","xmlns","xmlns:xlink"),t.allowedTags.push("desc","clippath","g"),function(e){function i(t,i){let r=this,n=b(r.options.exporting,t),a=function(t){!1===n.fallbackToExportServer?n.error?n.error(n,t):m(28,!0):r.exportChart(n)};if(s.isMS&&r.styledMode&&!o.inlineAllowlist.length&&o.inlineAllowlist.push(/^blockSize/,/^border/,/^caretColor/,/^color/,/^columnRule/,/^columnRuleColor/,/^cssFloat/,/^cursor/,/^fill$/,/^fillOpacity/,/^font/,/^inlineSize/,/^length/,/^lineHeight/,/^opacity/,/^outline/,/^parentRule/,/^rx$/,/^ry$/,/^stroke/,/^textAlign/,/^textAnchor/,/^textDecoration/,/^transform/,/^vectorEffect/,/^visibility/,/^x$/,/^y$/),s.isMS&&("application/pdf"===n.type||r.container.getElementsByTagName("image").length&&"image/svg+xml"!==n.type)||"application/pdf"===n.type&&[].some.call(r.container.getElementsByTagName("image"),function(t){let e=t.getAttribute("href");return""!==e&&"string"==typeof e&&0!==e.indexOf("data:")})){a(Error("Image type not supported for this chart/browser."));return}r.getSVGForLocalExport(n,i||{},a,function(t){t.indexOf("<foreignObject")>-1&&"image/svg+xml"!==n.type&&(s.isMS||"application/pdf"===n.type)?a(Error("Image type not supported for charts with embedded HTML")):e.downloadSVGLocal(t,y({filename:r.getFilename()},n),a,()=>w(r,"exportChartLocalSuccess"))})}function r(t,e){let i=u.getElementsByTagName("head")[0],r=u.createElement("script");r.type="text/javascript",r.src=t,r.onload=e,r.onerror=function(){m("Error loading script "+t)},i.appendChild(r)}function n(t,i,r,o){let s=this,n=t=>s.sanitizeSVG(t,d),a=()=>{g&&m===p&&o(n(c.innerHTML))},l=(t,e,i)=>{++m,i.imageElement.setAttributeNS("http://www.w3.org/1999/xlink","href",t),a()},h,c,d,u=null,g,p=0,m=0;s.unbindGetSVG=f(s,"getSVG",t=>{d=t.chartCopy.options,p=(g=(c=t.chartCopy.container.cloneNode(!0))&&c.getElementsByTagName("image")||[]).length}),s.getSVGForExport(t,i);try{if(!g||!g.length){o(n(c.innerHTML));return}for(let i=0;i<g.length;i++)(u=(h=g[i]).getAttributeNS("http://www.w3.org/1999/xlink","href"))?e.imageToDataUrl(u,"image/png",{imageElement:h},t.scale,l,r,r,r):(m++,h.parentNode.removeChild(h),i--,a())}catch(t){r(t)}s.unbindGetSVG()}function l(t,i,r,o,s,n,a,l,h){let c=new g.Image,d,p=()=>{setTimeout(function(){let e;let n=u.createElement("canvas"),l=n.getContext&&n.getContext("2d");try{if(l){n.height=c.height*o,n.width=c.width*o,l.drawImage(c,0,0,n.width,n.height);try{e=n.toDataURL(i),s(e,i,r,o)}catch(e){d(t,i,r,o)}}else a(t,i,r,o)}finally{h&&h(t,i,r,o)}},e.loadEventDeferDelay)},f=()=>{l(t,i,r,o),h&&h(t,i,r,o)};d=()=>{c=new g.Image,d=n,c.crossOrigin="Anonymous",c.onload=p,c.onerror=f,c.src=t},c.onload=p,c.onerror=f,c.src=t}function h(t){let i=g.navigator.userAgent,r=i.indexOf("WebKit")>-1&&0>i.indexOf("Chrome");try{if(!r&&-1===t.indexOf("<foreignObject"))return e.domurl.createObjectURL(new g.Blob([t],{type:"image/svg+xml;charset-utf-16"}))}catch(t){}return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(t)}function C(t,e,i,r){let o=(Number(t.getAttribute("width"))+2*e)*i,s=(Number(t.getAttribute("height"))+2*e)*i,n=new g.jspdf.jsPDF(s>o?"p":"l","pt",[o,s]);[].forEach.call(t.querySelectorAll('*[visibility="hidden"]'),function(t){t.parentNode.removeChild(t)});let a=t.querySelectorAll("linearGradient");for(let t=0;t<a.length;t++){let e=a[t].querySelectorAll("stop"),i=0;for(;i<e.length&&"0"===e[i].getAttribute("offset")&&"0"===e[i+1].getAttribute("offset");)e[i].remove(),i++}[].forEach.call(t.querySelectorAll("tspan"),t=>{""===t.textContent&&(t.textContent=" ",t.setAttribute("dx",-5))}),n.svg(t,{x:0,y:0,width:o,height:s,removeInvalid:!0}).then(()=>r(n.output("datauristring")))}e.CanVGRenderer={},e.domurl=g.URL||g.webkitURL||g,e.loadEventDeferDelay=s.isMS?150:0,e.compose=function(t){let e=t.prototype;return e.exportChartLocal||(e.getSVGForLocalExport=n,e.exportChartLocal=i,b(!0,c.exporting,a)),t},e.downloadSVGLocal=function(i,o,s,n){let a=u.createElement("div"),f=o.type||"image/png",m=(o.filename||"chart")+"."+("image/svg+xml"===f?"svg":f.split("/")[1]),y=o.scale||1,w,b,S,x=o.libURL||c.exporting.libURL,E=!0,R=o.pdfFont;x="/"!==x.slice(-1)?x+"/":x;let T=(t,e)=>{let i,r;let o=(t,e)=>{g.jspdf.jsPDF.API.events.push(["initialized",function(){this.addFileToVFS(t,e),this.addFont(t,"HighchartsFont",t),this.getFontList().HighchartsFont||this.setFont("HighchartsFont")}])};R&&(r=t.textContent||"",!/[^\u0000-\u007F\u200B]+/.test(r))&&(R=void 0);let s=["normal","italic","bold","bolditalic"],n=()=>{let t=s.shift();if(!t)return e();let r=R&&R[t];r?p({url:r,responseType:"blob",success:(e,r)=>{let s=new FileReader;s.onloadend=function(){if("string"==typeof this.result){let e=this.result.split(",")[1];o(t,e),"normal"===t&&(i=e)}n()},s.readAsDataURL(r.response)},error:n}):(i&&o(t,i),n())};n()},M=()=>{let e,r;t.setElementHTML(a,i);let o=a.getElementsByTagName("text"),l=function(t,e){let i=t;for(;i&&i!==a;){if(i.style[e]){let r=i.style[e];"fontSize"===e&&/em$/.test(r)&&(r=Math.round(16*parseFloat(r))+"px"),t.style[e]=r;break}i=i.parentNode}};[].forEach.call(o,function(t){for(["fontFamily","fontSize"].forEach(e=>{l(t,e)}),t.style.fontFamily=R&&R.normal?"HighchartsFont":String(t.style.fontFamily&&t.style.fontFamily.split(" ").splice(-1)),e=t.getElementsByTagName("title"),[].forEach.call(e,function(e){t.removeChild(e)}),r=t.getElementsByClassName("highcharts-text-outline");r.length>0;)t.removeChild(r[0])});let h=a.querySelector("svg");h&&T(h,()=>{C(h,0,y,t=>{try{d(t,m),n&&n()}catch(t){s(t)}})})};if("image/svg+xml"===f)try{void 0!==g.MSBlobBuilder?((b=new g.MSBlobBuilder).append(i),w=b.getBlob("image/svg+xml")):w=h(i),d(w,m),n&&n()}catch(t){s(t)}else"application/pdf"===f?g.jspdf&&g.jspdf.jsPDF?M():(E=!0,r(x+"jspdf.js",function(){r(x+"svg2pdf.js",M)})):(w=h(i),S=function(){try{e.domurl.revokeObjectURL(w)}catch(t){}},l(w,f,{},y,function(t){try{d(t,m),n&&n()}catch(t){s(t)}},function(){let t=u.createElement("canvas"),e=t.getContext("2d"),o=i.match(/^<svg[^>]*width\s*=\s*\"?(\d+)\"?[^>]*>/)[1]*y,a=i.match(/^<svg[^>]*height\s*=\s*\"?(\d+)\"?[^>]*>/)[1]*y,l=function(){g.canvg.Canvg.fromString(e,i).start();try{d(g.navigator.msSaveOrOpenBlob?t.msToBlob():t.toDataURL(f),m),n&&n()}catch(t){s(t)}finally{S()}};t.width=o,t.height=a,g.canvg?l():(E=!0,r(x+"canvg.js",function(){l()}))},s,s,function(){E&&S()}))},e.getScript=r,e.imageToDataUrl=l,e.svgToDataUrl=h,e.svgToPdf=C}(h||(h={})),h}),i(e,"masters/modules/offline-exporting.src.js",[e["Core/Globals.js"],e["Extensions/DownloadURL.js"],e["Extensions/OfflineExporting/OfflineExporting.js"]],function(t,e,i){return t.dataURLtoBlob=t.dataURLtoBlob||e.dataURLtoBlob,t.downloadSVGLocal=i.downloadSVGLocal,t.downloadURL=t.downloadURL||e.downloadURL,i.compose(t.Chart),t})},EC?(B.default=B,EC=B):"function"==typeof define&&define.amd?define("highcharts/modules/offline-exporting",["highcharts","highcharts/modules/exporting"],function(t){return B(t),B.Highcharts=t,B}):B("undefined"!=typeof Highcharts?Highcharts:void 0);var ES={};W=function(t){var e=t?t._modules:{};function i(t,e,i,r){t.hasOwnProperty(e)||(t[e]=r.apply(null,i),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}i(e,"Extensions/Annotations/AnnotationChart.js",[e["Core/Utilities.js"]],function(t){var e;let{addEvent:i,erase:r,find:o,fireEvent:s,pick:n,wrap:a}=t;function l(t,e){let i=this.initAnnotation(t);return this.options.annotations.push(i.options),n(e,!0)&&(i.redraw(),i.graphic.attr({opacity:1})),i}function h(){let t=this;t.plotBoxClip=this.renderer.clipRect(this.plotBox),t.controlPointsGroup=t.renderer.g("control-points").attr({zIndex:99}).clip(t.plotBoxClip).add(),t.options.annotations.forEach((e,i)=>{if(!t.annotations.some(t=>t.options===e)){let r=t.initAnnotation(e);t.options.annotations[i]=r.options}}),t.drawAnnotations(),i(t,"redraw",t.drawAnnotations),i(t,"destroy",function(){t.plotBoxClip.destroy(),t.controlPointsGroup.destroy()}),i(t,"exportData",function(e){let i=t.annotations,r=(this.options.exporting&&this.options.exporting.csv||{}).columnHeaderFormatter,o=!e.dataRows[1].xValues,s=t.options.lang&&t.options.lang.exportData&&t.options.lang.exportData.annotationHeader,n=e.dataRows[0].length,a=t.options.exporting&&t.options.exporting.csv&&t.options.exporting.csv.annotations&&t.options.exporting.csv.annotations.itemDelimiter,l=t.options.exporting&&t.options.exporting.csv&&t.options.exporting.csv.annotations&&t.options.exporting.csv.annotations.join;i.forEach(t=>{t.options.labelOptions&&t.options.labelOptions.includeInDataExport&&t.labels.forEach(t=>{if(t.options.text){let i=t.options.text;t.points.forEach(t=>{let r=t.x,o=t.series.xAxis?t.series.xAxis.index:-1,s=!1;if(-1===o){let t=e.dataRows[0].length,n=Array(t);for(let e=0;e<t;++e)n[e]="";n.push(i),n.xValues=[],n.xValues[o]=r,e.dataRows.push(n),s=!0}if(s||e.dataRows.forEach(t=>{!s&&t.xValues&&void 0!==o&&r===t.xValues[o]&&(l&&t.length>n?t[t.length-1]+=a+i:t.push(i),s=!0)}),!s){let t=e.dataRows[0].length,s=Array(t);for(let e=0;e<t;++e)s[e]="";s[0]=r,s.push(i),s.xValues=[],void 0!==o&&(s.xValues[o]=r),e.dataRows.push(s)}})}})});let h=0;e.dataRows.forEach(t=>{h=Math.max(h,t.length)});let c=h-e.dataRows[0].length;for(let t=0;t<c;t++){let i=function(t){let e;return r&&!1!==(e=r(t))?e:(e=s+" "+t,o)?{columnTitle:e,topLevelColumnTitle:e}:e}(t+1);o?(e.dataRows[0].push(i.topLevelColumnTitle),e.dataRows[1].push(i.columnTitle)):e.dataRows[0].push(i)}})}function c(){this.plotBoxClip.attr(this.plotBox),this.annotations.forEach(t=>{t.redraw(),t.graphic.animate({opacity:1},t.animationConfig)})}function d(t){let e=this.annotations,i="annotations"===t.coll?t:o(e,function(e){return e.options.id===t});i&&(s(i,"remove"),r(this.options.annotations,i.options),r(e,i),i.destroy())}function u(){this.annotations=[],this.options.annotations||(this.options.annotations=[])}function g(t){this.chart.hasDraggedAnnotation||t.apply(this,Array.prototype.slice.call(arguments,1))}return(e||(e={})).compose=function(t,e,r){let o=e.prototype;if(!o.addAnnotation){let s=r.prototype;i(e,"afterInit",u),o.addAnnotation=l,o.callbacks.push(h),o.collectionsWithInit.annotations=[l],o.collectionsWithUpdate.push("annotations"),o.drawAnnotations=c,o.removeAnnotation=d,o.initAnnotation=function(e){let i=new(t.types[e.type]||t)(this,e);return this.annotations.push(i),i},a(s,"onContainerMouseDown",g)}},e}),i(e,"Extensions/Annotations/AnnotationDefaults.js",[e["Core/Utilities.js"]],function(t){let{defined:e}=t;return{visible:!0,animation:{},crop:!0,draggable:"xy",labelOptions:{align:"center",allowOverlap:!1,backgroundColor:"rgba(0, 0, 0, 0.75)",borderColor:"#000000",borderRadius:3,borderWidth:1,className:"highcharts-no-tooltip",crop:!1,formatter:function(){return e(this.y)?""+this.y:"Annotation label"},includeInDataExport:!0,overflow:"justify",padding:5,shadow:!1,shape:"callout",style:{fontSize:"0.7em",fontWeight:"normal",color:"contrast"},useHTML:!1,verticalAlign:"bottom",x:0,y:-16},shapeOptions:{stroke:"rgba(0, 0, 0, 0.75)",strokeWidth:1,fill:"rgba(0, 0, 0, 0.75)",r:0,snap:2},controlPointOptions:{events:{},style:{cursor:"pointer",fill:"#ffffff",stroke:"#000000","stroke-width":2},height:10,symbol:"circle",visible:!1,width:10},events:{},zIndex:6}}),i(e,"Extensions/Annotations/EventEmitter.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(t,e){let{doc:i,isTouchDevice:r}=t,{addEvent:o,fireEvent:s,objectEach:n,pick:a,removeEvent:l}=e;return class{addEvents(){let t=this,e=function(e){o(e,r?"touchstart":"mousedown",e=>{t.onMouseDown(e)},{passive:!1})};if(e(this.graphic.element),(t.labels||[]).forEach(t=>{t.options.useHTML&&t.graphic.text&&e(t.graphic.text.element)}),n(t.options.events,(e,i)=>{let r=function(r){"click"===i&&t.cancelClick||e.call(t,t.chart.pointer?.normalize(r),t.target)};-1===(t.nonDOMEvents||[]).indexOf(i)?(o(t.graphic.element,i,r,{passive:!1}),t.graphic.div&&o(t.graphic.div,i,r,{passive:!1})):o(t,i,r,{passive:!1})}),t.options.draggable&&(o(t,"drag",t.onDrag),!t.graphic.renderer.styledMode)){let e={cursor:{x:"ew-resize",y:"ns-resize",xy:"move"}[t.options.draggable]};t.graphic.css(e),(t.labels||[]).forEach(t=>{t.options.useHTML&&t.graphic.text&&t.graphic.text.css(e)})}t.isUpdating||s(t,"add")}destroy(){this.removeDocEvents(),l(this),this.hcEvents=null}mouseMoveToRadians(t,e,i){let r=t.prevChartY-i,o=t.prevChartX-e,s=t.chartY-i,n=t.chartX-e,a;return this.chart.inverted&&(a=o,o=r,r=a,a=n,n=s,s=a),Math.atan2(s,n)-Math.atan2(r,o)}mouseMoveToScale(t,e,i){let r=t.prevChartX-e,o=t.prevChartY-i,s=t.chartX-e,n=t.chartY-i,a=(s||1)/(r||1),l=(n||1)/(o||1);if(this.chart.inverted){let t=l;l=a,a=t}return{x:a,y:l}}mouseMoveToTranslation(t){let e=t.chartX-t.prevChartX,i=t.chartY-t.prevChartY,r;return this.chart.inverted&&(r=i,i=e,e=r),{x:e,y:i}}onDrag(t){if(this.chart.isInsidePlot(t.chartX-this.chart.plotLeft,t.chartY-this.chart.plotTop,{visiblePlotOnly:!0})){let e=this.mouseMoveToTranslation(t);"x"===this.options.draggable&&(e.y=0),"y"===this.options.draggable&&(e.x=0),this.points.length?this.translate(e.x,e.y):(this.shapes.forEach(t=>t.translate(e.x,e.y)),this.labels.forEach(t=>t.translate(e.x,e.y))),this.redraw(!1)}}onMouseDown(t){if(t.preventDefault&&t.preventDefault(),2===t.button)return;let e=this,n=e.chart.pointer,l=t?.sourceCapabilities?.firesTouchEvents||!1,h=(t=n?.normalize(t)||t).chartX,c=t.chartY;e.cancelClick=!1,e.chart.hasDraggedAnnotation=!0,e.removeDrag=o(i,r||l?"touchmove":"mousemove",function(t){e.hasDragged=!0,(t=n?.normalize(t)||t).prevChartX=h,t.prevChartY=c,s(e,"drag",t),h=t.chartX,c=t.chartY},r||l?{passive:!1}:void 0),e.removeMouseUp=o(i,r||l?"touchend":"mouseup",function(){let t=a(e.target&&e.target.annotation,e.target);t&&(t.cancelClick=e.hasDragged),e.cancelClick=e.hasDragged,e.hasDragged=!1,e.chart.hasDraggedAnnotation=!1,s(a(t,e),"afterUpdate"),e.onMouseUp()},r||l?{passive:!1}:void 0)}onMouseUp(){let t=this.chart,e=this.target||this,i=t.options.annotations,r=t.annotations.indexOf(e);this.removeDocEvents(),i[r]=e.options}removeDocEvents(){this.removeDrag&&(this.removeDrag=this.removeDrag()),this.removeMouseUp&&(this.removeMouseUp=this.removeMouseUp())}}}),i(e,"Extensions/Annotations/ControlPoint.js",[e["Extensions/Annotations/EventEmitter.js"],e["Core/Utilities.js"]],function(t,e){let{merge:i,pick:r}=e;return class extends t{constructor(t,e,i,o){super(),this.nonDOMEvents=["drag"],this.chart=t,this.target=e,this.options=i,this.index=r(i.index,o)}destroy(){super.destroy(),this.graphic&&(this.graphic=this.graphic.destroy()),this.chart=null,this.target=null,this.options=null}redraw(t){this.graphic[t?"animate":"attr"](this.options.positioner.call(this,this.target))}render(){let t=this.chart,e=this.options;this.graphic=t.renderer.symbol(e.symbol,0,0,e.width,e.height).add(t.controlPointsGroup).css(e.style),this.setVisibility(e.visible),this.addEvents()}setVisibility(t){this.graphic[t?"show":"hide"](),this.options.visible=t}update(t){let e=this.chart,r=this.target,o=this.index,s=i(!0,this.options,t);this.destroy(),this.constructor(e,r,s,o),this.render(e.controlPointsGroup),this.redraw()}}}),i(e,"Extensions/Annotations/MockPoint.js",[e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(t,e){let{series:{prototype:i}}=t,{defined:r,fireEvent:o}=e;class s{static fromPoint(t){return new s(t.series.chart,null,{x:t.x,y:t.y,xAxis:t.series.xAxis,yAxis:t.series.yAxis})}static pointToPixels(t,e){let i=t.series,r=i.chart,o=t.plotX||0,s=t.plotY||0,n;return r.inverted&&(t.mock?(o=t.plotY,s=t.plotX):(o=r.plotWidth-(t.plotY||0),s=r.plotHeight-(t.plotX||0))),i&&!e&&(o+=(n=i.getPlotBox()).translateX,s+=n.translateY),{x:o,y:s}}static pointToOptions(t){return{x:t.x,y:t.y,xAxis:t.series.xAxis,yAxis:t.series.yAxis}}constructor(t,e,r){this.mock=!0,this.series={visible:!0,chart:t,getPlotBox:i.getPlotBox},this.target=e||null,this.options=r,this.applyOptions(this.getOptions())}applyOptions(t){this.command=t.command,this.setAxis(t,"x"),this.setAxis(t,"y"),this.refresh()}getLabelConfig(){return{x:this.x,y:this.y,point:this}}getOptions(){return this.hasDynamicOptions()?this.options(this.target):this.options}hasDynamicOptions(){return"function"==typeof this.options}isInsidePlot(){let t=this.plotX,e=this.plotY,i=this.series.xAxis,s=this.series.yAxis,n={x:t,y:e,isInsidePlot:!0,options:{}};return i&&(n.isInsidePlot=r(t)&&t>=0&&t<=i.len),s&&(n.isInsidePlot=n.isInsidePlot&&r(e)&&e>=0&&e<=s.len),o(this.series.chart,"afterIsInsidePlot",n),n.isInsidePlot}refresh(){let t=this.series,e=t.xAxis,i=t.yAxis,r=this.getOptions();e?(this.x=r.x,this.plotX=e.toPixels(r.x,!0)):(this.x=void 0,this.plotX=r.x),i?(this.y=r.y,this.plotY=i.toPixels(r.y,!0)):(this.y=null,this.plotY=r.y),this.isInside=this.isInsidePlot()}refreshOptions(){let t=this.series,e=t.xAxis,i=t.yAxis;this.x=this.options.x=e?this.options.x=e.toValue(this.plotX,!0):this.plotX,this.y=this.options.y=i?i.toValue(this.plotY,!0):this.plotY}rotate(t,e,i){if(!this.hasDynamicOptions()){let r=Math.cos(i),o=Math.sin(i),s=this.plotX-t,n=this.plotY-e;this.plotX=s*r-n*o+t,this.plotY=s*o+n*r+e,this.refreshOptions()}}scale(t,e,i,r){if(!this.hasDynamicOptions()){let o=this.plotX*i,s=this.plotY*r;this.plotX=(1-i)*t+o,this.plotY=(1-r)*e+s,this.refreshOptions()}}setAxis(t,e){let i=e+"Axis",o=t[i],s=this.series.chart;this.series[i]="object"==typeof o?o:r(o)?s[i][o]||s.get(o):null}toAnchor(){let t=[this.plotX,this.plotY,0,0];return this.series.chart.inverted&&(t[0]=this.plotY,t[1]=this.plotX),t}translate(t,e,i,r){this.hasDynamicOptions()||(this.plotX+=i,this.plotY+=r,this.refreshOptions())}}return s}),i(e,"Extensions/Annotations/ControlTarget.js",[e["Extensions/Annotations/ControlPoint.js"],e["Extensions/Annotations/MockPoint.js"],e["Core/Utilities.js"]],function(t,e,i){var r;return function(r){function o(){let e=this.controlPoints,r=this.options.controlPoints||[];r.forEach((o,s)=>{let n=i.merge(this.options.controlPointOptions,o);n.index||(n.index=s),r[s]=n,e.push(new t(this.chart,this,n))})}function s(t){let e=t.series.getPlotBox(),r=t.series.chart,o=t.mock?t.toAnchor():r.tooltip&&r.tooltip.getAnchor.call({chart:t.series.chart},t)||[0,0,0,0],s={x:o[0]+(this.options.x||0),y:o[1]+(this.options.y||0),height:o[2]||0,width:o[3]||0};return{relativePosition:s,absolutePosition:i.merge(s,{x:s.x+(t.mock?e.translateX:r.plotLeft),y:s.y+(t.mock?e.translateY:r.plotTop)})}}function n(){this.controlPoints.forEach(t=>t.destroy()),this.chart=null,this.controlPoints=null,this.points=null,this.options=null,this.annotation&&(this.annotation=null)}function a(){let t=this.options;return t.points||t.point&&i.splat(t.point)}function l(){let t,e;let i=this.getPointsOptions(),r=this.points,o=i&&i.length||0;for(t=0;t<o;t++){if(!(e=this.point(i[t],r[t]))){r.length=0;return}e.mock&&e.refresh(),r[t]=e}return r}function h(t,r){if(t&&t.series)return t;if(!r||null===r.series){if(i.isObject(t))r=new e(this.chart,this,t);else if(i.isString(t))r=this.chart.get(t)||null;else if("function"==typeof t){let i=t.call(r,this);r=i.series?i:new e(this.chart,this,t)}}return r}function c(t){this.controlPoints.forEach(e=>e.redraw(t))}function d(){this.controlPoints.forEach(t=>t.render())}function u(t,e,i,r,o){if(this.chart.inverted){let t=e;e=i,i=t}this.points.forEach((s,n)=>this.transformPoint(t,e,i,r,o,n),this)}function g(t,i,r,o,s,n){let a=this.points[n];a.mock||(a=this.points[n]=e.fromPoint(a)),a[t](i,r,o,s)}function p(t,e){this.transform("translate",null,null,t,e)}function f(t,e,i){this.transformPoint("translate",null,null,t,e,i)}r.compose=function(t){let e=t.prototype;e.addControlPoints||i.merge(!0,e,{addControlPoints:o,anchor:s,destroyControlTarget:n,getPointsOptions:a,linkPoints:l,point:h,redrawControlPoints:c,renderControlPoints:d,transform:u,transformPoint:g,translate:p,translatePoint:f})}}(r||(r={})),r}),i(e,"Extensions/Annotations/Controllables/Controllable.js",[e["Extensions/Annotations/ControlTarget.js"],e["Core/Utilities.js"]],function(t,e){let{merge:i}=e;class r{constructor(t,e,i,r){this.annotation=t,this.chart=t.chart,this.collection="label"===r?"labels":"shapes",this.controlPoints=[],this.options=e,this.points=[],this.index=i,this.itemType=r,this.init(t,e,i)}attr(...t){this.graphic.attr.apply(this.graphic,arguments)}attrsFromOptions(t){let e,i;let r=this.constructor.attrsMap,o={},s=this.chart.styledMode;for(e in t)i=r[e],void 0===r[e]||s&&-1!==["fill","stroke","stroke-width"].indexOf(i)||(o[i]=t[e]);return o}destroy(){this.graphic&&(this.graphic=this.graphic.destroy()),this.tracker&&(this.tracker=this.tracker.destroy()),this.destroyControlTarget()}init(t,e,i){this.annotation=t,this.chart=t.chart,this.options=e,this.points=[],this.controlPoints=[],this.index=i,this.linkPoints(),this.addControlPoints()}redraw(t){this.redrawControlPoints(t)}render(t){this.renderControlPoints()}rotate(t,e,i){this.transform("rotate",t,e,i)}scale(t,e,i,r){this.transform("scale",t,e,i,r)}setControlPointsVisibility(t){this.controlPoints.forEach(e=>{e.setVisibility(t)})}shouldBeDrawn(){return!!this.points.length}translateShape(t,e,i){let r=this.annotation.chart,o=this.annotation.userOptions,s=r.annotations.indexOf(this.annotation),n=r.options.annotations[s];this.translatePoint(t,e,0),i&&this.translatePoint(t,e,1),n[this.collection][this.index].point=this.options.point,o[this.collection][this.index].point=this.options.point}update(t){let e=this.annotation,r=i(!0,this.options,t),o=this.graphic.parentGroup,s=this.constructor;this.destroy(),i(!0,this,new s(e,r,this.index,this.itemType)),this.render(o),this.redraw()}}return t.compose(r),r}),i(e,"Extensions/Annotations/Controllables/ControllableDefaults.js",[],function(){return{defaultMarkers:{arrow:{tagName:"marker",attributes:{id:"arrow",refY:5,refX:9,markerWidth:10,markerHeight:10},children:[{tagName:"path",attributes:{d:"M 0 0 L 10 5 L 0 10 Z","stroke-width":0}}]},"reverse-arrow":{tagName:"marker",attributes:{id:"reverse-arrow",refY:5,refX:1,markerWidth:10,markerHeight:10},children:[{tagName:"path",attributes:{d:"M 0 5 L 10 0 L 10 10 Z","stroke-width":0}}]}}}}),i(e,"Extensions/Annotations/Controllables/ControllablePath.js",[e["Extensions/Annotations/Controllables/Controllable.js"],e["Extensions/Annotations/Controllables/ControllableDefaults.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(t,e,i,r){let{defaultMarkers:o}=e,{addEvent:s,defined:n,extend:a,merge:l,uniqueKey:h}=r,c=g("marker-end"),d=g("marker-start"),u="rgba(192,192,192,"+(i.svg?1e-4:.002)+")";function g(t){return function(e){this.attr(t,"url(#"+e+")")}}function p(){this.options.defs=l(o,this.options.defs||{})}function f(t,e){let i={attributes:{id:t}},r={stroke:e.color||"none",fill:e.color||"rgba(0, 0, 0, 0.75)"};i.children=e.children&&e.children.map(function(t){return l(r,t)});let o=l(!0,{attributes:{markerWidth:20,markerHeight:20,refX:0,refY:0,orient:"auto"}},e,i),s=this.definition(o);return s.id=t,s}class m extends t{static compose(t,e){let i=e.prototype;i.addMarker||(s(t,"afterGetContainer",p),i.addMarker=f)}constructor(t,e,i){super(t,e,i,"shape"),this.type="path"}toD(){let t=this.options.d;if(t)return"function"==typeof t?t.call(this):t;let e=this.points,i=e.length,r=[],o=i,s=e[0],n=o&&this.anchor(s).absolutePosition,a=0,l;if(n)for(r.push(["M",n.x,n.y]);++a<i&&o;)l=(s=e[a]).command||"L",n=this.anchor(s).absolutePosition,"M"===l?r.push([l,n.x,n.y]):"L"===l?r.push([l,n.x,n.y]):"Z"===l&&r.push([l]),o=s.series.visible;return o&&this.graphic?this.chart.renderer.crispLine(r,this.graphic.strokeWidth()):null}shouldBeDrawn(){return super.shouldBeDrawn()||!!this.options.d}render(t){let e=this.options,i=this.attrsFromOptions(e);this.graphic=this.annotation.chart.renderer.path([["M",0,0]]).attr(i).add(t),e.className&&this.graphic.addClass(e.className),this.tracker=this.annotation.chart.renderer.path([["M",0,0]]).addClass("highcharts-tracker-line").attr({zIndex:2}).add(t),this.annotation.chart.styledMode||this.tracker.attr({"stroke-linejoin":"round",stroke:u,fill:u,"stroke-width":this.graphic.strokeWidth()+2*e.snap}),super.render(),a(this.graphic,{markerStartSetter:d,markerEndSetter:c}),this.setMarkers(this)}redraw(t){if(this.graphic){let e=this.toD(),i=t?"animate":"attr";e?(this.graphic[i]({d:e}),this.tracker[i]({d:e})):(this.graphic.attr({d:"M 0 -9000000000"}),this.tracker.attr({d:"M 0 -9000000000"})),this.graphic.placed=this.tracker.placed=!!e}super.redraw(t)}setMarkers(t){let e=t.options,i=t.chart,r=i.options.defs,o=e.fill,s=n(o)&&"none"!==o?o:e.stroke;["markerStart","markerEnd"].forEach(function(o){let n,a,c,d;let u=e[o];if(u){for(c in r)if((u===((n=r[c]).attributes&&n.attributes.id)||u===n.id)&&"marker"===n.tagName){a=n;break}a&&(d=t[o]=i.renderer.addMarker((e.id||h())+"-"+u,l(a,{color:s})),t.attr(o,d.getAttribute("id")))}})}}return m.attrsMap={dashStyle:"dashstyle",strokeWidth:"stroke-width",stroke:"stroke",fill:"fill",zIndex:"zIndex"},m}),i(e,"Extensions/Annotations/Controllables/ControllableRect.js",[e["Extensions/Annotations/Controllables/Controllable.js"],e["Extensions/Annotations/Controllables/ControllablePath.js"],e["Core/Utilities.js"]],function(t,e,i){let{merge:r}=i;class o extends t{constructor(t,e,i){super(t,e,i,"shape"),this.type="rect",this.translate=super.translateShape}render(t){let e=this.attrsFromOptions(this.options);this.graphic=this.annotation.chart.renderer.rect(0,-9e9,0,0).attr(e).add(t),super.render()}redraw(t){if(this.graphic){let e=this.anchor(this.points[0]).absolutePosition;e?this.graphic[t?"animate":"attr"]({x:e.x,y:e.y,width:this.options.width,height:this.options.height}):this.attr({x:0,y:-9e9}),this.graphic.placed=!!e}super.redraw(t)}}return o.attrsMap=r(e.attrsMap,{width:"width",height:"height"}),o}),i(e,"Extensions/Annotations/Controllables/ControllableCircle.js",[e["Extensions/Annotations/Controllables/Controllable.js"],e["Extensions/Annotations/Controllables/ControllablePath.js"],e["Core/Utilities.js"]],function(t,e,i){let{merge:r}=i;class o extends t{constructor(t,e,i){super(t,e,i,"shape"),this.type="circle",this.translate=super.translateShape}redraw(t){if(this.graphic){let e=this.anchor(this.points[0]).absolutePosition;e?this.graphic[t?"animate":"attr"]({x:e.x,y:e.y,r:this.options.r}):this.graphic.attr({x:0,y:-9e9}),this.graphic.placed=!!e}super.redraw.call(this,t)}render(t){let e=this.attrsFromOptions(this.options);this.graphic=this.annotation.chart.renderer.circle(0,-9e9,0).attr(e).add(t),super.render()}setRadius(t){this.options.r=t}}return o.attrsMap=r(e.attrsMap,{r:"r"}),o}),i(e,"Extensions/Annotations/Controllables/ControllableEllipse.js",[e["Extensions/Annotations/Controllables/Controllable.js"],e["Extensions/Annotations/Controllables/ControllablePath.js"],e["Core/Utilities.js"]],function(t,e,i){let{merge:r,defined:o}=i;class s extends t{constructor(t,e,i){super(t,e,i,"shape"),this.type="ellipse"}init(t,e,i){o(e.yAxis)&&e.points.forEach(t=>{t.yAxis=e.yAxis}),o(e.xAxis)&&e.points.forEach(t=>{t.xAxis=e.xAxis}),super.init(t,e,i)}render(t){this.graphic=this.annotation.chart.renderer.createElement("ellipse").attr(this.attrsFromOptions(this.options)).add(t),super.render()}translate(t,e){super.translateShape(t,e,!0)}getDistanceFromLine(t,e,i,r){return Math.abs((e.y-t.y)*i-(e.x-t.x)*r+e.x*t.y-e.y*t.x)/Math.sqrt((e.y-t.y)*(e.y-t.y)+(e.x-t.x)*(e.x-t.x))}getAttrs(t,e){let i=t.x,r=t.y,o=e.x,s=e.y,n=(i+o)/2,a=180*Math.atan((s-r)/(o-i))/Math.PI;return n<i&&(a+=180),{cx:n,cy:(r+s)/2,rx:Math.sqrt((i-o)*(i-o)/4+(r-s)*(r-s)/4),ry:this.getRY(),angle:a}}getRY(){let t=this.getYAxis();return o(t)?Math.abs(t.toPixels(this.options.ry)-t.toPixels(0)):this.options.ry}getYAxis(){let t=this.options.yAxis;return this.chart.yAxis[t]}getAbsolutePosition(t){return this.anchor(t).absolutePosition}redraw(t){if(this.graphic){let e=this.getAbsolutePosition(this.points[0]),i=this.getAbsolutePosition(this.points[1]),r=this.getAttrs(e,i);e?this.graphic[t?"animate":"attr"]({cx:r.cx,cy:r.cy,rx:r.rx,ry:r.ry,rotation:r.angle,rotationOriginX:r.cx,rotationOriginY:r.cy}):this.graphic.attr({x:0,y:-9e9}),this.graphic.placed=!!e}super.redraw(t)}setYRadius(t){let e=this.annotation.userOptions.shapes;this.options.ry=t,e&&e[0]&&(e[0].ry=t,e[0].ry=t)}}return s.attrsMap=r(e.attrsMap,{ry:"ry"}),s}),i(e,"Extensions/Annotations/Controllables/ControllableLabel.js",[e["Extensions/Annotations/Controllables/Controllable.js"],e["Core/Templating.js"],e["Extensions/Annotations/MockPoint.js"],e["Core/Utilities.js"]],function(t,e,i,r){let{format:o}=e,{extend:s,isNumber:n,pick:a}=r;function l(t,e,i,r,o){let s=o&&o.anchorX,a=o&&o.anchorY,l,h,c=i/2;return n(s)&&n(a)&&(l=[["M",s,a]],(h=e-a)<0&&(h=-r-h),h<i&&(c=s<t+i/2?h:i-h),a>e+r?l.push(["L",t+c,e+r]):a<e?l.push(["L",t+c,e]):s<t?l.push(["L",t,e+r/2]):s>t+i&&l.push(["L",t+i,e+r/2])),l||[]}class h extends t{static alignedPosition(t,e){let i=t.align,r=t.verticalAlign,o=(e.x||0)+(t.x||0),s=(e.y||0)+(t.y||0),n,a;return"right"===i?n=1:"center"===i&&(n=2),n&&(o+=(e.width-(t.width||0))/n),"bottom"===r?a=1:"middle"===r&&(a=2),a&&(s+=(e.height-(t.height||0))/a),{x:Math.round(o),y:Math.round(s)}}static compose(t){t.prototype.symbols.connector=l}static justifiedOptions(t,e,i,r){let o;let s=i.align,n=i.verticalAlign,a=e.box?0:e.padding||0,l=e.getBBox(),h={align:s,verticalAlign:n,x:i.x,y:i.y,width:e.width,height:e.height},c=(r.x||0)-t.plotLeft,d=(r.y||0)-t.plotTop;return(o=c+a)<0&&("right"===s?h.align="left":h.x=(h.x||0)-o),(o=c+l.width-a)>t.plotWidth&&("left"===s?h.align="right":h.x=(h.x||0)+t.plotWidth-o),(o=d+a)<0&&("bottom"===n?h.verticalAlign="top":h.y=(h.y||0)-o),(o=d+l.height-a)>t.plotHeight&&("top"===n?h.verticalAlign="bottom":h.y=(h.y||0)+t.plotHeight-o),h}constructor(t,e,i){super(t,e,i,"label")}translatePoint(t,e){super.translatePoint(t,e,0)}translate(t,e){let i=this.annotation.chart,r=this.annotation.userOptions,o=i.annotations.indexOf(this.annotation),s=i.options.annotations[o];if(i.inverted){let i=t;t=e,e=i}this.options.x+=t,this.options.y+=e,s[this.collection][this.index].x=this.options.x,s[this.collection][this.index].y=this.options.y,r[this.collection][this.index].x=this.options.x,r[this.collection][this.index].y=this.options.y}render(t){let e=this.options,i=this.attrsFromOptions(e),r=e.style;this.graphic=this.annotation.chart.renderer.label("",0,-9999,e.shape,null,null,e.useHTML,null,"annotation-label").attr(i).add(t),this.annotation.chart.styledMode||("contrast"===r.color&&(r.color=this.annotation.chart.renderer.getContrast(h.shapesWithoutBackground.indexOf(e.shape)>-1?"#FFFFFF":e.backgroundColor)),this.graphic.css(e.style).shadow(e.shadow)),e.className&&this.graphic.addClass(e.className),this.graphic.labelrank=e.labelrank,super.render()}redraw(t){let e=this.options,i=this.text||e.format||e.text,r=this.graphic,s=this.points[0];if(!r){this.redraw(t);return}r.attr({text:i?o(String(i),s.getLabelConfig(),this.annotation.chart):e.formatter.call(s,this)});let n=this.anchor(s),a=this.position(n);a?(r.alignAttr=a,a.anchorX=n.absolutePosition.x,a.anchorY=n.absolutePosition.y,r[t?"animate":"attr"](a)):r.attr({x:0,y:-9999}),r.placed=!!a,super.redraw(t)}anchor(t){let e=super.anchor.apply(this,arguments),i=this.options.x||0,r=this.options.y||0;return e.absolutePosition.x-=i,e.absolutePosition.y-=r,e.relativePosition.x-=i,e.relativePosition.y-=r,e}position(t){let e=this.graphic,r=this.annotation.chart,o=r.tooltip,n=this.points[0],l=this.options,c=t.absolutePosition,d=t.relativePosition,u,g,p,f,m=n.series.visible&&i.prototype.isInsidePlot.call(n);if(e&&m){let{width:t=0,height:i=0}=e;l.distance&&o?u=o.getPosition.call({chart:r,distance:a(l.distance,16),getPlayingField:o.getPlayingField,pointer:o.pointer},t,i,{plotX:d.x,plotY:d.y,negative:n.negative,ttBelow:n.ttBelow,h:d.height||d.width}):l.positioner?u=l.positioner.call(this):(g={x:c.x,y:c.y,width:0,height:0},u=h.alignedPosition(s(l,{width:t,height:i}),g),"justify"===this.options.overflow&&(u=h.alignedPosition(h.justifiedOptions(r,e,l,u),g))),l.crop&&(p=u.x-r.plotLeft,f=u.y-r.plotTop,m=r.isInsidePlot(p,f)&&r.isInsidePlot(p+t,f+i))}return m?u:null}}return h.attrsMap={backgroundColor:"fill",borderColor:"stroke",borderWidth:"stroke-width",zIndex:"zIndex",borderRadius:"r",padding:"padding"},h.shapesWithoutBackground=["connector"],h}),i(e,"Extensions/Annotations/Controllables/ControllableImage.js",[e["Extensions/Annotations/Controllables/Controllable.js"],e["Extensions/Annotations/Controllables/ControllableLabel.js"]],function(t,e){class i extends t{constructor(t,e,i){super(t,e,i,"shape"),this.type="image",this.translate=super.translateShape}render(t){let e=this.attrsFromOptions(this.options),i=this.options;this.graphic=this.annotation.chart.renderer.image(i.src,0,-9e9,i.width,i.height).attr(e).add(t),this.graphic.width=i.width,this.graphic.height=i.height,super.render()}redraw(t){if(this.graphic){let i=this.anchor(this.points[0]),r=e.prototype.position.call(this,i);r?this.graphic[t?"animate":"attr"]({x:r.x,y:r.y}):this.graphic.attr({x:0,y:-9e9}),this.graphic.placed=!!r}super.redraw(t)}}return i.attrsMap={width:"width",height:"height",zIndex:"zIndex"},i}),i(e,"Shared/BaseForm.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Utilities.js"]],function(t,e){let{addEvent:i,createElement:r}=e;return class{constructor(t,e){this.iconsURL=e,this.container=this.createPopupContainer(t),this.closeButton=this.addCloseButton()}createPopupContainer(t,e="highcharts-popup highcharts-no-tooltip"){return r("div",{className:e},void 0,t)}addCloseButton(t="highcharts-popup-close"){let e=this,o=this.iconsURL,s=r("button",{className:t},void 0,this.container);return s.style["background-image"]="url("+(o.match(/png|svg|jpeg|jpg|gif/ig)?o:o+"close.svg")+")",["click","touchstart"].forEach(t=>{i(s,t,e.closeButtonEvents.bind(e))}),i(document,"keydown",function(t){"Escape"===t.code&&e.closeButtonEvents()}),s}closeButtonEvents(){this.closePopup()}showPopup(e="highcharts-annotation-toolbar"){let i=this.container,r=this.closeButton;this.type=void 0,i.innerHTML=t.emptyHTML,i.className.indexOf(e)>=0&&(i.classList.remove(e),i.removeAttribute("style")),i.appendChild(r),i.style.display="block",i.style.height=""}closePopup(){this.container.style.display="none"}}}),i(e,"Extensions/Annotations/Popup/PopupAnnotations.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(t,e){let{doc:i,isFirefox:r}=t,{createElement:o,isArray:s,isObject:n,objectEach:a,pick:l,stableSort:h}=e;function c(t,e,l,d,u,g){let p,f;if(!e)return;let m=this.addInput,y=this.lang;a(d,(i,r)=>{p=""!==l?l+"."+r:r,n(i)&&(!s(i)||s(i)&&n(i[0])?((f=y[r]||r).match(/\d/g)||u.push([!0,f,t]),c.call(this,t,e,p,i,u,!1)):u.push([this,p,"annotation",t,i]))}),g&&(h(u,t=>t[1].match(/format/g)?-1:1),r&&u.reverse(),u.forEach(t=>{!0===t[0]?o("span",{className:"highcharts-annotation-title"},void 0,t[2]).appendChild(i.createTextNode(t[1])):(t[4]={value:t[4][0],type:t[4][1]},m.apply(t[0],t.splice(1)))}))}return{addForm:function(t,e,r,s){if(!t)return;let n=this.container,a=this.lang,l=o("h2",{className:"highcharts-popup-main-title"},void 0,n);l.appendChild(i.createTextNode(a[e.langKey]||e.langKey||"")),l=o("div",{className:"highcharts-popup-lhs-col highcharts-popup-lhs-full"},void 0,n);let h=o("div",{className:"highcharts-popup-bottom-row"},void 0,n);c.call(this,l,t,"",e,[],!0),this.addButton(h,s?a.addButton||"Add":a.saveButton||"Save",s?"add":"save",n,r)},addToolbar:function(t,e,r){let s=this.lang,n=this.container,a=this.showForm,h="highcharts-annotation-toolbar";-1===n.className.indexOf(h)&&(n.className+=" "+h+" highcharts-no-mousewheel"),t&&(n.style.top=t.plotTop+10+"px");let c=o("p",{className:"highcharts-annotation-label"},void 0,n);c.setAttribute("aria-label","Annotation type"),c.appendChild(i.createTextNode(l(s[e.langKey]||e.langKey,e.shapes&&e.shapes[0].type,"")));let d=this.addButton(n,s.editButton||"Edit","edit",n,()=>{a.call(this,"annotation-edit",t,e,r)});d.className+=" highcharts-annotation-edit-button",d.style["background-image"]="url("+this.iconsURL+"edit.svg)",d=this.addButton(n,s.removeButton||"Remove","remove",n,r),d.className+=" highcharts-annotation-remove-button",d.style["background-image"]="url("+this.iconsURL+"destroy.svg)"}}}),i(e,"Extensions/Annotations/Popup/PopupIndicators.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Globals.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(t,e,i,r){var o,s;let{doc:n}=e,{seriesTypes:a}=i,{addEvent:l,createElement:h,defined:c,isArray:d,isObject:u,objectEach:g,stableSort:p}=r;(s=o||(o={}))[s["params.algorithm"]=0]="params.algorithm",s[s["params.average"]=1]="params.average";let f={"algorithm-pivotpoints":["standard","fibonacci","camarilla"],"average-disparityindex":["sma","ema","dema","tema","wma"]};function m(t){let e=h("div",{className:"highcharts-popup-lhs-col"},void 0,t),i=h("div",{className:"highcharts-popup-rhs-col"},void 0,t);return h("div",{className:"highcharts-popup-rhs-col-wrapper"},void 0,i),{lhsCol:e,rhsCol:i}}function y(e,i,r,o){let s=i.params||i.options.params;o.innerHTML=t.emptyHTML,h("h3",{className:"highcharts-indicator-title"},void 0,o).appendChild(n.createTextNode(T(i,r).indicatorFullName)),h("input",{type:"hidden",name:"highcharts-type-"+r,value:r},void 0,o),M.call(this,r,"series",e,o,i,i.linkedParent&&i.linkedParent.options.id),s.volumeSeriesID&&M.call(this,r,"volume",e,o,i,i.linkedParent&&s.volumeSeriesID),b.call(this,e,"params",s,r,o)}function w(e,i,r,o){function s(t,i){let r=C.parentNode.children[1];y.call(n,e,t,i,C),r&&(r.style.display="block"),g&&t.options&&h("input",{type:"hidden",name:"highcharts-id-"+i,value:t.options.id},void 0,C).setAttribute("highcharts-data-series-id",t.options.id)}let n=this,a=n.lang,c=i.querySelectorAll(".highcharts-popup-lhs-col")[0],u=i.querySelectorAll(".highcharts-popup-rhs-col")[0],g="edit"===r,f=g?e.series:e.options.plotOptions||{};if(!e&&f)return;let m,w=[];g||d(f)?d(f)&&(w=R.call(this,f)):w=E.call(this,f,o),p(w,(t,e)=>{let i=t.indicatorFullName.toLowerCase(),r=e.indicatorFullName.toLowerCase();return i<r?-1:i>r?1:0}),c.children[1]&&c.children[1].remove();let b=h("ul",{className:"highcharts-indicator-list"},void 0,c),C=u.querySelectorAll(".highcharts-popup-rhs-col-wrapper")[0];if(w.forEach(t=>{let{indicatorFullName:e,indicatorType:i,series:r}=t;m=h("li",{className:"highcharts-indicator-list"},void 0,b);let o=h("button",{className:"highcharts-indicator-list-item",textContent:e},void 0,m);["click","touchstart"].forEach(t=>{l(o,t,function(){s(r,i)})})}),w.length>0){let{series:t,indicatorType:e}=w[0];s(t,e)}else g||(t.setElementHTML(C.parentNode.children[0],a.noFilterMatch||""),C.parentNode.children[1].style.display="none")}function b(t,e,i,r,s){if(!t)return;let n=this.addInput;g(i,(i,a)=>{let l=e+"."+a;if(c(i)&&l){if(u(i)&&(n.call(this,l,r,s,{}),b.call(this,t,l,i,r,s)),l in o){let o=S.call(this,r,l,s);x.call(this,t,e,o,r,a,i)}else"params.volumeSeriesID"===l||d(i)||n.call(this,l,r,s,{value:i,type:"number"})}})}function C(t,e){let i=this,r=e.querySelectorAll(".highcharts-popup-lhs-col")[0],o=this.lang.clearFilter,s=h("div",{className:"highcharts-input-wrapper"},void 0,r),n=function(e){w.call(i,t,i.container,"add",e)},a=this.addInput("searchIndicators","input",s,{value:"",type:"text",htmlFor:"search-indicators",labelClassName:"highcharts-input-search-indicators-label"}),c=h("a",{textContent:o},void 0,s);a.classList.add("highcharts-input-search-indicators"),c.classList.add("clear-filter-button"),l(a,"input",function(){n(this.value),this.value.length?c.style.display="inline-block":c.style.display="none"}),["click","touchstart"].forEach(t=>{l(c,t,function(){a.value="",n(""),c.style.display="none"})})}function S(t,e,i){let r=e.split("."),o=r[r.length-1],s="highcharts-"+e+"-type-"+t,a=this.lang;h("label",{htmlFor:s},null,i).appendChild(n.createTextNode(a[o]||e));let l=h("select",{name:s,className:"highcharts-popup-field",id:"highcharts-select-"+e},null,i);return l.setAttribute("id","highcharts-select-"+e),l}function x(t,e,i,r,o,s,a){"series"===e||"volume"===e?t.series.forEach(t=>{let r=t.options,o=r.name||r.params?t.name:r.id||"";"highcharts-navigator-series"!==r.id&&r.id!==(a&&a.options&&a.options.id)&&(c(s)||"volume"!==e||"column"!==t.type||(s=r.id),h("option",{value:r.id},void 0,i).appendChild(n.createTextNode(o)))}):r&&o&&f[o+"-"+r].forEach(t=>{h("option",{value:t},void 0,i).appendChild(n.createTextNode(t))}),c(s)&&(i.value=s)}function E(t,e){let i;let r=this.chart&&this.chart.options.lang,o=r&&r.navigation&&r.navigation.popup&&r.navigation.popup.indicatorAliases,s=[];return g(t,(t,r)=>{let n=t&&t.options;if(t.params||n&&n.params){let{indicatorFullName:n,indicatorType:a}=T(t,r);if(e){let r=RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i"),l=o&&o[a]&&o[a].join(" ")||"";(n.match(r)||l.match(r))&&(i={indicatorFullName:n,indicatorType:a,series:t},s.push(i))}else i={indicatorFullName:n,indicatorType:a,series:t},s.push(i)}}),s}function R(t){let e=[];return t.forEach(t=>{t.is("sma")&&e.push({indicatorFullName:t.name,indicatorType:t.type,series:t})}),e}function T(t,e){let i=t.options,r=a[e]&&a[e].prototype.nameBase||e.toUpperCase(),o=e;return i&&i.type&&(o=t.options.type,r=t.name),{indicatorFullName:r,indicatorType:o}}function M(t,e,i,r,o,s){if(!i)return;let n=S.call(this,t,e,r);x.call(this,i,e,n,void 0,void 0,void 0,o),c(s)&&(n.value=s)}return{addForm:function(t,e,i){let r;let o=this.lang;if(!t)return;this.tabs.init.call(this,t);let s=this.container.querySelectorAll(".highcharts-tab-item-content");m(s[0]),C.call(this,t,s[0]),w.call(this,t,s[0],"add"),r=s[0].querySelectorAll(".highcharts-popup-rhs-col")[0],this.addButton(r,o.addButton||"add","add",r,i),m(s[1]),w.call(this,t,s[1],"edit"),r=s[1].querySelectorAll(".highcharts-popup-rhs-col")[0],this.addButton(r,o.saveButton||"save","edit",r,i),this.addButton(r,o.removeButton||"remove","remove",r,i)},getAmount:function(){let t=0;return this.series.forEach(e=>{(e.params||e.options.params)&&t++}),t}}}),i(e,"Extensions/Annotations/Popup/PopupTabs.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(t,e){let{doc:i}=t,{addEvent:r,createElement:o}=e;function s(){return o("div",{className:"highcharts-tab-item-content highcharts-no-mousewheel"},void 0,this.container)}function n(t,e){let r=this.container,s=this.lang,n="highcharts-tab-item";0===e&&(n+=" highcharts-tab-disabled");let a=o("button",{className:n},void 0,r);return a.appendChild(i.createTextNode(s[t+"Button"]||t)),a.setAttribute("highcharts-data-tab-type",t),a}function a(){let t=this.container,e=t.querySelectorAll(".highcharts-tab-item"),i=t.querySelectorAll(".highcharts-tab-item-content");for(let t=0;t<e.length;t++)e[t].classList.remove("highcharts-tab-item-active"),i[t].classList.remove("highcharts-tab-item-show")}function l(t,e){let i=this.container.querySelectorAll(".highcharts-tab-item-content");t.className+=" highcharts-tab-item-active",i[e].className+=" highcharts-tab-item-show"}function h(t){let e=this;this.container.querySelectorAll(".highcharts-tab-item").forEach((i,o)=>{(0!==t||"edit"!==i.getAttribute("highcharts-data-tab-type"))&&["click","touchstart"].forEach(t=>{r(i,t,function(){a.call(e),l.call(e,this,o)})})})}return{init:function(t){if(!t)return;let e=this.indicators.getAmount.call(t),i=n.call(this,"add");n.call(this,"edit",e),s.call(this),s.call(this),h.call(this,e),l.call(this,i,0)}}}),i(e,"Extensions/Annotations/Popup/Popup.js",[e["Shared/BaseForm.js"],e["Core/Globals.js"],e["Core/Defaults.js"],e["Extensions/Annotations/Popup/PopupAnnotations.js"],e["Extensions/Annotations/Popup/PopupIndicators.js"],e["Extensions/Annotations/Popup/PopupTabs.js"],e["Core/Utilities.js"]],function(t,e,i,r,o,s,n){let{doc:a}=e,{getOptions:l}=i,{addEvent:h,createElement:c,extend:d,fireEvent:u,pick:g}=n;class p extends t{constructor(t,e,i){super(t,e),this.chart=i,this.lang=(l().lang.navigation||{}).popup||{},h(this.container,"mousedown",()=>{let t=i&&i.navigationBindings&&i.navigationBindings.activeAnnotation;if(t){t.cancelClick=!0;let e=h(a,"click",()=>{setTimeout(()=>{t.cancelClick=!1},0),e()})}})}addInput(t,e,i,r){let o=t.split("."),s=o[o.length-1],n=this.lang,l="highcharts-"+e+"-"+g(r.htmlFor,s);s.match(/^\d+$/)||c("label",{htmlFor:l,className:r.labelClassName},void 0,i).appendChild(a.createTextNode(n[s]||s));let h=c("input",{name:l,value:r.value,type:r.type,className:"highcharts-popup-field"},void 0,i);return h.setAttribute("highcharts-data-name",t),h}closeButtonEvents(){if(this.chart){let t=this.chart.navigationBindings;u(t,"closePopup"),t&&t.selectedButtonElement&&u(t,"deselectButton",{button:t.selectedButtonElement})}else super.closeButtonEvents()}addButton(t,e,i,r,o){let s=c("button",void 0,void 0,t);return s.appendChild(a.createTextNode(e)),o&&["click","touchstart"].forEach(t=>{h(s,t,()=>{let t,e,s,n,a;return this.closePopup(),o((t=Array.prototype.slice.call(r.querySelectorAll("input")),e=Array.prototype.slice.call(r.querySelectorAll("select")),s=r.querySelectorAll("#highcharts-select-series > option:checked")[0],n=r.querySelectorAll("#highcharts-select-volume > option:checked")[0],a={actionType:i,linkedTo:s&&s.getAttribute("value")||"",fields:{}},t.forEach(t=>{let e=t.getAttribute("highcharts-data-name");t.getAttribute("highcharts-data-series-id")?a.seriesId=t.value:e?a.fields[e]=t.value:a.type=t.value}),e.forEach(t=>{let e=t.id;if("highcharts-select-series"!==e&&"highcharts-select-volume"!==e){let i=e.split("highcharts-select-")[1];a.fields[i]=t.value}}),n&&(a.fields["params.volumeSeriesID"]=n.getAttribute("value")||""),a))})}),s}showForm(t,e,i,r){e&&(this.showPopup(),"indicators"===t&&this.indicators.addForm.call(this,e,i,r),"annotation-toolbar"===t&&this.annotations.addToolbar.call(this,e,i,r),"annotation-edit"===t&&this.annotations.addForm.call(this,e,i,r),"flag"===t&&this.annotations.addForm.call(this,e,i,r,!0),this.type=t,this.container.style.height=this.container.offsetHeight+"px")}}return d(p.prototype,{annotations:r,indicators:o,tabs:s}),p}),i(e,"Extensions/Annotations/Popup/PopupComposition.js",[e["Core/Globals.js"],e["Extensions/Annotations/Popup/Popup.js"],e["Core/Utilities.js"]],function(t,e,i){let{composed:r}=t,{addEvent:o,pushUnique:s,wrap:n}=i;function a(){this.popup&&this.popup.closePopup()}function l(t){this.popup||(this.popup=new e(this.chart.container,this.chart.options.navigation.iconsURL||this.chart.options.stockTools&&this.chart.options.stockTools.gui.iconsURL||"https://code.highcharts.com/11.4.1/gfx/stock-icons/",this.chart)),this.popup.showForm(t.formType,this.chart,t.options,t.onSubmit)}function h(t,e){this.inClass(e.target,"highcharts-popup")||t.apply(this,Array.prototype.slice.call(arguments,1))}return{compose:function(t,e){s(r,"Popup")&&(o(t,"closePopup",a),o(t,"showPopup",l),n(e.prototype,"onContainerMouseDown",h))}}}),i(e,"Extensions/Annotations/Annotation.js",[e["Core/Animation/AnimationUtilities.js"],e["Extensions/Annotations/AnnotationChart.js"],e["Extensions/Annotations/AnnotationDefaults.js"],e["Extensions/Annotations/Controllables/ControllableRect.js"],e["Extensions/Annotations/Controllables/ControllableCircle.js"],e["Extensions/Annotations/Controllables/ControllableEllipse.js"],e["Extensions/Annotations/Controllables/ControllablePath.js"],e["Extensions/Annotations/Controllables/ControllableImage.js"],e["Extensions/Annotations/Controllables/ControllableLabel.js"],e["Extensions/Annotations/ControlPoint.js"],e["Extensions/Annotations/ControlTarget.js"],e["Extensions/Annotations/EventEmitter.js"],e["Extensions/Annotations/MockPoint.js"],e["Extensions/Annotations/Popup/PopupComposition.js"],e["Core/Utilities.js"]],function(t,e,i,r,o,s,n,a,l,h,c,d,u,g,p){let{getDeferredAnimation:f}=t,{destroyObjectProperties:m,erase:y,fireEvent:w,merge:b,pick:C,splat:S}=p;function x(t,e){let i={};return["labels","shapes"].forEach(r=>{let o=t[r];o&&(e[r]?i[r]=S(e[r]).map(function(t,e){return b(o[e],t)}):i[r]=t[r])}),i}class E extends d{static compose(t,i,r,o){e.compose(E,t,r),l.compose(o),n.compose(t,o),i.compose(E,t),g.compose(i,r)}constructor(t,e){super(),this.coll="annotations",this.chart=t,this.points=[],this.controlPoints=[],this.coll="annotations",this.index=-1,this.labels=[],this.shapes=[],this.options=b(this.defaultOptions,e),this.userOptions=e;let i=x(this.options,e);this.options.labels=i.labels,this.options.shapes=i.shapes,this.init(t,this.options)}addClipPaths(){this.setClipAxes(),this.clipXAxis&&this.clipYAxis&&this.options.crop&&(this.clipRect=this.chart.renderer.clipRect(this.getClipBox()))}addLabels(){let t=this.options.labels||[];t.forEach((e,i)=>{let r=this.initLabel(e,i);b(!0,t[i],r.options)})}addShapes(){let t=this.options.shapes||[];t.forEach((e,i)=>{let r=this.initShape(e,i);b(!0,t[i],r.options)})}destroy(){let t=this.chart,e=function(t){t.destroy()};this.labels.forEach(e),this.shapes.forEach(e),this.clipXAxis=null,this.clipYAxis=null,y(t.labelCollectors,this.labelCollector),super.destroy(),this.destroyControlTarget(),m(this,t)}destroyItem(t){y(this[t.itemType+"s"],t),t.destroy()}getClipBox(){if(this.clipXAxis&&this.clipYAxis)return{x:this.clipXAxis.left,y:this.clipYAxis.top,width:this.clipXAxis.width,height:this.clipYAxis.height}}initProperties(t,e){this.setOptions(e);let i=x(this.options,e);this.options.labels=i.labels,this.options.shapes=i.shapes,this.chart=t,this.points=[],this.controlPoints=[],this.coll="annotations",this.userOptions=e,this.labels=[],this.shapes=[]}init(t,e,i=this.index){let r=this.chart,o=this.options.animation;this.index=i,this.linkPoints(),this.addControlPoints(),this.addShapes(),this.addLabels(),this.setLabelCollector(),this.animationConfig=f(r,o)}initLabel(t,e){let i=new l(this,b(this.options.labelOptions,{controlPointOptions:this.options.controlPointOptions},t),e);return i.itemType="label",this.labels.push(i),i}initShape(t,e){let i=b(this.options.shapeOptions,{controlPointOptions:this.options.controlPointOptions},t),r=new E.shapesMap[i.type](this,i,e);return r.itemType="shape",this.shapes.push(r),r}redraw(t){this.linkPoints(),this.graphic||this.render(),this.clipRect&&this.clipRect.animate(this.getClipBox()),this.redrawItems(this.shapes,t),this.redrawItems(this.labels,t),this.redrawControlPoints(t)}redrawItem(t,e){let i,r;t.linkPoints(),t.shouldBeDrawn()?(t.graphic||this.renderItem(t),t.redraw(C(e,!0)&&t.graphic.placed),t.points.length&&(i=t.graphic,r=t.points.some(t=>!1!==t.series.visible&&!1!==t.visible),i&&(r?"hidden"===i.visibility&&i.show():i.hide()))):this.destroyItem(t)}redrawItems(t,e){let i=t.length;for(;i--;)this.redrawItem(t[i],e)}remove(){return this.chart.removeAnnotation(this)}render(){let t=this.chart.renderer;this.graphic=t.g("annotation").attr({opacity:0,zIndex:this.options.zIndex,visibility:this.options.visible?"inherit":"hidden"}).add(),this.shapesGroup=t.g("annotation-shapes").add(this.graphic),this.options.crop&&this.shapesGroup.clip(this.chart.plotBoxClip),this.labelsGroup=t.g("annotation-labels").attr({translateX:0,translateY:0}).add(this.graphic),this.addClipPaths(),this.clipRect&&this.graphic.clip(this.clipRect),this.renderItems(this.shapes),this.renderItems(this.labels),this.addEvents(),this.renderControlPoints()}renderItem(t){t.render("label"===t.itemType?this.labelsGroup:this.shapesGroup)}renderItems(t){let e=t.length;for(;e--;)this.renderItem(t[e])}setClipAxes(){let t=this.chart.xAxis,e=this.chart.yAxis,i=(this.options.labels||[]).concat(this.options.shapes||[]).reduce((i,r)=>{let o=r&&(r.point||r.points&&r.points[0]);return[t[o&&o.xAxis]||i[0],e[o&&o.yAxis]||i[1]]},[]);this.clipXAxis=i[0],this.clipYAxis=i[1]}setControlPointsVisibility(t){let e=function(e){e.setControlPointsVisibility(t)};this.controlPoints.forEach(e=>{e.setVisibility(t)}),this.shapes.forEach(e),this.labels.forEach(e)}setLabelCollector(){let t=this;t.labelCollector=function(){return t.labels.reduce(function(t,e){return e.options.allowOverlap||t.push(e.graphic),t},[])},t.chart.labelCollectors.push(t.labelCollector)}setOptions(t){this.options=b(this.defaultOptions,t)}setVisibility(t){let e=this.options,i=this.chart.navigationBindings,r=C(t,!e.visible);if(this.graphic.attr("visibility",r?"inherit":"hidden"),!r){let t=function(t){t.setControlPointsVisibility(r)};this.shapes.forEach(t),this.labels.forEach(t),i.activeAnnotation===this&&i.popup&&"annotation-toolbar"===i.popup.type&&w(i,"closePopup")}e.visible=r}update(t,e){let i=this.chart,r=x(this.userOptions,t),o=i.annotations.indexOf(this),s=b(!0,this.userOptions,t);s.labels=r.labels,s.shapes=r.shapes,this.destroy(),this.initProperties(i,s),this.init(i,s),i.options.annotations[o]=s,this.isUpdating=!0,C(e,!0)&&i.drawAnnotations(),w(this,"afterUpdate"),this.isUpdating=!1}}return E.ControlPoint=h,E.MockPoint=u,E.shapesMap={rect:r,circle:o,ellipse:s,path:n,image:a},E.types={},E.prototype.defaultOptions=i,E.prototype.nonDOMEvents=["add","afterUpdate","drag","remove"],c.compose(E),E}),i(e,"Core/Chart/ChartNavigationComposition.js",[],function(){var t;return function(t){t.compose=function(t){return t.navigation||(t.navigation=new e(t)),t};class e{constructor(t){this.updates=[],this.chart=t}addUpdate(t){this.chart.navigation.updates.push(t)}update(t,e){this.updates.forEach(i=>{i.call(this.chart,t,e)})}}t.Additions=e}(t||(t={})),t}),i(e,"Extensions/Annotations/NavigationBindingsUtilities.js",[e["Core/Utilities.js"]],function(t){let{defined:e,isNumber:i,pick:r}=t,o={backgroundColor:"string",borderColor:"string",borderRadius:"string",color:"string",fill:"string",fontSize:"string",labels:"string",name:"string",stroke:"string",title:"string"};return{annotationsFieldsTypes:o,getAssignedAxis:function(t){return t.filter(t=>{let e=t.axis.getExtremes(),o=e.min,s=e.max,n=r(t.axis.minPointOffset,0);return i(o)&&i(s)&&t.value>=o-n&&t.value<=s+n&&!t.axis.options.isInternal})[0]},getFieldType:function(t,i){let r=o[t],s=typeof i;return e(r)&&(s=r),({string:"text",number:"number",boolean:"checkbox"})[s]}}}),i(e,"Extensions/Annotations/NavigationBindingsDefaults.js",[e["Extensions/Annotations/NavigationBindingsUtilities.js"],e["Core/Utilities.js"]],function(t,e){let{getAssignedAxis:i}=t,{isNumber:r,merge:o}=e;return{lang:{navigation:{popup:{simpleShapes:"Simple shapes",lines:"Lines",circle:"Circle",ellipse:"Ellipse",rectangle:"Rectangle",label:"Label",shapeOptions:"Shape options",typeOptions:"Details",fill:"Fill",format:"Text",strokeWidth:"Line width",stroke:"Line color",title:"Title",name:"Name",labelOptions:"Label options",labels:"Labels",backgroundColor:"Background color",backgroundColors:"Background colors",borderColor:"Border color",borderRadius:"Border radius",borderWidth:"Border width",style:"Style",padding:"Padding",fontSize:"Font size",color:"Color",height:"Height",shapes:"Shape options"}}},navigation:{bindingsClassName:"highcharts-bindings-container",bindings:{circleAnnotation:{className:"highcharts-circle-annotation",start:function(t){let e=this.chart.pointer?.getCoordinates(t),r=e&&i(e.xAxis),s=e&&i(e.yAxis),n=this.chart.options.navigation;if(r&&s)return this.chart.addAnnotation(o({langKey:"circle",type:"basicAnnotation",shapes:[{type:"circle",point:{x:r.value,y:s.value,xAxis:r.axis.index,yAxis:s.axis.index},r:5}]},n.annotationsOptions,n.bindings.circleAnnotation.annotationsOptions))},steps:[function(t,e){let i;let o=e.options.shapes,s=o&&o[0]&&o[0].point||{};if(r(s.xAxis)&&r(s.yAxis)){let e=this.chart.inverted,r=this.chart.xAxis[s.xAxis].toPixels(s.x),o=this.chart.yAxis[s.yAxis].toPixels(s.y);i=Math.max(Math.sqrt(Math.pow(e?o-t.chartX:r-t.chartX,2)+Math.pow(e?r-t.chartY:o-t.chartY,2)),5)}e.update({shapes:[{r:i}]})}]},ellipseAnnotation:{className:"highcharts-ellipse-annotation",start:function(t){let e=this.chart.pointer?.getCoordinates(t),r=e&&i(e.xAxis),s=e&&i(e.yAxis),n=this.chart.options.navigation;if(r&&s)return this.chart.addAnnotation(o({langKey:"ellipse",type:"basicAnnotation",shapes:[{type:"ellipse",xAxis:r.axis.index,yAxis:s.axis.index,points:[{x:r.value,y:s.value},{x:r.value,y:s.value}],ry:1}]},n.annotationsOptions,n.bindings.ellipseAnnotation.annotationOptions))},steps:[function(t,e){let i=e.shapes[0],r=i.getAbsolutePosition(i.points[1]);i.translatePoint(t.chartX-r.x,t.chartY-r.y,1),i.redraw(!1)},function(t,e){let i=e.shapes[0],r=i.getAbsolutePosition(i.points[0]),o=i.getAbsolutePosition(i.points[1]),s=i.getDistanceFromLine(r,o,t.chartX,t.chartY),n=i.getYAxis(),a=Math.abs(n.toValue(0)-n.toValue(s));i.setYRadius(a),i.redraw(!1)}]},rectangleAnnotation:{className:"highcharts-rectangle-annotation",start:function(t){let e=this.chart.pointer?.getCoordinates(t),r=e&&i(e.xAxis),s=e&&i(e.yAxis);if(!r||!s)return;let n=r.value,a=s.value,l=r.axis.index,h=s.axis.index,c=this.chart.options.navigation;return this.chart.addAnnotation(o({langKey:"rectangle",type:"basicAnnotation",shapes:[{type:"path",points:[{xAxis:l,yAxis:h,x:n,y:a},{xAxis:l,yAxis:h,x:n,y:a},{xAxis:l,yAxis:h,x:n,y:a},{xAxis:l,yAxis:h,x:n,y:a},{command:"Z"}]}]},c.annotationsOptions,c.bindings.rectangleAnnotation.annotationsOptions))},steps:[function(t,e){let r=e.options.shapes,o=r&&r[0]&&r[0].points||[],s=this.chart.pointer?.getCoordinates(t),n=s&&i(s.xAxis),a=s&&i(s.yAxis);if(n&&a){let t=n.value,i=a.value;o[1].x=t,o[2].x=t,o[2].y=i,o[3].y=i,e.update({shapes:[{points:o}]})}}]},labelAnnotation:{className:"highcharts-label-annotation",start:function(t){let e=this.chart.pointer?.getCoordinates(t),r=e&&i(e.xAxis),s=e&&i(e.yAxis),n=this.chart.options.navigation;if(r&&s)return this.chart.addAnnotation(o({langKey:"label",type:"basicAnnotation",labelOptions:{format:"{y:.2f}",overflow:"none",crop:!0},labels:[{point:{xAxis:r.axis.index,yAxis:s.axis.index,x:r.value,y:s.value}}]},n.annotationsOptions,n.bindings.labelAnnotation.annotationsOptions))}}},events:{},annotationsOptions:{animation:{defer:0}}}}}),i(e,"Extensions/Annotations/NavigationBindings.js",[e["Core/Chart/ChartNavigationComposition.js"],e["Core/Defaults.js"],e["Core/Templating.js"],e["Core/Globals.js"],e["Extensions/Annotations/NavigationBindingsDefaults.js"],e["Extensions/Annotations/NavigationBindingsUtilities.js"],e["Core/Utilities.js"]],function(t,e,i,r,o,s,n){let{setOptions:a}=e,{format:l}=i,{composed:h,doc:c,win:d}=r,{getAssignedAxis:u,getFieldType:g}=s,{addEvent:p,attr:f,defined:m,fireEvent:y,isArray:w,isFunction:b,isNumber:C,isObject:S,merge:x,objectEach:E,pick:R,pushUnique:T}=n;function M(){this.chart.navigationBindings&&this.chart.navigationBindings.deselectAnnotation()}function k(){this.navigationBindings&&this.navigationBindings.destroy()}function A(){let t=this.options;t&&t.navigation&&t.navigation.bindings&&(this.navigationBindings=new L(this,t.navigation),this.navigationBindings.initEvents(),this.navigationBindings.initUpdate())}function O(){let t=this.navigationBindings,e="highcharts-disabled-btn";if(this&&t){let i=!1;if(this.series.forEach(t=>{!t.options.isInternal&&t.visible&&(i=!0)}),this.navigationBindings&&this.navigationBindings.container&&this.navigationBindings.container[0]){let r=this.navigationBindings.container[0];E(t.boundClassNames,(t,o)=>{let s=r.querySelectorAll("."+o);if(s)for(let r=0;r<s.length;r++){let o=s[r],n=o.className;"normal"===t.noDataState?-1!==n.indexOf(e)&&o.classList.remove(e):i?-1!==n.indexOf(e)&&o.classList.remove(e):-1===n.indexOf(e)&&(o.className+=" "+e)}})}}}function P(){this.deselectAnnotation()}function I(){this.selectedButtonElement=null}function H(t){let e,i;let r=t.prototype.defaultOptions.events&&t.prototype.defaultOptions.events.click;function o(t){let e=this,i=e.chart.navigationBindings,o=i.activeAnnotation;r&&r.call(e,t),o!==e?(i.deselectAnnotation(),i.activeAnnotation=e,e.setControlPointsVisibility(!0),y(i,"showPopup",{annotation:e,formType:"annotation-toolbar",options:i.annotationToFields(e),onSubmit:function(t){if("remove"===t.actionType)i.activeAnnotation=!1,i.chart.removeAnnotation(e);else{let r={};i.fieldsToOptions(t.fields,r),i.deselectAnnotation();let o=r.typeOptions;"measure"===e.options.type&&(o.crosshairY.enabled=0!==o.crosshairY.strokeWidth,o.crosshairX.enabled=0!==o.crosshairX.strokeWidth),e.update(r)}}})):y(i,"closePopup"),t.activeAnnotation=!0}x(!0,t.prototype.defaultOptions.events,{click:o,touchstart:function(t){e=t.touches[0].clientX,i=t.touches[0].clientY},touchend:function(t){e&&Math.sqrt(Math.pow(e-t.changedTouches[0].clientX,2)+Math.pow(i-t.changedTouches[0].clientY,2))>=4||o.call(this,t)}})}class L{static compose(t,e){T(h,"NavigationBindings")&&(p(t,"remove",M),H(t),E(t.types,t=>{H(t)}),p(e,"destroy",k),p(e,"load",A),p(e,"render",O),p(L,"closePopup",P),p(L,"deselectButton",I),a(o))}constructor(t,e){this.boundClassNames=void 0,this.chart=t,this.options=e,this.eventsToUnbind=[],this.container=this.chart.container.getElementsByClassName(this.options.bindingsClassName||""),this.container.length||(this.container=c.getElementsByClassName(this.options.bindingsClassName||""))}getCoords(t){let e=this.chart.pointer?.getCoordinates(t);return[e&&u(e.xAxis),e&&u(e.yAxis)]}initEvents(){let t=this,e=t.chart,i=t.container,o=t.options;t.boundClassNames={},E(o.bindings||{},e=>{t.boundClassNames[e.className]=e}),[].forEach.call(i,e=>{t.eventsToUnbind.push(p(e,"click",i=>{let r=t.getButtonEvents(e,i);r&&!r.button.classList.contains("highcharts-disabled-btn")&&t.bindingsButtonClick(r.button,r.events,i)}))}),E(o.events||{},(e,i)=>{b(e)&&t.eventsToUnbind.push(p(t,i,e,{passive:!1}))}),t.eventsToUnbind.push(p(e.container,"click",function(i){!e.cancelClick&&e.isInsidePlot(i.chartX-e.plotLeft,i.chartY-e.plotTop,{visiblePlotOnly:!0})&&t.bindingsChartClick(this,i)})),t.eventsToUnbind.push(p(e.container,r.isTouchDevice?"touchmove":"mousemove",function(e){t.bindingsContainerMouseMove(this,e)},r.isTouchDevice?{passive:!1}:void 0))}initUpdate(){let e=this;t.compose(this.chart).navigation.addUpdate(t=>{e.update(t)})}bindingsButtonClick(t,e,i){let r=this.chart,o=r.renderer.boxWrapper,s=!0;this.selectedButtonElement&&(this.selectedButtonElement.classList===t.classList&&(s=!1),y(this,"deselectButton",{button:this.selectedButtonElement}),this.nextEvent&&(this.currentUserDetails&&"annotations"===this.currentUserDetails.coll&&r.removeAnnotation(this.currentUserDetails),this.mouseMoveEvent=this.nextEvent=!1)),s?(this.selectedButton=e,this.selectedButtonElement=t,y(this,"selectButton",{button:t}),e.init&&e.init.call(this,t,i),(e.start||e.steps)&&r.renderer.boxWrapper.addClass("highcharts-draw-mode")):(r.stockTools&&r.stockTools.toggleButtonActiveClass(t),o.removeClass("highcharts-draw-mode"),this.nextEvent=!1,this.mouseMoveEvent=!1,this.selectedButton=null)}bindingsChartClick(t,e){t=this.chart;let i=this.activeAnnotation,r=this.selectedButton,o=t.renderer.boxWrapper;i&&(i.cancelClick||e.activeAnnotation||!e.target.parentNode||function(t,e){let i=d.Element.prototype,r=i.matches||i.msMatchesSelector||i.webkitMatchesSelector,o=null;if(i.closest)o=i.closest.call(t,e);else do{if(r.call(t,e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType)return o}(e.target,".highcharts-popup")?i.cancelClick&&setTimeout(()=>{i.cancelClick=!1},0):y(this,"closePopup")),r&&r.start&&(this.nextEvent?(this.nextEvent(e,this.currentUserDetails),this.steps&&(this.stepIndex++,r.steps[this.stepIndex]?this.mouseMoveEvent=this.nextEvent=r.steps[this.stepIndex]:(y(this,"deselectButton",{button:this.selectedButtonElement}),o.removeClass("highcharts-draw-mode"),r.end&&r.end.call(this,e,this.currentUserDetails),this.nextEvent=!1,this.mouseMoveEvent=!1,this.selectedButton=null))):(this.currentUserDetails=r.start.call(this,e),this.currentUserDetails&&r.steps?(this.stepIndex=0,this.steps=!0,this.mouseMoveEvent=this.nextEvent=r.steps[this.stepIndex]):(y(this,"deselectButton",{button:this.selectedButtonElement}),o.removeClass("highcharts-draw-mode"),this.steps=!1,this.selectedButton=null,r.end&&r.end.call(this,e,this.currentUserDetails))))}bindingsContainerMouseMove(t,e){this.mouseMoveEvent&&this.mouseMoveEvent(e,this.currentUserDetails)}fieldsToOptions(t,e){return E(t,(t,i)=>{let r=parseFloat(t),o=i.split("."),s=o.length-1;if(!C(r)||t.match(/px|em/g)||i.match(/format/g)||(t=r),"undefined"!==t){let i=e;o.forEach((e,r)=>{if("__proto__"!==e&&"constructor"!==e){let n=R(o[r+1],"");s===r?i[e]=t:(i[e]||(i[e]=n.match(/\d/g)?[]:{}),i=i[e])}})}}),e}deselectAnnotation(){this.activeAnnotation&&(this.activeAnnotation.setControlPointsVisibility(!1),this.activeAnnotation=!1)}annotationToFields(t){let e=t.options,i=L.annotationsEditable,r=i.nestedOptions,o=R(e.type,e.shapes&&e.shapes[0]&&e.shapes[0].type,e.labels&&e.labels[0]&&e.labels[0].type,"label"),s=L.annotationsNonEditable[e.langKey]||[],n={langKey:e.langKey,type:o};function a(e,i,o,n,h){let c;o&&m(e)&&-1===s.indexOf(i)&&((o.indexOf&&o.indexOf(i))>=0||o[i]||!0===o)&&(w(e)?(n[i]=[],e.forEach((t,e)=>{S(t)?(n[i][e]={},E(t,(t,o)=>{a(t,o,r[i],n[i][e],i)})):a(t,0,r[i],n[i],i)})):S(e)?(c={},w(n)?(n.push(c),c[i]={},c=c[i]):n[i]=c,E(e,(t,e)=>{a(t,e,0===i?o:r[i],c,i)})):"format"===i?n[i]=[l(e,t.labels[0].points[0]).toString(),"text"]:w(n)?n.push([e,g(h,e)]):n[i]=[e,g(i,e)])}return E(e,(t,s)=>{"typeOptions"===s?(n[s]={},E(e[s],(t,e)=>{a(t,e,r,n[s],e)})):a(t,s,i[o],n,s)}),n}getClickedClassNames(t,e){let i=e.target,r=[],o;for(;i&&i.tagName&&((o=f(i,"class"))&&(r=r.concat(o.split(" ").map(t=>[t,i]))),(i=i.parentNode)!==t););return r}getButtonEvents(t,e){let i;let r=this;return this.getClickedClassNames(t,e).forEach(t=>{r.boundClassNames[t[0]]&&!i&&(i={events:r.boundClassNames[t[0]],button:t[1]})}),i}update(t){this.options=x(!0,this.options,t),this.removeEvents(),this.initEvents()}removeEvents(){this.eventsToUnbind.forEach(t=>t())}destroy(){this.removeEvents()}}return L.annotationsEditable={nestedOptions:{labelOptions:["style","format","backgroundColor"],labels:["style"],label:["style"],style:["fontSize","color"],background:["fill","strokeWidth","stroke"],innerBackground:["fill","strokeWidth","stroke"],outerBackground:["fill","strokeWidth","stroke"],shapeOptions:["fill","strokeWidth","stroke"],shapes:["fill","strokeWidth","stroke"],line:["strokeWidth","stroke"],backgroundColors:[!0],connector:["fill","strokeWidth","stroke"],crosshairX:["strokeWidth","stroke"],crosshairY:["strokeWidth","stroke"]},circle:["shapes"],ellipse:["shapes"],verticalLine:[],label:["labelOptions"],measure:["background","crosshairY","crosshairX"],fibonacci:[],tunnel:["background","line","height"],pitchfork:["innerBackground","outerBackground"],rect:["shapes"],crookedLine:[],basicAnnotation:["shapes","labelOptions"]},L.annotationsNonEditable={rectangle:["crosshairX","crosshairY","labelOptions"],ellipse:["labelOptions"],circle:["labelOptions"]},L}),i(e,"masters/modules/annotations.src.js",[e["Core/Globals.js"],e["Extensions/Annotations/Annotation.js"],e["Extensions/Annotations/NavigationBindings.js"]],function(t,e,i){return t.Annotation=t.Annotation||e,t.NavigationBindings=t.NavigationBindings||i,t.Annotation.compose(t.Chart,t.NavigationBindings,t.Pointer,t.SVGRenderer),t})},ES?(W.default=W,ES=W):"function"==typeof define&&define.amd?define("highcharts/modules/annotations",["highcharts"],function(t){return W(t),W.Highcharts=t,W}):W("undefined"!=typeof Highcharts?Highcharts:void 0);var Ex={};n="millisecond",a="second",l="minute",h="hour",c="week",d="month",u="quarter",g="year",p="date",f="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w=function(t,e,i){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(i)+t},(C={})[b="en"]={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],i=t%100;return"["+t+(e[(i-20)%10]||e[i]||"th")+"]"}},S="$isDayjsObject",x=function(t){return t instanceof M||!(!t||!t[S])},E=function t(e,i,r){var o;if(!e)return b;if("string"==typeof e){var s=e.toLowerCase();C[s]&&(o=s),i&&(C[s]=i,o=s);var n=e.split("-");if(!o&&n.length>1)return t(n[0])}else{var a=e.name;C[a]=e,o=a}return!r&&o&&(b=o),o||!r&&b},R=function(t,e){if(x(t))return t.clone();var i="object"==typeof e?e:{};return i.date=t,i.args=arguments,new M(i)},(T={s:w,z:function(t){var e=-t.utcOffset(),i=Math.abs(e);return(e<=0?"+":"-")+w(Math.floor(i/60),2,"0")+":"+w(i%60,2,"0")},m:function t(e,i){if(e.date()<i.date())return-t(i,e);var r=12*(i.year()-e.year())+(i.month()-e.month()),o=e.clone().add(r,d),s=i-o<0,n=e.clone().add(r+(s?-1:1),d);return+(-(r+(i-o)/(s?o-n:n-o))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return({M:d,y:g,w:c,d:"day",D:p,h:h,m:l,s:a,ms:n,Q:u})[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}}).l=E,T.i=x,T.w=function(t,e){return R(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})},k=(M=function(){function t(t){this.$L=E(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[S]=!0}var e=t.prototype;return e.parse=function(t){this.$d=function(t){var e=t.date,i=t.utc;if(null===e)return new Date(NaN);if(T.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(m);if(r){var o=r[2]-1||0,s=(r[7]||"0").substring(0,3);return i?new Date(Date.UTC(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(e)}(t),this.init()},e.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},e.$utils=function(){return T},e.isValid=function(){return this.$d.toString()!==f},e.isSame=function(t,e){var i=R(t);return this.startOf(e)<=i&&i<=this.endOf(e)},e.isAfter=function(t,e){return R(t)<this.startOf(e)},e.isBefore=function(t,e){return this.endOf(e)<R(t)},e.$g=function(t,e,i){return T.u(t)?this[e]:this.set(i,t)},e.unix=function(){return Math.floor(this.valueOf()/1e3)},e.valueOf=function(){return this.$d.getTime()},e.startOf=function(t,e){var i=this,r=!!T.u(e)||e,o=T.p(t),s=function(t,e){var o=T.w(i.$u?Date.UTC(i.$y,e,t):new Date(i.$y,e,t),i);return r?o:o.endOf("day")},n=function(t,e){return T.w(i.toDate()[t].apply(i.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),i)},u=this.$W,f=this.$M,m=this.$D,y="set"+(this.$u?"UTC":"");switch(o){case g:return r?s(1,0):s(31,11);case d:return r?s(1,f):s(0,f+1);case c:var w=this.$locale().weekStart||0,b=(u<w?u+7:u)-w;return s(r?m-b:m+(6-b),f);case"day":case p:return n(y+"Hours",0);case h:return n(y+"Minutes",1);case l:return n(y+"Seconds",2);case a:return n(y+"Milliseconds",3);default:return this.clone()}},e.endOf=function(t){return this.startOf(t,!1)},e.$set=function(t,e){var i,r=T.p(t),o="set"+(this.$u?"UTC":""),s=((i={}).day=o+"Date",i[p]=o+"Date",i[d]=o+"Month",i[g]=o+"FullYear",i[h]=o+"Hours",i[l]=o+"Minutes",i[a]=o+"Seconds",i[n]=o+"Milliseconds",i)[r],c="day"===r?this.$D+(e-this.$W):e;if(r===d||r===g){var u=this.clone().set(p,1);u.$d[s](c),u.init(),this.$d=u.set(p,Math.min(this.$D,u.daysInMonth())).$d}else s&&this.$d[s](c);return this.init(),this},e.set=function(t,e){return this.clone().$set(t,e)},e.get=function(t){return this[T.p(t)]()},e.add=function(t,e){var i,r=this;t=Number(t);var o=T.p(e),s=function(e){var i=R(r);return T.w(i.date(i.date()+Math.round(e*t)),r)};if(o===d)return this.set(d,this.$M+t);if(o===g)return this.set(g,this.$y+t);if("day"===o)return s(1);if(o===c)return s(7);var n=((i={})[l]=6e4,i[h]=36e5,i[a]=1e3,i)[o]||1,u=this.$d.getTime()+t*n;return T.w(u,this)},e.subtract=function(t,e){return this.add(-1*t,e)},e.format=function(t){var e=this,i=this.$locale();if(!this.isValid())return i.invalidDate||f;var r=t||"YYYY-MM-DDTHH:mm:ssZ",o=T.z(this),s=this.$H,n=this.$m,a=this.$M,l=i.weekdays,h=i.months,c=i.meridiem,d=function(t,i,o,s){return t&&(t[i]||t(e,r))||o[i].slice(0,s)},u=function(t){return T.s(s%12||12,t,"0")},g=c||function(t,e,i){var r=t<12?"AM":"PM";return i?r.toLowerCase():r};return r.replace(y,function(t,r){return r||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return T.s(e.$y,4,"0");case"M":return a+1;case"MM":return T.s(a+1,2,"0");case"MMM":return d(i.monthsShort,a,h,3);case"MMMM":return d(h,a);case"D":return e.$D;case"DD":return T.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return d(i.weekdaysMin,e.$W,l,2);case"ddd":return d(i.weekdaysShort,e.$W,l,3);case"dddd":return l[e.$W];case"H":return String(s);case"HH":return T.s(s,2,"0");case"h":return u(1);case"hh":return u(2);case"a":return g(s,n,!0);case"A":return g(s,n,!1);case"m":return String(n);case"mm":return T.s(n,2,"0");case"s":return String(e.$s);case"ss":return T.s(e.$s,2,"0");case"SSS":return T.s(e.$ms,3,"0");case"Z":return o}return null}(t)||o.replace(":","")})},e.utcOffset=function(){return-(15*Math.round(this.$d.getTimezoneOffset()/15))},e.diff=function(t,e,i){var r,o=this,s=T.p(e),n=R(t),p=(n.utcOffset()-this.utcOffset())*6e4,f=this-n,m=function(){return T.m(o,n)};switch(s){case g:r=m()/12;break;case d:r=m();break;case u:r=m()/3;break;case c:r=(f-p)/6048e5;break;case"day":r=(f-p)/864e5;break;case h:r=f/36e5;break;case l:r=f/6e4;break;case a:r=f/1e3;break;default:r=f}return i?r:T.a(r)},e.daysInMonth=function(){return this.endOf(d).$D},e.$locale=function(){return C[this.$L]},e.locale=function(t,e){if(!t)return this.$L;var i=this.clone(),r=E(t,e,!0);return r&&(i.$L=r),i},e.clone=function(){return T.w(this.$d,this)},e.toDate=function(){return new Date(this.valueOf())},e.toJSON=function(){return this.isValid()?this.toISOString():null},e.toISOString=function(){return this.$d.toISOString()},e.toString=function(){return this.$d.toUTCString()},t}()).prototype,R.prototype=k,[["$ms",n],["$s",a],["$m",l],["$H",h],["$W","day"],["$M",d],["$y",g],["$D",p]].forEach(function(t){k[t[1]]=function(e){return this.$g(e,t[0],t[1])}}),R.extend=function(t,e){return t.$i||(t(e,M,R),t.$i=!0),R},R.locale=E,R.isDayjs=x,R.unix=function(t){return R(1e3*t)},R.en=C[b],R.Ls=C,R.p={},Ex=R,(V=te||(te={}))[V.NORMAL=0]="NORMAL",V[V.RUN_OF_EIGHT_EXCEPTION=1]="RUN_OF_EIGHT_EXCEPTION",V[V.FOUR_NEAR_LIMIT_EXCEPTION=2]="FOUR_NEAR_LIMIT_EXCEPTION",V[V.NPL_EXCEPTION=3]="NPL_EXCEPTION",(U=ti||(ti={}))[U.UNLOCKED=0]="UNLOCKED",U[U.LOCKED=1]="LOCKED",U[U.UNPL_MODIFIED=2]="UNPL_MODIFIED",U[U.LNPL_MODIFIED=4]="LNPL_MODIFIED",U[U.AVGX_MODIFIED=8]="AVGX_MODIFIED";const EE="rgb(87 83 78)",ER={avgX:0,LNPL:1/0,UNPL:-1/0,avgMovement:0,URL:-1/0},ET={tableData:[],lockedLimitBaseData:[],xLabel:"Date",yLabel:"Value",xdata:[],movements:[],dividerLines:[],lockedLimits:structuredClone(ER),lockedLimitStatus:0};function EM(t,e){if(t.length<8)return;let i=0;for(let r=0;r<7;r++)t[r].value>e&&(i|=1<<r%8);for(let r=7;r<t.length;r++)if(t[r].value>e?i|=1<<r%8:i&=~(1<<r%8),0==i||255==i)for(let e=r-7;e<=r;e++)t[e].status=1}function Ek(t,e,i){if(t.length<4)return;let r=0,o=0;for(let s=0;s<3;s++)t[s].value<e?r+=1:t[s].value>i&&(o+=1);for(let s=3;s<t.length;s++){if(t[s].value<e?r+=1:t[s].value>i&&(o+=1),r>=3||o>=3)for(let e=s-3;e<=s;e++)t[e].status=2;t[s-3].value<e?r-=1:t[s-3].value>i&&(o-=1)}}function EA(t,e,i){t.forEach(t=>{t.value<e?t.status=3:t.value>i&&(t.status=3)})}function EO(t){return{type:"line",color:EE,name:"",data:t,dataLabels:{enabled:!0,style:{color:EE}},marker:{symbol:"circle"}}}function EP(t){return t.map(t=>t.map(t=>({x:EY(t.x),y:t.value,color:function(t){switch(t){case 1:return"blue";case 2:return"orange";case 3:return"red";default:return"black"}}(t.status),dataLabels:{style:{color:function(t){switch(t){case 1:return"blue";case 2:return"#be5504";case 3:return"#e3242b";default:return"black"}}(t.status),textOutline:0}}})))}function EI(){let e=ET.dividerLines.length-2;if(e>=3)return;let i=t.xAxis[0].toValue(t.plotWidth*(e+1)/4);i%10&&(i+=1);let r={id:`divider-${e+1}`,x:i,line:null};ET.dividerLines.push(r),EL(r)}function EH(i=!0){let r=function(){var t;let e,i,r=ET.dividerLines;r.sort((t,e)=>t.x-e.x),console.assert(r.length>=2,"dividerLines should contain at least two divider lines"),EG(ET.xdata,ET.tableData.filter(t=>t.x&&(t.value||0==t.value)));let{min:o,max:s}=(t=ET.xdata,e=1/0,i=-1/0,t.forEach(t=>{let r=EY(t.x);e=Math.min(e,r),i=Math.max(i,r)}),{min:e,max:i});r[0].x=o,r[r.length-1].x=s;let n={xchartMin:1/0,xchartMax:-1/0,mrchartMax:-1/0,lineValues:[],xdataPerRange:[],movementsPerRange:[]},a=[],l=[];for(let t=0;t<r.length-1;t++){let e=r[t].x,i=r[t+1].x,o=ET.xdata.filter(t=>EY(t.x)>=e&&EY(t.x)<=i),s=EN(o);if(0===o.length){console.log(`No data in range ${e} - ${i}`);continue}let{avgX:h,avgMovement:c,UNPL:d,LNPL:u,URL:g,lowerQuartile:p,upperQuartile:f}=EF(o),m={xLeft:e,xRight:i,avgX:h,avgMovement:c,UNPL:d,LNPL:u,URL:g,lowerQuartile:p,upperQuartile:f};if(n.lineValues.push(m),n.xchartMin=Math.min(n.xchartMin,u),n.xchartMax=Math.max(n.xchartMax,d),n.mrchartMax=Math.max(n.mrchartMax,g),o.forEach(t=>t.status=0),0==t&&EX()){let t=EU();EM(o,ET.lockedLimits.avgX),Ek(o,t.useLowerQuartile?ET.lockedLimits.lowerQuartile:-1/0,t.useUpperQuartile?ET.lockedLimits.upperQuartile:1/0),EA(o,ET.lockedLimits.LNPL,ET.lockedLimits.UNPL)}else EM(o,h),Ek(o,p,f),EA(o,u,d);a=a.concat(o),n.xdataPerRange.push(o),s.forEach(t=>t.status=0),0==t&&EX()?EA(s,0,ET.lockedLimits.URL):EA(s,0,g),l=l.concat(s),n.movementsPerRange.push(s)}return EG(ET.xdata,a),EG(ET.movements,l),ET.xdata.forEach(t=>{t.value>n.xchartMax&&(n.xchartMax=t.value),t.value<n.xchartMin&&(n.xchartMin=t.value)}),ET.movements.forEach(t=>{t.value>n.mrchartMax&&(n.mrchartMax=t.value)}),EX()&&(n.xchartMax=Math.max(n.xchartMax,ET.lockedLimits.UNPL),n.xchartMin=Math.min(n.xchartMin,ET.lockedLimits.LNPL),n.mrchartMax=Math.max(n.mrchartMax,ET.lockedLimits.URL)),n}();return!function(i,r=!0){t.update({series:EP(i.xdataPerRange).map(EO)},r,!0),e.update({series:EP(i.movementsPerRange).map(EO)},r,!0)}(r,i),function(i,r=!0){function o(t){return{point:t.points[1],shape:"connector",align:"left"}}let s=[],n=[];for(let r=0;r<i.lineValues.length;r++){let o=i.lineValues[r];r==i.lineValues.length-1&&(o.xRight=o.xRight+Math.max(864e5,(Math.min(t.xAxis[0].max,e.xAxis[0].max)-o.xRight)/5));let a=2,l="steelblue",h="ShortDash",c={useUpperQuartile:!0,useLowerQuartile:!0};if(0==r&&EX()&&(c=EU(),ET.lockedLimits.xLeft=o.xLeft,ET.lockedLimits.xRight=o.xRight,o=ET.lockedLimits,a=3,h="Solid"),c.useLowerQuartile){let t={points:[{x:o.xLeft,y:o.lowerQuartile,xAxis:0,yAxis:0},{x:o.xRight,y:o.lowerQuartile,xAxis:0,yAxis:0}],type:"path",dashStyle:"Dot",strokeWidth:1};s.push(t)}if(c.useUpperQuartile){let t={points:[{x:o.xLeft,y:o.upperQuartile,xAxis:0,yAxis:0},{x:o.xRight,y:o.upperQuartile,xAxis:0,yAxis:0}],type:"path",dashStyle:"Dot",strokeWidth:1};s.push(t)}let d={points:[{x:o.xLeft,y:o.avgX,xAxis:0,yAxis:0},{x:o.xRight,y:o.avgX,xAxis:0,yAxis:0}],type:"path",dashStyle:h,stroke:"red",strokeWidth:a},u={points:[{x:o.xLeft,y:o.LNPL,xAxis:0,yAxis:0},{x:o.xRight,y:o.LNPL,xAxis:0,yAxis:0}],type:"path",dashStyle:h,stroke:l,strokeWidth:a},g={points:[{x:o.xLeft,y:o.UNPL,xAxis:0,yAxis:0},{x:o.xRight,y:o.UNPL,xAxis:0,yAxis:0}],type:"path",dashStyle:h,stroke:l,strokeWidth:a};s.push(d,u,g);let p={points:[{x:o.xLeft,y:o.avgMovement,xAxis:0,yAxis:0},{x:o.xRight,y:o.avgMovement,xAxis:0,yAxis:0}],type:"path",dashStyle:h,stroke:"red",strokeWidth:a},f={points:[{x:o.xLeft,y:o.URL,xAxis:0,yAxis:0},{x:o.xRight,y:o.URL,xAxis:0,yAxis:0}],type:"path",dashStyle:h,stroke:l,strokeWidth:a};n.push(p,f)}t.yAxis[0].setExtremes(i.xchartMin-(i.xchartMax-i.xchartMin)*.1,i.xchartMax+(i.xchartMax-i.xchartMin)*.1,!1),e.yAxis[0].setExtremes(0,1.1*i.mrchartMax,!1),t.removeAnnotation("limit-lines"),t.addAnnotation({id:"limit-lines",animation:{defer:0},draggable:"",shapes:s,labels:s.map(t=>o(t)).slice(-3),zIndex:1},!1),e.removeAnnotation("limit-lines"),e.addAnnotation({id:"limit-lines",animation:{defer:0},draggable:"",shapes:n,labels:n.map(t=>o(t)).slice(-2),zIndex:1},!1),t.redraw(r),e.redraw(r)}(r,i),ET.dividerLines.length>2?document.querySelector("#remove-divider").classList.remove("text-slate-400"):document.querySelector("#remove-divider").classList.add("text-slate-400"),ET.dividerLines.length<5?(document.querySelector("#add-divider").classList.remove("bg-slate-700"),document.querySelector("#add-divider").classList.remove("hover:bg-slate-600")):(document.querySelector("#add-divider").classList.add("bg-slate-700"),document.querySelector("#add-divider").classList.add("hover:bg-slate-600")),r}function EL(i){E6(i)||(EH(!1),t.removeAnnotation(i.id),i.line=t.addAnnotation({id:i.id,animation:{defer:0},events:{afterUpdate:function(t){for(let e of ET.dividerLines)if(e.line==t.target){e.x=t.target.options.shapes[0].points[0].x;break}EH()}},shapes:[{points:[{x:i.x,y:-9e15,xAxis:0,yAxis:0},{x:i.x,y:9e15,xAxis:0,yAxis:0}],type:"path",stroke:"purple",strokeWidth:4}],draggable:"x",zIndex:2},!1),t.redraw(!0),e.redraw(!0))}function ED(){let e=`divider-${ET.dividerLines.length-2}`;t.removeAnnotation(e),ET.dividerLines=ET.dividerLines.filter(t=>t.id!=e),EH()}function EN(t){let e=[];for(let i=1;i<t.length;i++){let r=E3(Math.abs(t[i].value-t[i-1].value));e.push({order:t[i].order,x:t[i].x,value:r})}return e}function E_(){let r=r=>{let o=prompt("Insert a new column name",ET.yLabel);if(o){let r=i.getColHeader();r[1]=o,ET.yLabel=o,i.updateSettings({colHeaders:r}),t.update({yAxis:{title:{text:E2(o),useHTML:!0}},title:{text:E0(),useHTML:!0}}),e.update({yAxis:{title:{text:E2(o),useHTML:!0}},title:{text:E1(),useHTML:!0}}),E_()}};document.querySelectorAll(".axis-label-y").forEach(t=>t.addEventListener("click",r)),document.querySelectorAll(".plot-title").forEach(t=>t.addEventListener("click",r))}function EF(t){let e=EN(t),i=t.reduce((t,e)=>t+e.value,0)/t.length,r=e.reduce((t,e)=>t+e.value,0)/Math.max(e.length,1),o=i+2.66*r,s=i-2.66*r;return{avgX:E3(i),avgMovement:E3(r),UNPL:E3(o),LNPL:E3(s),URL:E3(3.268*r),lowerQuartile:E3((s+i)/2),upperQuartile:E3((o+i)/2)}}function Ej(){return EF(ET.lockedLimitBaseData.filter(t=>t.x&&(t.value||0==t.value)))}function EB(t){let e=Ej();document.querySelectorAll(".lock-limit-input").forEach(i=>{i.value=t?e[i.dataset.limit]:ET.lockedLimits[i.dataset.limit]}),t&&(ET.lockedLimitStatus&=-9,ET.lockedLimitStatus&=-5,ET.lockedLimitStatus&=-3),document.querySelector('.lock-limit-input[data-limit="avgX"]').style.color=(8&ET.lockedLimitStatus)==8?"rgb(220 38 38)":"black",document.querySelector('.lock-limit-input[data-limit="avgX"]').placeholder=`${e.avgX}`,document.querySelector('.lock-limit-input[data-limit="UNPL"]').style.color=(2&ET.lockedLimitStatus)==2?"rgb(220 38 38)":"black",document.querySelector('.lock-limit-input[data-limit="UNPL"]').placeholder=`${e.UNPL}`,document.querySelector('.lock-limit-input[data-limit="LNPL"]').style.color=(4&ET.lockedLimitStatus)==4?"rgb(220 38 38)":"black",document.querySelector('.lock-limit-input[data-limit="LNPL"]').placeholder=`${e.LNPL}`,document.querySelector('.lock-limit-input[data-limit="avgMovement"]').placeholder=`${e.avgMovement}`,document.querySelector('.lock-limit-input[data-limit="URL"]').placeholder=`${e.URL}`}function EW(t,e,i,r){if(1==e.from.col)return t;let o=t.map(t=>new Date(EY(t[0]))),s=864e5;if(o.length>=2){s=o[1].valueOf()-o[0].valueOf();for(let e=2;e<o.length;e++)if(o[e].valueOf()-o[e-1].valueOf()!=s)return t}let n=[];if(o.length<2){if("down"==r){n=o.map(t=>new Date(new Date(t.valueOf()).setDate(t.getDate()+1)));for(let t=n.length;t<=i.to.row-i.from.row;t++){let t=n[n.length-1];n.push(new Date(new Date(t.valueOf()).setDate(t.getDate()+1)))}}else if("up"==r){n=o.map(t=>new Date(new Date(t.valueOf()).setDate(t.getDate()-1)));for(let t=n.length;t<=i.to.row-i.from.row;t++){let t=n[0];n=[new Date(new Date(t.valueOf()).setDate(t.getDate()-1)),...n]}}return n.map(t=>[Ez(t)])}if("down"==r){n=o.map(t=>new Date(t.valueOf()+o.length*s));for(let t=n.length;t<=i.to.row-i.from.row;t++)n.push(new Date(n[n.length-1].valueOf()+s))}else if("up"==r){n=o.map(t=>new Date(t.valueOf()-o.length*s));for(let t=n.length;t<=i.to.row-i.from.row;t++)n=[new Date(n[0].valueOf()-s),...n]}return n.map(t=>[Ez(t)])}function EV(t,e){if(e.length>1)return;let i=e[0];for(let e=i.startRow+t.length;e<=i.endRow;e++)t.push(["",""])}function EU(){if((-2&ET.lockedLimitStatus)==0)return{useUpperQuartile:!0,useLowerQuartile:!0};if((4&ET.lockedLimitStatus)==4&&(2&ET.lockedLimitStatus)==2||(8&ET.lockedLimitStatus)==8){var t;return(t=ET.lockedLimits.avgX,.001>Math.abs(ET.lockedLimits.UNPL+ET.lockedLimits.LNPL-2*t))?{useUpperQuartile:!0,useLowerQuartile:!0}:{useUpperQuartile:!1,useLowerQuartile:!1}}return(2&ET.lockedLimitStatus)==2?{useUpperQuartile:!1,useLowerQuartile:!0}:(4&ET.lockedLimitStatus)==4?{useUpperQuartile:!0,useLowerQuartile:!1}:(console.assert(!1),{useUpperQuartile:!0,useLowerQuartile:!0})}function Ez(t){let e=t.getTimezoneOffset();return(t=new Date(t.getTime()-6e4*e)).toISOString().slice(0,10)}function EY(t){return o(Ex)(t).valueOf()}function EG(t,e){t.splice(0,t.length,...E$(e))}function E$(t){return t.map(t=>({x:t.x,value:t.value,order:t.order,status:t.status}))}function EX(){return(1&ET.lockedLimitStatus)==1}function Eq(t){let e=new ArrayBuffer(4*t.length),i=new DataView(e);return t.forEach((t,e)=>{i.setFloat32(4*e,t)}),EK(new Uint8Array(e).reduce((t,e)=>t+String.fromCharCode(e),""))}function EK(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function EZ(t){return atob(t.replace(/-/g,"+").replace(/_/g,"/"))}function EQ(t){let e=EZ(t);var i=new Uint8Array(e.length);for(let t=0;t<e.length;t++)i[t]=e.charCodeAt(t);let r=new DataView(i.buffer),o=[];for(let t=0;t<i.length/4;t++)o.push(r.getFloat32(4*t));return o}function EJ(){!function(i,r){function o(t,e){return Ew.chart(t,{chart:{type:"line",scrollablePlotArea:{minWidth:600},plotBackgroundImage:"../xmrit-bg.png"},time:{useUTC:!1},title:{text:t===i?E0():E1(),useHTML:!0},plotOptions:{series:{stickyTracking:!1}},series:EP(e).map(EO),yAxis:{title:{text:`<div class="axis-label-y">${ET.yLabel}</div>`,useHTML:!0},gridLineWidth:0},xAxis:{type:"datetime",title:{text:ET.xLabel},maxPadding:.2},legend:{enabled:!1},credits:{enabled:!1},exporting:{buttons:{contextButton:{enabled:!1,menuItems:["downloadPNG","downloadJPEG","downloadSVG"]}},fallbackToExportServer:!1,allowHTML:!0}})}EG(ET.xdata,ET.tableData.filter(t=>t.x&&(t.value||0==t.value))),EG(ET.movements,EN(ET.xdata)),t=o(i,[ET.xdata]),e=o(r,[ET.movements]),ET.dividerLines=ET.dividerLines.filter(t=>!E6(t)).concat([{id:"divider-start",x:t.xAxis[0].min,line:null},{id:"divider-end",x:Math.min(t.xAxis[0].max,e.xAxis[0].max||1/0),line:null}]),ET.dividerLines.forEach(EL),EH()}("xplot","mrplot")}window.matchMedia("(max-width: 767px)").addEventListener("change",t=>{EH()}),screen.orientation.addEventListener("change",t=>{EH()}),document.addEventListener("DOMContentLoaded",function(s){let n=new URLSearchParams(window.location.search);if(n.has("d")){n.get("v");let t=n.get("s")||"",e=n.get("l")||"",{xLabel:i,yLabel:r,data:s,dividerLines:a,lockedLimits:l,lockedLimitStatus:h}=function(t,e,i,r){e=decodeURIComponent(e),i=decodeURIComponent(i);let[s,n]=e.split(".",2),a=o(Ev).decompress(EZ(s)),l=EQ(n),h=a.split(",").map(t=>t.replace(";",",")),c=h.splice(0,2),d=h.map((t,e)=>({order:e,x:t,value:E3(l[e]),status:0})),u=[];i?.length>0&&(u=u.concat(EQ(i).map((t,e)=>({id:`divider-${e+1}`,x:t,line:null}))));let g=structuredClone(ER),p=0;if(r?.length>0){let[t,e,i,o,s,...n]=EQ(r).map(E3);n.length>0&&(p=n[0]),g={avgX:t,avgMovement:e,LNPL:i,UNPL:o,URL:s,lowerQuartile:(t+i)/2,upperQuartile:(t+o)/2}}return{xLabel:c[0].replace(";",","),yLabel:c[1].replace(";",","),data:d,dividerLines:u,lockedLimits:g,lockedLimitStatus:p}}(0,n.get("d"),t,e);ET.xLabel=i,ET.yLabel=r,ET.tableData=s,ET.dividerLines=a,ET.lockedLimits=l,ET.lockedLimitStatus=h}else{let t=[5045,4350,4350,3975,4290,4430,4485,4285,3980,3925,3645,3760,3300,3685,3463,5200].map(function(t,e){return{order:e,x:`2020-01-${(e<9?"0":"")+(e+1)}`,value:t,status:0}});ET.tableData=t}ET.lockedLimitBaseData=E$(ET.tableData),EJ(),document.querySelector("#add-divider").addEventListener("click",EI),document.querySelector("#remove-divider").addEventListener("click",ED),document.querySelector("#export-xplot").addEventListener("click",()=>{EJ(),t.exportChartLocal({filename:"xplot"})}),document.querySelector("#export-mrplot").addEventListener("click",()=>{EJ(),e.exportChartLocal({filename:"mrplot"})}),E_(),EX()&&(document.querySelectorAll(".lock-limit-remove").forEach(t=>t.classList.remove("hidden")),document.querySelector("#lock-limit-warning").classList.remove("hidden")),document.querySelector("#lock-limit-btn").addEventListener("click",t=>{EX()||(EG(ET.lockedLimitBaseData,ET.tableData),r.updateSettings({data:ET.lockedLimitBaseData,colHeaders:[ET.xLabel,ET.yLabel]})),EB(!EX()),document.querySelector("#lock-limit-dialog").showModal()}),document.querySelector("#lock-limit-close").addEventListener("click",t=>{document.querySelector("#lock-limit-dialog").close()}),document.querySelectorAll(".lock-limit-remove").forEach(i=>i.addEventListener("click",r=>{t.removeAnnotation("locked-limits"),e.removeAnnotation("locked-limits"),i.classList.add("hidden"),document.querySelector("#lock-limit-warning").classList.add("hidden"),ET.lockedLimitStatus&=-2,EH(),document.querySelector("#lock-limit-dialog").close()})),document.querySelector("#lock-limit-add").addEventListener("click",t=>{let e=Ej(),i=structuredClone(ER);if(document.querySelectorAll(".lock-limit-input").forEach(t=>{i[t.dataset.limit]=""!==t.value?Number(t.value):e[t.dataset.limit]}),i.lowerQuartile=E3((i.avgX+i.LNPL)/2),i.upperQuartile=E3((i.avgX+i.UNPL)/2),i.avgX<i.LNPL||i.avgX>i.UNPL||i.avgMovement>i.URL){alert("Please ensure that the following limits are satisfied:\n1. Average X is between Lower Natural Process Limit (LNPL) and Upper Natural Process Limit (UNPL)\n2. Average Movement is less than or equal to Upper Range Limit (URL)");return}e.avgX!=i.avgX&&(ET.lockedLimitStatus|=8),e.LNPL!=i.LNPL&&(ET.lockedLimitStatus|=4),e.UNPL!=i.UNPL&&(ET.lockedLimitStatus|=2),ET.lockedLimits=i,ET.lockedLimitStatus|=1,EH(),document.querySelector("#lock-limit-dialog").close(),document.querySelectorAll(".lock-limit-remove").forEach(t=>t.classList.remove("hidden")),document.querySelector("#lock-limit-warning").classList.remove("hidden")}),r=new hD(document.querySelector("#lock-limit-dataTable"),{data:ET.lockedLimitBaseData,dataSchema:{x:null,value:null},columns:[{data:"x",type:"date",dateFormat:"YYYY-MM-DD",validator:(t,e)=>{if(!t){e(!0);return}let i=new Date(EY(t));e(i instanceof Date&&!isNaN(i.getTime()))}},{data:"value",type:"numeric"}],colHeaders:[ET.xLabel,ET.yLabel],contextMenu:!0,allowRemoveColumn:!1,minSpareRows:1,height:"auto",stretchH:"all",fillHandle:{autoInsertRow:!0,direction:"vertical"},beforeAutofill:(t,e,i,r)=>EW(t,e,i,r),beforePaste:(t,e)=>EV(t,e),afterChange(t,e){"loadData"!==e&&EB(!0)},afterValidate(t,e,i,r,o){let s=document.getElementById("data-table-error");if(t){s.classList.add("hidden");return}return s.classList.remove("hidden"),!1},licenseKey:"non-commercial-and-evaluation"});let a=document.getElementById("csv-file");a.addEventListener("change",t=>{if(!a.files?.length){console.log("No file input");return}let e=a.files[0],r=new FileReader;r.addEventListener("loadend",()=>{let{passed:t,multiplier:e,xLabel:o,yLabel:s,xdata:n}=function(t,e=","){let i="",r="",o=0,s=[],n=t.indexOf("\r\n");if(-1==n){let t=document.getElementById("file-error");return t.style.display="block",t.innerText="Missing CSV labels and/or data.",{passed:!1,multiplier:o,xLabel:i,yLabel:r,xdata:s}}let a=t.slice(0,n).split(e);if(a.length<2){let t=document.getElementById("file-error");return t.style.display="block",t.innerText="First row of CSV must have 2 columns.",{passed:!1,multiplier:o,xLabel:i,yLabel:r,xdata:s}}if(""===a[0]||""===a[1]){let t=document.getElementById("file-error");return t.style.display="block",t.innerText="Missing CSV label(s).",{passed:!1,multiplier:o,xLabel:i,yLabel:r,xdata:s}}if("date"!=a[0].toLowerCase()){let t=document.getElementById("file-error");return t.style.display="block",t.innerText="First column of CSV must be 'Date'.",{passed:!1,multiplier:o,xLabel:i,yLabel:r,xdata:s}}i="Date",r=a[1];let l=t.slice(n+2).split("\r\n");if(0==l.length){let t=document.getElementById("file-error");return t.style.display="block",t.innerText="Missing CSV data.",{passed:!1,multiplier:o,xLabel:i,yLabel:r,xdata:s}}for(let t=0;t<l.length;t++){let n=l[t].split(e);if(""===n[0]||""===n[1]){if(""!==l.slice(t+1).join(e).replace(/,/g,"")){let t=document.getElementById("file-error");return t.style.display="block",t.innerText="Fragmented CSV data.",{passed:!1,multiplier:0,xLabel:i,yLabel:r,xdata:s}}break}if(!Date.parse(n[0])){let t=document.getElementById("file-error");return t.style.display="block",t.innerText="Please input date in YYYY-MM-DD format (if on Excel, change date format settings).",{passed:!1,multiplier:o,xLabel:i,yLabel:r,xdata:s}}let a=Number(n[1]);if(isNaN(a)){let t=document.getElementById("file-error");return t.style.display="block",t.innerText="Values must be numbers.",{passed:!1,multiplier:o,xLabel:i,yLabel:r,xdata:s}}for(;Math.abs(a)/10**o>=1e4;)o+=3;s.push({order:t,x:n[0],value:a,status:0})}return{passed:!0,multiplier:o,xLabel:i,yLabel:r,xdata:s}}(r.result);if(!t)return;if(console.log(t,e,o,s,n),e>0){s+=` (x10${e.toString().split("").map(function(t){return""[Number(t)]}).join("")})`;for(let t=0;t<n.length;t++)n[t].value/=10**e}let a=document.getElementById("file-error");a.style.display="none",a.innerText="",ET.xLabel=o,ET.yLabel=s,ET.tableData=n,ET.lockedLimitBaseData=E$(ET.tableData),i.updateSettings({data:n,colHeaders:[o,s]}),ET.dividerLines=[],EJ()}),r.readAsText(e)}),document.querySelector("#download-data").addEventListener("click",()=>{let t=`${ET.xLabel},${ET.yLabel}\r
`+ET.xdata.filter(t=>t.x||t.value).map(t=>`${t.x||""},${E3(t.value)||""}`).join("\r\n");EX()&&(t+=`\r
\r
limit_lines,value\r
avg_x,${ET.lockedLimits.avgX}
LNPL,${ET.lockedLimits.LNPL}
UNPL,${ET.lockedLimits.UNPL}
avg_movement,${ET.lockedLimits.avgMovement}
URL,${ET.lockedLimits.URL}`);let e=new Blob([t],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(e),r=document.createElement("a");r.setAttribute("href",i),r.setAttribute("download","xmr-data.csv"),r.click(),r.remove(),URL.revokeObjectURL(i)}),document.querySelector("#refresh-charts").addEventListener("click",()=>{EJ()}),document.querySelector("#share-link").addEventListener("click",()=>{let t=function(t){let e={v:"0"},i=t.xdata.filter(t=>t.x||t.value),r=`${t.xLabel.replace(",",";")},${t.yLabel.replace(",",";")},`+i.map(t=>t.x?t.x.replace(",",";"):"").join(","),s=i.map(t=>E3(t.value));if(e.d=EK(o(Ev).compress(r))+"."+Eq(s),t.dividerLines){let i=Eq(t.dividerLines.filter(t=>!E6(t)).map(t=>t.x));i.length>0&&(e.s=i)}t.lockedLimits&&(1&t.lockedLimitStatus)==1&&(e.l=Eq([t.lockedLimits.avgX,t.lockedLimits.avgMovement,t.lockedLimits.LNPL,t.lockedLimits.UNPL,t.lockedLimits.URL,t.lockedLimitStatus]));let n=new URLSearchParams(e);return`${window.location.origin}${window.location.pathname}?${n.toString()}`}(ET);if(t.length>2e3){alert("Link too long! Consider removing a few datapoints.");return}navigator.clipboard.writeText(t).then(function(){console.log("Async: Copying to clipboard was successful!")},function(t){console.error("Async: Could not copy text: ",t)}),document.getElementById("data-copied-msg").classList.remove("hidden"),setTimeout(()=>{document.getElementById("data-copied-msg").classList.add("hidden")},2e3)}),i=new hD(document.querySelector("#dataTable"),{data:ET.tableData,dataSchema:{x:null,value:null},columns:[{data:"x",type:"date",dateFormat:"YYYY-MM-DD",validator:(t,e)=>{if(!t){e(!0);return}let i=new Date(EY(t));e(i instanceof Date&&!isNaN(i.getTime()))}},{data:"value",type:"numeric"}],colHeaders:[ET.xLabel??"Date","Value"===ET.yLabel?"Value ()":ET.yLabel],afterOnCellMouseDown:function(i,r){if(-1!==r.row)return;let o=prompt("Insert a new column name",this.getColHeader()[r.col]);if(o){let i=this.getColHeader();i[r.col]=o,this.updateSettings({colHeaders:i}),0==r.col?(ET.xLabel=o,t.update({xAxis:{title:{text:E2(o),useHTML:!0}}}),e.update({xAxis:{title:{text:E2(o),useHTML:!0}}})):(ET.yLabel=o,t.update({yAxis:{title:{text:E2(o),useHTML:!0}},title:{text:E0(),useHTML:!0}}),e.update({yAxis:{title:{text:E2(o),useHTML:!0}},title:{text:E1(),useHTML:!0}})),E_()}},contextMenu:!0,allowRemoveColumn:!1,minSpareRows:1,height:"auto",stretchH:"all",fillHandle:{autoInsertRow:!0,direction:"vertical"},beforeAutofill:(t,e,i,r)=>EW(t,e,i,r),beforePaste:(t,e)=>EV(t,e),beforeChange(t,e){var i;let r,o,s=ET.xdata.map(t=>t.x);t.forEach(([t,e,i,r])=>{"x"==e&&(s[t]=r)}),i=this,r={},o=!1,s.forEach((t,e)=>{t&&(t in r?(i.setCellMeta(e,0,"className","duplicate"),o=!0):i.setCellMeta(e,0,"className",""),r[t]=!0)}),o?document.getElementById("duplicate-data-warning").classList.remove("hidden"):document.getElementById("duplicate-data-warning").classList.add("hidden")},afterChange(t,e){"loadData"!=e&&EH()},afterValidate(t,e,i,r,o){let s=document.getElementById("data-table-error");if(t){s.classList.add("hidden");return}return s.classList.remove("hidden"),!1},licenseKey:"non-commercial-and-evaluation"})});const E0=()=>`<div class="plot-title">X Plot<span>${"value"!==ET.yLabel.toLowerCase()?": "+ET.yLabel:""}</span></div>`,E1=()=>`<div class="plot-title">MR Plot<span>${"value"!==ET.yLabel.toLowerCase()?": "+ET.yLabel:""}</span></div>`,E2=t=>`<div class="axis-label-y">${t}</div>`;function E3(t){return+t.toFixed(2)}function E6(t){return t.id&&("divider-start"==t.id||"divider-end"==t.id)}
//# sourceMappingURL=index.3261fa33.js.map
