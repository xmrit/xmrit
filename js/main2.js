"use strict";(()=>{var iD=Object.create;var Ag=Object.defineProperty;var sD=Object.getOwnPropertyDescriptor;var oD=Object.getOwnPropertyNames;var rD=Object.getPrototypeOf,nD=Object.prototype.hasOwnProperty;var Xr=(o=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(o,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):o)(function(o){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+o+'" is not supported')});var Ie=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports),Ri=(o,e)=>{for(var t in e)Ag(o,t,{get:e[t],enumerable:!0})},aD=(o,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of oD(e))!nD.call(o,s)&&s!==t&&Ag(o,s,{get:()=>e[s],enumerable:!(i=sD(e,s))||i.enumerable});return o};var ri=(o,e,t)=>(t=o!=null?iD(rD(o)):{},aD(e||!o||!o.__esModule?Ag(t,"default",{value:o,enumerable:!0}):t,o));var pi=Ie((d0,f0)=>{"use strict";var Df=function(o){return o&&o.Math===Math&&o};f0.exports=Df(typeof globalThis=="object"&&globalThis)||Df(typeof window=="object"&&window)||Df(typeof self=="object"&&self)||Df(typeof global=="object"&&global)||function(){return this}()||d0||Function("return this")()});var Vi=Ie((iz,m0)=>{"use strict";m0.exports=function(o){try{return!!o()}catch{return!0}}});var Rs=Ie((sz,p0)=>{"use strict";var lD=Vi();p0.exports=!lD(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})});var Xl=Ie((oz,g0)=>{"use strict";var hD=Vi();g0.exports=!hD(function(){var o=function(){}.bind();return typeof o!="function"||o.hasOwnProperty("prototype")})});var ql=Ie((rz,C0)=>{"use strict";var cD=Xl(),kf=Function.prototype.call;C0.exports=cD?kf.bind(kf):function(){return kf.apply(kf,arguments)}});var b0=Ie(v0=>{"use strict";var w0={}.propertyIsEnumerable,y0=Object.getOwnPropertyDescriptor,uD=y0&&!w0.call({1:2},1);v0.f=uD?function(e){var t=y0(this,e);return!!t&&t.enumerable}:w0});var Hf=Ie((az,x0)=>{"use strict";x0.exports=function(o,e){return{enumerable:!(o&1),configurable:!(o&2),writable:!(o&4),value:e}}});var yi=Ie((lz,T0)=>{"use strict";var S0=Xl(),E0=Function.prototype,Ig=E0.call,dD=S0&&E0.bind.bind(Ig,Ig);T0.exports=S0?dD:function(o){return function(){return Ig.apply(o,arguments)}}});var qr=Ie((hz,M0)=>{"use strict";var R0=yi(),fD=R0({}.toString),mD=R0("".slice);M0.exports=function(o){return mD(fD(o),8,-1)}});var A0=Ie((cz,O0)=>{"use strict";var pD=yi(),gD=Vi(),CD=qr(),_g=Object,wD=pD("".split);O0.exports=gD(function(){return!_g("z").propertyIsEnumerable(0)})?function(o){return CD(o)==="String"?wD(o,""):_g(o)}:_g});var Ng=Ie((uz,I0)=>{"use strict";I0.exports=function(o){return o==null}});var Pg=Ie((dz,_0)=>{"use strict";var yD=Ng(),vD=TypeError;_0.exports=function(o){if(yD(o))throw vD("Can't call method on "+o);return o}});var Kl=Ie((fz,N0)=>{"use strict";var bD=A0(),xD=Pg();N0.exports=function(o){return bD(xD(o))}});var Dg=Ie((mz,P0)=>{"use strict";var Lg=typeof document=="object"&&document.all,SD=typeof Lg>"u"&&Lg!==void 0;P0.exports={all:Lg,IS_HTMLDDA:SD}});var di=Ie((pz,D0)=>{"use strict";var L0=Dg(),ED=L0.all;D0.exports=L0.IS_HTMLDDA?function(o){return typeof o=="function"||o===ED}:function(o){return typeof o=="function"}});var or=Ie((gz,F0)=>{"use strict";var k0=di(),H0=Dg(),TD=H0.all;F0.exports=H0.IS_HTMLDDA?function(o){return typeof o=="object"?o!==null:k0(o)||o===TD}:function(o){return typeof o=="object"?o!==null:k0(o)}});var oa=Ie((Cz,B0)=>{"use strict";var kg=pi(),RD=di(),MD=function(o){return RD(o)?o:void 0};B0.exports=function(o,e){return arguments.length<2?MD(kg[o]):kg[o]&&kg[o][e]}});var Hg=Ie((wz,V0)=>{"use strict";var OD=yi();V0.exports=OD({}.isPrototypeOf)});var Ff=Ie((yz,W0)=>{"use strict";W0.exports=typeof navigator<"u"&&String(navigator.userAgent)||""});var X0=Ie((vz,$0)=>{"use strict";var z0=pi(),Fg=Ff(),U0=z0.process,Y0=z0.Deno,j0=U0&&U0.versions||Y0&&Y0.version,G0=j0&&j0.v8,Ms,Bf;G0&&(Ms=G0.split("."),Bf=Ms[0]>0&&Ms[0]<4?1:+(Ms[0]+Ms[1]));!Bf&&Fg&&(Ms=Fg.match(/Edge\/(\d+)/),(!Ms||Ms[1]>=74)&&(Ms=Fg.match(/Chrome\/(\d+)/),Ms&&(Bf=+Ms[1])));$0.exports=Bf});var Vf=Ie((bz,K0)=>{"use strict";var q0=X0(),AD=Vi(),ID=pi(),_D=ID.String;K0.exports=!!Object.getOwnPropertySymbols&&!AD(function(){var o=Symbol("symbol detection");return!_D(o)||!(Object(o)instanceof Symbol)||!Symbol.sham&&q0&&q0<41})});var Bg=Ie((xz,Z0)=>{"use strict";var ND=Vf();Z0.exports=ND&&!Symbol.sham&&typeof Symbol.iterator=="symbol"});var Wf=Ie((Sz,Q0)=>{"use strict";var PD=oa(),LD=di(),DD=Hg(),kD=Bg(),HD=Object;Q0.exports=kD?function(o){return typeof o=="symbol"}:function(o){var e=PD("Symbol");return LD(e)&&DD(e.prototype,HD(o))}});var Vg=Ie((Ez,J0)=>{"use strict";var FD=String;J0.exports=function(o){try{return FD(o)}catch{return"Object"}}});var Uf=Ie((Tz,eE)=>{"use strict";var BD=di(),VD=Vg(),WD=TypeError;eE.exports=function(o){if(BD(o))return o;throw WD(VD(o)+" is not a function")}});var iE=Ie((Rz,tE)=>{"use strict";var UD=Uf(),YD=Ng();tE.exports=function(o,e){var t=o[e];return YD(t)?void 0:UD(t)}});var oE=Ie((Mz,sE)=>{"use strict";var Wg=ql(),Ug=di(),Yg=or(),jD=TypeError;sE.exports=function(o,e){var t,i;if(e==="string"&&Ug(t=o.toString)&&!Yg(i=Wg(t,o))||Ug(t=o.valueOf)&&!Yg(i=Wg(t,o))||e!=="string"&&Ug(t=o.toString)&&!Yg(i=Wg(t,o)))return i;throw jD("Can't convert object to primitive value")}});var jg=Ie((Oz,rE)=>{"use strict";rE.exports=!1});var Yf=Ie((Az,aE)=>{"use strict";var nE=pi(),GD=Object.defineProperty;aE.exports=function(o,e){try{GD(nE,o,{value:e,configurable:!0,writable:!0})}catch{nE[o]=e}return e}});var jf=Ie((Iz,hE)=>{"use strict";var zD=pi(),$D=Yf(),lE="__core-js_shared__",XD=zD[lE]||$D(lE,{});hE.exports=XD});var Gg=Ie((_z,uE)=>{"use strict";var qD=jg(),cE=jf();(uE.exports=function(o,e){return cE[o]||(cE[o]=e!==void 0?e:{})})("versions",[]).push({version:"3.32.2",mode:qD?"pure":"global",copyright:"\xA9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.2/LICENSE",source:"https://github.com/zloirock/core-js"})});var Zl=Ie((Nz,dE)=>{"use strict";var KD=Pg(),ZD=Object;dE.exports=function(o){return ZD(KD(o))}});var Vs=Ie((Pz,fE)=>{"use strict";var QD=yi(),JD=Zl(),ek=QD({}.hasOwnProperty);fE.exports=Object.hasOwn||function(e,t){return ek(JD(e),t)}});var zg=Ie((Lz,mE)=>{"use strict";var tk=yi(),ik=0,sk=Math.random(),ok=tk(1 .toString);mE.exports=function(o){return"Symbol("+(o===void 0?"":o)+")_"+ok(++ik+sk,36)}});var Ql=Ie((Dz,gE)=>{"use strict";var rk=pi(),nk=Gg(),pE=Vs(),ak=zg(),lk=Vf(),hk=Bg(),ra=rk.Symbol,$g=nk("wks"),ck=hk?ra.for||ra:ra&&ra.withoutSetter||ak;gE.exports=function(o){return pE($g,o)||($g[o]=lk&&pE(ra,o)?ra[o]:ck("Symbol."+o)),$g[o]}});var vE=Ie((kz,yE)=>{"use strict";var uk=ql(),CE=or(),wE=Wf(),dk=iE(),fk=oE(),mk=Ql(),pk=TypeError,gk=mk("toPrimitive");yE.exports=function(o,e){if(!CE(o)||wE(o))return o;var t=dk(o,gk),i;if(t){if(e===void 0&&(e="default"),i=uk(t,o,e),!CE(i)||wE(i))return i;throw pk("Can't convert object to primitive value")}return e===void 0&&(e="number"),fk(o,e)}});var Xg=Ie((Hz,bE)=>{"use strict";var Ck=vE(),wk=Wf();bE.exports=function(o){var e=Ck(o,"string");return wk(e)?e:e+""}});var Gf=Ie((Fz,SE)=>{"use strict";var yk=pi(),xE=or(),qg=yk.document,vk=xE(qg)&&xE(qg.createElement);SE.exports=function(o){return vk?qg.createElement(o):{}}});var Kg=Ie((Bz,EE)=>{"use strict";var bk=Rs(),xk=Vi(),Sk=Gf();EE.exports=!bk&&!xk(function(){return Object.defineProperty(Sk("div"),"a",{get:function(){return 7}}).a!==7})});var Zg=Ie(RE=>{"use strict";var Ek=Rs(),Tk=ql(),Rk=b0(),Mk=Hf(),Ok=Kl(),Ak=Xg(),Ik=Vs(),_k=Kg(),TE=Object.getOwnPropertyDescriptor;RE.f=Ek?TE:function(e,t){if(e=Ok(e),t=Ak(t),_k)try{return TE(e,t)}catch{}if(Ik(e,t))return Mk(!Tk(Rk.f,e,t),e[t])}});var Qg=Ie((Wz,ME)=>{"use strict";var Nk=Rs(),Pk=Vi();ME.exports=Nk&&Pk(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})});var na=Ie((Uz,OE)=>{"use strict";var Lk=or(),Dk=String,kk=TypeError;OE.exports=function(o){if(Lk(o))return o;throw kk(Dk(o)+" is not an object")}});var Kr=Ie(IE=>{"use strict";var Hk=Rs(),Fk=Kg(),Bk=Qg(),zf=na(),AE=Xg(),Vk=TypeError,Jg=Object.defineProperty,Wk=Object.getOwnPropertyDescriptor,eC="enumerable",tC="configurable",iC="writable";IE.f=Hk?Bk?function(e,t,i){if(zf(e),t=AE(t),zf(i),typeof e=="function"&&t==="prototype"&&"value"in i&&iC in i&&!i[iC]){var s=Wk(e,t);s&&s[iC]&&(e[t]=i.value,i={configurable:tC in i?i[tC]:s[tC],enumerable:eC in i?i[eC]:s[eC],writable:!1})}return Jg(e,t,i)}:Jg:function(e,t,i){if(zf(e),t=AE(t),zf(i),Fk)try{return Jg(e,t,i)}catch{}if("get"in i||"set"in i)throw Vk("Accessors not supported");return"value"in i&&(e[t]=i.value),e}});var aa=Ie((jz,_E)=>{"use strict";var Uk=Rs(),Yk=Kr(),jk=Hf();_E.exports=Uk?function(o,e,t){return Yk.f(o,e,jk(1,t))}:function(o,e,t){return o[e]=t,o}});var LE=Ie((Gz,PE)=>{"use strict";var sC=Rs(),Gk=Vs(),NE=Function.prototype,zk=sC&&Object.getOwnPropertyDescriptor,oC=Gk(NE,"name"),$k=oC&&function(){}.name==="something",Xk=oC&&(!sC||sC&&zk(NE,"name").configurable);PE.exports={EXISTS:oC,PROPER:$k,CONFIGURABLE:Xk}});var kE=Ie((zz,DE)=>{"use strict";var qk=yi(),Kk=di(),rC=jf(),Zk=qk(Function.toString);Kk(rC.inspectSource)||(rC.inspectSource=function(o){return Zk(o)});DE.exports=rC.inspectSource});var BE=Ie(($z,FE)=>{"use strict";var Qk=pi(),Jk=di(),HE=Qk.WeakMap;FE.exports=Jk(HE)&&/native code/.test(String(HE))});var nC=Ie((Xz,WE)=>{"use strict";var eH=Gg(),tH=zg(),VE=eH("keys");WE.exports=function(o){return VE[o]||(VE[o]=tH(o))}});var $f=Ie((qz,UE)=>{"use strict";UE.exports={}});var zE=Ie((Kz,GE)=>{"use strict";var iH=BE(),jE=pi(),sH=or(),oH=aa(),aC=Vs(),lC=jf(),rH=nC(),nH=$f(),YE="Object already initialized",hC=jE.TypeError,aH=jE.WeakMap,Xf,Jl,qf,lH=function(o){return qf(o)?Jl(o):Xf(o,{})},hH=function(o){return function(e){var t;if(!sH(e)||(t=Jl(e)).type!==o)throw hC("Incompatible receiver, "+o+" required");return t}};iH||lC.state?(Os=lC.state||(lC.state=new aH),Os.get=Os.get,Os.has=Os.has,Os.set=Os.set,Xf=function(o,e){if(Os.has(o))throw hC(YE);return e.facade=o,Os.set(o,e),e},Jl=function(o){return Os.get(o)||{}},qf=function(o){return Os.has(o)}):(Zr=rH("state"),nH[Zr]=!0,Xf=function(o,e){if(aC(o,Zr))throw hC(YE);return e.facade=o,oH(o,Zr,e),e},Jl=function(o){return aC(o,Zr)?o[Zr]:{}},qf=function(o){return aC(o,Zr)});var Os,Zr;GE.exports={set:Xf,get:Jl,has:qf,enforce:lH,getterFor:hH}});var KE=Ie((Zz,qE)=>{"use strict";var uC=yi(),cH=Vi(),uH=di(),Kf=Vs(),cC=Rs(),dH=LE().CONFIGURABLE,fH=kE(),XE=zE(),mH=XE.enforce,pH=XE.get,$E=String,Zf=Object.defineProperty,gH=uC("".slice),CH=uC("".replace),wH=uC([].join),yH=cC&&!cH(function(){return Zf(function(){},"length",{value:8}).length!==8}),vH=String(String).split("String"),bH=qE.exports=function(o,e,t){gH($E(e),0,7)==="Symbol("&&(e="["+CH($E(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),t&&t.getter&&(e="get "+e),t&&t.setter&&(e="set "+e),(!Kf(o,"name")||dH&&o.name!==e)&&(cC?Zf(o,"name",{value:e,configurable:!0}):o.name=e),yH&&t&&Kf(t,"arity")&&o.length!==t.arity&&Zf(o,"length",{value:t.arity});try{t&&Kf(t,"constructor")&&t.constructor?cC&&Zf(o,"prototype",{writable:!1}):o.prototype&&(o.prototype=void 0)}catch{}var i=mH(o);return Kf(i,"source")||(i.source=wH(vH,typeof e=="string"?e:"")),o};Function.prototype.toString=bH(function(){return uH(this)&&pH(this).source||fH(this)},"toString")});var QE=Ie((Qz,ZE)=>{"use strict";var xH=di(),SH=Kr(),EH=KE(),TH=Yf();ZE.exports=function(o,e,t,i){i||(i={});var s=i.enumerable,r=i.name!==void 0?i.name:e;if(xH(t)&&EH(t,r,i),i.global)s?o[e]=t:TH(e,t);else{try{i.unsafe?o[e]&&(s=!0):delete o[e]}catch{}s?o[e]=t:SH.f(o,e,{value:t,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return o}});var eT=Ie((Jz,JE)=>{"use strict";var RH=Math.ceil,MH=Math.floor;JE.exports=Math.trunc||function(e){var t=+e;return(t>0?MH:RH)(t)}});var Qf=Ie((e$,tT)=>{"use strict";var OH=eT();tT.exports=function(o){var e=+o;return e!==e||e===0?0:OH(e)}});var sT=Ie((t$,iT)=>{"use strict";var AH=Qf(),IH=Math.max,_H=Math.min;iT.exports=function(o,e){var t=AH(o);return t<0?IH(t+e,0):_H(t,e)}});var rT=Ie((i$,oT)=>{"use strict";var NH=Qf(),PH=Math.min;oT.exports=function(o){return o>0?PH(NH(o),9007199254740991):0}});var eh=Ie((s$,nT)=>{"use strict";var LH=rT();nT.exports=function(o){return LH(o.length)}});var hT=Ie((o$,lT)=>{"use strict";var DH=Kl(),kH=sT(),HH=eh(),aT=function(o){return function(e,t,i){var s=DH(e),r=HH(s),n=kH(i,r),a;if(o&&t!==t){for(;r>n;)if(a=s[n++],a!==a)return!0}else for(;r>n;n++)if((o||n in s)&&s[n]===t)return o||n||0;return!o&&-1}};lT.exports={includes:aT(!0),indexOf:aT(!1)}});var fC=Ie((r$,uT)=>{"use strict";var FH=yi(),dC=Vs(),BH=Kl(),VH=hT().indexOf,WH=$f(),cT=FH([].push);uT.exports=function(o,e){var t=BH(o),i=0,s=[],r;for(r in t)!dC(WH,r)&&dC(t,r)&&cT(s,r);for(;e.length>i;)dC(t,r=e[i++])&&(~VH(s,r)||cT(s,r));return s}});var Jf=Ie((n$,dT)=>{"use strict";dT.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]});var mT=Ie(fT=>{"use strict";var UH=fC(),YH=Jf(),jH=YH.concat("length","prototype");fT.f=Object.getOwnPropertyNames||function(e){return UH(e,jH)}});var gT=Ie(pT=>{"use strict";pT.f=Object.getOwnPropertySymbols});var wT=Ie((h$,CT)=>{"use strict";var GH=oa(),zH=yi(),$H=mT(),XH=gT(),qH=na(),KH=zH([].concat);CT.exports=GH("Reflect","ownKeys")||function(e){var t=$H.f(qH(e)),i=XH.f;return i?KH(t,i(e)):t}});var mC=Ie((c$,vT)=>{"use strict";var yT=Vs(),ZH=wT(),QH=Zg(),JH=Kr();vT.exports=function(o,e,t){for(var i=ZH(e),s=JH.f,r=QH.f,n=0;n<i.length;n++){var a=i[n];!yT(o,a)&&!(t&&yT(t,a))&&s(o,a,r(e,a))}}});var xT=Ie((u$,bT)=>{"use strict";var eF=Vi(),tF=di(),iF=/#|\.prototype\./,th=function(o,e){var t=oF[sF(o)];return t===nF?!0:t===rF?!1:tF(e)?eF(e):!!e},sF=th.normalize=function(o){return String(o).replace(iF,".").toLowerCase()},oF=th.data={},rF=th.NATIVE="N",nF=th.POLYFILL="P";bT.exports=th});var rr=Ie((d$,ST)=>{"use strict";var pC=pi(),aF=Zg().f,lF=aa(),hF=QE(),cF=Yf(),uF=mC(),dF=xT();ST.exports=function(o,e){var t=o.target,i=o.global,s=o.stat,r,n,a,l,c,u;if(i?n=pC:s?n=pC[t]||cF(t,{}):n=(pC[t]||{}).prototype,n)for(a in e){if(c=e[a],o.dontCallGetSet?(u=aF(n,a),l=u&&u.value):l=n[a],r=dF(i?a:t+(s?".":"#")+a,o.forced),!r&&l!==void 0){if(typeof c==typeof l)continue;uF(c,l)}(o.sham||l&&l.sham)&&lF(c,"sham",!0),hF(n,a,c,o)}}});var gC=Ie((f$,ET)=>{"use strict";var fF=qr();ET.exports=Array.isArray||function(e){return fF(e)==="Array"}});var CC=Ie((m$,TT)=>{"use strict";var mF=Rs(),pF=gC(),gF=TypeError,CF=Object.getOwnPropertyDescriptor,wF=mF&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();TT.exports=wF?function(o,e){if(pF(o)&&!CF(o,"length").writable)throw gF("Cannot set read only .length");return o.length=e}:function(o,e){return o.length=e}});var wC=Ie((p$,RT)=>{"use strict";var yF=TypeError,vF=9007199254740991;RT.exports=function(o){if(o>vF)throw yF("Maximum allowed index exceeded");return o}});var ih=Ie((g$,IT)=>{"use strict";var IF=Xl(),AT=Function.prototype,MT=AT.apply,OT=AT.call;IT.exports=typeof Reflect=="object"&&Reflect.apply||(IF?OT.bind(MT):function(){return OT.apply(MT,arguments)})});var NT=Ie((C$,_T)=>{"use strict";var _F=yi(),NF=Uf();_T.exports=function(o,e,t){try{return _F(NF(Object.getOwnPropertyDescriptor(o,e)[t]))}catch{}}});var LT=Ie((w$,PT)=>{"use strict";var PF=di(),LF=String,DF=TypeError;PT.exports=function(o){if(typeof o=="object"||PF(o))return o;throw DF("Can't set "+LF(o)+" as a prototype")}});var yC=Ie((y$,DT)=>{"use strict";var kF=NT(),HF=na(),FF=LT();DT.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var o=!1,e={},t;try{t=kF(Object.prototype,"__proto__","set"),t(e,[]),o=e instanceof Array}catch{}return function(s,r){return HF(s),FF(r),o?t(s,r):s.__proto__=r,s}}():void 0)});var HT=Ie((v$,kT)=>{"use strict";var BF=Kr().f;kT.exports=function(o,e,t){t in o||BF(o,t,{configurable:!0,get:function(){return e[t]},set:function(i){e[t]=i}})}});var VT=Ie((b$,BT)=>{"use strict";var VF=di(),WF=or(),FT=yC();BT.exports=function(o,e,t){var i,s;return FT&&VF(i=e.constructor)&&i!==t&&WF(s=i.prototype)&&s!==t.prototype&&FT(o,s),o}});var YT=Ie((x$,UT)=>{"use strict";var UF=Ql(),YF=UF("toStringTag"),WT={};WT[YF]="z";UT.exports=String(WT)==="[object z]"});var GT=Ie((S$,jT)=>{"use strict";var jF=YT(),GF=di(),em=qr(),zF=Ql(),$F=zF("toStringTag"),XF=Object,qF=em(function(){return arguments}())==="Arguments",KF=function(o,e){try{return o[e]}catch{}};jT.exports=jF?em:function(o){var e,t,i;return o===void 0?"Undefined":o===null?"Null":typeof(t=KF(e=XF(o),$F))=="string"?t:qF?em(e):(i=em(e))==="Object"&&GF(e.callee)?"Arguments":i}});var vC=Ie((E$,zT)=>{"use strict";var ZF=GT(),QF=String;zT.exports=function(o){if(ZF(o)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return QF(o)}});var XT=Ie((T$,$T)=>{"use strict";var JF=vC();$T.exports=function(o,e){return o===void 0?arguments.length<2?"":e:JF(o)}});var KT=Ie((R$,qT)=>{"use strict";var eB=or(),tB=aa();qT.exports=function(o,e){eB(e)&&"cause"in e&&tB(o,"cause",e.cause)}});var eR=Ie((M$,JT)=>{"use strict";var iB=yi(),ZT=Error,sB=iB("".replace),oB=function(o){return String(ZT(o).stack)}("zxcasd"),QT=/\n\s*at [^:]*:[^\n]*/,rB=QT.test(oB);JT.exports=function(o,e){if(rB&&typeof o=="string"&&!ZT.prepareStackTrace)for(;e--;)o=sB(o,QT,"");return o}});var iR=Ie((O$,tR)=>{"use strict";var nB=Vi(),aB=Hf();tR.exports=!nB(function(){var o=Error("a");return"stack"in o?(Object.defineProperty(o,"stack",aB(1,7)),o.stack!==7):!0})});var rR=Ie((A$,oR)=>{"use strict";var lB=aa(),hB=eR(),cB=iR(),sR=Error.captureStackTrace;oR.exports=function(o,e,t,i){cB&&(sR?sR(o,e):lB(o,"stack",hB(t,i)))}});var fR=Ie((I$,dR)=>{"use strict";var nR=oa(),uB=Vs(),aR=aa(),dB=Hg(),lR=yC(),hR=mC(),cR=HT(),fB=VT(),mB=XT(),pB=KT(),gB=rR(),CB=Rs(),uR=jg();dR.exports=function(o,e,t,i){var s="stackTraceLimit",r=i?2:1,n=o.split("."),a=n[n.length-1],l=nR.apply(null,n);if(l){var c=l.prototype;if(!uR&&uB(c,"cause")&&delete c.cause,!t)return l;var u=nR("Error"),g=e(function(p,C){var y=mB(i?C:p,void 0),S=i?new l(p):new l;return y!==void 0&&aR(S,"message",y),gB(S,g,S.stack,2),this&&dB(c,this)&&fB(S,this,g),arguments.length>r&&pB(S,arguments[r]),S});if(g.prototype=c,a!=="Error"?lR?lR(g,u):hR(g,u,{name:!0}):CB&&s in l&&(cR(g,l,s),cR(g,l,"prepareStackTrace")),hR(g,l),!uR)try{c.name!==a&&aR(c,"name",a),c.constructor=g}catch{}return g}}});var wR=Ie((_$,CR)=>{"use strict";var yB=qr(),vB=yi();CR.exports=function(o){if(yB(o)==="Function")return vB(o)}});var bR=Ie((N$,vR)=>{"use strict";var yR=wR(),bB=Uf(),xB=Xl(),SB=yR(yR.bind);vR.exports=function(o,e){return bB(o),e===void 0?o:xB?SB(o,e):function(){return o.apply(e,arguments)}}});var SC=Ie((P$,xR)=>{"use strict";var EB=oa();xR.exports=EB("document","documentElement")});var im=Ie((L$,SR)=>{"use strict";var TB=yi();SR.exports=TB([].slice)});var EC=Ie((D$,ER)=>{"use strict";var RB=TypeError;ER.exports=function(o,e){if(o<e)throw RB("Not enough arguments");return o}});var RR=Ie((k$,TR)=>{"use strict";var MB=Ff();TR.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(MB)});var OR=Ie((H$,MR)=>{"use strict";var OB=pi(),AB=qr();MR.exports=AB(OB.process)==="process"});var PC=Ie((F$,HR)=>{"use strict";var Wi=pi(),IB=ih(),_B=bR(),AR=di(),NB=Vs(),kR=Vi(),IR=SC(),PB=im(),_R=Gf(),LB=EC(),DB=RR(),kB=OR(),IC=Wi.setImmediate,_C=Wi.clearImmediate,HB=Wi.process,TC=Wi.Dispatch,FB=Wi.Function,NR=Wi.MessageChannel,BB=Wi.String,RC=0,sh={},PR="onreadystatechange",oh,Jr,MC,OC;kR(function(){oh=Wi.location});var NC=function(o){if(NB(sh,o)){var e=sh[o];delete sh[o],e()}},AC=function(o){return function(){NC(o)}},LR=function(o){NC(o.data)},DR=function(o){Wi.postMessage(BB(o),oh.protocol+"//"+oh.host)};(!IC||!_C)&&(IC=function(e){LB(arguments.length,1);var t=AR(e)?e:FB(e),i=PB(arguments,1);return sh[++RC]=function(){IB(t,void 0,i)},Jr(RC),RC},_C=function(e){delete sh[e]},kB?Jr=function(o){HB.nextTick(AC(o))}:TC&&TC.now?Jr=function(o){TC.now(AC(o))}:NR&&!DB?(MC=new NR,OC=MC.port2,MC.port1.onmessage=LR,Jr=_B(OC.postMessage,OC)):Wi.addEventListener&&AR(Wi.postMessage)&&!Wi.importScripts&&oh&&oh.protocol!=="file:"&&!kR(DR)?(Jr=DR,Wi.addEventListener("message",LR,!1)):PR in _R("script")?Jr=function(o){IR.appendChild(_R("script"))[PR]=function(){IR.removeChild(this),NC(o)}}:Jr=function(o){setTimeout(AC(o),0)});HR.exports={set:IC,clear:_C}});var BR=Ie(()=>{"use strict";var VB=rr(),WB=pi(),FR=PC().clear;VB({global:!0,bind:!0,enumerable:!0,forced:WB.clearImmediate!==FR},{clearImmediate:FR})});var WR=Ie((W$,VR)=>{"use strict";VR.exports=typeof Bun=="function"&&Bun&&typeof Bun.version=="string"});var jR=Ie((U$,YR)=>{"use strict";var UR=pi(),UB=ih(),YB=di(),jB=WR(),GB=Ff(),zB=im(),$B=EC(),XB=UR.Function,qB=/MSIE .\./.test(GB)||jB&&function(){var o=UR.Bun.version.split(".");return o.length<3||o[0]==="0"&&(o[1]<3||o[1]==="3"&&o[2]==="0")}();YR.exports=function(o,e){var t=e?2:1;return qB?function(i,s){var r=$B(arguments.length,1)>t,n=YB(i)?i:XB(i),a=r?zB(arguments,t):[],l=r?function(){UB(n,this,a)}:n;return e?o(l,s):o(l)}:o}});var XR=Ie(()=>{"use strict";var KB=rr(),$R=pi(),GR=PC().set,ZB=jR(),zR=$R.setImmediate?ZB(GR,!1):GR;KB({global:!0,bind:!0,enumerable:!0,forced:$R.setImmediate!==zR},{setImmediate:zR})});var qR=Ie((LC,DC)=>{"use strict";(function(o,e){typeof LC=="object"&&typeof DC<"u"?DC.exports=e():typeof define=="function"&&define.amd?define(e):(o=typeof globalThis<"u"?globalThis:o||self,o.DOMPurify=e())})(LC,function(){"use strict";function o(Z){"@babel/helpers - typeof";return o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(te){return typeof te}:function(te){return te&&typeof Symbol=="function"&&te.constructor===Symbol&&te!==Symbol.prototype?"symbol":typeof te},o(Z)}function e(Z,te){return e=Object.setPrototypeOf||function(ce,Ce){return ce.__proto__=Ce,ce},e(Z,te)}function t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function i(Z,te,re){return t()?i=Reflect.construct:i=function(Ce,ge,ye){var Ee=[null];Ee.push.apply(Ee,ge);var Se=Function.bind.apply(Ce,Ee),be=new Se;return ye&&e(be,ye.prototype),be},i.apply(null,arguments)}function s(Z){return r(Z)||n(Z)||a(Z)||c()}function r(Z){if(Array.isArray(Z))return l(Z)}function n(Z){if(typeof Symbol<"u"&&Z[Symbol.iterator]!=null||Z["@@iterator"]!=null)return Array.from(Z)}function a(Z,te){if(Z){if(typeof Z=="string")return l(Z,te);var re=Object.prototype.toString.call(Z).slice(8,-1);if(re==="Object"&&Z.constructor&&(re=Z.constructor.name),re==="Map"||re==="Set")return Array.from(Z);if(re==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(re))return l(Z,te)}}function l(Z,te){(te==null||te>Z.length)&&(te=Z.length);for(var re=0,ce=new Array(te);re<te;re++)ce[re]=Z[re];return ce}function c(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u=Object.hasOwnProperty,g=Object.setPrototypeOf,p=Object.isFrozen,C=Object.getPrototypeOf,y=Object.getOwnPropertyDescriptor,S=Object.freeze,O=Object.seal,M=Object.create,_=typeof Reflect<"u"&&Reflect,N=_.apply,E=_.construct;N||(N=function(te,re,ce){return te.apply(re,ce)}),S||(S=function(te){return te}),O||(O=function(te){return te}),E||(E=function(te,re){return i(te,s(re))});var k=f(Array.prototype.forEach),ie=f(Array.prototype.pop),$=f(Array.prototype.push),H=f(String.prototype.toLowerCase),Q=f(String.prototype.toString),Y=f(String.prototype.match),P=f(String.prototype.replace),j=f(String.prototype.indexOf),A=f(String.prototype.trim),v=f(RegExp.prototype.test),R=w(TypeError);function f(Z){return function(te){for(var re=arguments.length,ce=new Array(re>1?re-1:0),Ce=1;Ce<re;Ce++)ce[Ce-1]=arguments[Ce];return N(Z,te,ce)}}function w(Z){return function(){for(var te=arguments.length,re=new Array(te),ce=0;ce<te;ce++)re[ce]=arguments[ce];return E(Z,re)}}function b(Z,te,re){var ce;re=(ce=re)!==null&&ce!==void 0?ce:H,g&&g(Z,null);for(var Ce=te.length;Ce--;){var ge=te[Ce];if(typeof ge=="string"){var ye=re(ge);ye!==ge&&(p(te)||(te[Ce]=ye),ge=ye)}Z[ge]=!0}return Z}function h(Z){var te=M(null),re;for(re in Z)N(u,Z,[re])===!0&&(te[re]=Z[re]);return te}function m(Z,te){for(;Z!==null;){var re=y(Z,te);if(re){if(re.get)return f(re.get);if(typeof re.value=="function")return f(re.value)}Z=C(Z)}function ce(Ce){return console.warn("fallback value for",Ce),null}return ce}var x=S(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),I=S(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),B=S(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),V=S(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),U=S(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),K=S(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),L=S(["#text"]),X=S(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),q=S(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),le=S(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),D=S(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),F=O(/\{\{[\w\W]*|[\w\W]*\}\}/gm),oe=O(/<%[\w\W]*|[\w\W]*%>/gm),ne=O(/\${[\w\W]*}/gm),ae=O(/^data-[\-\w.\u00B7-\uFFFF]/),fe=O(/^aria-[\-\w]+$/),me=O(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),G=O(/^(?:\w+script|data):/i),se=O(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ee=O(/^html$/i),ue=function(){return typeof window>"u"?null:window},de=function(te,re){if(o(te)!=="object"||typeof te.createPolicy!="function")return null;var ce=null,Ce="data-tt-policy-suffix";re.currentScript&&re.currentScript.hasAttribute(Ce)&&(ce=re.currentScript.getAttribute(Ce));var ge="dompurify"+(ce?"#"+ce:"");try{return te.createPolicy(ge,{createHTML:function(Ee){return Ee},createScriptURL:function(Ee){return Ee}})}catch{return console.warn("TrustedTypes policy "+ge+" could not be created."),null}};function W(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ue(),te=function(xe){return W(xe)};if(te.version="2.4.7",te.removed=[],!Z||!Z.document||Z.document.nodeType!==9)return te.isSupported=!1,te;var re=Z.document,ce=Z.document,Ce=Z.DocumentFragment,ge=Z.HTMLTemplateElement,ye=Z.Node,Ee=Z.Element,Se=Z.NodeFilter,be=Z.NamedNodeMap,Re=be===void 0?Z.NamedNodeMap||Z.MozNamedAttrMap:be,Ae=Z.HTMLFormElement,Ne=Z.DOMParser,Me=Z.trustedTypes,Ze=Ee.prototype,it=m(Ze,"cloneNode"),rt=m(Ze,"nextSibling"),It=m(Ze,"childNodes"),wt=m(Ze,"parentNode");if(typeof ge=="function"){var ct=ce.createElement("template");ct.content&&ct.content.ownerDocument&&(ce=ct.content.ownerDocument)}var qe=de(Me,re),wi=qe?qe.createHTML(""):"",Ut=ce,Fs=Ut.implementation,ts=Ut.createNodeIterator,vs=Ut.createDocumentFragment,Be=Ut.getElementsByTagName,Il=re.importNode,ao={};try{ao=h(ce).documentMode?ce.documentMode:{}}catch{}var Vt={};te.isSupported=typeof wt=="function"&&Fs&&Fs.createHTMLDocument!==void 0&&ao!==9;var Wr=F,Et=oe,lo=ne,ag=ae,ui=fe,bs=G,Bi=se,Yt=me,Mt=null,is=b({},[].concat(s(x),s(I),s(B),s(U),s(L))),Dt=null,ff=b({},[].concat(s(X),s(q),s(le),s(D))),jt=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ur=null,kt=null,Yr=!0,_l=!0,Nl=!1,Pl=!0,Xo=!1,ho=!1,Ll=!1,Dl=!1,qo=!1,Xn=!1,jr=!1,kl=!0,mf=!1,lg="user-content-",Hl=!0,Ko=!1,ss={},co=null,pf=b({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),gf=null,Zo=b({},["audio","video","img","source","image","track"]),Qo=null,Fl=b({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Bs="http://www.w3.org/1998/Math/MathML",_i="http://www.w3.org/2000/svg",xs="http://www.w3.org/1999/xhtml",Jo=xs,Bl=!1,Vl=null,hg=b({},[Bs,_i,xs],Q),uo,cg=["application/xhtml+xml","text/html"],ug="text/html",Zt,er=null,Cf=ce.createElement("form"),wf=function(xe){return xe instanceof RegExp||xe instanceof Function},Wl=function(xe){er&&er===xe||((!xe||o(xe)!=="object")&&(xe={}),xe=h(xe),uo=cg.indexOf(xe.PARSER_MEDIA_TYPE)===-1?uo=ug:uo=xe.PARSER_MEDIA_TYPE,Zt=uo==="application/xhtml+xml"?Q:H,Mt="ALLOWED_TAGS"in xe?b({},xe.ALLOWED_TAGS,Zt):is,Dt="ALLOWED_ATTR"in xe?b({},xe.ALLOWED_ATTR,Zt):ff,Vl="ALLOWED_NAMESPACES"in xe?b({},xe.ALLOWED_NAMESPACES,Q):hg,Qo="ADD_URI_SAFE_ATTR"in xe?b(h(Fl),xe.ADD_URI_SAFE_ATTR,Zt):Fl,gf="ADD_DATA_URI_TAGS"in xe?b(h(Zo),xe.ADD_DATA_URI_TAGS,Zt):Zo,co="FORBID_CONTENTS"in xe?b({},xe.FORBID_CONTENTS,Zt):pf,Ur="FORBID_TAGS"in xe?b({},xe.FORBID_TAGS,Zt):{},kt="FORBID_ATTR"in xe?b({},xe.FORBID_ATTR,Zt):{},ss="USE_PROFILES"in xe?xe.USE_PROFILES:!1,Yr=xe.ALLOW_ARIA_ATTR!==!1,_l=xe.ALLOW_DATA_ATTR!==!1,Nl=xe.ALLOW_UNKNOWN_PROTOCOLS||!1,Pl=xe.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Xo=xe.SAFE_FOR_TEMPLATES||!1,ho=xe.WHOLE_DOCUMENT||!1,qo=xe.RETURN_DOM||!1,Xn=xe.RETURN_DOM_FRAGMENT||!1,jr=xe.RETURN_TRUSTED_TYPE||!1,Dl=xe.FORCE_BODY||!1,kl=xe.SANITIZE_DOM!==!1,mf=xe.SANITIZE_NAMED_PROPS||!1,Hl=xe.KEEP_CONTENT!==!1,Ko=xe.IN_PLACE||!1,Yt=xe.ALLOWED_URI_REGEXP||Yt,Jo=xe.NAMESPACE||xs,jt=xe.CUSTOM_ELEMENT_HANDLING||{},xe.CUSTOM_ELEMENT_HANDLING&&wf(xe.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(jt.tagNameCheck=xe.CUSTOM_ELEMENT_HANDLING.tagNameCheck),xe.CUSTOM_ELEMENT_HANDLING&&wf(xe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(jt.attributeNameCheck=xe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),xe.CUSTOM_ELEMENT_HANDLING&&typeof xe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(jt.allowCustomizedBuiltInElements=xe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Xo&&(_l=!1),Xn&&(qo=!0),ss&&(Mt=b({},s(L)),Dt=[],ss.html===!0&&(b(Mt,x),b(Dt,X)),ss.svg===!0&&(b(Mt,I),b(Dt,q),b(Dt,D)),ss.svgFilters===!0&&(b(Mt,B),b(Dt,q),b(Dt,D)),ss.mathMl===!0&&(b(Mt,U),b(Dt,le),b(Dt,D))),xe.ADD_TAGS&&(Mt===is&&(Mt=h(Mt)),b(Mt,xe.ADD_TAGS,Zt)),xe.ADD_ATTR&&(Dt===ff&&(Dt=h(Dt)),b(Dt,xe.ADD_ATTR,Zt)),xe.ADD_URI_SAFE_ATTR&&b(Qo,xe.ADD_URI_SAFE_ATTR,Zt),xe.FORBID_CONTENTS&&(co===pf&&(co=h(co)),b(co,xe.FORBID_CONTENTS,Zt)),Hl&&(Mt["#text"]=!0),ho&&b(Mt,["html","head","body"]),Mt.table&&(b(Mt,["tbody"]),delete Ur.tbody),S&&S(xe),er=xe)},yf=b({},["mi","mo","mn","ms","mtext"]),vf=b({},["foreignobject","desc","title","annotation-xml"]),dg=b({},["title","style","font","a","script"]),qn=b({},I);b(qn,B),b(qn,V);var Ul=b({},U);b(Ul,K);var fg=function(xe){var Le=wt(xe);(!Le||!Le.tagName)&&(Le={namespaceURI:Jo,tagName:"template"});var Fe=H(xe.tagName),bt=H(Le.tagName);return Vl[xe.namespaceURI]?xe.namespaceURI===_i?Le.namespaceURI===xs?Fe==="svg":Le.namespaceURI===Bs?Fe==="svg"&&(bt==="annotation-xml"||yf[bt]):!!qn[Fe]:xe.namespaceURI===Bs?Le.namespaceURI===xs?Fe==="math":Le.namespaceURI===_i?Fe==="math"&&vf[bt]:!!Ul[Fe]:xe.namespaceURI===xs?Le.namespaceURI===_i&&!vf[bt]||Le.namespaceURI===Bs&&!yf[bt]?!1:!Ul[Fe]&&(dg[Fe]||!qn[Fe]):!!(uo==="application/xhtml+xml"&&Vl[xe.namespaceURI]):!1},Ss=function(xe){$(te.removed,{element:xe});try{xe.parentNode.removeChild(xe)}catch{try{xe.outerHTML=wi}catch{xe.remove()}}},Yl=function(xe,Le){try{$(te.removed,{attribute:Le.getAttributeNode(xe),from:Le})}catch{$(te.removed,{attribute:null,from:Le})}if(Le.removeAttribute(xe),xe==="is"&&!Dt[xe])if(qo||Xn)try{Ss(Le)}catch{}else try{Le.setAttribute(xe,"")}catch{}},bf=function(xe){var Le,Fe;if(Dl)xe="<remove></remove>"+xe;else{var bt=Y(xe,/^[\r\n\t ]+/);Fe=bt&&bt[0]}uo==="application/xhtml+xml"&&Jo===xs&&(xe='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+xe+"</body></html>");var dt=qe?qe.createHTML(xe):xe;if(Jo===xs)try{Le=new Ne().parseFromString(dt,uo)}catch{}if(!Le||!Le.documentElement){Le=Fs.createDocument(Jo,"template",null);try{Le.documentElement.innerHTML=Bl?wi:dt}catch{}}var Qt=Le.body||Le.documentElement;return xe&&Fe&&Qt.insertBefore(ce.createTextNode(Fe),Qt.childNodes[0]||null),Jo===xs?Be.call(Le,ho?"html":"body")[0]:ho?Le.documentElement:Qt},xf=function(xe){return ts.call(xe.ownerDocument||xe,xe,Se.SHOW_ELEMENT|Se.SHOW_COMMENT|Se.SHOW_TEXT,null,!1)},mg=function(xe){return xe instanceof Ae&&(typeof xe.nodeName!="string"||typeof xe.textContent!="string"||typeof xe.removeChild!="function"||!(xe.attributes instanceof Re)||typeof xe.removeAttribute!="function"||typeof xe.setAttribute!="function"||typeof xe.namespaceURI!="string"||typeof xe.insertBefore!="function"||typeof xe.hasChildNodes!="function")},Gr=function(xe){return o(ye)==="object"?xe instanceof ye:xe&&o(xe)==="object"&&typeof xe.nodeType=="number"&&typeof xe.nodeName=="string"},Es=function(xe,Le,Fe){Vt[xe]&&k(Vt[xe],function(bt){bt.call(te,Le,Fe,er)})},Kn=function(xe){var Le;if(Es("beforeSanitizeElements",xe,null),mg(xe)||v(/[\u0080-\uFFFF]/,xe.nodeName))return Ss(xe),!0;var Fe=Zt(xe.nodeName);if(Es("uponSanitizeElement",xe,{tagName:Fe,allowedTags:Mt}),xe.hasChildNodes()&&!Gr(xe.firstElementChild)&&(!Gr(xe.content)||!Gr(xe.content.firstElementChild))&&v(/<[/\w]/g,xe.innerHTML)&&v(/<[/\w]/g,xe.textContent)||Fe==="select"&&v(/<template/i,xe.innerHTML))return Ss(xe),!0;if(!Mt[Fe]||Ur[Fe]){if(!Ur[Fe]&&Sf(Fe)&&(jt.tagNameCheck instanceof RegExp&&v(jt.tagNameCheck,Fe)||jt.tagNameCheck instanceof Function&&jt.tagNameCheck(Fe)))return!1;if(Hl&&!co[Fe]){var bt=wt(xe)||xe.parentNode,dt=It(xe)||xe.childNodes;if(dt&&bt)for(var Qt=dt.length,Gt=Qt-1;Gt>=0;--Gt)bt.insertBefore(it(dt[Gt],!0),rt(xe))}return Ss(xe),!0}return xe instanceof Ee&&!fg(xe)||(Fe==="noscript"||Fe==="noembed"||Fe==="noframes")&&v(/<\/no(script|embed|frames)/i,xe.innerHTML)?(Ss(xe),!0):(Xo&&xe.nodeType===3&&(Le=xe.textContent,Le=P(Le,Wr," "),Le=P(Le,Et," "),Le=P(Le,lo," "),xe.textContent!==Le&&($(te.removed,{element:xe.cloneNode()}),xe.textContent=Le)),Es("afterSanitizeElements",xe,null),!1)},Zn=function(xe,Le,Fe){if(kl&&(Le==="id"||Le==="name")&&(Fe in ce||Fe in Cf))return!1;if(!(_l&&!kt[Le]&&v(ag,Le))){if(!(Yr&&v(ui,Le))){if(!Dt[Le]||kt[Le]){if(!(Sf(xe)&&(jt.tagNameCheck instanceof RegExp&&v(jt.tagNameCheck,xe)||jt.tagNameCheck instanceof Function&&jt.tagNameCheck(xe))&&(jt.attributeNameCheck instanceof RegExp&&v(jt.attributeNameCheck,Le)||jt.attributeNameCheck instanceof Function&&jt.attributeNameCheck(Le))||Le==="is"&&jt.allowCustomizedBuiltInElements&&(jt.tagNameCheck instanceof RegExp&&v(jt.tagNameCheck,Fe)||jt.tagNameCheck instanceof Function&&jt.tagNameCheck(Fe))))return!1}else if(!Qo[Le]){if(!v(Yt,P(Fe,Bi,""))){if(!((Le==="src"||Le==="xlink:href"||Le==="href")&&xe!=="script"&&j(Fe,"data:")===0&&gf[xe])){if(!(Nl&&!v(bs,P(Fe,Bi,"")))){if(Fe)return!1}}}}}}return!0},Sf=function(xe){return xe.indexOf("-")>0},jl=function(xe){var Le,Fe,bt,dt;Es("beforeSanitizeAttributes",xe,null);var Qt=xe.attributes;if(Qt){var Gt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Dt};for(dt=Qt.length;dt--;){Le=Qt[dt];var Qn=Le,ti=Qn.name,Gl=Qn.namespaceURI;if(Fe=ti==="value"?Le.value:A(Le.value),bt=Zt(ti),Gt.attrName=bt,Gt.attrValue=Fe,Gt.keepAttr=!0,Gt.forceKeepAttr=void 0,Es("uponSanitizeAttribute",xe,Gt),Fe=Gt.attrValue,!Gt.forceKeepAttr&&(Yl(ti,xe),!!Gt.keepAttr)){if(!Pl&&v(/\/>/i,Fe)){Yl(ti,xe);continue}Xo&&(Fe=P(Fe,Wr," "),Fe=P(Fe,Et," "),Fe=P(Fe,lo," "));var Tf=Zt(xe.nodeName);if(Zn(Tf,bt,Fe)){if(mf&&(bt==="id"||bt==="name")&&(Yl(ti,xe),Fe=lg+Fe),qe&&o(Me)==="object"&&typeof Me.getAttributeType=="function"&&!Gl)switch(Me.getAttributeType(Tf,bt)){case"TrustedHTML":{Fe=qe.createHTML(Fe);break}case"TrustedScriptURL":{Fe=qe.createScriptURL(Fe);break}}try{Gl?xe.setAttributeNS(Gl,ti,Fe):xe.setAttribute(ti,Fe),ie(te.removed)}catch{}}}}Es("afterSanitizeAttributes",xe,null)}},Ef=function Ke(xe){var Le,Fe=xf(xe);for(Es("beforeSanitizeShadowDOM",xe,null);Le=Fe.nextNode();)Es("uponSanitizeShadowNode",Le,null),!Kn(Le)&&(Le.content instanceof Ce&&Ke(Le.content),jl(Le));Es("afterSanitizeShadowDOM",xe,null)};return te.sanitize=function(Ke){var xe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Le,Fe,bt,dt,Qt;if(Bl=!Ke,Bl&&(Ke="<!-->"),typeof Ke!="string"&&!Gr(Ke))if(typeof Ke.toString=="function"){if(Ke=Ke.toString(),typeof Ke!="string")throw R("dirty is not a string, aborting")}else throw R("toString is not a function");if(!te.isSupported){if(o(Z.toStaticHTML)==="object"||typeof Z.toStaticHTML=="function"){if(typeof Ke=="string")return Z.toStaticHTML(Ke);if(Gr(Ke))return Z.toStaticHTML(Ke.outerHTML)}return Ke}if(Ll||Wl(xe),te.removed=[],typeof Ke=="string"&&(Ko=!1),Ko){if(Ke.nodeName){var Gt=Zt(Ke.nodeName);if(!Mt[Gt]||Ur[Gt])throw R("root node is forbidden and cannot be sanitized in-place")}}else if(Ke instanceof ye)Le=bf("<!---->"),Fe=Le.ownerDocument.importNode(Ke,!0),Fe.nodeType===1&&Fe.nodeName==="BODY"||Fe.nodeName==="HTML"?Le=Fe:Le.appendChild(Fe);else{if(!qo&&!Xo&&!ho&&Ke.indexOf("<")===-1)return qe&&jr?qe.createHTML(Ke):Ke;if(Le=bf(Ke),!Le)return qo?null:jr?wi:""}Le&&Dl&&Ss(Le.firstChild);for(var Qn=xf(Ko?Ke:Le);bt=Qn.nextNode();)bt.nodeType===3&&bt===dt||Kn(bt)||(bt.content instanceof Ce&&Ef(bt.content),jl(bt),dt=bt);if(dt=null,Ko)return Ke;if(qo){if(Xn)for(Qt=vs.call(Le.ownerDocument);Le.firstChild;)Qt.appendChild(Le.firstChild);else Qt=Le;return(Dt.shadowroot||Dt.shadowrootmod)&&(Qt=Il.call(re,Qt,!0)),Qt}var ti=ho?Le.outerHTML:Le.innerHTML;return ho&&Mt["!doctype"]&&Le.ownerDocument&&Le.ownerDocument.doctype&&Le.ownerDocument.doctype.name&&v(ee,Le.ownerDocument.doctype.name)&&(ti="<!DOCTYPE "+Le.ownerDocument.doctype.name+`>
`+ti),Xo&&(ti=P(ti,Wr," "),ti=P(ti,Et," "),ti=P(ti,lo," ")),qe&&jr?qe.createHTML(ti):ti},te.setConfig=function(Ke){Wl(Ke),Ll=!0},te.clearConfig=function(){er=null,Ll=!1},te.isValidAttribute=function(Ke,xe,Le){er||Wl({});var Fe=Zt(Ke),bt=Zt(xe);return Zn(Fe,bt,Le)},te.addHook=function(Ke,xe){typeof xe=="function"&&(Vt[Ke]=Vt[Ke]||[],$(Vt[Ke],xe))},te.removeHook=function(Ke){if(Vt[Ke])return ie(Vt[Ke])},te.removeHooks=function(Ke){Vt[Ke]&&(Vt[Ke]=[])},te.removeAllHooks=function(){Vt={}},te}var z=W();return z})});var Ui=Ie((kC,la)=>{"use strict";(function(o,e){typeof kC=="object"&&typeof la<"u"?la.exports=e():typeof define=="function"&&define.amd?define(e):o.moment=e()})(kC,function(){"use strict";var o;function e(){return o.apply(null,arguments)}function t(d){o=d}function i(d){return d instanceof Array||Object.prototype.toString.call(d)==="[object Array]"}function s(d){return d!=null&&Object.prototype.toString.call(d)==="[object Object]"}function r(d,T){return Object.prototype.hasOwnProperty.call(d,T)}function n(d){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(d).length===0;var T;for(T in d)if(r(d,T))return!1;return!0}function a(d){return d===void 0}function l(d){return typeof d=="number"||Object.prototype.toString.call(d)==="[object Number]"}function c(d){return d instanceof Date||Object.prototype.toString.call(d)==="[object Date]"}function u(d,T){var J=[],he,pe=d.length;for(he=0;he<pe;++he)J.push(T(d[he],he));return J}function g(d,T){for(var J in T)r(T,J)&&(d[J]=T[J]);return r(T,"toString")&&(d.toString=T.toString),r(T,"valueOf")&&(d.valueOf=T.valueOf),d}function p(d,T,J,he){return jS(d,T,J,he,!0).utc()}function C(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function y(d){return d._pf==null&&(d._pf=C()),d._pf}var S;Array.prototype.some?S=Array.prototype.some:S=function(d){var T=Object(this),J=T.length>>>0,he;for(he=0;he<J;he++)if(he in T&&d.call(this,T[he],he,T))return!0;return!1};function O(d){if(d._isValid==null){var T=y(d),J=S.call(T.parsedDateParts,function(pe){return pe!=null}),he=!isNaN(d._d.getTime())&&T.overflow<0&&!T.empty&&!T.invalidEra&&!T.invalidMonth&&!T.invalidWeekday&&!T.weekdayMismatch&&!T.nullInput&&!T.invalidFormat&&!T.userInvalidated&&(!T.meridiem||T.meridiem&&J);if(d._strict&&(he=he&&T.charsLeftOver===0&&T.unusedTokens.length===0&&T.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(d))d._isValid=he;else return he}return d._isValid}function M(d){var T=p(NaN);return d!=null?g(y(T),d):y(T).userInvalidated=!0,T}var _=e.momentProperties=[],N=!1;function E(d,T){var J,he,pe,ve=_.length;if(a(T._isAMomentObject)||(d._isAMomentObject=T._isAMomentObject),a(T._i)||(d._i=T._i),a(T._f)||(d._f=T._f),a(T._l)||(d._l=T._l),a(T._strict)||(d._strict=T._strict),a(T._tzm)||(d._tzm=T._tzm),a(T._isUTC)||(d._isUTC=T._isUTC),a(T._offset)||(d._offset=T._offset),a(T._pf)||(d._pf=y(T)),a(T._locale)||(d._locale=T._locale),ve>0)for(J=0;J<ve;J++)he=_[J],pe=T[he],a(pe)||(d[he]=pe);return d}function k(d){E(this,d),this._d=new Date(d._d!=null?d._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),N===!1&&(N=!0,e.updateOffset(this),N=!1)}function ie(d){return d instanceof k||d!=null&&d._isAMomentObject!=null}function $(d){e.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+d)}function H(d,T){var J=!0;return g(function(){if(e.deprecationHandler!=null&&e.deprecationHandler(null,d),J){var he=[],pe,ve,Oe,Qe=arguments.length;for(ve=0;ve<Qe;ve++){if(pe="",typeof arguments[ve]=="object"){pe+=`
[`+ve+"] ";for(Oe in arguments[0])r(arguments[0],Oe)&&(pe+=Oe+": "+arguments[0][Oe]+", ");pe=pe.slice(0,-2)}else pe=arguments[ve];he.push(pe)}$(d+`
Arguments: `+Array.prototype.slice.call(he).join("")+`
`+new Error().stack),J=!1}return T.apply(this,arguments)},T)}var Q={};function Y(d,T){e.deprecationHandler!=null&&e.deprecationHandler(d,T),Q[d]||($(T),Q[d]=!0)}e.suppressDeprecationWarnings=!1,e.deprecationHandler=null;function P(d){return typeof Function<"u"&&d instanceof Function||Object.prototype.toString.call(d)==="[object Function]"}function j(d){var T,J;for(J in d)r(d,J)&&(T=d[J],P(T)?this[J]=T:this["_"+J]=T);this._config=d,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function A(d,T){var J=g({},d),he;for(he in T)r(T,he)&&(s(d[he])&&s(T[he])?(J[he]={},g(J[he],d[he]),g(J[he],T[he])):T[he]!=null?J[he]=T[he]:delete J[he]);for(he in d)r(d,he)&&!r(T,he)&&s(d[he])&&(J[he]=g({},J[he]));return J}function v(d){d!=null&&this.set(d)}var R;Object.keys?R=Object.keys:R=function(d){var T,J=[];for(T in d)r(d,T)&&J.push(T);return J};var f={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function w(d,T,J){var he=this._calendar[d]||this._calendar.sameElse;return P(he)?he.call(T,J):he}function b(d,T,J){var he=""+Math.abs(d),pe=T-he.length,ve=d>=0;return(ve?J?"+":"":"-")+Math.pow(10,Math.max(0,pe)).toString().substr(1)+he}var h=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,m=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,x={},I={};function B(d,T,J,he){var pe=he;typeof he=="string"&&(pe=function(){return this[he]()}),d&&(I[d]=pe),T&&(I[T[0]]=function(){return b(pe.apply(this,arguments),T[1],T[2])}),J&&(I[J]=function(){return this.localeData().ordinal(pe.apply(this,arguments),d)})}function V(d){return d.match(/\[[\s\S]/)?d.replace(/^\[|\]$/g,""):d.replace(/\\/g,"")}function U(d){var T=d.match(h),J,he;for(J=0,he=T.length;J<he;J++)I[T[J]]?T[J]=I[T[J]]:T[J]=V(T[J]);return function(pe){var ve="",Oe;for(Oe=0;Oe<he;Oe++)ve+=P(T[Oe])?T[Oe].call(pe,d):T[Oe];return ve}}function K(d,T){return d.isValid()?(T=L(T,d.localeData()),x[T]=x[T]||U(T),x[T](d)):d.localeData().invalidDate()}function L(d,T){var J=5;function he(pe){return T.longDateFormat(pe)||pe}for(m.lastIndex=0;J>=0&&m.test(d);)d=d.replace(m,he),m.lastIndex=0,J-=1;return d}var X={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function q(d){var T=this._longDateFormat[d],J=this._longDateFormat[d.toUpperCase()];return T||!J?T:(this._longDateFormat[d]=J.match(h).map(function(he){return he==="MMMM"||he==="MM"||he==="DD"||he==="dddd"?he.slice(1):he}).join(""),this._longDateFormat[d])}var le="Invalid date";function D(){return this._invalidDate}var F="%d",oe=/\d{1,2}/;function ne(d){return this._ordinal.replace("%d",d)}var ae={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function fe(d,T,J,he){var pe=this._relativeTime[J];return P(pe)?pe(d,T,J,he):pe.replace(/%d/i,d)}function me(d,T){var J=this._relativeTime[d>0?"future":"past"];return P(J)?J(T):J.replace(/%s/i,T)}var G={};function se(d,T){var J=d.toLowerCase();G[J]=G[J+"s"]=G[T]=d}function ee(d){return typeof d=="string"?G[d]||G[d.toLowerCase()]:void 0}function ue(d){var T={},J,he;for(he in d)r(d,he)&&(J=ee(he),J&&(T[J]=d[he]));return T}var de={};function W(d,T){de[d]=T}function z(d){var T=[],J;for(J in d)r(d,J)&&T.push({unit:J,priority:de[J]});return T.sort(function(he,pe){return he.priority-pe.priority}),T}function Z(d){return d%4===0&&d%100!==0||d%400===0}function te(d){return d<0?Math.ceil(d)||0:Math.floor(d)}function re(d){var T=+d,J=0;return T!==0&&isFinite(T)&&(J=te(T)),J}function ce(d,T){return function(J){return J!=null?(ge(this,d,J),e.updateOffset(this,T),this):Ce(this,d)}}function Ce(d,T){return d.isValid()?d._d["get"+(d._isUTC?"UTC":"")+T]():NaN}function ge(d,T,J){d.isValid()&&!isNaN(J)&&(T==="FullYear"&&Z(d.year())&&d.month()===1&&d.date()===29?(J=re(J),d._d["set"+(d._isUTC?"UTC":"")+T](J,d.month(),Yr(J,d.month()))):d._d["set"+(d._isUTC?"UTC":"")+T](J))}function ye(d){return d=ee(d),P(this[d])?this[d]():this}function Ee(d,T){if(typeof d=="object"){d=ue(d);var J=z(d),he,pe=J.length;for(he=0;he<pe;he++)this[J[he].unit](d[J[he].unit])}else if(d=ee(d),P(this[d]))return this[d](T);return this}var Se=/\d/,be=/\d\d/,Re=/\d{3}/,Ae=/\d{4}/,Ne=/[+-]?\d{6}/,Me=/\d\d?/,Ze=/\d\d\d\d?/,it=/\d\d\d\d\d\d?/,rt=/\d{1,3}/,It=/\d{1,4}/,wt=/[+-]?\d{1,6}/,ct=/\d+/,qe=/[+-]?\d+/,wi=/Z|[+-]\d\d:?\d\d/gi,Ut=/Z|[+-]\d\d(?::?\d\d)?/gi,Fs=/[+-]?\d+(\.\d{1,3})?/,ts=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,vs;vs={};function Be(d,T,J){vs[d]=P(T)?T:function(he,pe){return he&&J?J:T}}function Il(d,T){return r(vs,d)?vs[d](T._strict,T._locale):new RegExp(ao(d))}function ao(d){return Vt(d.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(T,J,he,pe,ve){return J||he||pe||ve}))}function Vt(d){return d.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Wr={};function Et(d,T){var J,he=T,pe;for(typeof d=="string"&&(d=[d]),l(T)&&(he=function(ve,Oe){Oe[T]=re(ve)}),pe=d.length,J=0;J<pe;J++)Wr[d[J]]=he}function lo(d,T){Et(d,function(J,he,pe,ve){pe._w=pe._w||{},T(J,pe._w,pe,ve)})}function ag(d,T,J){T!=null&&r(Wr,d)&&Wr[d](T,J._a,J,d)}var ui=0,bs=1,Bi=2,Yt=3,Mt=4,is=5,Dt=6,ff=7,jt=8;function Ur(d,T){return(d%T+T)%T}var kt;Array.prototype.indexOf?kt=Array.prototype.indexOf:kt=function(d){var T;for(T=0;T<this.length;++T)if(this[T]===d)return T;return-1};function Yr(d,T){if(isNaN(d)||isNaN(T))return NaN;var J=Ur(T,12);return d+=(T-J)/12,J===1?Z(d)?29:28:31-J%7%2}B("M",["MM",2],"Mo",function(){return this.month()+1}),B("MMM",0,0,function(d){return this.localeData().monthsShort(this,d)}),B("MMMM",0,0,function(d){return this.localeData().months(this,d)}),se("month","M"),W("month",8),Be("M",Me),Be("MM",Me,be),Be("MMM",function(d,T){return T.monthsShortRegex(d)}),Be("MMMM",function(d,T){return T.monthsRegex(d)}),Et(["M","MM"],function(d,T){T[bs]=re(d)-1}),Et(["MMM","MMMM"],function(d,T,J,he){var pe=J._locale.monthsParse(d,he,J._strict);pe!=null?T[bs]=pe:y(J).invalidMonth=d});var _l="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Nl="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Pl=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Xo=ts,ho=ts;function Ll(d,T){return d?i(this._months)?this._months[d.month()]:this._months[(this._months.isFormat||Pl).test(T)?"format":"standalone"][d.month()]:i(this._months)?this._months:this._months.standalone}function Dl(d,T){return d?i(this._monthsShort)?this._monthsShort[d.month()]:this._monthsShort[Pl.test(T)?"format":"standalone"][d.month()]:i(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function qo(d,T,J){var he,pe,ve,Oe=d.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],he=0;he<12;++he)ve=p([2e3,he]),this._shortMonthsParse[he]=this.monthsShort(ve,"").toLocaleLowerCase(),this._longMonthsParse[he]=this.months(ve,"").toLocaleLowerCase();return J?T==="MMM"?(pe=kt.call(this._shortMonthsParse,Oe),pe!==-1?pe:null):(pe=kt.call(this._longMonthsParse,Oe),pe!==-1?pe:null):T==="MMM"?(pe=kt.call(this._shortMonthsParse,Oe),pe!==-1?pe:(pe=kt.call(this._longMonthsParse,Oe),pe!==-1?pe:null)):(pe=kt.call(this._longMonthsParse,Oe),pe!==-1?pe:(pe=kt.call(this._shortMonthsParse,Oe),pe!==-1?pe:null))}function Xn(d,T,J){var he,pe,ve;if(this._monthsParseExact)return qo.call(this,d,T,J);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),he=0;he<12;he++){if(pe=p([2e3,he]),J&&!this._longMonthsParse[he]&&(this._longMonthsParse[he]=new RegExp("^"+this.months(pe,"").replace(".","")+"$","i"),this._shortMonthsParse[he]=new RegExp("^"+this.monthsShort(pe,"").replace(".","")+"$","i")),!J&&!this._monthsParse[he]&&(ve="^"+this.months(pe,"")+"|^"+this.monthsShort(pe,""),this._monthsParse[he]=new RegExp(ve.replace(".",""),"i")),J&&T==="MMMM"&&this._longMonthsParse[he].test(d))return he;if(J&&T==="MMM"&&this._shortMonthsParse[he].test(d))return he;if(!J&&this._monthsParse[he].test(d))return he}}function jr(d,T){var J;if(!d.isValid())return d;if(typeof T=="string"){if(/^\d+$/.test(T))T=re(T);else if(T=d.localeData().monthsParse(T),!l(T))return d}return J=Math.min(d.date(),Yr(d.year(),T)),d._d["set"+(d._isUTC?"UTC":"")+"Month"](T,J),d}function kl(d){return d!=null?(jr(this,d),e.updateOffset(this,!0),this):Ce(this,"Month")}function mf(){return Yr(this.year(),this.month())}function lg(d){return this._monthsParseExact?(r(this,"_monthsRegex")||Ko.call(this),d?this._monthsShortStrictRegex:this._monthsShortRegex):(r(this,"_monthsShortRegex")||(this._monthsShortRegex=Xo),this._monthsShortStrictRegex&&d?this._monthsShortStrictRegex:this._monthsShortRegex)}function Hl(d){return this._monthsParseExact?(r(this,"_monthsRegex")||Ko.call(this),d?this._monthsStrictRegex:this._monthsRegex):(r(this,"_monthsRegex")||(this._monthsRegex=ho),this._monthsStrictRegex&&d?this._monthsStrictRegex:this._monthsRegex)}function Ko(){function d(Oe,Qe){return Qe.length-Oe.length}var T=[],J=[],he=[],pe,ve;for(pe=0;pe<12;pe++)ve=p([2e3,pe]),T.push(this.monthsShort(ve,"")),J.push(this.months(ve,"")),he.push(this.months(ve,"")),he.push(this.monthsShort(ve,""));for(T.sort(d),J.sort(d),he.sort(d),pe=0;pe<12;pe++)T[pe]=Vt(T[pe]),J[pe]=Vt(J[pe]);for(pe=0;pe<24;pe++)he[pe]=Vt(he[pe]);this._monthsRegex=new RegExp("^("+he.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+J.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+T.join("|")+")","i")}B("Y",0,0,function(){var d=this.year();return d<=9999?b(d,4):"+"+d}),B(0,["YY",2],0,function(){return this.year()%100}),B(0,["YYYY",4],0,"year"),B(0,["YYYYY",5],0,"year"),B(0,["YYYYYY",6,!0],0,"year"),se("year","y"),W("year",1),Be("Y",qe),Be("YY",Me,be),Be("YYYY",It,Ae),Be("YYYYY",wt,Ne),Be("YYYYYY",wt,Ne),Et(["YYYYY","YYYYYY"],ui),Et("YYYY",function(d,T){T[ui]=d.length===2?e.parseTwoDigitYear(d):re(d)}),Et("YY",function(d,T){T[ui]=e.parseTwoDigitYear(d)}),Et("Y",function(d,T){T[ui]=parseInt(d,10)});function ss(d){return Z(d)?366:365}e.parseTwoDigitYear=function(d){return re(d)+(re(d)>68?1900:2e3)};var co=ce("FullYear",!0);function pf(){return Z(this.year())}function gf(d,T,J,he,pe,ve,Oe){var Qe;return d<100&&d>=0?(Qe=new Date(d+400,T,J,he,pe,ve,Oe),isFinite(Qe.getFullYear())&&Qe.setFullYear(d)):Qe=new Date(d,T,J,he,pe,ve,Oe),Qe}function Zo(d){var T,J;return d<100&&d>=0?(J=Array.prototype.slice.call(arguments),J[0]=d+400,T=new Date(Date.UTC.apply(null,J)),isFinite(T.getUTCFullYear())&&T.setUTCFullYear(d)):T=new Date(Date.UTC.apply(null,arguments)),T}function Qo(d,T,J){var he=7+T-J,pe=(7+Zo(d,0,he).getUTCDay()-T)%7;return-pe+he-1}function Fl(d,T,J,he,pe){var ve=(7+J-he)%7,Oe=Qo(d,he,pe),Qe=1+7*(T-1)+ve+Oe,ut,_t;return Qe<=0?(ut=d-1,_t=ss(ut)+Qe):Qe>ss(d)?(ut=d+1,_t=Qe-ss(d)):(ut=d,_t=Qe),{year:ut,dayOfYear:_t}}function Bs(d,T,J){var he=Qo(d.year(),T,J),pe=Math.floor((d.dayOfYear()-he-1)/7)+1,ve,Oe;return pe<1?(Oe=d.year()-1,ve=pe+_i(Oe,T,J)):pe>_i(d.year(),T,J)?(ve=pe-_i(d.year(),T,J),Oe=d.year()+1):(Oe=d.year(),ve=pe),{week:ve,year:Oe}}function _i(d,T,J){var he=Qo(d,T,J),pe=Qo(d+1,T,J);return(ss(d)-he+pe)/7}B("w",["ww",2],"wo","week"),B("W",["WW",2],"Wo","isoWeek"),se("week","w"),se("isoWeek","W"),W("week",5),W("isoWeek",5),Be("w",Me),Be("ww",Me,be),Be("W",Me),Be("WW",Me,be),lo(["w","ww","W","WW"],function(d,T,J,he){T[he.substr(0,1)]=re(d)});function xs(d){return Bs(d,this._week.dow,this._week.doy).week}var Jo={dow:0,doy:6};function Bl(){return this._week.dow}function Vl(){return this._week.doy}function hg(d){var T=this.localeData().week(this);return d==null?T:this.add((d-T)*7,"d")}function uo(d){var T=Bs(this,1,4).week;return d==null?T:this.add((d-T)*7,"d")}B("d",0,"do","day"),B("dd",0,0,function(d){return this.localeData().weekdaysMin(this,d)}),B("ddd",0,0,function(d){return this.localeData().weekdaysShort(this,d)}),B("dddd",0,0,function(d){return this.localeData().weekdays(this,d)}),B("e",0,0,"weekday"),B("E",0,0,"isoWeekday"),se("day","d"),se("weekday","e"),se("isoWeekday","E"),W("day",11),W("weekday",11),W("isoWeekday",11),Be("d",Me),Be("e",Me),Be("E",Me),Be("dd",function(d,T){return T.weekdaysMinRegex(d)}),Be("ddd",function(d,T){return T.weekdaysShortRegex(d)}),Be("dddd",function(d,T){return T.weekdaysRegex(d)}),lo(["dd","ddd","dddd"],function(d,T,J,he){var pe=J._locale.weekdaysParse(d,he,J._strict);pe!=null?T.d=pe:y(J).invalidWeekday=d}),lo(["d","e","E"],function(d,T,J,he){T[he]=re(d)});function cg(d,T){return typeof d!="string"?d:isNaN(d)?(d=T.weekdaysParse(d),typeof d=="number"?d:null):parseInt(d,10)}function ug(d,T){return typeof d=="string"?T.weekdaysParse(d)%7||7:isNaN(d)?null:d}function Zt(d,T){return d.slice(T,7).concat(d.slice(0,T))}var er="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Cf="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),wf="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Wl=ts,yf=ts,vf=ts;function dg(d,T){var J=i(this._weekdays)?this._weekdays:this._weekdays[d&&d!==!0&&this._weekdays.isFormat.test(T)?"format":"standalone"];return d===!0?Zt(J,this._week.dow):d?J[d.day()]:J}function qn(d){return d===!0?Zt(this._weekdaysShort,this._week.dow):d?this._weekdaysShort[d.day()]:this._weekdaysShort}function Ul(d){return d===!0?Zt(this._weekdaysMin,this._week.dow):d?this._weekdaysMin[d.day()]:this._weekdaysMin}function fg(d,T,J){var he,pe,ve,Oe=d.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],he=0;he<7;++he)ve=p([2e3,1]).day(he),this._minWeekdaysParse[he]=this.weekdaysMin(ve,"").toLocaleLowerCase(),this._shortWeekdaysParse[he]=this.weekdaysShort(ve,"").toLocaleLowerCase(),this._weekdaysParse[he]=this.weekdays(ve,"").toLocaleLowerCase();return J?T==="dddd"?(pe=kt.call(this._weekdaysParse,Oe),pe!==-1?pe:null):T==="ddd"?(pe=kt.call(this._shortWeekdaysParse,Oe),pe!==-1?pe:null):(pe=kt.call(this._minWeekdaysParse,Oe),pe!==-1?pe:null):T==="dddd"?(pe=kt.call(this._weekdaysParse,Oe),pe!==-1||(pe=kt.call(this._shortWeekdaysParse,Oe),pe!==-1)?pe:(pe=kt.call(this._minWeekdaysParse,Oe),pe!==-1?pe:null)):T==="ddd"?(pe=kt.call(this._shortWeekdaysParse,Oe),pe!==-1||(pe=kt.call(this._weekdaysParse,Oe),pe!==-1)?pe:(pe=kt.call(this._minWeekdaysParse,Oe),pe!==-1?pe:null)):(pe=kt.call(this._minWeekdaysParse,Oe),pe!==-1||(pe=kt.call(this._weekdaysParse,Oe),pe!==-1)?pe:(pe=kt.call(this._shortWeekdaysParse,Oe),pe!==-1?pe:null))}function Ss(d,T,J){var he,pe,ve;if(this._weekdaysParseExact)return fg.call(this,d,T,J);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),he=0;he<7;he++){if(pe=p([2e3,1]).day(he),J&&!this._fullWeekdaysParse[he]&&(this._fullWeekdaysParse[he]=new RegExp("^"+this.weekdays(pe,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[he]=new RegExp("^"+this.weekdaysShort(pe,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[he]=new RegExp("^"+this.weekdaysMin(pe,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[he]||(ve="^"+this.weekdays(pe,"")+"|^"+this.weekdaysShort(pe,"")+"|^"+this.weekdaysMin(pe,""),this._weekdaysParse[he]=new RegExp(ve.replace(".",""),"i")),J&&T==="dddd"&&this._fullWeekdaysParse[he].test(d))return he;if(J&&T==="ddd"&&this._shortWeekdaysParse[he].test(d))return he;if(J&&T==="dd"&&this._minWeekdaysParse[he].test(d))return he;if(!J&&this._weekdaysParse[he].test(d))return he}}function Yl(d){if(!this.isValid())return d!=null?this:NaN;var T=this._isUTC?this._d.getUTCDay():this._d.getDay();return d!=null?(d=cg(d,this.localeData()),this.add(d-T,"d")):T}function bf(d){if(!this.isValid())return d!=null?this:NaN;var T=(this.day()+7-this.localeData()._week.dow)%7;return d==null?T:this.add(d-T,"d")}function xf(d){if(!this.isValid())return d!=null?this:NaN;if(d!=null){var T=ug(d,this.localeData());return this.day(this.day()%7?T:T-7)}else return this.day()||7}function mg(d){return this._weekdaysParseExact?(r(this,"_weekdaysRegex")||Kn.call(this),d?this._weekdaysStrictRegex:this._weekdaysRegex):(r(this,"_weekdaysRegex")||(this._weekdaysRegex=Wl),this._weekdaysStrictRegex&&d?this._weekdaysStrictRegex:this._weekdaysRegex)}function Gr(d){return this._weekdaysParseExact?(r(this,"_weekdaysRegex")||Kn.call(this),d?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(r(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=yf),this._weekdaysShortStrictRegex&&d?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Es(d){return this._weekdaysParseExact?(r(this,"_weekdaysRegex")||Kn.call(this),d?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(r(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=vf),this._weekdaysMinStrictRegex&&d?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Kn(){function d(Ti,Co){return Co.length-Ti.length}var T=[],J=[],he=[],pe=[],ve,Oe,Qe,ut,_t;for(ve=0;ve<7;ve++)Oe=p([2e3,1]).day(ve),Qe=Vt(this.weekdaysMin(Oe,"")),ut=Vt(this.weekdaysShort(Oe,"")),_t=Vt(this.weekdays(Oe,"")),T.push(Qe),J.push(ut),he.push(_t),pe.push(Qe),pe.push(ut),pe.push(_t);T.sort(d),J.sort(d),he.sort(d),pe.sort(d),this._weekdaysRegex=new RegExp("^("+pe.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+he.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+J.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+T.join("|")+")","i")}function Zn(){return this.hours()%12||12}function Sf(){return this.hours()||24}B("H",["HH",2],0,"hour"),B("h",["hh",2],0,Zn),B("k",["kk",2],0,Sf),B("hmm",0,0,function(){return""+Zn.apply(this)+b(this.minutes(),2)}),B("hmmss",0,0,function(){return""+Zn.apply(this)+b(this.minutes(),2)+b(this.seconds(),2)}),B("Hmm",0,0,function(){return""+this.hours()+b(this.minutes(),2)}),B("Hmmss",0,0,function(){return""+this.hours()+b(this.minutes(),2)+b(this.seconds(),2)});function jl(d,T){B(d,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),T)})}jl("a",!0),jl("A",!1),se("hour","h"),W("hour",13);function Ef(d,T){return T._meridiemParse}Be("a",Ef),Be("A",Ef),Be("H",Me),Be("h",Me),Be("k",Me),Be("HH",Me,be),Be("hh",Me,be),Be("kk",Me,be),Be("hmm",Ze),Be("hmmss",it),Be("Hmm",Ze),Be("Hmmss",it),Et(["H","HH"],Yt),Et(["k","kk"],function(d,T,J){var he=re(d);T[Yt]=he===24?0:he}),Et(["a","A"],function(d,T,J){J._isPm=J._locale.isPM(d),J._meridiem=d}),Et(["h","hh"],function(d,T,J){T[Yt]=re(d),y(J).bigHour=!0}),Et("hmm",function(d,T,J){var he=d.length-2;T[Yt]=re(d.substr(0,he)),T[Mt]=re(d.substr(he)),y(J).bigHour=!0}),Et("hmmss",function(d,T,J){var he=d.length-4,pe=d.length-2;T[Yt]=re(d.substr(0,he)),T[Mt]=re(d.substr(he,2)),T[is]=re(d.substr(pe)),y(J).bigHour=!0}),Et("Hmm",function(d,T,J){var he=d.length-2;T[Yt]=re(d.substr(0,he)),T[Mt]=re(d.substr(he))}),Et("Hmmss",function(d,T,J){var he=d.length-4,pe=d.length-2;T[Yt]=re(d.substr(0,he)),T[Mt]=re(d.substr(he,2)),T[is]=re(d.substr(pe))});function Ke(d){return(d+"").toLowerCase().charAt(0)==="p"}var xe=/[ap]\.?m?\.?/i,Le=ce("Hours",!0);function Fe(d,T,J){return d>11?J?"pm":"PM":J?"am":"AM"}var bt={calendar:f,longDateFormat:X,invalidDate:le,ordinal:F,dayOfMonthOrdinalParse:oe,relativeTime:ae,months:_l,monthsShort:Nl,week:Jo,weekdays:er,weekdaysMin:wf,weekdaysShort:Cf,meridiemParse:xe},dt={},Qt={},Gt;function Qn(d,T){var J,he=Math.min(d.length,T.length);for(J=0;J<he;J+=1)if(d[J]!==T[J])return J;return he}function ti(d){return d&&d.toLowerCase().replace("_","-")}function Gl(d){for(var T=0,J,he,pe,ve;T<d.length;){for(ve=ti(d[T]).split("-"),J=ve.length,he=ti(d[T+1]),he=he?he.split("-"):null;J>0;){if(pe=zl(ve.slice(0,J).join("-")),pe)return pe;if(he&&he.length>=J&&Qn(ve,he)>=J-1)break;J--}T++}return Gt}function Tf(d){return d.match("^[^/\\\\]*$")!=null}function zl(d){var T=null,J;if(dt[d]===void 0&&typeof la<"u"&&la&&la.exports&&Tf(d))try{T=Gt._abbr,J=Xr,J("./locale/"+d),tr(T)}catch{dt[d]=null}return dt[d]}function tr(d,T){var J;return d&&(a(T)?J=fo(d):J=pg(d,T),J?Gt=J:typeof console<"u"&&console.warn&&console.warn("Locale "+d+" not found. Did you forget to load it?")),Gt._abbr}function pg(d,T){if(T!==null){var J,he=bt;if(T.abbr=d,dt[d]!=null)Y("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),he=dt[d]._config;else if(T.parentLocale!=null)if(dt[T.parentLocale]!=null)he=dt[T.parentLocale]._config;else if(J=zl(T.parentLocale),J!=null)he=J._config;else return Qt[T.parentLocale]||(Qt[T.parentLocale]=[]),Qt[T.parentLocale].push({name:d,config:T}),null;return dt[d]=new v(A(he,T)),Qt[d]&&Qt[d].forEach(function(pe){pg(pe.name,pe.config)}),tr(d),dt[d]}else return delete dt[d],null}function vN(d,T){if(T!=null){var J,he,pe=bt;dt[d]!=null&&dt[d].parentLocale!=null?dt[d].set(A(dt[d]._config,T)):(he=zl(d),he!=null&&(pe=he._config),T=A(pe,T),he==null&&(T.abbr=d),J=new v(T),J.parentLocale=dt[d],dt[d]=J),tr(d)}else dt[d]!=null&&(dt[d].parentLocale!=null?(dt[d]=dt[d].parentLocale,d===tr()&&tr(d)):dt[d]!=null&&delete dt[d]);return dt[d]}function fo(d){var T;if(d&&d._locale&&d._locale._abbr&&(d=d._locale._abbr),!d)return Gt;if(!i(d)){if(T=zl(d),T)return T;d=[d]}return Gl(d)}function bN(){return R(dt)}function gg(d){var T,J=d._a;return J&&y(d).overflow===-2&&(T=J[bs]<0||J[bs]>11?bs:J[Bi]<1||J[Bi]>Yr(J[ui],J[bs])?Bi:J[Yt]<0||J[Yt]>24||J[Yt]===24&&(J[Mt]!==0||J[is]!==0||J[Dt]!==0)?Yt:J[Mt]<0||J[Mt]>59?Mt:J[is]<0||J[is]>59?is:J[Dt]<0||J[Dt]>999?Dt:-1,y(d)._overflowDayOfYear&&(T<ui||T>Bi)&&(T=Bi),y(d)._overflowWeeks&&T===-1&&(T=ff),y(d)._overflowWeekday&&T===-1&&(T=jt),y(d).overflow=T),d}var xN=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,SN=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,EN=/Z|[+-]\d\d(?::?\d\d)?/,Rf=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Cg=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],TN=/^\/?Date\((-?\d+)/i,RN=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,MN={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function WS(d){var T,J,he=d._i,pe=xN.exec(he)||SN.exec(he),ve,Oe,Qe,ut,_t=Rf.length,Ti=Cg.length;if(pe){for(y(d).iso=!0,T=0,J=_t;T<J;T++)if(Rf[T][1].exec(pe[1])){Oe=Rf[T][0],ve=Rf[T][2]!==!1;break}if(Oe==null){d._isValid=!1;return}if(pe[3]){for(T=0,J=Ti;T<J;T++)if(Cg[T][1].exec(pe[3])){Qe=(pe[2]||" ")+Cg[T][0];break}if(Qe==null){d._isValid=!1;return}}if(!ve&&Qe!=null){d._isValid=!1;return}if(pe[4])if(EN.exec(pe[4]))ut="Z";else{d._isValid=!1;return}d._f=Oe+(Qe||"")+(ut||""),yg(d)}else d._isValid=!1}function ON(d,T,J,he,pe,ve){var Oe=[AN(d),Nl.indexOf(T),parseInt(J,10),parseInt(he,10),parseInt(pe,10)];return ve&&Oe.push(parseInt(ve,10)),Oe}function AN(d){var T=parseInt(d,10);return T<=49?2e3+T:T<=999?1900+T:T}function IN(d){return d.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function _N(d,T,J){if(d){var he=Cf.indexOf(d),pe=new Date(T[0],T[1],T[2]).getDay();if(he!==pe)return y(J).weekdayMismatch=!0,J._isValid=!1,!1}return!0}function NN(d,T,J){if(d)return MN[d];if(T)return 0;var he=parseInt(J,10),pe=he%100,ve=(he-pe)/100;return ve*60+pe}function US(d){var T=RN.exec(IN(d._i)),J;if(T){if(J=ON(T[4],T[3],T[2],T[5],T[6],T[7]),!_N(T[1],J,d))return;d._a=J,d._tzm=NN(T[8],T[9],T[10]),d._d=Zo.apply(null,d._a),d._d.setUTCMinutes(d._d.getUTCMinutes()-d._tzm),y(d).rfc2822=!0}else d._isValid=!1}function PN(d){var T=TN.exec(d._i);if(T!==null){d._d=new Date(+T[1]);return}if(WS(d),d._isValid===!1)delete d._isValid;else return;if(US(d),d._isValid===!1)delete d._isValid;else return;d._strict?d._isValid=!1:e.createFromInputFallback(d)}e.createFromInputFallback=H("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(d){d._d=new Date(d._i+(d._useUTC?" UTC":""))});function Jn(d,T,J){return d??T??J}function LN(d){var T=new Date(e.now());return d._useUTC?[T.getUTCFullYear(),T.getUTCMonth(),T.getUTCDate()]:[T.getFullYear(),T.getMonth(),T.getDate()]}function wg(d){var T,J,he=[],pe,ve,Oe;if(!d._d){for(pe=LN(d),d._w&&d._a[Bi]==null&&d._a[bs]==null&&DN(d),d._dayOfYear!=null&&(Oe=Jn(d._a[ui],pe[ui]),(d._dayOfYear>ss(Oe)||d._dayOfYear===0)&&(y(d)._overflowDayOfYear=!0),J=Zo(Oe,0,d._dayOfYear),d._a[bs]=J.getUTCMonth(),d._a[Bi]=J.getUTCDate()),T=0;T<3&&d._a[T]==null;++T)d._a[T]=he[T]=pe[T];for(;T<7;T++)d._a[T]=he[T]=d._a[T]==null?T===2?1:0:d._a[T];d._a[Yt]===24&&d._a[Mt]===0&&d._a[is]===0&&d._a[Dt]===0&&(d._nextDay=!0,d._a[Yt]=0),d._d=(d._useUTC?Zo:gf).apply(null,he),ve=d._useUTC?d._d.getUTCDay():d._d.getDay(),d._tzm!=null&&d._d.setUTCMinutes(d._d.getUTCMinutes()-d._tzm),d._nextDay&&(d._a[Yt]=24),d._w&&typeof d._w.d<"u"&&d._w.d!==ve&&(y(d).weekdayMismatch=!0)}}function DN(d){var T,J,he,pe,ve,Oe,Qe,ut,_t;T=d._w,T.GG!=null||T.W!=null||T.E!=null?(ve=1,Oe=4,J=Jn(T.GG,d._a[ui],Bs(Ht(),1,4).year),he=Jn(T.W,1),pe=Jn(T.E,1),(pe<1||pe>7)&&(ut=!0)):(ve=d._locale._week.dow,Oe=d._locale._week.doy,_t=Bs(Ht(),ve,Oe),J=Jn(T.gg,d._a[ui],_t.year),he=Jn(T.w,_t.week),T.d!=null?(pe=T.d,(pe<0||pe>6)&&(ut=!0)):T.e!=null?(pe=T.e+ve,(T.e<0||T.e>6)&&(ut=!0)):pe=ve),he<1||he>_i(J,ve,Oe)?y(d)._overflowWeeks=!0:ut!=null?y(d)._overflowWeekday=!0:(Qe=Fl(J,he,pe,ve,Oe),d._a[ui]=Qe.year,d._dayOfYear=Qe.dayOfYear)}e.ISO_8601=function(){},e.RFC_2822=function(){};function yg(d){if(d._f===e.ISO_8601){WS(d);return}if(d._f===e.RFC_2822){US(d);return}d._a=[],y(d).empty=!0;var T=""+d._i,J,he,pe,ve,Oe,Qe=T.length,ut=0,_t,Ti;for(pe=L(d._f,d._locale).match(h)||[],Ti=pe.length,J=0;J<Ti;J++)ve=pe[J],he=(T.match(Il(ve,d))||[])[0],he&&(Oe=T.substr(0,T.indexOf(he)),Oe.length>0&&y(d).unusedInput.push(Oe),T=T.slice(T.indexOf(he)+he.length),ut+=he.length),I[ve]?(he?y(d).empty=!1:y(d).unusedTokens.push(ve),ag(ve,he,d)):d._strict&&!he&&y(d).unusedTokens.push(ve);y(d).charsLeftOver=Qe-ut,T.length>0&&y(d).unusedInput.push(T),d._a[Yt]<=12&&y(d).bigHour===!0&&d._a[Yt]>0&&(y(d).bigHour=void 0),y(d).parsedDateParts=d._a.slice(0),y(d).meridiem=d._meridiem,d._a[Yt]=kN(d._locale,d._a[Yt],d._meridiem),_t=y(d).era,_t!==null&&(d._a[ui]=d._locale.erasConvertYear(_t,d._a[ui])),wg(d),gg(d)}function kN(d,T,J){var he;return J==null?T:d.meridiemHour!=null?d.meridiemHour(T,J):(d.isPM!=null&&(he=d.isPM(J),he&&T<12&&(T+=12),!he&&T===12&&(T=0)),T)}function HN(d){var T,J,he,pe,ve,Oe,Qe=!1,ut=d._f.length;if(ut===0){y(d).invalidFormat=!0,d._d=new Date(NaN);return}for(pe=0;pe<ut;pe++)ve=0,Oe=!1,T=E({},d),d._useUTC!=null&&(T._useUTC=d._useUTC),T._f=d._f[pe],yg(T),O(T)&&(Oe=!0),ve+=y(T).charsLeftOver,ve+=y(T).unusedTokens.length*10,y(T).score=ve,Qe?ve<he&&(he=ve,J=T):(he==null||ve<he||Oe)&&(he=ve,J=T,Oe&&(Qe=!0));g(d,J||T)}function FN(d){if(!d._d){var T=ue(d._i),J=T.day===void 0?T.date:T.day;d._a=u([T.year,T.month,J,T.hour,T.minute,T.second,T.millisecond],function(he){return he&&parseInt(he,10)}),wg(d)}}function BN(d){var T=new k(gg(YS(d)));return T._nextDay&&(T.add(1,"d"),T._nextDay=void 0),T}function YS(d){var T=d._i,J=d._f;return d._locale=d._locale||fo(d._l),T===null||J===void 0&&T===""?M({nullInput:!0}):(typeof T=="string"&&(d._i=T=d._locale.preparse(T)),ie(T)?new k(gg(T)):(c(T)?d._d=T:i(J)?HN(d):J?yg(d):VN(d),O(d)||(d._d=null),d))}function VN(d){var T=d._i;a(T)?d._d=new Date(e.now()):c(T)?d._d=new Date(T.valueOf()):typeof T=="string"?PN(d):i(T)?(d._a=u(T.slice(0),function(J){return parseInt(J,10)}),wg(d)):s(T)?FN(d):l(T)?d._d=new Date(T):e.createFromInputFallback(d)}function jS(d,T,J,he,pe){var ve={};return(T===!0||T===!1)&&(he=T,T=void 0),(J===!0||J===!1)&&(he=J,J=void 0),(s(d)&&n(d)||i(d)&&d.length===0)&&(d=void 0),ve._isAMomentObject=!0,ve._useUTC=ve._isUTC=pe,ve._l=J,ve._i=d,ve._f=T,ve._strict=he,BN(ve)}function Ht(d,T,J,he){return jS(d,T,J,he,!1)}var WN=H("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var d=Ht.apply(null,arguments);return this.isValid()&&d.isValid()?d<this?this:d:M()}),UN=H("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var d=Ht.apply(null,arguments);return this.isValid()&&d.isValid()?d>this?this:d:M()});function GS(d,T){var J,he;if(T.length===1&&i(T[0])&&(T=T[0]),!T.length)return Ht();for(J=T[0],he=1;he<T.length;++he)(!T[he].isValid()||T[he][d](J))&&(J=T[he]);return J}function YN(){var d=[].slice.call(arguments,0);return GS("isBefore",d)}function jN(){var d=[].slice.call(arguments,0);return GS("isAfter",d)}var GN=function(){return Date.now?Date.now():+new Date},$l=["year","quarter","month","week","day","hour","minute","second","millisecond"];function zN(d){var T,J=!1,he,pe=$l.length;for(T in d)if(r(d,T)&&!(kt.call($l,T)!==-1&&(d[T]==null||!isNaN(d[T]))))return!1;for(he=0;he<pe;++he)if(d[$l[he]]){if(J)return!1;parseFloat(d[$l[he]])!==re(d[$l[he]])&&(J=!0)}return!0}function $N(){return this._isValid}function XN(){return Ts(NaN)}function Mf(d){var T=ue(d),J=T.year||0,he=T.quarter||0,pe=T.month||0,ve=T.week||T.isoWeek||0,Oe=T.day||0,Qe=T.hour||0,ut=T.minute||0,_t=T.second||0,Ti=T.millisecond||0;this._isValid=zN(T),this._milliseconds=+Ti+_t*1e3+ut*6e4+Qe*1e3*60*60,this._days=+Oe+ve*7,this._months=+pe+he*3+J*12,this._data={},this._locale=fo(),this._bubble()}function Of(d){return d instanceof Mf}function vg(d){return d<0?Math.round(-1*d)*-1:Math.round(d)}function qN(d,T,J){var he=Math.min(d.length,T.length),pe=Math.abs(d.length-T.length),ve=0,Oe;for(Oe=0;Oe<he;Oe++)(J&&d[Oe]!==T[Oe]||!J&&re(d[Oe])!==re(T[Oe]))&&ve++;return ve+pe}function zS(d,T){B(d,0,0,function(){var J=this.utcOffset(),he="+";return J<0&&(J=-J,he="-"),he+b(~~(J/60),2)+T+b(~~J%60,2)})}zS("Z",":"),zS("ZZ",""),Be("Z",Ut),Be("ZZ",Ut),Et(["Z","ZZ"],function(d,T,J){J._useUTC=!0,J._tzm=bg(Ut,d)});var KN=/([\+\-]|\d\d)/gi;function bg(d,T){var J=(T||"").match(d),he,pe,ve;return J===null?null:(he=J[J.length-1]||[],pe=(he+"").match(KN)||["-",0,0],ve=+(pe[1]*60)+re(pe[2]),ve===0?0:pe[0]==="+"?ve:-ve)}function xg(d,T){var J,he;return T._isUTC?(J=T.clone(),he=(ie(d)||c(d)?d.valueOf():Ht(d).valueOf())-J.valueOf(),J._d.setTime(J._d.valueOf()+he),e.updateOffset(J,!1),J):Ht(d).local()}function Sg(d){return-Math.round(d._d.getTimezoneOffset())}e.updateOffset=function(){};function ZN(d,T,J){var he=this._offset||0,pe;if(!this.isValid())return d!=null?this:NaN;if(d!=null){if(typeof d=="string"){if(d=bg(Ut,d),d===null)return this}else Math.abs(d)<16&&!J&&(d=d*60);return!this._isUTC&&T&&(pe=Sg(this)),this._offset=d,this._isUTC=!0,pe!=null&&this.add(pe,"m"),he!==d&&(!T||this._changeInProgress?KS(this,Ts(d-he,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?he:Sg(this)}function QN(d,T){return d!=null?(typeof d!="string"&&(d=-d),this.utcOffset(d,T),this):-this.utcOffset()}function JN(d){return this.utcOffset(0,d)}function eP(d){return this._isUTC&&(this.utcOffset(0,d),this._isUTC=!1,d&&this.subtract(Sg(this),"m")),this}function tP(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var d=bg(wi,this._i);d!=null?this.utcOffset(d):this.utcOffset(0,!0)}return this}function iP(d){return this.isValid()?(d=d?Ht(d).utcOffset():0,(this.utcOffset()-d)%60===0):!1}function sP(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function oP(){if(!a(this._isDSTShifted))return this._isDSTShifted;var d={},T;return E(d,this),d=YS(d),d._a?(T=d._isUTC?p(d._a):Ht(d._a),this._isDSTShifted=this.isValid()&&qN(d._a,T.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function rP(){return this.isValid()?!this._isUTC:!1}function nP(){return this.isValid()?this._isUTC:!1}function $S(){return this.isValid()?this._isUTC&&this._offset===0:!1}var aP=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,lP=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ts(d,T){var J=d,he=null,pe,ve,Oe;return Of(d)?J={ms:d._milliseconds,d:d._days,M:d._months}:l(d)||!isNaN(+d)?(J={},T?J[T]=+d:J.milliseconds=+d):(he=aP.exec(d))?(pe=he[1]==="-"?-1:1,J={y:0,d:re(he[Bi])*pe,h:re(he[Yt])*pe,m:re(he[Mt])*pe,s:re(he[is])*pe,ms:re(vg(he[Dt]*1e3))*pe}):(he=lP.exec(d))?(pe=he[1]==="-"?-1:1,J={y:zr(he[2],pe),M:zr(he[3],pe),w:zr(he[4],pe),d:zr(he[5],pe),h:zr(he[6],pe),m:zr(he[7],pe),s:zr(he[8],pe)}):J==null?J={}:typeof J=="object"&&("from"in J||"to"in J)&&(Oe=hP(Ht(J.from),Ht(J.to)),J={},J.ms=Oe.milliseconds,J.M=Oe.months),ve=new Mf(J),Of(d)&&r(d,"_locale")&&(ve._locale=d._locale),Of(d)&&r(d,"_isValid")&&(ve._isValid=d._isValid),ve}Ts.fn=Mf.prototype,Ts.invalid=XN;function zr(d,T){var J=d&&parseFloat(d.replace(",","."));return(isNaN(J)?0:J)*T}function XS(d,T){var J={};return J.months=T.month()-d.month()+(T.year()-d.year())*12,d.clone().add(J.months,"M").isAfter(T)&&--J.months,J.milliseconds=+T-+d.clone().add(J.months,"M"),J}function hP(d,T){var J;return d.isValid()&&T.isValid()?(T=xg(T,d),d.isBefore(T)?J=XS(d,T):(J=XS(T,d),J.milliseconds=-J.milliseconds,J.months=-J.months),J):{milliseconds:0,months:0}}function qS(d,T){return function(J,he){var pe,ve;return he!==null&&!isNaN(+he)&&(Y(T,"moment()."+T+"(period, number) is deprecated. Please use moment()."+T+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),ve=J,J=he,he=ve),pe=Ts(J,he),KS(this,pe,d),this}}function KS(d,T,J,he){var pe=T._milliseconds,ve=vg(T._days),Oe=vg(T._months);d.isValid()&&(he=he??!0,Oe&&jr(d,Ce(d,"Month")+Oe*J),ve&&ge(d,"Date",Ce(d,"Date")+ve*J),pe&&d._d.setTime(d._d.valueOf()+pe*J),he&&e.updateOffset(d,ve||Oe))}var cP=qS(1,"add"),uP=qS(-1,"subtract");function ZS(d){return typeof d=="string"||d instanceof String}function dP(d){return ie(d)||c(d)||ZS(d)||l(d)||mP(d)||fP(d)||d===null||d===void 0}function fP(d){var T=s(d)&&!n(d),J=!1,he=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],pe,ve,Oe=he.length;for(pe=0;pe<Oe;pe+=1)ve=he[pe],J=J||r(d,ve);return T&&J}function mP(d){var T=i(d),J=!1;return T&&(J=d.filter(function(he){return!l(he)&&ZS(d)}).length===0),T&&J}function pP(d){var T=s(d)&&!n(d),J=!1,he=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],pe,ve;for(pe=0;pe<he.length;pe+=1)ve=he[pe],J=J||r(d,ve);return T&&J}function gP(d,T){var J=d.diff(T,"days",!0);return J<-6?"sameElse":J<-1?"lastWeek":J<0?"lastDay":J<1?"sameDay":J<2?"nextDay":J<7?"nextWeek":"sameElse"}function CP(d,T){arguments.length===1&&(arguments[0]?dP(arguments[0])?(d=arguments[0],T=void 0):pP(arguments[0])&&(T=arguments[0],d=void 0):(d=void 0,T=void 0));var J=d||Ht(),he=xg(J,this).startOf("day"),pe=e.calendarFormat(this,he)||"sameElse",ve=T&&(P(T[pe])?T[pe].call(this,J):T[pe]);return this.format(ve||this.localeData().calendar(pe,this,Ht(J)))}function wP(){return new k(this)}function yP(d,T){var J=ie(d)?d:Ht(d);return this.isValid()&&J.isValid()?(T=ee(T)||"millisecond",T==="millisecond"?this.valueOf()>J.valueOf():J.valueOf()<this.clone().startOf(T).valueOf()):!1}function vP(d,T){var J=ie(d)?d:Ht(d);return this.isValid()&&J.isValid()?(T=ee(T)||"millisecond",T==="millisecond"?this.valueOf()<J.valueOf():this.clone().endOf(T).valueOf()<J.valueOf()):!1}function bP(d,T,J,he){var pe=ie(d)?d:Ht(d),ve=ie(T)?T:Ht(T);return this.isValid()&&pe.isValid()&&ve.isValid()?(he=he||"()",(he[0]==="("?this.isAfter(pe,J):!this.isBefore(pe,J))&&(he[1]===")"?this.isBefore(ve,J):!this.isAfter(ve,J))):!1}function xP(d,T){var J=ie(d)?d:Ht(d),he;return this.isValid()&&J.isValid()?(T=ee(T)||"millisecond",T==="millisecond"?this.valueOf()===J.valueOf():(he=J.valueOf(),this.clone().startOf(T).valueOf()<=he&&he<=this.clone().endOf(T).valueOf())):!1}function SP(d,T){return this.isSame(d,T)||this.isAfter(d,T)}function EP(d,T){return this.isSame(d,T)||this.isBefore(d,T)}function TP(d,T,J){var he,pe,ve;if(!this.isValid())return NaN;if(he=xg(d,this),!he.isValid())return NaN;switch(pe=(he.utcOffset()-this.utcOffset())*6e4,T=ee(T),T){case"year":ve=Af(this,he)/12;break;case"month":ve=Af(this,he);break;case"quarter":ve=Af(this,he)/3;break;case"second":ve=(this-he)/1e3;break;case"minute":ve=(this-he)/6e4;break;case"hour":ve=(this-he)/36e5;break;case"day":ve=(this-he-pe)/864e5;break;case"week":ve=(this-he-pe)/6048e5;break;default:ve=this-he}return J?ve:te(ve)}function Af(d,T){if(d.date()<T.date())return-Af(T,d);var J=(T.year()-d.year())*12+(T.month()-d.month()),he=d.clone().add(J,"months"),pe,ve;return T-he<0?(pe=d.clone().add(J-1,"months"),ve=(T-he)/(he-pe)):(pe=d.clone().add(J+1,"months"),ve=(T-he)/(pe-he)),-(J+ve)||0}e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",e.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function RP(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function MP(d){if(!this.isValid())return null;var T=d!==!0,J=T?this.clone().utc():this;return J.year()<0||J.year()>9999?K(J,T?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):P(Date.prototype.toISOString)?T?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",K(J,"Z")):K(J,T?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function OP(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var d="moment",T="",J,he,pe,ve;return this.isLocal()||(d=this.utcOffset()===0?"moment.utc":"moment.parseZone",T="Z"),J="["+d+'("]',he=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",pe="-MM-DD[T]HH:mm:ss.SSS",ve=T+'[")]',this.format(J+he+pe+ve)}function AP(d){d||(d=this.isUtc()?e.defaultFormatUtc:e.defaultFormat);var T=K(this,d);return this.localeData().postformat(T)}function IP(d,T){return this.isValid()&&(ie(d)&&d.isValid()||Ht(d).isValid())?Ts({to:this,from:d}).locale(this.locale()).humanize(!T):this.localeData().invalidDate()}function _P(d){return this.from(Ht(),d)}function NP(d,T){return this.isValid()&&(ie(d)&&d.isValid()||Ht(d).isValid())?Ts({from:this,to:d}).locale(this.locale()).humanize(!T):this.localeData().invalidDate()}function PP(d){return this.to(Ht(),d)}function QS(d){var T;return d===void 0?this._locale._abbr:(T=fo(d),T!=null&&(this._locale=T),this)}var JS=H("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(d){return d===void 0?this.localeData():this.locale(d)});function e0(){return this._locale}var If=1e3,ea=60*If,_f=60*ea,t0=(365*400+97)*24*_f;function ta(d,T){return(d%T+T)%T}function i0(d,T,J){return d<100&&d>=0?new Date(d+400,T,J)-t0:new Date(d,T,J).valueOf()}function s0(d,T,J){return d<100&&d>=0?Date.UTC(d+400,T,J)-t0:Date.UTC(d,T,J)}function LP(d){var T,J;if(d=ee(d),d===void 0||d==="millisecond"||!this.isValid())return this;switch(J=this._isUTC?s0:i0,d){case"year":T=J(this.year(),0,1);break;case"quarter":T=J(this.year(),this.month()-this.month()%3,1);break;case"month":T=J(this.year(),this.month(),1);break;case"week":T=J(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":T=J(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":T=J(this.year(),this.month(),this.date());break;case"hour":T=this._d.valueOf(),T-=ta(T+(this._isUTC?0:this.utcOffset()*ea),_f);break;case"minute":T=this._d.valueOf(),T-=ta(T,ea);break;case"second":T=this._d.valueOf(),T-=ta(T,If);break}return this._d.setTime(T),e.updateOffset(this,!0),this}function DP(d){var T,J;if(d=ee(d),d===void 0||d==="millisecond"||!this.isValid())return this;switch(J=this._isUTC?s0:i0,d){case"year":T=J(this.year()+1,0,1)-1;break;case"quarter":T=J(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":T=J(this.year(),this.month()+1,1)-1;break;case"week":T=J(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":T=J(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":T=J(this.year(),this.month(),this.date()+1)-1;break;case"hour":T=this._d.valueOf(),T+=_f-ta(T+(this._isUTC?0:this.utcOffset()*ea),_f)-1;break;case"minute":T=this._d.valueOf(),T+=ea-ta(T,ea)-1;break;case"second":T=this._d.valueOf(),T+=If-ta(T,If)-1;break}return this._d.setTime(T),e.updateOffset(this,!0),this}function kP(){return this._d.valueOf()-(this._offset||0)*6e4}function HP(){return Math.floor(this.valueOf()/1e3)}function FP(){return new Date(this.valueOf())}function BP(){var d=this;return[d.year(),d.month(),d.date(),d.hour(),d.minute(),d.second(),d.millisecond()]}function VP(){var d=this;return{years:d.year(),months:d.month(),date:d.date(),hours:d.hours(),minutes:d.minutes(),seconds:d.seconds(),milliseconds:d.milliseconds()}}function WP(){return this.isValid()?this.toISOString():null}function UP(){return O(this)}function YP(){return g({},y(this))}function jP(){return y(this).overflow}function GP(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}B("N",0,0,"eraAbbr"),B("NN",0,0,"eraAbbr"),B("NNN",0,0,"eraAbbr"),B("NNNN",0,0,"eraName"),B("NNNNN",0,0,"eraNarrow"),B("y",["y",1],"yo","eraYear"),B("y",["yy",2],0,"eraYear"),B("y",["yyy",3],0,"eraYear"),B("y",["yyyy",4],0,"eraYear"),Be("N",Eg),Be("NN",Eg),Be("NNN",Eg),Be("NNNN",iL),Be("NNNNN",sL),Et(["N","NN","NNN","NNNN","NNNNN"],function(d,T,J,he){var pe=J._locale.erasParse(d,he,J._strict);pe?y(J).era=pe:y(J).invalidEra=d}),Be("y",ct),Be("yy",ct),Be("yyy",ct),Be("yyyy",ct),Be("yo",oL),Et(["y","yy","yyy","yyyy"],ui),Et(["yo"],function(d,T,J,he){var pe;J._locale._eraYearOrdinalRegex&&(pe=d.match(J._locale._eraYearOrdinalRegex)),J._locale.eraYearOrdinalParse?T[ui]=J._locale.eraYearOrdinalParse(d,pe):T[ui]=parseInt(d,10)});function zP(d,T){var J,he,pe,ve=this._eras||fo("en")._eras;for(J=0,he=ve.length;J<he;++J){switch(typeof ve[J].since){case"string":pe=e(ve[J].since).startOf("day"),ve[J].since=pe.valueOf();break}switch(typeof ve[J].until){case"undefined":ve[J].until=1/0;break;case"string":pe=e(ve[J].until).startOf("day").valueOf(),ve[J].until=pe.valueOf();break}}return ve}function $P(d,T,J){var he,pe,ve=this.eras(),Oe,Qe,ut;for(d=d.toUpperCase(),he=0,pe=ve.length;he<pe;++he)if(Oe=ve[he].name.toUpperCase(),Qe=ve[he].abbr.toUpperCase(),ut=ve[he].narrow.toUpperCase(),J)switch(T){case"N":case"NN":case"NNN":if(Qe===d)return ve[he];break;case"NNNN":if(Oe===d)return ve[he];break;case"NNNNN":if(ut===d)return ve[he];break}else if([Oe,Qe,ut].indexOf(d)>=0)return ve[he]}function XP(d,T){var J=d.since<=d.until?1:-1;return T===void 0?e(d.since).year():e(d.since).year()+(T-d.offset)*J}function qP(){var d,T,J,he=this.localeData().eras();for(d=0,T=he.length;d<T;++d)if(J=this.clone().startOf("day").valueOf(),he[d].since<=J&&J<=he[d].until||he[d].until<=J&&J<=he[d].since)return he[d].name;return""}function KP(){var d,T,J,he=this.localeData().eras();for(d=0,T=he.length;d<T;++d)if(J=this.clone().startOf("day").valueOf(),he[d].since<=J&&J<=he[d].until||he[d].until<=J&&J<=he[d].since)return he[d].narrow;return""}function ZP(){var d,T,J,he=this.localeData().eras();for(d=0,T=he.length;d<T;++d)if(J=this.clone().startOf("day").valueOf(),he[d].since<=J&&J<=he[d].until||he[d].until<=J&&J<=he[d].since)return he[d].abbr;return""}function QP(){var d,T,J,he,pe=this.localeData().eras();for(d=0,T=pe.length;d<T;++d)if(J=pe[d].since<=pe[d].until?1:-1,he=this.clone().startOf("day").valueOf(),pe[d].since<=he&&he<=pe[d].until||pe[d].until<=he&&he<=pe[d].since)return(this.year()-e(pe[d].since).year())*J+pe[d].offset;return this.year()}function JP(d){return r(this,"_erasNameRegex")||Tg.call(this),d?this._erasNameRegex:this._erasRegex}function eL(d){return r(this,"_erasAbbrRegex")||Tg.call(this),d?this._erasAbbrRegex:this._erasRegex}function tL(d){return r(this,"_erasNarrowRegex")||Tg.call(this),d?this._erasNarrowRegex:this._erasRegex}function Eg(d,T){return T.erasAbbrRegex(d)}function iL(d,T){return T.erasNameRegex(d)}function sL(d,T){return T.erasNarrowRegex(d)}function oL(d,T){return T._eraYearOrdinalRegex||ct}function Tg(){var d=[],T=[],J=[],he=[],pe,ve,Oe=this.eras();for(pe=0,ve=Oe.length;pe<ve;++pe)T.push(Vt(Oe[pe].name)),d.push(Vt(Oe[pe].abbr)),J.push(Vt(Oe[pe].narrow)),he.push(Vt(Oe[pe].name)),he.push(Vt(Oe[pe].abbr)),he.push(Vt(Oe[pe].narrow));this._erasRegex=new RegExp("^("+he.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+T.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+d.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+J.join("|")+")","i")}B(0,["gg",2],0,function(){return this.weekYear()%100}),B(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Nf(d,T){B(0,[d,d.length],0,T)}Nf("gggg","weekYear"),Nf("ggggg","weekYear"),Nf("GGGG","isoWeekYear"),Nf("GGGGG","isoWeekYear"),se("weekYear","gg"),se("isoWeekYear","GG"),W("weekYear",1),W("isoWeekYear",1),Be("G",qe),Be("g",qe),Be("GG",Me,be),Be("gg",Me,be),Be("GGGG",It,Ae),Be("gggg",It,Ae),Be("GGGGG",wt,Ne),Be("ggggg",wt,Ne),lo(["gggg","ggggg","GGGG","GGGGG"],function(d,T,J,he){T[he.substr(0,2)]=re(d)}),lo(["gg","GG"],function(d,T,J,he){T[he]=e.parseTwoDigitYear(d)});function rL(d){return o0.call(this,d,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function nL(d){return o0.call(this,d,this.isoWeek(),this.isoWeekday(),1,4)}function aL(){return _i(this.year(),1,4)}function lL(){return _i(this.isoWeekYear(),1,4)}function hL(){var d=this.localeData()._week;return _i(this.year(),d.dow,d.doy)}function cL(){var d=this.localeData()._week;return _i(this.weekYear(),d.dow,d.doy)}function o0(d,T,J,he,pe){var ve;return d==null?Bs(this,he,pe).year:(ve=_i(d,he,pe),T>ve&&(T=ve),uL.call(this,d,T,J,he,pe))}function uL(d,T,J,he,pe){var ve=Fl(d,T,J,he,pe),Oe=Zo(ve.year,0,ve.dayOfYear);return this.year(Oe.getUTCFullYear()),this.month(Oe.getUTCMonth()),this.date(Oe.getUTCDate()),this}B("Q",0,"Qo","quarter"),se("quarter","Q"),W("quarter",7),Be("Q",Se),Et("Q",function(d,T){T[bs]=(re(d)-1)*3});function dL(d){return d==null?Math.ceil((this.month()+1)/3):this.month((d-1)*3+this.month()%3)}B("D",["DD",2],"Do","date"),se("date","D"),W("date",9),Be("D",Me),Be("DD",Me,be),Be("Do",function(d,T){return d?T._dayOfMonthOrdinalParse||T._ordinalParse:T._dayOfMonthOrdinalParseLenient}),Et(["D","DD"],Bi),Et("Do",function(d,T){T[Bi]=re(d.match(Me)[0])});var r0=ce("Date",!0);B("DDD",["DDDD",3],"DDDo","dayOfYear"),se("dayOfYear","DDD"),W("dayOfYear",4),Be("DDD",rt),Be("DDDD",Re),Et(["DDD","DDDD"],function(d,T,J){J._dayOfYear=re(d)});function fL(d){var T=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return d==null?T:this.add(d-T,"d")}B("m",["mm",2],0,"minute"),se("minute","m"),W("minute",14),Be("m",Me),Be("mm",Me,be),Et(["m","mm"],Mt);var mL=ce("Minutes",!1);B("s",["ss",2],0,"second"),se("second","s"),W("second",15),Be("s",Me),Be("ss",Me,be),Et(["s","ss"],is);var pL=ce("Seconds",!1);B("S",0,0,function(){return~~(this.millisecond()/100)}),B(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),B(0,["SSS",3],0,"millisecond"),B(0,["SSSS",4],0,function(){return this.millisecond()*10}),B(0,["SSSSS",5],0,function(){return this.millisecond()*100}),B(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),B(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),B(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),B(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),se("millisecond","ms"),W("millisecond",16),Be("S",rt,Se),Be("SS",rt,be),Be("SSS",rt,Re);var ir,n0;for(ir="SSSS";ir.length<=9;ir+="S")Be(ir,ct);function gL(d,T){T[Dt]=re(("0."+d)*1e3)}for(ir="S";ir.length<=9;ir+="S")Et(ir,gL);n0=ce("Milliseconds",!1),B("z",0,0,"zoneAbbr"),B("zz",0,0,"zoneName");function CL(){return this._isUTC?"UTC":""}function wL(){return this._isUTC?"Coordinated Universal Time":""}var De=k.prototype;De.add=cP,De.calendar=CP,De.clone=wP,De.diff=TP,De.endOf=DP,De.format=AP,De.from=IP,De.fromNow=_P,De.to=NP,De.toNow=PP,De.get=ye,De.invalidAt=jP,De.isAfter=yP,De.isBefore=vP,De.isBetween=bP,De.isSame=xP,De.isSameOrAfter=SP,De.isSameOrBefore=EP,De.isValid=UP,De.lang=JS,De.locale=QS,De.localeData=e0,De.max=UN,De.min=WN,De.parsingFlags=YP,De.set=Ee,De.startOf=LP,De.subtract=uP,De.toArray=BP,De.toObject=VP,De.toDate=FP,De.toISOString=MP,De.inspect=OP,typeof Symbol<"u"&&Symbol.for!=null&&(De[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),De.toJSON=WP,De.toString=RP,De.unix=HP,De.valueOf=kP,De.creationData=GP,De.eraName=qP,De.eraNarrow=KP,De.eraAbbr=ZP,De.eraYear=QP,De.year=co,De.isLeapYear=pf,De.weekYear=rL,De.isoWeekYear=nL,De.quarter=De.quarters=dL,De.month=kl,De.daysInMonth=mf,De.week=De.weeks=hg,De.isoWeek=De.isoWeeks=uo,De.weeksInYear=hL,De.weeksInWeekYear=cL,De.isoWeeksInYear=aL,De.isoWeeksInISOWeekYear=lL,De.date=r0,De.day=De.days=Yl,De.weekday=bf,De.isoWeekday=xf,De.dayOfYear=fL,De.hour=De.hours=Le,De.minute=De.minutes=mL,De.second=De.seconds=pL,De.millisecond=De.milliseconds=n0,De.utcOffset=ZN,De.utc=JN,De.local=eP,De.parseZone=tP,De.hasAlignedHourOffset=iP,De.isDST=sP,De.isLocal=rP,De.isUtcOffset=nP,De.isUtc=$S,De.isUTC=$S,De.zoneAbbr=CL,De.zoneName=wL,De.dates=H("dates accessor is deprecated. Use date instead.",r0),De.months=H("months accessor is deprecated. Use month instead",kl),De.years=H("years accessor is deprecated. Use year instead",co),De.zone=H("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",QN),De.isDSTShifted=H("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",oP);function yL(d){return Ht(d*1e3)}function vL(){return Ht.apply(null,arguments).parseZone()}function a0(d){return d}var Tt=v.prototype;Tt.calendar=w,Tt.longDateFormat=q,Tt.invalidDate=D,Tt.ordinal=ne,Tt.preparse=a0,Tt.postformat=a0,Tt.relativeTime=fe,Tt.pastFuture=me,Tt.set=j,Tt.eras=zP,Tt.erasParse=$P,Tt.erasConvertYear=XP,Tt.erasAbbrRegex=eL,Tt.erasNameRegex=JP,Tt.erasNarrowRegex=tL,Tt.months=Ll,Tt.monthsShort=Dl,Tt.monthsParse=Xn,Tt.monthsRegex=Hl,Tt.monthsShortRegex=lg,Tt.week=xs,Tt.firstDayOfYear=Vl,Tt.firstDayOfWeek=Bl,Tt.weekdays=dg,Tt.weekdaysMin=Ul,Tt.weekdaysShort=qn,Tt.weekdaysParse=Ss,Tt.weekdaysRegex=mg,Tt.weekdaysShortRegex=Gr,Tt.weekdaysMinRegex=Es,Tt.isPM=Ke,Tt.meridiem=Fe;function Pf(d,T,J,he){var pe=fo(),ve=p().set(he,T);return pe[J](ve,d)}function l0(d,T,J){if(l(d)&&(T=d,d=void 0),d=d||"",T!=null)return Pf(d,T,J,"month");var he,pe=[];for(he=0;he<12;he++)pe[he]=Pf(d,he,J,"month");return pe}function Rg(d,T,J,he){typeof d=="boolean"?(l(T)&&(J=T,T=void 0),T=T||""):(T=d,J=T,d=!1,l(T)&&(J=T,T=void 0),T=T||"");var pe=fo(),ve=d?pe._week.dow:0,Oe,Qe=[];if(J!=null)return Pf(T,(J+ve)%7,he,"day");for(Oe=0;Oe<7;Oe++)Qe[Oe]=Pf(T,(Oe+ve)%7,he,"day");return Qe}function bL(d,T){return l0(d,T,"months")}function xL(d,T){return l0(d,T,"monthsShort")}function SL(d,T,J){return Rg(d,T,J,"weekdays")}function EL(d,T,J){return Rg(d,T,J,"weekdaysShort")}function TL(d,T,J){return Rg(d,T,J,"weekdaysMin")}tr("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(d){var T=d%10,J=re(d%100/10)===1?"th":T===1?"st":T===2?"nd":T===3?"rd":"th";return d+J}}),e.lang=H("moment.lang is deprecated. Use moment.locale instead.",tr),e.langData=H("moment.langData is deprecated. Use moment.localeData instead.",fo);var mo=Math.abs;function RL(){var d=this._data;return this._milliseconds=mo(this._milliseconds),this._days=mo(this._days),this._months=mo(this._months),d.milliseconds=mo(d.milliseconds),d.seconds=mo(d.seconds),d.minutes=mo(d.minutes),d.hours=mo(d.hours),d.months=mo(d.months),d.years=mo(d.years),this}function h0(d,T,J,he){var pe=Ts(T,J);return d._milliseconds+=he*pe._milliseconds,d._days+=he*pe._days,d._months+=he*pe._months,d._bubble()}function ML(d,T){return h0(this,d,T,1)}function OL(d,T){return h0(this,d,T,-1)}function c0(d){return d<0?Math.floor(d):Math.ceil(d)}function AL(){var d=this._milliseconds,T=this._days,J=this._months,he=this._data,pe,ve,Oe,Qe,ut;return d>=0&&T>=0&&J>=0||d<=0&&T<=0&&J<=0||(d+=c0(Mg(J)+T)*864e5,T=0,J=0),he.milliseconds=d%1e3,pe=te(d/1e3),he.seconds=pe%60,ve=te(pe/60),he.minutes=ve%60,Oe=te(ve/60),he.hours=Oe%24,T+=te(Oe/24),ut=te(u0(T)),J+=ut,T-=c0(Mg(ut)),Qe=te(J/12),J%=12,he.days=T,he.months=J,he.years=Qe,this}function u0(d){return d*4800/146097}function Mg(d){return d*146097/4800}function IL(d){if(!this.isValid())return NaN;var T,J,he=this._milliseconds;if(d=ee(d),d==="month"||d==="quarter"||d==="year")switch(T=this._days+he/864e5,J=this._months+u0(T),d){case"month":return J;case"quarter":return J/3;case"year":return J/12}else switch(T=this._days+Math.round(Mg(this._months)),d){case"week":return T/7+he/6048e5;case"day":return T+he/864e5;case"hour":return T*24+he/36e5;case"minute":return T*1440+he/6e4;case"second":return T*86400+he/1e3;case"millisecond":return Math.floor(T*864e5)+he;default:throw new Error("Unknown unit "+d)}}function _L(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+re(this._months/12)*31536e6:NaN}function po(d){return function(){return this.as(d)}}var NL=po("ms"),PL=po("s"),LL=po("m"),DL=po("h"),kL=po("d"),HL=po("w"),FL=po("M"),BL=po("Q"),VL=po("y");function WL(){return Ts(this)}function UL(d){return d=ee(d),this.isValid()?this[d+"s"]():NaN}function $r(d){return function(){return this.isValid()?this._data[d]:NaN}}var YL=$r("milliseconds"),jL=$r("seconds"),GL=$r("minutes"),zL=$r("hours"),$L=$r("days"),XL=$r("months"),qL=$r("years");function KL(){return te(this.days()/7)}var go=Math.round,ia={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function ZL(d,T,J,he,pe){return pe.relativeTime(T||1,!!J,d,he)}function QL(d,T,J,he){var pe=Ts(d).abs(),ve=go(pe.as("s")),Oe=go(pe.as("m")),Qe=go(pe.as("h")),ut=go(pe.as("d")),_t=go(pe.as("M")),Ti=go(pe.as("w")),Co=go(pe.as("y")),sr=ve<=J.ss&&["s",ve]||ve<J.s&&["ss",ve]||Oe<=1&&["m"]||Oe<J.m&&["mm",Oe]||Qe<=1&&["h"]||Qe<J.h&&["hh",Qe]||ut<=1&&["d"]||ut<J.d&&["dd",ut];return J.w!=null&&(sr=sr||Ti<=1&&["w"]||Ti<J.w&&["ww",Ti]),sr=sr||_t<=1&&["M"]||_t<J.M&&["MM",_t]||Co<=1&&["y"]||["yy",Co],sr[2]=T,sr[3]=+d>0,sr[4]=he,ZL.apply(null,sr)}function JL(d){return d===void 0?go:typeof d=="function"?(go=d,!0):!1}function eD(d,T){return ia[d]===void 0?!1:T===void 0?ia[d]:(ia[d]=T,d==="s"&&(ia.ss=T-1),!0)}function tD(d,T){if(!this.isValid())return this.localeData().invalidDate();var J=!1,he=ia,pe,ve;return typeof d=="object"&&(T=d,d=!1),typeof d=="boolean"&&(J=d),typeof T=="object"&&(he=Object.assign({},ia,T),T.s!=null&&T.ss==null&&(he.ss=T.s-1)),pe=this.localeData(),ve=QL(this,!J,he,pe),J&&(ve=pe.pastFuture(+this,ve)),pe.postformat(ve)}var Og=Math.abs;function sa(d){return(d>0)-(d<0)||+d}function Lf(){if(!this.isValid())return this.localeData().invalidDate();var d=Og(this._milliseconds)/1e3,T=Og(this._days),J=Og(this._months),he,pe,ve,Oe,Qe=this.asSeconds(),ut,_t,Ti,Co;return Qe?(he=te(d/60),pe=te(he/60),d%=60,he%=60,ve=te(J/12),J%=12,Oe=d?d.toFixed(3).replace(/\.?0+$/,""):"",ut=Qe<0?"-":"",_t=sa(this._months)!==sa(Qe)?"-":"",Ti=sa(this._days)!==sa(Qe)?"-":"",Co=sa(this._milliseconds)!==sa(Qe)?"-":"",ut+"P"+(ve?_t+ve+"Y":"")+(J?_t+J+"M":"")+(T?Ti+T+"D":"")+(pe||he||d?"T":"")+(pe?Co+pe+"H":"")+(he?Co+he+"M":"")+(d?Co+Oe+"S":"")):"P0D"}var xt=Mf.prototype;xt.isValid=$N,xt.abs=RL,xt.add=ML,xt.subtract=OL,xt.as=IL,xt.asMilliseconds=NL,xt.asSeconds=PL,xt.asMinutes=LL,xt.asHours=DL,xt.asDays=kL,xt.asWeeks=HL,xt.asMonths=FL,xt.asQuarters=BL,xt.asYears=VL,xt.valueOf=_L,xt._bubble=AL,xt.clone=WL,xt.get=UL,xt.milliseconds=YL,xt.seconds=jL,xt.minutes=GL,xt.hours=zL,xt.days=$L,xt.weeks=KL,xt.months=XL,xt.years=qL,xt.humanize=tD,xt.toISOString=Lf,xt.toString=Lf,xt.toJSON=Lf,xt.locale=QS,xt.localeData=e0,xt.toIsoString=H("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Lf),xt.lang=JS,B("X",0,0,"unix"),B("x",0,0,"valueOf"),Be("x",qe),Be("X",Fs),Et("X",function(d,T,J){J._d=new Date(parseFloat(d)*1e3)}),Et("x",function(d,T,J){J._d=new Date(re(d))});return e.version="2.29.4",t(Ht),e.fn=De,e.min=YN,e.max=jN,e.now=GN,e.utc=p,e.unix=yL,e.months=bL,e.isDate=c,e.locale=tr,e.invalid=M,e.duration=Ts,e.isMoment=ie,e.weekdays=SL,e.parseZone=vL,e.localeData=fo,e.isDuration=Of,e.monthsShort=xL,e.weekdaysMin=TL,e.defineLocale=pg,e.updateLocale=vN,e.locales=bN,e.weekdaysShort=EL,e.normalizeUnits=ee,e.relativeTimeRounding=JL,e.relativeTimeThreshold=eD,e.calendarFormat=gP,e.prototype=De,e.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},e})});var uM=Ie((sX,cM)=>{"use strict";var gV=yi(),aM=gC(),CV=di(),lM=qr(),wV=vC(),hM=gV([].push);cM.exports=function(o){if(CV(o))return o;if(aM(o)){for(var e=o.length,t=[],i=0;i<e;i++){var s=o[i];typeof s=="string"?hM(t,s):(typeof s=="number"||lM(s)==="Number"||lM(s)==="String")&&hM(t,wV(s))}var r=t.length,n=!0;return function(a,l){if(n)return n=!1,l;if(aM(this))return l;for(var c=0;c<r;c++)if(t[c]===a)return l}}}});var VM=Ie((cq,BM)=>{"use strict";var iW=fC(),sW=Jf();BM.exports=Object.keys||function(e){return iW(e,sW)}});var UM=Ie(WM=>{"use strict";var oW=Rs(),rW=Qg(),nW=Kr(),aW=na(),lW=Kl(),hW=VM();WM.f=oW&&!rW?Object.defineProperties:function(e,t){aW(e);for(var i=lW(t),s=hW(t),r=s.length,n=0,a;r>n;)nW.f(e,a=s[n++],i[a]);return e}});var KM=Ie((dq,qM)=>{"use strict";var cW=na(),uW=UM(),YM=Jf(),dW=$f(),fW=SC(),mW=Gf(),pW=nC(),jM=">",GM="<",Aw="prototype",Iw="script",$M=pW("IE_PROTO"),Ow=function(){},XM=function(o){return GM+Iw+jM+o+GM+"/"+Iw+jM},zM=function(o){o.write(XM("")),o.close();var e=o.parentWindow.Object;return o=null,e},gW=function(){var o=mW("iframe"),e="java"+Iw+":",t;return o.style.display="none",fW.appendChild(o),o.src=String(e),t=o.contentWindow.document,t.open(),t.write(XM("document.F=Object")),t.close(),t.F},Cm,wm=function(){try{Cm=new ActiveXObject("htmlfile")}catch{}wm=typeof document<"u"?document.domain&&Cm?zM(Cm):gW():zM(Cm);for(var o=YM.length;o--;)delete wm[Aw][YM[o]];return wm()};dW[$M]=!0;qM.exports=Object.create||function(e,t){var i;return e!==null?(Ow[Aw]=cW(e),i=new Ow,Ow[Aw]=null,i[$M]=e):i=wm(),t===void 0?i:uW.f(i,t)}});var QM=Ie((fq,ZM)=>{"use strict";var CW=Ql(),wW=KM(),yW=Kr().f,_w=CW("unscopables"),Nw=Array.prototype;Nw[_w]===void 0&&yW(Nw,_w,{configurable:!0,value:wW(null)});ZM.exports=function(o){Nw[_w][o]=!0}});var EA=Ie((Vy,SA)=>{"use strict";(function(o,e){"use strict";var t;if(typeof Vy=="object"){try{t=Ui()}catch{}SA.exports=e(t)}else typeof define=="function"&&define.amd?define(function(i){var s="moment";try{t=i(s)}catch{}return e(t)}):o.Pikaday=e(o.moment)})(Vy,function(o){"use strict";var e=typeof o=="function",t=!!window.addEventListener,i=window.document,s=window.setTimeout,r=function(f,w,b,h){t?f.addEventListener(w,b,!!h):f.attachEvent("on"+w,b)},n=function(f,w,b,h){t?f.removeEventListener(w,b,!!h):f.detachEvent("on"+w,b)},a=function(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")},l=function(f,w){return(" "+f.className+" ").indexOf(" "+w+" ")!==-1},c=function(f,w){l(f,w)||(f.className=f.className===""?w:f.className+" "+w)},u=function(f,w){f.className=a((" "+f.className+" ").replace(" "+w+" "," "))},g=function(f){return/Array/.test(Object.prototype.toString.call(f))},p=function(f){return/Date/.test(Object.prototype.toString.call(f))&&!isNaN(f.getTime())},C=function(f){var w=f.getDay();return w===0||w===6},y=function(f){return f%4===0&&f%100!==0||f%400===0},S=function(f,w){return[31,y(f)?29:28,31,30,31,30,31,31,30,31,30,31][w]},O=function(f){p(f)&&f.setHours(0,0,0,0)},M=function(f,w){return f.getTime()===w.getTime()},_=function(f,w,b){var h,m;for(h in w)m=f[h]!==void 0,m&&typeof w[h]=="object"&&w[h]!==null&&w[h].nodeName===void 0?p(w[h])?b&&(f[h]=new Date(w[h].getTime())):g(w[h])?b&&(f[h]=w[h].slice(0)):f[h]=_({},w[h],b):(b||!m)&&(f[h]=w[h]);return f},N=function(f,w,b){var h;i.createEvent?(h=i.createEvent("HTMLEvents"),h.initEvent(w,!0,!1),h=_(h,b),f.dispatchEvent(h)):i.createEventObject&&(h=i.createEventObject(),h=_(h,b),f.fireEvent("on"+w,h))},E=function(f){return f.month<0&&(f.year-=Math.ceil(Math.abs(f.month)/12),f.month+=12),f.month>11&&(f.year+=Math.floor(Math.abs(f.month)/12),f.month-=12),f},k={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},ie=function(f,w,b){for(w+=f.firstDay;w>=7;)w-=7;return b?f.i18n.weekdaysShort[w]:f.i18n.weekdays[w]},$=function(f){var w=[],b="false";if(f.isEmpty)if(f.showDaysInNextAndPreviousMonths)w.push("is-outside-current-month"),f.enableSelectionDaysInNextAndPreviousMonths||w.push("is-selection-disabled");else return'<td class="is-empty"></td>';return f.isDisabled&&w.push("is-disabled"),f.isToday&&w.push("is-today"),f.isSelected&&(w.push("is-selected"),b="true"),f.hasEvent&&w.push("has-event"),f.isInRange&&w.push("is-inrange"),f.isStartRange&&w.push("is-startrange"),f.isEndRange&&w.push("is-endrange"),'<td data-day="'+f.day+'" class="'+w.join(" ")+'" aria-selected="'+b+'"><button class="pika-button pika-day" type="button" data-pika-year="'+f.year+'" data-pika-month="'+f.month+'" data-pika-day="'+f.day+'">'+f.day+"</button></td>"},H=function(f,w){f.setHours(0,0,0,0);var b=f.getDate(),h=f.getDay(),m=w,x=m-1,I=7,B=function(X){return(X+I-1)%I};f.setDate(b+x-B(h));var V=new Date(f.getFullYear(),0,m),U=24*60*60*1e3,K=(f.getTime()-V.getTime())/U,L=1+Math.round((K-x+B(V.getDay()))/I);return L},Q=function(f,w,b,h){var m=new Date(b,w,f),x=e?o(m).isoWeek():H(m,h);return'<td class="pika-week">'+x+"</td>"},Y=function(f,w,b,h){return'<tr class="pika-row'+(b?" pick-whole-week":"")+(h?" is-selected":"")+'">'+(w?f.reverse():f).join("")+"</tr>"},P=function(f){return"<tbody>"+f.join("")+"</tbody>"},j=function(f){var w,b=[];for(f.showWeekNumber&&b.push("<th></th>"),w=0;w<7;w++)b.push('<th scope="col"><abbr title="'+ie(f,w)+'">'+ie(f,w,!0)+"</abbr></th>");return"<thead><tr>"+(f.isRTL?b.reverse():b).join("")+"</tr></thead>"},A=function(f,w,b,h,m,x){var I,B,V,U=f._o,K=b===U.minYear,L=b===U.maxYear,X='<div id="'+x+'" class="pika-title" role="heading" aria-live="assertive">',q,le,D=!0,F=!0;for(V=[],I=0;I<12;I++)V.push('<option value="'+(b===m?I-w:12+I-w)+'"'+(I===h?' selected="selected"':"")+(K&&I<U.minMonth||L&&I>U.maxMonth?' disabled="disabled"':"")+">"+U.i18n.months[I]+"</option>");for(q='<div class="pika-label">'+U.i18n.months[h]+'<select class="pika-select pika-select-month" tabindex="-1">'+V.join("")+"</select></div>",g(U.yearRange)?(I=U.yearRange[0],B=U.yearRange[1]+1):(I=b-U.yearRange,B=1+b+U.yearRange),V=[];I<B&&I<=U.maxYear;I++)I>=U.minYear&&V.push('<option value="'+I+'"'+(I===b?' selected="selected"':"")+">"+I+"</option>");return le='<div class="pika-label">'+b+U.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+V.join("")+"</select></div>",U.showMonthAfterYear?X+=le+q:X+=q+le,K&&(h===0||U.minMonth>=h)&&(D=!1),L&&(h===11||U.maxMonth<=h)&&(F=!1),w===0&&(X+='<button class="pika-prev'+(D?"":" is-disabled")+'" type="button">'+U.i18n.previousMonth+"</button>"),w===f._o.numberOfMonths-1&&(X+='<button class="pika-next'+(F?"":" is-disabled")+'" type="button">'+U.i18n.nextMonth+"</button>"),X+="</div>"},v=function(f,w,b){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+b+'">'+j(f)+P(w)+"</table>"},R=function(f){var w=this,b=w.config(f);w._onMouseDown=function(m){if(w._v){m=m||window.event;var x=m.target||m.srcElement;if(x)if(l(x,"is-disabled")||(l(x,"pika-button")&&!l(x,"is-empty")&&!l(x.parentNode,"is-disabled")?(w.setDate(new Date(x.getAttribute("data-pika-year"),x.getAttribute("data-pika-month"),x.getAttribute("data-pika-day"))),b.bound&&s(function(){w.hide(),b.blurFieldOnSelect&&b.field&&b.field.blur()},100)):l(x,"pika-prev")?w.prevMonth():l(x,"pika-next")&&w.nextMonth()),l(x,"pika-select"))w._c=!0;else if(m.preventDefault)m.preventDefault();else return m.returnValue=!1,!1}},w._onChange=function(m){m=m||window.event;var x=m.target||m.srcElement;x&&(l(x,"pika-select-month")?w.gotoMonth(x.value):l(x,"pika-select-year")&&w.gotoYear(x.value))},w._onKeyChange=function(m){if(m=m||window.event,w.isVisible())switch(m.keyCode){case 13:case 27:b.field&&b.field.blur();break;case 37:w.adjustDate("subtract",1);break;case 38:w.adjustDate("subtract",7);break;case 39:w.adjustDate("add",1);break;case 40:w.adjustDate("add",7);break;case 8:case 46:w.setDate(null);break}},w._parseFieldValue=function(){if(b.parse)return b.parse(b.field.value,b.format);if(e){var m=o(b.field.value,b.format,b.formatStrict);return m&&m.isValid()?m.toDate():null}else return new Date(Date.parse(b.field.value))},w._onInputChange=function(m){var x;m.firedBy!==w&&(x=w._parseFieldValue(),p(x)&&w.setDate(x),w._v||w.show())},w._onInputFocus=function(){w.show()},w._onInputClick=function(){w.show()},w._onInputBlur=function(){var m=i.activeElement;do if(l(m,"pika-single"))return;while(m=m.parentNode);w._c||(w._b=s(function(){w.hide()},50)),w._c=!1},w._onClick=function(m){m=m||window.event;var x=m.target||m.srcElement,I=x;if(x){!t&&l(x,"pika-select")&&(x.onchange||(x.setAttribute("onchange","return;"),r(x,"change",w._onChange)));do if(l(I,"pika-single")||I===b.trigger)return;while(I=I.parentNode);w._v&&x!==b.trigger&&I!==b.trigger&&w.hide()}},w.el=i.createElement("div"),w.el.className="pika-single"+(b.isRTL?" is-rtl":"")+(b.theme?" "+b.theme:""),r(w.el,"mousedown",w._onMouseDown,!0),r(w.el,"touchend",w._onMouseDown,!0),r(w.el,"change",w._onChange),b.keyboardInput&&r(i,"keydown",w._onKeyChange),b.field&&(b.container?b.container.appendChild(w.el):b.bound?i.body.appendChild(w.el):b.field.parentNode.insertBefore(w.el,b.field.nextSibling),r(b.field,"change",w._onInputChange),b.defaultDate||(b.defaultDate=w._parseFieldValue(),b.setDefaultDate=!0));var h=b.defaultDate;p(h)?b.setDefaultDate?w.setDate(h,!0):w.gotoDate(h):w.gotoDate(new Date),b.bound?(this.hide(),w.el.className+=" is-bound",r(b.trigger,"click",w._onInputClick),r(b.trigger,"focus",w._onInputFocus),r(b.trigger,"blur",w._onInputBlur)):this.show()};return R.prototype={config:function(f){this._o||(this._o=_({},k,!0));var w=_(this._o,f,!0);w.isRTL=!!w.isRTL,w.field=w.field&&w.field.nodeName?w.field:null,w.theme=typeof w.theme=="string"&&w.theme?w.theme:null,w.bound=!!(w.bound!==void 0?w.field&&w.bound:w.field),w.trigger=w.trigger&&w.trigger.nodeName?w.trigger:w.field,w.disableWeekends=!!w.disableWeekends,w.disableDayFn=typeof w.disableDayFn=="function"?w.disableDayFn:null;var b=parseInt(w.numberOfMonths,10)||1;if(w.numberOfMonths=b>4?4:b,p(w.minDate)||(w.minDate=!1),p(w.maxDate)||(w.maxDate=!1),w.minDate&&w.maxDate&&w.maxDate<w.minDate&&(w.maxDate=w.minDate=!1),w.minDate&&this.setMinDate(w.minDate),w.maxDate&&this.setMaxDate(w.maxDate),g(w.yearRange)){var h=new Date().getFullYear()-10;w.yearRange[0]=parseInt(w.yearRange[0],10)||h,w.yearRange[1]=parseInt(w.yearRange[1],10)||h}else w.yearRange=Math.abs(parseInt(w.yearRange,10))||k.yearRange,w.yearRange>100&&(w.yearRange=100);return w},toString:function(f){return f=f||this._o.format,p(this._d)?this._o.toString?this._o.toString(this._d,f):e?o(this._d).format(f):this._d.toDateString():""},getMoment:function(){return e?o(this._d):null},setMoment:function(f,w){e&&o.isMoment(f)&&this.setDate(f.toDate(),w)},getDate:function(){return p(this._d)?new Date(this._d.getTime()):null},setDate:function(f,w){if(!f)return this._d=null,this._o.field&&(this._o.field.value="",N(this._o.field,"change",{firedBy:this})),this.draw();if(typeof f=="string"&&(f=new Date(Date.parse(f))),!!p(f)){var b=this._o.minDate,h=this._o.maxDate;p(b)&&f<b?f=b:p(h)&&f>h&&(f=h),this._d=new Date(f.getTime()),O(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),N(this._o.field,"change",{firedBy:this})),!w&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(f){var w=!0;if(p(f)){if(this.calendars){var b=new Date(this.calendars[0].year,this.calendars[0].month,1),h=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),m=f.getTime();h.setMonth(h.getMonth()+1),h.setDate(h.getDate()-1),w=m<b.getTime()||h.getTime()<m}w&&(this.calendars=[{month:f.getMonth(),year:f.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(f,w){var b=this.getDate()||new Date,h=parseInt(w)*24*60*60*1e3,m;f==="add"?m=new Date(b.valueOf()+h):f==="subtract"&&(m=new Date(b.valueOf()-h)),this.setDate(m)},adjustCalendars:function(){this.calendars[0]=E(this.calendars[0]);for(var f=1;f<this._o.numberOfMonths;f++)this.calendars[f]=E({month:this.calendars[0].month+f,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(f){isNaN(f)||(this.calendars[0].month=parseInt(f,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(f){isNaN(f)||(this.calendars[0].year=parseInt(f,10),this.adjustCalendars())},setMinDate:function(f){f instanceof Date?(O(f),this._o.minDate=f,this._o.minYear=f.getFullYear(),this._o.minMonth=f.getMonth()):(this._o.minDate=k.minDate,this._o.minYear=k.minYear,this._o.minMonth=k.minMonth,this._o.startRange=k.startRange),this.draw()},setMaxDate:function(f){f instanceof Date?(O(f),this._o.maxDate=f,this._o.maxYear=f.getFullYear(),this._o.maxMonth=f.getMonth()):(this._o.maxDate=k.maxDate,this._o.maxYear=k.maxYear,this._o.maxMonth=k.maxMonth,this._o.endRange=k.endRange),this.draw()},setStartRange:function(f){this._o.startRange=f},setEndRange:function(f){this._o.endRange=f},draw:function(f){if(!(!this._v&&!f)){var w=this._o,b=w.minYear,h=w.maxYear,m=w.minMonth,x=w.maxMonth,I="",B;this._y<=b&&(this._y=b,!isNaN(m)&&this._m<m&&(this._m=m)),this._y>=h&&(this._y=h,!isNaN(x)&&this._m>x&&(this._m=x));for(var V=0;V<w.numberOfMonths;V++)B="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),I+='<div class="pika-lendar">'+A(this,V,this.calendars[V].year,this.calendars[V].month,this.calendars[0].year,B)+this.render(this.calendars[V].year,this.calendars[V].month,B)+"</div>";this.el.innerHTML=I,w.bound&&w.field.type!=="hidden"&&s(function(){w.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),w.bound&&w.field.setAttribute("aria-label",w.ariaLabel)}},adjustPosition:function(){var f,w,b,h,m,x,I,B,V,U,K,L;if(!this._o.container){if(this.el.style.position="absolute",f=this._o.trigger,w=f,b=this.el.offsetWidth,h=this.el.offsetHeight,m=window.innerWidth||i.documentElement.clientWidth,x=window.innerHeight||i.documentElement.clientHeight,I=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,K=!0,L=!0,typeof f.getBoundingClientRect=="function")U=f.getBoundingClientRect(),B=U.left+window.pageXOffset,V=U.bottom+window.pageYOffset;else for(B=w.offsetLeft,V=w.offsetTop+w.offsetHeight;w=w.offsetParent;)B+=w.offsetLeft,V+=w.offsetTop;(this._o.reposition&&B+b>m||this._o.position.indexOf("right")>-1&&B-b+f.offsetWidth>0)&&(B=B-b+f.offsetWidth,K=!1),(this._o.reposition&&V+h>x+I||this._o.position.indexOf("top")>-1&&V-h-f.offsetHeight>0)&&(V=V-h-f.offsetHeight,L=!1),this.el.style.left=B+"px",this.el.style.top=V+"px",c(this.el,K?"left-aligned":"right-aligned"),c(this.el,L?"bottom-aligned":"top-aligned"),u(this.el,K?"right-aligned":"left-aligned"),u(this.el,L?"top-aligned":"bottom-aligned")}},render:function(f,w,b){var h=this._o,m=new Date,x=S(f,w),I=new Date(f,w,1).getDay(),B=[],V=[];O(m),h.firstDay>0&&(I-=h.firstDay,I<0&&(I+=7));for(var U=w===0?11:w-1,K=w===11?0:w+1,L=w===0?f-1:f,X=w===11?f+1:f,q=S(L,U),le=x+I,D=le;D>7;)D-=7;le+=7-D;for(var F=!1,oe=0,ne=0;oe<le;oe++){var ae=new Date(f,w,1+(oe-I)),fe=p(this._d)?M(ae,this._d):!1,me=M(ae,m),G=h.events.indexOf(ae.toDateString())!==-1,se=oe<I||oe>=x+I,ee=1+(oe-I),ue=w,de=f,W=h.startRange&&M(h.startRange,ae),z=h.endRange&&M(h.endRange,ae),Z=h.startRange&&h.endRange&&h.startRange<ae&&ae<h.endRange,te=h.minDate&&ae<h.minDate||h.maxDate&&ae>h.maxDate||h.disableWeekends&&C(ae)||h.disableDayFn&&h.disableDayFn(ae);se&&(oe<I?(ee=q+ee,ue=U,de=L):(ee=ee-x,ue=K,de=X));var re={day:ee,month:ue,year:de,hasEvent:G,isSelected:fe,isToday:me,isDisabled:te,isEmpty:se,isStartRange:W,isEndRange:z,isInRange:Z,showDaysInNextAndPreviousMonths:h.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:h.enableSelectionDaysInNextAndPreviousMonths};h.pickWholeWeek&&fe&&(F=!0),V.push($(re)),++ne===7&&(h.showWeekNumber&&V.unshift(Q(oe-I,w,f,h.firstWeekOfYearMinDays)),B.push(Y(V,h.isRTL,h.pickWholeWeek,F)),V=[],ne=0,F=!1)}return v(h,B,b)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),u(this.el,"is-hidden"),this._o.bound&&(r(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var f=this._v;f!==!1&&(this._o.bound&&n(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),c(this.el,"is-hidden"),this._v=!1,f!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var f=this._o;this.hide(),n(this.el,"mousedown",this._onMouseDown,!0),n(this.el,"touchend",this._onMouseDown,!0),n(this.el,"change",this._onChange),f.keyboardInput&&n(i,"keydown",this._onKeyChange),f.field&&(n(f.field,"change",this._onInputChange),f.bound&&(n(f.trigger,"click",this._onInputClick),n(f.trigger,"focus",this._onInputFocus),n(f.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},R})});var _A=Ie((IA,Zy)=>{"use strict";(function(o){typeof IA=="object"&&typeof Zy<"u"?Zy.exports=o():typeof define=="function"&&define.amd?define([],o):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).numbro=o()})(function(){return function o(e,t,i){function s(a,l){if(!t[a]){if(!e[a]){var c=typeof Xr=="function"&&Xr;if(!l&&c)return c(a,!0);if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var g=t[a]={exports:{}};e[a][0].call(g.exports,function(p){return s(e[a][1][p]||p)},g,g.exports,o,e,t,i)}return t[a].exports}for(var r=typeof Xr=="function"&&Xr,n=0;n<i.length;n++)s(i[n]);return s}({1:[function(o,e,t){(function(i){"use strict";var s,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,n=Math.ceil,a=Math.floor,l="[BigNumber Error] ",c=l+"Number primitive has more than 15 significant digits: ",u=1e14,g=14,p=9007199254740991,C=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],y=1e7,S=1e9;function O($){var H=0|$;return 0<$||$===H?H:H-1}function M($){for(var H,Q,Y=1,P=$.length,j=$[0]+"";Y<P;){for(H=$[Y++]+"",Q=g-H.length;Q--;H="0"+H);j+=H}for(P=j.length;j.charCodeAt(--P)===48;);return j.slice(0,P+1||1)}function _($,H){var Q,Y,P=$.c,j=H.c,A=$.s,v=H.s,R=$.e,f=H.e;if(!A||!v)return null;if(Q=P&&!P[0],Y=j&&!j[0],Q||Y)return Q?Y?0:-v:A;if(A!=v)return A;if(Q=A<0,Y=R==f,!P||!j)return Y?0:!P^Q?1:-1;if(!Y)return f<R^Q?1:-1;for(v=(R=P.length)<(f=j.length)?R:f,A=0;A<v;A++)if(P[A]!=j[A])return P[A]>j[A]^Q?1:-1;return R==f?0:f<R^Q?1:-1}function N($,H,Q,Y){if($<H||Q<$||$!==($<0?n($):a($)))throw Error(l+(Y||"Argument")+(typeof $=="number"?$<H||Q<$?" out of range: ":" not an integer: ":" not a primitive number: ")+String($))}function E($){var H=$.c.length-1;return O($.e/g)==H&&$.c[H]%2!=0}function k($,H){return(1<$.length?$.charAt(0)+"."+$.slice(1):$)+(H<0?"e":"e+")+H}function ie($,H,Q){var Y,P;if(H<0){for(P=Q+".";++H;P+=Q);$=P+$}else if(++H>(Y=$.length)){for(P=Q,H-=Y;--H;P+=Q);$+=P}else H<Y&&($=$.slice(0,H)+"."+$.slice(H));return $}(s=function $(H){var Q,Y,P,j,A,v,R,f,w,b,h=F.prototype={constructor:F,toString:null,valueOf:null},m=new F(1),x=20,I=4,B=-7,V=21,U=-1e7,K=1e7,L=!1,X=1,q=0,le={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},D="0123456789abcdefghijklmnopqrstuvwxyz";function F(G,se){var ee,ue,de,W,z,Z,te,re,ce=this;if(!(ce instanceof F))return new F(G,se);if(se==null){if(G instanceof F)return ce.s=G.s,ce.e=G.e,void(ce.c=(G=G.c)?G.slice():G);if((Z=typeof G=="number")&&0*G==0){if(ce.s=1/G<0?(G=-G,-1):1,G===~~G){for(W=0,z=G;10<=z;z/=10,W++);return ce.e=W,void(ce.c=[G])}re=String(G)}else{if(re=String(G),!r.test(re))return P(ce,re,Z);ce.s=re.charCodeAt(0)==45?(re=re.slice(1),-1):1}-1<(W=re.indexOf("."))&&(re=re.replace(".","")),0<(z=re.search(/e/i))?(W<0&&(W=z),W+=+re.slice(z+1),re=re.substring(0,z)):W<0&&(W=re.length)}else{if(N(se,2,D.length,"Base"),re=String(G),se==10)return fe(ce=new F(G instanceof F?G:re),x+ce.e+1,I);if(Z=typeof G=="number"){if(0*G!=0)return P(ce,re,Z,se);if(ce.s=1/G<0?(re=re.slice(1),-1):1,F.DEBUG&&15<re.replace(/^0\.0*|\./,"").length)throw Error(c+G);Z=!1}else ce.s=re.charCodeAt(0)===45?(re=re.slice(1),-1):1;for(ee=D.slice(0,se),W=z=0,te=re.length;z<te;z++)if(ee.indexOf(ue=re.charAt(z))<0){if(ue=="."){if(W<z){W=te;continue}}else if(!de&&(re==re.toUpperCase()&&(re=re.toLowerCase())||re==re.toLowerCase()&&(re=re.toUpperCase()))){de=!0,z=-1,W=0;continue}return P(ce,String(G),Z,se)}-1<(W=(re=Y(re,se,10,ce.s)).indexOf("."))?re=re.replace(".",""):W=re.length}for(z=0;re.charCodeAt(z)===48;z++);for(te=re.length;re.charCodeAt(--te)===48;);if(re=re.slice(z,++te)){if(te-=z,Z&&F.DEBUG&&15<te&&(p<G||G!==a(G)))throw Error(c+ce.s*G);if(K<(W=W-z-1))ce.c=ce.e=null;else if(W<U)ce.c=[ce.e=0];else{if(ce.e=W,ce.c=[],z=(W+1)%g,W<0&&(z+=g),z<te){for(z&&ce.c.push(+re.slice(0,z)),te-=g;z<te;)ce.c.push(+re.slice(z,z+=g));re=re.slice(z),z=g-re.length}else z-=te;for(;z--;re+="0");ce.c.push(+re)}}else ce.c=[ce.e=0]}function oe(G,se,ee,ue){var de,W,z,Z,te;if(ee==null?ee=I:N(ee,0,8),!G.c)return G.toString();if(de=G.c[0],z=G.e,se==null)te=M(G.c),te=ue==1||ue==2&&(z<=B||V<=z)?k(te,z):ie(te,z,"0");else if(W=(G=fe(new F(G),se,ee)).e,Z=(te=M(G.c)).length,ue==1||ue==2&&(se<=W||W<=B)){for(;Z<se;te+="0",Z++);te=k(te,W)}else if(se-=z,te=ie(te,W,"0"),Z<W+1){if(0<--se)for(te+=".";se--;te+="0");}else if(0<(se+=W-Z))for(W+1==Z&&(te+=".");se--;te+="0");return G.s<0&&de?"-"+te:te}function ne(G,se){for(var ee,ue=1,de=new F(G[0]);ue<G.length;ue++){if(!(ee=new F(G[ue])).s){de=ee;break}se.call(de,ee)&&(de=ee)}return de}function ae(G,se,ee){for(var ue=1,de=se.length;!se[--de];se.pop());for(de=se[0];10<=de;de/=10,ue++);return(ee=ue+ee*g-1)>K?G.c=G.e=null:G.c=ee<U?[G.e=0]:(G.e=ee,se),G}function fe(G,se,ee,ue){var de,W,z,Z,te,re,ce,Ce=G.c,ge=C;if(Ce){e:{for(de=1,Z=Ce[0];10<=Z;Z/=10,de++);if((W=se-de)<0)W+=g,z=se,ce=(te=Ce[re=0])/ge[de-z-1]%10|0;else if((re=n((W+1)/g))>=Ce.length){if(!ue)break e;for(;Ce.length<=re;Ce.push(0));te=ce=0,z=(W%=g)-g+(de=1)}else{for(te=Z=Ce[re],de=1;10<=Z;Z/=10,de++);ce=(z=(W%=g)-g+de)<0?0:te/ge[de-z-1]%10|0}if(ue=ue||se<0||Ce[re+1]!=null||(z<0?te:te%ge[de-z-1]),ue=ee<4?(ce||ue)&&(ee==0||ee==(G.s<0?3:2)):5<ce||ce==5&&(ee==4||ue||ee==6&&(0<W?0<z?te/ge[de-z]:0:Ce[re-1])%10&1||ee==(G.s<0?8:7)),se<1||!Ce[0])return Ce.length=0,ue?(se-=G.e+1,Ce[0]=ge[(g-se%g)%g],G.e=-se||0):Ce[0]=G.e=0,G;if(W==0?(Ce.length=re,Z=1,re--):(Ce.length=re+1,Z=ge[g-W],Ce[re]=0<z?a(te/ge[de-z]%ge[z])*Z:0),ue)for(;;){if(re==0){for(W=1,z=Ce[0];10<=z;z/=10,W++);for(z=Ce[0]+=Z,Z=1;10<=z;z/=10,Z++);W!=Z&&(G.e++,Ce[0]==u&&(Ce[0]=1));break}if(Ce[re]+=Z,Ce[re]!=u)break;Ce[re--]=0,Z=1}for(W=Ce.length;Ce[--W]===0;Ce.pop());}G.e>K?G.c=G.e=null:G.e<U&&(G.c=[G.e=0])}return G}function me(G){var se,ee=G.e;return ee===null?G.toString():(se=M(G.c),se=ee<=B||V<=ee?k(se,ee):ie(se,ee,"0"),G.s<0?"-"+se:se)}return F.clone=$,F.ROUND_UP=0,F.ROUND_DOWN=1,F.ROUND_CEIL=2,F.ROUND_FLOOR=3,F.ROUND_HALF_UP=4,F.ROUND_HALF_DOWN=5,F.ROUND_HALF_EVEN=6,F.ROUND_HALF_CEIL=7,F.ROUND_HALF_FLOOR=8,F.EUCLID=9,F.config=F.set=function(G){var se,ee;if(G!=null){if(typeof G!="object")throw Error(l+"Object expected: "+G);if(G.hasOwnProperty(se="DECIMAL_PLACES")&&(N(ee=G[se],0,S,se),x=ee),G.hasOwnProperty(se="ROUNDING_MODE")&&(N(ee=G[se],0,8,se),I=ee),G.hasOwnProperty(se="EXPONENTIAL_AT")&&((ee=G[se])&&ee.pop?(N(ee[0],-S,0,se),N(ee[1],0,S,se),B=ee[0],V=ee[1]):(N(ee,-S,S,se),B=-(V=ee<0?-ee:ee))),G.hasOwnProperty(se="RANGE"))if((ee=G[se])&&ee.pop)N(ee[0],-S,-1,se),N(ee[1],1,S,se),U=ee[0],K=ee[1];else{if(N(ee,-S,S,se),!ee)throw Error(l+se+" cannot be zero: "+ee);U=-(K=ee<0?-ee:ee)}if(G.hasOwnProperty(se="CRYPTO")){if((ee=G[se])!==!!ee)throw Error(l+se+" not true or false: "+ee);if(ee){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw L=!ee,Error(l+"crypto unavailable");L=ee}else L=ee}if(G.hasOwnProperty(se="MODULO_MODE")&&(N(ee=G[se],0,9,se),X=ee),G.hasOwnProperty(se="POW_PRECISION")&&(N(ee=G[se],0,S,se),q=ee),G.hasOwnProperty(se="FORMAT")){if(typeof(ee=G[se])!="object")throw Error(l+se+" not an object: "+ee);le=ee}if(G.hasOwnProperty(se="ALPHABET")){if(typeof(ee=G[se])!="string"||/^.$|[+-.\s]|(.).*\1/.test(ee))throw Error(l+se+" invalid: "+ee);D=ee}}return{DECIMAL_PLACES:x,ROUNDING_MODE:I,EXPONENTIAL_AT:[B,V],RANGE:[U,K],CRYPTO:L,MODULO_MODE:X,POW_PRECISION:q,FORMAT:le,ALPHABET:D}},F.isBigNumber=function(G){return G instanceof F||G&&G._isBigNumber===!0||!1},F.maximum=F.max=function(){return ne(arguments,h.lt)},F.minimum=F.min=function(){return ne(arguments,h.gt)},F.random=(j=9007199254740992,A=Math.random()*j&2097151?function(){return a(Math.random()*j)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(G){var se,ee,ue,de,W,z=0,Z=[],te=new F(m);if(G==null?G=x:N(G,0,S),de=n(G/g),L)if(crypto.getRandomValues){for(se=crypto.getRandomValues(new Uint32Array(de*=2));z<de;)9e15<=(W=131072*se[z]+(se[z+1]>>>11))?(ee=crypto.getRandomValues(new Uint32Array(2)),se[z]=ee[0],se[z+1]=ee[1]):(Z.push(W%1e14),z+=2);z=de/2}else{if(!crypto.randomBytes)throw L=!1,Error(l+"crypto unavailable");for(se=crypto.randomBytes(de*=7);z<de;)9e15<=(W=281474976710656*(31&se[z])+1099511627776*se[z+1]+4294967296*se[z+2]+16777216*se[z+3]+(se[z+4]<<16)+(se[z+5]<<8)+se[z+6])?crypto.randomBytes(7).copy(se,z):(Z.push(W%1e14),z+=7);z=de/7}if(!L)for(;z<de;)(W=A())<9e15&&(Z[z++]=W%1e14);for(de=Z[--z],G%=g,de&&G&&(W=C[g-G],Z[z]=a(de/W)*W);Z[z]===0;Z.pop(),z--);if(z<0)Z=[ue=0];else{for(ue=-1;Z[0]===0;Z.splice(0,1),ue-=g);for(z=1,W=Z[0];10<=W;W/=10,z++);z<g&&(ue-=g-z)}return te.e=ue,te.c=Z,te}),F.sum=function(){for(var G=1,se=arguments,ee=new F(se[0]);G<se.length;)ee=ee.plus(se[G++]);return ee},Y=function(){var G="0123456789";function se(ee,ue,de,W){for(var z,Z,te=[0],re=0,ce=ee.length;re<ce;){for(Z=te.length;Z--;te[Z]*=ue);for(te[0]+=W.indexOf(ee.charAt(re++)),z=0;z<te.length;z++)te[z]>de-1&&(te[z+1]==null&&(te[z+1]=0),te[z+1]+=te[z]/de|0,te[z]%=de)}return te.reverse()}return function(ee,ue,de,W,z){var Z,te,re,ce,Ce,ge,ye,Ee,Se=ee.indexOf("."),be=x,Re=I;for(0<=Se&&(ce=q,q=0,ee=ee.replace(".",""),ge=(Ee=new F(ue)).pow(ee.length-Se),q=ce,Ee.c=se(ie(M(ge.c),ge.e,"0"),10,de,G),Ee.e=Ee.c.length),re=ce=(ye=se(ee,ue,de,z?(Z=D,G):(Z=G,D))).length;ye[--ce]==0;ye.pop());if(!ye[0])return Z.charAt(0);if(Se<0?--re:(ge.c=ye,ge.e=re,ge.s=W,ye=(ge=Q(ge,Ee,be,Re,de)).c,Ce=ge.r,re=ge.e),Se=ye[te=re+be+1],ce=de/2,Ce=Ce||te<0||ye[te+1]!=null,Ce=Re<4?(Se!=null||Ce)&&(Re==0||Re==(ge.s<0?3:2)):ce<Se||Se==ce&&(Re==4||Ce||Re==6&&1&ye[te-1]||Re==(ge.s<0?8:7)),te<1||!ye[0])ee=Ce?ie(Z.charAt(1),-be,Z.charAt(0)):Z.charAt(0);else{if(ye.length=te,Ce)for(--de;++ye[--te]>de;)ye[te]=0,te||(++re,ye=[1].concat(ye));for(ce=ye.length;!ye[--ce];);for(Se=0,ee="";Se<=ce;ee+=Z.charAt(ye[Se++]));ee=ie(ee,re,Z.charAt(0))}return ee}}(),Q=function(){function G(ue,de,W){var z,Z,te,re,ce=0,Ce=ue.length,ge=de%y,ye=de/y|0;for(ue=ue.slice();Ce--;)ce=((Z=ge*(te=ue[Ce]%y)+(z=ye*te+(re=ue[Ce]/y|0)*ge)%y*y+ce)/W|0)+(z/y|0)+ye*re,ue[Ce]=Z%W;return ce&&(ue=[ce].concat(ue)),ue}function se(ue,de,W,z){var Z,te;if(W!=z)te=z<W?1:-1;else for(Z=te=0;Z<W;Z++)if(ue[Z]!=de[Z]){te=ue[Z]>de[Z]?1:-1;break}return te}function ee(ue,de,W,z){for(var Z=0;W--;)ue[W]-=Z,Z=ue[W]<de[W]?1:0,ue[W]=Z*z+ue[W]-de[W];for(;!ue[0]&&1<ue.length;ue.splice(0,1));}return function(ue,de,W,z,Z){var te,re,ce,Ce,ge,ye,Ee,Se,be,Re,Ae,Ne,Me,Ze,it,rt,It,wt=ue.s==de.s?1:-1,ct=ue.c,qe=de.c;if(!(ct&&ct[0]&&qe&&qe[0]))return new F(ue.s&&de.s&&(ct?!qe||ct[0]!=qe[0]:qe)?ct&&ct[0]==0||!qe?0*wt:wt/0:NaN);for(be=(Se=new F(wt)).c=[],wt=W+(re=ue.e-de.e)+1,Z||(Z=u,re=O(ue.e/g)-O(de.e/g),wt=wt/g|0),ce=0;qe[ce]==(ct[ce]||0);ce++);if(qe[ce]>(ct[ce]||0)&&re--,wt<0)be.push(1),Ce=!0;else{for(Ze=ct.length,rt=qe.length,wt+=2,1<(ge=a(Z/(qe[ce=0]+1)))&&(qe=G(qe,ge,Z),ct=G(ct,ge,Z),rt=qe.length,Ze=ct.length),Me=rt,Ae=(Re=ct.slice(0,rt)).length;Ae<rt;Re[Ae++]=0);It=qe.slice(),It=[0].concat(It),it=qe[0],qe[1]>=Z/2&&it++;do{if(ge=0,(te=se(qe,Re,rt,Ae))<0){if(Ne=Re[0],rt!=Ae&&(Ne=Ne*Z+(Re[1]||0)),1<(ge=a(Ne/it)))for(Z<=ge&&(ge=Z-1),Ee=(ye=G(qe,ge,Z)).length,Ae=Re.length;se(ye,Re,Ee,Ae)==1;)ge--,ee(ye,rt<Ee?It:qe,Ee,Z),Ee=ye.length,te=1;else ge==0&&(te=ge=1),Ee=(ye=qe.slice()).length;if(Ee<Ae&&(ye=[0].concat(ye)),ee(Re,ye,Ae,Z),Ae=Re.length,te==-1)for(;se(qe,Re,rt,Ae)<1;)ge++,ee(Re,rt<Ae?It:qe,Ae,Z),Ae=Re.length}else te===0&&(ge++,Re=[0]);be[ce++]=ge,Re[0]?Re[Ae++]=ct[Me]||0:(Re=[ct[Me]],Ae=1)}while((Me++<Ze||Re[0]!=null)&&wt--);Ce=Re[0]!=null,be[0]||be.splice(0,1)}if(Z==u){for(ce=1,wt=be[0];10<=wt;wt/=10,ce++);fe(Se,W+(Se.e=ce+re*g-1)+1,z,Ce)}else Se.e=re,Se.r=+Ce;return Se}}(),v=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,f=/^\.([^.]+)$/,w=/^-?(Infinity|NaN)$/,b=/^\s*\+(?=[\w.])|^\s+|\s+$/g,P=function(G,se,ee,ue){var de,W=ee?se:se.replace(b,"");if(w.test(W))G.s=isNaN(W)?null:W<0?-1:1,G.c=G.e=null;else{if(!ee&&(W=W.replace(v,function(z,Z,te){return de=(te=te.toLowerCase())=="x"?16:te=="b"?2:8,ue&&ue!=de?z:Z}),ue&&(de=ue,W=W.replace(R,"$1").replace(f,"0.$1")),se!=W))return new F(W,de);if(F.DEBUG)throw Error(l+"Not a"+(ue?" base "+ue:"")+" number: "+se);G.c=G.e=G.s=null}},h.absoluteValue=h.abs=function(){var G=new F(this);return G.s<0&&(G.s=1),G},h.comparedTo=function(G,se){return _(this,new F(G,se))},h.decimalPlaces=h.dp=function(G,se){var ee,ue,de;if(G!=null)return N(G,0,S),se==null?se=I:N(se,0,8),fe(new F(this),G+this.e+1,se);if(!(ee=this.c))return null;if(ue=((de=ee.length-1)-O(this.e/g))*g,de=ee[de])for(;de%10==0;de/=10,ue--);return ue<0&&(ue=0),ue},h.dividedBy=h.div=function(G,se){return Q(this,new F(G,se),x,I)},h.dividedToIntegerBy=h.idiv=function(G,se){return Q(this,new F(G,se),0,1)},h.exponentiatedBy=h.pow=function(G,se){var ee,ue,de,W,z,Z,te,re,ce=this;if((G=new F(G)).c&&!G.isInteger())throw Error(l+"Exponent not an integer: "+me(G));if(se!=null&&(se=new F(se)),z=14<G.e,!ce.c||!ce.c[0]||ce.c[0]==1&&!ce.e&&ce.c.length==1||!G.c||!G.c[0])return re=new F(Math.pow(+me(ce),z?2-E(G):+me(G))),se?re.mod(se):re;if(Z=G.s<0,se){if(se.c?!se.c[0]:!se.s)return new F(NaN);(ue=!Z&&ce.isInteger()&&se.isInteger())&&(ce=ce.mod(se))}else{if(9<G.e&&(0<ce.e||ce.e<-1||(ce.e==0?1<ce.c[0]||z&&24e7<=ce.c[1]:ce.c[0]<8e13||z&&ce.c[0]<=9999975e7)))return W=ce.s<0&&E(G)?-0:0,-1<ce.e&&(W=1/W),new F(Z?1/W:W);q&&(W=n(q/g+2))}for(te=z?(ee=new F(.5),Z&&(G.s=1),E(G)):(de=Math.abs(+me(G)))%2,re=new F(m);;){if(te){if(!(re=re.times(ce)).c)break;W?re.c.length>W&&(re.c.length=W):ue&&(re=re.mod(se))}if(de){if((de=a(de/2))===0)break;te=de%2}else if(fe(G=G.times(ee),G.e+1,1),14<G.e)te=E(G);else{if((de=+me(G))==0)break;te=de%2}ce=ce.times(ce),W?ce.c&&ce.c.length>W&&(ce.c.length=W):ue&&(ce=ce.mod(se))}return ue?re:(Z&&(re=m.div(re)),se?re.mod(se):W?fe(re,q,I,void 0):re)},h.integerValue=function(G){var se=new F(this);return G==null?G=I:N(G,0,8),fe(se,se.e+1,G)},h.isEqualTo=h.eq=function(G,se){return _(this,new F(G,se))===0},h.isFinite=function(){return!!this.c},h.isGreaterThan=h.gt=function(G,se){return 0<_(this,new F(G,se))},h.isGreaterThanOrEqualTo=h.gte=function(G,se){return(se=_(this,new F(G,se)))===1||se===0},h.isInteger=function(){return!!this.c&&O(this.e/g)>this.c.length-2},h.isLessThan=h.lt=function(G,se){return _(this,new F(G,se))<0},h.isLessThanOrEqualTo=h.lte=function(G,se){return(se=_(this,new F(G,se)))===-1||se===0},h.isNaN=function(){return!this.s},h.isNegative=function(){return this.s<0},h.isPositive=function(){return 0<this.s},h.isZero=function(){return!!this.c&&this.c[0]==0},h.minus=function(G,se){var ee,ue,de,W,z=this,Z=z.s;if(se=(G=new F(G,se)).s,!Z||!se)return new F(NaN);if(Z!=se)return G.s=-se,z.plus(G);var te=z.e/g,re=G.e/g,ce=z.c,Ce=G.c;if(!te||!re){if(!ce||!Ce)return ce?(G.s=-se,G):new F(Ce?z:NaN);if(!ce[0]||!Ce[0])return Ce[0]?(G.s=-se,G):new F(ce[0]?z:I==3?-0:0)}if(te=O(te),re=O(re),ce=ce.slice(),Z=te-re){for((de=(W=Z<0)?(Z=-Z,ce):(re=te,Ce)).reverse(),se=Z;se--;de.push(0));de.reverse()}else for(ue=(W=(Z=ce.length)<(se=Ce.length))?Z:se,Z=se=0;se<ue;se++)if(ce[se]!=Ce[se]){W=ce[se]<Ce[se];break}if(W&&(de=ce,ce=Ce,Ce=de,G.s=-G.s),0<(se=(ue=Ce.length)-(ee=ce.length)))for(;se--;ce[ee++]=0);for(se=u-1;Z<ue;){if(ce[--ue]<Ce[ue]){for(ee=ue;ee&&!ce[--ee];ce[ee]=se);--ce[ee],ce[ue]+=u}ce[ue]-=Ce[ue]}for(;ce[0]==0;ce.splice(0,1),--re);return ce[0]?ae(G,ce,re):(G.s=I==3?-1:1,G.c=[G.e=0],G)},h.modulo=h.mod=function(G,se){var ee,ue,de=this;return G=new F(G,se),!de.c||!G.s||G.c&&!G.c[0]?new F(NaN):!G.c||de.c&&!de.c[0]?new F(de):(X==9?(ue=G.s,G.s=1,ee=Q(de,G,0,3),G.s=ue,ee.s*=ue):ee=Q(de,G,0,X),(G=de.minus(ee.times(G))).c[0]||X!=1||(G.s=de.s),G)},h.multipliedBy=h.times=function(G,se){var ee,ue,de,W,z,Z,te,re,ce,Ce,ge,ye,Ee,Se,be,Re=this,Ae=Re.c,Ne=(G=new F(G,se)).c;if(!(Ae&&Ne&&Ae[0]&&Ne[0]))return!Re.s||!G.s||Ae&&!Ae[0]&&!Ne||Ne&&!Ne[0]&&!Ae?G.c=G.e=G.s=null:(G.s*=Re.s,Ae&&Ne?(G.c=[0],G.e=0):G.c=G.e=null),G;for(ue=O(Re.e/g)+O(G.e/g),G.s*=Re.s,(te=Ae.length)<(Ce=Ne.length)&&(Ee=Ae,Ae=Ne,Ne=Ee,de=te,te=Ce,Ce=de),de=te+Ce,Ee=[];de--;Ee.push(0));for(Se=u,be=y,de=Ce;0<=--de;){for(ee=0,ge=Ne[de]%be,ye=Ne[de]/be|0,W=de+(z=te);de<W;)ee=((re=ge*(re=Ae[--z]%be)+(Z=ye*re+(ce=Ae[z]/be|0)*ge)%be*be+Ee[W]+ee)/Se|0)+(Z/be|0)+ye*ce,Ee[W--]=re%Se;Ee[W]=ee}return ee?++ue:Ee.splice(0,1),ae(G,Ee,ue)},h.negated=function(){var G=new F(this);return G.s=-G.s||null,G},h.plus=function(G,se){var ee,ue=this,de=ue.s;if(se=(G=new F(G,se)).s,!de||!se)return new F(NaN);if(de!=se)return G.s=-se,ue.minus(G);var W=ue.e/g,z=G.e/g,Z=ue.c,te=G.c;if(!W||!z){if(!Z||!te)return new F(de/0);if(!Z[0]||!te[0])return te[0]?G:new F(Z[0]?ue:0*de)}if(W=O(W),z=O(z),Z=Z.slice(),de=W-z){for((ee=0<de?(z=W,te):(de=-de,Z)).reverse();de--;ee.push(0));ee.reverse()}for((de=Z.length)-(se=te.length)<0&&(ee=te,te=Z,Z=ee,se=de),de=0;se;)de=(Z[--se]=Z[se]+te[se]+de)/u|0,Z[se]=u===Z[se]?0:Z[se]%u;return de&&(Z=[de].concat(Z),++z),ae(G,Z,z)},h.precision=h.sd=function(G,se){var ee,ue,de;if(G!=null&&G!==!!G)return N(G,1,S),se==null?se=I:N(se,0,8),fe(new F(this),G,se);if(!(ee=this.c))return null;if(ue=(de=ee.length-1)*g+1,de=ee[de]){for(;de%10==0;de/=10,ue--);for(de=ee[0];10<=de;de/=10,ue++);}return G&&this.e+1>ue&&(ue=this.e+1),ue},h.shiftedBy=function(G){return N(G,-p,p),this.times("1e"+G)},h.squareRoot=h.sqrt=function(){var G,se,ee,ue,de,W=this,z=W.c,Z=W.s,te=W.e,re=x+4,ce=new F("0.5");if(Z!==1||!z||!z[0])return new F(!Z||Z<0&&(!z||z[0])?NaN:z?W:1/0);if((ee=(Z=Math.sqrt(+me(W)))==0||Z==1/0?(((se=M(z)).length+te)%2==0&&(se+="0"),Z=Math.sqrt(+se),te=O((te+1)/2)-(te<0||te%2),new F(se=Z==1/0?"1e"+te:(se=Z.toExponential()).slice(0,se.indexOf("e")+1)+te)):new F(Z+"")).c[0]){for((Z=(te=ee.e)+re)<3&&(Z=0);;)if(de=ee,ee=ce.times(de.plus(Q(W,de,re,1))),M(de.c).slice(0,Z)===(se=M(ee.c)).slice(0,Z)){if(ee.e<te&&--Z,(se=se.slice(Z-3,Z+1))!="9999"&&(ue||se!="4999")){+se&&(+se.slice(1)||se.charAt(0)!="5")||(fe(ee,ee.e+x+2,1),G=!ee.times(ee).eq(W));break}if(!ue&&(fe(de,de.e+x+2,0),de.times(de).eq(W))){ee=de;break}re+=4,Z+=4,ue=1}}return fe(ee,ee.e+x+1,I,G)},h.toExponential=function(G,se){return G!=null&&(N(G,0,S),G++),oe(this,G,se,1)},h.toFixed=function(G,se){return G!=null&&(N(G,0,S),G=G+this.e+1),oe(this,G,se)},h.toFormat=function(G,se,ee){var ue;if(ee==null)G!=null&&se&&typeof se=="object"?(ee=se,se=null):G&&typeof G=="object"?(ee=G,G=se=null):ee=le;else if(typeof ee!="object")throw Error(l+"Argument not an object: "+ee);if(ue=this.toFixed(G,se),this.c){var de,W=ue.split("."),z=+ee.groupSize,Z=+ee.secondaryGroupSize,te=ee.groupSeparator||"",re=W[0],ce=W[1],Ce=this.s<0,ge=Ce?re.slice(1):re,ye=ge.length;if(Z&&(de=z,z=Z,ye-=Z=de),0<z&&0<ye){for(de=ye%z||z,re=ge.substr(0,de);de<ye;de+=z)re+=te+ge.substr(de,z);0<Z&&(re+=te+ge.slice(de)),Ce&&(re="-"+re)}ue=ce?re+(ee.decimalSeparator||"")+((Z=+ee.fractionGroupSize)?ce.replace(new RegExp("\\d{"+Z+"}\\B","g"),"$&"+(ee.fractionGroupSeparator||"")):ce):re}return(ee.prefix||"")+ue+(ee.suffix||"")},h.toFraction=function(G){var se,ee,ue,de,W,z,Z,te,re,ce,Ce,ge,ye=this,Ee=ye.c;if(G!=null&&(!(Z=new F(G)).isInteger()&&(Z.c||Z.s!==1)||Z.lt(m)))throw Error(l+"Argument "+(Z.isInteger()?"out of range: ":"not an integer: ")+me(Z));if(!Ee)return new F(ye);for(se=new F(m),re=ee=new F(m),ue=te=new F(m),ge=M(Ee),W=se.e=ge.length-ye.e-1,se.c[0]=C[(z=W%g)<0?g+z:z],G=!G||0<Z.comparedTo(se)?0<W?se:re:Z,z=K,K=1/0,Z=new F(ge),te.c[0]=0;ce=Q(Z,se,0,1),(de=ee.plus(ce.times(ue))).comparedTo(G)!=1;)ee=ue,ue=de,re=te.plus(ce.times(de=re)),te=de,se=Z.minus(ce.times(de=se)),Z=de;return de=Q(G.minus(ee),ue,0,1),te=te.plus(de.times(re)),ee=ee.plus(de.times(ue)),te.s=re.s=ye.s,Ce=Q(re,ue,W*=2,I).minus(ye).abs().comparedTo(Q(te,ee,W,I).minus(ye).abs())<1?[re,ue]:[te,ee],K=z,Ce},h.toNumber=function(){return+me(this)},h.toPrecision=function(G,se){return G!=null&&N(G,1,S),oe(this,G,se,2)},h.toString=function(G){var se,ee=this,ue=ee.s,de=ee.e;return de===null?ue?(se="Infinity",ue<0&&(se="-"+se)):se="NaN":(se=G==null?de<=B||V<=de?k(M(ee.c),de):ie(M(ee.c),de,"0"):G===10?ie(M((ee=fe(new F(ee),x+de+1,I)).c),ee.e,"0"):(N(G,2,D.length,"Base"),Y(ie(M(ee.c),de,"0"),10,G,ue,!0)),ue<0&&ee.c[0]&&(se="-"+se)),se},h.valueOf=h.toJSON=function(){return me(this)},h._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(h[Symbol.toStringTag]="BigNumber",h[Symbol.for("nodejs.util.inspect.custom")]=h.valueOf),H!=null&&F.set(H),F}()).default=s.BigNumber=s,e!==void 0&&e.exports?e.exports=s:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=s)})(this)},{}],2:[function(o,e,t){"use strict";e.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var s=i%10;return~~(i%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(o,e,t){"use strict";function i(O,M){return function(_){if(Array.isArray(_))return _}(O)||function(_,N){var E=[],k=!0,ie=!1,$=void 0;try{for(var H,Q=_[Symbol.iterator]();!(k=(H=Q.next()).done)&&(E.push(H.value),!N||E.length!==N);k=!0);}catch(Y){ie=!0,$=Y}finally{try{k||Q.return==null||Q.return()}finally{if(ie)throw $}}return E}(O,M)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=o("./globalState"),r=o("./validating"),n=o("./parsing"),a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],l={general:{scale:1024,suffixes:a,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:a,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function u(O){var M=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},_=2<arguments.length?arguments[2]:void 0;if(typeof M=="string"&&(M=n.parseFormat(M)),!r.validateFormat(M))return"ERROR: invalid format";var N=M.prefix||"",E=M.postfix||"",k=function(ie,$,H){switch($.output){case"currency":return $=S($,s.currentCurrencyDefaultFormat()),function(D,F,oe){var ne=oe.currentCurrency(),ae=Object.assign({},c,F),fe=void 0,me="",G=!!ae.totalLength||!!ae.forceAverage||ae.average,se=F.currencyPosition||ne.position,ee=F.currencySymbol||ne.symbol;ae.spaceSeparated&&(me=" "),se==="infix"&&(fe=me+ee+me);var ue=y({instance:D,providedFormat:F,state:oe,decimalSeparator:fe});return se==="prefix"&&(ue=D._value<0&&ae.negative==="sign"?"-".concat(me).concat(ee).concat(ue.slice(1)):ee+me+ue),se&&se!=="postfix"||(ue=ue+(me=G?"":me)+ee),ue}(ie,$,s);case"percent":return $=S($,s.currentPercentageDefaultFormat()),function(D,F,oe,ne){var ae=F.prefixSymbol,fe=y({instance:ne(100*D._value),providedFormat:F,state:oe}),me=Object.assign({},c,F);return ae?"%".concat(me.spaceSeparated?" ":"").concat(fe):"".concat(fe).concat(me.spaceSeparated?" ":"","%")}(ie,$,s,H);case"byte":return $=S($,s.currentByteDefaultFormat()),m=ie,I=s,B=H,V=(x=$).base||"binary",U=l[V],K=g(m._value,U.suffixes,U.scale),L=K.value,X=K.suffix,q=y({instance:B(L),providedFormat:x,state:I,defaults:I.currentByteDefaultFormat()}),le=I.currentAbbreviations(),"".concat(q).concat(le.spaced?" ":"").concat(X);case"time":return $=S($,s.currentTimeDefaultFormat()),f=ie,w=Math.floor(f._value/60/60),b=Math.floor((f._value-60*w*60)/60),h=Math.round(f._value-60*w*60-60*b),"".concat(w,":").concat(b<10?"0":"").concat(b,":").concat(h<10?"0":"").concat(h);case"ordinal":return $=S($,s.currentOrdinalDefaultFormat()),Q=ie,Y=$,j=(P=s).currentOrdinal(),A=Object.assign({},c,Y),v=y({instance:Q,providedFormat:Y,state:P}),R=j(Q._value),"".concat(v).concat(A.spaceSeparated?" ":"").concat(R);case"number":default:return y({instance:ie,providedFormat:$,numbro:H})}var Q,Y,P,j,A,v,R,f,w,b,h,m,x,I,B,V,U,K,L,X,q,le}(O,M,_);return k=(k=N+k)+E}function g(O,M,_){var N=M[0],E=Math.abs(O);if(_<=E){for(var k=1;k<M.length;++k){var ie=Math.pow(_,k),$=Math.pow(_,k+1);if(ie<=E&&E<$){N=M[k],O/=ie;break}}N===M[0]&&(O/=Math.pow(_,M.length-1),N=M[M.length-1])}return{value:O,suffix:N}}function p(O){for(var M="",_=0;_<O;_++)M+="0";return M}function C(O,M){return O.toString().indexOf("e")!==-1?function(_,N){var E=_.toString(),k=i(E.split("e"),2),ie=k[0],$=k[1],H=i(ie.split("."),2),Q=H[0],Y=H[1],P=Y===void 0?"":Y;if(0<+$)E=Q+P+p($-P.length);else{var j=".";j=+Q<0?"-0".concat(j):"0".concat(j);var A=(p(-$-1)+Math.abs(Q)+P).substr(0,N);A.length<N&&(A+=p(N-A.length)),E=j+A}return 0<+$&&0<N&&(E+=".".concat(p(N))),E}(O,M):(Math.round(+"".concat(O,"e+").concat(M))/Math.pow(10,M)).toFixed(M)}function y(O){var M=O.instance,_=O.providedFormat,N=O.state,E=N===void 0?s:N,k=O.decimalSeparator,ie=O.defaults,$=ie===void 0?E.currentDefaults():ie,H=M._value;if(H===0&&E.hasZeroFormat())return E.getZeroFormat();if(!isFinite(H))return H.toString();var Q,Y,P,j,A,v,R,f,w=Object.assign({},c,$,_),b=w.totalLength,h=b?0:w.characteristic,m=w.optionalCharacteristic,x=w.forceAverage,I=!!b||!!x||w.average,B=b?-1:I&&_.mantissa===void 0?0:w.mantissa,V=!b&&(_.optionalMantissa===void 0?B===-1:w.optionalMantissa),U=w.trimMantissa,K=w.thousandSeparated,L=w.spaceSeparated,X=w.negative,q=w.forceSign,le=w.exponential,D="";if(I){var F=function(G){var se=G.value,ee=G.forceAverage,ue=G.abbreviations,de=G.spaceSeparated,W=de!==void 0&&de,z=G.totalLength,Z=z===void 0?0:z,te="",re=Math.abs(se),ce=-1;if(re>=Math.pow(10,12)&&!ee||ee==="trillion"?(te=ue.trillion,se/=Math.pow(10,12)):re<Math.pow(10,12)&&re>=Math.pow(10,9)&&!ee||ee==="billion"?(te=ue.billion,se/=Math.pow(10,9)):re<Math.pow(10,9)&&re>=Math.pow(10,6)&&!ee||ee==="million"?(te=ue.million,se/=Math.pow(10,6)):(re<Math.pow(10,6)&&re>=Math.pow(10,3)&&!ee||ee==="thousand")&&(te=ue.thousand,se/=Math.pow(10,3)),te&&(te=(W?" ":"")+te),Z){var Ce=se.toString().split(".")[0];ce=Math.max(Z-Ce.length,0)}return{value:se,abbreviation:te,mantissaPrecision:ce}}({value:H,forceAverage:x,abbreviations:E.currentAbbreviations(),spaceSeparated:L,totalLength:b});H=F.value,D+=F.abbreviation,b&&(B=F.mantissaPrecision)}if(le){var oe=(Y=(Q={value:H,characteristicPrecision:h}).value,P=Q.characteristicPrecision,j=P===void 0?0:P,A=i(Y.toExponential().split("e"),2),v=A[0],R=A[1],f=+v,j&&1<j&&(f*=Math.pow(10,j-1),R=0<=(R=+R-(j-1))?"+".concat(R):R),{value:f,abbreviation:"e".concat(R)});H=oe.value,D=oe.abbreviation+D}var ne,ae,fe,me=function(G,se,ee,ue,de){if(ue===-1)return G;var W=C(se,ue),z=i(W.toString().split("."),2),Z=z[0],te=z[1],re=te===void 0?"":te;if(re.match(/^0+$/)&&(ee||de))return Z;var ce=re.match(/0+$/);return de&&ce?"".concat(Z,".").concat(re.toString().slice(0,ce.index)):W.toString()}(H.toString(),H,V,B,U);return me=function(G,se,ee,ue,de){var W=ue.currentDelimiters(),z=W.thousands;de=de||W.decimal;var Z=W.thousandsSize||3,te=G.toString(),re=te.split(".")[0],ce=te.split(".")[1];return ee&&(se<0&&(re=re.slice(1)),function(Ce,ge){for(var ye=[],Ee=0,Se=Ce;0<Se;Se--)Ee===ge&&(ye.unshift(Se),Ee=0),Ee++;return ye}(re.length,Z).forEach(function(Ce,ge){re=re.slice(0,Ce+ge)+z+re.slice(Ce+ge)}),se<0&&(re="-".concat(re))),te=ce?re+de+ce:re}(me=function(G,se,ee,ue){var de=G,W=i(de.toString().split("."),2),z=W[0],Z=W[1];if(z.match(/^-?0$/)&&ee)return Z?"".concat(z.replace("0",""),".").concat(Z):z.replace("0","");if(z.length<ue)for(var te=ue-z.length,re=0;re<te;re++)de="0".concat(de);return de.toString()}(me,0,m,h),H,K,E,k),(I||le)&&(me=me+D),(q||H<0)&&(ne=me,fe=X,me=(ae=H)===0?ne:+ne==0?ne.replace("-",""):0<ae?"+".concat(ne):fe==="sign"?ne:"(".concat(ne.replace("-",""),")")),me}function S(O,M){if(!O)return M;var _=Object.keys(O);return _.length===1&&_[0]==="output"?M:O}e.exports=function(O){return{format:function(){for(var M=arguments.length,_=new Array(M),N=0;N<M;N++)_[N]=arguments[N];return u.apply(void 0,_.concat([O]))},getByteUnit:function(){for(var M=arguments.length,_=new Array(M),N=0;N<M;N++)_[N]=arguments[N];return function(E){var k=l.general;return g(E._value,k.suffixes,k.scale).suffix}.apply(void 0,_.concat([O]))},getBinaryByteUnit:function(){for(var M=arguments.length,_=new Array(M),N=0;N<M;N++)_[N]=arguments[N];return function(E){var k=l.binary;return g(E._value,k.suffixes,k.scale).suffix}.apply(void 0,_.concat([O]))},getDecimalByteUnit:function(){for(var M=arguments.length,_=new Array(M),N=0;N<M;N++)_[N]=arguments[N];return function(E){var k=l.decimal;return g(E._value,k.suffixes,k.scale).suffix}.apply(void 0,_.concat([O]))},formatOrDefault:S}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(o,e,t){"use strict";var i=o("./en-US"),s=o("./validating"),r=o("./parsing"),n={},a=void 0,l={},c=null,u={};function g(C){a=C}function p(){return l[a]}n.languages=function(){return Object.assign({},l)},n.currentLanguage=function(){return a},n.currentCurrency=function(){return p().currency},n.currentAbbreviations=function(){return p().abbreviations},n.currentDelimiters=function(){return p().delimiters},n.currentOrdinal=function(){return p().ordinal},n.currentDefaults=function(){return Object.assign({},p().defaults,u)},n.currentOrdinalDefaultFormat=function(){return Object.assign({},n.currentDefaults(),p().ordinalFormat)},n.currentByteDefaultFormat=function(){return Object.assign({},n.currentDefaults(),p().byteFormat)},n.currentPercentageDefaultFormat=function(){return Object.assign({},n.currentDefaults(),p().percentageFormat)},n.currentCurrencyDefaultFormat=function(){return Object.assign({},n.currentDefaults(),p().currencyFormat)},n.currentTimeDefaultFormat=function(){return Object.assign({},n.currentDefaults(),p().timeFormat)},n.setDefaults=function(C){C=r.parseFormat(C),s.validateFormat(C)&&(u=C)},n.getZeroFormat=function(){return c},n.setZeroFormat=function(C){return c=typeof C=="string"?C:null},n.hasZeroFormat=function(){return c!==null},n.languageData=function(C){if(C){if(l[C])return l[C];throw new Error('Unknown tag "'.concat(C,'"'))}return p()},n.registerLanguage=function(C){var y=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(C))throw new Error("Invalid language data");l[C.languageTag]=C,y&&g(C.languageTag)},n.setLanguage=function(C){var y=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!l[C]){var S=C.split("-")[0],O=Object.keys(l).find(function(M){return M.split("-")[0]===S});return l[O]?void g(O):void g(y)}g(C)},n.registerLanguage(i),a=i.languageTag,e.exports=n},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(o,e,t){"use strict";e.exports=function(i){return{loadLanguagesInNode:function(s){return r=i,void s.forEach(function(n){var a=void 0;try{a=o("../languages/".concat(n))}catch{console.error('Unable to load "'.concat(n,'". No matching language file found.'))}a&&r.registerLanguage(a)});var r}}}},{}],6:[function(o,e,t){"use strict";var i=o("bignumber.js");function s(r,n,a){var l=new i(r._value),c=n;return a.isNumbro(n)&&(c=n._value),c=new i(c),r._value=l.minus(c).toNumber(),r}e.exports=function(r){return{add:function(n,a){return c=a,u=r,g=new i((l=n)._value),p=c,u.isNumbro(c)&&(p=c._value),p=new i(p),l._value=g.plus(p).toNumber(),l;var l,c,u,g,p},subtract:function(n,a){return s(n,a,r)},multiply:function(n,a){return c=a,u=r,g=new i((l=n)._value),p=c,u.isNumbro(c)&&(p=c._value),p=new i(p),l._value=g.times(p).toNumber(),l;var l,c,u,g,p},divide:function(n,a){return c=a,u=r,g=new i((l=n)._value),p=c,u.isNumbro(c)&&(p=c._value),p=new i(p),l._value=g.dividedBy(p).toNumber(),l;var l,c,u,g,p},set:function(n,a){return l=n,u=c=a,r.isNumbro(c)&&(u=c._value),l._value=u,l;var l,c,u},difference:function(n,a){return l=a,s(u=(c=r)(n._value),l,c),Math.abs(u._value);var l,c,u}}}},{"bignumber.js":1}],7:[function(o,e,t){"use strict";function i(y,S){for(var O=0;O<S.length;O++){var M=S[O];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(y,M.key,M)}}var s=o("./globalState"),r=o("./validating"),n=o("./loading")(C),a=o("./unformatting"),l=o("./formatting")(C),c=o("./manipulating")(C),u=o("./parsing"),g=function(){function y(_){(function(N,E){if(!(N instanceof E))throw new TypeError("Cannot call a class as a function")})(this,y),this._value=_}var S,O,M;return S=y,(O=[{key:"clone",value:function(){return C(this._value)}},{key:"format",value:function(){var _=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return l.format(this,_)}},{key:"formatCurrency",value:function(_){return typeof _=="string"&&(_=u.parseFormat(_)),(_=l.formatOrDefault(_,s.currentCurrencyDefaultFormat())).output="currency",l.format(this,_)}},{key:"formatTime",value:function(){var _=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return _.output="time",l.format(this,_)}},{key:"binaryByteUnits",value:function(){return l.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return l.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return l.getByteUnit(this)}},{key:"difference",value:function(_){return c.difference(this,_)}},{key:"add",value:function(_){return c.add(this,_)}},{key:"subtract",value:function(_){return c.subtract(this,_)}},{key:"multiply",value:function(_){return c.multiply(this,_)}},{key:"divide",value:function(_){return c.divide(this,_)}},{key:"set",value:function(_){return c.set(this,p(_))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(S.prototype,O),M&&i(S,M),y}();function p(y){var S=y;return C.isNumbro(y)?S=y._value:typeof y=="string"?S=C.unformat(y):isNaN(y)&&(S=NaN),S}function C(y){return new g(p(y))}C.version="2.1.2",C.isNumbro=function(y){return y instanceof g},C.language=s.currentLanguage,C.registerLanguage=s.registerLanguage,C.setLanguage=s.setLanguage,C.languages=s.languages,C.languageData=s.languageData,C.zeroFormat=s.setZeroFormat,C.defaultFormat=s.currentDefaults,C.setDefaults=s.setDefaults,C.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,C.validate=r.validate,C.loadLanguagesInNode=n.loadLanguagesInNode,C.unformat=a.unformat,e.exports=C},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(o,e,t){"use strict";e.exports={parseFormat:function(i){var s,r,n,a,l,c,u,g,p,C,y,S,O,M,_,N,E,k,ie,$,H=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(r=H,i=(n=(s=i).match(/^{([^}]*)}/))?(r.prefix=n[1],s.slice(n[0].length)):s,l=H,function(Q,Y){if(Q.indexOf("$")===-1){if(Q.indexOf("%")===-1)return Q.indexOf("bd")!==-1?(Y.output="byte",Y.base="general"):Q.indexOf("b")!==-1?(Y.output="byte",Y.base="binary"):Q.indexOf("d")!==-1?(Y.output="byte",Y.base="decimal"):Q.indexOf(":")===-1?Q.indexOf("o")!==-1&&(Y.output="ordinal"):Y.output="time";Y.output="percent"}else Y.output="currency"}(i=(c=(a=i).match(/{([^}]*)}$/))?(l.postfix=c[1],a.slice(0,-c[0].length)):a,H),u=H,(g=i.match(/[1-9]+[0-9]*/))&&(u.totalLength=+g[0]),p=H,(C=i.split(".")[0].match(/0+/))&&(p.characteristic=C[0].length),function(Q,Y){if(Q.indexOf(".")!==-1){var P=Q.split(".")[0];Y.optionalCharacteristic=P.indexOf("0")===-1}}(i,H),y=H,i.indexOf("a")!==-1&&(y.average=!0),O=H,(S=i).indexOf("K")!==-1?O.forceAverage="thousand":S.indexOf("M")!==-1?O.forceAverage="million":S.indexOf("B")!==-1?O.forceAverage="billion":S.indexOf("T")!==-1&&(O.forceAverage="trillion"),function(Q,Y){var P=Q.split(".")[1];if(P){var j=P.match(/0+/);j&&(Y.mantissa=j[0].length)}}(i,H),_=H,(M=i).match(/\[\.]/)?_.optionalMantissa=!0:M.match(/\./)&&(_.optionalMantissa=!1),N=H,i.indexOf(",")!==-1&&(N.thousandSeparated=!0),E=H,i.indexOf(" ")!==-1&&(E.spaceSeparated=!0),ie=H,(k=i).match(/^\+?\([^)]*\)$/)&&(ie.negative="parenthesis"),k.match(/^\+?-/)&&(ie.negative="sign"),$=H,i.match(/^\+/)&&($.forceSign=!0),H)}}},{}],9:[function(o,e,t){"use strict";var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(n){return n.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function r(n,a){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,u=4<arguments.length?arguments[4]:void 0,g=5<arguments.length?arguments[5]:void 0,p=6<arguments.length?arguments[6]:void 0;if(n!=="")return n===u?0:function C(y,S){var O=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",M=3<arguments.length?arguments[3]:void 0,_=4<arguments.length?arguments[4]:void 0,N=5<arguments.length?arguments[5]:void 0,E=6<arguments.length?arguments[6]:void 0;if(!isNaN(+y))return+y;var k="",ie=y.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(ie!==y)return-1*C(ie,S,O,M,_,N,E);for(var $=0;$<i.length;$++){var H=i[$];if((k=y.replace(H.key,""))!==y)return C(k,S,O,M,_,N,E)*H.factor}if((k=y.replace("%",""))!==y)return C(k,S,O,M,_,N,E)/100;var Q=parseFloat(y);if(!isNaN(Q)){var Y=M(Q);if(Y&&Y!=="."&&(k=y.replace(new RegExp("".concat(s(Y),"$")),""))!==y)return C(k,S,O,M,_,N,E);var P={};Object.keys(N).forEach(function(b){P[N[b]]=b});for(var j=Object.keys(P).sort().reverse(),A=j.length,v=0;v<A;v++){var R=j[v],f=P[R];if((k=y.replace(R,""))!==y){var w=void 0;switch(f){case"thousand":w=Math.pow(10,3);break;case"million":w=Math.pow(10,6);break;case"billion":w=Math.pow(10,9);break;case"trillion":w=Math.pow(10,12)}return C(k,S,O,M,_,N,E)*w}}}}(function(C,y){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",O=C.replace(S,"");return O=(O=O.replace(new RegExp("([0-9])".concat(s(y.thousands),"([0-9])"),"g"),"$1$2")).replace(y.decimal,".")}(n,a,l),a,l,c,u,g,p)}e.exports={unformat:function(n,a){var l,c,u,g=o("./globalState"),p=g.currentDelimiters(),C=g.currentCurrency().symbol,y=g.currentOrdinal(),S=g.getZeroFormat(),O=g.currentAbbreviations(),M=void 0;if(typeof n=="string")M=function(_,N){if(!_.indexOf(":")||N.thousands===":")return!1;var E=_.split(":");if(E.length!==3)return!1;var k=+E[0],ie=+E[1],$=+E[2];return!isNaN(k)&&!isNaN(ie)&&!isNaN($)}(n,p)?(l=n.split(":"),c=+l[0],u=+l[1],+l[2]+60*u+3600*c):r(n,p,C,y,S,O,a);else{if(typeof n!="number")return;M=n}if(M!==void 0)return M}}},{"./globalState":4}],10:[function(o,e,t){"use strict";function i(p){return function(C){if(Array.isArray(C)){for(var y=0,S=new Array(C.length);y<C.length;y++)S[y]=C[y];return S}}(p)||function(C){if(Symbol.iterator in Object(C)||Object.prototype.toString.call(C)==="[object Arguments]")return Array.from(C)}(p)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(p){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C})(p)}var r=o("./unformatting"),n=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,a={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(p,C){return C.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(p){return p.output==="byte"}},characteristic:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(p){return 0<=p},message:"value must be positive"},{restriction:function(p,C){return!C.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(p,C){return C.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},l={languageTag:{type:"string",mandatory:!0,restriction:function(p){return p.match(n)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(p){return!!r.unformat(p)}function u(p,C,y){var S=3<arguments.length&&arguments[3]!==void 0&&arguments[3],O=Object.keys(p).map(function(M){if(!C[M])return console.error("".concat(y," Invalid key: ").concat(M)),!1;var _=p[M],N=C[M];if(typeof N=="string"&&(N={type:N}),N.type==="format"){if(!u(_,a,"[Validate ".concat(M,"]"),!0))return!1}else if(s(_)!==N.type)return console.error("".concat(y," ").concat(M,' type mismatched: "').concat(N.type,'" expected, "').concat(s(_),'" provided')),!1;if(N.restrictions&&N.restrictions.length)for(var E=N.restrictions.length,k=0;k<E;k++){var ie=N.restrictions[k],$=ie.restriction,H=ie.message;if(!$(_,p))return console.error("".concat(y," ").concat(M," invalid value: ").concat(H)),!1}return N.restriction&&!N.restriction(_,p)?(console.error("".concat(y," ").concat(M," invalid value: ").concat(N.message)),!1):N.validValues&&N.validValues.indexOf(_)===-1?(console.error("".concat(y," ").concat(M," invalid value: must be among ").concat(JSON.stringify(N.validValues),', "').concat(_,'" provided')),!1):!(N.children&&!u(_,N.children,"[Validate ".concat(M,"]")))});return S||O.push.apply(O,i(Object.keys(C).map(function(M){var _=C[M];if(typeof _=="string"&&(_={type:_}),_.mandatory){var N=_.mandatory;if(typeof N=="function"&&(N=N(p)),N&&p[M]===void 0)return console.error("".concat(y,' Missing mandatory key "').concat(M,'"')),!1}return!0}))),O.reduce(function(M,_){return M&&_},!0)}function g(p){return u(p,a,"[Validate format]")}e.exports={validate:function(p,C){var y=c(p),S=g(C);return y&&S},validateFormat:g,validateInput:c,validateLanguage:function(p){return u(p,l,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})});var OI=Ie((Ane,MI)=>{"use strict";var RI=Vg(),dj=TypeError;MI.exports=function(o,e){if(!delete o[e])throw dj("Cannot delete property "+RI(e)+" of "+RI(o))}});var z_=Ie((xxe,eg)=>{"use strict";(function(){"use strict";var o=function(){var e={},t={refPrefix:"`",refIntBase:96,refIntFloorCode:" ".charCodeAt(0),refIntCeilCode:void 0,maxStringDistance:void 0,minStringLength:5,maxStringLength:void 0,defaultWindow:144,maxWindow:void 0,windowLength:void 0},i=function(u){u=u||{},t=r(t,u),t.refIntCeilCode=t.refIntFloorCode+t.refIntBase-1,t.maxStringDistance=Math.pow(t.refIntBase,2)-1,t.maxStringLength=Math.pow(t.refIntBase,1)-1+t.minStringLength,t.maxWindow=t.maxStringDistance+t.minStringLength},s=function(u,g,p){var C={};if(u!==null){if(Array.prototype.forEach&&u.forEach===Array.prototype.forEach)u.forEach(g,p);else if(u.length===+u.length){for(var y=0,S=u.length;y<S;y++)if(g.call(p,u[y],y,u)===C)return}else for(var O in u)if(u.hasOwnProperty(O)&&g.call(p,u[O],O,u)===C)return}},r=function(u){return s(Array.prototype.slice.call(arguments,1),function(g){if(g)for(var p in g)u[p]=g[p]}),u},n=function(u,g){if(u>=0&&u<Math.pow(t.refIntBase,g)-1){for(var p="";u>0;)p=String.fromCharCode(u%t.refIntBase+t.refIntFloorCode)+p,u=Math.floor(u/t.refIntBase);for(var C=g-p.length,y=0;y<C;y++)p=String.fromCharCode(t.refIntFloorCode)+p;return p}else throw"Reference int out of range: "+u+" (width = "+g+")"},a=function(u){return n(u-t.minStringLength,1)},l=function(u,g){for(var p=0,C,y=0;y<g;y++)if(p*=t.refIntBase,C=u.charCodeAt(y),C>=t.refIntFloorCode&&C<=t.refIntCeilCode)p+=C-t.refIntFloorCode;else throw"Invalid char code in reference int: "+C;return p},c=function(u){return l(u,1)+t.minStringLength};return e.compress=function(u,g){if(Object.prototype.toString.call(u)!=="[object String]")throw"Input must be a string";i(g);var p=t.windowLength||t.defaultWindow;if(p>t.maxWindow)throw"Window length too large";for(var C="",y=0,S=u.length-t.minStringLength;y<S;){for(var O=Math.max(y-p,0),M=t.minStringLength,_=!1,N={distance:t.maxStringDistance,length:0},E=null,k,ie;O+M<y;)k=u.substr(O,M)===u.substr(y,M)&&M<t.maxStringLength,k?(M++,_=!0):(ie=M-1,_&&ie>N.length&&(N.distance=y-O-ie,N.length=ie),M=t.minStringLength,O++,_=!1);N.length?(E=t.refPrefix+n(N.distance,2)+a(N.length),y+=N.length):(u.charAt(y)!==t.refPrefix?E=u.charAt(y):E=t.refPrefix+t.refPrefix,y++),C+=E}return C+u.slice(y).replace(/`/g,"``")},e.decompress=function(u,g){if(Object.prototype.toString.call(u)!=="[object String]")throw"Input must be a string";var p="",C=0,y,S,O,M;for(i(g);C<u.length;)y=u.charAt(C),y!==t.refPrefix?(p+=y,C++):(S=u.charAt(C+1),S!==t.refPrefix?(O=l(u.substr(C+1,2),2),M=c(u.charAt(C+3)),p+=p.substr(p.length-O-M,M),C+=t.minStringLength-1):(p+=t.refPrefix,C+=2));return p},e}();typeof define<"u"&&define.amd?define([],function(){return o}):typeof eg<"u"&&eg.exports?eg.exports=o:window!==void 0&&(window.LZ77=o)})()});var X_=Ie(($_,tg)=>{"use strict";(function(o,e){typeof tg=="object"&&tg.exports?(e.default=e,tg.exports=o&&o.document?e(o):e):typeof define=="function"&&define.amd?define("highcharts/highcharts",function(){return e(o)}):(o.Highcharts&&o.Highcharts.error(16,!0),o.Highcharts=e(o))})(typeof window<"u"?window:$_,function(o){"use strict";var e={};function t(i,s,r,n){i.hasOwnProperty(s)||(i[s]=n.apply(null,r),typeof CustomEvent=="function"&&o.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:s,module:i[s]}})))}return t(e,"Core/Globals.js",[],function(){var i,s;return(s=i||(i={})).SVG_NS="http://www.w3.org/2000/svg",s.product="Highcharts",s.version="11.3.0",s.win=o!==void 0?o:{},s.doc=s.win.document,s.svg=s.doc&&s.doc.createElementNS&&!!s.doc.createElementNS(s.SVG_NS,"svg").createSVGRect,s.userAgent=s.win.navigator&&s.win.navigator.userAgent||"",s.isChrome=s.userAgent.indexOf("Chrome")!==-1,s.isFirefox=s.userAgent.indexOf("Firefox")!==-1,s.isMS=/(edge|msie|trident)/i.test(s.userAgent)&&!s.win.opera,s.isSafari=!s.isChrome&&s.userAgent.indexOf("Safari")!==-1,s.isTouchDevice=/(Mobile|Android|Windows Phone)/.test(s.userAgent),s.isWebKit=s.userAgent.indexOf("AppleWebKit")!==-1,s.deg2rad=2*Math.PI/360,s.hasBidiBug=s.isFirefox&&4>parseInt(s.userAgent.split("Firefox/")[1],10),s.hasTouch=!!s.win.TouchEvent,s.marginNames=["plotTop","marginRight","marginBottom","plotLeft"],s.noop=function(){},s.supportsPassiveEvents=function(){let r=!1;if(!s.isMS){let n=Object.defineProperty({},"passive",{get:function(){r=!0}});s.win.addEventListener&&s.win.removeEventListener&&(s.win.addEventListener("testPassive",s.noop,n),s.win.removeEventListener("testPassive",s.noop,n))}return r}(),s.charts=[],s.composed=[],s.dateFormats={},s.seriesTypes={},s.symbolSizes={},s.chartCount=0,i}),t(e,"Core/Utilities.js",[e["Core/Globals.js"]],function(i){let s,{charts:r,doc:n,win:a}=i;function l(v,R,f,w){let b=R?"Highcharts error":"Highcharts warning";v===32&&(v=`${b}: Deprecated member`);let h=S(v),m=h?`${b} #${v}: www.highcharts.com/errors/${v}/`:v.toString();if(w!==void 0){let x="";h&&(m+="?"),Q(w,function(I,B){x+=`
 - ${B}: ${I}`,h&&(m+=encodeURI(B)+"="+encodeURI(I))}),m+=x}P(i,"displayError",{chart:f,code:v,message:m,params:w},function(){if(R)throw Error(m);a.console&&l.messages.indexOf(m)===-1&&console.warn(m)}),l.messages.push(m)}function c(v,R){return parseInt(v,R||10)}function u(v){return typeof v=="string"}function g(v){let R=Object.prototype.toString.call(v);return R==="[object Array]"||R==="[object Array Iterator]"}function p(v,R){return!!v&&typeof v=="object"&&(!R||!g(v))}function C(v){return p(v)&&typeof v.nodeType=="number"}function y(v){let R=v&&v.constructor;return!!(p(v,!0)&&!C(v)&&R&&R.name&&R.name!=="Object")}function S(v){return typeof v=="number"&&!isNaN(v)&&v<1/0&&v>-1/0}function O(v){return v!=null}function M(v,R,f){let w,b=u(R)&&!O(f),h=(m,x)=>{O(m)?v.setAttribute(x,m):b?(w=v.getAttribute(x))||x!=="class"||(w=v.getAttribute(x+"Name")):v.removeAttribute(x)};return u(R)?h(f,R):Q(R,h),w}function _(v){return g(v)?v:[v]}function N(v,R){let f;for(f in v||(v={}),R)v[f]=R[f];return v}function E(){let v=arguments,R=v.length;for(let f=0;f<R;f++){let w=v[f];if(w!=null)return w}}function k(v,R){i.isMS&&!i.svg&&R&&O(R.opacity)&&(R.filter=`alpha(opacity=${100*R.opacity})`),N(v.style,R)}function ie(v){return Math.pow(10,Math.floor(Math.log(v)/Math.LN10))}function $(v,R){return v>1e14?v:parseFloat(v.toPrecision(R||14))}(l||(l={})).messages=[],Math.easeInOutSine=function(v){return-.5*(Math.cos(Math.PI*v)-1)};let H=Array.prototype.find?function(v,R){return v.find(R)}:function(v,R){let f,w=v.length;for(f=0;f<w;f++)if(R(v[f],f))return v[f]};function Q(v,R,f){for(let w in v)Object.hasOwnProperty.call(v,w)&&R.call(f||v[w],v[w],w,v)}function Y(v,R,f){function w(m,x){let I=v.removeEventListener;I&&I.call(v,m,x,!1)}function b(m){let x,I;v.nodeName&&(R?(x={})[R]=!0:x=m,Q(x,function(B,V){if(m[V])for(I=m[V].length;I--;)w(V,m[V][I].fn)}))}let h=typeof v=="function"&&v.prototype||v;if(Object.hasOwnProperty.call(h,"hcEvents")){let m=h.hcEvents;if(R){let x=m[R]||[];f?(m[R]=x.filter(function(I){return f!==I.fn}),w(R,f)):(b(m),m[R]=[])}else b(m),delete h.hcEvents}}function P(v,R,f,w){let b;if(f=f||{},n.createEvent&&(v.dispatchEvent||v.fireEvent&&v!==i))(b=n.createEvent("Events")).initEvent(R,!0,!0),f=N(b,f),v.dispatchEvent?v.dispatchEvent(f):v.fireEvent(R,f);else if(v.hcEvents){f.target||N(f,{preventDefault:function(){f.defaultPrevented=!0},target:v,type:R});let h=[],m=v,x=!1;for(;m.hcEvents;)Object.hasOwnProperty.call(m,"hcEvents")&&m.hcEvents[R]&&(h.length&&(x=!0),h.unshift.apply(h,m.hcEvents[R])),m=Object.getPrototypeOf(m);x&&h.sort((I,B)=>I.order-B.order),h.forEach(I=>{I.fn.call(v,f)===!1&&f.preventDefault()})}w&&!f.defaultPrevented&&w.call(v,f)}Q({map:"map",each:"forEach",grep:"filter",reduce:"reduce",some:"some"},function(v,R){i[R]=function(f){return l(32,!1,void 0,{[`Highcharts.${R}`]:`use Array.${v}`}),Array.prototype[v].apply(f,[].slice.call(arguments,1))}});let j=function(){let v=Math.random().toString(36).substring(2,9)+"-",R=0;return function(){return"highcharts-"+(s?"":v)+R++}}();return a.jQuery&&(a.jQuery.fn.highcharts=function(){let v=[].slice.call(arguments);if(this[0])return v[0]?(new i[u(v[0])?v.shift():"Chart"](this[0],v[0],v[1]),this):r[M(this[0],"data-highcharts-chart")]}),{addEvent:function(v,R,f,w={}){let b=typeof v=="function"&&v.prototype||v;Object.hasOwnProperty.call(b,"hcEvents")||(b.hcEvents={});let h=b.hcEvents;i.Point&&v instanceof i.Point&&v.series&&v.series.chart&&(v.series.chart.runTrackerClick=!0);let m=v.addEventListener;m&&m.call(v,R,f,!!i.supportsPassiveEvents&&{passive:w.passive===void 0?R.indexOf("touch")!==-1:w.passive,capture:!1}),h[R]||(h[R]=[]);let x={fn:f,order:typeof w.order=="number"?w.order:1/0};return h[R].push(x),h[R].sort((I,B)=>I.order-B.order),function(){Y(v,R,f)}},arrayMax:function(v){let R=v.length,f=v[0];for(;R--;)v[R]>f&&(f=v[R]);return f},arrayMin:function(v){let R=v.length,f=v[0];for(;R--;)v[R]<f&&(f=v[R]);return f},attr:M,clamp:function(v,R,f){return v>R?v<f?v:f:R},clearTimeout:function(v){O(v)&&clearTimeout(v)},correctFloat:$,createElement:function(v,R,f,w,b){let h=n.createElement(v);return R&&N(h,R),b&&k(h,{padding:"0",border:"none",margin:"0"}),f&&k(h,f),w&&w.appendChild(h),h},css:k,defined:O,destroyObjectProperties:function(v,R){Q(v,function(f,w){f&&f!==R&&f.destroy&&f.destroy(),delete v[w]})},diffObjects:function(v,R,f,w){let b={};return function h(m,x,I,B){let V=f?x:m;Q(m,function(U,K){if(!B&&w&&w.indexOf(K)>-1&&x[K]){U=_(U),I[K]=[];for(let L=0;L<Math.max(U.length,x[K].length);L++)x[K][L]&&(U[L]===void 0?I[K][L]=x[K][L]:(I[K][L]={},h(U[L],x[K][L],I[K][L],B+1)))}else p(U,!0)&&!U.nodeType?(I[K]=g(U)?[]:{},h(U,x[K]||{},I[K],B+1),Object.keys(I[K]).length!==0||K==="colorAxis"&&B===0||delete I[K]):(m[K]!==x[K]||K in m&&!(K in x))&&(I[K]=V[K])})}(v,R,b,0),b},discardElement:function(v){v&&v.parentElement&&v.parentElement.removeChild(v)},erase:function(v,R){let f=v.length;for(;f--;)if(v[f]===R){v.splice(f,1);break}},error:l,extend:N,extendClass:function(v,R){let f=function(){};return f.prototype=new v,N(f.prototype,R),f},find:H,fireEvent:P,getClosestDistance:function(v,R){let f,w,b,h=!R;return v.forEach(m=>{if(m.length>1)for(b=m.length-1;b>0;b--)(w=m[b]-m[b-1])<0&&!h?(R?.(),R=void 0):w&&(f===void 0||w<f)&&(f=w)}),f},getMagnitude:ie,getNestedProperty:function(v,R){let f=v.split(".");for(;f.length&&O(R);){let w=f.shift();if(w===void 0||w==="__proto__")return;if(w==="this"){let h;return p(R)&&(h=R["@this"]),h??R}let b=R[w];if(!O(b)||typeof b=="function"||typeof b.nodeType=="number"||b===a)return;R=b}return R},getStyle:function v(R,f,w){let b;if(f==="width"){let m=Math.min(R.offsetWidth,R.scrollWidth),x=R.getBoundingClientRect&&R.getBoundingClientRect().width;return x<m&&x>=m-1&&(m=Math.floor(x)),Math.max(0,m-(v(R,"padding-left",!0)||0)-(v(R,"padding-right",!0)||0))}if(f==="height")return Math.max(0,Math.min(R.offsetHeight,R.scrollHeight)-(v(R,"padding-top",!0)||0)-(v(R,"padding-bottom",!0)||0));let h=a.getComputedStyle(R,void 0);return h&&(b=h.getPropertyValue(f),E(w,f!=="opacity")&&(b=c(b))),b},inArray:function(v,R,f){return l(32,!1,void 0,{"Highcharts.inArray":"use Array.indexOf"}),R.indexOf(v,f)},insertItem:function(v,R){let f,w=v.options.index,b=R.length;for(f=v.options.isInternal?b:0;f<b+1;f++)if(!R[f]||S(w)&&w<E(R[f].options.index,R[f]._i)||R[f].options.isInternal){R.splice(f,0,v);break}return f},isArray:g,isClass:y,isDOMElement:C,isFunction:function(v){return typeof v=="function"},isNumber:S,isObject:p,isString:u,keys:function(v){return l(32,!1,void 0,{"Highcharts.keys":"use Object.keys"}),Object.keys(v)},merge:function(){let v,R=arguments,f={},w=function(h,m){return typeof h!="object"&&(h={}),Q(m,function(x,I){I!=="__proto__"&&I!=="constructor"&&(!p(x,!0)||y(x)||C(x)?h[I]=m[I]:h[I]=w(h[I]||{},x))}),h};R[0]===!0&&(f=R[1],R=Array.prototype.slice.call(R,2));let b=R.length;for(v=0;v<b;v++)f=w(f,R[v]);return f},normalizeTickInterval:function(v,R,f,w,b){let h,m=v;f=E(f,ie(v));let x=v/f;for(!R&&(R=b?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],w===!1&&(f===1?R=R.filter(function(I){return I%1==0}):f<=.1&&(R=[1/f]))),h=0;h<R.length&&(m=R[h],(!b||!(m*f>=v))&&(b||!(x<=(R[h]+(R[h+1]||R[h]))/2)));h++);return $(m*f,-Math.round(Math.log(.001)/Math.LN10))},objectEach:Q,offset:function(v){let R=n.documentElement,f=v.parentElement||v.parentNode?v.getBoundingClientRect():{top:0,left:0,width:0,height:0};return{top:f.top+(a.pageYOffset||R.scrollTop)-(R.clientTop||0),left:f.left+(a.pageXOffset||R.scrollLeft)-(R.clientLeft||0),width:f.width,height:f.height}},pad:function(v,R,f){return Array((R||2)+1-String(v).replace("-","").length).join(f||"0")+v},pick:E,pInt:c,pushUnique:function(v,R){return 0>v.indexOf(R)&&!!v.push(R)},relativeLength:function(v,R,f){return/%$/.test(v)?R*parseFloat(v)/100+(f||0):parseFloat(v)},removeEvent:Y,splat:_,stableSort:function(v,R){let f,w,b=v.length;for(w=0;w<b;w++)v[w].safeI=w;for(v.sort(function(h,m){return(f=R(h,m))===0?h.safeI-m.safeI:f}),w=0;w<b;w++)delete v[w].safeI},syncTimeout:function(v,R,f){return R>0?setTimeout(v,R,f):(v.call(0,f),-1)},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},uniqueKey:j,useSerialIds:function(v){return s=E(v,s)},wrap:function(v,R,f){let w=v[R];v[R]=function(){let b=arguments,h=this;return f.apply(this,[function(){return w.apply(h,arguments.length?arguments:b)}].concat([].slice.call(arguments)))}}}}),t(e,"Core/Chart/ChartDefaults.js",[],function(){return{alignThresholds:!1,panning:{enabled:!1,type:"x"},styledMode:!1,borderRadius:0,colorCount:10,allowMutatingData:!0,ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{},position:{}},reflow:!0,type:"line",zooming:{singleTouch:!1,resetButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}}},width:null,height:null,borderColor:"#334eff",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"}}),t(e,"Core/Color/Palettes.js",[],function(){return{colors:["#2caffe","#544fc5","#00e272","#fe6a35","#6b8abc","#d568fb","#2ee0ca","#fa4b42","#feb56a","#91e8e1"]}}),t(e,"Core/Time.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s){let{win:r}=i,{defined:n,error:a,extend:l,isNumber:c,isObject:u,merge:g,objectEach:p,pad:C,pick:y,splat:S,timeUnits:O}=s,M=i.isSafari&&r.Intl&&r.Intl.DateTimeFormat.prototype.formatRange,_=i.isSafari&&r.Intl&&!r.Intl.DateTimeFormat.prototype.formatRange;return class{constructor(N){this.options={},this.useUTC=!1,this.variableTimezone=!1,this.Date=r.Date,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.update(N)}get(N,E){if(this.variableTimezone||this.timezoneOffset){let k=E.getTime(),ie=k-this.getTimezoneOffset(E);E.setTime(ie);let $=E["getUTC"+N]();return E.setTime(k),$}return this.useUTC?E["getUTC"+N]():E["get"+N]()}set(N,E,k){if(this.variableTimezone||this.timezoneOffset){if(N==="Milliseconds"||N==="Seconds"||N==="Minutes"&&this.getTimezoneOffset(E)%36e5==0)return E["setUTC"+N](k);let ie=this.getTimezoneOffset(E),$=E.getTime()-ie;E.setTime($),E["setUTC"+N](k);let H=this.getTimezoneOffset(E);return $=E.getTime()+H,E.setTime($)}return this.useUTC||M&&N==="FullYear"?E["setUTC"+N](k):E["set"+N](k)}update(N={}){let E=y(N.useUTC,!0);this.options=N=g(!0,this.options,N),this.Date=N.Date||r.Date||Date,this.useUTC=E,this.timezoneOffset=E&&N.timezoneOffset||void 0,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.variableTimezone=E&&!!(N.getTimezoneOffset||N.timezone)}makeTime(N,E,k,ie,$,H){let Q,Y,P;return this.useUTC?(Q=this.Date.UTC.apply(0,arguments),Y=this.getTimezoneOffset(Q),Q+=Y,Y!==(P=this.getTimezoneOffset(Q))?Q+=P-Y:Y-36e5!==this.getTimezoneOffset(Q-36e5)||_||(Q-=36e5)):Q=new this.Date(N,E,y(k,1),y(ie,0),y($,0),y(H,0)).getTime(),Q}timezoneOffsetFunction(){let N=this,E=this.options,k=E.getTimezoneOffset;return this.useUTC?E.timezone?ie=>{try{let[$,H,Q,Y,P=0]=Intl.DateTimeFormat("en",{timeZone:E.timezone,timeZoneName:"shortOffset"}).format(ie).split(/(GMT|:)/).map(Number),j=-(36e5*(Q+P/60));if(c(j))return j}catch{a(34)}return 0}:this.useUTC&&k?ie=>6e4*k(ie.valueOf()):()=>6e4*(N.timezoneOffset||0):ie=>6e4*new Date(ie.toString()).getTimezoneOffset()}dateFormat(N,E,k){if(!n(E)||isNaN(E))return i.defaultOptions.lang&&i.defaultOptions.lang.invalidDate||"";N=y(N,"%Y-%m-%d %H:%M:%S");let ie=this,$=new this.Date(E),H=this.get("Hours",$),Q=this.get("Day",$),Y=this.get("Date",$),P=this.get("Month",$),j=this.get("FullYear",$),A=i.defaultOptions.lang,v=A&&A.weekdays,R=A&&A.shortWeekdays,f=l({a:R?R[Q]:v[Q].substr(0,3),A:v[Q],d:C(Y),e:C(Y,2," "),w:Q,b:A.shortMonths[P],B:A.months[P],m:C(P+1),o:P+1,y:j.toString().substr(2,2),Y:j,H:C(H),k:H,I:C(H%12||12),l:H%12||12,M:C(this.get("Minutes",$)),p:H<12?"AM":"PM",P:H<12?"am":"pm",S:C(this.get("Seconds",$)),L:C(Math.floor(E%1e3),3)},i.dateFormats);return p(f,function(w,b){for(;N.indexOf("%"+b)!==-1;)N=N.replace("%"+b,typeof w=="function"?w.call(ie,E):w)}),k?N.substr(0,1).toUpperCase()+N.substr(1):N}resolveDTLFormat(N){return u(N,!0)?N:{main:(N=S(N))[0],from:N[1],to:N[2]}}getTimeTicks(N,E,k,ie){let $,H,Q,Y,P=this,j=P.Date,A=[],v={},R=new j(E),f=N.unitRange,w=N.count||1;if(ie=y(ie,1),n(E)){P.set("Milliseconds",R,f>=O.second?0:w*Math.floor(P.get("Milliseconds",R)/w)),f>=O.second&&P.set("Seconds",R,f>=O.minute?0:w*Math.floor(P.get("Seconds",R)/w)),f>=O.minute&&P.set("Minutes",R,f>=O.hour?0:w*Math.floor(P.get("Minutes",R)/w)),f>=O.hour&&P.set("Hours",R,f>=O.day?0:w*Math.floor(P.get("Hours",R)/w)),f>=O.day&&P.set("Date",R,f>=O.month?1:Math.max(1,w*Math.floor(P.get("Date",R)/w))),f>=O.month&&(P.set("Month",R,f>=O.year?0:w*Math.floor(P.get("Month",R)/w)),H=P.get("FullYear",R)),f>=O.year&&(H-=H%w,P.set("FullYear",R,H)),f===O.week&&(Y=P.get("Day",R),P.set("Date",R,P.get("Date",R)-Y+ie+(Y<ie?-7:0))),H=P.get("FullYear",R);let b=P.get("Month",R),h=P.get("Date",R),m=P.get("Hours",R);E=R.getTime(),(P.variableTimezone||!P.useUTC)&&n(k)&&(Q=k-E>4*O.month||P.getTimezoneOffset(E)!==P.getTimezoneOffset(k));let x=R.getTime();for($=1;x<k;)A.push(x),f===O.year?x=P.makeTime(H+$*w,0):f===O.month?x=P.makeTime(H,b+$*w):Q&&(f===O.day||f===O.week)?x=P.makeTime(H,b,h+$*w*(f===O.day?1:7)):Q&&f===O.hour&&w>1?x=P.makeTime(H,b,h,m+$*w):x+=f*w,$++;A.push(x),f<=O.hour&&A.length<1e4&&A.forEach(function(I){I%18e5==0&&P.dateFormat("%H%M%S%L",I)==="000000000"&&(v[I]="day")})}return A.info=l(N,{higherRanks:v,totalRange:f*w}),A}getDateFormat(N,E,k,ie){let $=this.dateFormat("%m-%d %H:%M:%S.%L",E),H="01-01 00:00:00.000",Q={millisecond:15,second:12,minute:9,hour:6,day:3},Y="millisecond",P=Y;for(Y in O){if(N===O.week&&+this.dateFormat("%w",E)===k&&$.substr(6)===H.substr(6)){Y="week";break}if(O[Y]>N){Y=P;break}if(Q[Y]&&$.substr(Q[Y])!==H.substr(Q[Y]))break;Y!=="week"&&(P=Y)}return this.resolveDTLFormat(ie[Y]).main}}}),t(e,"Core/Defaults.js",[e["Core/Chart/ChartDefaults.js"],e["Core/Globals.js"],e["Core/Color/Palettes.js"],e["Core/Time.js"],e["Core/Utilities.js"]],function(i,s,r,n,a){let{isTouchDevice:l,svg:c}=s,{merge:u}=a,g={colors:r.colors,symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{},time:{Date:void 0,getTimezoneOffset:void 0,timezone:void 0,timezoneOffset:0,useUTC:!0},chart:i,title:{style:{color:"#333333",fontWeight:"bold"},text:"Chart title",align:"center",margin:15,widthAdjust:-44},subtitle:{style:{color:"#666666",fontSize:"0.8em"},text:"",align:"center",widthAdjust:-44},caption:{margin:15,style:{color:"#666666",fontSize:"0.8em"},text:"",align:"left",verticalAlign:"bottom"},plotOptions:{},legend:{enabled:!0,align:"center",alignColumns:!0,className:"highcharts-no-tooltip",layout:"horizontal",itemMarginBottom:2,itemMarginTop:2,labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{style:{fontSize:"0.8em"},activeColor:"#0022ff",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",cursor:"pointer",fontSize:"0.8em",textDecoration:"none",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#666666",textDecoration:"line-through"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontSize:"0.8em",fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:c,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %e %b, %H:%M:%S.%L",second:"%A, %e %b, %H:%M:%S",minute:"%A, %e %b, %H:%M",hour:"%A, %e %b, %H:%M",day:"%A, %e %b %Y",week:"Week from %A, %e %b %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerShape:"callout",hideDelay:500,padding:8,shape:"callout",shared:!1,snap:l?25:10,headerFormat:'<span style="font-size: 0.8em">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">\u25CF</span> {series.name}: <b>{point.y}</b><br/>',backgroundColor:"#ffffff",borderWidth:void 0,shadow:!0,stickOnContact:!1,style:{color:"#333333",cursor:"default",fontSize:"0.8em"},useHTML:!1},credits:{enabled:!0,href:"https://www.highcharts.com?credits",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"0.6em"},text:"Highcharts.com"}};g.chart.styledMode=!1;let p=new n(g.time);return{defaultOptions:g,defaultTime:p,getOptions:function(){return g},setOptions:function(C){return u(!0,g,C),(C.time||C.global)&&(s.time?s.time.update(u(g.global,g.time,C.global,C.time)):s.time=p),g}}}),t(e,"Core/Color/Color.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s){let{isNumber:r,merge:n,pInt:a}=s;class l{static parse(u){return u?new l(u):l.None}constructor(u){let g,p,C,y;this.rgba=[NaN,NaN,NaN,NaN],this.input=u;let S=i.Color;if(S&&S!==l)return new S(u);if(typeof u=="object"&&u.stops!==void 0)this.stops=u.stops.map(O=>new l(O[1]));else if(typeof u=="string"){if(this.input=u=l.names[u.toLowerCase()]||u,u.charAt(0)==="#"){let O=u.length,M=parseInt(u.substr(1),16);O===7?p=[(16711680&M)>>16,(65280&M)>>8,255&M,1]:O===4&&(p=[(3840&M)>>4|(3840&M)>>8,(240&M)>>4|240&M,(15&M)<<4|15&M,1])}if(!p)for(C=l.parsers.length;C--&&!p;)(g=(y=l.parsers[C]).regex.exec(u))&&(p=y.parse(g))}p&&(this.rgba=p)}get(u){let g=this.input,p=this.rgba;if(typeof g=="object"&&this.stops!==void 0){let C=n(g);return C.stops=[].slice.call(C.stops),this.stops.forEach((y,S)=>{C.stops[S]=[C.stops[S][0],y.get(u)]}),C}return p&&r(p[0])?u!=="rgb"&&(u||p[3]!==1)?u==="a"?`${p[3]}`:"rgba("+p.join(",")+")":"rgb("+p[0]+","+p[1]+","+p[2]+")":g}brighten(u){let g=this.rgba;if(this.stops)this.stops.forEach(function(p){p.brighten(u)});else if(r(u)&&u!==0)for(let p=0;p<3;p++)g[p]+=a(255*u),g[p]<0&&(g[p]=0),g[p]>255&&(g[p]=255);return this}setOpacity(u){return this.rgba[3]=u,this}tweenTo(u,g){let p=this.rgba,C=u.rgba;if(!r(p[0])||!r(C[0]))return u.input||"none";let y=C[3]!==1||p[3]!==1;return(y?"rgba(":"rgb(")+Math.round(C[0]+(p[0]-C[0])*(1-g))+","+Math.round(C[1]+(p[1]-C[1])*(1-g))+","+Math.round(C[2]+(p[2]-C[2])*(1-g))+(y?","+(C[3]+(p[3]-C[3])*(1-g)):"")+")"}}return l.names={white:"#ffffff",black:"#000000"},l.parsers=[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(c){return[a(c[1]),a(c[2]),a(c[3]),parseFloat(c[4],10)]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(c){return[a(c[1]),a(c[2]),a(c[3]),1]}}],l.None=new l(""),l}),t(e,"Core/Animation/Fx.js",[e["Core/Color/Color.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s,r){let{parse:n}=i,{win:a}=s,{isNumber:l,objectEach:c}=r;class u{constructor(p,C,y){this.pos=NaN,this.options=C,this.elem=p,this.prop=y}dSetter(){let p=this.paths,C=p&&p[0],y=p&&p[1],S=this.now||0,O=[];if(S!==1&&C&&y)if(C.length===y.length&&S<1)for(let M=0;M<y.length;M++){let _=C[M],N=y[M],E=[];for(let k=0;k<N.length;k++){let ie=_[k],$=N[k];l(ie)&&l($)&&!(N[0]==="A"&&(k===4||k===5))?E[k]=ie+S*($-ie):E[k]=$}O.push(E)}else O=y;else O=this.toD||[];this.elem.attr("d",O,void 0,!0)}update(){let p=this.elem,C=this.prop,y=this.now,S=this.options.step;this[C+"Setter"]?this[C+"Setter"]():p.attr?p.element&&p.attr(C,y,null,!0):p.style[C]=y+this.unit,S&&S.call(p,y,this)}run(p,C,y){let S=this,O=S.options,M=function(E){return!M.stopped&&S.step(E)},_=a.requestAnimationFrame||function(E){setTimeout(E,13)},N=function(){for(let E=0;E<u.timers.length;E++)u.timers[E]()||u.timers.splice(E--,1);u.timers.length&&_(N)};p!==C||this.elem["forceAnimate:"+this.prop]?(this.startTime=+new Date,this.start=p,this.end=C,this.unit=y,this.now=this.start,this.pos=0,M.elem=this.elem,M.prop=this.prop,M()&&u.timers.push(M)===1&&_(N)):(delete O.curAnim[this.prop],O.complete&&Object.keys(O.curAnim).length===0&&O.complete.call(this.elem))}step(p){let C,y,S=+new Date,O=this.options,M=this.elem,_=O.complete,N=O.duration,E=O.curAnim;return M.attr&&!M.element?C=!1:p||S>=N+this.startTime?(this.now=this.end,this.pos=1,this.update(),E[this.prop]=!0,y=!0,c(E,function(k){k!==!0&&(y=!1)}),y&&_&&_.call(M),C=!1):(this.pos=O.easing((S-this.startTime)/N),this.now=this.start+(this.end-this.start)*this.pos,this.update(),C=!0),C}initPath(p,C,y){let S=p.startX,O=p.endX,M=y.slice(),_=p.isArea,N=_?2:1,E,k,ie,$,H=C&&C.slice();if(!H)return[M,M];function Q(P,j){for(;P.length<k;){let A=P[0],v=j[k-P.length];if(v&&A[0]==="M"&&(v[0]==="C"?P[0]=["C",A[1],A[2],A[1],A[2],A[1],A[2]]:P[0]=["L",A[1],A[2]]),P.unshift(A),_){let R=P.pop();P.push(P[P.length-1],R)}}}function Y(P,j){for(;P.length<k;){let A=P[Math.floor(P.length/N)-1].slice();if(A[0]==="C"&&(A[1]=A[5],A[2]=A[6]),_){let v=P[Math.floor(P.length/N)].slice();P.splice(P.length/2,0,A,v)}else P.push(A)}}if(S&&O&&O.length){for(ie=0;ie<S.length;ie++){if(S[ie]===O[0]){E=ie;break}if(S[0]===O[O.length-S.length+ie]){E=ie,$=!0;break}if(S[S.length-1]===O[O.length-S.length+ie]){E=S.length-ie;break}}E===void 0&&(H=[])}return H.length&&l(E)&&(k=M.length+E*N,$?(Q(H,M),Y(M,H)):(Q(M,H),Y(H,M))),[H,M]}fillSetter(){u.prototype.strokeSetter.apply(this,arguments)}strokeSetter(){this.elem.attr(this.prop,n(this.start).tweenTo(n(this.end),this.pos),void 0,!0)}}return u.timers=[],u}),t(e,"Core/Animation/AnimationUtilities.js",[e["Core/Animation/Fx.js"],e["Core/Utilities.js"]],function(i,s){let{defined:r,getStyle:n,isArray:a,isNumber:l,isObject:c,merge:u,objectEach:g,pick:p}=s;function C(S){return c(S)?u({duration:500,defer:0},S):{duration:S?500:0,defer:0}}function y(S,O){let M=i.timers.length;for(;M--;)i.timers[M].elem!==S||O&&O!==i.timers[M].prop||(i.timers[M].stopped=!0)}return{animate:function(S,O,M){let _,N="",E,k,ie;c(M)||(ie=arguments,M={duration:ie[2],easing:ie[3],complete:ie[4]}),l(M.duration)||(M.duration=400),M.easing=typeof M.easing=="function"?M.easing:Math[M.easing]||Math.easeInOutSine,M.curAnim=u(O),g(O,function($,H){y(S,H),k=new i(S,M,H),E=void 0,H==="d"&&a(O.d)?(k.paths=k.initPath(S,S.pathArray,O.d),k.toD=O.d,_=0,E=1):S.attr?_=S.attr(H):(_=parseFloat(n(S,H))||0,H!=="opacity"&&(N="px")),E||(E=$),typeof E=="string"&&E.match("px")&&(E=E.replace(/px/g,"")),k.run(_,E,N)})},animObject:C,getDeferredAnimation:function(S,O,M){let _=C(O),N=M?[M]:S.series,E=0,k=0;return N.forEach($=>{let H=C($.options.animation);E=c(O)&&r(O.defer)?_.defer:Math.max(E,H.duration+H.defer),k=Math.min(_.duration,H.duration)}),S.renderer.forExport&&(E=0),{defer:Math.max(0,E-k),duration:Math.min(E,k)}},setAnimation:function(S,O){O.renderer.globalAnimation=p(S,O.options.chart.animation,!0)},stop:y}}),t(e,"Core/Renderer/HTML/AST.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s){let{SVG_NS:r,win:n}=i,{attr:a,createElement:l,css:c,error:u,isFunction:g,isString:p,objectEach:C,splat:y}=s,{trustedTypes:S}=n,O=S&&g(S.createPolicy)&&S.createPolicy("highcharts",{createHTML:E=>E}),M=O?O.createHTML(""):"",_=function(){try{return!!new DOMParser().parseFromString(M,"text/html")}catch{return!1}}();class N{static filterUserAttributes(k){return C(k,(ie,$)=>{let H=!0;N.allowedAttributes.indexOf($)===-1&&(H=!1),["background","dynsrc","href","lowsrc","src"].indexOf($)!==-1&&(H=p(ie)&&N.allowedReferences.some(Q=>ie.indexOf(Q)===0)),H||(u(33,!1,void 0,{"Invalid attribute in config":`${$}`}),delete k[$]),p(ie)&&k[$]&&(k[$]=ie.replace(/</g,"&lt;"))}),k}static parseStyle(k){return k.split(";").reduce((ie,$)=>{let H=$.split(":").map(Y=>Y.trim()),Q=H.shift();return Q&&H.length&&(ie[Q.replace(/-([a-z])/g,Y=>Y[1].toUpperCase())]=H.join(":")),ie},{})}static setElementHTML(k,ie){k.innerHTML=N.emptyHTML,ie&&new N(ie).addToDOM(k)}constructor(k){this.nodes=typeof k=="string"?this.parseMarkup(k):k}addToDOM(k){return function ie($,H){let Q;return y($).forEach(function(Y){let P,j=Y.tagName,A=Y.textContent?i.doc.createTextNode(Y.textContent):void 0,v=N.bypassHTMLFiltering;if(j)if(j==="#text")P=A;else if(N.allowedTags.indexOf(j)!==-1||v){let R=j==="svg"?r:H.namespaceURI||r,f=i.doc.createElementNS(R,j),w=Y.attributes||{};C(Y,function(b,h){h!=="tagName"&&h!=="attributes"&&h!=="children"&&h!=="style"&&h!=="textContent"&&(w[h]=b)}),a(f,v?w:N.filterUserAttributes(w)),Y.style&&c(f,Y.style),A&&f.appendChild(A),ie(Y.children||[],f),P=f}else u(33,!1,void 0,{"Invalid tagName in config":j});P&&H.appendChild(P),Q=P}),Q}(this.nodes,k)}parseMarkup(k){let ie,$=[];if(k=k.trim().replace(/ style=(["'])/g," data-style=$1"),_)ie=new DOMParser().parseFromString(O?O.createHTML(k):k,"text/html");else{let Q=l("div");Q.innerHTML=k,ie={body:Q}}let H=(Q,Y)=>{let P=Q.nodeName.toLowerCase(),j={tagName:P};P==="#text"&&(j.textContent=Q.textContent||"");let A=Q.attributes;if(A){let v={};[].forEach.call(A,R=>{R.name==="data-style"?j.style=N.parseStyle(R.value):v[R.name]=R.value}),j.attributes=v}if(Q.childNodes.length){let v=[];[].forEach.call(Q.childNodes,R=>{H(R,v)}),v.length&&(j.children=v)}Y.push(j)};return[].forEach.call(ie.body.childNodes,Q=>H(Q,$)),$}}return N.allowedAttributes=["alt","aria-controls","aria-describedby","aria-expanded","aria-haspopup","aria-hidden","aria-label","aria-labelledby","aria-live","aria-pressed","aria-readonly","aria-roledescription","aria-selected","class","clip-path","color","colspan","cx","cy","d","dx","dy","disabled","fill","filterUnits","flood-color","flood-opacity","height","href","id","in","markerHeight","markerWidth","offset","opacity","orient","padding","paddingLeft","paddingRight","patternUnits","r","refX","refY","role","scope","slope","src","startOffset","stdDeviation","stroke","stroke-linecap","stroke-width","style","tableValues","result","rowspan","summary","target","tabindex","text-align","text-anchor","textAnchor","textLength","title","type","valign","width","x","x1","x2","xlink:href","y","y1","y2","zIndex"],N.allowedReferences=["https://","http://","mailto:","/","../","./","#"],N.allowedTags=["a","abbr","b","br","button","caption","circle","clipPath","code","dd","defs","div","dl","dt","em","feComponentTransfer","feDropShadow","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feOffset","feMerge","feMergeNode","filter","h1","h2","h3","h4","h5","h6","hr","i","img","li","linearGradient","marker","ol","p","path","pattern","pre","rect","small","span","stop","strong","style","sub","sup","svg","table","text","textPath","thead","title","tbody","tspan","td","th","tr","u","ul","#text"],N.emptyHTML=M,N.bypassHTMLFiltering=!1,N}),t(e,"Core/Templating.js",[e["Core/Defaults.js"],e["Core/Utilities.js"]],function(i,s){let{defaultOptions:r,defaultTime:n}=i,{extend:a,getNestedProperty:l,isArray:c,isNumber:u,isObject:g,isString:p,pick:C,pInt:y}=s,S={add:(_,N)=>_+N,divide:(_,N)=>N!==0?_/N:"",eq:(_,N)=>_==N,each:function(_){let N=arguments[arguments.length-1];return!!c(_)&&_.map((E,k)=>O(N.body,a(g(E)?E:{"@this":E},{"@index":k,"@first":k===0,"@last":k===_.length-1}))).join("")},ge:(_,N)=>_>=N,gt:(_,N)=>_>N,if:_=>!!_,le:(_,N)=>_<=N,lt:(_,N)=>_<N,multiply:(_,N)=>_*N,ne:(_,N)=>_!=N,subtract:(_,N)=>_-N,unless:_=>!_};function O(_="",N,E){let k=/\{([a-zA-Z0-9\:\.\,;\-\/<>%_@"'= #\(\)]+)\}/g,ie=/\(([a-zA-Z0-9\:\.\,;\-\/<>%_@"'= ]+)\)/g,$=[],H=/f$/,Q=/\.([0-9])/,Y=r.lang,P=E&&E.time||n,j=E&&E.numberFormatter||M,A=(b="")=>{let h;return b==="true"||b!=="false"&&((h=Number(b)).toString()===b?h:l(b,N))},v,R,f=0,w;for(;(v=k.exec(_))!==null;){let b=ie.exec(v[1]);b&&(v=b,w=!0),R&&R.isBlock||(R={ctx:N,expression:v[1],find:v[0],isBlock:v[1].charAt(0)==="#",start:v.index,startInner:v.index+v[0].length,length:v[0].length});let h=v[1].split(" ")[0].replace("#","");S[h]&&(R.isBlock&&h===R.fn&&f++,R.fn||(R.fn=h));let m=v[1]==="else";if(R.isBlock&&R.fn&&(v[1]===`/${R.fn}`||m))if(f)!m&&f--;else{let x=R.startInner,I=_.substr(x,v.index-x);R.body===void 0?(R.body=I,R.startInner=v.index+v[0].length):R.elseBody=I,R.find+=I+v[0],m||($.push(R),R=void 0)}else R.isBlock||$.push(R);if(b&&!R?.isBlock)break}return $.forEach(b=>{let h,m,{body:x,elseBody:I,expression:B,fn:V}=b;if(V){let U=[b],K=B.split(" ");for(m=S[V].length;m--;)U.unshift(A(K[m+1]));h=S[V].apply(N,U),b.isBlock&&typeof h=="boolean"&&(h=O(h?x:I,N))}else{let U=B.split(":");if(h=A(U.shift()||""),U.length&&typeof h=="number"){let K=U.join(":");if(H.test(K)){let L=parseInt((K.match(Q)||["","-1"])[1],10);h!==null&&(h=j(h,L,Y.decimalPoint,K.indexOf(",")>-1?Y.thousandsSep:""))}else h=P.dateFormat(K,h)}}_=_.replace(b.find,C(h,""))}),w?O(_,N,E):_}function M(_,N,E,k){let ie,$;_=+_||0,N=+N;let H=r.lang,Q=(_.toString().split(".")[1]||"").split("e")[0].length,Y=_.toString().split("e"),P=N;N===-1?N=Math.min(Q,20):u(N)?N&&Y[1]&&Y[1]<0&&(($=N+ +Y[1])>=0?(Y[0]=(+Y[0]).toExponential($).split("e")[0],N=$):(Y[0]=Y[0].split(".")[0]||0,_=N<20?(Y[0]*Math.pow(10,Y[1])).toFixed(N):0,Y[1]=0)):N=2;let j=(Math.abs(Y[1]?Y[0]:_)+Math.pow(10,-Math.max(N,Q)-1)).toFixed(N),A=String(y(j)),v=A.length>3?A.length%3:0;return E=C(E,H.decimalPoint),k=C(k,H.thousandsSep),ie=(_<0?"-":"")+(v?A.substr(0,v)+k:""),0>+Y[1]&&!P?ie="0":ie+=A.substr(v).replace(/(\d{3})(?=\d)/g,"$1"+k),N&&(ie+=E+j.slice(-N)),Y[1]&&+ie!=0&&(ie+="e"+Y[1]),ie}return{dateFormat:function(_,N,E){return n.dateFormat(_,N,E)},format:O,helpers:S,numberFormat:M}}),t(e,"Core/Renderer/RendererUtilities.js",[e["Core/Utilities.js"]],function(i){var s;let{clamp:r,pick:n,pushUnique:a,stableSort:l}=i;return(s||(s={})).distribute=function c(u,g,p){let C=u,y=C.reducedLen||g,S=(j,A)=>j.target-A.target,O=[],M=u.length,_=[],N=O.push,E,k,ie,$=!0,H,Q,Y=0,P;for(E=M;E--;)Y+=u[E].size;if(Y>y){for(l(u,(j,A)=>(A.rank||0)-(j.rank||0)),ie=(P=u[0].rank===u[u.length-1].rank)?M/2:-1,k=P?ie:M-1;ie&&Y>y;)H=u[E=Math.floor(k)],a(_,E)&&(Y-=H.size),k+=ie,P&&k>=u.length&&(ie/=2,k=ie);_.sort((j,A)=>A-j).forEach(j=>N.apply(O,u.splice(j,1)))}for(l(u,S),u=u.map(j=>({size:j.size,targets:[j.target],align:n(j.align,.5)}));$;){for(E=u.length;E--;)H=u[E],Q=(Math.min.apply(0,H.targets)+Math.max.apply(0,H.targets))/2,H.pos=r(Q-H.size*H.align,0,g-H.size);for(E=u.length,$=!1;E--;)E>0&&u[E-1].pos+u[E-1].size>u[E].pos&&(u[E-1].size+=u[E].size,u[E-1].targets=u[E-1].targets.concat(u[E].targets),u[E-1].align=.5,u[E-1].pos+u[E-1].size>g&&(u[E-1].pos=g-u[E-1].size),u.splice(E,1),$=!0)}return N.apply(C,O),E=0,u.some(j=>{let A=0;return(j.targets||[]).some(()=>(C[E].pos=j.pos+A,p!==void 0&&Math.abs(C[E].pos-C[E].target)>p?(C.slice(0,E+1).forEach(v=>delete v.pos),C.reducedLen=(C.reducedLen||g)-.1*g,C.reducedLen>.1*g&&c(C,g,p),!0):(A+=C[E].size,E++,!1)))}),l(C,S),C},s}),t(e,"Core/Renderer/SVG/SVGElement.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Color/Color.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s,r,n){let{animate:a,animObject:l,stop:c}=i,{deg2rad:u,doc:g,noop:p,svg:C,SVG_NS:y,win:S}=r,{addEvent:O,attr:M,createElement:_,css:N,defined:E,erase:k,extend:ie,fireEvent:$,isArray:H,isFunction:Q,isObject:Y,isString:P,merge:j,objectEach:A,pick:v,pInt:R,syncTimeout:f,uniqueKey:w}=n;class b{_defaultGetter(m){let x=v(this[m+"Value"],this[m],this.element?this.element.getAttribute(m):null,0);return/^[\-0-9\.]+$/.test(x)&&(x=parseFloat(x)),x}_defaultSetter(m,x,I){I.setAttribute(x,m)}add(m){let x,I=this.renderer,B=this.element;return m&&(this.parentGroup=m),this.textStr!==void 0&&this.element.nodeName==="text"&&I.buildText(this),this.added=!0,(!m||m.handleZ||this.zIndex)&&(x=this.zIndexSetter()),x||(m?m.element:I.box).appendChild(B),this.onAdd&&this.onAdd(),this}addClass(m,x){let I=x?"":this.attr("class")||"";return(m=(m||"").split(/ /g).reduce(function(B,V){return I.indexOf(V)===-1&&B.push(V),B},I?[I]:[]).join(" "))!==I&&this.attr("class",m),this}afterSetters(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)}align(m,x,I){let B,V,U,K,L,X={},q=this.renderer,le=q.alignedObjects;m?(this.alignOptions=m,this.alignByTranslate=x,(!I||P(I))&&(this.alignTo=U=I||"renderer",k(le,this),le.push(this),I=void 0)):(m=this.alignOptions,x=this.alignByTranslate,U=this.alignTo),I=v(I,q[U],U==="scrollablePlotBox"?q.plotBox:void 0,q);let D=m.align,F=m.verticalAlign;return B=(I.x||0)+(m.x||0),V=(I.y||0)+(m.y||0),D==="right"?K=1:D==="center"&&(K=2),K&&(B+=(I.width-(m.width||0))/K),X[x?"translateX":"x"]=Math.round(B),F==="bottom"?L=1:F==="middle"&&(L=2),L&&(V+=(I.height-(m.height||0))/L),X[x?"translateY":"y"]=Math.round(V),this[this.placed?"animate":"attr"](X),this.placed=!0,this.alignAttr=X,this}alignSetter(m){let x={left:"start",center:"middle",right:"end"};x[m]&&(this.alignValue=m,this.element.setAttribute("text-anchor",x[m]))}animate(m,x,I){let B=l(v(x,this.renderer.globalAnimation,!0)),V=B.defer;return g.hidden&&(B.duration=0),B.duration!==0?(I&&(B.complete=I),f(()=>{this.element&&a(this,m,B)},V)):(this.attr(m,void 0,I||B.complete),A(m,function(U,K){B.step&&B.step.call(this,U,{prop:K,pos:1,elem:this})},this)),this}applyTextOutline(m){let x=this.element;m.indexOf("contrast")!==-1&&(m=m.replace(/contrast/g,this.renderer.getContrast(x.style.fill)));let B=m.split(" "),V=B[B.length-1],U=B[0];if(U&&U!=="none"&&r.svg){this.fakeTS=!0,U=U.replace(/(^[\d\.]+)(.*?)$/g,function(le,D,F){return 2*Number(D)+F}),this.removeTextOutline();let K=g.createElementNS(y,"tspan");M(K,{class:"highcharts-text-outline",fill:V,stroke:V,"stroke-width":U,"stroke-linejoin":"round"});let L=x.querySelector("textPath")||x;[].forEach.call(L.childNodes,le=>{let D=le.cloneNode(!0);D.removeAttribute&&["fill","stroke","stroke-width","stroke"].forEach(F=>D.removeAttribute(F)),K.appendChild(D)});let X=0;[].forEach.call(L.querySelectorAll("text tspan"),le=>{X+=Number(le.getAttribute("dy"))});let q=g.createElementNS(y,"tspan");q.textContent="\u200B",M(q,{x:Number(x.getAttribute("x")),dy:-X}),K.appendChild(q),L.insertBefore(K,L.firstChild)}}attr(m,x,I,B){let V=this.element,U=b.symbolCustomAttribs,K,L,X=this,q;return typeof m=="string"&&x!==void 0&&(K=m,(m={})[K]=x),typeof m=="string"?X=(this[m+"Getter"]||this._defaultGetter).call(this,m,V):(A(m,function(le,D){q=!1,B||c(this,D),this.symbolName&&U.indexOf(D)!==-1&&(L||(this.symbolAttr(m),L=!0),q=!0),this.rotation&&(D==="x"||D==="y")&&(this.doTransform=!0),q||(this[D+"Setter"]||this._defaultSetter).call(this,le,D,V)},this),this.afterSetters()),I&&I.call(this),X}clip(m){if(m&&!m.clipPath){let x=w()+"-",I=this.renderer.createElement("clipPath").attr({id:x}).add(this.renderer.defs);ie(m,{clipPath:I,id:x,count:0}),m.add(I)}return this.attr("clip-path",m?`url(${this.renderer.url}#${m.id})`:"none")}crisp(m,x){x=x||m.strokeWidth||0;let I=Math.round(x)%2/2;return m.x=Math.floor(m.x||this.x||0)+I,m.y=Math.floor(m.y||this.y||0)+I,m.width=Math.floor((m.width||this.width||0)-2*I),m.height=Math.floor((m.height||this.height||0)-2*I),E(m.strokeWidth)&&(m.strokeWidth=x),m}complexColor(m,x,I){let B=this.renderer,V,U,K,L,X,q,le,D,F,oe,ne=[],ae;$(this.renderer,"complexColor",{args:arguments},function(){if(m.radialGradient?U="radialGradient":m.linearGradient&&(U="linearGradient"),U){if(K=m[U],X=B.gradients,q=m.stops,F=I.radialReference,H(K)&&(m[U]=K={x1:K[0],y1:K[1],x2:K[2],y2:K[3],gradientUnits:"userSpaceOnUse"}),U==="radialGradient"&&F&&!E(K.gradientUnits)&&(L=K,K=j(K,B.getRadialAttr(F,L),{gradientUnits:"userSpaceOnUse"})),A(K,function(fe,me){me!=="id"&&ne.push(me,fe)}),A(q,function(fe){ne.push(fe)}),X[ne=ne.join(",")])oe=X[ne].attr("id");else{K.id=oe=w();let fe=X[ne]=B.createElement(U).attr(K).add(B.defs);fe.radAttr=L,fe.stops=[],q.forEach(function(me){me[1].indexOf("rgba")===0?(le=(V=s.parse(me[1])).get("rgb"),D=V.get("a")):(le=me[1],D=1);let G=B.createElement("stop").attr({offset:me[0],"stop-color":le,"stop-opacity":D}).add(fe);fe.stops.push(G)})}ae="url("+B.url+"#"+oe+")",I.setAttribute(x,ae),I.gradient=ne,m.toString=function(){return ae}}})}css(m){let x=this.styles,I={},B=this.element,V,U=!x;if(x&&A(m,function(K,L){x&&x[L]!==K&&(I[L]=K,U=!0)}),U){x&&(m=ie(x,I)),m.width===null||m.width==="auto"?delete this.textWidth:B.nodeName.toLowerCase()==="text"&&m.width&&(V=this.textWidth=R(m.width)),this.styles=m,V&&!C&&this.renderer.forExport&&delete m.width;let K=j(m);B.namespaceURI===this.SVG_NS&&(["textOutline","textOverflow","width"].forEach(L=>K&&delete K[L]),K.color&&(K.fill=K.color)),N(B,K)}return this.added&&(this.element.nodeName==="text"&&this.renderer.buildText(this),m.textOutline&&this.applyTextOutline(m.textOutline)),this}dashstyleSetter(m){let x,I=this["stroke-width"];if(I==="inherit"&&(I=1),m=m&&m.toLowerCase()){let B=m.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(x=B.length;x--;)B[x]=""+R(B[x])*v(I,NaN);m=B.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",m)}}destroy(){let m=this,x=m.element||{},I=m.renderer,B=x.ownerSVGElement,V=x.nodeName==="SPAN"&&m.parentGroup||void 0,U,K;if(x.onclick=x.onmouseout=x.onmouseover=x.onmousemove=x.point=null,c(m),m.clipPath&&B){let L=m.clipPath;[].forEach.call(B.querySelectorAll("[clip-path],[CLIP-PATH]"),function(X){X.getAttribute("clip-path").indexOf(L.element.id)>-1&&X.removeAttribute("clip-path")}),m.clipPath=L.destroy()}if(m.connector=m.connector?.destroy(),m.stops){for(K=0;K<m.stops.length;K++)m.stops[K].destroy();m.stops.length=0,m.stops=void 0}for(m.safeRemoveChild(x);V&&V.div&&V.div.childNodes.length===0;)U=V.parentGroup,m.safeRemoveChild(V.div),delete V.div,V=U;m.alignTo&&k(I.alignedObjects,m),A(m,function(L,X){m[X]&&m[X].parentGroup===m&&m[X].destroy&&m[X].destroy(),delete m[X]})}dSetter(m,x,I){H(m)&&(typeof m[0]=="string"&&(m=this.renderer.pathToSegments(m)),this.pathArray=m,m=m.reduce((B,V,U)=>V&&V.join?(U?B+" ":"")+V.join(" "):(V||"").toString(),"")),/(NaN| {2}|^$)/.test(m)&&(m="M 0 0"),this[x]!==m&&(I.setAttribute(x,m),this[x]=m)}fillSetter(m,x,I){typeof m=="string"?I.setAttribute(x,m):m&&this.complexColor(m,x,I)}hrefSetter(m,x,I){I.setAttributeNS("http://www.w3.org/1999/xlink",x,m)}getBBox(m,x){let I,B,V,U,K,{alignValue:L,element:X,renderer:q,styles:le,textStr:D}=this,{cache:F,cacheKeys:oe}=q,ne=X.namespaceURI===this.SVG_NS,ae=v(x,this.rotation,0),fe=q.styledMode?X&&b.prototype.getStyle.call(X,"font-size"):le&&le.fontSize;if(E(D)&&((K=D.toString()).indexOf("<")===-1&&(K=K.replace(/[0-9]/g,"0")),K+=["",q.rootFontSize,fe,ae,this.textWidth,L,le&&le.textOverflow,le&&le.fontWeight].join(",")),K&&!m&&(I=F[K]),!I){if(ne||q.forExport){try{U=this.fakeTS&&function(me){let G=X.querySelector(".highcharts-text-outline");G&&N(G,{display:me})},Q(U)&&U("none"),I=X.getBBox?ie({},X.getBBox()):{width:X.offsetWidth,height:X.offsetHeight,x:0,y:0},Q(U)&&U("")}catch{}(!I||I.width<0)&&(I={x:0,y:0,width:0,height:0})}else I=this.htmlGetBBox();if(B=I.width,V=I.height,ne&&(I.height=V={"11px,17":14,"13px,20":16}[`${fe||""},${Math.round(V)}`]||V),ae){let me=Number(X.getAttribute("y")||0)-I.y,G={right:1,center:.5}[L||0]||0,se=ae*u,ee=(ae-90)*u,ue=B*Math.cos(se),de=B*Math.sin(se),W=Math.cos(ee),z=Math.sin(ee),Z=I.x+G*(B-ue),te=I.y+me-G*de,re=Z+me*W,ce=re+ue,Ce=ce-V*W,ge=Ce-ue,ye=te+me*z,Ee=ye+de,Se=Ee-V*z,be=Se-de;I.x=Math.min(re,ce,Ce,ge),I.y=Math.min(ye,Ee,Se,be),I.width=Math.max(re,ce,Ce,ge)-I.x,I.height=Math.max(ye,Ee,Se,be)-I.y}}if(K&&(D===""||I.height>0)){for(;oe.length>250;)delete F[oe.shift()];F[K]||oe.push(K),F[K]=I}return I}getStyle(m){return S.getComputedStyle(this.element||this,"").getPropertyValue(m)}hasClass(m){return(""+this.attr("class")).split(" ").indexOf(m)!==-1}hide(){return this.attr({visibility:"hidden"})}htmlGetBBox(){return{height:0,width:0,x:0,y:0}}constructor(m,x){this.onEvents={},this.opacity=1,this.SVG_NS=y,this.element=x==="span"?_(x):g.createElementNS(this.SVG_NS,x),this.renderer=m,$(this,"afterInit")}on(m,x){let{onEvents:I}=this;return I[m]&&I[m](),I[m]=O(this.element,m,x),this}opacitySetter(m,x,I){let B=Number(Number(m).toFixed(3));this.opacity=B,I.setAttribute(x,B)}removeClass(m){return this.attr("class",(""+this.attr("class")).replace(P(m)?RegExp(`(^| )${m}( |$)`):m," ").replace(/ +/g," ").trim())}removeTextOutline(){let m=this.element.querySelector("tspan.highcharts-text-outline");m&&this.safeRemoveChild(m)}safeRemoveChild(m){let x=m.parentNode;x&&x.removeChild(m)}setRadialReference(m){let x=this.element.gradient&&this.renderer.gradients[this.element.gradient];return this.element.radialReference=m,x&&x.radAttr&&x.animate(this.renderer.getRadialAttr(m,x.radAttr)),this}setTextPath(m,x){x=j(!0,{enabled:!0,attributes:{dy:-5,startOffset:"50%",textAnchor:"middle"}},x);let I=this.renderer.url,B=this.text||this,V=B.textPath,{attributes:U,enabled:K}=x;if(m=m||V&&V.path,V&&V.undo(),m&&K){let L=O(B,"afterModifyTree",X=>{if(m&&K){let q=m.attr("id");q||m.attr("id",q=w());let le={x:0,y:0};E(U.dx)&&(le.dx=U.dx,delete U.dx),E(U.dy)&&(le.dy=U.dy,delete U.dy),B.attr(le),this.attr({transform:""}),this.box&&(this.box=this.box.destroy());let D=X.nodes.slice(0);X.nodes.length=0,X.nodes[0]={tagName:"textPath",attributes:ie(U,{"text-anchor":U.textAnchor,href:`${I}#${q}`}),children:D}}});B.textPath={path:m,undo:L}}else B.attr({dx:0,dy:0}),delete B.textPath;return this.added&&(B.textCache="",this.renderer.buildText(B)),this}shadow(m){let{renderer:x}=this,I=j(this.parentGroup?.rotation===90?{offsetX:-1,offsetY:-1}:{},Y(m)?m:{}),B=x.shadowDefinition(I);return this.attr({filter:m?`url(${x.url}#${B})`:"none"})}show(m=!0){return this.attr({visibility:m?"inherit":"visible"})}"stroke-widthSetter"(m,x,I){this[x]=m,I.setAttribute(x,m)}strokeWidth(){if(!this.renderer.styledMode)return this["stroke-width"]||0;let m=this.getStyle("stroke-width"),x=0,I;return m.indexOf("px")===m.length-2?x=R(m):m!==""&&(M(I=g.createElementNS(y,"rect"),{width:m,"stroke-width":0}),this.element.parentNode.appendChild(I),x=I.getBBox().width,I.parentNode.removeChild(I)),x}symbolAttr(m){let x=this;b.symbolCustomAttribs.forEach(function(I){x[I]=v(m[I],x[I])}),x.attr({d:x.renderer.symbols[x.symbolName](x.x,x.y,x.width,x.height,x)})}textSetter(m){m!==this.textStr&&(delete this.textPxLength,this.textStr=m,this.added&&this.renderer.buildText(this))}titleSetter(m){let x=this.element,I=x.getElementsByTagName("title")[0]||g.createElementNS(this.SVG_NS,"title");x.insertBefore?x.insertBefore(I,x.firstChild):x.appendChild(I),I.textContent=String(v(m,"")).replace(/<[^>]*>/g,"").replace(/&lt;/g,"<").replace(/&gt;/g,">")}toFront(){let m=this.element;return m.parentNode.appendChild(m),this}translate(m,x){return this.attr({translateX:m,translateY:x})}updateTransform(m="transform"){let{element:x,matrix:I,rotation:B=0,scaleX:V,scaleY:U,translateX:K=0,translateY:L=0}=this,X=["translate("+K+","+L+")"];E(I)&&X.push("matrix("+I.join(",")+")"),B&&X.push("rotate("+B+" "+v(this.rotationOriginX,x.getAttribute("x"),0)+" "+v(this.rotationOriginY,x.getAttribute("y")||0)+")"),(E(V)||E(U))&&X.push("scale("+v(V,1)+" "+v(U,1)+")"),X.length&&!(this.text||this).textPath&&x.setAttribute(m,X.join(" "))}visibilitySetter(m,x,I){m==="inherit"?I.removeAttribute(x):this[x]!==m&&I.setAttribute(x,m),this[x]=m}xGetter(m){return this.element.nodeName==="circle"&&(m==="x"?m="cx":m==="y"&&(m="cy")),this._defaultGetter(m)}zIndexSetter(m,x){let I=this.renderer,B=this.parentGroup,V=B||I,U=V.element||I.box,K=this.element,L=U===I.box,X,q,le,D=!1,F,oe=this.added,ne;if(E(m)?(K.setAttribute("data-z-index",m),m=+m,this[x]===m&&(oe=!1)):E(this[x])&&K.removeAttribute("data-z-index"),this[x]=m,oe){for((m=this.zIndex)&&B&&(B.handleZ=!0),ne=(X=U.childNodes).length-1;ne>=0&&!D;ne--)F=!E(le=(q=X[ne]).getAttribute("data-z-index")),q!==K&&(m<0&&F&&!L&&!ne?(U.insertBefore(K,X[ne]),D=!0):(R(le)<=m||F&&(!E(m)||m>=0))&&(U.insertBefore(K,X[ne+1]),D=!0));D||(U.insertBefore(K,X[L?3:0]),D=!0)}return D}}return b.symbolCustomAttribs=["anchorX","anchorY","clockwise","end","height","innerR","r","start","width","x","y"],b.prototype.strokeSetter=b.prototype.fillSetter,b.prototype.yGetter=b.prototype.xGetter,b.prototype.matrixSetter=b.prototype.rotationOriginXSetter=b.prototype.rotationOriginYSetter=b.prototype.rotationSetter=b.prototype.scaleXSetter=b.prototype.scaleYSetter=b.prototype.translateXSetter=b.prototype.translateYSetter=b.prototype.verticalAlignSetter=function(h,m){this[m]=h,this.doTransform=!0},b}),t(e,"Core/Renderer/RendererRegistry.js",[e["Core/Globals.js"]],function(i){var s,r;let n;return(r=s||(s={})).rendererTypes={},r.getRendererType=function(a=n){return r.rendererTypes[a]||r.rendererTypes[n]},r.registerRendererType=function(a,l,c){r.rendererTypes[a]=l,(!n||c)&&(n=a,i.Renderer=l)},s}),t(e,"Core/Renderer/SVG/SVGLabel.js",[e["Core/Renderer/SVG/SVGElement.js"],e["Core/Utilities.js"]],function(i,s){let{defined:r,extend:n,isNumber:a,merge:l,pick:c,removeEvent:u}=s;class g extends i{constructor(C,y,S,O,M,_,N,E,k,ie){let $;super(C,"g"),this.paddingLeftSetter=this.paddingSetter,this.paddingRightSetter=this.paddingSetter,this.textStr=y,this.x=S,this.y=O,this.anchorX=_,this.anchorY=N,this.baseline=k,this.className=ie,this.addClass(ie==="button"?"highcharts-no-tooltip":"highcharts-label"),ie&&this.addClass("highcharts-"+ie),this.text=C.text(void 0,0,0,E).attr({zIndex:1}),typeof M=="string"&&(($=/^url\((.*?)\)$/.test(M))||this.renderer.symbols[M])&&(this.symbolKey=M),this.bBox=g.emptyBBox,this.padding=3,this.baselineOffset=0,this.needsBox=C.styledMode||$,this.deferredAttr={},this.alignFactor=0}alignSetter(C){let y={left:0,center:.5,right:1}[C];y!==this.alignFactor&&(this.alignFactor=y,this.bBox&&a(this.xSetting)&&this.attr({x:this.xSetting}))}anchorXSetter(C,y){this.anchorX=C,this.boxAttr(y,Math.round(C)-this.getCrispAdjust()-this.xSetting)}anchorYSetter(C,y){this.anchorY=C,this.boxAttr(y,C-this.ySetting)}boxAttr(C,y){this.box?this.box.attr(C,y):this.deferredAttr[C]=y}css(C){if(C){let y={};C=l(C),g.textProps.forEach(S=>{C[S]!==void 0&&(y[S]=C[S],delete C[S])}),this.text.css(y),"fontSize"in y||"fontWeight"in y?this.updateTextPadding():("width"in y||"textOverflow"in y)&&this.updateBoxSize()}return i.prototype.css.call(this,C)}destroy(){u(this.element,"mouseenter"),u(this.element,"mouseleave"),this.text&&this.text.destroy(),this.box&&(this.box=this.box.destroy()),i.prototype.destroy.call(this)}fillSetter(C,y){C&&(this.needsBox=!0),this.fill=C,this.boxAttr(y,C)}getBBox(){this.textStr&&this.bBox.width===0&&this.bBox.height===0&&this.updateBoxSize();let C=this.padding,y=c(this.paddingLeft,C);return{width:this.width||0,height:this.height||0,x:this.bBox.x-y,y:this.bBox.y-C}}getCrispAdjust(){return this.renderer.styledMode&&this.box?this.box.strokeWidth()%2/2:(this["stroke-width"]?parseInt(this["stroke-width"],10):0)%2/2}heightSetter(C){this.heightSetting=C}onAdd(){this.text.add(this),this.attr({text:c(this.textStr,""),x:this.x||0,y:this.y||0}),this.box&&r(this.anchorX)&&this.attr({anchorX:this.anchorX,anchorY:this.anchorY})}paddingSetter(C,y){a(C)?C!==this[y]&&(this[y]=C,this.updateTextPadding()):this[y]=void 0}rSetter(C,y){this.boxAttr(y,C)}strokeSetter(C,y){this.stroke=C,this.boxAttr(y,C)}"stroke-widthSetter"(C,y){C&&(this.needsBox=!0),this["stroke-width"]=C,this.boxAttr(y,C)}"text-alignSetter"(C){this.textAlign=C}textSetter(C){C!==void 0&&this.text.attr({text:C}),this.updateTextPadding()}updateBoxSize(){let C,y=this.text,S={},O=this.padding,M=this.bBox=(!a(this.widthSetting)||!a(this.heightSetting)||this.textAlign)&&r(y.textStr)?y.getBBox():g.emptyBBox;this.width=this.getPaddedWidth(),this.height=(this.heightSetting||M.height||0)+2*O;let _=this.renderer.fontMetrics(y);if(this.baselineOffset=O+Math.min((this.text.firstLineMetrics||_).b,M.height||1/0),this.heightSetting&&(this.baselineOffset+=(this.heightSetting-_.h)/2),this.needsBox&&!y.textPath){if(!this.box){let N=this.box=this.symbolKey?this.renderer.symbol(this.symbolKey):this.renderer.rect();N.addClass((this.className==="button"?"":"highcharts-label-box")+(this.className?" highcharts-"+this.className+"-box":"")),N.add(this)}C=this.getCrispAdjust(),S.x=C,S.y=(this.baseline?-this.baselineOffset:0)+C,S.width=Math.round(this.width),S.height=Math.round(this.height),this.box.attr(n(S,this.deferredAttr)),this.deferredAttr={}}}updateTextPadding(){let C=this.text;if(!C.textPath){this.updateBoxSize();let y=this.baseline?0:this.baselineOffset,S=c(this.paddingLeft,this.padding);r(this.widthSetting)&&this.bBox&&(this.textAlign==="center"||this.textAlign==="right")&&(S+={center:.5,right:1}[this.textAlign]*(this.widthSetting-this.bBox.width)),(S!==C.x||y!==C.y)&&(C.attr("x",S),C.hasBoxWidthChanged&&(this.bBox=C.getBBox(!0)),y!==void 0&&C.attr("y",y)),C.x=S,C.y=y}}widthSetter(C){this.widthSetting=a(C)?C:void 0}getPaddedWidth(){let C=this.padding,y=c(this.paddingLeft,C),S=c(this.paddingRight,C);return(this.widthSetting||this.bBox.width||0)+y+S}xSetter(C){this.x=C,this.alignFactor&&(C-=this.alignFactor*this.getPaddedWidth(),this["forceAnimate:x"]=!0),this.xSetting=Math.round(C),this.attr("translateX",this.xSetting)}ySetter(C){this.ySetting=this.y=Math.round(C),this.attr("translateY",this.ySetting)}}return g.emptyBBox={width:0,height:0,x:0,y:0},g.textProps=["color","direction","fontFamily","fontSize","fontStyle","fontWeight","lineHeight","textAlign","textDecoration","textOutline","textOverflow","whiteSpace","width"],g}),t(e,"Core/Renderer/SVG/Symbols.js",[e["Core/Utilities.js"]],function(i){let{defined:s,isNumber:r,pick:n}=i;function a(u,g,p,C,y){let S=[];if(y){let O=y.start||0,M=n(y.r,p),_=n(y.r,C||p),N=.001>Math.abs((y.end||0)-O-2*Math.PI),E=(y.end||0)-.001,k=y.innerR,ie=n(y.open,N),$=Math.cos(O),H=Math.sin(O),Q=Math.cos(E),Y=Math.sin(E),P=n(y.longArc,E-O-Math.PI<.001?0:1),j=["A",M,_,0,P,n(y.clockwise,1),u+M*Q,g+_*Y];j.params={start:O,end:E,cx:u,cy:g},S.push(["M",u+M*$,g+_*H],j),s(k)&&((j=["A",k,k,0,P,s(y.clockwise)?1-y.clockwise:0,u+k*$,g+k*H]).params={start:E,end:O,cx:u,cy:g},S.push(ie?["M",u+k*Q,g+k*Y]:["L",u+k*Q,g+k*Y],j)),ie||S.push(["Z"])}return S}function l(u,g,p,C,y){return y&&y.r?c(u,g,p,C,y):[["M",u,g],["L",u+p,g],["L",u+p,g+C],["L",u,g+C],["Z"]]}function c(u,g,p,C,y){let S=y?.r||0;return[["M",u+S,g],["L",u+p-S,g],["A",S,S,0,0,1,u+p,g+S],["L",u+p,g+C-S],["A",S,S,0,0,1,u+p-S,g+C],["L",u+S,g+C],["A",S,S,0,0,1,u,g+C-S],["L",u,g+S],["A",S,S,0,0,1,u+S,g],["Z"]]}return{arc:a,callout:function(u,g,p,C,y){let S=Math.min(y&&y.r||0,p,C),O=S+6,M=y&&y.anchorX,_=y&&y.anchorY||0,N=c(u,g,p,C,{r:S});if(!r(M)||M<p&&M>0&&_<C&&_>0)return N;if(u+M>p-O)if(_>g+O&&_<g+C-O)N.splice(3,1,["L",u+p,_-6],["L",u+p+6,_],["L",u+p,_+6],["L",u+p,g+C-S]);else if(M<p){let E=_<g+O,k=E?g:g+C;N.splice(E?2:5,0,["L",M,_],["L",u+p-S,k])}else N.splice(3,1,["L",u+p,C/2],["L",M,_],["L",u+p,C/2],["L",u+p,g+C-S]);else if(u+M<O)if(_>g+O&&_<g+C-O)N.splice(7,1,["L",u,_+6],["L",u-6,_],["L",u,_-6],["L",u,g+S]);else if(M>0){let E=_<g+O,k=E?g:g+C;N.splice(E?1:6,0,["L",M,_],["L",u+S,k])}else N.splice(7,1,["L",u,C/2],["L",M,_],["L",u,C/2],["L",u,g+S]);else _>C&&M<p-O?N.splice(5,1,["L",M+6,g+C],["L",M,g+C+6],["L",M-6,g+C],["L",u+S,g+C]):_<0&&M>O&&N.splice(1,1,["L",M-6,g],["L",M,g-6],["L",M+6,g],["L",p-S,g]);return N},circle:function(u,g,p,C){return a(u+p/2,g+C/2,p/2,C/2,{start:.5*Math.PI,end:2.5*Math.PI,open:!1})},diamond:function(u,g,p,C){return[["M",u+p/2,g],["L",u+p,g+C/2],["L",u+p/2,g+C],["L",u,g+C/2],["Z"]]},rect:l,roundedRect:c,square:l,triangle:function(u,g,p,C){return[["M",u+p/2,g],["L",u+p,g+C],["L",u,g+C],["Z"]]},"triangle-down":function(u,g,p,C){return[["M",u,g],["L",u+p,g],["L",u+p/2,g+C],["Z"]]}}}),t(e,"Core/Renderer/SVG/TextBuilder.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s,r){let{doc:n,SVG_NS:a,win:l}=s,{attr:c,extend:u,fireEvent:g,isString:p,objectEach:C,pick:y}=r;return class{constructor(S){let O=S.styles;this.renderer=S.renderer,this.svgElement=S,this.width=S.textWidth,this.textLineHeight=O&&O.lineHeight,this.textOutline=O&&O.textOutline,this.ellipsis=!!(O&&O.textOverflow==="ellipsis"),this.noWrap=!!(O&&O.whiteSpace==="nowrap")}buildSVG(){let S=this.svgElement,O=S.element,M=S.renderer,_=y(S.textStr,"").toString(),N=_.indexOf("<")!==-1,E=O.childNodes,k=!S.added&&M.box,ie=[_,this.ellipsis,this.noWrap,this.textLineHeight,this.textOutline,S.getStyle("font-size"),this.width].join(",");if(ie!==S.textCache){S.textCache=ie,delete S.actualWidth;for(let $=E.length;$--;)O.removeChild(E[$]);if(N||this.ellipsis||this.width||S.textPath||_.indexOf(" ")!==-1&&(!this.noWrap||/<br.*?>/g.test(_))){if(_!==""){k&&k.appendChild(O);let $=new i(_);this.modifyTree($.nodes),$.addToDOM(O),this.modifyDOM(),this.ellipsis&&(O.textContent||"").indexOf("\u2026")!==-1&&S.attr("title",this.unescapeEntities(S.textStr||"",["&lt;","&gt;"])),k&&k.removeChild(O)}}else O.appendChild(n.createTextNode(this.unescapeEntities(_)));p(this.textOutline)&&S.applyTextOutline&&S.applyTextOutline(this.textOutline)}}modifyDOM(){let S,O=this.svgElement,M=c(O.element,"x");for(O.firstLineMetrics=void 0;(S=O.element.firstChild)&&/^[\s\u200B]*$/.test(S.textContent||" ");)O.element.removeChild(S);[].forEach.call(O.element.querySelectorAll("tspan.highcharts-br"),(k,ie)=>{k.nextSibling&&k.previousSibling&&(ie===0&&k.previousSibling.nodeType===1&&(O.firstLineMetrics=O.renderer.fontMetrics(k.previousSibling)),c(k,{dy:this.getLineHeight(k.nextSibling),x:M}))});let _=this.width||0;if(!_)return;let N=(k,ie)=>{let $=k.textContent||"",H=$.replace(/([^\^])-/g,"$1- ").split(" "),Q=!this.noWrap&&(H.length>1||O.element.childNodes.length>1),Y=this.getLineHeight(ie),P=0,j=O.actualWidth;if(this.ellipsis)$&&this.truncate(k,$,void 0,0,Math.max(0,_-.8*Y),(A,v)=>A.substring(0,v)+"\u2026");else if(Q){let A=[],v=[];for(;ie.firstChild&&ie.firstChild!==k;)v.push(ie.firstChild),ie.removeChild(ie.firstChild);for(;H.length;)H.length&&!this.noWrap&&P>0&&(A.push(k.textContent||""),k.textContent=H.join(" ").replace(/- /g,"-")),this.truncate(k,void 0,H,P===0&&j||0,_,(R,f)=>H.slice(0,f).join(" ").replace(/- /g,"-")),j=O.actualWidth,P++;v.forEach(R=>{ie.insertBefore(R,k)}),A.forEach(R=>{ie.insertBefore(n.createTextNode(R),k);let f=n.createElementNS(a,"tspan");f.textContent="\u200B",c(f,{dy:Y,x:M}),ie.insertBefore(f,k)})}},E=k=>{[].slice.call(k.childNodes).forEach($=>{$.nodeType===l.Node.TEXT_NODE?N($,k):($.className.baseVal.indexOf("highcharts-br")!==-1&&(O.actualWidth=0),E($))})};E(O.element)}getLineHeight(S){let O=S.nodeType===l.Node.TEXT_NODE?S.parentElement:S;return this.textLineHeight?parseInt(this.textLineHeight.toString(),10):this.renderer.fontMetrics(O||this.svgElement.element).h}modifyTree(S){let O=(M,_)=>{let{attributes:N={},children:E,style:k={},tagName:ie}=M,$=this.renderer.styledMode;if(ie==="b"||ie==="strong"?$?N.class="highcharts-strong":k.fontWeight="bold":(ie==="i"||ie==="em")&&($?N.class="highcharts-emphasized":k.fontStyle="italic"),k&&k.color&&(k.fill=k.color),ie==="br"){N.class="highcharts-br",M.textContent="\u200B";let H=S[_+1];H&&H.textContent&&(H.textContent=H.textContent.replace(/^ +/gm,""))}else ie==="a"&&E&&E.some(H=>H.tagName==="#text")&&(M.children=[{children:E,tagName:"tspan"}]);ie!=="#text"&&ie!=="a"&&(M.tagName="tspan"),u(M,{attributes:N,style:k}),E&&E.filter(H=>H.tagName!=="#text").forEach(O)};S.forEach(O),g(this.svgElement,"afterModifyTree",{nodes:S})}truncate(S,O,M,_,N,E){let k,ie,$=this.svgElement,{renderer:H,rotation:Q}=$,Y=[],P=M?1:0,j=(O||M||"").length,A=j,v=function(R,f){let w=f||R,b=S.parentNode;if(b&&Y[w]===void 0&&b.getSubStringLength)try{Y[w]=_+b.getSubStringLength(0,M?w+1:w)}catch{}return Y[w]};if($.rotation=0,_+(ie=v(S.textContent.length))>N){for(;P<=j;)A=Math.ceil((P+j)/2),M&&(k=E(M,A)),ie=v(A,k&&k.length-1),P===j?P=j+1:ie>N?j=A-1:P=A;j===0?S.textContent="":O&&j===O.length-1||(S.textContent=k||E(O||M,A))}M&&M.splice(0,A),$.actualWidth=ie,$.rotation=Q}unescapeEntities(S,O){return C(this.renderer.escapes,function(M,_){O&&O.indexOf(M)!==-1||(S=S.toString().replace(RegExp(M,"g"),_))}),S}}}),t(e,"Core/Renderer/SVG/SVGRenderer.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Color/Color.js"],e["Core/Globals.js"],e["Core/Renderer/RendererRegistry.js"],e["Core/Renderer/SVG/SVGElement.js"],e["Core/Renderer/SVG/SVGLabel.js"],e["Core/Renderer/SVG/Symbols.js"],e["Core/Renderer/SVG/TextBuilder.js"],e["Core/Utilities.js"]],function(i,s,r,n,a,l,c,u,g){let p,{charts:C,deg2rad:y,doc:S,isFirefox:O,isMS:M,isWebKit:_,noop:N,SVG_NS:E,symbolSizes:k,win:ie}=r,{addEvent:$,attr:H,createElement:Q,css:Y,defined:P,destroyObjectProperties:j,extend:A,isArray:v,isNumber:R,isObject:f,isString:w,merge:b,pick:h,pInt:m,uniqueKey:x}=g;class I{constructor(V,U,K,L,X,q,le){let D,F,oe=this.createElement("svg").attr({version:"1.1",class:"highcharts-root"}),ne=oe.element;le||oe.css(this.getStyle(L||{})),V.appendChild(ne),H(V,"dir","ltr"),V.innerHTML.indexOf("xmlns")===-1&&H(ne,"xmlns",this.SVG_NS),this.box=ne,this.boxWrapper=oe,this.alignedObjects=[],this.url=this.getReferenceURL(),this.createElement("desc").add().element.appendChild(S.createTextNode("Created with Highcharts 11.3.0")),this.defs=this.createElement("defs").add(),this.allowHTML=q,this.forExport=X,this.styledMode=le,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.rootFontSize=oe.getStyle("font-size"),this.setSize(U,K,!1),O&&V.getBoundingClientRect&&((D=function(){Y(V,{left:0,top:0}),F=V.getBoundingClientRect(),Y(V,{left:Math.ceil(F.left)-F.left+"px",top:Math.ceil(F.top)-F.top+"px"})})(),this.unSubPixelFix=$(ie,"resize",D))}definition(V){return new i([V]).addToDOM(this.defs.element)}getReferenceURL(){if((O||_)&&S.getElementsByTagName("base").length){if(!P(p)){let V=x(),U=new i([{tagName:"svg",attributes:{width:8,height:8},children:[{tagName:"defs",children:[{tagName:"clipPath",attributes:{id:V},children:[{tagName:"rect",attributes:{width:4,height:4}}]}]},{tagName:"rect",attributes:{id:"hitme",width:8,height:8,"clip-path":`url(#${V})`,fill:"rgba(0,0,0,0.001)"}}]}]),K=U.addToDOM(S.body);Y(K,{position:"fixed",top:0,left:0,zIndex:9e5});let L=S.elementFromPoint(6,6);p=(L&&L.id)==="hitme",S.body.removeChild(K)}if(p)return ie.location.href.split("#")[0].replace(/<[^>]*>/g,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20")}return""}getStyle(V){return this.style=A({fontFamily:"Helvetica, Arial, sans-serif",fontSize:"1rem"},V),this.style}setStyle(V){this.boxWrapper.css(this.getStyle(V))}isHidden(){return!this.boxWrapper.getBBox().width}destroy(){let V=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),j(this.gradients||{}),this.gradients=null,this.defs=V.destroy(),this.unSubPixelFix&&this.unSubPixelFix(),this.alignedObjects=null,null}createElement(V){return new this.Element(this,V)}getRadialAttr(V,U){return{cx:V[0]-V[2]/2+(U.cx||0)*V[2],cy:V[1]-V[2]/2+(U.cy||0)*V[2],r:(U.r||0)*V[2]}}shadowDefinition(V){let U=[`highcharts-drop-shadow-${this.chartIndex}`,...Object.keys(V).map(L=>`${L}-${V[L]}`)].join("-").toLowerCase().replace(/[^a-z0-9\-]/g,""),K=b({color:"#000000",offsetX:1,offsetY:1,opacity:.15,width:5},V);return this.defs.element.querySelector(`#${U}`)||this.definition({tagName:"filter",attributes:{id:U,filterUnits:K.filterUnits},children:[{tagName:"feDropShadow",attributes:{dx:K.offsetX,dy:K.offsetY,"flood-color":K.color,"flood-opacity":Math.min(5*K.opacity,1),stdDeviation:K.width/2}}]}),U}buildText(V){new u(V).buildSVG()}getContrast(V){let U=s.parse(V).rgba.map(L=>{let X=L/255;return X<=.03928?X/12.92:Math.pow((X+.055)/1.055,2.4)}),K=.2126*U[0]+.7152*U[1]+.0722*U[2];return 1.05/(K+.05)>(K+.05)/.05?"#FFFFFF":"#000000"}button(V,U,K,L,X={},q,le,D,F,oe){let ne,ae,fe,me=this.label(V,U,K,F,void 0,void 0,oe,void 0,"button"),G=this.styledMode,se=X.states||{},ee=0;X=b(X),delete X.states;let ue=b({color:"#333333",cursor:"pointer",fontSize:"0.8em",fontWeight:"normal"},X.style);delete X.style;let de=i.filterUserAttributes(X);return me.attr(b({padding:8,r:2},de)),G||(de=b({fill:"#f7f7f7",stroke:"#cccccc","stroke-width":1},de),ne=(q=b(de,{fill:"#e6e6e6"},i.filterUserAttributes(q||se.hover||{}))).style,delete q.style,ae=(le=b(de,{fill:"#e6e9ff",style:{color:"#000000",fontWeight:"bold"}},i.filterUserAttributes(le||se.select||{}))).style,delete le.style,fe=(D=b(de,{style:{color:"#cccccc"}},i.filterUserAttributes(D||se.disabled||{}))).style,delete D.style),$(me.element,M?"mouseover":"mouseenter",function(){ee!==3&&me.setState(1)}),$(me.element,M?"mouseout":"mouseleave",function(){ee!==3&&me.setState(ee)}),me.setState=function(W){if(W!==1&&(me.state=ee=W),me.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][W||0]),!G){me.attr([de,q,le,D][W||0]);let z=[ue,ne,ae,fe][W||0];f(z)&&me.css(z)}},!G&&(me.attr(de).css(A({cursor:"default"},ue)),oe&&me.text.css({pointerEvents:"none"})),me.on("touchstart",W=>W.stopPropagation()).on("click",function(W){ee!==3&&L.call(me,W)})}crispLine(V,U,K="round"){let L=V[0],X=V[1];return P(L[1])&&L[1]===X[1]&&(L[1]=X[1]=Math[K](L[1])-U%2/2),P(L[2])&&L[2]===X[2]&&(L[2]=X[2]=Math[K](L[2])+U%2/2),V}path(V){let U=this.styledMode?{}:{fill:"none"};return v(V)?U.d=V:f(V)&&A(U,V),this.createElement("path").attr(U)}circle(V,U,K){let L=f(V)?V:V===void 0?{}:{x:V,y:U,r:K},X=this.createElement("circle");return X.xSetter=X.ySetter=function(q,le,D){D.setAttribute("c"+le,q)},X.attr(L)}arc(V,U,K,L,X,q){let le;f(V)?(U=(le=V).y,K=le.r,L=le.innerR,X=le.start,q=le.end,V=le.x):le={innerR:L,start:X,end:q};let D=this.symbol("arc",V,U,K,K,le);return D.r=K,D}rect(V,U,K,L,X,q){let le=f(V)?V:V===void 0?{}:{x:V,y:U,r:X,width:Math.max(K||0,0),height:Math.max(L||0,0)},D=this.createElement("rect");return this.styledMode||(q!==void 0&&(le["stroke-width"]=q,A(le,D.crisp(le))),le.fill="none"),D.rSetter=function(F,oe,ne){D.r=F,H(ne,{rx:F,ry:F})},D.rGetter=function(){return D.r||0},D.attr(le)}roundedRect(V){return this.symbol("roundedRect").attr(V)}setSize(V,U,K){this.width=V,this.height=U,this.boxWrapper.animate({width:V,height:U},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:h(K,!0)?void 0:0}),this.alignElements()}g(V){let U=this.createElement("g");return V?U.attr({class:"highcharts-"+V}):U}image(V,U,K,L,X,q){let le={preserveAspectRatio:"none"};R(U)&&(le.x=U),R(K)&&(le.y=K),R(L)&&(le.width=L),R(X)&&(le.height=X);let D=this.createElement("image").attr(le),F=function(oe){D.attr({href:V}),q.call(D,oe)};if(q){D.attr({href:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="});let oe=new ie.Image;$(oe,"load",F),oe.src=V,oe.complete&&F({})}else D.attr({href:V});return D}symbol(V,U,K,L,X,q){let le,D,F,oe,ne=this,ae=/^url\((.*?)\)$/,fe=ae.test(V),me=!fe&&(this.symbols[V]?V:"circle"),G=me&&this.symbols[me];if(G)typeof U=="number"&&(D=G.call(this.symbols,Math.round(U||0),Math.round(K||0),L||0,X||0,q)),le=this.path(D),ne.styledMode||le.attr("fill","none"),A(le,{symbolName:me||void 0,x:U,y:K,width:L,height:X}),q&&A(le,q);else if(fe){F=V.match(ae)[1];let se=le=this.image(F);se.imgwidth=h(q&&q.width,k[F]&&k[F].width),se.imgheight=h(q&&q.height,k[F]&&k[F].height),oe=ee=>ee.attr({width:ee.width,height:ee.height}),["width","height"].forEach(ee=>{se[`${ee}Setter`]=function(ue,de){this[de]=ue;let{alignByTranslate:W,element:z,width:Z,height:te,imgwidth:re,imgheight:ce}=this,Ce=de==="width"?re:ce,ge=1;q&&q.backgroundSize==="within"&&Z&&te&&re&&ce?(ge=Math.min(Z/re,te/ce),H(z,{width:Math.round(re*ge),height:Math.round(ce*ge)})):z&&Ce&&z.setAttribute(de,Ce),!W&&re&&ce&&this.translate(((Z||0)-re*ge)/2,((te||0)-ce*ge)/2)}}),P(U)&&se.attr({x:U,y:K}),se.isImg=!0,P(se.imgwidth)&&P(se.imgheight)?oe(se):(se.attr({width:0,height:0}),Q("img",{onload:function(){let ee=C[ne.chartIndex];this.width===0&&(Y(this,{position:"absolute",top:"-999em"}),S.body.appendChild(this)),k[F]={width:this.width,height:this.height},se.imgwidth=this.width,se.imgheight=this.height,se.element&&oe(se),this.parentNode&&this.parentNode.removeChild(this),ne.imgCount--,ne.imgCount||!ee||ee.hasLoaded||ee.onload()},src:F}),this.imgCount++)}return le}clipRect(V,U,K,L){return this.rect(V,U,K,L,0)}text(V,U,K,L){let X={};if(L&&(this.allowHTML||!this.forExport))return this.html(V,U,K);X.x=Math.round(U||0),K&&(X.y=Math.round(K)),P(V)&&(X.text=V);let q=this.createElement("text").attr(X);return L&&(!this.forExport||this.allowHTML)||(q.xSetter=function(le,D,F){let oe=F.getElementsByTagName("tspan"),ne=F.getAttribute(D);for(let ae=0,fe;ae<oe.length;ae++)(fe=oe[ae]).getAttribute(D)===ne&&fe.setAttribute(D,le);F.setAttribute(D,le)}),q}fontMetrics(V){let U=m(a.prototype.getStyle.call(V,"font-size")||0),K=U<24?U+3:Math.round(1.2*U),L=Math.round(.8*K);return{h:K,b:L,f:U}}rotCorr(V,U,K){let L=V;return U&&K&&(L=Math.max(L*Math.cos(U*y),4)),{x:-V/3*Math.sin(U*y),y:L}}pathToSegments(V){let U=[],K=[],L={A:8,C:7,H:2,L:3,M:3,Q:5,S:5,T:3,V:2};for(let X=0;X<V.length;X++)w(K[0])&&R(V[X])&&K.length===L[K[0].toUpperCase()]&&V.splice(X,0,K[0].replace("M","L").replace("m","l")),typeof V[X]=="string"&&(K.length&&U.push(K.slice(0)),K.length=0),K.push(V[X]);return U.push(K.slice(0)),U}label(V,U,K,L,X,q,le,D,F){return new l(this,V,U,K,L,X,q,le,D,F)}alignElements(){this.alignedObjects.forEach(V=>V.align())}}return A(I.prototype,{Element:a,SVG_NS:E,escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},symbols:c,draw:N}),n.registerRendererType("svg",I,!0),I}),t(e,"Core/Renderer/HTML/HTMLElement.js",[e["Core/Globals.js"],e["Core/Renderer/SVG/SVGElement.js"],e["Core/Utilities.js"]],function(i,s,r){let{composed:n}=i,{css:a,defined:l,extend:c,pushUnique:u,pInt:g}=r;class p extends s{static compose(y){if(u(n,this.compose)){let S=p.prototype,O=y.prototype;O.getSpanCorrection=S.getSpanCorrection,O.htmlCss=S.htmlCss,O.htmlGetBBox=S.htmlGetBBox,O.htmlUpdateTransform=S.htmlUpdateTransform,O.setSpanRotation=S.setSpanRotation}return y}getSpanCorrection(y,S,O){this.xCorr=-y*O,this.yCorr=-S}htmlCss(y){let S,{element:O}=this,M=O.tagName==="SPAN"&&y&&"width"in y,_=M&&y.width;return M&&(delete y.width,this.textWidth=g(_)||void 0,S=!0),y?.textOverflow==="ellipsis"&&(y.whiteSpace="nowrap",y.overflow="hidden"),c(this.styles,y),a(O,y),S&&this.htmlUpdateTransform(),this}htmlGetBBox(){let{element:y}=this;return{x:y.offsetLeft,y:y.offsetTop,width:y.offsetWidth,height:y.offsetHeight}}htmlUpdateTransform(){if(!this.added){this.alignOnAdd=!0;return}let{element:y,renderer:S,rotation:O,styles:M,textAlign:_="left",textWidth:N,translateX:E=0,translateY:k=0,x:ie=0,y:$=0}=this,H={left:0,center:.5,right:1}[_],Q=M?.whiteSpace;if(a(y,{marginLeft:`${E}px`,marginTop:`${k}px`}),y.tagName==="SPAN"){let Y=[O,_,y.innerHTML,N,this.textAlign].join(","),P,j=!1;if(N!==this.oldTextWidth){let A=this.textPxLength?this.textPxLength:(a(y,{width:"",whiteSpace:Q||"nowrap"}),y.offsetWidth),v=N||0;(v>this.oldTextWidth||A>v)&&(/[ \-]/.test(y.textContent||y.innerText)||y.style.textOverflow==="ellipsis")&&(a(y,{width:A>v||O?N+"px":"auto",display:"block",whiteSpace:Q||"normal"}),this.oldTextWidth=N,j=!0)}this.hasBoxWidthChanged=j,Y!==this.cTT&&(P=S.fontMetrics(y).b,l(O)&&(O!==(this.oldRotation||0)||_!==this.oldAlign)&&this.setSpanRotation(O,H,P),this.getSpanCorrection(!l(O)&&this.textPxLength||y.offsetWidth,P,H)),a(y,{left:ie+(this.xCorr||0)+"px",top:$+(this.yCorr||0)+"px"}),this.cTT=Y,this.oldRotation=O,this.oldAlign=_}}setSpanRotation(y,S,O){a(this.element,{transform:`rotate(${y}deg)`,transformOrigin:`${100*S}% ${O}px`})}}return p}),t(e,"Core/Renderer/HTML/HTMLRenderer.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Globals.js"],e["Core/Renderer/SVG/SVGElement.js"],e["Core/Renderer/SVG/SVGRenderer.js"],e["Core/Utilities.js"]],function(i,s,r,n,a){let{composed:l}=s,{attr:c,createElement:u,extend:g,pick:p,pushUnique:C}=a;class y extends n{static compose(O){if(C(l,this.compose)){let M=y.prototype,_=O.prototype;_.html=M.html}return O}html(O,M,_){let N=this.createElement("span"),E=N.element,k=N.renderer,ie=function($,H){["opacity","visibility"].forEach(function(Q){$[Q+"Setter"]=function(Y,P,j){let A=$.div?$.div.style:H;r.prototype[Q+"Setter"].call(this,Y,P,j),A&&(A[P]=Y)}}),$.addedSetters=!0};return N.textSetter=function($){$!==this.textStr&&(delete this.bBox,delete this.oldTextWidth,i.setElementHTML(this.element,p($,"")),this.textStr=$,N.doTransform=!0)},ie(N,N.element.style),N.xSetter=N.ySetter=N.alignSetter=N.rotationSetter=function($,H){H==="align"?N.alignValue=N.textAlign=$:N[H]=$,N.doTransform=!0},N.afterSetters=function(){this.doTransform&&(this.htmlUpdateTransform(),this.doTransform=!1)},N.attr({text:O,x:Math.round(M),y:Math.round(_)}).css({position:"absolute"}),k.styledMode||N.css({fontFamily:this.style.fontFamily,fontSize:this.style.fontSize}),E.style.whiteSpace="nowrap",N.css=N.htmlCss,N.add=function($){let H,Q,Y=k.box.parentNode,P=[];if(this.parentGroup=$,$){if(!(H=$.div)){for(Q=$;Q;)P.push(Q),Q=Q.parentGroup;P.reverse().forEach(function(j){var A;let v=c(j.element,"class"),R=j.css;function f(h,m){j[m]=h,m==="translateX"?b.left=h+"px":b.top=h+"px",j.doTransform=!0}let w=j.styles||{};H=j.div=j.div||u("div",v?{className:v}:void 0,{position:"absolute",left:(j.translateX||0)+"px",top:(j.translateY||0)+"px",display:j.display,opacity:j.opacity,visibility:j.visibility},H||Y);let b=H.style;g(j,{classSetter:(A=H,function(h){this.element.setAttribute("class",h),A.className=h}),css:function(h){return R.call(j,h),["cursor","pointerEvents"].forEach(m=>{h[m]&&(b[m]=h[m])}),j},on:function(){return P[0].div&&N.on.apply({element:P[0].div,onEvents:j.onEvents},arguments),j},translateXSetter:f,translateYSetter:f}),j.addedSetters||ie(j),j.css(w)})}}else H=Y;return H.appendChild(E),N.added=!0,N.alignOnAdd&&N.htmlUpdateTransform(),N},N}}return y}),t(e,"Core/Axis/AxisDefaults.js",[],function(){var i,s;return(s=i||(i={})).xAxis={alignTicks:!0,allowDecimals:void 0,panningEnabled:!0,zIndex:2,zoomEnabled:!0,dateTimeLabelFormats:{millisecond:{main:"%H:%M:%S.%L",range:!1},second:{main:"%H:%M:%S",range:!1},minute:{main:"%H:%M",range:!1},hour:{main:"%H:%M",range:!1},day:{main:"%e %b"},week:{main:"%e %b"},month:{main:"%b '%y"},year:{main:"%Y"}},endOnTick:!1,gridLineDashStyle:"Solid",gridZIndex:1,labels:{autoRotationLimit:80,distance:15,enabled:!0,indentation:10,overflow:"justify",padding:5,reserveSpace:void 0,rotation:void 0,staggerLines:0,step:0,useHTML:!1,zIndex:7,style:{color:"#333333",cursor:"default",fontSize:"0.8em"}},maxPadding:.01,minorGridLineDashStyle:"Solid",minorTickLength:2,minorTickPosition:"outside",minorTicksPerMajor:5,minPadding:.01,offset:void 0,reversed:void 0,reversedStacks:!1,showEmpty:!0,showFirstLabel:!0,showLastLabel:!0,startOfWeek:1,startOnTick:!1,tickLength:10,tickPixelInterval:100,tickmarkPlacement:"between",tickPosition:"outside",title:{align:"middle",useHTML:!1,x:0,y:0,style:{color:"#666666",fontSize:"0.8em"}},type:"linear",uniqueNames:!0,visible:!0,minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#333333",lineWidth:1,gridLineColor:"#e6e6e6",gridLineWidth:void 0,tickColor:"#333333"},s.yAxis={reversedStacks:!0,endOnTick:!0,maxPadding:.05,minPadding:.05,tickPixelInterval:72,showLastLabel:!0,labels:{x:void 0},startOnTick:!0,title:{text:"Values"},stackLabels:{animation:{},allowOverlap:!1,enabled:!1,crop:!0,overflow:"justify",formatter:function(){let{numberFormatter:r}=this.axis.chart;return r(this.total||0,-1)},style:{color:"#000000",fontSize:"0.7em",fontWeight:"bold",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0},i}),t(e,"Core/Foundation.js",[e["Core/Utilities.js"]],function(i){var s;let{addEvent:r,isFunction:n,objectEach:a,removeEvent:l}=i;return(s||(s={})).registerEventOptions=function(c,u){c.eventOptions=c.eventOptions||{},a(u.events,function(g,p){c.eventOptions[p]!==g&&(c.eventOptions[p]&&(l(c,p,c.eventOptions[p]),delete c.eventOptions[p]),n(g)&&(c.eventOptions[p]=g,r(c,p,g,{order:0})))})},s}),t(e,"Core/Axis/Tick.js",[e["Core/Templating.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s,r){let{deg2rad:n}=s,{clamp:a,correctFloat:l,defined:c,destroyObjectProperties:u,extend:g,fireEvent:p,isNumber:C,merge:y,objectEach:S,pick:O}=r;return class{constructor(M,_,N,E,k){this.isNew=!0,this.isNewLabel=!0,this.axis=M,this.pos=_,this.type=N||"",this.parameters=k||{},this.tickmarkOffset=this.parameters.tickmarkOffset,this.options=this.parameters.options,p(this,"init"),N||E||this.addLabel()}addLabel(){let M=this,_=M.axis,N=_.options,E=_.chart,k=_.categories,ie=_.logarithmic,$=_.names,H=M.pos,Q=O(M.options&&M.options.labels,N.labels),Y=_.tickPositions,P=H===Y[0],j=H===Y[Y.length-1],A=(!Q.step||Q.step===1)&&_.tickInterval===1,v=Y.info,R=M.label,f,w,b,h=this.parameters.category||(k?O(k[H],$[H],H):H);ie&&C(h)&&(h=l(ie.lin2log(h))),_.dateTime&&(v?f=(w=E.time.resolveDTLFormat(N.dateTimeLabelFormats[!N.grid&&v.higherRanks[H]||v.unitName])).main:C(h)&&(f=_.dateTime.getXDateFormat(h,N.dateTimeLabelFormats||{}))),M.isFirst=P,M.isLast=j;let m={axis:_,chart:E,dateTimeLabelFormat:f,isFirst:P,isLast:j,pos:H,tick:M,tickPositionInfo:v,value:h};p(this,"labelFormat",m);let x=V=>Q.formatter?Q.formatter.call(V,V):Q.format?(V.text=_.defaultLabelFormatter.call(V,V),i.format(Q.format,V,E)):_.defaultLabelFormatter.call(V,V),I=x.call(m,m),B=w&&w.list;B?M.shortenLabel=function(){for(b=0;b<B.length;b++)if(g(m,{dateTimeLabelFormat:B[b]}),R.attr({text:x.call(m,m)}),R.getBBox().width<_.getSlotWidth(M)-2*Q.padding)return;R.attr({text:""})}:M.shortenLabel=void 0,A&&_._addedPlotLB&&M.moveLabel(I,Q),c(R)||M.movedLabel?R&&R.textStr!==I&&!A&&(!R.textWidth||Q.style.width||R.styles.width||R.css({width:null}),R.attr({text:I}),R.textPxLength=R.getBBox().width):(M.label=R=M.createLabel(I,Q),M.rotation=0)}createLabel(M,_,N){let E=this.axis,k=E.chart,ie=c(M)&&_.enabled?k.renderer.text(M,N?.x,N?.y,_.useHTML).add(E.labelGroup):void 0;return ie&&(k.styledMode||ie.css(y(_.style)),ie.textPxLength=ie.getBBox().width),ie}destroy(){u(this,this.axis)}getPosition(M,_,N,E){let k=this.axis,ie=k.chart,$=E&&ie.oldChartHeight||ie.chartHeight,H={x:M?l(k.translate(_+N,void 0,void 0,E)+k.transB):k.left+k.offset+(k.opposite?(E&&ie.oldChartWidth||ie.chartWidth)-k.right-k.left:0),y:M?$-k.bottom+k.offset-(k.opposite?k.height:0):l($-k.translate(_+N,void 0,void 0,E)-k.transB)};return H.y=a(H.y,-1e5,1e5),p(this,"afterGetPosition",{pos:H}),H}getLabelPosition(M,_,N,E,k,ie,$,H){let Q,Y,P=this.axis,j=P.transA,A=P.isLinked&&P.linkedParent?P.linkedParent.reversed:P.reversed,v=P.staggerLines,R=P.tickRotCorr||{x:0,y:0},f=E||P.reserveSpaceDefault?0:-P.labelOffset*(P.labelAlign==="center"?.5:1),w=k.distance,b={};return Q=P.side===0?N.rotation?-w:-N.getBBox().height:P.side===2?R.y+w:Math.cos(N.rotation*n)*(R.y-N.getBBox(!1,0).height/2),c(k.y)&&(Q=P.side===0&&P.horiz?k.y+Q:k.y),M=M+O(k.x,[0,1,0,-1][P.side]*w)+f+R.x-(ie&&E?ie*j*(A?-1:1):0),_=_+Q-(ie&&!E?ie*j*(A?1:-1):0),v&&(Y=$/(H||1)%v,P.opposite&&(Y=v-Y-1),_+=Y*(P.labelOffset/v)),b.x=M,b.y=Math.round(_),p(this,"afterGetLabelPosition",{pos:b,tickmarkOffset:ie,index:$}),b}getLabelSize(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0}getMarkPath(M,_,N,E,k,ie){return ie.crispLine([["M",M,_],["L",M+(k?0:-N),_+(k?N:0)]],E)}handleOverflow(M){let _=this.axis,N=_.options.labels,E=M.x,k=_.chart.chartWidth,ie=_.chart.spacing,$=O(_.labelLeft,Math.min(_.pos,ie[3])),H=O(_.labelRight,Math.max(_.isRadial?0:_.pos+_.len,k-ie[1])),Q=this.label,Y=this.rotation,P={left:0,center:.5,right:1}[_.labelAlign||Q.attr("align")],j=Q.getBBox().width,A=_.getSlotWidth(this),v={},R=A,f=1,w;Y||N.overflow!=="justify"?Y<0&&E-P*j<$?w=Math.round(E/Math.cos(Y*n)-$):Y>0&&E+P*j>H&&(w=Math.round((k-E)/Math.cos(Y*n))):(E-P*j<$?R=M.x+R*(1-P)-$:E+(1-P)*j>H&&(R=H-M.x+R*P,f=-1),(R=Math.min(A,R))<A&&_.labelAlign==="center"&&(M.x+=f*(A-R-P*(A-Math.min(j,R)))),(j>R||_.autoRotation&&(Q.styles||{}).width)&&(w=R)),w&&(this.shortenLabel?this.shortenLabel():(v.width=Math.floor(w)+"px",(N.style||{}).textOverflow||(v.textOverflow="ellipsis"),Q.css(v)))}moveLabel(M,_){let N=this,E=N.label,k=N.axis,ie=!1,$;E&&E.textStr===M?(N.movedLabel=E,ie=!0,delete N.label):S(k.ticks,function(H){ie||H.isNew||H===N||!H.label||H.label.textStr!==M||(N.movedLabel=H.label,ie=!0,H.labelPos=N.movedLabel.xy,delete H.label)}),!ie&&(N.labelPos||E)&&($=N.labelPos||E.xy,N.movedLabel=N.createLabel(M,_,$),N.movedLabel&&N.movedLabel.attr({opacity:0}))}render(M,_,N){let E=this.axis,k=E.horiz,ie=this.pos,$=O(this.tickmarkOffset,E.tickmarkOffset),H=this.getPosition(k,ie,$,_),Q=H.x,Y=H.y,P=k&&Q===E.pos+E.len||!k&&Y===E.pos?-1:1,j=O(N,this.label&&this.label.newOpacity,1);N=O(N,1),this.isActive=!0,this.renderGridLine(_,N,P),this.renderMark(H,N,P),this.renderLabel(H,_,j,M),this.isNew=!1,p(this,"afterRender")}renderGridLine(M,_,N){let E=this.axis,k=E.options,ie={},$=this.pos,H=this.type,Q=O(this.tickmarkOffset,E.tickmarkOffset),Y=E.chart.renderer,P=this.gridLine,j,A=k.gridLineWidth,v=k.gridLineColor,R=k.gridLineDashStyle;this.type==="minor"&&(A=k.minorGridLineWidth,v=k.minorGridLineColor,R=k.minorGridLineDashStyle),P||(E.chart.styledMode||(ie.stroke=v,ie["stroke-width"]=A||0,ie.dashstyle=R),H||(ie.zIndex=1),M&&(_=0),this.gridLine=P=Y.path().attr(ie).addClass("highcharts-"+(H?H+"-":"")+"grid-line").add(E.gridGroup)),P&&(j=E.getPlotLinePath({value:$+Q,lineWidth:P.strokeWidth()*N,force:"pass",old:M,acrossPanes:!1}))&&P[M||this.isNew?"attr":"animate"]({d:j,opacity:_})}renderMark(M,_,N){let E=this.axis,k=E.options,ie=E.chart.renderer,$=this.type,H=E.tickSize($?$+"Tick":"tick"),Q=M.x,Y=M.y,P=O(k[$!=="minor"?"tickWidth":"minorTickWidth"],!$&&E.isXAxis?1:0),j=k[$!=="minor"?"tickColor":"minorTickColor"],A=this.mark,v=!A;H&&(E.opposite&&(H[0]=-H[0]),A||(this.mark=A=ie.path().addClass("highcharts-"+($?$+"-":"")+"tick").add(E.axisGroup),E.chart.styledMode||A.attr({stroke:j,"stroke-width":P})),A[v?"attr":"animate"]({d:this.getMarkPath(Q,Y,H[0],A.strokeWidth()*N,E.horiz,ie),opacity:_}))}renderLabel(M,_,N,E){let k=this.axis,ie=k.horiz,$=k.options,H=this.label,Q=$.labels,Y=Q.step,P=O(this.tickmarkOffset,k.tickmarkOffset),j=M.x,A=M.y,v=!0;H&&C(j)&&(H.xy=M=this.getLabelPosition(j,A,H,ie,Q,P,E,Y),(!this.isFirst||this.isLast||$.showFirstLabel)&&(!this.isLast||this.isFirst||$.showLastLabel)?!ie||Q.step||Q.rotation||_||N===0||this.handleOverflow(M):v=!1,Y&&E%Y&&(v=!1),v&&C(M.y)?(M.opacity=N,H[this.isNewLabel?"attr":"animate"](M).show(!0),this.isNewLabel=!1):(H.hide(),this.isNewLabel=!0))}replaceMovedLabel(){let M=this.label,_=this.axis;M&&!this.isNew&&(M.animate({opacity:0},void 0,M.destroy),delete this.label),_.isDirty=!0,this.label=this.movedLabel,delete this.movedLabel}}}),t(e,"Core/Axis/Axis.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Axis/AxisDefaults.js"],e["Core/Color/Color.js"],e["Core/Defaults.js"],e["Core/Foundation.js"],e["Core/Globals.js"],e["Core/Axis/Tick.js"],e["Core/Utilities.js"]],function(i,s,r,n,a,l,c,u){let{animObject:g}=i,{xAxis:p,yAxis:C}=s,{defaultOptions:y}=n,{registerEventOptions:S}=a,{deg2rad:O}=l,{arrayMax:M,arrayMin:_,clamp:N,correctFloat:E,defined:k,destroyObjectProperties:ie,erase:$,error:H,extend:Q,fireEvent:Y,getClosestDistance:P,insertItem:j,isArray:A,isNumber:v,isString:R,merge:f,normalizeTickInterval:w,objectEach:b,pick:h,relativeLength:m,removeEvent:x,splat:I,syncTimeout:B}=u,V=(K,L)=>w(L,void 0,void 0,h(K.options.allowDecimals,L<.5||K.tickAmount!==void 0),!!K.tickAmount);Q(y,{xAxis:p,yAxis:f(p,C)});class U{constructor(L,X,q){this.init(L,X,q)}init(L,X,q=this.coll){let le=q==="xAxis",D=this.isZAxis||(L.inverted?!le:le);this.chart=L,this.horiz=D,this.isXAxis=le,this.coll=q,Y(this,"init",{userOptions:X}),this.opposite=h(X.opposite,this.opposite),this.side=h(X.side,this.side,D?this.opposite?0:2:this.opposite?1:3),this.setOptions(X);let F=this.options,oe=F.labels,ne=F.type;this.userOptions=X,this.minPixelPadding=0,this.reversed=h(F.reversed,this.reversed),this.visible=F.visible,this.zoomEnabled=F.zoomEnabled,this.hasNames=ne==="category"||F.categories===!0,this.categories=A(F.categories)&&F.categories||(this.hasNames?[]:void 0),this.names||(this.names=[],this.names.keys={}),this.plotLinesAndBandsGroups={},this.positiveValuesOnly=!!this.logarithmic,this.isLinked=k(F.linkedTo),this.ticks={},this.labelEdge=[],this.minorTicks={},this.plotLinesAndBands=[],this.alternateBands={},this.len=0,this.minRange=this.userMinRange=F.minRange||F.maxZoom,this.range=F.range,this.offset=F.offset||0,this.max=void 0,this.min=void 0;let ae=h(F.crosshair,I(L.options.tooltip.crosshairs)[le?0:1]);this.crosshair=ae===!0?{}:ae,L.axes.indexOf(this)===-1&&(le?L.axes.splice(L.xAxis.length,0,this):L.axes.push(this),j(this,L[this.coll])),L.orderItems(this.coll),this.series=this.series||[],L.inverted&&!this.isZAxis&&le&&!k(this.reversed)&&(this.reversed=!0),this.labelRotation=v(oe.rotation)?oe.rotation:void 0,S(this,F),Y(this,"afterInit")}setOptions(L){let X=this.horiz?{labels:{autoRotation:[-45]},margin:15}:{title:{rotation:90*this.side}};this.options=f(X,y[this.coll],L),Y(this,"afterSetOptions",{userOptions:L})}defaultLabelFormatter(L){let X=this.axis,q=this.chart,{numberFormatter:le}=q,D=v(this.value)?this.value:NaN,F=X.chart.time,oe=X.categories,ne=this.dateTimeLabelFormat,ae=y.lang,fe=ae.numericSymbols,me=ae.numericSymbolMagnitude||1e3,G=X.logarithmic?Math.abs(D):X.tickInterval,se=fe&&fe.length,ee,ue;if(oe)ue=`${this.value}`;else if(ne)ue=F.dateFormat(ne,D);else if(se&&fe&&G>=1e3)for(;se--&&ue===void 0;)G>=(ee=Math.pow(me,se+1))&&10*D%ee==0&&fe[se]!==null&&D!==0&&(ue=le(D/ee,-1)+fe[se]);return ue===void 0&&(ue=Math.abs(D)>=1e4?le(D,-1):le(D,-1,void 0,"")),ue}getSeriesExtremes(){let L,X=this;Y(this,"getSeriesExtremes",null,function(){X.hasVisibleSeries=!1,X.dataMin=X.dataMax=X.threshold=void 0,X.softThreshold=!X.isXAxis,X.series.forEach(q=>{if(q.reserveSpace()){let le=q.options,D,F=le.threshold,oe,ne;if(X.hasVisibleSeries=!0,X.positiveValuesOnly&&0>=(F||0)&&(F=void 0),X.isXAxis)(D=q.xData)&&D.length&&(D=X.logarithmic?D.filter(ae=>ae>0):D,oe=(L=q.getXExtremes(D)).min,ne=L.max,v(oe)||oe instanceof Date||(D=D.filter(v),oe=(L=q.getXExtremes(D)).min,ne=L.max),D.length&&(X.dataMin=Math.min(h(X.dataMin,oe),oe),X.dataMax=Math.max(h(X.dataMax,ne),ne)));else{let ae=q.applyExtremes();v(ae.dataMin)&&(oe=ae.dataMin,X.dataMin=Math.min(h(X.dataMin,oe),oe)),v(ae.dataMax)&&(ne=ae.dataMax,X.dataMax=Math.max(h(X.dataMax,ne),ne)),k(F)&&(X.threshold=F),(!le.softThreshold||X.positiveValuesOnly)&&(X.softThreshold=!1)}}})}),Y(this,"afterGetSeriesExtremes")}translate(L,X,q,le,D,F){let oe=this.linkedParent||this,ne=le&&oe.old?oe.old.min:oe.min;if(!v(ne))return NaN;let ae=oe.minPixelPadding,fe=(oe.isOrdinal||oe.brokenAxis?.hasBreaks||oe.logarithmic&&D)&&oe.lin2val,me=1,G=0,se=le&&oe.old?oe.old.transA:oe.transA,ee=0;if(se||(se=oe.transA),q&&(me*=-1,G=oe.len),oe.reversed&&(me*=-1,G-=me*(oe.sector||oe.len)),X)ee=(L=L*me+G-ae)/se+ne,fe&&(ee=oe.lin2val(ee));else{fe&&(L=oe.val2lin(L));let ue=me*(L-ne)*se;ee=(oe.isRadial?ue:E(ue))+G+me*ae+(v(F)?se*F:0)}return ee}toPixels(L,X){return this.translate(L,!1,!this.horiz,void 0,!0)+(X?0:this.pos)}toValue(L,X){return this.translate(L-(X?0:this.pos),!0,!this.horiz,void 0,!0)}getPlotLinePath(L){let X=this,q=X.chart,le=X.left,D=X.top,F=L.old,oe=L.value,ne=L.lineWidth,ae=F&&q.oldChartHeight||q.chartHeight,fe=F&&q.oldChartWidth||q.chartWidth,me=X.transB,G=L.translatedValue,se=L.force,ee,ue,de,W,z;function Z(re,ce,Ce){return se!=="pass"&&(re<ce||re>Ce)&&(se?re=N(re,ce,Ce):z=!0),re}let te={value:oe,lineWidth:ne,old:F,force:se,acrossPanes:L.acrossPanes,translatedValue:G};return Y(this,"getPlotLinePath",te,function(re){ee=de=Math.round((G=N(G=h(G,X.translate(oe,void 0,void 0,F)),-1e5,1e5))+me),ue=W=Math.round(ae-G-me),v(G)?X.horiz?(ue=D,W=ae-X.bottom,ee=de=Z(ee,le,le+X.width)):(ee=le,de=fe-X.right,ue=W=Z(ue,D,D+X.height)):(z=!0,se=!1),re.path=z&&!se?void 0:q.renderer.crispLine([["M",ee,ue],["L",de,W]],ne||1)}),te.path}getLinearTickPositions(L,X,q){let le,D,F,oe=E(Math.floor(X/L)*L),ne=E(Math.ceil(q/L)*L),ae=[];if(E(oe+L)===oe&&(F=20),this.single)return[X];for(le=oe;le<=ne&&(ae.push(le),(le=E(le+L,F))!==D);)D=le;return ae}getMinorTickInterval(){let{minorTicks:L,minorTickInterval:X}=this.options;return L===!0?h(X,"auto"):L!==!1?X:void 0}getMinorTickPositions(){let L=this.options,X=this.tickPositions,q=this.minorTickInterval,le=this.pointRangePadding||0,D=(this.min||0)-le,F=(this.max||0)+le,oe=F-D,ne=[],ae;if(oe&&oe/q<this.len/3){let fe=this.logarithmic;if(fe)this.paddedTicks.forEach(function(me,G,se){G&&ne.push.apply(ne,fe.getLogTickPositions(q,se[G-1],se[G],!0))});else if(this.dateTime&&this.getMinorTickInterval()==="auto")ne=ne.concat(this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(q),D,F,L.startOfWeek));else for(ae=D+(X[0]-D)%q;ae<=F&&ae!==ne[0];ae+=q)ne.push(ae)}return ne.length!==0&&this.trimTicks(ne),ne}adjustForMinRange(){let L=this.options,X=this.logarithmic,{max:q,min:le,minRange:D}=this,F,oe,ne,ae;this.isXAxis&&D===void 0&&!X&&(D=k(L.min)||k(L.max)||k(L.floor)||k(L.ceiling)?null:Math.min(5*(P(this.series.map(fe=>(fe.xIncrement?fe.xData?.slice(0,2):fe.xData)||[]))||0),this.dataMax-this.dataMin)),v(q)&&v(le)&&v(D)&&q-le<D&&(oe=this.dataMax-this.dataMin>=D,F=(D-q+le)/2,ne=[le-F,h(L.min,le-F)],oe&&(ne[2]=X?X.log2lin(this.dataMin):this.dataMin),ae=[(le=M(ne))+D,h(L.max,le+D)],oe&&(ae[2]=X?X.log2lin(this.dataMax):this.dataMax),(q=_(ae))-le<D&&(ne[0]=q-D,ne[1]=h(L.min,q-D),le=M(ne))),this.minRange=D,this.min=le,this.max=q}getClosest(){let L,X;if(this.categories)X=1;else{let q=[];this.series.forEach(function(le){let D=le.closestPointRange;le.xData?.length===1?q.push(le.xData[0]):!le.noSharedTooltip&&k(D)&&le.reserveSpace()&&(X=k(X)?Math.min(X,D):D)}),q.length&&(q.sort((le,D)=>le-D),L=P([q]))}return L&&X?Math.min(L,X):L||X}nameToX(L){let X=A(this.options.categories),q=X?this.categories:this.names,le=L.options.x,D;return L.series.requireSorting=!1,k(le)||(le=this.options.uniqueNames&&q?X?q.indexOf(L.name):h(q.keys[L.name],-1):L.series.autoIncrement()),le===-1?!X&&q&&(D=q.length):D=le,D!==void 0?(this.names[D]=L.name,this.names.keys[L.name]=D):L.x&&(D=L.x),D}updateNames(){let L=this,X=this.names;X.length>0&&(Object.keys(X.keys).forEach(function(le){delete X.keys[le]}),X.length=0,this.minRange=this.userMinRange,(this.series||[]).forEach(le=>{le.xIncrement=null,(!le.points||le.isDirtyData)&&(L.max=Math.max(L.max,le.xData.length-1),le.processData(),le.generatePoints()),le.data.forEach(function(D,F){let oe;D?.options&&D.name!==void 0&&(oe=L.nameToX(D))!==void 0&&oe!==D.x&&(D.x=oe,le.xData[F]=oe)})}))}setAxisTranslation(){let L=this,X=L.max-L.min,q=L.linkedParent,le=!!L.categories,D=L.isXAxis,F=L.axisPointRange||0,oe,ne=0,ae=0,fe,me=L.transA;(D||le||F)&&(oe=L.getClosest(),q?(ne=q.minPointOffset,ae=q.pointRangePadding):L.series.forEach(function(G){let se=le?1:D?h(G.options.pointRange,oe,0):L.axisPointRange||0,ee=G.options.pointPlacement;if(F=Math.max(F,se),!L.single||le){let ue=G.is("xrange")?!D:D;ne=Math.max(ne,ue&&R(ee)?0:se/2),ae=Math.max(ae,ue&&ee==="on"?0:se)}}),fe=L.ordinal&&L.ordinal.slope&&oe?L.ordinal.slope/oe:1,L.minPointOffset=ne*=fe,L.pointRangePadding=ae*=fe,L.pointRange=Math.min(F,L.single&&le?1:X),D&&oe&&(L.closestPointRange=oe)),L.translationSlope=L.transA=me=L.staticScale||L.len/(X+ae||1),L.transB=L.horiz?L.left:L.bottom,L.minPixelPadding=me*ne,Y(this,"afterSetAxisTranslation")}minFromRange(){let{max:L,min:X}=this;return v(L)&&v(X)&&L-X||void 0}setTickInterval(L){let{categories:X,chart:q,dataMax:le,dataMin:D,dateTime:F,isXAxis:oe,logarithmic:ne,options:ae,softThreshold:fe}=this,me=v(this.threshold)?this.threshold:void 0,G=this.minRange||0,{ceiling:se,floor:ee,linkedTo:ue,softMax:de,softMin:W}=ae,z=v(ue)&&q[this.coll]?.[ue],Z=ae.tickPixelInterval,te=ae.maxPadding,re=ae.minPadding,ce=0,Ce,ge=v(ae.tickInterval)&&ae.tickInterval>=0?ae.tickInterval:void 0,ye,Ee,Se,be;if(F||X||z||this.getTickAmount(),Se=h(this.userMin,ae.min),be=h(this.userMax,ae.max),z?(this.linkedParent=z,Ce=z.getExtremes(),this.min=h(Ce.min,Ce.dataMin),this.max=h(Ce.max,Ce.dataMax),ae.type!==z.options.type&&H(11,!0,q)):(fe&&k(me)&&v(le)&&v(D)&&(D>=me?(ye=me,re=0):le<=me&&(Ee=me,te=0)),this.min=h(Se,ye,D),this.max=h(be,Ee,le)),v(this.max)&&v(this.min)&&(ne&&(this.positiveValuesOnly&&!L&&0>=Math.min(this.min,h(D,this.min))&&H(10,!0,q),this.min=E(ne.log2lin(this.min),16),this.max=E(ne.log2lin(this.max),16)),this.range&&v(D)&&(this.userMin=this.min=Se=Math.max(D,this.minFromRange()||0),this.userMax=be=this.max,this.range=void 0)),Y(this,"foundExtremes"),this.adjustForMinRange(),v(this.min)&&v(this.max)){if(!v(this.userMin)&&v(W)&&W<this.min&&(this.min=Se=W),!v(this.userMax)&&v(de)&&de>this.max&&(this.max=be=de),X||this.axisPointRange||this.stacking?.usePercentage||z||!(ce=this.max-this.min)||(!k(Se)&&re&&(this.min-=ce*re),k(be)||!te||(this.max+=ce*te)),!v(this.userMin)&&v(ee)&&(this.min=Math.max(this.min,ee)),!v(this.userMax)&&v(se)&&(this.max=Math.min(this.max,se)),fe&&v(D)&&v(le)){let Ae=me||0;!k(Se)&&this.min<Ae&&D>=Ae?this.min=ae.minRange?Math.min(Ae,this.max-G):Ae:!k(be)&&this.max>Ae&&le<=Ae&&(this.max=ae.minRange?Math.max(Ae,this.min+G):Ae)}!q.polar&&this.min>this.max&&(k(ae.min)?this.max=this.min:k(ae.max)&&(this.min=this.max)),ce=this.max-this.min}if(this.min!==this.max&&v(this.min)&&v(this.max)?z&&!ge&&Z===z.options.tickPixelInterval?this.tickInterval=ge=z.tickInterval:this.tickInterval=h(ge,this.tickAmount?ce/Math.max(this.tickAmount-1,1):void 0,X?1:ce*Z/Math.max(this.len,Z)):this.tickInterval=1,oe&&!L){let Ae=this.min!==this.old?.min||this.max!==this.old?.max;this.series.forEach(function(Ne){Ne.forceCrop=Ne.forceCropping?.(),Ne.processData(Ae)}),Y(this,"postProcessData",{hasExtremesChanged:Ae})}this.setAxisTranslation(),Y(this,"initialAxisTranslation"),this.pointRange&&!ge&&(this.tickInterval=Math.max(this.pointRange,this.tickInterval));let Re=h(ae.minTickInterval,F&&!this.series.some(Ae=>Ae.noSharedTooltip)?this.closestPointRange:0);!ge&&this.tickInterval<Re&&(this.tickInterval=Re),F||ne||ge||(this.tickInterval=V(this,this.tickInterval)),this.tickAmount||(this.tickInterval=this.unsquish()),this.setTickPositions()}setTickPositions(){let L=this.options,X=L.tickPositions,q=L.tickPositioner,le=this.getMinorTickInterval(),D=this.hasVerticalPanning(),F=this.coll==="colorAxis",oe=(F||!D)&&L.startOnTick,ne=(F||!D)&&L.endOnTick,ae=[],fe;if(this.tickmarkOffset=this.categories&&L.tickmarkPlacement==="between"&&this.tickInterval===1?.5:0,this.minorTickInterval=le==="auto"&&this.tickInterval?this.tickInterval/L.minorTicksPerMajor:le,this.single=this.min===this.max&&k(this.min)&&!this.tickAmount&&(this.min%1==0||L.allowDecimals!==!1),X)ae=X.slice();else if(v(this.min)&&v(this.max)){if(!this.ordinal?.positions&&(this.max-this.min)/this.tickInterval>Math.max(2*this.len,200))ae=[this.min,this.max],H(19,!1,this.chart);else if(this.dateTime)ae=this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(this.tickInterval,L.units),this.min,this.max,L.startOfWeek,this.ordinal?.positions,this.closestPointRange,!0);else if(this.logarithmic)ae=this.logarithmic.getLogTickPositions(this.tickInterval,this.min,this.max);else{let me=this.tickInterval,G=me;for(;G<=2*me&&(ae=this.getLinearTickPositions(this.tickInterval,this.min,this.max),this.tickAmount&&ae.length>this.tickAmount);)this.tickInterval=V(this,G*=1.1)}ae.length>this.len&&(ae=[ae[0],ae[ae.length-1]])[0]===ae[1]&&(ae.length=1),q&&(this.tickPositions=ae,(fe=q.apply(this,[this.min,this.max]))&&(ae=fe))}this.tickPositions=ae,this.paddedTicks=ae.slice(0),this.trimTicks(ae,oe,ne),!this.isLinked&&v(this.min)&&v(this.max)&&(this.single&&ae.length<2&&!this.categories&&!this.series.some(me=>me.is("heatmap")&&me.options.pointPlacement==="between")&&(this.min-=.5,this.max+=.5),X||fe||this.adjustTickAmount()),Y(this,"afterSetTickPositions")}trimTicks(L,X,q){let le=L[0],D=L[L.length-1],F=!this.isOrdinal&&this.minPointOffset||0;if(Y(this,"trimTicks"),!this.isLinked){if(X&&le!==-1/0)this.min=le;else for(;this.min-F>L[0];)L.shift();if(q)this.max=D;else for(;this.max+F<L[L.length-1];)L.pop();L.length===0&&k(le)&&!this.options.tickPositions&&L.push((D+le)/2)}}alignToOthers(){let L,X=this,q=[this],le=X.options,D=this.chart.options.chart,F=this.coll==="yAxis"&&D.alignThresholds,oe=[];if(X.thresholdAlignment=void 0,(D.alignTicks!==!1&&le.alignTicks||F)&&le.startOnTick!==!1&&le.endOnTick!==!1&&!X.logarithmic){let ne=fe=>{let{horiz:me,options:G}=fe;return[me?G.left:G.top,G.width,G.height,G.pane].join(",")},ae=ne(this);this.chart[this.coll].forEach(function(fe){let{series:me}=fe;me.length&&me.some(G=>G.visible)&&fe!==X&&ne(fe)===ae&&(L=!0,q.push(fe))})}if(L&&F){q.forEach(ae=>{let fe=ae.getThresholdAlignment(X);v(fe)&&oe.push(fe)});let ne=oe.length>1?oe.reduce((ae,fe)=>ae+=fe,0)/oe.length:void 0;q.forEach(ae=>{ae.thresholdAlignment=ne})}return L}getThresholdAlignment(L){if((!v(this.dataMin)||this!==L&&this.series.some(X=>X.isDirty||X.isDirtyData))&&this.getSeriesExtremes(),v(this.threshold)){let X=N((this.threshold-(this.dataMin||0))/((this.dataMax||0)-(this.dataMin||0)),0,1);return this.options.reversed&&(X=1-X),X}}getTickAmount(){let L=this.options,X=L.tickPixelInterval,q=L.tickAmount;k(L.tickInterval)||q||!(this.len<X)||this.isRadial||this.logarithmic||!L.startOnTick||!L.endOnTick||(q=2),!q&&this.alignToOthers()&&(q=Math.ceil(this.len/X)+1),q<4&&(this.finalTickAmt=q,q=5),this.tickAmount=q}adjustTickAmount(){let L=this,{finalTickAmt:X,max:q,min:le,options:D,tickPositions:F,tickAmount:oe,thresholdAlignment:ne}=L,ae=F?.length,fe=h(L.threshold,L.softThreshold?0:null),me,G,se=L.tickInterval,ee,ue=()=>F.push(E(F[F.length-1]+se)),de=()=>F.unshift(E(F[0]-se));if(v(ne)&&(ee=ne<.5?Math.ceil(ne*(oe-1)):Math.floor(ne*(oe-1)),D.reversed&&(ee=oe-1-ee)),L.hasData()&&v(le)&&v(q)){let W=()=>{L.transA*=(ae-1)/(oe-1),L.min=D.startOnTick?F[0]:Math.min(le,F[0]),L.max=D.endOnTick?F[F.length-1]:Math.max(q,F[F.length-1])};if(v(ee)&&v(L.threshold)){for(;F[ee]!==fe||F.length!==oe||F[0]>le||F[F.length-1]<q;){for(F.length=0,F.push(L.threshold);F.length<oe;)F[ee]===void 0||F[ee]>L.threshold?de():ue();if(se>8*L.tickInterval)break;se*=2}W()}else if(ae<oe){for(;F.length<oe;)F.length%2||le===fe?ue():de();W()}if(k(X)){for(G=me=F.length;G--;)(X===3&&G%2==1||X<=2&&G>0&&G<me-1)&&F.splice(G,1);L.finalTickAmt=void 0}}}setScale(){let{coll:L,stacking:X}=this,q=!1,le=!1;this.series.forEach(F=>{q=q||F.isDirtyData||F.isDirty,le=le||F.xAxis&&F.xAxis.isDirty||!1}),this.setAxisSize();let D=this.len!==(this.old&&this.old.len);D||q||le||this.isLinked||this.forceRedraw||this.userMin!==(this.old&&this.old.userMin)||this.userMax!==(this.old&&this.old.userMax)||this.alignToOthers()?(X&&L==="yAxis"&&X.buildStacks(),this.forceRedraw=!1,this.userMinRange||(this.minRange=void 0),this.getSeriesExtremes(),this.setTickInterval(),X&&L==="xAxis"&&X.buildStacks(),this.isDirty||(this.isDirty=D||this.min!==this.old?.min||this.max!==this.old?.max)):X&&X.cleanStacks(),q&&this.panningState&&(this.panningState.isDirty=!0),Y(this,"afterSetScale")}setExtremes(L,X,q=!0,le,D){let F=this,oe=F.chart;F.series.forEach(ne=>{delete ne.kdTree}),Y(F,"setExtremes",D=Q(D,{min:L,max:X}),()=>{F.userMin=L,F.userMax=X,F.eventArgs=D,q&&oe.redraw(le)})}zoom(L,X){let q=this,le=this.dataMin,D=this.dataMax,F=this.options,oe=Math.min(le,h(F.min,le)),ne=Math.max(D,h(F.max,D)),ae={newMin:L,newMax:X};return Y(this,"zoom",ae,function(fe){let me=fe.newMin,G=fe.newMax;(me!==q.min||G!==q.max)&&(!q.allowZoomOutside&&(k(le)&&(me<oe&&(me=oe),me>ne&&(me=ne)),k(D)&&(G<oe&&(G=oe),G>ne&&(G=ne))),q.displayBtn=me!==void 0||G!==void 0,q.setExtremes(me,G,!1,void 0,{trigger:"zoom"})),fe.zoomed=!0}),ae.zoomed}setAxisSize(){let L=this.chart,X=this.options,q=X.offsets||[0,0,0,0],le=this.horiz,D=this.width=Math.round(m(h(X.width,L.plotWidth-q[3]+q[1]),L.plotWidth)),F=this.height=Math.round(m(h(X.height,L.plotHeight-q[0]+q[2]),L.plotHeight)),oe=this.top=Math.round(m(h(X.top,L.plotTop+q[0]),L.plotHeight,L.plotTop)),ne=this.left=Math.round(m(h(X.left,L.plotLeft+q[3]),L.plotWidth,L.plotLeft));this.bottom=L.chartHeight-F-oe,this.right=L.chartWidth-D-ne,this.len=Math.max(le?D:F,0),this.pos=le?ne:oe}getExtremes(){let L=this.logarithmic;return{min:L?E(L.lin2log(this.min)):this.min,max:L?E(L.lin2log(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}}getThreshold(L){let X=this.logarithmic,q=X?X.lin2log(this.min):this.min,le=X?X.lin2log(this.max):this.max;return L===null||L===-1/0?L=q:L===1/0?L=le:q>L?L=q:le<L&&(L=le),this.translate(L,0,1,0,1)}autoLabelAlign(L){let X=(h(L,0)-90*this.side+720)%360,q={align:"center"};return Y(this,"autoLabelAlign",q,function(le){X>15&&X<165?le.align="right":X>195&&X<345&&(le.align="left")}),q.align}tickSize(L){let X=this.options,q=h(X[L==="tick"?"tickWidth":"minorTickWidth"],L==="tick"&&this.isXAxis&&!this.categories?1:0),le=X[L==="tick"?"tickLength":"minorTickLength"],D;q&&le&&(X[L+"Position"]==="inside"&&(le=-le),D=[le,q]);let F={tickSize:D};return Y(this,"afterTickSize",F),F.tickSize}labelMetrics(){let L=this.chart.renderer,X=this.ticks,q=X[Object.keys(X)[0]]||{};return this.chart.renderer.fontMetrics(q.label||q.movedLabel||L.box)}unsquish(){let L=this.options.labels,X=this.horiz,q=this.tickInterval,le=this.len/(((this.categories?1:0)+this.max-this.min)/q),D=L.rotation,F=this.labelMetrics().h,oe=Math.max(this.max-this.min,0),ne=function(se){let ee=se/(le||1);return(ee=ee>1?Math.ceil(ee):1)*q>oe&&se!==1/0&&le!==1/0&&oe&&(ee=Math.ceil(oe/q)),E(ee*q)},ae=q,fe,me=Number.MAX_VALUE,G;if(X){if(!L.staggerLines&&(v(D)?G=[D]:le<L.autoRotationLimit&&(G=L.autoRotation)),G){let se,ee;for(let ue of G)(ue===D||ue&&ue>=-90&&ue<=90)&&(ee=(se=ne(Math.abs(F/Math.sin(O*ue))))+Math.abs(ue/360))<me&&(me=ee,fe=ue,ae=se)}}else ae=ne(.75*F);return this.autoRotation=G,this.labelRotation=h(fe,v(D)?D:0),L.step?q:ae}getSlotWidth(L){let X=this.chart,q=this.horiz,le=this.options.labels,D=Math.max(this.tickPositions.length-(this.categories?0:1),1),F=X.margin[3];if(L&&v(L.slotWidth))return L.slotWidth;if(q&&le.step<2)return le.rotation?0:(this.staggerLines||1)*this.len/D;if(!q){let oe=le.style.width;if(oe!==void 0)return parseInt(String(oe),10);if(F)return F-X.spacing[3]}return .33*X.chartWidth}renderUnsquish(){let L=this.chart,X=L.renderer,q=this.tickPositions,le=this.ticks,D=this.options.labels,F=D.style,oe=this.horiz,ne=this.getSlotWidth(),ae=Math.max(1,Math.round(ne-2*D.padding)),fe={},me=this.labelMetrics(),G=F.textOverflow,se,ee,ue=0,de,W;if(R(D.rotation)||(fe.rotation=D.rotation||0),q.forEach(function(z){let Z=le[z];Z.movedLabel&&Z.replaceMovedLabel(),Z&&Z.label&&Z.label.textPxLength>ue&&(ue=Z.label.textPxLength)}),this.maxLabelLength=ue,this.autoRotation)ue>ae&&ue>me.h?fe.rotation=this.labelRotation:this.labelRotation=0;else if(ne&&(se=ae,!G))for(ee="clip",W=q.length;!oe&&W--;)(de=le[q[W]].label)&&(de.styles&&de.styles.textOverflow==="ellipsis"?de.css({textOverflow:"clip"}):de.textPxLength>ne&&de.css({width:ne+"px"}),de.getBBox().height>this.len/q.length-(me.h-me.f)&&(de.specificTextOverflow="ellipsis"));fe.rotation&&(se=ue>.5*L.chartHeight?.33*L.chartHeight:ue,G||(ee="ellipsis")),this.labelAlign=D.align||this.autoLabelAlign(this.labelRotation),this.labelAlign&&(fe.align=this.labelAlign),q.forEach(function(z){let Z=le[z],te=Z&&Z.label,re=F.width,ce={};te&&(te.attr(fe),Z.shortenLabel?Z.shortenLabel():se&&!re&&F.whiteSpace!=="nowrap"&&(se<te.textPxLength||te.element.tagName==="SPAN")?(ce.width=se+"px",G||(ce.textOverflow=te.specificTextOverflow||ee),te.css(ce)):te.styles&&te.styles.width&&!ce.width&&!re&&te.css({width:null}),delete te.specificTextOverflow,Z.rotation=fe.rotation)},this),this.tickRotCorr=X.rotCorr(me.b,this.labelRotation||0,this.side!==0)}hasData(){return this.series.some(function(L){return L.hasData()})||this.options.showEmpty&&k(this.min)&&k(this.max)}addTitle(L){let X,q=this.chart.renderer,le=this.horiz,D=this.opposite,F=this.options,oe=F.title,ne=this.chart.styledMode;this.axisTitle||((X=oe.textAlign)||(X=(le?{low:"left",middle:"center",high:"right"}:{low:D?"right":"left",middle:"center",high:D?"left":"right"})[oe.align]),this.axisTitle=q.text(oe.text||"",0,0,oe.useHTML).attr({zIndex:7,rotation:oe.rotation||0,align:X}).addClass("highcharts-axis-title"),ne||this.axisTitle.css(f(oe.style)),this.axisTitle.add(this.axisGroup),this.axisTitle.isNew=!0),ne||oe.style.width||this.isRadial||this.axisTitle.css({width:this.len+"px"}),this.axisTitle[L?"show":"hide"](L)}generateTick(L){let X=this.ticks;X[L]?X[L].addLabel():X[L]=new c(this,L)}createGroups(){let{axisParent:L,chart:X,coll:q,options:le}=this,D=X.renderer,F=(oe,ne,ae)=>D.g(oe).attr({zIndex:ae}).addClass(`highcharts-${q.toLowerCase()}${ne} `+(this.isRadial?`highcharts-radial-axis${ne} `:"")+(le.className||"")).add(L);this.axisGroup||(this.gridGroup=F("grid","-grid",le.gridZIndex),this.axisGroup=F("axis","",le.zIndex),this.labelGroup=F("axis-labels","-labels",le.labels.zIndex))}getOffset(){let L=this,{chart:X,horiz:q,options:le,side:D,ticks:F,tickPositions:oe,coll:ne}=L,ae=X.inverted&&!L.isZAxis?[1,0,3,2][D]:D,fe=L.hasData(),me=le.title,G=le.labels,se=v(le.crossing),ee=X.axisOffset,ue=X.clipOffset,de=[-1,1,1,-1][D],W,z=0,Z,te=0,re=0,ce,Ce;if(L.showAxis=W=fe||le.showEmpty,L.staggerLines=L.horiz&&G.staggerLines||void 0,L.createGroups(),fe||L.isLinked?(oe.forEach(function(ge){L.generateTick(ge)}),L.renderUnsquish(),L.reserveSpaceDefault=D===0||D===2||{1:"left",3:"right"}[D]===L.labelAlign,h(G.reserveSpace,!se&&null,L.labelAlign==="center"||null,L.reserveSpaceDefault)&&oe.forEach(function(ge){re=Math.max(F[ge].getLabelSize(),re)}),L.staggerLines&&(re*=L.staggerLines),L.labelOffset=re*(L.opposite?-1:1)):b(F,function(ge,ye){ge.destroy(),delete F[ye]}),me?.text&&me.enabled!==!1&&(L.addTitle(W),W&&!se&&me.reserveSpace!==!1&&(L.titleOffset=z=L.axisTitle.getBBox()[q?"height":"width"],te=k(Z=me.offset)?0:h(me.margin,q?5:10))),L.renderLine(),L.offset=de*h(le.offset,ee[D]?ee[D]+(le.margin||0):0),L.tickRotCorr=L.tickRotCorr||{x:0,y:0},Ce=D===0?-L.labelMetrics().h:D===2?L.tickRotCorr.y:0,ce=Math.abs(re)+te,re&&(ce-=Ce,ce+=de*(q?h(G.y,L.tickRotCorr.y+de*G.distance):h(G.x,de*G.distance))),L.axisTitleMargin=h(Z,ce),L.getMaxLabelDimensions&&(L.maxLabelDimensions=L.getMaxLabelDimensions(F,oe)),ne!=="colorAxis"){let ge=this.tickSize("tick");ee[D]=Math.max(ee[D],(L.axisTitleMargin||0)+z+de*L.offset,ce,oe&&oe.length&&ge?ge[0]+de*L.offset:0);let ye=!L.axisLine||le.offset?0:2*Math.floor(L.axisLine.strokeWidth()/2);ue[ae]=Math.max(ue[ae],ye)}Y(this,"afterGetOffset")}getLinePath(L){let X=this.chart,q=this.opposite,le=this.offset,D=this.horiz,F=this.left+(q?this.width:0)+le,oe=X.chartHeight-this.bottom-(q?this.height:0)+le;return q&&(L*=-1),X.renderer.crispLine([["M",D?this.left:F,D?oe:this.top],["L",D?X.chartWidth-this.right:F,D?oe:X.chartHeight-this.bottom]],L)}renderLine(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.chart.styledMode||this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))}getTitlePosition(L){let X=this.horiz,q=this.left,le=this.top,D=this.len,F=this.options.title,oe=X?q:le,ne=this.opposite,ae=this.offset,fe=F.x,me=F.y,G=this.chart.renderer.fontMetrics(L),se=L?Math.max(L.getBBox(!1,0).height-G.h-1,0):0,ee={low:oe+(X?0:D),middle:oe+D/2,high:oe+(X?D:0)}[F.align],ue=(X?le+this.height:q)+(X?1:-1)*(ne?-1:1)*(this.axisTitleMargin||0)+[-se,se,G.f,-se][this.side],de={x:X?ee+fe:ue+(ne?this.width:0)+ae+fe,y:X?ue+me-(ne?this.height:0)+ae:ee+me};return Y(this,"afterGetTitlePosition",{titlePosition:de}),de}renderMinorTick(L,X){let q=this.minorTicks;q[L]||(q[L]=new c(this,L,"minor")),X&&q[L].isNew&&q[L].render(null,!0),q[L].render(null,!1,1)}renderTick(L,X,q){let le=this.isLinked,D=this.ticks;(!le||L>=this.min&&L<=this.max||this.grid&&this.grid.isColumn)&&(D[L]||(D[L]=new c(this,L)),q&&D[L].isNew&&D[L].render(X,!0,-1),D[L].render(X))}render(){let L,X,q=this,le=q.chart,D=q.logarithmic,F=le.renderer,oe=q.options,ne=q.isLinked,ae=q.tickPositions,fe=q.axisTitle,me=q.ticks,G=q.minorTicks,se=q.alternateBands,ee=oe.stackLabels,ue=oe.alternateGridColor,de=oe.crossing,W=q.tickmarkOffset,z=q.axisLine,Z=q.showAxis,te=g(F.globalAnimation);if(q.labelEdge.length=0,q.overlap=!1,[me,G,se].forEach(function(re){b(re,function(ce){ce.isActive=!1})}),v(de)){let re=this.isXAxis?le.yAxis[0]:le.xAxis[0],ce=[1,-1,-1,1][this.side];if(re){let Ce=re.toPixels(de,!0);q.horiz&&(Ce=re.len-Ce),q.offset=ce*Ce}}if(q.hasData()||ne){let re=q.chart.hasRendered&&q.old&&v(q.old.min);q.minorTickInterval&&!q.categories&&q.getMinorTickPositions().forEach(function(ce){q.renderMinorTick(ce,re)}),ae.length&&(ae.forEach(function(ce,Ce){q.renderTick(ce,Ce,re)}),W&&(q.min===0||q.single)&&(me[-1]||(me[-1]=new c(q,-1,null,!0)),me[-1].render(-1))),ue&&ae.forEach(function(ce,Ce){X=ae[Ce+1]!==void 0?ae[Ce+1]+W:q.max-W,Ce%2==0&&ce<q.max&&X<=q.max+(le.polar?-W:W)&&(se[ce]||(se[ce]=new l.PlotLineOrBand(q,{})),L=ce+W,se[ce].options={from:D?D.lin2log(L):L,to:D?D.lin2log(X):X,color:ue,className:"highcharts-alternate-grid"},se[ce].render(),se[ce].isActive=!0)}),q._addedPlotLB||(q._addedPlotLB=!0,(oe.plotLines||[]).concat(oe.plotBands||[]).forEach(function(ce){q.addPlotBandOrLine(ce)}))}[me,G,se].forEach(function(re){let ce=[],Ce=te.duration;b(re,function(ge,ye){ge.isActive||(ge.render(ye,!1,0),ge.isActive=!1,ce.push(ye))}),B(function(){let ge=ce.length;for(;ge--;)re[ce[ge]]&&!re[ce[ge]].isActive&&(re[ce[ge]].destroy(),delete re[ce[ge]])},re!==se&&le.hasRendered&&Ce?Ce:0)}),z&&(z[z.isPlaced?"animate":"attr"]({d:this.getLinePath(z.strokeWidth())}),z.isPlaced=!0,z[Z?"show":"hide"](Z)),fe&&Z&&(fe[fe.isNew?"attr":"animate"](q.getTitlePosition(fe)),fe.isNew=!1),ee&&ee.enabled&&q.stacking&&q.stacking.renderStackTotals(),q.old={len:q.len,max:q.max,min:q.min,transA:q.transA,userMax:q.userMax,userMin:q.userMin},q.isDirty=!1,Y(this,"afterRender")}redraw(){this.visible&&(this.render(),this.plotLinesAndBands.forEach(function(L){L.render()})),this.series.forEach(function(L){L.isDirty=!0})}getKeepProps(){return this.keepProps||U.keepProps}destroy(L){let X=this,q=X.plotLinesAndBands,le=this.eventOptions;if(Y(this,"destroy",{keepEvents:L}),L||x(X),[X.ticks,X.minorTicks,X.alternateBands].forEach(function(D){ie(D)}),q){let D=q.length;for(;D--;)q[D].destroy()}for(let D in["axisLine","axisTitle","axisGroup","gridGroup","labelGroup","cross","scrollbar"].forEach(function(F){X[F]&&(X[F]=X[F].destroy())}),X.plotLinesAndBandsGroups)X.plotLinesAndBandsGroups[D]=X.plotLinesAndBandsGroups[D].destroy();b(X,function(D,F){X.getKeepProps().indexOf(F)===-1&&delete X[F]}),this.eventOptions=le}drawCrosshair(L,X){let q=this.crosshair,le=h(q&&q.snap,!0),D=this.chart,F,oe,ne,ae=this.cross,fe;if(Y(this,"drawCrosshair",{e:L,point:X}),L||(L=this.cross&&this.cross.e),q&&(k(X)||!le)!==!1){if(le?k(X)&&(oe=h(this.coll!=="colorAxis"?X.crosshairPos:null,this.isXAxis?X.plotX:this.len-X.plotY)):oe=L&&(this.horiz?L.chartX-this.pos:this.len-L.chartY+this.pos),k(oe)&&(fe={value:X&&(this.isXAxis?X.x:h(X.stackY,X.y)),translatedValue:oe},D.polar&&Q(fe,{isCrosshair:!0,chartX:L&&L.chartX,chartY:L&&L.chartY,point:X}),F=this.getPlotLinePath(fe)||null),!k(F)){this.hideCrosshair();return}ne=this.categories&&!this.isRadial,ae||(this.cross=ae=D.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(ne?"category ":"thin ")+(q.className||"")).attr({zIndex:h(q.zIndex,2)}).add(),!D.styledMode&&(ae.attr({stroke:q.color||(ne?r.parse("#ccd3ff").setOpacity(.25).get():"#cccccc"),"stroke-width":h(q.width,1)}).css({"pointer-events":"none"}),q.dashStyle&&ae.attr({dashstyle:q.dashStyle}))),ae.show().attr({d:F}),ne&&!q.width&&ae.attr({"stroke-width":this.transA}),this.cross.e=L}else this.hideCrosshair();Y(this,"afterDrawCrosshair",{e:L,point:X})}hideCrosshair(){this.cross&&this.cross.hide(),Y(this,"afterHideCrosshair")}hasVerticalPanning(){let L=this.chart.options.chart.panning;return!!(L&&L.enabled&&/y/.test(L.type))}update(L,X){let q=this.chart;L=f(this.userOptions,L),this.destroy(!0),this.init(q,L),q.isDirtyBox=!0,h(X,!0)&&q.redraw()}remove(L){let X=this.chart,q=this.coll,le=this.series,D=le.length;for(;D--;)le[D]&&le[D].remove(!1);$(X.axes,this),$(X[q]||[],this),X.orderItems(q),this.destroy(),X.isDirtyBox=!0,h(L,!0)&&X.redraw()}setTitle(L,X){this.update({title:L},X)}setCategories(L,X){this.update({categories:L},X)}}return U.keepProps=["coll","extKey","hcEvents","names","series","userMax","userMin"],U}),t(e,"Core/Axis/DateTimeAxis.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s){var r;let{composed:n}=i,{addEvent:a,getMagnitude:l,normalizeTickInterval:c,pushUnique:u,timeUnits:g}=s;return function(p){function C(){return this.chart.time.getTimeTicks.apply(this.chart.time,arguments)}function y(){if(this.options.type!=="datetime"){this.dateTime=void 0;return}this.dateTime||(this.dateTime=new S(this))}p.compose=function O(M){if(u(n,O)){M.keepProps.push("dateTime");let _=M.prototype;_.getTimeTicks=C,a(M,"afterSetOptions",y)}return M};class S{constructor(M){this.axis=M}normalizeTimeTickInterval(M,_){let N=_||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],E=N[N.length-1],k=g[E[0]],ie=E[1],$;for($=0;$<N.length;$++)if(k=g[(E=N[$])[0]],ie=E[1],N[$+1]){let Q=(k*ie[ie.length-1]+g[N[$+1][0]])/2;if(M<=Q)break}k===g.year&&M<5*k&&(ie=[1,2,5]);let H=c(M/k,ie,E[0]==="year"?Math.max(l(M/k),1):1);return{unitRange:k,count:H,unitName:E[0]}}getXDateFormat(M,_){let{axis:N}=this,E=N.chart.time;return N.closestPointRange?E.getDateFormat(N.closestPointRange,M,N.options.startOfWeek,_)||E.resolveDTLFormat(_.year).main:E.resolveDTLFormat(_.day).main}}p.Additions=S}(r||(r={})),r}),t(e,"Core/Axis/LogarithmicAxis.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s){var r;let{composed:n}=i,{addEvent:a,normalizeTickInterval:l,pick:c,pushUnique:u}=s;return function(g){function p(S){let O=S.userOptions,M=this.logarithmic;O.type!=="logarithmic"?this.logarithmic=void 0:M||(M=this.logarithmic=new y(this))}function C(){let S=this.logarithmic;S&&(this.lin2val=function(O){return S.lin2log(O)},this.val2lin=function(O){return S.log2lin(O)})}g.compose=function S(O){return u(n,S)&&(O.keepProps.push("logarithmic"),a(O,"init",p),a(O,"afterInit",C)),O};class y{constructor(O){this.axis=O}getLogTickPositions(O,M,_,N){let E=this.axis,k=E.len,ie=E.options,$=[];if(N||(this.minorAutoInterval=void 0),O>=.5)O=Math.round(O),$=E.getLinearTickPositions(O,M,_);else if(O>=.08){let H,Q,Y,P,j,A,v,R=Math.floor(M);for(H=O>.3?[1,2,4]:O>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9],Q=R;Q<_+1&&!v;Q++)for(Y=0,P=H.length;Y<P&&!v;Y++)(j=this.log2lin(this.lin2log(Q)*H[Y]))>M&&(!N||A<=_)&&A!==void 0&&$.push(A),A>_&&(v=!0),A=j}else{let H=this.lin2log(M),Q=this.lin2log(_),Y=N?E.getMinorTickInterval():ie.tickInterval,P=Y==="auto"?null:Y,j=ie.tickPixelInterval/(N?5:1),A=N?k/E.tickPositions.length:k;O=l(O=c(P,this.minorAutoInterval,(Q-H)*j/(A||1))),$=E.getLinearTickPositions(O,H,Q).map(this.log2lin),N||(this.minorAutoInterval=O/5)}return N||(E.tickInterval=O),$}lin2log(O){return Math.pow(10,O)}log2lin(O){return Math.log(O)/Math.LN10}}g.Additions=y}(r||(r={})),r}),t(e,"Core/Axis/PlotLineOrBand/PlotLineOrBandAxis.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s){var r;let{composed:n}=i,{erase:a,extend:l,isNumber:c,pushUnique:u}=s;return function(g){let p;function C(E){return this.addPlotBandOrLine(E,"plotBands")}function y(E,k){let ie=this.userOptions,$=new p(this,E);if(this.visible&&($=$.render()),$){if(this._addedPlotLB||(this._addedPlotLB=!0,(ie.plotLines||[]).concat(ie.plotBands||[]).forEach(H=>{this.addPlotBandOrLine(H)})),k){let H=ie[k]||[];H.push(E),ie[k]=H}this.plotLinesAndBands.push($)}return $}function S(E){return this.addPlotBandOrLine(E,"plotLines")}function O(E,k,ie){ie=ie||this.options;let $=this.getPlotLinePath({value:k,force:!0,acrossPanes:ie.acrossPanes}),H=[],Q=this.horiz,Y=!c(this.min)||!c(this.max)||E<this.min&&k<this.min||E>this.max&&k>this.max,P=this.getPlotLinePath({value:E,force:!0,acrossPanes:ie.acrossPanes}),j,A=1,v;if(P&&$)for(Y&&(v=P.toString()===$.toString(),A=0),j=0;j<P.length;j+=2){let R=P[j],f=P[j+1],w=$[j],b=$[j+1];(R[0]==="M"||R[0]==="L")&&(f[0]==="M"||f[0]==="L")&&(w[0]==="M"||w[0]==="L")&&(b[0]==="M"||b[0]==="L")&&(Q&&w[1]===R[1]?(w[1]+=A,b[1]+=A):Q||w[2]!==R[2]||(w[2]+=A,b[2]+=A),H.push(["M",R[1],R[2]],["L",f[1],f[2]],["L",b[1],b[2]],["L",w[1],w[2]],["Z"])),H.isFlat=v}return H}function M(E){this.removePlotBandOrLine(E)}function _(E){let k=this.plotLinesAndBands,ie=this.options,$=this.userOptions;if(k){let H=k.length;for(;H--;)k[H].id===E&&k[H].destroy();[ie.plotLines||[],$.plotLines||[],ie.plotBands||[],$.plotBands||[]].forEach(function(Q){for(H=Q.length;H--;)(Q[H]||{}).id===E&&a(Q,Q[H])})}}function N(E){this.removePlotBandOrLine(E)}g.compose=function E(k,ie){return u(n,E)&&(p=k,l(ie.prototype,{addPlotBand:C,addPlotLine:S,addPlotBandOrLine:y,getPlotBandPath:O,removePlotBand:M,removePlotLine:N,removePlotBandOrLine:_})),ie}}(r||(r={})),r}),t(e,"Core/Axis/PlotLineOrBand/PlotLineOrBand.js",[e["Core/Axis/PlotLineOrBand/PlotLineOrBandAxis.js"],e["Core/Utilities.js"]],function(i,s){let{arrayMax:r,arrayMin:n,defined:a,destroyObjectProperties:l,erase:c,fireEvent:u,merge:g,objectEach:p,pick:C}=s;class y{static compose(O){return i.compose(y,O)}constructor(O,M){this.axis=O,this.options=M,this.id=M.id}render(){u(this,"render");let{axis:O,options:M}=this,{horiz:_,logarithmic:N}=O,{color:E,events:k,zIndex:ie=0}=M,$={},H=O.chart.renderer,Q=M.to,Y=M.from,P=M.value,j=M.borderWidth,A=M.label,{label:v,svgElem:R}=this,f=[],w,b=a(Y)&&a(Q),h=a(P),m=!R,x={class:"highcharts-plot-"+(b?"band ":"line ")+(M.className||"")},I=b?"bands":"lines";if(!O.chart.styledMode&&(h?(x.stroke=E||"#999999",x["stroke-width"]=C(M.width,1),M.dashStyle&&(x.dashstyle=M.dashStyle)):b&&(x.fill=E||"#e6e9ff",j&&(x.stroke=M.borderColor,x["stroke-width"]=j))),$.zIndex=ie,I+="-"+ie,(w=O.plotLinesAndBandsGroups[I])||(O.plotLinesAndBandsGroups[I]=w=H.g("plot-"+I).attr($).add()),R||(this.svgElem=R=H.path().attr(x).add(w)),a(P))f=O.getPlotLinePath({value:N?.log2lin(P)??P,lineWidth:R.strokeWidth(),acrossPanes:M.acrossPanes});else{if(!(a(Y)&&a(Q)))return;f=O.getPlotBandPath(N?.log2lin(Y)??Y,N?.log2lin(Q)??Q,M)}return!this.eventsAdded&&k&&(p(k,(B,V)=>{R?.on(V,function(U){k[V].apply(this,[U])})}),this.eventsAdded=!0),(m||!R.d)&&f?.length?R.attr({d:f}):R&&(f?(R.show(),R.animate({d:f})):R.d&&(R.hide(),v&&(this.label=v=v.destroy()))),A&&(a(A.text)||a(A.formatter))&&f?.length&&O.width>0&&O.height>0&&!f.isFlat?(A=g({align:_&&b&&"center",x:_?!b&&4:10,verticalAlign:!_&&b&&"middle",y:_?b?16:10:b?6:-4,rotation:_&&!b&&90},A),this.renderLabel(A,f,b,ie)):v&&v.hide(),this}renderLabel(O,M,_,N){let E=this.axis,k=E.chart.renderer,ie=this.label;ie||(this.label=ie=k.text(this.getLabelText(O),0,0,O.useHTML).attr({align:O.textAlign||O.align,rotation:O.rotation,class:"highcharts-plot-"+(_?"band":"line")+"-label"+(O.className||""),zIndex:N}),E.chart.styledMode||ie.css(g({fontSize:"0.8em",textOverflow:"ellipsis"},O.style)),ie.add());let $=M.xBounds||[M[0][1],M[1][1],_?M[2][1]:M[0][1]],H=M.yBounds||[M[0][2],M[1][2],_?M[2][2]:M[0][2]],Q=n($),Y=n(H);if(ie.align(O,!1,{x:Q,y:Y,width:r($)-Q,height:r(H)-Y}),!ie.alignValue||ie.alignValue==="left"){let P=O.clip?E.width:E.chart.chartWidth;ie.css({width:(ie.rotation===90?E.height-(ie.alignAttr.y-E.top):P-(ie.alignAttr.x-E.left))+"px"})}ie.show(!0)}getLabelText(O){return a(O.formatter)?O.formatter.call(this):O.text}destroy(){c(this.axis.plotLinesAndBands,this),delete this.axis,l(this)}}return y}),t(e,"Core/Tooltip.js",[e["Core/Templating.js"],e["Core/Globals.js"],e["Core/Renderer/RendererUtilities.js"],e["Core/Renderer/RendererRegistry.js"],e["Core/Utilities.js"]],function(i,s,r,n,a){var l;let{format:c}=i,{composed:u,doc:g,isSafari:p}=s,{distribute:C}=r,{addEvent:y,clamp:S,css:O,discardElement:M,extend:_,fireEvent:N,isArray:E,isNumber:k,isString:ie,merge:$,pick:H,pushUnique:Q,splat:Y,syncTimeout:P}=a;class j{constructor(v,R){this.allowShared=!0,this.crosshairs=[],this.distance=0,this.isHidden=!0,this.isSticky=!1,this.now={},this.options={},this.outside=!1,this.chart=v,this.init(v,R)}bodyFormatter(v){return v.map(function(R){let f=R.series.tooltipOptions;return(f[(R.point.formatPrefix||"point")+"Formatter"]||R.point.tooltipFormatter).call(R.point,f[(R.point.formatPrefix||"point")+"Format"]||"")})}cleanSplit(v){this.chart.series.forEach(function(R){let f=R&&R.tt;f&&(!f.isActive||v?R.tt=f.destroy():f.isActive=!1)})}defaultFormatter(v){let R,f=this.points||Y(this);return(R=(R=[v.tooltipFooterHeaderFormatter(f[0])]).concat(v.bodyFormatter(f))).push(v.tooltipFooterHeaderFormatter(f[0],!0)),R}destroy(){this.label&&(this.label=this.label.destroy()),this.split&&(this.cleanSplit(!0),this.tt&&(this.tt=this.tt.destroy())),this.renderer&&(this.renderer=this.renderer.destroy(),M(this.container)),a.clearTimeout(this.hideTimer),a.clearTimeout(this.tooltipTimeout)}getAnchor(v,R){let f,w=this.chart,b=w.pointer,h=w.inverted,m=w.plotTop,x=w.plotLeft;if((v=Y(v))[0].series&&v[0].series.yAxis&&!v[0].series.yAxis.options.reversedStacks&&(v=v.slice().reverse()),this.followPointer&&R)R.chartX===void 0&&(R=b.normalize(R)),f=[R.chartX-x,R.chartY-m];else if(v[0].tooltipPos)f=v[0].tooltipPos;else{let I=0,B=0;v.forEach(function(V){let U=V.pos(!0);U&&(I+=U[0],B+=U[1])}),I/=v.length,B/=v.length,this.shared&&v.length>1&&R&&(h?I=R.chartX:B=R.chartY),f=[I-x,B-m]}return f.map(Math.round)}getClassName(v,R,f){let w=this.options,b=v.series,h=b.options;return[w.className,"highcharts-label",f&&"highcharts-tooltip-header",R?"highcharts-tooltip-box":"highcharts-tooltip",!f&&"highcharts-color-"+H(v.colorIndex,b.colorIndex),h&&h.className].filter(ie).join(" ")}getLabel(){let v=this,R=this.chart.styledMode,f=this.options,w=this.split&&this.allowShared,b=this.container,h=this.chart.renderer;if(this.label){let m=!this.label.hasClass("highcharts-label");(!w&&m||w&&!m)&&this.destroy()}if(!this.label){if(this.outside){let m=this.chart.options.chart.style,x=n.getRendererType();this.container=b=s.doc.createElement("div"),b.className="highcharts-tooltip-container",O(b,{position:"absolute",top:"1px",pointerEvents:"none",zIndex:Math.max(this.options.style.zIndex||0,(m&&m.zIndex||0)+3)}),this.renderer=h=new x(b,0,0,m,void 0,void 0,h.styledMode)}if(w?this.label=h.g("tooltip"):(this.label=h.label("",0,0,f.shape,void 0,void 0,f.useHTML,void 0,"tooltip").attr({padding:f.padding,r:f.borderRadius}),R||this.label.attr({fill:f.backgroundColor,"stroke-width":f.borderWidth||0}).css(f.style).css({pointerEvents:f.style.pointerEvents||(this.shouldStickOnContact()?"auto":"none")})),v.outside){let m=this.label,{xSetter:x,ySetter:I}=m;m.xSetter=function(B){x.call(m,v.distance),b&&(b.style.left=B+"px")},m.ySetter=function(B){I.call(m,v.distance),b&&(b.style.top=B+"px")}}this.label.attr({zIndex:8}).shadow(f.shadow).add()}return b&&!b.parentElement&&s.doc.body.appendChild(b),this.label}getPlayingField(){let{body:v,documentElement:R}=g,{chart:f,distance:w,outside:b}=this;return{width:b?Math.max(v.scrollWidth,R.scrollWidth,v.offsetWidth,R.offsetWidth,R.clientWidth)-2*w:f.chartWidth,height:b?Math.max(v.scrollHeight,R.scrollHeight,v.offsetHeight,R.offsetHeight,R.clientHeight):f.chartHeight}}getPosition(v,R,f){let{distance:w,chart:b,outside:h}=this,{inverted:m,plotLeft:x,plotTop:I,polar:B}=b,{plotX:V=0,plotY:U=0}=f,K={},L=m&&f.h||0,{height:X,width:q}=this.getPlayingField(),le=b.pointer.getChartPosition(),D=W=>W*le.scaleX,F=W=>W*le.scaleY,oe=W=>{let z=W==="x";return[W,z?q:X,z?v:R].concat(h?[z?D(v):F(R),z?le.left-w+D(V+x):le.top-w+F(U+I),0,z?q:X]:[z?v:R,z?V+x:U+I,z?x:I,z?x+b.plotWidth:I+b.plotHeight])},ne=oe("y"),ae=oe("x"),fe,me=!!f.negative;!B&&b.hoverSeries?.yAxis?.reversed&&(me=!me);let G=!this.followPointer&&H(f.ttBelow,!B&&!m===me),se=function(W,z,Z,te,re,ce,Ce){let ge=h?W==="y"?F(w):D(w):w,ye=(Z-te)/2,Ee=te<re-w,Se=re+w+te<z,be=re-ge-Z+ye,Re=re+ge-ye;if(G&&Se)K[W]=Re;else if(!G&&Ee)K[W]=be;else if(Ee)K[W]=Math.min(Ce-te,be-L<0?be:be-L);else{if(!Se)return!1;K[W]=Math.max(ce,Re+L+Z>z?Re:Re+L)}},ee=function(W,z,Z,te,re){if(re<w||re>z-w)return!1;re<Z/2?K[W]=1:re>z-te/2?K[W]=z-te-2:K[W]=re-Z/2},ue=function(W){[ne,ae]=[ae,ne],fe=W},de=()=>{se.apply(0,ne)!==!1?ee.apply(0,ae)!==!1||fe||(ue(!0),de()):fe?K.x=K.y=0:(ue(!0),de())};return(m&&!B||this.len>1)&&ue(),de(),K}hide(v){let R=this;a.clearTimeout(this.hideTimer),v=H(v,this.options.hideDelay),this.isHidden||(this.hideTimer=P(function(){let f=R.getLabel();R.getLabel().animate({opacity:0},{duration:v&&150,complete:()=>{f.hide(),R.container&&R.container.remove()}}),R.isHidden=!0},v))}init(v,R){this.chart=v,this.options=R,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.split=R.split&&!v.inverted&&!v.polar,this.shared=R.shared||this.split,this.outside=H(R.outside,!!(v.scrollablePixelsX||v.scrollablePixelsY))}shouldStickOnContact(v){return!!(!this.followPointer&&this.options.stickOnContact&&(!v||this.chart.pointer.inClass(v.target,"highcharts-tooltip")))}move(v,R,f,w){let b=this,h=b.now,m=b.options.animation!==!1&&!b.isHidden&&(Math.abs(v-h.x)>1||Math.abs(R-h.y)>1),x=b.followPointer||b.len>1;_(h,{x:m?(2*h.x+v)/3:v,y:m?(h.y+R)/2:R,anchorX:x?void 0:m?(2*h.anchorX+f)/3:f,anchorY:x?void 0:m?(h.anchorY+w)/2:w}),b.getLabel().attr(h),b.drawTracker(),m&&(a.clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){b&&b.move(v,R,f,w)},32))}refresh(v,R){let f=this.chart,w=this.options,b=f.pointer,h=Y(v),m=h[0],x=[],I=w.format,B=w.formatter||this.defaultFormatter,V=this.shared,U=f.styledMode,K={};if(!w.enabled||!m.series)return;a.clearTimeout(this.hideTimer),this.allowShared=!(!E(v)&&v.series&&v.series.noSharedTooltip),this.followPointer=!this.split&&m.series.tooltipOptions.followPointer;let L=this.getAnchor(v,R),X=L[0],q=L[1];V&&this.allowShared?(b.applyInactiveState(h),h.forEach(function(F){F.setState("hover"),x.push(F.getLabelConfig())}),(K=m.getLabelConfig()).points=x):K=m.getLabelConfig(),this.len=x.length;let le=ie(I)?c(I,K,f):B.call(K,this),D=m.series;if(this.distance=H(D.tooltipOptions.distance,16),le===!1)this.hide();else{if(this.split&&this.allowShared)this.renderSplit(le,h);else{let F=X,oe=q;if(R&&b.isDirectTouch&&(F=R.chartX-f.plotLeft,oe=R.chartY-f.plotTop),f.polar||D.options.clip===!1||h.some(ne=>b.isDirectTouch||ne.series.shouldShowTooltip(F,oe))){let ne=this.getLabel();(!w.style.width||U)&&ne.css({width:(this.outside?this.getPlayingField():f.spacingBox).width+"px"}),ne.attr({text:le&&le.join?le.join(""):le}),ne.addClass(this.getClassName(m),!0),U||ne.attr({stroke:w.borderColor||m.color||D.color||"#666666"}),this.updatePosition({plotX:X,plotY:q,negative:m.negative,ttBelow:m.ttBelow,h:L[2]||0})}else{this.hide();return}}this.isHidden&&this.label&&this.label.attr({opacity:1}).show(),this.isHidden=!1}N(this,"refresh")}renderSplit(v,R){let f=this,{chart:w,chart:{chartWidth:b,chartHeight:h,plotHeight:m,plotLeft:x,plotTop:I,pointer:B,scrollablePixelsY:V=0,scrollablePixelsX:U,scrollingContainer:{scrollLeft:K,scrollTop:L}={scrollLeft:0,scrollTop:0},styledMode:X},distance:q,options:le,options:{positioner:D}}=f,F=f.outside&&typeof U!="number"?g.documentElement.getBoundingClientRect():{left:K,right:K+b,top:L,bottom:L+h},oe=f.getLabel(),ne=this.renderer||w.renderer,ae=!!(w.xAxis[0]&&w.xAxis[0].opposite),{left:fe,top:me}=B.getChartPosition(),G=I+L,se=0,ee=m-V;function ue(re,ce,Ce,ge,ye=!0){let Ee,Se;return Ce?(Ee=ae?0:ee,Se=S(re-ge/2,F.left,F.right-ge-(f.outside?fe:0))):(Ee=ce-G,Se=S(Se=ye?re-ge-q:re+q,ye?Se:F.left,F.right)),{x:Se,y:Ee}}ie(v)&&(v=[!1,v]);let de=v.slice(0,R.length+1).reduce(function(re,ce,Ce){if(ce!==!1&&ce!==""){let ge=R[Ce-1]||{isHeader:!0,plotX:R[0].plotX,plotY:m,series:{}},ye=ge.isHeader,Ee=ye?f:ge.series,Se=Ee.tt=function(Me,Ze,it){let rt=Me,{isHeader:It,series:wt}=Ze;if(!rt){let ct={padding:le.padding,r:le.borderRadius};X||(ct.fill=le.backgroundColor,ct["stroke-width"]=le.borderWidth??1),rt=ne.label("",0,0,le[It?"headerShape":"shape"],void 0,void 0,le.useHTML).addClass(f.getClassName(Ze,!0,It)).attr(ct).add(oe)}return rt.isActive=!0,rt.attr({text:it}),X||rt.css(le.style).attr({stroke:le.borderColor||Ze.color||wt.color||"#333333"}),rt}(Ee.tt,ge,ce.toString()),be=Se.getBBox(),Re=be.width+Se.strokeWidth();ye&&(se=be.height,ee+=se,ae&&(G-=se));let{anchorX:Ae,anchorY:Ne}=function(Me){let Ze,it,{isHeader:rt,plotX:It=0,plotY:wt=0,series:ct}=Me;if(rt)Ze=Math.max(x+It,x),it=I+m/2;else{let{xAxis:qe,yAxis:wi}=ct;Ze=qe.pos+S(It,-q,qe.len+q),ct.shouldShowTooltip(0,wi.pos-I+wt,{ignoreX:!0})&&(it=wi.pos+wt)}return{anchorX:Ze=S(Ze,F.left-q,F.right+q),anchorY:it}}(ge);if(typeof Ne=="number"){let Me=be.height+1,Ze=D?D.call(f,Re,Me,ge):ue(Ae,Ne,ye,Re);re.push({align:D?0:void 0,anchorX:Ae,anchorY:Ne,boxWidth:Re,point:ge,rank:H(Ze.rank,ye?1:0),size:Me,target:Ze.y,tt:Se,x:Ze.x})}else Se.isActive=!1}return re},[]);!D&&de.some(re=>{let{outside:ce}=f,Ce=(ce?fe:0)+re.anchorX;return Ce<F.left&&Ce+re.boxWidth<F.right||Ce<fe-F.left+re.boxWidth&&F.right-Ce>Ce})&&(de=de.map(re=>{let{x:ce,y:Ce}=ue(re.anchorX,re.anchorY,re.point.isHeader,re.boxWidth,!1);return _(re,{target:Ce,x:ce})})),f.cleanSplit(),C(de,ee);let W={left:fe,right:fe};de.forEach(function(re){let{x:ce,boxWidth:Ce,isHeader:ge}=re;!ge&&(f.outside&&fe+ce<W.left&&(W.left=fe+ce),!ge&&f.outside&&W.left+Ce>W.right&&(W.right=fe+ce))}),de.forEach(function(re){let{x:ce,anchorX:Ce,anchorY:ge,pos:ye,point:{isHeader:Ee}}=re,Se={visibility:ye===void 0?"hidden":"inherit",x:ce,y:(ye||0)+G,anchorX:Ce,anchorY:ge};if(f.outside&&ce<Ce){let be=fe-W.left;be>0&&(Ee||(Se.x=ce+be,Se.anchorX=Ce+be),Ee&&(Se.x=(W.right-W.left)/2,Se.anchorX=Ce+be))}re.tt.attr(Se)});let{container:z,outside:Z,renderer:te}=f;if(Z&&z&&te){let{width:re,height:ce,x:Ce,y:ge}=oe.getBBox();te.setSize(re+Ce,ce+ge,!1),z.style.left=W.left+"px",z.style.top=me+"px"}p&&oe.attr({opacity:oe.opacity===1?.999:1})}drawTracker(){if(!this.shouldStickOnContact()){this.tracker&&(this.tracker=this.tracker.destroy());return}let v=this.chart,R=this.label,f=this.shared?v.hoverPoints:v.hoverPoint;if(!R||!f)return;let w={x:0,y:0,width:0,height:0},b=this.getAnchor(f),h=R.getBBox();b[0]+=v.plotLeft-(R.translateX||0),b[1]+=v.plotTop-(R.translateY||0),w.x=Math.min(0,b[0]),w.y=Math.min(0,b[1]),w.width=b[0]<0?Math.max(Math.abs(b[0]),h.width-b[0]):Math.max(Math.abs(b[0]),h.width),w.height=b[1]<0?Math.max(Math.abs(b[1]),h.height-Math.abs(b[1])):Math.max(Math.abs(b[1]),h.height),this.tracker?this.tracker.attr(w):(this.tracker=R.renderer.rect(w).addClass("highcharts-tracker").add(R),v.styledMode||this.tracker.attr({fill:"rgba(0,0,0,0)"}))}styledModeFormat(v){return v.replace('style="font-size: 0.8em"','class="highcharts-header"').replace(/style="color:{(point|series)\.color}"/g,'class="highcharts-color-{$1.colorIndex} {series.options.className} {point.options.className}"')}tooltipFooterHeaderFormatter(v,R){let f=v.series,w=f.tooltipOptions,b=f.xAxis,h=b&&b.dateTime,m={isFooter:R,labelConfig:v},x=w.xDateFormat,I=w[R?"footerFormat":"headerFormat"];return N(this,"headerFormatter",m,function(B){h&&!x&&k(v.key)&&(x=h.getXDateFormat(v.key,w.dateTimeLabelFormats)),h&&x&&(v.point&&v.point.tooltipDateKeys||["key"]).forEach(function(V){I=I.replace("{point."+V+"}","{point."+V+":"+x+"}")}),f.chart.styledMode&&(I=this.styledModeFormat(I)),B.text=c(I,{point:v,series:f},this.chart)}),m.text}update(v){this.destroy(),this.init(this.chart,$(!0,this.options,v))}updatePosition(v){let{chart:R,container:f,distance:w,options:b,renderer:h}=this,{height:m=0,width:x=0}=this.getLabel(),I=R.pointer,{left:B,top:V,scaleX:U,scaleY:K}=I.getChartPosition(),L=(b.positioner||this.getPosition).call(this,x,m,v),X=(v.plotX||0)+R.plotLeft,q=(v.plotY||0)+R.plotTop,le;h&&f&&(b.positioner&&(L.x+=B-w,L.y+=V-w),le=(b.borderWidth||0)+2*w+2,h.setSize(x+le,m+le,!1),(U!==1||K!==1)&&(O(f,{transform:`scale(${U}, ${K})`}),X*=U,q*=K),X+=B-L.x,q+=V-L.y),this.move(Math.round(L.x),Math.round(L.y||0),X,q)}}return(l=j||(j={})).compose=function A(v){Q(u,A)&&y(v,"afterInit",function(){let R=this.chart;R.options.tooltip&&(R.tooltip=new l(R,R.options.tooltip))})},j}),t(e,"Core/Series/Point.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Animation/AnimationUtilities.js"],e["Core/Defaults.js"],e["Core/Templating.js"],e["Core/Utilities.js"]],function(i,s,r,n,a){let{animObject:l}=s,{defaultOptions:c}=r,{format:u}=n,{addEvent:g,defined:p,erase:C,extend:y,fireEvent:S,getNestedProperty:O,isArray:M,isFunction:_,isNumber:N,isObject:E,merge:k,objectEach:ie,pick:$,syncTimeout:H,removeEvent:Q,uniqueKey:Y}=a;class P{animateBeforeDestroy(){let A=this,v={x:A.startXPos,opacity:0},R=A.getGraphicalProps();R.singular.forEach(function(f){A[f]=A[f].animate(f==="dataLabel"?{x:A[f].startXPos,y:A[f].startYPos,opacity:0}:v)}),R.plural.forEach(function(f){A[f].forEach(function(w){w.element&&w.animate(y({x:A.startXPos},w.startYPos?{x:w.startXPos,y:w.startYPos}:{}))})})}applyOptions(A,v){let R=this.series,f=R.options.pointValKey||R.pointValKey;return y(this,A=P.prototype.optionsToObject.call(this,A)),this.options=this.options?y(this.options,A):A,A.group&&delete this.group,A.dataLabels&&delete this.dataLabels,f&&(this.y=P.prototype.getNestedProperty.call(this,f)),this.selected&&(this.state="select"),"name"in this&&v===void 0&&R.xAxis&&R.xAxis.hasNames&&(this.x=R.xAxis.nameToX(this)),this.x===void 0&&R?v===void 0?this.x=R.autoIncrement():this.x=v:N(A.x)&&R.options.relativeXValue&&(this.x=R.autoIncrement(A.x)),this.isNull=this.isValid&&!this.isValid(),this.formatPrefix=this.isNull?"null":"point",this}destroy(){if(!this.destroyed){let A=this,v=A.series,R=v.chart,f=v.options.dataSorting,w=R.hoverPoints,b=A.series.chart.renderer.globalAnimation,h=l(b),m=()=>{for(let x in(A.graphic||A.graphics||A.dataLabel||A.dataLabels)&&(Q(A),A.destroyElements()),A)delete A[x]};A.legendItem&&R.legend.destroyItem(A),w&&(A.setState(),C(w,A),w.length||(R.hoverPoints=null)),A===R.hoverPoint&&A.onMouseOut(),f&&f.enabled?(this.animateBeforeDestroy(),H(m,h.duration)):m(),R.pointCount--}this.destroyed=!0}destroyElements(A){let v=this,R=v.getGraphicalProps(A);R.singular.forEach(function(f){v[f]=v[f].destroy()}),R.plural.forEach(function(f){v[f].forEach(function(w){w&&w.element&&w.destroy()}),delete v[f]})}firePointEvent(A,v,R){let f=this,w=this.series,b=w.options;(b.point.events[A]||f.options&&f.options.events&&f.options.events[A])&&f.importEvents(),A==="click"&&b.allowPointSelect&&(R=function(h){!f.destroyed&&f.select&&f.select(null,h.ctrlKey||h.metaKey||h.shiftKey)}),S(f,A,v,R)}getClassName(){return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(this.colorIndex!==void 0?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+(this.zone&&this.zone.className?" "+this.zone.className.replace("highcharts-negative",""):"")}getGraphicalProps(A){let v,R,f=this,w=[],b={singular:[],plural:[]};for((A=A||{graphic:1,dataLabel:1}).graphic&&w.push("graphic","connector"),A.dataLabel&&w.push("dataLabel","dataLabelPath","dataLabelUpper"),R=w.length;R--;)f[v=w[R]]&&b.singular.push(v);return["graphic","dataLabel"].forEach(function(h){let m=h+"s";A[h]&&f[m]&&b.plural.push(m)}),b}getLabelConfig(){return{x:this.category,y:this.y,color:this.color,colorIndex:this.colorIndex,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}}getNestedProperty(A){return A?A.indexOf("custom.")===0?O(A,this.options):this[A]:void 0}getZone(){let A=this.series,v=A.zones,R=A.zoneAxis||"y",f,w=0;for(f=v[0];this[R]>=f.value;)f=v[++w];return this.nonZonedColor||(this.nonZonedColor=this.color),f&&f.color&&!this.options.color?this.color=f.color:this.color=this.nonZonedColor,f}hasNewShapeType(){return(this.graphic&&(this.graphic.symbolName||this.graphic.element.nodeName))!==this.shapeType}constructor(A,v,R){this.formatPrefix="point",this.visible=!0,this.series=A,this.applyOptions(v,R),this.id??(this.id=Y()),this.resolveColor(),A.chart.pointCount++,S(this,"afterInit")}isValid(){return(N(this.x)||this.x instanceof Date)&&N(this.y)}optionsToObject(A){let v=this.series,R=v.options.keys,f=R||v.pointArrayMap||["y"],w=f.length,b={},h,m=0,x=0;if(N(A)||A===null)b[f[0]]=A;else if(M(A))for(!R&&A.length>w&&((h=typeof A[0])=="string"?b.name=A[0]:h==="number"&&(b.x=A[0]),m++);x<w;)R&&A[m]===void 0||(f[x].indexOf(".")>0?P.prototype.setNestedProperty(b,A[m],f[x]):b[f[x]]=A[m]),m++,x++;else typeof A=="object"&&(b=A,A.dataLabels&&(v.hasDataLabels=()=>!0),A.marker&&(v._hasPointMarkers=!0));return b}pos(A,v=this.plotY){if(!this.destroyed){let{plotX:R,series:f}=this,{chart:w,xAxis:b,yAxis:h}=f,m=0,x=0;if(N(R)&&N(v))return A&&(m=b?b.pos:w.plotLeft,x=h?h.pos:w.plotTop),w.inverted&&b&&h?[h.len-v+x,b.len-R+m]:[R+m,v+x]}}resolveColor(){let A=this.series,v=A.chart.options.chart,R=A.chart.styledMode,f,w,b=v.colorCount,h;delete this.nonZonedColor,A.options.colorByPoint?(R||(f=(w=A.options.colors||A.chart.options.colors)[A.colorCounter],b=w.length),h=A.colorCounter,A.colorCounter++,A.colorCounter===b&&(A.colorCounter=0)):(R||(f=A.color),h=A.colorIndex),this.colorIndex=$(this.options.colorIndex,h),this.color=$(this.options.color,f)}setNestedProperty(A,v,R){return R.split(".").reduce(function(w,b,h,m){let x=m.length-1===h;return w[b]=x?v:E(w[b],!0)?w[b]:{},w[b]},A),A}shouldDraw(){return!this.isNull}tooltipFormatter(A){let v=this.series,R=v.tooltipOptions,f=$(R.valueDecimals,""),w=R.valuePrefix||"",b=R.valueSuffix||"";return v.chart.styledMode&&(A=v.chart.tooltip.styledModeFormat(A)),(v.pointArrayMap||["y"]).forEach(function(h){h="{point."+h,(w||b)&&(A=A.replace(RegExp(h+"}","g"),w+h+"}"+b)),A=A.replace(RegExp(h+"}","g"),h+":,."+f+"f}")}),u(A,{point:this,series:this.series},v.chart)}update(A,v,R,f){let w,b=this,h=b.series,m=b.graphic,x=h.chart,I=h.options;function B(){b.applyOptions(A);let V=m&&b.hasMockGraphic,U=b.y===null?!V:V;m&&U&&(b.graphic=m.destroy(),delete b.hasMockGraphic),E(A,!0)&&(m&&m.element&&A&&A.marker&&A.marker.symbol!==void 0&&(b.graphic=m.destroy()),A?.dataLabels&&b.dataLabel&&(b.dataLabel=b.dataLabel.destroy())),w=b.index,h.updateParallelArrays(b,w),I.data[w]=E(I.data[w],!0)||E(A,!0)?b.options:$(A,I.data[w]),h.isDirty=h.isDirtyData=!0,!h.fixedBox&&h.hasCartesianSeries&&(x.isDirtyBox=!0),I.legendType==="point"&&(x.isDirtyLegend=!0),v&&x.redraw(R)}v=$(v,!0),f===!1?B():b.firePointEvent("update",{options:A},B)}remove(A,v){this.series.removePoint(this.series.data.indexOf(this),A,v)}select(A,v){let R=this,f=R.series,w=f.chart;A=$(A,!R.selected),this.selectedStaging=A,R.firePointEvent(A?"select":"unselect",{accumulate:v},function(){R.selected=R.options.selected=A,f.options.data[f.data.indexOf(R)]=R.options,R.setState(A&&"select"),v||w.getSelectedPoints().forEach(function(b){let h=b.series;b.selected&&b!==R&&(b.selected=b.options.selected=!1,h.options.data[h.data.indexOf(b)]=b.options,b.setState(w.hoverPoints&&h.options.inactiveOtherPoints?"inactive":""),b.firePointEvent("unselect"))})}),delete this.selectedStaging}onMouseOver(A){let v=this.series,R=v.chart,f=R.pointer;A=A?f.normalize(A):f.getChartCoordinatesFromPoint(this,R.inverted),f.runPointActions(A,this)}onMouseOut(){let A=this.series.chart;this.firePointEvent("mouseOut"),this.series.options.inactiveOtherPoints||(A.hoverPoints||[]).forEach(function(v){v.setState()}),A.hoverPoints=A.hoverPoint=null}importEvents(){if(!this.hasImportedEvents){let A=this,v=k(A.series.options.point,A.options),R=v.events;A.events=R,ie(R,function(f,w){_(f)&&g(A,w,f)}),this.hasImportedEvents=!0}}setState(A,v){let R=this.series,f=this.state,w=R.options.states[A||"normal"]||{},b=c.plotOptions[R.type].marker&&R.options.marker,h=b&&b.enabled===!1,m=b&&b.states&&b.states[A||"normal"]||{},x=m.enabled===!1,I=this.marker||{},B=R.chart,V=b&&R.markerAttribs,U=R.halo,K,L,X,q=R.stateMarkerGraphic,le;if((A=A||"")===this.state&&!v||this.selected&&A!=="select"||w.enabled===!1||A&&(x||h&&m.enabled===!1)||A&&I.states&&I.states[A]&&I.states[A].enabled===!1)return;if(this.state=A,V&&(K=R.markerAttribs(this,A)),this.graphic&&!this.hasMockGraphic){if(f&&this.graphic.removeClass("highcharts-point-"+f),A&&this.graphic.addClass("highcharts-point-"+A),!B.styledMode){L=R.pointAttribs(this,A),X=$(B.options.chart.animation,w.animation);let ne=L.opacity;R.options.inactiveOtherPoints&&N(ne)&&(this.dataLabels||[]).forEach(function(ae){ae&&!ae.hasClass("highcharts-data-label-hidden")&&(ae.animate({opacity:ne},X),ae.connector&&ae.connector.animate({opacity:ne},X))}),this.graphic.animate(L,X)}K&&this.graphic.animate(K,$(B.options.chart.animation,m.animation,b.animation)),q&&q.hide()}else A&&m&&(le=I.symbol||R.symbol,q&&q.currentSymbol!==le&&(q=q.destroy()),K&&(q?q[v?"animate":"attr"]({x:K.x,y:K.y}):le&&(R.stateMarkerGraphic=q=B.renderer.symbol(le,K.x,K.y,K.width,K.height).add(R.markerGroup),q.currentSymbol=le)),!B.styledMode&&q&&this.state!=="inactive"&&q.attr(R.pointAttribs(this,A))),q&&(q[A&&this.isInside?"show":"hide"](),q.element.point=this,q.addClass(this.getClassName(),!0));let D=w.halo,F=this.graphic||q,oe=F&&F.visibility||"inherit";D&&D.size&&F&&oe!=="hidden"&&!this.isCluster?(U||(R.halo=U=B.renderer.path().add(F.parentGroup)),U.show()[v?"animate":"attr"]({d:this.haloPath(D.size)}),U.attr({class:"highcharts-halo highcharts-color-"+$(this.colorIndex,R.colorIndex)+(this.className?" "+this.className:""),visibility:oe,zIndex:-1}),U.point=this,B.styledMode||U.attr(y({fill:this.color||R.color,"fill-opacity":D.opacity},i.filterUserAttributes(D.attributes||{})))):U&&U.point&&U.point.haloPath&&U.animate({d:U.point.haloPath(0)},null,U.hide),S(this,"afterSetState",{state:A})}haloPath(A){let v=this.pos();return v?this.series.chart.renderer.symbols.circle(Math.floor(v[0])-A,v[1]-A,2*A,2*A):[]}}return P}),t(e,"Core/Pointer.js",[e["Core/Color/Color.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s,r){var n;let{parse:a}=i,{charts:l,composed:c,noop:u}=s,{addEvent:g,attr:p,css:C,defined:y,extend:S,find:O,fireEvent:M,isNumber:_,isObject:N,objectEach:E,offset:k,pick:ie,pushUnique:$,splat:H}=r;class Q{applyInactiveState(P){let j=[],A;(P||[]).forEach(function(v){A=v.series,j.push(A),A.linkedParent&&j.push(A.linkedParent),A.linkedSeries&&(j=j.concat(A.linkedSeries)),A.navigatorSeries&&j.push(A.navigatorSeries)}),this.chart.series.forEach(function(v){j.indexOf(v)===-1?v.setState("inactive",!0):v.options.inactiveOtherPoints&&v.setAllPointsToState("inactive")})}destroy(){let P=this;this.eventsToUnbind.forEach(j=>j()),this.eventsToUnbind=[],!s.chartCount&&(Q.unbindDocumentMouseUp&&(Q.unbindDocumentMouseUp=Q.unbindDocumentMouseUp()),Q.unbindDocumentTouchEnd&&(Q.unbindDocumentTouchEnd=Q.unbindDocumentTouchEnd())),clearInterval(P.tooltipTimeout),E(P,function(j,A){P[A]=void 0})}getSelectionMarkerAttrs(P,j){let A={args:{chartX:P,chartY:j},attrs:{},shapeType:"rect"};return M(this,"getSelectionMarkerAttrs",A,v=>{let R,{chart:f,mouseDownX:w=0,mouseDownY:b=0,zoomHor:h,zoomVert:m}=this,x=v.attrs;x.x=f.plotLeft,x.y=f.plotTop,x.width=h?1:f.plotWidth,x.height=m?1:f.plotHeight,h&&(R=P-w,x.width=Math.abs(R),x.x=(R>0?0:R)+w),m&&(R=j-b,x.height=Math.abs(R),x.y=(R>0?0:R)+b)}),A}drag(P){let j=this.chart,A=j.options.chart,v=j.plotLeft,R=j.plotTop,f=j.plotWidth,w=j.plotHeight,b=this.mouseDownX||0,h=this.mouseDownY||0,m=N(A.panning)?A.panning&&A.panning.enabled:A.panning,x=A.panKey&&P[A.panKey+"Key"],I=P.chartX,B=P.chartY,V,U=this.selectionMarker;if((!U||!U.touch)&&(I<v?I=v:I>v+f&&(I=v+f),B<R?B=R:B>R+w&&(B=R+w),this.hasDragged=Math.sqrt(Math.pow(b-I,2)+Math.pow(h-B,2)),this.hasDragged>10)){V=j.isInsidePlot(b-v,h-R,{visiblePlotOnly:!0});let{shapeType:K,attrs:L}=this.getSelectionMarkerAttrs(I,B);(j.hasCartesianSeries||j.mapView)&&(this.zoomX||this.zoomY)&&V&&!x&&!U&&(this.selectionMarker=U=j.renderer[K](),U.attr({class:"highcharts-selection-marker",zIndex:7}).add(),j.styledMode||U.attr({fill:A.selectionMarkerFill||a("#334eff").setOpacity(.25).get()})),U&&U.attr(L),V&&!U&&m&&j.pan(P,A.panning)}}dragStart(P){let j=this.chart;j.mouseIsDown=P.type,j.cancelClick=!1,j.mouseDownX=this.mouseDownX=P.chartX,j.mouseDownY=this.mouseDownY=P.chartY}getSelectionBox(P){let j={args:{marker:P},result:{}};return M(this,"getSelectionBox",j,A=>{A.result={x:P.attr?+P.attr("x"):P.x,y:P.attr?+P.attr("y"):P.y,width:P.attr?P.attr("width"):P.width,height:P.attr?P.attr("height"):P.height}}),j.result}drop(P){let j=this,A=this.chart,v=this.hasPinched;if(this.selectionMarker){let{x:R,y:f,width:w,height:b}=this.getSelectionBox(this.selectionMarker),h={originalEvent:P,xAxis:[],yAxis:[],x:R,y:f,width:w,height:b},m=!!A.mapView;(this.hasDragged||v)&&(A.axes.forEach(function(x){if(x.zoomEnabled&&y(x.min)&&(v||j[{xAxis:"zoomX",yAxis:"zoomY"}[x.coll]])&&_(R)&&_(f)&&_(w)&&_(b)){let I=x.horiz,B=P.type==="touchend"?x.minPixelPadding:0,V=x.toValue((I?R:f)+B),U=x.toValue((I?R+w:f+b)-B);h[x.coll].push({axis:x,min:Math.min(V,U),max:Math.max(V,U)}),m=!0}}),m&&M(A,"selection",h,function(x){A.zoom(S(x,v?{animation:!1}:null))})),_(A.index)&&(this.selectionMarker=this.selectionMarker.destroy()),v&&this.scaleGroups()}A&&_(A.index)&&(C(A.container,{cursor:A._cursor}),A.cancelClick=+this.hasDragged>10,A.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])}findNearestKDPoint(P,j,A){let v;return P.forEach(function(R){let f=R.noSharedTooltip&&j,w=!f&&0>R.options.findNearestPointBy.indexOf("y"),b=R.searchPoint(A,w);N(b,!0)&&b.series&&(!N(v,!0)||function(h,m){let x=h.distX-m.distX,I=h.dist-m.dist,B=(m.series.group&&m.series.group.zIndex)-(h.series.group&&h.series.group.zIndex);return x!==0&&j?x:I!==0?I:B!==0?B:h.series.index>m.series.index?-1:1}(v,b)>0)&&(v=b)}),v}getChartCoordinatesFromPoint(P,j){let A=P.series,v=A.xAxis,R=A.yAxis,f=P.shapeArgs;if(v&&R){let w=ie(P.clientX,P.plotX),b=P.plotY||0;return P.isNode&&f&&_(f.x)&&_(f.y)&&(w=f.x,b=f.y),j?{chartX:R.len+R.pos-b,chartY:v.len+v.pos-w}:{chartX:w+v.pos,chartY:b+R.pos}}if(f&&f.x&&f.y)return{chartX:f.x,chartY:f.y}}getChartPosition(){if(this.chartPosition)return this.chartPosition;let{container:P}=this.chart,j=k(P);this.chartPosition={left:j.left,top:j.top,scaleX:1,scaleY:1};let A=P.offsetWidth,v=P.offsetHeight;return A>2&&v>2&&(this.chartPosition.scaleX=j.width/A,this.chartPosition.scaleY=j.height/v),this.chartPosition}getCoordinates(P){let j={xAxis:[],yAxis:[]};return this.chart.axes.forEach(function(A){j[A.isXAxis?"xAxis":"yAxis"].push({axis:A,value:A.toValue(P[A.horiz?"chartX":"chartY"])})}),j}getHoverData(P,j,A,v,R,f){let w=[],b=function(V){return V.visible&&!(!R&&V.directTouch)&&ie(V.options.enableMouseTracking,!0)},h=j,m,x={chartX:f?f.chartX:void 0,chartY:f?f.chartY:void 0,shared:R};M(this,"beforeGetHoverData",x),m=h&&!h.stickyTracking?[h]:A.filter(V=>V.stickyTracking&&(x.filter||b)(V));let B=v&&P||!f?P:this.findNearestKDPoint(m,R,f);return h=B&&B.series,B&&(R&&!h.noSharedTooltip?(m=A.filter(function(V){return x.filter?x.filter(V):b(V)&&!V.noSharedTooltip})).forEach(function(V){let U=O(V.points,function(K){return K.x===B.x&&!K.isNull});N(U)&&(V.boosted&&V.boost&&(U=V.boost.getPoint(U)),w.push(U))}):w.push(B)),M(this,"afterGetHoverData",x={hoverPoint:B}),{hoverPoint:x.hoverPoint,hoverSeries:h,hoverPoints:w}}getPointFromEvent(P){let j=P.target,A;for(;j&&!A;)A=j.point,j=j.parentNode;return A}onTrackerMouseOut(P){let j=this.chart,A=P.relatedTarget,v=j.hoverSeries;this.isDirectTouch=!1,!v||!A||v.stickyTracking||this.inClass(A,"highcharts-tooltip")||this.inClass(A,"highcharts-series-"+v.index)&&this.inClass(A,"highcharts-tracker")||v.onMouseOut()}inClass(P,j){let A=P,v;for(;A;){if(v=p(A,"class")){if(v.indexOf(j)!==-1)return!0;if(v.indexOf("highcharts-container")!==-1)return!1}A=A.parentElement}}constructor(P,j){this.hasDragged=!1,this.lastValidTouch={},this.pinchDown=[],this.eventsToUnbind=[],this.options=j,this.chart=P,this.runChartClick=!!j.chart.events?.click,this.pinchDown=[],this.lastValidTouch={},this.setDOMEvents(),M(this,"afterInit")}normalize(P,j){let A=P.touches,v=A?A.length?A.item(0):ie(A.changedTouches,P.changedTouches)[0]:P;j||(j=this.getChartPosition());let R=v.pageX-j.left,f=v.pageY-j.top;return S(P,{chartX:Math.round(R/=j.scaleX),chartY:Math.round(f/=j.scaleY)})}onContainerClick(P){let j=this.chart,A=j.hoverPoint,v=this.normalize(P),R=j.plotLeft,f=j.plotTop;!j.cancelClick&&(A&&this.inClass(v.target,"highcharts-tracker")?(M(A.series,"click",S(v,{point:A})),j.hoverPoint&&A.firePointEvent("click",v)):(S(v,this.getCoordinates(v)),j.isInsidePlot(v.chartX-R,v.chartY-f,{visiblePlotOnly:!0})&&M(j,"click",v)))}onContainerMouseDown(P){let j=(1&(P.buttons||P.button))==1;P=this.normalize(P),s.isFirefox&&P.button!==0&&this.onContainerMouseMove(P),(P.button===void 0||j)&&(this.zoomOption(P),j&&P.preventDefault&&P.preventDefault(),this.dragStart(P))}onContainerMouseLeave(P){let j=l[ie(Q.hoverChartIndex,-1)];P=this.normalize(P),this.onContainerMouseMove(P),j&&P.relatedTarget&&!this.inClass(P.relatedTarget,"highcharts-tooltip")&&(j.pointer.reset(),j.pointer.chartPosition=void 0)}onContainerMouseEnter(P){delete this.chartPosition}onContainerMouseMove(P){let j=this.chart,A=j.tooltip,v=this.normalize(P);this.setHoverChartIndex(P),(j.mouseIsDown==="mousedown"||this.touchSelect(v))&&this.drag(v),!j.openMenu&&(this.inClass(v.target,"highcharts-tracker")||j.isInsidePlot(v.chartX-j.plotLeft,v.chartY-j.plotTop,{visiblePlotOnly:!0}))&&!(A&&A.shouldStickOnContact(v))&&(this.inClass(v.target,"highcharts-no-tooltip")?this.reset(!1,0):this.runPointActions(v))}onDocumentTouchEnd(P){let j=l[ie(Q.hoverChartIndex,-1)];j&&j.pointer.drop(P)}onContainerTouchMove(P){this.touchSelect(P)?this.onContainerMouseMove(P):this.touch(P)}onContainerTouchStart(P){this.touchSelect(P)?this.onContainerMouseDown(P):(this.zoomOption(P),this.touch(P,!0))}onDocumentMouseMove(P){let j=this.chart,A=j.tooltip,v=this.chartPosition,R=this.normalize(P,v);!v||j.isInsidePlot(R.chartX-j.plotLeft,R.chartY-j.plotTop,{visiblePlotOnly:!0})||A&&A.shouldStickOnContact(R)||this.inClass(R.target,"highcharts-tracker")||this.reset()}onDocumentMouseUp(P){let j=l[ie(Q.hoverChartIndex,-1)];j&&j.pointer.drop(P)}pinch(P){let j=this,A=j.chart,v=j.pinchDown,R=P.touches||[],f=R.length,w=j.lastValidTouch,b=j.hasZoom,h={},m=f===1&&(j.inClass(P.target,"highcharts-tracker")&&A.runTrackerClick||j.runChartClick),x={},I=j.chart.tooltip,B=f===1&&ie(I&&I.options.followTouchMove,!0),V=j.selectionMarker;f>1?j.initiated=!0:B&&(j.initiated=!1),b&&j.initiated&&!m&&P.cancelable!==!1&&P.preventDefault(),[].map.call(R,function(U){return j.normalize(U)}),P.type==="touchstart"?([].forEach.call(R,function(U,K){v[K]={chartX:U.chartX,chartY:U.chartY}}),w.x=[v[0].chartX,v[1]&&v[1].chartX],w.y=[v[0].chartY,v[1]&&v[1].chartY],A.axes.forEach(function(U){if(U.zoomEnabled){let K=A.bounds[U.horiz?"h":"v"],L=U.minPixelPadding,X=U.toPixels(Math.min(ie(U.options.min,U.dataMin),U.dataMin)),q=U.toPixels(Math.max(ie(U.options.max,U.dataMax),U.dataMax)),le=Math.min(X,q),D=Math.max(X,q);K.min=Math.min(U.pos,le-L),K.max=Math.max(U.pos+U.len,D+L)}}),j.res=!0):B?this.runPointActions(j.normalize(P)):v.length&&(M(A,"touchpan",{originalEvent:P},()=>{V||(j.selectionMarker=V=S({destroy:u,touch:!0},A.plotBox)),j.pinchTranslate(v,R,h,V,x,w),j.hasPinched=b,j.scaleGroups(h,x)}),j.res&&(j.res=!1,this.reset(!1,0)))}pinchTranslate(P,j,A,v,R,f){this.zoomHor&&this.pinchTranslateDirection(!0,P,j,A,v,R,f),this.zoomVert&&this.pinchTranslateDirection(!1,P,j,A,v,R,f)}pinchTranslateDirection(P,j,A,v,R,f,w,b){let h=this.chart,m=P?"x":"y",x=P?"X":"Y",I="chart"+x,B=P?"width":"height",V=h["plot"+(P?"Left":"Top")],U=h.inverted,K=h.bounds[P?"h":"v"],L=j.length===1,X=j[0][I],q=!L&&j[1][I],le=function(){typeof fe=="number"&&Math.abs(X-q)>20&&(ne=b||Math.abs(ae-fe)/Math.abs(X-q)),oe=(V-ae)/ne+X,D=h["plot"+(P?"Width":"Height")]/ne},D,F,oe,ne=b||1,ae=A[0][I],fe=!L&&A[1][I],me;le(),(F=oe)<K.min?(F=K.min,me=!0):F+D>K.max&&(F=K.max-D,me=!0),me?(ae-=.8*(ae-w[m][0]),typeof fe=="number"&&(fe-=.8*(fe-w[m][1])),le()):w[m]=[ae,fe],U||(f[m]=oe-V,f[B]=D);let G=U?P?"scaleY":"scaleX":"scale"+x,se=U?1/ne:ne;R[B]=D,R[m]=F,v[G]=ne*(U&&!P?-1:1),v["translate"+x]=se*V+(ae-se*X)}reset(P,j){let A=this.chart,v=A.hoverSeries,R=A.hoverPoint,f=A.hoverPoints,w=A.tooltip,b=w&&w.shared?f:R;P&&b&&H(b).forEach(function(h){h.series.isCartesian&&h.plotX===void 0&&(P=!1)}),P?w&&b&&H(b).length&&(w.refresh(b),w.shared&&f?f.forEach(function(h){h.setState(h.state,!0),h.series.isCartesian&&(h.series.xAxis.crosshair&&h.series.xAxis.drawCrosshair(null,h),h.series.yAxis.crosshair&&h.series.yAxis.drawCrosshair(null,h))}):R&&(R.setState(R.state,!0),A.axes.forEach(function(h){h.crosshair&&R.series[h.coll]===h&&h.drawCrosshair(null,R)}))):(R&&R.onMouseOut(),f&&f.forEach(function(h){h.setState()}),v&&v.onMouseOut(),w&&w.hide(j),this.unDocMouseMove&&(this.unDocMouseMove=this.unDocMouseMove()),A.axes.forEach(function(h){h.hideCrosshair()}),this.hoverX=A.hoverPoints=A.hoverPoint=null)}runPointActions(P,j,A){let v=this.chart,R=v.series,f=v.tooltip&&v.tooltip.options.enabled?v.tooltip:void 0,w=!!f&&f.shared,b=j||v.hoverPoint,h=b&&b.series||v.hoverSeries,m=(!P||P.type!=="touchmove")&&(!!j||h&&h.directTouch&&this.isDirectTouch),x=this.getHoverData(b,h,R,m,w,P);b=x.hoverPoint,h=x.hoverSeries;let I=x.hoverPoints,B=h&&h.tooltipOptions.followPointer&&!h.tooltipOptions.split,V=w&&h&&!h.noSharedTooltip;if(b&&(A||b!==v.hoverPoint||f&&f.isHidden)){if((v.hoverPoints||[]).forEach(function(U){I.indexOf(U)===-1&&U.setState()}),v.hoverSeries!==h&&h.onMouseOver(),this.applyInactiveState(I),(I||[]).forEach(function(U){U.setState("hover")}),v.hoverPoint&&v.hoverPoint.firePointEvent("mouseOut"),!b.series)return;v.hoverPoints=I,v.hoverPoint=b,b.firePointEvent("mouseOver",void 0,()=>{f&&b&&f.refresh(V?I:b,P)})}else if(B&&f&&!f.isHidden){let U=f.getAnchor([{}],P);v.isInsidePlot(U[0],U[1],{visiblePlotOnly:!0})&&f.updatePosition({plotX:U[0],plotY:U[1]})}this.unDocMouseMove||(this.unDocMouseMove=g(v.container.ownerDocument,"mousemove",function(U){let K=l[Q.hoverChartIndex];K&&K.pointer.onDocumentMouseMove(U)}),this.eventsToUnbind.push(this.unDocMouseMove)),v.axes.forEach(function(U){let K,L=ie((U.crosshair||{}).snap,!0);!L||(K=v.hoverPoint)&&K.series[U.coll]===U||(K=O(I,X=>X.series&&X.series[U.coll]===U)),K||!L?U.drawCrosshair(P,K):U.hideCrosshair()})}scaleGroups(P,j){let A=this.chart;A.series.forEach(function(v){let R=P||v.getPlotBox("series");v.group&&(v.xAxis&&v.xAxis.zoomEnabled||A.mapView)&&(v.group.attr(R),v.markerGroup&&(v.markerGroup.attr(P||v.getPlotBox("marker")),v.markerGroup.clip(j?A.clipRect:null)),v.dataLabelsGroup&&v.dataLabelsGroup.attr(R))}),A.clipRect.attr(j||A.clipBox)}setDOMEvents(){let P=this.chart.container,j=P.ownerDocument;P.onmousedown=this.onContainerMouseDown.bind(this),P.onmousemove=this.onContainerMouseMove.bind(this),P.onclick=this.onContainerClick.bind(this),this.eventsToUnbind.push(g(P,"mouseenter",this.onContainerMouseEnter.bind(this))),this.eventsToUnbind.push(g(P,"mouseleave",this.onContainerMouseLeave.bind(this))),Q.unbindDocumentMouseUp||(Q.unbindDocumentMouseUp=g(j,"mouseup",this.onDocumentMouseUp.bind(this)));let A=this.chart.renderTo.parentElement;for(;A&&A.tagName!=="BODY";)this.eventsToUnbind.push(g(A,"scroll",()=>{delete this.chartPosition})),A=A.parentElement;s.hasTouch&&(this.eventsToUnbind.push(g(P,"touchstart",this.onContainerTouchStart.bind(this),{passive:!1})),this.eventsToUnbind.push(g(P,"touchmove",this.onContainerTouchMove.bind(this),{passive:!1})),Q.unbindDocumentTouchEnd||(Q.unbindDocumentTouchEnd=g(j,"touchend",this.onDocumentTouchEnd.bind(this),{passive:!1})))}setHoverChartIndex(P){let j=this.chart,A=s.charts[ie(Q.hoverChartIndex,-1)];A&&A!==j&&A.pointer.onContainerMouseLeave(P||{relatedTarget:j.container}),A&&A.mouseIsDown||(Q.hoverChartIndex=j.index)}touch(P,j){let A,v,R=this.chart;this.setHoverChartIndex(),P.touches.length===1?(P=this.normalize(P),R.isInsidePlot(P.chartX-R.plotLeft,P.chartY-R.plotTop,{visiblePlotOnly:!0})&&!R.openMenu?(j&&this.runPointActions(P),P.type==="touchmove"&&(A=!!(v=this.pinchDown)[0]&&Math.sqrt(Math.pow(v[0].chartX-P.chartX,2)+Math.pow(v[0].chartY-P.chartY,2))>=4),ie(A,!0)&&this.pinch(P)):j&&this.reset()):P.touches.length===2&&this.pinch(P)}touchSelect(P){return!!(this.chart.zooming.singleTouch&&P.touches&&P.touches.length===1)}zoomOption(P){let j=this.chart,A=(j.options.chart,j.inverted),v=j.zooming.type||"",R,f;/touch/.test(P.type)&&(v=ie(j.zooming.pinchType,v)),this.zoomX=R=/x/.test(v),this.zoomY=f=/y/.test(v),this.zoomHor=R&&!A||f&&A,this.zoomVert=f&&!A||R&&A,this.hasZoom=R||f}}return(n=Q||(Q={})).compose=function Y(P){$(c,Y)&&g(P,"beforeRender",function(){this.pointer=new n(this,this.options)})},Q}),t(e,"Core/Legend/Legend.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Templating.js"],e["Core/Globals.js"],e["Core/Series/Point.js"],e["Core/Renderer/RendererUtilities.js"],e["Core/Utilities.js"]],function(i,s,r,n,a,l){var c;let{animObject:u,setAnimation:g}=i,{format:p}=s,{composed:C,marginNames:y}=r,{distribute:S}=a,{addEvent:O,createElement:M,css:_,defined:N,discardElement:E,find:k,fireEvent:ie,isNumber:$,merge:H,pick:Q,pushUnique:Y,relativeLength:P,stableSort:j,syncTimeout:A}=l;class v{constructor(f,w){this.allItems=[],this.initialItemY=0,this.itemHeight=0,this.itemMarginBottom=0,this.itemMarginTop=0,this.itemX=0,this.itemY=0,this.lastItemY=0,this.lastLineHeight=0,this.legendHeight=0,this.legendWidth=0,this.maxItemWidth=0,this.maxLegendWidth=0,this.offsetWidth=0,this.padding=0,this.pages=[],this.symbolHeight=0,this.symbolWidth=0,this.titleHeight=0,this.totalItemWidth=0,this.widthOption=0,this.chart=f,this.setOptions(w),w.enabled&&(this.render(),O(this.chart,"endResize",function(){this.legend.positionCheckboxes()})),O(this.chart,"render",()=>{this.options.enabled&&this.proximate&&(this.proximatePositions(),this.positionItems())})}setOptions(f){let w=Q(f.padding,8);this.options=f,this.chart.styledMode||(this.itemStyle=f.itemStyle,this.itemHiddenStyle=H(this.itemStyle,f.itemHiddenStyle)),this.itemMarginTop=f.itemMarginTop,this.itemMarginBottom=f.itemMarginBottom,this.padding=w,this.initialItemY=w-5,this.symbolWidth=Q(f.symbolWidth,16),this.pages=[],this.proximate=f.layout==="proximate"&&!this.chart.inverted,this.baseline=void 0}update(f,w){let b=this.chart;this.setOptions(H(!0,this.options,f)),this.destroy(),b.isDirtyLegend=b.isDirtyBox=!0,Q(w,!0)&&b.redraw(),ie(this,"afterUpdate",{redraw:w})}colorizeItem(f,w){let{area:b,group:h,label:m,line:x,symbol:I}=f.legendItem||{};if(h?.[w?"removeClass":"addClass"]("highcharts-legend-item-hidden"),!this.chart.styledMode){let{itemHiddenStyle:B={}}=this,V=B.color,{fillColor:U,fillOpacity:K,lineColor:L,marker:X}=f.options,q=le=>(!w&&(le.fill&&(le.fill=V),le.stroke&&(le.stroke=V)),le);m?.css(H(w?this.itemStyle:B)),x?.attr(q({stroke:L||f.color})),I&&I.attr(q(X&&I.isMarker?f.pointAttribs():{fill:f.color})),b?.attr(q({fill:U||f.color,"fill-opacity":U?1:K??.75}))}ie(this,"afterColorizeItem",{item:f,visible:w})}positionItems(){this.allItems.forEach(this.positionItem,this),this.chart.isResizing||this.positionCheckboxes()}positionItem(f){let{group:w,x:b=0,y:h=0}=f.legendItem||{},m=this.options,x=m.symbolPadding,I=!m.rtl,B=f.checkbox;if(w&&w.element){let V={translateX:I?b:this.legendWidth-b-2*x-4,translateY:h};w[N(w.translateY)?"animate":"attr"](V,void 0,()=>{ie(this,"afterPositionItem",{item:f})})}B&&(B.x=b,B.y=h)}destroyItem(f){let w=f.checkbox,b=f.legendItem||{};for(let h of["group","label","line","symbol"])b[h]&&(b[h]=b[h].destroy());w&&E(w),f.legendItem=void 0}destroy(){for(let f of this.getAllItems())this.destroyItem(f);for(let f of["clipRect","up","down","pager","nav","box","title","group"])this[f]&&(this[f]=this[f].destroy());this.display=null}positionCheckboxes(){let f,w=this.group&&this.group.alignAttr,b=this.clipHeight||this.legendHeight,h=this.titleHeight;w&&(f=w.translateY,this.allItems.forEach(function(m){let x,I=m.checkbox;I&&(x=f+h+I.y+(this.scrollOffset||0)+3,_(I,{left:w.translateX+m.checkboxOffset+I.x-20+"px",top:x+"px",display:this.proximate||x>f-6&&x<f+b-6?"":"none"}))},this))}renderTitle(){let f=this.options,w=this.padding,b=f.title,h,m=0;b.text&&(this.title||(this.title=this.chart.renderer.label(b.text,w-3,w-4,void 0,void 0,void 0,f.useHTML,void 0,"legend-title").attr({zIndex:1}),this.chart.styledMode||this.title.css(b.style),this.title.add(this.group)),b.width||this.title.css({width:this.maxLegendWidth+"px"}),m=(h=this.title.getBBox()).height,this.offsetWidth=h.width,this.contentGroup.attr({translateY:m})),this.titleHeight=m}setText(f){let w=this.options;f.legendItem.label.attr({text:w.labelFormat?p(w.labelFormat,f,this.chart):w.labelFormatter.call(f)})}renderItem(f){let w=f.legendItem=f.legendItem||{},b=this.chart,h=b.renderer,m=this.options,x=m.layout==="horizontal",I=this.symbolWidth,B=m.symbolPadding||0,V=this.itemStyle,U=this.itemHiddenStyle,K=x?Q(m.itemDistance,20):0,L=!m.rtl,X=!f.series,q=!X&&f.series.drawLegendSymbol?f.series:f,le=q.options,D=!!this.createCheckboxForItem&&le&&le.showCheckbox,F=m.useHTML,oe=f.options.className,ne=w.label,ae=I+B+K+(D?20:0);!ne&&(w.group=h.g("legend-item").addClass("highcharts-"+q.type+"-series highcharts-color-"+f.colorIndex+(oe?" "+oe:"")+(X?" highcharts-series-"+f.index:"")).attr({zIndex:1}).add(this.scrollGroup),w.label=ne=h.text("",L?I+B:-B,this.baseline||0,F),b.styledMode||ne.css(H(f.visible?V:U)),ne.attr({align:L?"left":"right",zIndex:2}).add(w.group),!this.baseline&&(this.fontMetrics=h.fontMetrics(ne),this.baseline=this.fontMetrics.f+3+this.itemMarginTop,ne.attr("y",this.baseline),this.symbolHeight=Q(m.symbolHeight,this.fontMetrics.f),m.squareSymbol&&(this.symbolWidth=Q(m.symbolWidth,Math.max(this.symbolHeight,16)),ae=this.symbolWidth+B+K+(D?20:0),L&&ne.attr("x",this.symbolWidth+B))),q.drawLegendSymbol(this,f),this.setItemEvents&&this.setItemEvents(f,ne,F)),D&&!f.checkbox&&this.createCheckboxForItem&&this.createCheckboxForItem(f),this.colorizeItem(f,f.visible),(b.styledMode||!V.width)&&ne.css({width:(m.itemWidth||this.widthOption||b.spacingBox.width)-ae+"px"}),this.setText(f);let fe=ne.getBBox(),me=this.fontMetrics&&this.fontMetrics.h||0;f.itemWidth=f.checkboxOffset=m.itemWidth||w.labelWidth||fe.width+ae,this.maxItemWidth=Math.max(this.maxItemWidth,f.itemWidth),this.totalItemWidth+=f.itemWidth,this.itemHeight=f.itemHeight=Math.round(w.labelHeight||(fe.height>1.5*me?fe.height:me))}layoutItem(f){let w=this.options,b=this.padding,h=w.layout==="horizontal",m=f.itemHeight,x=this.itemMarginBottom,I=this.itemMarginTop,B=h?Q(w.itemDistance,20):0,V=this.maxLegendWidth,U=w.alignColumns&&this.totalItemWidth>V?this.maxItemWidth:f.itemWidth,K=f.legendItem||{};h&&this.itemX-b+U>V&&(this.itemX=b,this.lastLineHeight&&(this.itemY+=I+this.lastLineHeight+x),this.lastLineHeight=0),this.lastItemY=I+this.itemY+x,this.lastLineHeight=Math.max(m,this.lastLineHeight),K.x=this.itemX,K.y=this.itemY,h?this.itemX+=U:(this.itemY+=I+m+x,this.lastLineHeight=m),this.offsetWidth=this.widthOption||Math.max((h?this.itemX-b-(f.checkbox?0:B):U)+b,this.offsetWidth)}getAllItems(){let f=[];return this.chart.series.forEach(function(w){let b=w&&w.options;w&&Q(b.showInLegend,!N(b.linkedTo)&&void 0,!0)&&(f=f.concat((w.legendItem||{}).labels||(b.legendType==="point"?w.data:w)))}),ie(this,"afterGetAllItems",{allItems:f}),f}getAlignment(){let f=this.options;return this.proximate?f.align.charAt(0)+"tv":f.floating?"":f.align.charAt(0)+f.verticalAlign.charAt(0)+f.layout.charAt(0)}adjustMargins(f,w){let b=this.chart,h=this.options,m=this.getAlignment();m&&[/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/].forEach(function(x,I){x.test(m)&&!N(f[I])&&(b[y[I]]=Math.max(b[y[I]],b.legend[(I+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][I]*h[I%2?"x":"y"]+Q(h.margin,12)+w[I]+(b.titleOffset[I]||0)))})}proximatePositions(){let f,w=this.chart,b=[],h=this.options.align==="left";for(let m of(this.allItems.forEach(function(x){let I,B,V=h,U,K;x.yAxis&&(x.xAxis.options.reversed&&(V=!V),x.points&&(I=k(V?x.points:x.points.slice(0).reverse(),function(L){return $(L.plotY)})),B=this.itemMarginTop+x.legendItem.label.getBBox().height+this.itemMarginBottom,K=x.yAxis.top-w.plotTop,U=x.visible?(I?I.plotY:x.yAxis.height)+(K-.3*B):K+x.yAxis.height,b.push({target:U,size:B,item:x}))},this),S(b,w.plotHeight)))f=m.item.legendItem||{},$(m.pos)&&(f.y=w.plotTop-w.spacing[0]+m.pos)}render(){let f=this.chart,w=f.renderer,b=this.options,h=this.padding,m=this.getAllItems(),x,I,B,V=this.group,U,K=this.box;this.itemX=h,this.itemY=this.initialItemY,this.offsetWidth=0,this.lastItemY=0,this.widthOption=P(b.width,f.spacingBox.width-h),U=f.spacingBox.width-2*h-b.x,["rm","lm"].indexOf(this.getAlignment().substring(0,2))>-1&&(U/=2),this.maxLegendWidth=this.widthOption||U,V||(this.group=V=w.g("legend").addClass(b.className||"").attr({zIndex:7}).add(),this.contentGroup=w.g().attr({zIndex:1}).add(V),this.scrollGroup=w.g().add(this.contentGroup)),this.renderTitle(),j(m,(L,X)=>(L.options&&L.options.legendIndex||0)-(X.options&&X.options.legendIndex||0)),b.reversed&&m.reverse(),this.allItems=m,this.display=x=!!m.length,this.lastLineHeight=0,this.maxItemWidth=0,this.totalItemWidth=0,this.itemHeight=0,m.forEach(this.renderItem,this),m.forEach(this.layoutItem,this),I=(this.widthOption||this.offsetWidth)+h,B=this.lastItemY+this.lastLineHeight+this.titleHeight,B=this.handleOverflow(B)+h,K||(this.box=K=w.rect().addClass("highcharts-legend-box").attr({r:b.borderRadius}).add(V)),f.styledMode||K.attr({stroke:b.borderColor,"stroke-width":b.borderWidth||0,fill:b.backgroundColor||"none"}).shadow(b.shadow),I>0&&B>0&&K[K.placed?"animate":"attr"](K.crisp.call({},{x:0,y:0,width:I,height:B},K.strokeWidth())),V[x?"show":"hide"](),f.styledMode&&V.getStyle("display")==="none"&&(I=B=0),this.legendWidth=I,this.legendHeight=B,x&&this.align(),this.proximate||this.positionItems(),ie(this,"afterRender")}align(f=this.chart.spacingBox){let w=this.chart,b=this.options,h=f.y;/(lth|ct|rth)/.test(this.getAlignment())&&w.titleOffset[0]>0?h+=w.titleOffset[0]:/(lbh|cb|rbh)/.test(this.getAlignment())&&w.titleOffset[2]>0&&(h-=w.titleOffset[2]),h!==f.y&&(f=H(f,{y:h})),w.hasRendered||(this.group.placed=!1),this.group.align(H(b,{width:this.legendWidth,height:this.legendHeight,verticalAlign:this.proximate?"top":b.verticalAlign}),!0,f)}handleOverflow(f){let w=this,b=this.chart,h=b.renderer,m=this.options,x=m.y,I=m.verticalAlign==="top",B=this.padding,V=m.maxHeight,U=m.navigation,K=Q(U.animation,!0),L=U.arrowSize||12,X=this.pages,q=this.allItems,le=function(G){typeof G=="number"?me.attr({height:G}):me&&(w.clipRect=me.destroy(),w.contentGroup.clip()),w.contentGroup.div&&(w.contentGroup.div.style.clip=G?"rect("+B+"px,9999px,"+(B+G)+"px,0)":"auto")},D=function(G){return w[G]=h.circle(0,0,1.3*L).translate(L/2,L/2).add(fe),b.styledMode||w[G].attr("fill","rgba(0,0,0,0.0001)"),w[G]},F,oe,ne,ae=b.spacingBox.height+(I?-x:x)-B,fe=this.nav,me=this.clipRect;return m.layout!=="horizontal"||m.verticalAlign==="middle"||m.floating||(ae/=2),V&&(ae=Math.min(ae,V)),X.length=0,f&&ae>0&&f>ae&&U.enabled!==!1?(this.clipHeight=F=Math.max(ae-20-this.titleHeight-B,0),this.currentPage=Q(this.currentPage,1),this.fullHeight=f,q.forEach((G,se)=>{ne=G.legendItem||{};let ee=ne.y||0,ue=Math.round(ne.label.getBBox().height),de=X.length;(!de||ee-X[de-1]>F&&(oe||ee)!==X[de-1])&&(X.push(oe||ee),de++),ne.pageIx=de-1,oe&&((q[se-1].legendItem||{}).pageIx=de-1),se===q.length-1&&ee+ue-X[de-1]>F&&ee>X[de-1]&&(X.push(ee),ne.pageIx=de),ee!==oe&&(oe=ee)}),me||(me=w.clipRect=h.clipRect(0,B-2,9999,0),w.contentGroup.clip(me)),le(F),fe||(this.nav=fe=h.g().attr({zIndex:1}).add(this.group),this.up=h.symbol("triangle",0,0,L,L).add(fe),D("upTracker").on("click",function(){w.scroll(-1,K)}),this.pager=h.text("",15,10).addClass("highcharts-legend-navigation"),!b.styledMode&&U.style&&this.pager.css(U.style),this.pager.add(fe),this.down=h.symbol("triangle-down",0,0,L,L).add(fe),D("downTracker").on("click",function(){w.scroll(1,K)})),w.scroll(0),f=ae):fe&&(le(),this.nav=fe.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),f}scroll(f,w){let b=this.chart,h=this.pages,m=h.length,x=this.clipHeight,I=this.options.navigation,B=this.pager,V=this.padding,U=this.currentPage+f;if(U>m&&(U=m),U>0){w!==void 0&&g(w,b),this.nav.attr({translateX:V,translateY:x+this.padding+7+this.titleHeight,visibility:"inherit"}),[this.up,this.upTracker].forEach(function(L){L.attr({class:U===1?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})}),B.attr({text:U+"/"+m}),[this.down,this.downTracker].forEach(function(L){L.attr({x:18+this.pager.getBBox().width,class:U===m?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})},this),b.styledMode||(this.up.attr({fill:U===1?I.inactiveColor:I.activeColor}),this.upTracker.css({cursor:U===1?"default":"pointer"}),this.down.attr({fill:U===m?I.inactiveColor:I.activeColor}),this.downTracker.css({cursor:U===m?"default":"pointer"})),this.scrollOffset=-h[U-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=U,this.positionCheckboxes();let K=u(Q(w,b.renderer.globalAnimation,!0));A(()=>{ie(this,"afterScroll",{currentPage:U})},K.duration)}}setItemEvents(f,w,b){let h=this,m=f.legendItem||{},x=h.chart.renderer.boxWrapper,I=f instanceof n,B="highcharts-legend-"+(I?"point":"series")+"-active",V=h.chart.styledMode,U=b?[w,m.symbol]:[m.group],K=L=>{h.allItems.forEach(X=>{f!==X&&[X].concat(X.linkedSeries||[]).forEach(q=>{q.setState(L,!I)})})};for(let L of U)L&&L.on("mouseover",function(){f.visible&&K("inactive"),f.setState("hover"),f.visible&&x.addClass(B),V||w.css(h.options.itemHoverStyle)}).on("mouseout",function(){h.chart.styledMode||w.css(H(f.visible?h.itemStyle:h.itemHiddenStyle)),K(""),x.removeClass(B),f.setState()}).on("click",function(X){let q="legendItemClick",le=function(){f.setVisible&&f.setVisible(),K(f.visible?"inactive":"")};x.removeClass(B),X={browserEvent:X},f.firePointEvent?f.firePointEvent(q,X,le):ie(f,q,X,le)})}createCheckboxForItem(f){f.checkbox=M("input",{type:"checkbox",className:"highcharts-legend-checkbox",checked:f.selected,defaultChecked:f.selected},this.options.itemCheckboxStyle,this.chart.container),O(f.checkbox,"click",function(w){let b=w.target;ie(f.series||f,"checkboxClick",{checked:b.checked,item:f},function(){f.select()})})}}return(c=v||(v={})).compose=function R(f){Y(C,R)&&O(f,"beforeMargins",function(){this.legend=new c(this,this.options.legend)})},v}),t(e,"Core/Legend/LegendSymbol.js",[e["Core/Utilities.js"]],function(i){var s;let{extend:r,merge:n,pick:a}=i;return function(l){function c(u,g,p){let C=this.legendItem=this.legendItem||{},{chart:y,options:S}=this,{baseline:O=0,symbolWidth:M,symbolHeight:_}=u,N=this.symbol||"circle",E=_/2,k=y.renderer,ie=C.group,$=O-Math.round(_*(p?.4:.3)),H={},Q,Y=S.marker,P=0;if(y.styledMode||(H["stroke-width"]=Math.min(S.lineWidth||0,24),S.dashStyle?H.dashstyle=S.dashStyle:S.linecap==="square"||(H["stroke-linecap"]="round")),C.line=k.path().addClass("highcharts-graph").attr(H).add(ie),p&&(C.area=k.path().addClass("highcharts-area").add(ie)),H["stroke-linecap"]&&(P=Math.min(C.line.strokeWidth(),M)/2),M){let j=[["M",P,$],["L",M-P,$]];C.line.attr({d:j}),C.area?.attr({d:[...j,["L",M-P,O],["L",P,O]]})}if(Y&&Y.enabled!==!1&&M){let j=Math.min(a(Y.radius,E),E);N.indexOf("url")===0&&(Y=n(Y,{width:_,height:_}),j=0),C.symbol=Q=k.symbol(N,M/2-j,$-j,2*j,2*j,r({context:"legend"},Y)).addClass("highcharts-point").add(ie),Q.isMarker=!0}}l.areaMarker=function(u,g){c.call(this,u,g,!0)},l.lineMarker=c,l.rectangle=function(u,g){let p=g.legendItem||{},C=u.options,y=u.symbolHeight,S=C.squareSymbol,O=S?y:u.symbolWidth;p.symbol=this.chart.renderer.rect(S?(u.symbolWidth-y)/2:0,u.baseline-y+1,O,y,a(u.options.symbolRadius,y/2)).addClass("highcharts-point").attr({zIndex:3}).add(p.group)}}(s||(s={})),s}),t(e,"Core/Series/SeriesDefaults.js",[],function(){return{lineWidth:2,allowPointSelect:!1,crisp:!0,showCheckbox:!1,animation:{duration:1e3},enableMouseTracking:!0,events:{},marker:{enabledThreshold:2,lineColor:"#ffffff",lineWidth:0,radius:4,states:{normal:{animation:!0},hover:{animation:{duration:150},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{animation:{},align:"center",borderWidth:0,defer:!0,formatter:function(){let{numberFormatter:i}=this.series.chart;return typeof this.y!="number"?"":i(this.y,-1)},padding:5,style:{fontSize:"0.7em",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0},cropThreshold:300,opacity:1,pointRange:0,softThreshold:!0,states:{normal:{animation:!0},hover:{animation:{duration:150},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{animation:{duration:0}},inactive:{animation:{duration:150},opacity:.2}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"}}),t(e,"Core/Series/SeriesRegistry.js",[e["Core/Globals.js"],e["Core/Defaults.js"],e["Core/Series/Point.js"],e["Core/Utilities.js"]],function(i,s,r,n){var a;let{defaultOptions:l}=s,{extendClass:c,merge:u}=n;return function(g){function p(C,y){let S=l.plotOptions||{},O=y.defaultOptions,M=y.prototype;M.type=C,M.pointClass||(M.pointClass=r),O&&(S[C]=O),g.seriesTypes[C]=y}g.seriesTypes=i.seriesTypes,g.registerSeriesType=p,g.seriesType=function(C,y,S,O,M){let _=l.plotOptions||{};return y=y||"",_[C]=u(_[y],S),p(C,c(g.seriesTypes[y]||function(){},O)),g.seriesTypes[C].prototype.type=C,M&&(g.seriesTypes[C].prototype.pointClass=c(r,M)),g.seriesTypes[C]}}(a||(a={})),a}),t(e,"Core/Series/Series.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Defaults.js"],e["Core/Foundation.js"],e["Core/Globals.js"],e["Core/Legend/LegendSymbol.js"],e["Core/Series/Point.js"],e["Core/Series/SeriesDefaults.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Renderer/SVG/SVGElement.js"],e["Core/Utilities.js"]],function(i,s,r,n,a,l,c,u,g,p){let{animObject:C,setAnimation:y}=i,{defaultOptions:S}=s,{registerEventOptions:O}=r,{hasTouch:M,svg:_,win:N}=n,{seriesTypes:E}=u,{arrayMax:k,arrayMin:ie,clamp:$,correctFloat:H,defined:Q,destroyObjectProperties:Y,diffObjects:P,erase:j,error:A,extend:v,find:R,fireEvent:f,getClosestDistance:w,getNestedProperty:b,insertItem:h,isArray:m,isNumber:x,isString:I,merge:B,objectEach:V,pick:U,removeEvent:K,splat:L,syncTimeout:X}=p;class q{constructor(){this.zoneAxis="y"}init(D,F){let oe;f(this,"init",{options:F});let ne=this,ae=D.series;this.eventsToUnbind=[],ne.chart=D,ne.options=ne.setOptions(F);let fe=ne.options,me=fe.visible!==!1;ne.linkedSeries=[],ne.bindAxes(),v(ne,{name:fe.name,state:"",visible:me,selected:fe.selected===!0}),O(this,fe);let G=fe.events;(G&&G.click||fe.point&&fe.point.events&&fe.point.events.click||fe.allowPointSelect)&&(D.runTrackerClick=!0),ne.getColor(),ne.getSymbol(),ne.parallelArrays.forEach(function(se){ne[se+"Data"]||(ne[se+"Data"]=[])}),ne.isCartesian&&(D.hasCartesianSeries=!0),ae.length&&(oe=ae[ae.length-1]),ne._i=U(oe&&oe._i,-1)+1,ne.opacity=ne.options.opacity,D.orderItems("series",h(this,ae)),fe.dataSorting&&fe.dataSorting.enabled?ne.setDataSortingOptions():ne.points||ne.data||ne.setData(fe.data,!1),f(this,"afterInit")}is(D){return E[D]&&this instanceof E[D]}bindAxes(){let D,F=this,oe=F.options,ne=F.chart;f(this,"bindAxes",null,function(){(F.axisTypes||[]).forEach(function(ae){ne[ae].forEach(function(fe){D=fe.options,(U(oe[ae],0)===fe.index||oe[ae]!==void 0&&oe[ae]===D.id)&&(h(F,fe.series),F[ae]=fe,fe.isDirty=!0)}),F[ae]||F.optionalAxis===ae||A(18,!0,ne)})}),f(this,"afterBindAxes")}updateParallelArrays(D,F,oe){let ne=D.series,ae=x(F)?function(fe){let me=fe==="y"&&ne.toYData?ne.toYData(D):D[fe];ne[fe+"Data"][F]=me}:function(fe){Array.prototype[F].apply(ne[fe+"Data"],oe)};ne.parallelArrays.forEach(ae)}hasData(){return this.visible&&this.dataMax!==void 0&&this.dataMin!==void 0||this.visible&&this.yData&&this.yData.length>0}hasMarkerChanged(D,F){let oe=D.marker,ne=F.marker||{};return oe&&(ne.enabled&&!oe.enabled||ne.symbol!==oe.symbol||ne.height!==oe.height||ne.width!==oe.width)}autoIncrement(D){let F=this.options,oe=F.pointIntervalUnit,ne=F.relativeXValue,ae=this.chart.time,fe=this.xIncrement,me,G;return fe=U(fe,F.pointStart,0),this.pointInterval=G=U(this.pointInterval,F.pointInterval,1),ne&&x(D)&&(G*=D),oe&&(me=new ae.Date(fe),oe==="day"?ae.set("Date",me,ae.get("Date",me)+G):oe==="month"?ae.set("Month",me,ae.get("Month",me)+G):oe==="year"&&ae.set("FullYear",me,ae.get("FullYear",me)+G),G=me.getTime()-fe),ne&&x(D)?fe+G:(this.xIncrement=fe+G,fe)}setDataSortingOptions(){let D=this.options;v(this,{requireSorting:!1,sorted:!1,enabledDataSorting:!0,allowDG:!1}),Q(D.pointRange)||(D.pointRange=1)}setOptions(D){let F,oe=this.chart,ne=oe.options,ae=ne.plotOptions,fe=oe.userOptions||{},me=B(D),G=oe.styledMode,se={plotOptions:ae,userOptions:me};f(this,"setOptions",se);let ee=se.plotOptions[this.type],ue=fe.plotOptions||{},de=ue.series||{},W=S.plotOptions[this.type]||{},z=ue[this.type]||{};this.userOptions=se.userOptions;let Z=B(ee,ae.series,z,me);this.tooltipOptions=B(S.tooltip,S.plotOptions.series?.tooltip,W?.tooltip,oe.userOptions.tooltip,ue.series?.tooltip,z.tooltip,me.tooltip),this.stickyTracking=U(me.stickyTracking,z.stickyTracking,de.stickyTracking,!!this.tooltipOptions.shared&&!this.noSharedTooltip||Z.stickyTracking),ee.marker===null&&delete Z.marker,this.zoneAxis=Z.zoneAxis||"y";let te=this.zones=(Z.zones||[]).slice();return(Z.negativeColor||Z.negativeFillColor)&&!Z.zones&&(F={value:Z[this.zoneAxis+"Threshold"]||Z.threshold||0,className:"highcharts-negative"},G||(F.color=Z.negativeColor,F.fillColor=Z.negativeFillColor),te.push(F)),te.length&&Q(te[te.length-1].value)&&te.push(G?{}:{color:this.color,fillColor:this.fillColor}),f(this,"afterSetOptions",{options:Z}),Z}getName(){return U(this.options.name,"Series "+(this.index+1))}getCyclic(D,F,oe){let ne,ae,fe=this.chart,me=`${D}Index`,G=`${D}Counter`,se=oe?.length||fe.options.chart.colorCount;!F&&(Q(ae=U(D==="color"?this.options.colorIndex:void 0,this[me]))?ne=ae:(fe.series.length||(fe[G]=0),ne=fe[G]%se,fe[G]+=1),oe&&(F=oe[ne])),ne!==void 0&&(this[me]=ne),this[D]=F}getColor(){this.chart.styledMode?this.getCyclic("color"):this.options.colorByPoint?this.color="#cccccc":this.getCyclic("color",this.options.color||S.plotOptions[this.type].color,this.chart.options.colors)}getPointsCollection(){return(this.hasGroupedData?this.points:this.data)||[]}getSymbol(){let D=this.options.marker;this.getCyclic("symbol",D.symbol,this.chart.options.symbols)}findPointIndex(D,F){let oe,ne,ae,fe=D.id,me=D.x,G=this.points,se=this.options.dataSorting;if(fe){let ee=this.chart.get(fe);ee instanceof l&&(oe=ee)}else if(this.linkedParent||this.enabledDataSorting||this.options.relativeXValue){let ee=ue=>!ue.touched&&ue.index===D.index;if(se&&se.matchByName?ee=ue=>!ue.touched&&ue.name===D.name:this.options.relativeXValue&&(ee=ue=>!ue.touched&&ue.options.x===D.x),!(oe=R(G,ee)))return}return oe&&(ae=oe&&oe.index)!==void 0&&(ne=!0),ae===void 0&&x(me)&&(ae=this.xData.indexOf(me,F)),ae!==-1&&ae!==void 0&&this.cropped&&(ae=ae>=this.cropStart?ae-this.cropStart:ae),!ne&&x(ae)&&G[ae]&&G[ae].touched&&(ae=void 0),ae}updateData(D,F){let oe=this.options,ne=oe.dataSorting,ae=this.points,fe=[],me=this.requireSorting,G=D.length===ae.length,se,ee,ue,de,W=!0;if(this.xIncrement=null,D.forEach(function(z,Z){let te,re=Q(z)&&this.pointClass.prototype.optionsToObject.call({series:this},z)||{},ce=re.x;re.id||x(ce)?((te=this.findPointIndex(re,de))===-1||te===void 0?fe.push(z):ae[te]&&z!==oe.data[te]?(ae[te].update(z,!1,null,!1),ae[te].touched=!0,me&&(de=te+1)):ae[te]&&(ae[te].touched=!0),(!G||Z!==te||ne&&ne.enabled||this.hasDerivedData)&&(se=!0)):fe.push(z)},this),se)for(ee=ae.length;ee--;)(ue=ae[ee])&&!ue.touched&&ue.remove&&ue.remove(!1,F);else!G||ne&&ne.enabled?W=!1:(D.forEach(function(z,Z){z===ae[Z].y||ae[Z].destroyed||ae[Z].update(z,!1,null,!1)}),fe.length=0);return ae.forEach(function(z){z&&(z.touched=!1)}),!!W&&(fe.forEach(function(z){this.addPoint(z,!1,null,null,!1)},this),this.xIncrement===null&&this.xData&&this.xData.length&&(this.xIncrement=k(this.xData),this.autoIncrement()),!0)}setData(D,F=!0,oe,ne){let ae=this,fe=ae.points,me=fe&&fe.length||0,G=ae.options,se=ae.chart,ee=G.dataSorting,ue=ae.xAxis,de=G.turboThreshold,W=this.xData,z=this.yData,Z=ae.pointArrayMap,te=Z&&Z.length,re=G.keys,ce,Ce,ge,ye=0,Ee=1,Se=null,be;se.options.chart.allowMutatingData||(G.data&&delete ae.options.data,ae.userOptions.data&&delete ae.userOptions.data,be=B(!0,D)),D=be||D||[];let Re=D.length;if(ee&&ee.enabled&&(D=this.sortData(D)),se.options.chart.allowMutatingData&&ne!==!1&&Re&&me&&!ae.cropped&&!ae.hasGroupedData&&ae.visible&&!ae.boosted&&(ge=this.updateData(D,oe)),!ge){if(ae.xIncrement=null,ae.colorCounter=0,this.parallelArrays.forEach(function(Ae){ae[Ae+"Data"].length=0}),de&&Re>de)if(x(Se=ae.getFirstValidPoint(D)))for(ce=0;ce<Re;ce++)W[ce]=this.autoIncrement(),z[ce]=D[ce];else if(m(Se))if(te)if(Se.length===te)for(ce=0;ce<Re;ce++)W[ce]=this.autoIncrement(),z[ce]=D[ce];else for(ce=0;ce<Re;ce++)Ce=D[ce],W[ce]=Ce[0],z[ce]=Ce.slice(1,te+1);else if(re&&(ye=re.indexOf("x"),Ee=re.indexOf("y"),ye=ye>=0?ye:0,Ee=Ee>=0?Ee:1),Se.length===1&&(Ee=0),ye===Ee)for(ce=0;ce<Re;ce++)W[ce]=this.autoIncrement(),z[ce]=D[ce][Ee];else for(ce=0;ce<Re;ce++)Ce=D[ce],W[ce]=Ce[ye],z[ce]=Ce[Ee];else A(12,!1,se);else for(ce=0;ce<Re;ce++)Ce={series:ae},ae.pointClass.prototype.applyOptions.apply(Ce,[D[ce]]),ae.updateParallelArrays(Ce,ce);for(z&&I(z[0])&&A(14,!0,se),ae.data=[],ae.options.data=ae.userOptions.data=D,ce=me;ce--;)fe[ce]?.destroy();ue&&(ue.minRange=ue.userMinRange),ae.isDirty=se.isDirtyBox=!0,ae.isDirtyData=!!fe,oe=!1}G.legendType==="point"&&(this.processData(),this.generatePoints()),F&&se.redraw(oe)}sortData(D){let F=this,oe=F.options,ne=oe.dataSorting,ae=ne.sortKey||"y",fe=function(G,se){return Q(se)&&G.pointClass.prototype.optionsToObject.call({series:G},se)||{}};return D.forEach(function(G,se){D[se]=fe(F,G),D[se].index=se},this),D.concat().sort((G,se)=>{let ee=b(ae,G),ue=b(ae,se);return ue<ee?-1:ue>ee?1:0}).forEach(function(G,se){G.x=se},this),F.linkedSeries&&F.linkedSeries.forEach(function(G){let se=G.options,ee=se.data;se.dataSorting&&se.dataSorting.enabled||!ee||(ee.forEach(function(ue,de){ee[de]=fe(G,ue),D[de]&&(ee[de].x=D[de].x,ee[de].index=de)}),G.setData(ee,!1))}),D}getProcessedData(D){let F=this,oe=F.xAxis,ne=F.options,ae=ne.cropThreshold,fe=D||F.getExtremesFromAll||ne.getExtremesFromAll,me=oe?.logarithmic,G=F.isCartesian,se,ee,ue=0,de,W,z,Z=F.xData,te=F.yData,re=!1,ce=Z.length;oe&&(W=(de=oe.getExtremes()).min,z=de.max,re=!!(oe.categories&&!oe.names.length)),G&&F.sorted&&!fe&&(!ae||ce>ae||F.forceCrop)&&(Z[ce-1]<W||Z[0]>z?(Z=[],te=[]):F.yData&&(Z[0]<W||Z[ce-1]>z)&&(Z=(se=this.cropData(F.xData,F.yData,W,z)).xData,te=se.yData,ue=se.start,ee=!0));let Ce=w([me?Z.map(me.log2lin):Z],()=>F.requireSorting&&!re&&A(15,!1,F.chart));return{xData:Z,yData:te,cropped:ee,cropStart:ue,closestPointRange:Ce}}processData(D){let F=this.xAxis;if(this.isCartesian&&!this.isDirty&&!F.isDirty&&!this.yAxis.isDirty&&!D)return!1;let oe=this.getProcessedData();this.cropped=oe.cropped,this.cropStart=oe.cropStart,this.processedXData=oe.xData,this.processedYData=oe.yData,this.closestPointRange=this.basePointRange=oe.closestPointRange,f(this,"afterProcessData")}cropData(D,F,oe,ne){let ae=D.length,fe,me,G=0,se=ae;for(fe=0;fe<ae;fe++)if(D[fe]>=oe){G=Math.max(0,fe-1);break}for(me=fe;me<ae;me++)if(D[me]>ne){se=me+1;break}return{xData:D.slice(G,se),yData:F.slice(G,se),start:G,end:se}}generatePoints(){let D=this.options,F=this.processedData||D.data,oe=this.processedXData,ne=this.processedYData,ae=this.pointClass,fe=oe.length,me=this.cropStart||0,G=this.hasGroupedData,se=D.keys,ee=[],ue=D.dataGrouping&&D.dataGrouping.groupAll?me:0,de,W,z,Z,te=this.data;if(!te&&!G){let re=[];re.length=F.length,te=this.data=re}for(se&&G&&(this.options.keys=!1),Z=0;Z<fe;Z++)W=me+Z,G?((z=new ae(this,[oe[Z]].concat(L(ne[Z])))).dataGroup=this.groupMap[ue+Z],z.dataGroup.options&&(z.options=z.dataGroup.options,v(z,z.dataGroup.options),delete z.dataLabels)):(z=te[W])||F[W]===void 0||(te[W]=z=new ae(this,F[W],oe[Z])),z&&(z.index=G?ue+Z:W,ee[Z]=z);if(this.options.keys=se,te&&(fe!==(de=te.length)||G))for(Z=0;Z<de;Z++)Z!==me||G||(Z+=fe),te[Z]&&(te[Z].destroyElements(),te[Z].plotX=void 0);this.data=te,this.points=ee,f(this,"afterGeneratePoints")}getXExtremes(D){return{min:ie(D),max:k(D)}}getExtremes(D,F){let oe=this.xAxis,ne=this.yAxis,ae=this.processedXData||this.xData,fe=[],me=this.requireSorting&&!this.is("column")?1:0,G=!!ne&&ne.positiveValuesOnly,se,ee,ue,de,W,z,Z,te=0,re=0,ce=0;D=D||this.stackedYData||this.processedYData||[];let Ce=D.length;for(oe&&(te=(se=oe.getExtremes()).min,re=se.max),z=0;z<Ce;z++)if(de=ae[z],ee=(x(W=D[z])||m(W))&&((x(W)?W>0:W.length)||!G),ue=F||this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||!oe||(ae[z+me]||de)>=te&&(ae[z-me]||de)<=re,ee&&ue)if(Z=W.length)for(;Z--;)x(W[Z])&&(fe[ce++]=W[Z]);else fe[ce++]=W;let ge={activeYData:fe,dataMin:ie(fe),dataMax:k(fe)};return f(this,"afterGetExtremes",{dataExtremes:ge}),ge}applyExtremes(){let D=this.getExtremes();return this.dataMin=D.dataMin,this.dataMax=D.dataMax,D}getFirstValidPoint(D){let F=D.length,oe=0,ne=null;for(;ne===null&&oe<F;)ne=D[oe],oe++;return ne}translate(){this.processedXData||this.processData(),this.generatePoints();let D=this.options,F=D.stacking,oe=this.xAxis,ne=oe.categories,ae=this.enabledDataSorting,fe=this.yAxis,me=this.points,G=me.length,se=this.pointPlacementToXValue(),ee=!!se,ue=D.threshold,de=D.startFromThreshold?ue:0,W,z,Z,te,re=Number.MAX_VALUE;function ce(Ce){return $(Ce,-1e5,1e5)}for(W=0;W<G;W++){let Ce,ge=me[W],ye=ge.x,Ee,Se,be=ge.y,Re=ge.low,Ae=F&&fe.stacking?.stacks[(this.negStacks&&be<(de?0:ue)?"-":"")+this.stackKey];z=oe.translate(ye,!1,!1,!1,!0,se),ge.plotX=x(z)?H(ce(z)):void 0,F&&this.visible&&Ae&&Ae[ye]&&(te=this.getStackIndicator(te,ye,this.index),!ge.isNull&&te.key&&(Se=(Ee=Ae[ye]).points[te.key]),Ee&&m(Se)&&(Re=Se[0],be=Se[1],Re===de&&te.key===Ae[ye].base&&(Re=U(x(ue)?ue:fe.min)),fe.positiveValuesOnly&&Q(Re)&&Re<=0&&(Re=void 0),ge.total=ge.stackTotal=U(Ee.total),ge.percentage=Q(ge.y)&&Ee.total?ge.y/Ee.total*100:void 0,ge.stackY=be,this.irregularWidths||Ee.setOffset(this.pointXOffset||0,this.barW||0,void 0,void 0,void 0,this.xAxis))),ge.yBottom=Q(Re)?ce(fe.translate(Re,!1,!0,!1,!0)):void 0,this.dataModify&&(be=this.dataModify.modifyValue(be,W)),x(be)&&ge.plotX!==void 0&&(Ce=x(Ce=fe.translate(be,!1,!0,!1,!0))?ce(Ce):void 0),ge.plotY=Ce,ge.isInside=this.isPointInside(ge),ge.clientX=ee?H(oe.translate(ye,!1,!1,!1,!0,se)):z,ge.negative=(ge.y||0)<(ue||0),ge.category=U(ne&&ne[ge.x],ge.x),ge.isNull||ge.visible===!1||(Z!==void 0&&(re=Math.min(re,Math.abs(z-Z))),Z=z),ge.zone=this.zones.length?ge.getZone():void 0,!ge.graphic&&this.group&&ae&&(ge.isNew=!0)}this.closestPointRangePx=re,f(this,"afterTranslate")}getValidPoints(D,F,oe){let ne=this.chart;return(D||this.points||[]).filter(function(ae){let{plotX:fe,plotY:me}=ae;return!(!oe&&(ae.isNull||!x(me)))&&(!F||!!ne.isInsidePlot(fe,me,{inverted:ne.inverted}))&&ae.visible!==!1})}getClipBox(){let{chart:D,xAxis:F,yAxis:oe}=this,ne=B(D.clipBox);return F&&F.len!==D.plotSizeX&&(ne.width=F.len),oe&&oe.len!==D.plotSizeY&&(ne.height=oe.len),ne}getSharedClipKey(){return this.sharedClipKey=(this.options.xAxis||0)+","+(this.options.yAxis||0),this.sharedClipKey}setClip(){let{chart:D,group:F,markerGroup:oe}=this,ne=D.sharedClips,ae=D.renderer,fe=this.getClipBox(),me=this.getSharedClipKey(),G=ne[me];G?G.animate(fe):ne[me]=G=ae.clipRect(fe),F&&F.clip(this.options.clip===!1?void 0:G),oe&&oe.clip()}animate(D){let{chart:F,group:oe,markerGroup:ne}=this,ae=F.inverted,fe=C(this.options.animation),me=[this.getSharedClipKey(),fe.duration,fe.easing,fe.defer].join(","),G=F.sharedClips[me],se=F.sharedClips[me+"m"];if(D&&oe){let ee=this.getClipBox();if(G)G.attr("height",ee.height);else{ee.width=0,ae&&(ee.x=F.plotHeight),G=F.renderer.clipRect(ee),F.sharedClips[me]=G;let ue={x:-99,y:-99,width:ae?F.plotWidth+199:99,height:ae?99:F.plotHeight+199};se=F.renderer.clipRect(ue),F.sharedClips[me+"m"]=se}oe.clip(G),ne&&ne.clip(se)}else if(G&&!G.hasClass("highcharts-animating")){let ee=this.getClipBox(),ue=fe.step;ne&&ne.element.childNodes.length&&(fe.step=function(de,W){ue&&ue.apply(W,arguments),W.prop==="width"&&se&&se.element&&se.attr(ae?"height":"width",de+99)}),G.addClass("highcharts-animating").animate(ee,fe)}}afterAnimate(){this.setClip(),V(this.chart.sharedClips,(D,F,oe)=>{D&&!this.chart.container.querySelector(`[clip-path="url(#${D.id})"]`)&&(D.destroy(),delete oe[F])}),this.finishedAnimating=!0,f(this,"afterAnimate")}drawPoints(D=this.points){let F,oe,ne,ae,fe,me,G,se=this.chart,ee=se.styledMode,{colorAxis:ue,options:de}=this,W=de.marker,z=this[this.specialGroup||"markerGroup"],Z=this.xAxis,te=U(W.enabled,!Z||!!Z.isRadial||null,this.closestPointRangePx>=W.enabledThreshold*W.radius);if(W.enabled!==!1||this._hasPointMarkers)for(F=0;F<D.length;F++)if(ae=(ne=(oe=D[F]).graphic)?"animate":"attr",fe=oe.marker||{},me=!!oe.marker,(te&&fe.enabled===void 0||fe.enabled)&&!oe.isNull&&oe.visible!==!1){let ce=U(fe.symbol,this.symbol,"rect");G=this.markerAttribs(oe,oe.selected&&"select"),this.enabledDataSorting&&(oe.startXPos=Z.reversed?-(G.width||0):Z.width);let Ce=oe.isInside!==!1;if(!ne&&Ce&&((G.width||0)>0||oe.hasImage)&&(oe.graphic=ne=se.renderer.symbol(ce,G.x,G.y,G.width,G.height,me?fe:W).add(z),this.enabledDataSorting&&se.hasRendered&&(ne.attr({x:oe.startXPos}),ae="animate")),ne&&ae==="animate"&&ne[Ce?"show":"hide"](Ce).animate(G),ne){let ge=this.pointAttribs(oe,ee||!oe.selected?void 0:"select");ee?ue&&ne.css({fill:ge.fill}):ne[ae](ge)}ne&&ne.addClass(oe.getClassName(),!0)}else ne&&(oe.graphic=ne.destroy())}markerAttribs(D,F){let oe=this.options,ne=oe.marker,ae=D.marker||{},fe=ae.symbol||ne.symbol,me={},G,se,ee=U(ae.radius,ne&&ne.radius);F&&(G=ne.states[F],ee=U((se=ae.states&&ae.states[F])&&se.radius,G&&G.radius,ee&&ee+(G&&G.radiusPlus||0))),D.hasImage=fe&&fe.indexOf("url")===0,D.hasImage&&(ee=0);let ue=D.pos();return x(ee)&&ue&&(me.x=ue[0]-ee,me.y=ue[1]-ee,oe.crisp&&(me.x=Math.floor(me.x))),ee&&(me.width=me.height=2*ee),me}pointAttribs(D,F){let oe=this.options.marker,ne=D&&D.options,ae=ne&&ne.marker||{},fe=ne&&ne.color,me=D&&D.color,G=D&&D.zone&&D.zone.color,se,ee,ue=this.color,de,W,z=U(ae.lineWidth,oe.lineWidth),Z=1;return ue=fe||G||me||ue,de=ae.fillColor||oe.fillColor||ue,W=ae.lineColor||oe.lineColor||ue,F=F||"normal",se=oe.states[F]||{},z=U((ee=ae.states&&ae.states[F]||{}).lineWidth,se.lineWidth,z+U(ee.lineWidthPlus,se.lineWidthPlus,0)),de=ee.fillColor||se.fillColor||de,{stroke:W=ee.lineColor||se.lineColor||W,"stroke-width":z,fill:de,opacity:Z=U(ee.opacity,se.opacity,Z)}}destroy(D){let F,oe,ne,ae=this,fe=ae.chart,me=/AppleWebKit\/533/.test(N.navigator.userAgent),G=ae.data||[];for(f(ae,"destroy",{keepEventsForUpdate:D}),this.removeEvents(D),(ae.axisTypes||[]).forEach(function(se){(ne=ae[se])&&ne.series&&(j(ne.series,ae),ne.isDirty=ne.forceRedraw=!0)}),ae.legendItem&&ae.chart.legend.destroyItem(ae),F=G.length;F--;)(oe=G[F])&&oe.destroy&&oe.destroy();ae.zones.forEach(Y),p.clearTimeout(ae.animationTimeout),V(ae,function(se,ee){se instanceof g&&!se.survive&&se[me&&ee==="group"?"hide":"destroy"]()}),fe.hoverSeries===ae&&(fe.hoverSeries=void 0),j(fe.series,ae),fe.orderItems("series"),V(ae,function(se,ee){D&&ee==="hcEvents"||delete ae[ee]})}applyZones(){let{area:D,chart:F,graph:oe,zones:ne,points:ae,xAxis:fe,yAxis:me,zoneAxis:G}=this,{inverted:se,renderer:ee}=F,ue=this[`${G}Axis`],{isXAxis:de,len:W=0}=ue||{},z=(oe?.strokeWidth()||0)/2+1,Z=(te,re=0,ce=0)=>{se&&(ce=W-ce);let{translated:Ce=0,lineClip:ge}=te,ye=ce-Ce;ge?.push(["L",re,Math.abs(ye)<z?ce-z*(ye<=0?-1:1):Ce])};if(ne.length&&(oe||D)&&ue&&x(ue.min)){let te=ue.getExtremes().max,re=ge=>{ge.forEach((ye,Ee)=>{(ye[0]==="M"||ye[0]==="L")&&(ge[Ee]=[ye[0],de?W-ye[1]:ye[1],de?ye[2]:W-ye[2]])})};if(ne.forEach((ge,ye)=>{ge.lineClip=[],ge.translated=$(ue.toPixels(U(ge.value,te),!0)||0,0,W)}),oe&&!this.showLine&&oe.hide(),D&&D.hide(),G==="y"&&ae.length<fe.len)for(let ge of ae){let{plotX:ye,plotY:Ee,zone:Se}=ge,be=Se&&ne[ne.indexOf(Se)-1];Se&&Z(Se,ye,Ee),be&&Z(be,ye,Ee)}let ce=[],Ce=ue.toPixels(ue.getExtremes().min,!0);ne.forEach(ge=>{let ye=ge.lineClip||[],Ee=Math.round(ge.translated||0);fe.reversed&&ye.reverse();let{clip:Se,simpleClip:be}=ge,Re=0,Ae=0,Ne=fe.len,Me=me.len;de?(Re=Ee,Ne=Ce):(Ae=Ee,Me=Ce);let Ze=[["M",Re,Ae],["L",Ne,Ae],["L",Ne,Me],["L",Re,Me],["Z"]],it=[Ze[0],...ye,Ze[1],Ze[2],...ce,Ze[3],Ze[4]];ce=ye.reverse(),Ce=Ee,se&&(re(it),D&&re(Ze)),Se?(Se.animate({d:it}),be?.animate({d:Ze})):(Se=ge.clip=ee.path(it),D&&(be=ge.simpleClip=ee.path(Ze))),oe&&ge.graph?.clip(Se),D&&ge.area?.clip(be)})}else this.visible&&(oe&&oe.show(),D&&D.show())}plotGroup(D,F,oe,ne,ae){let fe=this[D],me=!fe,G={visibility:oe,zIndex:ne||.1};return Q(this.opacity)&&!this.chart.styledMode&&this.state!=="inactive"&&(G.opacity=this.opacity),fe||(this[D]=fe=this.chart.renderer.g().add(ae)),fe.addClass("highcharts-"+F+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(Q(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(fe.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0),fe.attr(G)[me?"attr":"animate"](this.getPlotBox(F)),fe}getPlotBox(D){let F=this.xAxis,oe=this.yAxis,ne=this.chart,ae=ne.inverted&&!ne.polar&&F&&this.invertible!==!1&&D==="series";return ne.inverted&&(F=oe,oe=this.xAxis),{translateX:F?F.left:ne.plotLeft,translateY:oe?oe.top:ne.plotTop,rotation:ae?90:0,rotationOriginX:ae?(F.len-oe.len)/2:0,rotationOriginY:ae?(F.len+oe.len)/2:0,scaleX:ae?-1:1,scaleY:1}}removeEvents(D){let{eventsToUnbind:F}=this;D||K(this),F.length&&(F.forEach(oe=>{oe()}),F.length=0)}render(){let D=this,{chart:F,options:oe,hasRendered:ne}=D,ae=C(oe.animation),fe=D.visible?"inherit":"hidden",me=oe.zIndex,G=F.seriesGroup,se=D.finishedAnimating?0:ae.duration;f(this,"render"),D.plotGroup("group","series",fe,me,G),D.markerGroup=D.plotGroup("markerGroup","markers",fe,me,G),oe.clip!==!1&&D.setClip(),se&&D.animate?.(!0),D.drawGraph&&(D.drawGraph(),D.applyZones()),D.visible&&D.drawPoints(),D.drawDataLabels?.(),D.redrawPoints?.(),oe.enableMouseTracking&&D.drawTracker?.(),se&&D.animate?.(),ne||(se&&ae.defer&&(se+=ae.defer),D.animationTimeout=X(()=>{D.afterAnimate()},se||0)),D.isDirty=!1,D.hasRendered=!0,f(D,"afterRender")}redraw(){let D=this.isDirty||this.isDirtyData;this.translate(),this.render(),D&&delete this.kdTree}reserveSpace(){return this.visible||!this.chart.options.chart.ignoreHiddenSeries}searchPoint(D,F){let{xAxis:oe,yAxis:ne}=this,ae=this.chart.inverted;return this.searchKDTree({clientX:ae?oe.len-D.chartY+oe.pos:D.chartX-oe.pos,plotY:ae?ne.len-D.chartX+ne.pos:D.chartY-ne.pos},F,D)}buildKDTree(D){this.buildingKdTree=!0;let F=this,oe=F.options.findNearestPointBy.indexOf("y")>-1?2:1;delete F.kdTree,X(function(){F.kdTree=function ne(ae,fe,me){let G,se,ee=ae?.length;if(ee)return G=F.kdAxisArray[fe%me],ae.sort((ue,de)=>(ue[G]||0)-(de[G]||0)),{point:ae[se=Math.floor(ee/2)],left:ne(ae.slice(0,se),fe+1,me),right:ne(ae.slice(se+1),fe+1,me)}}(F.getValidPoints(void 0,!F.directTouch),oe,oe),F.buildingKdTree=!1},F.options.kdNow||D?.type==="touchstart"?0:1)}searchKDTree(D,F,oe){let ne=this,[ae,fe]=this.kdAxisArray,me=F?"distX":"dist",G=(ne.options.findNearestPointBy||"").indexOf("y")>-1?2:1,se=!!ne.isBubble;if(this.kdTree||this.buildingKdTree||this.buildKDTree(oe),this.kdTree)return function ee(ue,de,W,z){let Z=de.point,te=ne.kdAxisArray[W%z],re,ce,Ce=Z;(function(Se,be){let Re=Se[ae],Ae=be[ae],Ne=Q(Re)&&Q(Ae)?Re-Ae:null,Me=Se[fe],Ze=be[fe],it=Q(Me)&&Q(Ze)?Me-Ze:0,rt=se&&be.marker?.radius||0;be.dist=Math.sqrt((Ne&&Ne*Ne||0)+it*it)-rt,be.distX=Q(Ne)?Math.abs(Ne)-rt:Number.MAX_VALUE})(ue,Z);let ge=(ue[te]||0)-(Z[te]||0)+(se&&Z.marker?.radius||0),ye=ge<0?"left":"right",Ee=ge<0?"right":"left";return de[ye]&&(Ce=(re=ee(ue,de[ye],W+1,z))[me]<Ce[me]?re:Z),de[Ee]&&Math.sqrt(ge*ge)<Ce[me]&&(Ce=(ce=ee(ue,de[Ee],W+1,z))[me]<Ce[me]?ce:Ce),Ce}(D,this.kdTree,G,G)}pointPlacementToXValue(){let{options:D,xAxis:F}=this,oe=D.pointPlacement;return oe==="between"&&(oe=F.reversed?-.5:.5),x(oe)?oe*(D.pointRange||F.pointRange):0}isPointInside(D){let{chart:F,xAxis:oe,yAxis:ne}=this,{plotX:ae=-1,plotY:fe=-1}=D;return fe>=0&&fe<=(ne?ne.len:F.plotHeight)&&ae>=0&&ae<=(oe?oe.len:F.plotWidth)}drawTracker(){let D=this,F=D.options,oe=F.trackByArea,ne=[].concat((oe?D.areaPath:D.graphPath)||[]),ae=D.chart,fe=ae.pointer,me=ae.renderer,G=ae.options.tooltip?.snap||0,se=()=>{F.enableMouseTracking&&ae.hoverSeries!==D&&D.onMouseOver()},ee="rgba(192,192,192,"+(_?1e-4:.002)+")",ue=D.tracker;ue?ue.attr({d:ne}):D.graph&&(D.tracker=ue=me.path(ne).attr({visibility:D.visible?"inherit":"hidden",zIndex:2}).addClass(oe?"highcharts-tracker-area":"highcharts-tracker-line").add(D.group),ae.styledMode||ue.attr({"stroke-linecap":"round","stroke-linejoin":"round",stroke:ee,fill:oe?ee:"none","stroke-width":D.graph.strokeWidth()+(oe?0:2*G)}),[D.tracker,D.markerGroup,D.dataLabelsGroup].forEach(de=>{de&&(de.addClass("highcharts-tracker").on("mouseover",se).on("mouseout",W=>{fe.onTrackerMouseOut(W)}),F.cursor&&!ae.styledMode&&de.css({cursor:F.cursor}),M&&de.on("touchstart",se))})),f(this,"afterDrawTracker")}addPoint(D,F,oe,ne,ae){let fe,me,G=this.options,se=this.data,ee=this.chart,ue=this.xAxis,de=ue&&ue.hasNames&&ue.names,W=G.data,z=this.xData;F=U(F,!0);let Z={series:this};this.pointClass.prototype.applyOptions.apply(Z,[D]);let te=Z.x;if(me=z.length,this.requireSorting&&te<z[me-1])for(fe=!0;me&&z[me-1]>te;)me--;this.updateParallelArrays(Z,"splice",[me,0,0]),this.updateParallelArrays(Z,me),de&&Z.name&&(de[te]=Z.name),W.splice(me,0,D),(fe||this.processedData)&&(this.data.splice(me,0,null),this.processData()),G.legendType==="point"&&this.generatePoints(),oe&&(se[0]&&se[0].remove?se[0].remove(!1):(se.shift(),this.updateParallelArrays(Z,"shift"),W.shift())),ae!==!1&&f(this,"addPoint",{point:Z}),this.isDirty=!0,this.isDirtyData=!0,F&&ee.redraw(ne)}removePoint(D,F,oe){let ne=this,ae=ne.data,fe=ae[D],me=ne.points,G=ne.chart,se=function(){me&&me.length===ae.length&&me.splice(D,1),ae.splice(D,1),ne.options.data.splice(D,1),ne.updateParallelArrays(fe||{series:ne},"splice",[D,1]),fe&&fe.destroy(),ne.isDirty=!0,ne.isDirtyData=!0,F&&G.redraw()};y(oe,G),F=U(F,!0),fe?fe.firePointEvent("remove",null,se):se()}remove(D,F,oe,ne){let ae=this,fe=ae.chart;function me(){ae.destroy(ne),fe.isDirtyLegend=fe.isDirtyBox=!0,fe.linkSeries(ne),U(D,!0)&&fe.redraw(F)}oe!==!1?f(ae,"remove",null,me):me()}update(D,F){f(this,"update",{options:D=P(D,this.userOptions)});let oe=this,ne=oe.chart,ae=oe.userOptions,fe=oe.initialType||oe.type,me=ne.options.plotOptions,G=E[fe].prototype,se=oe.finishedAnimating&&{animation:!1},ee={},ue,de,W=["colorIndex","eventOptions","navigatorSeries","symbolIndex","baseSeries"],z=D.type||ae.type||ne.options.chart.type,Z=!(this.hasDerivedData||z&&z!==this.type||D.pointStart!==void 0||D.pointInterval!==void 0||D.relativeXValue!==void 0||D.joinBy||D.mapData||["dataGrouping","pointStart","pointInterval","pointIntervalUnit","keys"].some(re=>oe.hasOptionChanged(re)));z=z||fe,Z&&(W.push("data","isDirtyData","isDirtyCanvas","points","processedData","processedXData","processedYData","xIncrement","cropped","_hasPointMarkers","hasDataLabels","nodes","layout","level","mapMap","mapData","minY","maxY","minX","maxX"),D.visible!==!1&&W.push("area","graph"),oe.parallelArrays.forEach(function(re){W.push(re+"Data")}),D.data&&(D.dataSorting&&v(oe.options.dataSorting,D.dataSorting),this.setData(D.data,!1))),D=B(ae,{index:ae.index===void 0?oe.index:ae.index,pointStart:me?.series?.pointStart??ae.pointStart??oe.xData?.[0]},!Z&&{data:oe.options.data},D,se),Z&&D.data&&(D.data=oe.options.data),(W=["group","markerGroup","dataLabelsGroup","transformGroup"].concat(W)).forEach(function(re){W[re]=oe[re],delete oe[re]});let te=!1;if(E[z]){if(te=z!==oe.type,oe.remove(!1,!1,!1,!0),te)if(Object.setPrototypeOf)Object.setPrototypeOf(oe,E[z].prototype);else{let re=Object.hasOwnProperty.call(oe,"hcEvents")&&oe.hcEvents;for(de in G)oe[de]=void 0;v(oe,E[z].prototype),re?oe.hcEvents=re:delete oe.hcEvents}}else A(17,!0,ne,{missingModuleFor:z});if(W.forEach(function(re){oe[re]=W[re]}),oe.init(ne,D),Z&&this.points)for(let re of((ue=oe.options).visible===!1?(ee.graphic=1,ee.dataLabel=1):(this.hasMarkerChanged(ue,ae)&&(ee.graphic=1),oe.hasDataLabels?.()||(ee.dataLabel=1)),this.points))re&&re.series&&(re.resolveColor(),Object.keys(ee).length&&re.destroyElements(ee),ue.showInLegend===!1&&re.legendItem&&ne.legend.destroyItem(re));oe.initialType=fe,ne.linkSeries(),ne.setSortedData(),te&&oe.linkedSeries.length&&(oe.isDirtyData=!0),f(this,"afterUpdate"),U(F,!0)&&ne.redraw(!!Z&&void 0)}setName(D){this.name=this.options.name=this.userOptions.name=D,this.chart.isDirtyLegend=!0}hasOptionChanged(D){let F=this.chart,oe=this.options[D],ne=F.options.plotOptions,ae=this.userOptions[D],fe=U(ne?.[this.type]?.[D],ne?.series?.[D]);return ae&&!Q(fe)?oe!==ae:oe!==U(fe,oe)}onMouseOver(){let D=this.chart,F=D.hoverSeries;D.pointer.setHoverChartIndex(),F&&F!==this&&F.onMouseOut(),this.options.events.mouseOver&&f(this,"mouseOver"),this.setState("hover"),D.hoverSeries=this}onMouseOut(){let D=this.options,F=this.chart,oe=F.tooltip,ne=F.hoverPoint;F.hoverSeries=null,ne&&ne.onMouseOut(),this&&D.events.mouseOut&&f(this,"mouseOut"),oe&&!this.stickyTracking&&(!oe.shared||this.noSharedTooltip)&&oe.hide(),F.series.forEach(function(ae){ae.setState("",!0)})}setState(D,F){let oe=this,ne=oe.options,ae=oe.graph,fe=ne.inactiveOtherPoints,me=ne.states,G=U(me[D||"normal"]&&me[D||"normal"].animation,oe.chart.options.chart.animation),se=ne.lineWidth,ee=ne.opacity;if(D=D||"",oe.state!==D&&([oe.group,oe.markerGroup,oe.dataLabelsGroup].forEach(function(ue){ue&&(oe.state&&ue.removeClass("highcharts-series-"+oe.state),D&&ue.addClass("highcharts-series-"+D))}),oe.state=D,!oe.chart.styledMode)){if(me[D]&&me[D].enabled===!1)return;if(D&&(se=me[D].lineWidth||se+(me[D].lineWidthPlus||0),ee=U(me[D].opacity,ee)),ae&&!ae.dashstyle&&x(se))for(let ue of[ae,...this.zones.map(de=>de.graph)])ue?.animate({"stroke-width":se},G);fe||[oe.group,oe.markerGroup,oe.dataLabelsGroup,oe.labelBySeries].forEach(function(ue){ue&&ue.animate({opacity:ee},G)})}F&&fe&&oe.points&&oe.setAllPointsToState(D||void 0)}setAllPointsToState(D){this.points.forEach(function(F){F.setState&&F.setState(D)})}setVisible(D,F){let oe=this,ne=oe.chart,ae=ne.options.chart.ignoreHiddenSeries,fe=oe.visible;oe.visible=D=oe.options.visible=oe.userOptions.visible=D===void 0?!fe:D;let me=D?"show":"hide";["group","dataLabelsGroup","markerGroup","tracker","tt"].forEach(G=>{oe[G]?.[me]()}),(ne.hoverSeries===oe||ne.hoverPoint?.series===oe)&&oe.onMouseOut(),oe.legendItem&&ne.legend.colorizeItem(oe,D),oe.isDirty=!0,oe.options.stacking&&ne.series.forEach(G=>{G.options.stacking&&G.visible&&(G.isDirty=!0)}),oe.linkedSeries.forEach(G=>{G.setVisible(D,!1)}),ae&&(ne.isDirtyBox=!0),f(oe,me),F!==!1&&ne.redraw()}show(){this.setVisible(!0)}hide(){this.setVisible(!1)}select(D){this.selected=D=this.options.selected=D===void 0?!this.selected:D,this.checkbox&&(this.checkbox.checked=D),f(this,D?"select":"unselect")}shouldShowTooltip(D,F,oe={}){return oe.series=this,oe.visiblePlotOnly=!0,this.chart.isInsidePlot(D,F,oe)}drawLegendSymbol(D,F){a[this.options.legendSymbol||"rectangle"]?.call(this,D,F)}}return q.defaultOptions=c,q.types=u.seriesTypes,q.registerType=u.registerSeriesType,v(q.prototype,{axisTypes:["xAxis","yAxis"],coll:"series",colorCounter:0,directTouch:!1,isCartesian:!0,kdAxisArray:["clientX","plotY"],parallelArrays:["x","y"],pointClass:l,requireSorting:!0,sorted:!0}),u.series=q,q}),t(e,"Core/Chart/Chart.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Axis/Axis.js"],e["Core/Defaults.js"],e["Core/Templating.js"],e["Core/Foundation.js"],e["Core/Globals.js"],e["Core/Renderer/RendererRegistry.js"],e["Core/Series/Series.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Renderer/SVG/SVGRenderer.js"],e["Core/Time.js"],e["Core/Utilities.js"],e["Core/Renderer/HTML/AST.js"],e["Core/Axis/Tick.js"]],function(i,s,r,n,a,l,c,u,g,p,C,y,S,O){let{animate:M,animObject:_,setAnimation:N}=i,{defaultOptions:E,defaultTime:k}=r,{numberFormat:ie}=n,{registerEventOptions:$}=a,{charts:H,doc:Q,marginNames:Y,svg:P,win:j}=l,{seriesTypes:A}=g,{addEvent:v,attr:R,createElement:f,clamp:w,css:b,defined:h,diffObjects:m,discardElement:x,erase:I,error:B,extend:V,find:U,fireEvent:K,getStyle:L,isArray:X,isNumber:q,isObject:le,isString:D,merge:F,objectEach:oe,pick:ne,pInt:ae,relativeLength:fe,removeEvent:me,splat:G,syncTimeout:se,uniqueKey:ee}=y;class ue{static chart(W,z,Z){return new ue(W,z,Z)}constructor(W,z,Z){this.sharedClips={};let te=[...arguments];(D(W)||W.nodeName)&&(this.renderTo=te.shift()),this.init(te[0],te[1])}setZoomOptions(){let W=this.options.chart,z=W.zooming;this.zooming={...z,type:ne(W.zoomType,z.type),key:ne(W.zoomKey,z.key),pinchType:ne(W.pinchType,z.pinchType),singleTouch:ne(W.zoomBySingleTouch,z.singleTouch,!1),resetButton:F(z.resetButton,W.resetZoomButton)}}init(W,z){K(this,"init",{args:arguments},function(){let Z=F(E,W),te=Z.chart;this.userOptions=V({},W),this.margin=[],this.spacing=[],this.bounds={h:{},v:{}},this.labelCollectors=[],this.callback=z,this.isResizing=0,this.options=Z,this.axes=[],this.series=[],this.time=W.time&&Object.keys(W.time).length?new C(W.time):l.time,this.numberFormatter=te.numberFormatter||ie,this.styledMode=te.styledMode,this.hasCartesianSeries=te.showAxes,this.index=H.length,H.push(this),l.chartCount++,$(this,te),this.xAxis=[],this.yAxis=[],this.pointCount=this.colorCounter=this.symbolCounter=0,this.setZoomOptions(),K(this,"afterInit"),this.firstRender()})}initSeries(W){let z=this.options.chart,Z=W.type||z.type,te=A[Z];te||B(17,!0,this,{missingModuleFor:Z});let re=new te;return typeof re.init=="function"&&re.init(this,W),re}setSortedData(){this.getSeriesOrderByLinks().forEach(function(W){W.points||W.data||!W.enabledDataSorting||W.setData(W.options.data,!1)})}getSeriesOrderByLinks(){return this.series.concat().sort(function(W,z){return W.linkedSeries.length||z.linkedSeries.length?z.linkedSeries.length-W.linkedSeries.length:0})}orderItems(W,z=0){let Z=this[W],te=this.options[W]=G(this.options[W]).slice(),re=this.userOptions[W]=this.userOptions[W]?G(this.userOptions[W]).slice():[];if(this.hasRendered&&(te.splice(z),re.splice(z)),Z)for(let ce=z,Ce=Z.length;ce<Ce;++ce){let ge=Z[ce];ge&&(ge.index=ce,ge instanceof u&&(ge.name=ge.getName()),ge.options.isInternal||(te[ce]=ge.options,re[ce]=ge.userOptions))}}isInsidePlot(W,z,Z={}){let{inverted:te,plotBox:re,plotLeft:ce,plotTop:Ce,scrollablePlotBox:ge}=this,ye=0,Ee=0;Z.visiblePlotOnly&&this.scrollingContainer&&({scrollLeft:ye,scrollTop:Ee}=this.scrollingContainer);let Se=Z.series,be=Z.visiblePlotOnly&&ge||re,Re=Z.inverted?z:W,Ae=Z.inverted?W:z,Ne={x:Re,y:Ae,isInsidePlot:!0,options:Z};if(!Z.ignoreX){let Me=Se&&(te&&!this.polar?Se.yAxis:Se.xAxis)||{pos:ce,len:1/0},Ze=Z.paneCoordinates?Me.pos+Re:ce+Re;Ze>=Math.max(ye+ce,Me.pos)&&Ze<=Math.min(ye+ce+be.width,Me.pos+Me.len)||(Ne.isInsidePlot=!1)}if(!Z.ignoreY&&Ne.isInsidePlot){let Me=!te&&Z.axis&&!Z.axis.isXAxis&&Z.axis||Se&&(te?Se.xAxis:Se.yAxis)||{pos:Ce,len:1/0},Ze=Z.paneCoordinates?Me.pos+Ae:Ce+Ae;Ze>=Math.max(Ee+Ce,Me.pos)&&Ze<=Math.min(Ee+Ce+be.height,Me.pos+Me.len)||(Ne.isInsidePlot=!1)}return K(this,"afterIsInsidePlot",Ne),Ne.isInsidePlot}redraw(W){K(this,"beforeRedraw");let z=this.hasCartesianSeries?this.axes:this.colorAxis||[],Z=this.series,te=this.pointer,re=this.legend,ce=this.userOptions.legend,Ce=this.renderer,ge=Ce.isHidden(),ye=[],Ee,Se,be,Re=this.isDirtyBox,Ae=this.isDirtyLegend,Ne;for(Ce.rootFontSize=Ce.boxWrapper.getStyle("font-size"),this.setResponsive&&this.setResponsive(!1),N(!!this.hasRendered&&W,this),ge&&this.temporaryDisplay(),this.layOutTitles(!1),be=Z.length;be--;)if(((Ne=Z[be]).options.stacking||Ne.options.centerInCategory)&&(Se=!0,Ne.isDirty)){Ee=!0;break}if(Ee)for(be=Z.length;be--;)(Ne=Z[be]).options.stacking&&(Ne.isDirty=!0);Z.forEach(function(Me){Me.isDirty&&(Me.options.legendType==="point"?(typeof Me.updateTotals=="function"&&Me.updateTotals(),Ae=!0):ce&&(ce.labelFormatter||ce.labelFormat)&&(Ae=!0)),Me.isDirtyData&&K(Me,"updatedData")}),Ae&&re&&re.options.enabled&&(re.render(),this.isDirtyLegend=!1),Se&&this.getStacks(),z.forEach(function(Me){Me.updateNames(),Me.setScale()}),this.getMargins(),z.forEach(function(Me){Me.isDirty&&(Re=!0)}),z.forEach(function(Me){let Ze=Me.min+","+Me.max;Me.extKey!==Ze&&(Me.extKey=Ze,ye.push(function(){K(Me,"afterSetExtremes",V(Me.eventArgs,Me.getExtremes())),delete Me.eventArgs})),(Re||Se)&&Me.redraw()}),Re&&this.drawChartBox(),K(this,"predraw"),Z.forEach(function(Me){(Re||Me.isDirty)&&Me.visible&&Me.redraw(),Me.isDirtyData=!1}),te&&te.reset(!0),Ce.draw(),K(this,"redraw"),K(this,"render"),ge&&this.temporaryDisplay(!0),ye.forEach(function(Me){Me.call()})}get(W){let z=this.series;function Z(re){return re.id===W||re.options&&re.options.id===W}let te=U(this.axes,Z)||U(this.series,Z);for(let re=0;!te&&re<z.length;re++)te=U(z[re].points||[],Z);return te}getAxes(){let W=this.userOptions;for(let z of(K(this,"getAxes"),["xAxis","yAxis"])){let Z=W[z]=G(W[z]||{});for(let te of Z)new s(this,te,z)}K(this,"afterGetAxes")}getSelectedPoints(){return this.series.reduce((W,z)=>(z.getPointsCollection().forEach(Z=>{ne(Z.selectedStaging,Z.selected)&&W.push(Z)}),W),[])}getSelectedSeries(){return this.series.filter(function(W){return W.selected})}setTitle(W,z,Z){this.applyDescription("title",W),this.applyDescription("subtitle",z),this.applyDescription("caption",void 0),this.layOutTitles(Z)}applyDescription(W,z){let Z=this,te=this.options[W]=F(this.options[W],z),re=this[W];re&&z&&(this[W]=re=re.destroy()),te&&!re&&((re=this.renderer.text(te.text,0,0,te.useHTML).attr({align:te.align,class:"highcharts-"+W,zIndex:te.zIndex||4}).add()).update=function(ce,Ce){Z.applyDescription(W,ce),Z.layOutTitles(Ce)},this.styledMode||re.css(V(W==="title"?{fontSize:this.options.isStock?"1em":"1.2em"}:{},te.style)),this[W]=re)}layOutTitles(W=!0){let z=[0,0,0],Z=this.renderer,te=this.spacingBox;["title","subtitle","caption"].forEach(function(ce){let Ce=this[ce],ge=this.options[ce],ye=ge.verticalAlign||"top",Ee=ce==="title"?ye==="top"?-3:0:ye==="top"?z[0]+2:0;if(Ce){Ce.css({width:(ge.width||te.width+(ge.widthAdjust||0))+"px"});let Se=Z.fontMetrics(Ce).b,be=Math.round(Ce.getBBox(ge.useHTML).height);Ce.align(V({y:ye==="bottom"?Se:Ee+Se,height:be},ge),!1,"spacingBox"),ge.floating||(ye==="top"?z[0]=Math.ceil(z[0]+be):ye==="bottom"&&(z[2]=Math.ceil(z[2]+be)))}},this),z[0]&&(this.options.title.verticalAlign||"top")==="top"&&(z[0]+=this.options.title.margin),z[2]&&this.options.caption.verticalAlign==="bottom"&&(z[2]+=this.options.caption.margin);let re=!this.titleOffset||this.titleOffset.join(",")!==z.join(",");this.titleOffset=z,K(this,"afterLayOutTitles"),!this.isDirtyBox&&re&&(this.isDirtyBox=this.isDirtyLegend=re,this.hasRendered&&W&&this.isDirtyBox&&this.redraw())}getContainerBox(){return{width:L(this.renderTo,"width",!0)||0,height:L(this.renderTo,"height",!0)||0}}getChartSize(){let W=this.options.chart,z=W.width,Z=W.height,te=this.getContainerBox();this.chartWidth=Math.max(0,z||te.width||600),this.chartHeight=Math.max(0,fe(Z,this.chartWidth)||(te.height>1?te.height:400)),this.containerBox=te}temporaryDisplay(W){let z=this.renderTo,Z;if(W)for(;z&&z.style;)z.hcOrigStyle&&(b(z,z.hcOrigStyle),delete z.hcOrigStyle),z.hcOrigDetached&&(Q.body.removeChild(z),z.hcOrigDetached=!1),z=z.parentNode;else for(;z&&z.style&&(Q.body.contains(z)||z.parentNode||(z.hcOrigDetached=!0,Q.body.appendChild(z)),(L(z,"display",!1)==="none"||z.hcOricDetached)&&(z.hcOrigStyle={display:z.style.display,height:z.style.height,overflow:z.style.overflow},Z={display:"block",overflow:"hidden"},z!==this.renderTo&&(Z.height=0),b(z,Z),z.offsetWidth||z.style.setProperty("display","block","important")),(z=z.parentNode)!==Q.body););}setClassName(W){this.container.className="highcharts-container "+(W||"")}getContainer(){let W=this.options,z=W.chart,Z="data-highcharts-chart",te=ee(),re,ce=this.renderTo;ce||(this.renderTo=ce=z.renderTo),D(ce)&&(this.renderTo=ce=Q.getElementById(ce)),ce||B(13,!0,this);let Ce=ae(R(ce,Z));q(Ce)&&H[Ce]&&H[Ce].hasRendered&&H[Ce].destroy(),R(ce,Z,this.index),ce.innerHTML=S.emptyHTML,z.skipClone||ce.offsetWidth||this.temporaryDisplay(),this.getChartSize();let ge=this.chartWidth,ye=this.chartHeight;b(ce,{overflow:"hidden"}),this.styledMode||(re=V({position:"relative",overflow:"hidden",width:ge+"px",height:ye+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)",userSelect:"none","touch-action":"manipulation",outline:"none"},z.style||{}));let Ee=f("div",{id:te},re,ce);this.container=Ee,this._cursor=Ee.style.cursor;let Se=z.renderer||!P?c.getRendererType(z.renderer):p;if(this.renderer=new Se(Ee,ge,ye,void 0,z.forExport,W.exporting&&W.exporting.allowHTML,this.styledMode),this.containerBox=this.getContainerBox(),N(void 0,this),this.setClassName(z.className),this.styledMode)for(let be in W.defs)this.renderer.definition(W.defs[be]);else this.renderer.setStyle(z.style);this.renderer.chartIndex=this.index,K(this,"afterGetContainer")}getMargins(W){let{spacing:z,margin:Z,titleOffset:te}=this;this.resetMargins(),te[0]&&!h(Z[0])&&(this.plotTop=Math.max(this.plotTop,te[0]+z[0])),te[2]&&!h(Z[2])&&(this.marginBottom=Math.max(this.marginBottom,te[2]+z[2])),this.legend&&this.legend.display&&this.legend.adjustMargins(Z,z),K(this,"getMargins"),W||this.getAxisMargins()}getAxisMargins(){let W=this,z=W.axisOffset=[0,0,0,0],Z=W.colorAxis,te=W.margin,re=function(ce){ce.forEach(function(Ce){Ce.visible&&Ce.getOffset()})};W.hasCartesianSeries?re(W.axes):Z&&Z.length&&re(Z),Y.forEach(function(ce,Ce){h(te[Ce])||(W[ce]+=z[Ce])}),W.setChartSize()}getOptions(){return m(this.userOptions,E)}reflow(W){let z=this,Z=z.containerBox,te=z.getContainerBox();delete z.pointer.chartPosition,!z.isPrinting&&!z.isResizing&&Z&&te.width&&((te.width!==Z.width||te.height!==Z.height)&&(y.clearTimeout(z.reflowTimeout),z.reflowTimeout=se(function(){z.container&&z.setSize(void 0,void 0,!1)},W?100:0)),z.containerBox=te)}setReflow(){let W=this,z=Z=>{W.options?.chart.reflow&&W.hasLoaded&&W.reflow(Z)};if(typeof ResizeObserver=="function")new ResizeObserver(z).observe(W.renderTo);else{let Z=v(j,"resize",z);v(this,"destroy",Z)}}setSize(W,z,Z){let te=this,re=te.renderer;te.isResizing+=1,N(Z,te);let ce=re.globalAnimation;te.oldChartHeight=te.chartHeight,te.oldChartWidth=te.chartWidth,W!==void 0&&(te.options.chart.width=W),z!==void 0&&(te.options.chart.height=z),te.getChartSize();let{chartWidth:Ce,chartHeight:ge,scrollablePixelsX:ye=0,scrollablePixelsY:Ee=0}=te;(te.isDirtyBox||Ce!==te.oldChartWidth||ge!==te.oldChartHeight)&&(te.styledMode||(ce?M:b)(te.container,{width:`${Ce+ye}px`,height:`${ge+Ee}px`},ce),te.setChartSize(!0),re.setSize(Ce,ge,ce),te.axes.forEach(function(Se){Se.isDirty=!0,Se.setScale()}),te.isDirtyLegend=!0,te.isDirtyBox=!0,te.layOutTitles(),te.getMargins(),te.redraw(ce),te.oldChartHeight=void 0,K(te,"resize"),setTimeout(()=>{te&&K(te,"endResize",void 0,()=>{te.isResizing-=1})},_(ce).duration))}setChartSize(W){let z,Z,te,re,ce=this.inverted,Ce=this.renderer,ge=this.chartWidth,ye=this.chartHeight,Ee=this.options.chart,Se=this.spacing,be=this.clipOffset;this.plotLeft=z=Math.round(this.plotLeft),this.plotTop=Z=Math.round(this.plotTop),this.plotWidth=te=Math.max(0,Math.round(ge-z-this.marginRight)),this.plotHeight=re=Math.max(0,Math.round(ye-Z-this.marginBottom)),this.plotSizeX=ce?re:te,this.plotSizeY=ce?te:re,this.plotBorderWidth=Ee.plotBorderWidth||0,this.spacingBox=Ce.spacingBox={x:Se[3],y:Se[0],width:ge-Se[3]-Se[1],height:ye-Se[0]-Se[2]},this.plotBox=Ce.plotBox={x:z,y:Z,width:te,height:re};let Re=2*Math.floor(this.plotBorderWidth/2),Ae=Math.ceil(Math.max(Re,be[3])/2),Ne=Math.ceil(Math.max(Re,be[0])/2);this.clipBox={x:Ae,y:Ne,width:Math.floor(this.plotSizeX-Math.max(Re,be[1])/2-Ae),height:Math.max(0,Math.floor(this.plotSizeY-Math.max(Re,be[2])/2-Ne))},W||(this.axes.forEach(function(Me){Me.setAxisSize(),Me.setAxisTranslation()}),Ce.alignElements()),K(this,"afterSetChartSize",{skipAxes:W})}resetMargins(){K(this,"resetMargins");let W=this,z=W.options.chart;["margin","spacing"].forEach(function(Z){let te=z[Z],re=le(te)?te:[te,te,te,te];["Top","Right","Bottom","Left"].forEach(function(ce,Ce){W[Z][Ce]=ne(z[Z+ce],re[Ce])})}),Y.forEach(function(Z,te){W[Z]=ne(W.margin[te],W.spacing[te])}),W.axisOffset=[0,0,0,0],W.clipOffset=[0,0,0,0]}drawChartBox(){let W=this.options.chart,z=this.renderer,Z=this.chartWidth,te=this.chartHeight,re=this.styledMode,ce=this.plotBGImage,Ce=W.backgroundColor,ge=W.plotBackgroundColor,ye=W.plotBackgroundImage,Ee=this.plotLeft,Se=this.plotTop,be=this.plotWidth,Re=this.plotHeight,Ae=this.plotBox,Ne=this.clipRect,Me=this.clipBox,Ze=this.chartBackground,it=this.plotBackground,rt=this.plotBorder,It,wt,ct,qe="animate";Ze||(this.chartBackground=Ze=z.rect().addClass("highcharts-background").add(),qe="attr"),re?It=wt=Ze.strokeWidth():(wt=(It=W.borderWidth||0)+(W.shadow?8:0),ct={fill:Ce||"none"},(It||Ze["stroke-width"])&&(ct.stroke=W.borderColor,ct["stroke-width"]=It),Ze.attr(ct).shadow(W.shadow)),Ze[qe]({x:wt/2,y:wt/2,width:Z-wt-It%2,height:te-wt-It%2,r:W.borderRadius}),qe="animate",it||(qe="attr",this.plotBackground=it=z.rect().addClass("highcharts-plot-background").add()),it[qe](Ae),!re&&(it.attr({fill:ge||"none"}).shadow(W.plotShadow),ye&&(ce?(ye!==ce.attr("href")&&ce.attr("href",ye),ce.animate(Ae)):this.plotBGImage=z.image(ye,Ee,Se,be,Re).add())),Ne?Ne.animate({width:Me.width,height:Me.height}):this.clipRect=z.clipRect(Me),qe="animate",rt||(qe="attr",this.plotBorder=rt=z.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),re||rt.attr({stroke:W.plotBorderColor,"stroke-width":W.plotBorderWidth||0,fill:"none"}),rt[qe](rt.crisp({x:Ee,y:Se,width:be,height:Re},-rt.strokeWidth())),this.isDirtyBox=!1,K(this,"afterDrawChartBox")}propFromSeries(){let W,z,Z,te=this,re=te.options.chart,ce=te.options.series;["inverted","angular","polar"].forEach(function(Ce){for(z=A[re.type],Z=re[Ce]||z&&z.prototype[Ce],W=ce&&ce.length;!Z&&W--;)(z=A[ce[W].type])&&z.prototype[Ce]&&(Z=!0);te[Ce]=Z})}linkSeries(W){let z=this,Z=z.series;Z.forEach(function(te){te.linkedSeries.length=0}),Z.forEach(function(te){let{linkedTo:re}=te.options;if(D(re)){let ce;(ce=re===":previous"?z.series[te.index-1]:z.get(re))&&ce.linkedParent!==te&&(ce.linkedSeries.push(te),te.linkedParent=ce,ce.enabledDataSorting&&te.setDataSortingOptions(),te.visible=ne(te.options.visible,ce.options.visible,te.visible))}}),K(this,"afterLinkSeries",{isUpdating:W})}renderSeries(){this.series.forEach(function(W){W.translate(),W.render()})}render(){let W=this.axes,z=this.colorAxis,Z=this.renderer,te=this.options.chart.axisLayoutRuns||2,re=Ee=>{Ee.forEach(Se=>{Se.visible&&Se.render()})},ce=0,Ce=!0,ge,ye=0;for(let Ee of(this.setTitle(),K(this,"beforeMargins"),this.getStacks?.(),this.getMargins(!0),this.setChartSize(),W)){let{options:Se}=Ee,{labels:be}=Se;if(Ee.horiz&&Ee.visible&&be.enabled&&Ee.series.length&&Ee.coll!=="colorAxis"&&!this.polar){ce=Se.tickLength,Ee.createGroups();let Re=new O(Ee,0,"",!0),Ae=Re.createLabel("x",be);if(Re.destroy(),Ae&&ne(be.reserveSpace,!q(Se.crossing))&&(ce=Ae.getBBox().height+be.distance+Math.max(Se.offset||0,0)),ce){Ae?.destroy();break}}}for(this.plotHeight=Math.max(this.plotHeight-ce,0);(Ce||ge||te>1)&&ye<te;){let Ee=this.plotWidth,Se=this.plotHeight;for(let be of W)ye===0?be.setScale():(be.horiz&&Ce||!be.horiz&&ge)&&be.setTickInterval(!0);ye===0?this.getAxisMargins():this.getMargins(),Ce=Ee/this.plotWidth>(ye?1:1.1),ge=Se/this.plotHeight>(ye?1:1.05),ye++}this.drawChartBox(),this.hasCartesianSeries?re(W):z&&z.length&&re(z),this.seriesGroup||(this.seriesGroup=Z.g("series-group").attr({zIndex:3}).shadow(this.options.chart.seriesGroupShadow).add()),this.renderSeries(),this.addCredits(),this.setResponsive&&this.setResponsive(),this.hasRendered=!0}addCredits(W){let z=this,Z=F(!0,this.options.credits,W);Z.enabled&&!this.credits&&(this.credits=this.renderer.text(Z.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){Z.href&&(j.location.href=Z.href)}).attr({align:Z.position.align,zIndex:8}),z.styledMode||this.credits.css(Z.style),this.credits.add().align(Z.position),this.credits.update=function(te){z.credits=z.credits.destroy(),z.addCredits(te)})}destroy(){let W,z=this,Z=z.axes,te=z.series,re=z.container,ce=re&&re.parentNode;for(K(z,"destroy"),z.renderer.forExport?I(H,z):H[z.index]=void 0,l.chartCount--,z.renderTo.removeAttribute("data-highcharts-chart"),me(z),W=Z.length;W--;)Z[W]=Z[W].destroy();for(this.scroller&&this.scroller.destroy&&this.scroller.destroy(),W=te.length;W--;)te[W]=te[W].destroy();["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","rangeSelector","legend","resetZoomButton","tooltip","renderer"].forEach(function(Ce){let ge=z[Ce];ge&&ge.destroy&&(z[Ce]=ge.destroy())}),re&&(re.innerHTML=S.emptyHTML,me(re),ce&&x(re)),oe(z,function(Ce,ge){delete z[ge]})}firstRender(){let W=this,z=W.options;W.getContainer(),W.resetMargins(),W.setChartSize(),W.propFromSeries(),W.getAxes();let Z=X(z.series)?z.series:[];z.series=[],Z.forEach(function(te){W.initSeries(te)}),W.linkSeries(),W.setSortedData(),K(W,"beforeRender"),W.render(),W.pointer.getChartPosition(),W.renderer.imgCount||W.hasLoaded||W.onload(),W.temporaryDisplay(!0)}onload(){this.callbacks.concat([this.callback]).forEach(function(W){W&&this.index!==void 0&&W.apply(this,[this])},this),K(this,"load"),K(this,"render"),h(this.index)&&this.setReflow(),this.warnIfA11yModuleNotLoaded(),this.hasLoaded=!0}warnIfA11yModuleNotLoaded(){let{options:W,title:z}=this;!W||this.accessibility||(this.renderer.boxWrapper.attr({role:"img","aria-label":(z&&z.element.textContent||"").replace(/</g,"&lt;")}),W.accessibility&&W.accessibility.enabled===!1||B('Highcharts warning: Consider including the "accessibility.js" module to make your chart more usable for people with disabilities. Set the "accessibility.enabled" option to false to remove this warning. See https://www.highcharts.com/docs/accessibility/accessibility-module.',!1,this))}addSeries(W,z,Z){let te,re=this;return W&&(z=ne(z,!0),K(re,"addSeries",{options:W},function(){te=re.initSeries(W),re.isDirtyLegend=!0,re.linkSeries(),te.enabledDataSorting&&te.setData(W.data,!1),K(re,"afterAddSeries",{series:te}),z&&re.redraw(Z)})),te}addAxis(W,z,Z,te){return this.createAxis(z?"xAxis":"yAxis",{axis:W,redraw:Z,animation:te})}addColorAxis(W,z,Z){return this.createAxis("colorAxis",{axis:W,redraw:z,animation:Z})}createAxis(W,z){let Z=new s(this,z.axis,W);return ne(z.redraw,!0)&&this.redraw(z.animation),Z}showLoading(W){let z=this,Z=z.options,te=Z.loading,re=function(){ce&&b(ce,{left:z.plotLeft+"px",top:z.plotTop+"px",width:z.plotWidth+"px",height:z.plotHeight+"px"})},ce=z.loadingDiv,Ce=z.loadingSpan;ce||(z.loadingDiv=ce=f("div",{className:"highcharts-loading highcharts-loading-hidden"},null,z.container)),Ce||(z.loadingSpan=Ce=f("span",{className:"highcharts-loading-inner"},null,ce),v(z,"redraw",re)),ce.className="highcharts-loading",S.setElementHTML(Ce,ne(W,Z.lang.loading,"")),z.styledMode||(b(ce,V(te.style,{zIndex:10})),b(Ce,te.labelStyle),z.loadingShown||(b(ce,{opacity:0,display:""}),M(ce,{opacity:te.style.opacity||.5},{duration:te.showDuration||0}))),z.loadingShown=!0,re()}hideLoading(){let W=this.options,z=this.loadingDiv;z&&(z.className="highcharts-loading highcharts-loading-hidden",this.styledMode||M(z,{opacity:0},{duration:W.loading.hideDuration||100,complete:function(){b(z,{display:"none"})}})),this.loadingShown=!1}update(W,z,Z,te){let re,ce,Ce,ge=this,ye={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"},Ee=W.isResponsiveOptions,Se=[];K(ge,"update",{options:W}),Ee||ge.setResponsive(!1,!0),W=m(W,ge.options),ge.userOptions=F(ge.userOptions,W);let be=W.chart;be&&(F(!0,ge.options.chart,be),this.setZoomOptions(),"className"in be&&ge.setClassName(be.className),("inverted"in be||"polar"in be||"type"in be)&&(ge.propFromSeries(),re=!0),"alignTicks"in be&&(re=!0),"events"in be&&$(this,be),oe(be,function(Ne,Me){ge.propsRequireUpdateSeries.indexOf("chart."+Me)!==-1&&(ce=!0),ge.propsRequireDirtyBox.indexOf(Me)!==-1&&(ge.isDirtyBox=!0),ge.propsRequireReflow.indexOf(Me)===-1||(ge.isDirtyBox=!0,Ee||(Ce=!0))}),!ge.styledMode&&be.style&&ge.renderer.setStyle(ge.options.chart.style||{})),!ge.styledMode&&W.colors&&(this.options.colors=W.colors),W.time&&(this.time===k&&(this.time=new C(W.time)),F(!0,ge.options.time,W.time)),oe(W,function(Ne,Me){ge[Me]&&typeof ge[Me].update=="function"?ge[Me].update(Ne,!1):typeof ge[ye[Me]]=="function"?ge[ye[Me]](Ne):Me!=="colors"&&ge.collectionsWithUpdate.indexOf(Me)===-1&&F(!0,ge.options[Me],W[Me]),Me!=="chart"&&ge.propsRequireUpdateSeries.indexOf(Me)!==-1&&(ce=!0)}),this.collectionsWithUpdate.forEach(function(Ne){W[Ne]&&(G(W[Ne]).forEach(function(Me,Ze){let it,rt=h(Me.id);rt&&(it=ge.get(Me.id)),!it&&ge[Ne]&&(it=ge[Ne][ne(Me.index,Ze)])&&(rt&&h(it.options.id)||it.options.isInternal)&&(it=void 0),it&&it.coll===Ne&&(it.update(Me,!1),Z&&(it.touched=!0)),!it&&Z&&ge.collectionsWithInit[Ne]&&(ge.collectionsWithInit[Ne][0].apply(ge,[Me].concat(ge.collectionsWithInit[Ne][1]||[]).concat([!1])).touched=!0)}),Z&&ge[Ne].forEach(function(Me){Me.touched||Me.options.isInternal?delete Me.touched:Se.push(Me)}))}),Se.forEach(function(Ne){Ne.chart&&Ne.remove&&Ne.remove(!1)}),re&&ge.axes.forEach(function(Ne){Ne.update({},!1)}),ce&&ge.getSeriesOrderByLinks().forEach(function(Ne){Ne.chart&&Ne.update({},!1)},this);let Re=be&&be.width,Ae=be&&(D(be.height)?fe(be.height,Re||ge.chartWidth):be.height);Ce||q(Re)&&Re!==ge.chartWidth||q(Ae)&&Ae!==ge.chartHeight?ge.setSize(Re,Ae,te):ne(z,!0)&&ge.redraw(te),K(ge,"afterUpdate",{options:W,redraw:z,animation:te})}setSubtitle(W,z){this.applyDescription("subtitle",W),this.layOutTitles(z)}setCaption(W,z){this.applyDescription("caption",W),this.layOutTitles(z)}showResetZoom(){let W=this,z=E.lang,Z=W.zooming.resetButton,te=Z.theme,re=Z.relativeTo==="chart"||Z.relativeTo==="spacingBox"?null:"scrollablePlotBox";function ce(){W.zoomOut()}K(this,"beforeShowResetZoom",null,function(){W.resetZoomButton=W.renderer.button(z.resetZoom,null,null,ce,te).attr({align:Z.position.align,title:z.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(Z.position,!1,re)}),K(this,"afterShowResetZoom")}zoomOut(){K(this,"selection",{resetSelection:!0},this.zoom)}zoom(W){let z=this,Z=z.pointer,te=!1,re;!W||W.resetSelection?(z.axes.forEach(function(Ce){re=Ce.zoom()}),Z.initiated=!1):W.xAxis.concat(W.yAxis).forEach(function(Ce){let ge=Ce.axis,ye=ge.isXAxis,{hasPinched:Ee,mouseDownX:Se,mouseDownY:be}=Z;(Z[ye?"zoomX":"zoomY"]&&h(Se)&&h(be)&&z.isInsidePlot(Se-z.plotLeft,be-z.plotTop,{axis:ge,ignoreX:Ee,ignoreY:Ee})||!h(z.inverted?Se:be))&&(re=ge.zoom(Ce.min,Ce.max),ge.displayBtn&&(te=!0))});let ce=z.resetZoomButton;te&&!ce?z.showResetZoom():!te&&le(ce)&&(z.resetZoomButton=ce.destroy()),re&&z.redraw(ne(z.options.chart.animation,W&&W.animation,z.pointCount<100))}pan(W,z){let Z,te=this,re=te.hoverPoints,ce=typeof z=="object"?z:{enabled:z,type:"x"},Ce=te.options.chart;Ce&&Ce.panning&&(Ce.panning=ce);let ge=ce.type;K(this,"pan",{originalEvent:W},function(){re&&re.forEach(function(Se){Se.setState()});let ye=te.xAxis;ge==="xy"?ye=ye.concat(te.yAxis):ge==="y"&&(ye=te.yAxis);let Ee={};ye.forEach(function(Se){if(!Se.options.panningEnabled||Se.options.isInternal)return;let be=Se.horiz,Re=W[be?"chartX":"chartY"],Ae=be?"mouseDownX":"mouseDownY",Ne=te[Ae],Me=Se.minPointOffset||0,Ze=Se.reversed&&!te.inverted||!Se.reversed&&te.inverted?-1:1,it=Se.getExtremes(),rt=Se.toValue(Ne-Re,!0)+Me*Ze,It=Se.toValue(Ne+Se.len-Re,!0)-(Me*Ze||Se.isXAxis&&Se.pointRangePadding||0),wt=It<rt,ct=Se.hasVerticalPanning(),qe=wt?It:rt,wi=wt?rt:It,Ut=Se.panningState,Fs;ct&&!Se.isXAxis&&(!Ut||Ut.isDirty)&&Se.series.forEach(function(Be){let Il=Be.getProcessedData(!0),ao=Be.getExtremes(Il.yData,!0);Ut||(Ut={startMin:Number.MAX_VALUE,startMax:-Number.MAX_VALUE}),q(ao.dataMin)&&q(ao.dataMax)&&(Ut.startMin=Math.min(ne(Be.options.threshold,1/0),ao.dataMin,Ut.startMin),Ut.startMax=Math.max(ne(Be.options.threshold,-1/0),ao.dataMax,Ut.startMax))});let ts=Math.min(ne(Ut&&Ut.startMin,it.dataMin),Me?it.min:Se.toValue(Se.toPixels(it.min)-Se.minPixelPadding)),vs=Math.max(ne(Ut&&Ut.startMax,it.dataMax),Me?it.max:Se.toValue(Se.toPixels(it.max)+Se.minPixelPadding));Se.panningState=Ut,Se.isOrdinal||((Fs=ts-qe)>0&&(wi+=Fs,qe=ts),(Fs=wi-vs)>0&&(wi=vs,qe-=Fs),Se.series.length&&qe!==it.min&&wi!==it.max&&qe>=ts&&wi<=vs&&(Se.setExtremes(qe,wi,!1,!1,{trigger:"pan"}),!te.resetZoomButton&&qe!==ts&&wi!==vs&&ge.match("y")&&(te.showResetZoom(),Se.displayBtn=!1),Z=!0),Ee[Ae]=Re)}),oe(Ee,(Se,be)=>{te[be]=Se}),Z&&te.redraw(!1),b(te.container,{cursor:"move"})})}}return V(ue.prototype,{callbacks:[],collectionsWithInit:{xAxis:[ue.prototype.addAxis,[!0]],yAxis:[ue.prototype.addAxis,[!1]],series:[ue.prototype.addSeries]},collectionsWithUpdate:["xAxis","yAxis","series"],propsRequireDirtyBox:["backgroundColor","borderColor","borderWidth","borderRadius","plotBackgroundColor","plotBackgroundImage","plotBorderColor","plotBorderWidth","plotShadow","shadow"],propsRequireReflow:["margin","marginTop","marginRight","marginBottom","marginLeft","spacing","spacingTop","spacingRight","spacingBottom","spacingLeft"],propsRequireUpdateSeries:["chart.inverted","chart.polar","chart.ignoreHiddenSeries","chart.type","colors","plotOptions","time","tooltip"]}),ue}),t(e,"Extensions/ScrollablePlotArea.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Globals.js"],e["Core/Renderer/RendererRegistry.js"],e["Core/Utilities.js"]],function(i,s,r,n){let{stop:a}=i,{composed:l}=s,{addEvent:c,createElement:u,css:g,defined:p,extend:C,merge:y,pick:S,pushUnique:O}=n;function M(){let H,{axisOffset:Q,chartWidth:Y,chartHeight:P,container:j,plotHeight:A,plotLeft:v,plotTop:R,plotWidth:f,scrollablePixelsX:w=0,scrollablePixelsY:b=0,scrollingContainer:h}=this,m=!this.fixedDiv,x=this.options.chart,I=x.scrollablePlotArea,{scrollPositionX:B,scrollPositionY:V}=I,U=r.getRendererType(),{fixedRenderer:K}=this;K?K.setSize(Y,P):(this.fixedDiv=u("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:(x.style?.zIndex||0)+2,top:0},void 0,!0),h?.parentNode.insertBefore(this.fixedDiv,h),g(this.renderTo,{overflow:"visible"}),this.fixedRenderer=K=new U(this.fixedDiv,Y,P,x.style),this.scrollableMask=K.path().attr({fill:x.backgroundColor||"#fff","fill-opacity":S(I.opacity,.85),zIndex:-1}).addClass("highcharts-scrollable-mask").add(),c(this,"afterShowResetZoom",this.moveFixedElements),c(this,"afterApplyDrilldown",this.moveFixedElements),c(this,"afterLayOutTitles",this.moveFixedElements)),(this.scrollableDirty||m)&&(this.scrollableDirty=!1,this.moveFixedElements());let L=Y+w,X=P+b;a(this.container),g(j,{width:`${L}px`,height:`${X}px`}),this.renderer.boxWrapper.attr({width:L,height:X,viewBox:[0,0,L,X].join(" ")}),this.chartBackground?.attr({width:L,height:X}),h&&(g(h,{width:`${this.chartWidth}px`,height:`${this.chartHeight}px`}),m&&(B&&(h.scrollLeft=w*B),V&&(h.scrollTop=b*V)));let q=R-Q[0]-1,le=v-Q[3]-1,D=R+A+Q[2]+1,F=v+f+Q[1]+1,oe=v+f-w,ne=R+A-b;H=w?[["M",0,q],["L",v-1,q],["L",v-1,D],["L",0,D],["Z"],["M",oe,q],["L",Y,q],["L",Y,D],["L",oe,D],["Z"]]:b?[["M",le,0],["L",le,R-1],["L",F,R-1],["L",F,0],["Z"],["M",le,ne],["L",le,P],["L",F,P],["L",F,ne],["Z"]]:[["M",0,0]],this.redrawTrigger!=="adjustHeight"&&this.scrollableMask?.attr({d:H})}function _(){let H,Q=this.container,Y=this.fixedRenderer,P=[".highcharts-breadcrumbs-group",".highcharts-contextbutton",".highcharts-caption",".highcharts-credits",".highcharts-legend",".highcharts-legend-checkbox",".highcharts-navigator-series",".highcharts-navigator-xaxis",".highcharts-navigator-yaxis",".highcharts-navigator",".highcharts-reset-zoom",".highcharts-drillup-button",".highcharts-scrollbar",".highcharts-subtitle",".highcharts-title"];for(let j of(this.scrollablePixelsX&&!this.inverted?H=".highcharts-yaxis":this.scrollablePixelsX&&this.inverted||this.scrollablePixelsY&&!this.inverted?H=".highcharts-xaxis":this.scrollablePixelsY&&this.inverted&&(H=".highcharts-yaxis"),H&&P.push(`${H}:not(.highcharts-radial-axis)`,`${H}-labels:not(.highcharts-radial-axis-labels)`),P))[].forEach.call(Q.querySelectorAll(j),A=>{(A.namespaceURI===Y.SVG_NS?Y.box:Y.box.parentNode).appendChild(A),A.style.pointerEvents="auto"})}function N(){let H,Q={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};this.scrollablePixelsX&&(Q.overflowX="auto"),this.scrollablePixelsY&&(Q.overflowY="auto"),this.scrollingParent=u("div",{className:"highcharts-scrolling-parent"},{position:"relative"},this.renderTo),this.scrollingContainer=u("div",{className:"highcharts-scrolling"},Q,this.scrollingParent),c(this.scrollingContainer,"scroll",()=>{this.pointer&&(delete this.pointer.chartPosition,this.hoverPoint&&(H=this.hoverPoint),this.pointer.runPointActions(void 0,H,!0))}),this.innerContainer=u("div",{className:"highcharts-inner-container"},null,this.scrollingContainer),this.innerContainer.appendChild(this.container),this.setUpScrolling=null}function E(){this.chart.scrollableDirty=!0}function k(H){let Q,Y,P,j=this.options.chart.scrollablePlotArea,A=j&&j.minWidth,v=j&&j.minHeight;if(!this.renderer.forExport&&(A?(this.scrollablePixelsX=Q=Math.max(0,A-this.chartWidth),Q&&(this.scrollablePlotBox=this.renderer.scrollablePlotBox=y(this.plotBox),this.plotBox.width=this.plotWidth+=Q,this.inverted?this.clipBox.height+=Q:this.clipBox.width+=Q,P={1:{name:"right",value:Q}})):v&&(this.scrollablePixelsY=Y=Math.max(0,v-this.chartHeight),p(Y)&&(this.scrollablePlotBox=this.renderer.scrollablePlotBox=y(this.plotBox),this.plotBox.height=this.plotHeight+=Y,this.inverted?this.clipBox.width+=Y:this.clipBox.height+=Y,P={2:{name:"bottom",value:Y}})),P&&!H.skipAxes))for(let R of this.axes)if(P[R.side]){let f=R.getPlotLinePath;R.getPlotLinePath=function(){let w=P[R.side].name,b=P[R.side].value,h=this[w];this[w]=h-b;let m=f.apply(this,arguments);return this[w]=h,m}}else R.setAxisSize(),R.setAxisTranslation()}function ie(){this.scrollablePixelsX||this.scrollablePixelsY?(this.setUpScrolling&&this.setUpScrolling(),this.applyFixed()):this.fixedDiv&&this.applyFixed()}function $(){this.chart.scrollableDirty=!0}return{compose:function H(Q,Y,P){O(l,H)&&(c(Q,"afterInit",E),C(Y.prototype,{applyFixed:M,moveFixedElements:_,setUpScrolling:N}),c(Y,"afterSetChartSize",k),c(Y,"render",ie),c(P,"show",$))}}}),t(e,"Core/Axis/Stacking/StackItem.js",[e["Core/Templating.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(i,s,r){let{format:n}=i,{series:a}=s,{destroyObjectProperties:l,fireEvent:c,isNumber:u,pick:g}=r;return class{constructor(p,C,y,S,O){let M=p.chart.inverted,_=p.reversed;this.axis=p;let N=this.isNegative=!!y!=!!_;this.options=C=C||{},this.x=S,this.total=null,this.cumulative=null,this.points={},this.hasValidPoints=!1,this.stack=O,this.leftCliff=0,this.rightCliff=0,this.alignOptions={align:C.align||(M?N?"left":"right":"center"),verticalAlign:C.verticalAlign||(M?"middle":N?"bottom":"top"),y:C.y,x:C.x},this.textAlign=C.textAlign||(M?N?"right":"left":"center")}destroy(){l(this,this.axis)}render(p){let C=this.axis.chart,y=this.options,S=y.format,O=S?n(S,this,C):y.formatter.call(this);if(this.label)this.label.attr({text:O,visibility:"hidden"});else{this.label=C.renderer.label(O,null,void 0,y.shape,void 0,void 0,y.useHTML,!1,"stack-labels");let M={r:y.borderRadius||0,text:O,padding:g(y.padding,5),visibility:"hidden"};C.styledMode||(M.fill=y.backgroundColor,M.stroke=y.borderColor,M["stroke-width"]=y.borderWidth,this.label.css(y.style||{})),this.label.attr(M),this.label.added||this.label.add(p)}this.label.labelrank=C.plotSizeY,c(this,"afterRender")}setOffset(p,C,y,S,O,M){let{alignOptions:_,axis:N,label:E,options:k,textAlign:ie}=this,$=N.chart,H=this.getStackBox({xOffset:p,width:C,boxBottom:y,boxTop:S,defaultX:O,xAxis:M}),{verticalAlign:Q}=_;if(E&&H){let Y=E.getBBox(),P=E.padding,j=g(k.overflow,"justify")==="justify",A;_.x=k.x||0,_.y=k.y||0;let{x:v,y:R}=this.adjustStackPosition({labelBox:Y,verticalAlign:Q,textAlign:ie});H.x-=v,H.y-=R,E.align(_,!1,H),(A=$.isInsidePlot(E.alignAttr.x+_.x+v,E.alignAttr.y+_.y+R))||(j=!1),j&&a.prototype.justifyDataLabel.call(N,E,_,E.alignAttr,Y,H),E.attr({x:E.alignAttr.x,y:E.alignAttr.y,rotation:k.rotation,rotationOriginX:Y.width/2,rotationOriginY:Y.height/2}),g(!j&&k.crop,!0)&&(A=u(E.x)&&u(E.y)&&$.isInsidePlot(E.x-P+(E.width||0),E.y)&&$.isInsidePlot(E.x+P,E.y)),E[A?"show":"hide"]()}c(this,"afterSetOffset",{xOffset:p,width:C})}adjustStackPosition({labelBox:p,verticalAlign:C,textAlign:y}){let S={bottom:0,middle:1,top:2,right:1,center:0,left:-1},O=S[C],M=S[y];return{x:p.width/2+p.width/2*M,y:p.height/2*O}}getStackBox(p){let C=this.axis,y=C.chart,{boxTop:S,defaultX:O,xOffset:M,width:_,boxBottom:N}=p,E=C.stacking.usePercentage?100:g(S,this.total,0),k=C.toPixels(E),ie=p.xAxis||y.xAxis[0],$=g(O,ie.translate(this.x))+M,H=C.toPixels(N||u(C.min)&&C.logarithmic&&C.logarithmic.lin2log(C.min)||0),Q=Math.abs(k-H),Y=y.inverted,P=this.isNegative;return Y?{x:(P?k:k-Q)-y.plotLeft,y:ie.height-$-_,width:Q,height:_}:{x:$+ie.transB-y.plotLeft,y:(P?k-Q:k)-y.plotTop,width:_,height:Q}}}}),t(e,"Core/Axis/Stacking/StackingAxis.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Axis/Axis.js"],e["Core/Globals.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Axis/Stacking/StackItem.js"],e["Core/Utilities.js"]],function(i,s,r,n,a,l){var c;let{getDeferredAnimation:u}=i,{composed:g}=r,{series:{prototype:p}}=n,{addEvent:C,correctFloat:y,defined:S,destroyObjectProperties:O,fireEvent:M,isArray:_,isNumber:N,objectEach:E,pick:k,pushUnique:ie}=l;function $(){let f=this.inverted;this.axes.forEach(w=>{w.stacking&&w.stacking.stacks&&w.hasVisibleSeries&&(w.stacking.oldStacks=w.stacking.stacks)}),this.series.forEach(w=>{let b=w.xAxis&&w.xAxis.options||{};w.options.stacking&&w.reserveSpace()&&(w.stackKey=[w.type,k(w.options.stack,""),f?b.top:b.left,f?b.height:b.width].join(","))})}function H(){let f=this.stacking;if(f){let w=f.stacks;E(w,(b,h)=>{O(b),delete w[h]}),f.stackTotalGroup?.destroy()}}function Q(){this.stacking||(this.stacking=new R(this))}function Y(f,w,b,h){return!S(f)||f.x!==w||h&&f.stackKey!==h?f={x:w,index:0,key:h,stackKey:h}:f.index++,f.key=[b,w,f.index].join(","),f}function P(){let f,w=this,b=w.yAxis,h=w.stackKey||"",m=b.stacking.stacks,x=w.processedXData,I=w.options.stacking,B=w[I+"Stacker"];B&&[h,"-"+h].forEach(V=>{let U=x.length,K,L,X;for(;U--;)K=x[U],f=w.getStackIndicator(f,K,w.index,V),L=m[V]?.[K],(X=L?.points[f.key||""])&&B.call(w,X,L,U)})}function j(f,w,b){let h=w.total?100/w.total:0;f[0]=y(f[0]*h),f[1]=y(f[1]*h),this.stackedYData[b]=f[1]}function A(f){(this.is("column")||this.is("columnrange"))&&(this.options.centerInCategory&&!this.options.stacking&&this.chart.series.length>1?p.setStackedPoints.call(this,f,"group"):f.stacking.resetStacks())}function v(f,w){let b,h,m,x,I,B,V,U,K,L=w||this.options.stacking;if(!L||!this.reserveSpace()||({group:"xAxis"}[L]||"yAxis")!==f.coll)return;let X=this.processedXData,q=this.processedYData,le=[],D=q.length,F=this.options,oe=F.threshold||0,ne=F.startFromThreshold?oe:0,ae=F.stack,fe=w?`${this.type},${L}`:this.stackKey||"",me="-"+fe,G=this.negStacks,se=f.stacking,ee=se.stacks,ue=se.oldStacks;for(se.stacksTouched+=1,V=0;V<D;V++){U=X[V],K=q[V],B=(b=this.getStackIndicator(b,U,this.index)).key||"",ee[I=(h=G&&K<(ne?0:oe))?me:fe]||(ee[I]={}),ee[I][U]||(ue[I]?.[U]?(ee[I][U]=ue[I][U],ee[I][U].total=null):ee[I][U]=new a(f,f.options.stackLabels,!!h,U,ae)),m=ee[I][U],K!==null?(m.points[B]=m.points[this.index]=[k(m.cumulative,ne)],S(m.cumulative)||(m.base=B),m.touched=se.stacksTouched,b.index>0&&this.singleStacks===!1&&(m.points[B][0]=m.points[this.index+","+U+",0"][0])):(delete m.points[B],delete m.points[this.index]);let de=m.total||0;L==="percent"?(x=h?fe:me,de=G&&ee[x]?.[U]?(x=ee[x][U]).total=Math.max(x.total||0,de)+Math.abs(K)||0:y(de+(Math.abs(K)||0))):L==="group"?(_(K)&&(K=K[0]),K!==null&&de++):de=y(de+(K||0)),L==="group"?m.cumulative=(de||1)-1:m.cumulative=y(k(m.cumulative,ne)+(K||0)),m.total=de,K!==null&&(m.points[B].push(m.cumulative),le[V]=m.cumulative,m.hasValidPoints=!0)}L==="percent"&&(se.usePercentage=!0),L!=="group"&&(this.stackedYData=le),se.oldStacks={}}class R{constructor(w){this.oldStacks={},this.stacks={},this.stacksTouched=0,this.axis=w}buildStacks(){let w,b,h=this.axis,m=h.series,x=h.coll==="xAxis",I=h.options.reversedStacks,B=m.length;for(this.resetStacks(),this.usePercentage=!1,b=B;b--;)w=m[I?b:B-b-1],x&&w.setGroupedPoints(h),w.setStackedPoints(h);if(!x)for(b=0;b<B;b++)m[b].modifyStacks();M(h,"afterBuildStacks")}cleanStacks(){this.oldStacks&&(this.stacks=this.oldStacks,E(this.stacks,w=>{E(w,b=>{b.cumulative=b.total})}))}resetStacks(){E(this.stacks,w=>{E(w,(b,h)=>{N(b.touched)&&b.touched<this.stacksTouched?(b.destroy(),delete w[h]):(b.total=null,b.cumulative=null)})})}renderStackTotals(){let w=this.axis,b=w.chart,h=b.renderer,m=this.stacks,x=w.options.stackLabels?.animation,I=u(b,x||!1),B=this.stackTotalGroup=this.stackTotalGroup||h.g("stack-labels").attr({zIndex:6,opacity:0}).add();B.translate(b.plotLeft,b.plotTop),E(m,V=>{E(V,U=>{U.render(B)})}),B.animate({opacity:1},I)}}return(c||(c={})).compose=function f(w,b,h){if(ie(g,f)){let m=b.prototype,x=h.prototype;C(w,"init",Q),C(w,"destroy",H),m.getStacks=$,x.getStackIndicator=Y,x.modifyStacks=P,x.percentStacker=j,x.setGroupedPoints=A,x.setStackedPoints=v}},c}),t(e,"Series/Line/LineSeries.js",[e["Core/Series/Series.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(i,s,r){let{defined:n,merge:a,isObject:l}=r;class c extends i{drawGraph(){let g=this.options,p=(this.gappedPath||this.getGraphPath).call(this),C=this.chart.styledMode;[this,...this.zones].forEach((y,S)=>{let O,M=y.graph,_=M?"animate":"attr",N=y.dashStyle||g.dashStyle;M?(M.endX=this.preventGraphAnimation?null:p.xMap,M.animate({d:p})):p.length&&(y.graph=M=this.chart.renderer.path(p).addClass("highcharts-graph"+(S?` highcharts-zone-graph-${S-1} `:" ")+(S&&y.className||"")).attr({zIndex:1}).add(this.group)),M&&!C&&(O={stroke:!S&&g.lineColor||y.color||this.color||"#cccccc","stroke-width":g.lineWidth||0,fill:this.fillGraph&&this.color||"none"},N?O.dashstyle=N:g.linecap!=="square"&&(O["stroke-linecap"]=O["stroke-linejoin"]="round"),M[_](O).shadow(S<2&&g.shadow&&a({filterUnits:"userSpaceOnUse"},l(g.shadow)?g.shadow:{}))),M&&(M.startX=p.xMap,M.isArea=p.isArea)})}getGraphPath(g,p,C){let y=this,S=y.options,O=[],M=[],_,N=S.step;g=g||y.points;let E=g.reversed;return E&&g.reverse(),(N={right:1,center:2}[N]||N&&3)&&E&&(N=4-N),(g=this.getValidPoints(g,!1,!(S.connectNulls&&!p&&!C))).forEach(function(k,ie){let $,H=k.plotX,Q=k.plotY,Y=g[ie-1],P=k.isNull||typeof Q!="number";(k.leftCliff||Y&&Y.rightCliff)&&!C&&(_=!0),P&&!n(p)&&ie>0?_=!S.connectNulls:P&&!p?_=!0:(ie===0||_?$=[["M",k.plotX,k.plotY]]:y.getPointSpline?$=[y.getPointSpline(g,k,ie)]:N?($=N===1?[["L",Y.plotX,Q]]:N===2?[["L",(Y.plotX+H)/2,Y.plotY],["L",(Y.plotX+H)/2,Q]]:[["L",H,Y.plotY]]).push(["L",H,Q]):$=[["L",H,Q]],M.push(k.x),N&&(M.push(k.x),N===2&&M.push(k.x)),O.push.apply(O,$),_=!1)}),O.xMap=M,y.graphPath=O,O}}return c.defaultOptions=a(i.defaultOptions,{legendSymbol:"lineMarker"}),s.registerSeriesType("line",c),c}),t(e,"Series/Area/AreaSeries.js",[e["Core/Color/Color.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(i,s,r){let{parse:n}=i,{seriesTypes:{line:a}}=s,{extend:l,merge:c,objectEach:u,pick:g}=r;class p extends a{drawGraph(){this.areaPath=[],super.drawGraph.apply(this);let{areaPath:y,options:S}=this;[this,...this.zones].forEach((O,M)=>{let _={},N=O.fillColor||S.fillColor,E=O.area,k=E?"animate":"attr";E?(E.endX=this.preventGraphAnimation?null:y.xMap,E.animate({d:y})):(_.zIndex=0,(E=O.area=this.chart.renderer.path(y).addClass("highcharts-area"+(M?` highcharts-zone-area-${M-1} `:" ")+(M&&O.className||"")).add(this.group)).isArea=!0),this.chart.styledMode||(_.fill=N||O.color||this.color,_["fill-opacity"]=N?1:S.fillOpacity??.75,E.css({pointerEvents:this.stickyTracking?"none":"auto"})),E[k](_),E.startX=y.xMap,E.shiftUnit=S.step?2:1})}getGraphPath(y){let S,O,M,_=a.prototype.getGraphPath,N=this.options,E=N.stacking,k=this.yAxis,ie=[],$=[],H=this.index,Q=k.stacking.stacks[this.stackKey],Y=N.threshold,P=Math.round(k.getThreshold(N.threshold)),j=g(N.connectNulls,E==="percent"),A=function(h,m,x){let I=y[h],B=E&&Q[I.x].points[H],V=I[x+"Null"]||0,U=I[x+"Cliff"]||0,K,L,X=!0;U||V?(K=(V?B[0]:B[1])+U,L=B[0]+U,X=!!V):!E&&y[m]&&y[m].isNull&&(K=L=Y),K!==void 0&&($.push({plotX:S,plotY:K===null?P:k.getThreshold(K),isNull:X,isCliff:!0}),ie.push({plotX:S,plotY:L===null?P:k.getThreshold(L),doCurve:!1}))};y=y||this.points,E&&(y=this.getStackPoints(y));for(let h=0,m=y.length;h<m;++h)E||(y[h].leftCliff=y[h].rightCliff=y[h].leftNull=y[h].rightNull=void 0),O=y[h].isNull,S=g(y[h].rectPlotX,y[h].plotX),M=E?g(y[h].yBottom,P):P,O&&!j||(j||A(h,h-1,"left"),O&&!E&&j||($.push(y[h]),ie.push({x:h,plotX:S,plotY:M})),j||A(h,h+1,"right"));let v=_.call(this,$,!0,!0);ie.reversed=!0;let R=_.call(this,ie,!0,!0),f=R[0];f&&f[0]==="M"&&(R[0]=["L",f[1],f[2]]);let w=v.concat(R);w.length&&w.push(["Z"]);let b=_.call(this,$,!1,j);return w.xMap=v.xMap,this.areaPath=w,b}getStackPoints(y){let S=this,O=[],M=[],_=this.xAxis,N=this.yAxis,E=N.stacking.stacks[this.stackKey],k={},ie=N.series,$=ie.length,H=N.options.reversedStacks?1:-1,Q=ie.indexOf(S);if(y=y||this.points,this.options.stacking){for(let P=0;P<y.length;P++)y[P].leftNull=y[P].rightNull=void 0,k[y[P].x]=y[P];u(E,function(P,j){P.total!==null&&M.push(j)}),M.sort(function(P,j){return P-j});let Y=ie.map(P=>P.visible);M.forEach(function(P,j){let A=0,v,R;if(k[P]&&!k[P].isNull)O.push(k[P]),[-1,1].forEach(function(f){let w=f===1?"rightNull":"leftNull",b=E[M[j+f]],h=0;if(b){let m=Q;for(;m>=0&&m<$;){let x=ie[m].index;!(v=b.points[x])&&(x===S.index?k[P][w]=!0:Y[m]&&(R=E[P].points[x])&&(h-=R[1]-R[0])),m+=H}}k[P][f===1?"rightCliff":"leftCliff"]=h});else{let f=Q;for(;f>=0&&f<$;){let w=ie[f].index;if(v=E[P].points[w]){A=v[1];break}f+=H}A=g(A,0),A=N.translate(A,0,1,0,1),O.push({isNull:!0,plotX:_.translate(P,0,0,0,1),x:P,plotY:A,yBottom:A})}})}return O}}return p.defaultOptions=c(a.defaultOptions,{threshold:0,legendSymbol:"areaMarker"}),l(p.prototype,{singleStacks:!1}),s.registerSeriesType("area",p),p}),t(e,"Series/Spline/SplineSeries.js",[e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(i,s){let{line:r}=i.seriesTypes,{merge:n,pick:a}=s;class l extends r{getPointSpline(u,g,p){let C,y,S,O,M=g.plotX||0,_=g.plotY||0,N=u[p-1],E=u[p+1];function k($){return $&&!$.isNull&&$.doCurve!==!1&&!g.isCliff}if(k(N)&&k(E)){let $=N.plotX||0,H=N.plotY||0,Q=E.plotX||0,Y=E.plotY||0,P=0;C=(1.5*M+$)/2.5,y=(1.5*_+H)/2.5,S=(1.5*M+Q)/2.5,O=(1.5*_+Y)/2.5,S!==C&&(P=(O-y)*(S-M)/(S-C)+_-O),y+=P,O+=P,y>H&&y>_?(y=Math.max(H,_),O=2*_-y):y<H&&y<_&&(y=Math.min(H,_),O=2*_-y),O>Y&&O>_?(O=Math.max(Y,_),y=2*_-O):O<Y&&O<_&&(O=Math.min(Y,_),y=2*_-O),g.rightContX=S,g.rightContY=O,g.controlPoints={low:[C,y],high:[S,O]}}let ie=["C",a(N.rightContX,N.plotX,0),a(N.rightContY,N.plotY,0),a(C,M,0),a(y,_,0),M,_];return N.rightContX=N.rightContY=void 0,ie}}return l.defaultOptions=n(r.defaultOptions),i.registerSeriesType("spline",l),l}),t(e,"Series/AreaSpline/AreaSplineSeries.js",[e["Series/Spline/SplineSeries.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(i,s,r){let{area:n,area:{prototype:a}}=s.seriesTypes,{extend:l,merge:c}=r;class u extends i{}return u.defaultOptions=c(i.defaultOptions,n.defaultOptions),l(u.prototype,{getGraphPath:a.getGraphPath,getStackPoints:a.getStackPoints,drawGraph:a.drawGraph}),s.registerSeriesType("areaspline",u),u}),t(e,"Series/Column/ColumnSeriesDefaults.js",[],function(){return{borderRadius:3,centerInCategory:!1,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:void 0,verticalAlign:void 0,y:void 0},startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"}}),t(e,"Series/Column/ColumnSeries.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Color/Color.js"],e["Series/Column/ColumnSeriesDefaults.js"],e["Core/Globals.js"],e["Core/Series/Series.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(i,s,r,n,a,l,c){let{animObject:u}=i,{parse:g}=s,{hasTouch:p,noop:C}=n,{clamp:y,defined:S,extend:O,fireEvent:M,isArray:_,isNumber:N,merge:E,pick:k,objectEach:ie,relativeLength:$}=c;class H extends a{animate(Y){let P,j,A=this,v=this.yAxis,R=v.pos,f=A.options,w=this.chart.inverted,b={},h=w?"translateX":"translateY";Y?(b.scaleY=.001,j=y(v.toPixels(f.threshold),R,R+v.len),w?b.translateX=j-v.len:b.translateY=j,A.clipBox&&A.setClip(),A.group.attr(b)):(P=Number(A.group.attr(h)),A.group.animate({scaleY:1},O(u(A.options.animation),{step:function(m,x){A.group&&(b[h]=P+x.pos*(R-P),A.group.attr(b))}})))}init(Y,P){super.init.apply(this,arguments);let j=this;(Y=j.chart).hasRendered&&Y.series.forEach(function(A){A.type===j.type&&(A.isDirty=!0)})}getColumnMetrics(){let Y=this,P=Y.options,j=Y.xAxis,A=Y.yAxis,v=j.options.reversedStacks,R=j.reversed&&!v||!j.reversed&&v,f={},w,b=0;P.grouping===!1?b=1:Y.chart.series.forEach(function(K){let L,X=K.yAxis,q=K.options;K.type===Y.type&&K.reserveSpace()&&A.len===X.len&&A.pos===X.pos&&(q.stacking&&q.stacking!=="group"?(f[w=K.stackKey]===void 0&&(f[w]=b++),L=f[w]):q.grouping!==!1&&(L=b++),K.columnIndex=L)});let h=Math.min(Math.abs(j.transA)*(!j.brokenAxis?.hasBreaks&&j.ordinal?.slope||P.pointRange||j.closestPointRange||j.tickInterval||1),j.len),m=h*P.groupPadding,x=(h-2*m)/(b||1),I=Math.min(P.maxPointWidth||j.len,k(P.pointWidth,x*(1-2*P.pointPadding))),B=(x-I)/2,V=(Y.columnIndex||0)+(R?1:0),U=B+(m+V*x-h/2)*(R?-1:1);return Y.columnMetrics={width:I,offset:U,paddedWidth:x,columnCount:b},Y.columnMetrics}crispCol(Y,P,j,A){this.chart;let v=this.borderWidth,R=-(v%2?.5:0),f=v%2?.5:1;this.options.crisp&&(j=Math.round(Y+j)+R-(Y=Math.round(Y)+R));let w=Math.round(P+A)+f,b=.5>=Math.abs(P)&&w>.5;return A=w-(P=Math.round(P)+f),b&&A&&(P-=1,A+=1),{x:Y,y:P,width:j,height:A}}adjustForMissingColumns(Y,P,j,A){if(!j.isNull&&A.columnCount>1){let v=this.xAxis.series.filter(b=>b.visible).map(b=>b.index),R=0,f=0;ie(this.xAxis.stacking?.stacks,b=>{if(typeof j.x=="number"){let h=b[j.x.toString()];if(h){let m=h.points[this.index];if(_(m)){let x=Object.keys(h.points).filter(I=>!I.match(",")&&h.points[I]&&h.points[I].length>1).map(parseFloat).filter(I=>v.indexOf(I)!==-1).sort((I,B)=>B-I);R=x.indexOf(this.index),f=x.length}}}});let w=(f-1)*A.paddedWidth+P;Y=(j.plotX||0)+w/2-P-R*A.paddedWidth}return Y}translate(){let Y=this,P=Y.chart,j=Y.options,A=Y.dense=Y.closestPointRange*Y.xAxis.transA<2,v=Y.borderWidth=k(j.borderWidth,A?0:1),R=Y.xAxis,f=Y.yAxis,w=j.threshold,b=k(j.minPointLength,5),h=Y.getColumnMetrics(),m=h.width,x=Y.pointXOffset=h.offset,I=Y.dataMin,B=Y.dataMax,V=Y.barW=Math.max(m,1+2*v),U=Y.translatedThreshold=f.getThreshold(w);P.inverted&&(U-=.5),j.pointPadding&&(V=Math.ceil(V)),a.prototype.translate.apply(Y),Y.points.forEach(function(K){let L=k(K.yBottom,U),X=999+Math.abs(L),q=K.plotX||0,le=y(K.plotY,-X,f.len+X);K.stackBox;let D,F=Math.min(le,L),oe=Math.max(le,L)-F,ne=m,ae=q+x,fe=V;b&&Math.abs(oe)<b&&(oe=b,D=!f.reversed&&!K.negative||f.reversed&&K.negative,N(w)&&N(B)&&K.y===w&&B<=w&&(f.min||0)<w&&(I!==B||(f.max||0)<=w)&&(D=!D,K.negative=!K.negative),F=Math.abs(F-U)>b?L-b:U-(D?b:0)),S(K.options.pointWidth)&&(ae-=Math.round(((ne=fe=Math.ceil(K.options.pointWidth))-m)/2)),j.centerInCategory&&!j.stacking&&(ae=Y.adjustForMissingColumns(ae,ne,K,h)),K.barX=ae,K.pointWidth=ne,K.tooltipPos=P.inverted?[y(f.len+f.pos-P.plotLeft-le,f.pos-P.plotLeft,f.len+f.pos-P.plotLeft),R.len+R.pos-P.plotTop-ae-fe/2,oe]:[R.left-P.plotLeft+ae+fe/2,y(le+f.pos-P.plotTop,f.pos-P.plotTop,f.len+f.pos-P.plotTop),oe],K.shapeType=Y.pointClass.prototype.shapeType||"roundedRect",K.shapeArgs=Y.crispCol(ae,K.isNull?U:F,fe,K.isNull?0:oe)}),M(this,"afterColumnTranslate")}drawGraph(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")}pointAttribs(Y,P){let j=this.options,A=this.pointAttrToOptions||{},v=A.stroke||"borderColor",R=A["stroke-width"]||"borderWidth",f,w,b,h=Y&&Y.color||this.color,m=Y&&Y[v]||j[v]||h,x=Y&&Y.options.dashStyle||j.dashStyle,I=Y&&Y[R]||j[R]||this[R]||0,B=k(Y&&Y.opacity,j.opacity,1);Y&&this.zones.length&&(w=Y.getZone(),h=Y.options.color||w&&(w.color||Y.nonZonedColor)||this.color,w&&(m=w.borderColor||m,x=w.dashStyle||x,I=w.borderWidth||I)),P&&Y&&(b=(f=E(j.states[P],Y.options.states&&Y.options.states[P]||{})).brightness,h=f.color||b!==void 0&&g(h).brighten(f.brightness).get()||h,m=f[v]||m,I=f[R]||I,x=f.dashStyle||x,B=k(f.opacity,B));let V={fill:h,stroke:m,"stroke-width":I,opacity:B};return x&&(V.dashstyle=x),V}drawPoints(Y=this.points){let P,j=this,A=this.chart,v=j.options,R=A.renderer,f=v.animationLimit||250;Y.forEach(function(w){let b=w.plotY,h=w.graphic,m=!!h,x=h&&A.pointCount<f?"animate":"attr";N(b)&&w.y!==null?(P=w.shapeArgs,h&&w.hasNewShapeType()&&(h=h.destroy()),j.enabledDataSorting&&(w.startXPos=j.xAxis.reversed?-(P&&P.width||0):j.xAxis.width),!h&&(w.graphic=h=R[w.shapeType](P).add(w.group||j.group),h&&j.enabledDataSorting&&A.hasRendered&&A.pointCount<f&&(h.attr({x:w.startXPos}),m=!0,x="animate")),h&&m&&h[x](E(P)),A.styledMode||h[x](j.pointAttribs(w,w.selected&&"select")).shadow(w.allowShadow!==!1&&v.shadow),h&&(h.addClass(w.getClassName(),!0),h.attr({visibility:w.visible?"inherit":"hidden"}))):h&&(w.graphic=h.destroy())})}drawTracker(Y=this.points){let P,j=this,A=j.chart,v=A.pointer,R=function(f){let w=v.getPointFromEvent(f);w!==void 0&&j.options.enableMouseTracking&&(v.isDirectTouch=!0,w.onMouseOver(f))};Y.forEach(function(f){P=_(f.dataLabels)?f.dataLabels:f.dataLabel?[f.dataLabel]:[],f.graphic&&(f.graphic.element.point=f),P.forEach(function(w){w.div?w.div.point=f:w.element.point=f})}),j._hasTracking||(j.trackerGroups.forEach(function(f){j[f]&&(j[f].addClass("highcharts-tracker").on("mouseover",R).on("mouseout",function(w){v.onTrackerMouseOut(w)}),p&&j[f].on("touchstart",R),!A.styledMode&&j.options.cursor&&j[f].css({cursor:j.options.cursor}))}),j._hasTracking=!0),M(this,"afterDrawTracker")}remove(){let Y=this,P=Y.chart;P.hasRendered&&P.series.forEach(function(j){j.type===Y.type&&(j.isDirty=!0)}),a.prototype.remove.apply(Y,arguments)}}return H.defaultOptions=E(a.defaultOptions,r),O(H.prototype,{directTouch:!0,getSymbol:C,negStacks:!0,trackerGroups:["group","dataLabelsGroup"]}),l.registerSeriesType("column",H),H}),t(e,"Core/Series/DataLabel.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Templating.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s,r,n){var a;let{getDeferredAnimation:l}=i,{format:c}=s,{composed:u}=r,{defined:g,extend:p,fireEvent:C,isArray:y,isString:S,merge:O,objectEach:M,pick:_,pInt:N,pushUnique:E,splat:k}=n;return function(ie){function $(){return v(this).some(f=>f?.enabled)}function H(f,w,b,h,m){let x=this,I=this.chart,B=this.isCartesian&&I.inverted,V=this.enabledDataSorting,U=f.plotX,K=f.plotY,L=b.rotation,X=b.align,q=g(U)&&g(K)&&I.isInsidePlot(U,Math.round(K),{inverted:B,paneCoordinates:!0,series:x}),le=me=>{V&&x.xAxis&&!ne&&x.setDataLabelStartPos(f,w,m,q,me)},D,F,oe,ne=_(b.overflow,V?"none":"justify")==="justify",ae=this.visible&&f.visible!==!1&&g(U)&&(f.series.forceDL||V&&!ne||q||_(b.inside,!!this.options.stacking)&&h&&I.isInsidePlot(U,B?h.x+1:h.y+h.height-1,{inverted:B,paneCoordinates:!0,series:x})),fe=f.pos();if(ae&&fe){L&&w.attr({align:X});let me=w.getBBox(!0),G=[0,0];if(D=I.renderer.fontMetrics(w).b,h=p({x:fe[0],y:Math.round(fe[1]),width:0,height:0},h),p(b,{width:me.width,height:me.height}),L?(ne=!1,F=I.renderer.rotCorr(D,L),oe={x:h.x+(b.x||0)+h.width/2+F.x,y:h.y+(b.y||0)+{top:0,middle:.5,bottom:1}[b.verticalAlign]*h.height},G=[me.x-Number(w.attr("x")),me.y-Number(w.attr("y"))],le(oe),w[m?"attr":"animate"](oe)):(le(h),w.align(b,void 0,h),oe=w.alignAttr),ne&&h.height>=0)this.justifyDataLabel(w,b,oe,me,h,m);else if(_(b.crop,!0)){let{x:se,y:ee}=oe;se+=G[0],ee+=G[1],ae=I.isInsidePlot(se,ee,{paneCoordinates:!0,series:x})&&I.isInsidePlot(se+me.width,ee+me.height,{paneCoordinates:!0,series:x})}b.shape&&!L&&w[m?"attr":"animate"]({anchorX:fe[0],anchorY:fe[1]})}m&&V&&(w.placed=!1),ae||V&&!ne?w.show():(w.hide(),w.placed=!1)}function Q(){return this.plotGroup("dataLabelsGroup","data-labels",this.hasRendered?"inherit":"hidden",this.options.dataLabels.zIndex||6)}function Y(f){let w=this.hasRendered||0,b=this.initDataLabelsGroup().attr({opacity:+w});return!w&&b&&(this.visible&&b.show(),this.options.animation?b.animate({opacity:1},f):b.attr({opacity:1})),b}function P(f){let w;f=f||this.points;let b=this,h=b.chart,m=b.options,x=h.renderer,{backgroundColor:I,plotBackgroundColor:B}=h.options.chart,V=x.getContrast(S(B)&&B||S(I)&&I||"#000000"),U=v(b),{animation:K,defer:L}=U[0],X=L?l(h,K,b):{defer:0,duration:0};C(this,"drawDataLabels"),b.hasDataLabels?.()&&(w=this.initDataLabels(X),f.forEach(q=>{let le=q.dataLabels||[];k(A(U,q.dlOptions||q.options?.dataLabels)).forEach((F,oe)=>{let ne=F.enabled&&q.visible&&(!q.isNull||q.dataLabelOnNull)&&function(re,ce){let Ce=ce.filter;if(Ce){let ge=Ce.operator,ye=re[Ce.property],Ee=Ce.value;return ge===">"&&ye>Ee||ge==="<"&&ye<Ee||ge===">="&&ye>=Ee||ge==="<="&&ye<=Ee||ge==="=="&&ye==Ee||ge==="==="&&ye===Ee||ge==="!="&&ye!=Ee||ge==="!=="&&ye!==Ee}return!0}(q,F),{backgroundColor:ae,borderColor:fe,distance:me,style:G={}}=F,se,ee,ue,de,W={},z=le[oe],Z=!z,te;if(ne&&(ee=_(F[q.formatPrefix+"Format"],F.format),se=q.getLabelConfig(),ue=g(ee)?c(ee,se,h):(F[q.formatPrefix+"Formatter"]||F.formatter).call(se,F),de=F.rotation,!h.styledMode&&(G.color=_(F.color,G.color,S(b.color)?b.color:void 0,"#000000"),G.color==="contrast"?(ae!=="none"&&(te=ae),q.contrastColor=x.getContrast(te!=="auto"&&te||q.color||b.color),G.color=te||!g(me)&&F.inside||0>N(me||0)||m.stacking?q.contrastColor:V):delete q.contrastColor,m.cursor&&(G.cursor=m.cursor)),W={r:F.borderRadius||0,rotation:de,padding:F.padding,zIndex:1},h.styledMode||(W.fill=ae==="auto"?q.color:ae,W.stroke=fe==="auto"?q.color:fe,W["stroke-width"]=F.borderWidth),M(W,(re,ce)=>{re===void 0&&delete W[ce]})),!z||ne&&g(ue)&&!!z.div==!!F.useHTML&&(z.rotation&&F.rotation||z.rotation===F.rotation)||(z=void 0,Z=!0),ne&&g(ue)&&(z?W.text=ue:(z=de?x.text(ue,0,0,F.useHTML).addClass("highcharts-data-label"):x.label(ue,0,0,F.shape,void 0,void 0,F.useHTML,void 0,"data-label"))&&z.addClass(" highcharts-data-label-color-"+q.colorIndex+" "+(F.className||"")+(F.useHTML?" highcharts-tracker":"")),z)){z.options=F,z.attr(W),h.styledMode||z.css(G).shadow(F.shadow);let re=F[q.formatPrefix+"TextPath"]||F.textPath;re&&!F.useHTML&&(z.setTextPath(q.getDataLabelPath?.(z)||q.graphic,re),q.dataLabelPath&&!re.enabled&&(q.dataLabelPath=q.dataLabelPath.destroy())),z.added||z.add(w),b.alignDataLabel(q,z,F,void 0,Z),z.isActive=!0,le[oe]&&le[oe]!==z&&le[oe].destroy(),le[oe]=z}});let D=le.length;for(;D--;)le[D]&&le[D].isActive?le[D].isActive=!1:(le[D]?.destroy(),le.splice(D,1));q.dataLabel=le[0],q.dataLabels=le})),C(this,"afterDrawDataLabels")}function j(f,w,b,h,m,x){let I=this.chart,B=w.align,V=w.verticalAlign,U=f.box?0:f.padding||0,{x:K=0,y:L=0}=w,X,q;return(X=(b.x||0)+U)<0&&(B==="right"&&K>=0?(w.align="left",w.inside=!0):K-=X,q=!0),(X=(b.x||0)+h.width-U)>I.plotWidth&&(B==="left"&&K<=0?(w.align="right",w.inside=!0):K+=I.plotWidth-X,q=!0),(X=b.y+U)<0&&(V==="bottom"&&L>=0?(w.verticalAlign="top",w.inside=!0):L-=X,q=!0),(X=(b.y||0)+h.height-U)>I.plotHeight&&(V==="top"&&L<=0?(w.verticalAlign="bottom",w.inside=!0):L+=I.plotHeight-X,q=!0),q&&(w.x=K,w.y=L,f.placed=!x,f.align(w,void 0,m)),q}function A(f,w){let b=[],h;if(y(f)&&!y(w))b=f.map(function(m){return O(m,w)});else if(y(w)&&!y(f))b=w.map(function(m){return O(f,m)});else if(y(f)||y(w)){if(y(f)&&y(w))for(h=Math.max(f.length,w.length);h--;)b[h]=O(f[h],w[h])}else b=O(f,w);return b}function v(f){let w=f.chart.options.plotOptions;return k(A(A(w?.series?.dataLabels,w?.[f.type]?.dataLabels),f.options.dataLabels))}function R(f,w,b,h,m){let x=this.chart,I=x.inverted,B=this.xAxis,V=B.reversed,U=((I?w.height:w.width)||0)/2,K=f.pointWidth,L=K?K/2:0;w.startXPos=I?m.x:V?-U-L:B.width-U+L,w.startYPos=I?V?this.yAxis.height-U+L:-U-L:m.y,h?w.visibility==="hidden"&&(w.show(),w.attr({opacity:0}).animate({opacity:1})):w.attr({opacity:1}).animate({opacity:0},void 0,w.hide),x.hasRendered&&(b&&w.attr({x:w.startXPos,y:w.startYPos}),w.placed=!0)}ie.compose=function f(w){if(E(u,f)){let b=w.prototype;b.initDataLabelsGroup=Q,b.initDataLabels=Y,b.alignDataLabel=H,b.drawDataLabels=P,b.justifyDataLabel=j,b.setDataLabelStartPos=R,b.hasDataLabels=$}}}(a||(a={})),a}),t(e,"Series/Column/ColumnDataLabel.js",[e["Core/Series/DataLabel.js"],e["Core/Globals.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(i,s,r,n){var a;let{composed:l}=s,{series:c}=r,{merge:u,pick:g,pushUnique:p}=n;return function(C){function y(S,O,M,_,N){let E=this.chart.inverted,k=S.series,ie=(k.xAxis?k.xAxis.len:this.chart.plotSizeX)||0,$=(k.yAxis?k.yAxis.len:this.chart.plotSizeY)||0,H=S.dlBox||S.shapeArgs,Q=g(S.below,S.plotY>g(this.translatedThreshold,$)),Y=g(M.inside,!!this.options.stacking);if(H){if(_=u(H),!(M.overflow==="allow"&&M.crop===!1)){_.y<0&&(_.height+=_.y,_.y=0);let P=_.y+_.height-$;P>0&&P<_.height&&(_.height-=P)}E&&(_={x:$-_.y-_.height,y:ie-_.x-_.width,width:_.height,height:_.width}),Y||(E?(_.x+=Q?0:_.width,_.width=0):(_.y+=Q?_.height:0,_.height=0))}M.align=g(M.align,!E||Y?"center":Q?"right":"left"),M.verticalAlign=g(M.verticalAlign,E||Y?"middle":Q?"top":"bottom"),c.prototype.alignDataLabel.call(this,S,O,M,_,N),M.inside&&S.contrastColor&&O.css({color:S.contrastColor})}C.compose=function S(O){i.compose(c),p(l,S)&&(O.prototype.alignDataLabel=y)}}(a||(a={})),a}),t(e,"Series/Bar/BarSeries.js",[e["Series/Column/ColumnSeries.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(i,s,r){let{extend:n,merge:a}=r;class l extends i{}return l.defaultOptions=a(i.defaultOptions,{}),n(l.prototype,{inverted:!0}),s.registerSeriesType("bar",l),l}),t(e,"Series/Scatter/ScatterSeriesDefaults.js",[],function(){return{lineWidth:0,findNearestPointBy:"xy",jitter:{x:0,y:0},marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">\u25CF</span> <span style="font-size: 0.8em"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}}}),t(e,"Series/Scatter/ScatterSeries.js",[e["Series/Scatter/ScatterSeriesDefaults.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(i,s,r){let{column:n,line:a}=s.seriesTypes,{addEvent:l,extend:c,merge:u}=r;class g extends a{applyJitter(){let C=this,y=this.options.jitter,S=this.points.length;y&&this.points.forEach(function(O,M){["x","y"].forEach(function(_,N){let E,k="plot"+_.toUpperCase(),ie,$,H;y[_]&&!O.isNull&&(E=C[_+"Axis"],H=y[_]*E.transA,E&&!E.isLog&&(ie=Math.max(0,O[k]-H),$=Math.min(E.len,O[k]+H),O[k]=ie+($-ie)*function(Q){let Y=1e4*Math.sin(Q);return Y-Math.floor(Y)}(M+N*S),_==="x"&&(O.clientX=O.plotX)))})})}drawGraph(){this.options.lineWidth?super.drawGraph():this.graph&&(this.graph=this.graph.destroy())}}return g.defaultOptions=u(a.defaultOptions,i),c(g.prototype,{drawTracker:n.prototype.drawTracker,sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"]}),l(g,"afterTranslate",function(){this.applyJitter()}),s.registerSeriesType("scatter",g),g}),t(e,"Series/CenteredUtilities.js",[e["Core/Globals.js"],e["Core/Series/Series.js"],e["Core/Utilities.js"]],function(i,s,r){var n,a;let{deg2rad:l}=i,{fireEvent:c,isNumber:u,pick:g,relativeLength:p}=r;return(a=n||(n={})).getCenter=function(){let C=this.options,y=this.chart,S=2*(C.slicedOffset||0),O=y.plotWidth-2*S,M=y.plotHeight-2*S,_=C.center,N=Math.min(O,M),E=C.thickness,k,ie=C.size,$=C.innerSize||0,H,Q;typeof ie=="string"&&(ie=parseFloat(ie)),typeof $=="string"&&($=parseFloat($));let Y=[g(_[0],"50%"),g(_[1],"50%"),g(ie&&ie<0?void 0:C.size,"100%"),g($&&$<0?void 0:C.innerSize||0,"0%")];for(!y.angular||this instanceof s||(Y[3]=0),H=0;H<4;++H)Q=Y[H],k=H<2||H===2&&/%$/.test(Q),Y[H]=p(Q,[O,M,N,Y[2]][H])+(k?S:0);return Y[3]>Y[2]&&(Y[3]=Y[2]),u(E)&&2*E<Y[2]&&E>0&&(Y[3]=Y[2]-2*E),c(this,"afterGetCenter",{positions:Y}),Y},a.getStartAndEndRadians=function(C,y){let S=u(C)?C:0,O=u(y)&&y>S&&y-S<360?y:S+360;return{start:l*(S+-90),end:l*(O+-90)}},n}),t(e,"Series/Pie/PiePoint.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Series/Point.js"],e["Core/Utilities.js"]],function(i,s,r){let{setAnimation:n}=i,{addEvent:a,defined:l,extend:c,isNumber:u,isString:g,pick:p,relativeLength:C}=r;class y extends s{getConnectorPath(O){let M=O.dataLabelPosition,_=O.options||{},N=_.connectorShape,E=this.connectorShapes[N]||N;return M&&E.call(this,{...M.computed,alignment:M.alignment},M.connectorPosition,_)||[]}getTranslate(){return this.sliced&&this.slicedTranslation||{translateX:0,translateY:0}}haloPath(O){let M=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(M.x,M.y,M.r+O,M.r+O,{innerR:M.r-1,start:M.start,end:M.end,borderRadius:M.borderRadius})}constructor(O,M,_){super(O,M,_),this.half=0,this.name??(this.name="Slice");let N=E=>{this.slice(E.type==="select")};a(this,"select",N),a(this,"unselect",N)}isValid(){return u(this.y)&&this.y>=0}setVisible(O,M=!0){O!==this.visible&&this.update({visible:O??!this.visible},M,void 0,!1)}slice(O,M,_){let N=this.series,E=N.chart;n(_,E),M=p(M,!0),this.sliced=this.options.sliced=O=l(O)?O:!this.sliced,N.options.data[N.data.indexOf(this)]=this.options,this.graphic&&this.graphic.animate(this.getTranslate())}}return c(y.prototype,{connectorShapes:{fixedOffset:function(S,O,M){let _=O.breakAt,N=O.touchingSliceAt,E=M.softConnector?["C",S.x+(S.alignment==="left"?-5:5),S.y,2*_.x-N.x,2*_.y-N.y,_.x,_.y]:["L",_.x,_.y];return[["M",S.x,S.y],E,["L",N.x,N.y]]},straight:function(S,O){let M=O.touchingSliceAt;return[["M",S.x,S.y],["L",M.x,M.y]]},crookedLine:function(S,O,M){let{breakAt:_,touchingSliceAt:N}=O,{series:E}=this,[k,ie,$]=E.center,H=$/2,{plotLeft:Q,plotWidth:Y}=E.chart,P=S.alignment==="left",{x:j,y:A}=S,v=_.x;if(M.crookDistance){let f=C(M.crookDistance,1);v=P?k+H+(Y+Q-k-H)*(1-f):Q+(k-H)*f}else v=k+(ie-A)*Math.tan((this.angle||0)-Math.PI/2);let R=[["M",j,A]];return(P?v<=j&&v>=_.x:v>=j&&v<=_.x)&&R.push(["L",v,A]),R.push(["L",_.x,_.y],["L",N.x,N.y]),R}}}),y}),t(e,"Series/Pie/PieSeriesDefaults.js",[],function(){return{borderRadius:3,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{connectorPadding:5,connectorShape:"crookedLine",crookDistance:void 0,distance:30,enabled:!0,formatter:function(){return this.point.isNull?void 0:this.point.name},softConnector:!0,x:0},fillColor:void 0,ignoreHiddenPoint:!0,inactiveOtherPoints:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,lineWidth:void 0,states:{hover:{brightness:.1}}}}),t(e,"Series/Pie/PieSeries.js",[e["Series/CenteredUtilities.js"],e["Series/Column/ColumnSeries.js"],e["Core/Globals.js"],e["Series/Pie/PiePoint.js"],e["Series/Pie/PieSeriesDefaults.js"],e["Core/Series/Series.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Renderer/SVG/Symbols.js"],e["Core/Utilities.js"]],function(i,s,r,n,a,l,c,u,g){let{getStartAndEndRadians:p}=i,{noop:C}=r,{clamp:y,extend:S,fireEvent:O,merge:M,pick:_,relativeLength:N,splat:E}=g;class k extends l{animate($){let H=this,Q=H.points,Y=H.startAngleRad;$||Q.forEach(function(P){let j=P.graphic,A=P.shapeArgs;j&&A&&(j.attr({r:_(P.startR,H.center&&H.center[3]/2),start:Y,end:Y}),j.animate({r:A.r,start:A.start,end:A.end},H.options.animation))})}drawEmpty(){let $,H,Q=this.startAngleRad,Y=this.endAngleRad,P=this.options;this.total===0&&this.center?($=this.center[0],H=this.center[1],this.graph||(this.graph=this.chart.renderer.arc($,H,this.center[1]/2,0,Q,Y).addClass("highcharts-empty-series").add(this.group)),this.graph.attr({d:u.arc($,H,this.center[2]/2,0,{start:Q,end:Y,innerR:this.center[3]/2})}),this.chart.styledMode||this.graph.attr({"stroke-width":P.borderWidth,fill:P.fillColor||"none",stroke:P.color||"#cccccc"})):this.graph&&(this.graph=this.graph.destroy())}drawPoints(){let $=this.chart.renderer;this.points.forEach(function(H){H.graphic&&H.hasNewShapeType()&&(H.graphic=H.graphic.destroy()),H.graphic||(H.graphic=$[H.shapeType](H.shapeArgs).add(H.series.group),H.delayedRendering=!0)})}generatePoints(){super.generatePoints(),this.updateTotals()}getX($,H,Q,Y){let P=this.center,j=this.radii?this.radii[Q.index]||0:P[2]/2,A=Y.dataLabelPosition,v=A?.distance||0,R=Math.asin(y(($-P[1])/(j+v),-1,1));return P[0]+(H?-1:1)*(Math.cos(R)*(j+v))+(v>0?(H?-1:1)*(Y.padding||0):0)}hasData(){return!!this.processedXData.length}redrawPoints(){let $,H,Q,Y,P=this,j=P.chart;this.drawEmpty(),P.group&&!j.styledMode&&P.group.shadow(P.options.shadow),P.points.forEach(function(A){let v={};H=A.graphic,!A.isNull&&H?(Y=A.shapeArgs,$=A.getTranslate(),j.styledMode||(Q=P.pointAttribs(A,A.selected&&"select")),A.delayedRendering?(H.setRadialReference(P.center).attr(Y).attr($),j.styledMode||H.attr(Q).attr({"stroke-linejoin":"round"}),A.delayedRendering=!1):(H.setRadialReference(P.center),j.styledMode||M(!0,v,Q),M(!0,v,Y,$),H.animate(v)),H.attr({visibility:A.visible?"inherit":"hidden"}),H.addClass(A.getClassName(),!0)):H&&(A.graphic=H.destroy())})}sortByAngle($,H){$.sort(function(Q,Y){return Q.angle!==void 0&&(Y.angle-Q.angle)*H})}translate($){O(this,"translate"),this.generatePoints();let H=this.options,Q=H.slicedOffset,Y=p(H.startAngle,H.endAngle),P=this.startAngleRad=Y.start,j=this.endAngleRad=Y.end,A=j-P,v=this.points,R=H.ignoreHiddenPoint,f=v.length,w,b,h,m,x,I,B,V=0;for($||(this.center=$=this.getCenter()),I=0;I<f;I++){B=v[I],w=P+V*A,B.isValid()&&(!R||B.visible)&&(V+=B.percentage/100),b=P+V*A;let U={x:$[0],y:$[1],r:$[2]/2,innerR:$[3]/2,start:Math.round(1e3*w)/1e3,end:Math.round(1e3*b)/1e3};B.shapeType="arc",B.shapeArgs=U,(h=(b+w)/2)>1.5*Math.PI?h-=2*Math.PI:h<-Math.PI/2&&(h+=2*Math.PI),B.slicedTranslation={translateX:Math.round(Math.cos(h)*Q),translateY:Math.round(Math.sin(h)*Q)},m=Math.cos(h)*$[2]/2,x=Math.sin(h)*$[2]/2,B.tooltipPos=[$[0]+.7*m,$[1]+.7*x],B.half=h<-Math.PI/2||h>Math.PI/2?1:0,B.angle=h}O(this,"afterTranslate")}updateTotals(){let $=this.points,H=$.length,Q=this.options.ignoreHiddenPoint,Y,P,j=0;for(Y=0;Y<H;Y++)(P=$[Y]).isValid()&&(!Q||P.visible)&&(j+=P.y);for(Y=0,this.total=j;Y<H;Y++)(P=$[Y]).percentage=j>0&&(P.visible||!Q)?P.y/j*100:0,P.total=j}}return k.defaultOptions=M(l.defaultOptions,a),S(k.prototype,{axisTypes:[],directTouch:!0,drawGraph:void 0,drawTracker:s.prototype.drawTracker,getCenter:i.getCenter,getSymbol:C,isCartesian:!1,noSharedTooltip:!0,pointAttribs:s.prototype.pointAttribs,pointClass:n,requireSorting:!1,searchPoint:C,trackerGroups:["group","dataLabelsGroup"]}),c.registerSeriesType("pie",k),k}),t(e,"Series/Pie/PieDataLabel.js",[e["Core/Series/DataLabel.js"],e["Core/Globals.js"],e["Core/Renderer/RendererUtilities.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(i,s,r,n,a){var l;let{composed:c,noop:u}=s,{distribute:g}=r,{series:p}=n,{arrayMax:C,clamp:y,defined:S,pick:O,pushUnique:M,relativeLength:_}=a;return function(N){let E={radialDistributionY:function(Q,Y){return(Y.dataLabelPosition?.top||0)+Q.distributeBox.pos},radialDistributionX:function(Q,Y,P,j,A){let v=A.dataLabelPosition;return Q.getX(P<(v?.top||0)+2||P>(v?.bottom||0)-2?j:P,Y.half,Y,A)},justify:function(Q,Y,P,j){return j[0]+(Q.half?-1:1)*(P+(Y.dataLabelPosition?.distance||0))},alignToPlotEdges:function(Q,Y,P,j){let A=Q.getBBox().width;return Y?A+j:P-A-j},alignToConnectors:function(Q,Y,P,j){let A=0,v;return Q.forEach(function(R){(v=R.dataLabel.getBBox().width)>A&&(A=v)}),Y?A+j:P-A-j}};function k(Q,Y){let{center:P,options:j}=this,A=P[2]/2,v=Q.angle||0,R=Math.cos(v),f=Math.sin(v),w=P[0]+R*A,b=P[1]+f*A,h=Math.min((j.slicedOffset||0)+(j.borderWidth||0),Y/5);return{natural:{x:w+R*Y,y:b+f*Y},computed:{},alignment:Y<0?"center":Q.half?"right":"left",connectorPosition:{breakAt:{x:w+R*h,y:b+f*h},touchingSliceAt:{x:w,y:b}},distance:Y}}function ie(){let Q=this,Y=Q.points,P=Q.chart,j=P.plotWidth,A=P.plotHeight,v=P.plotLeft,R=Math.round(P.chartWidth/3),f=Q.center,w=f[2]/2,b=f[1],h=[[],[]],m=[0,0,0,0],x=Q.dataLabelPositioners,I,B,V,U=0;Q.visible&&Q.hasDataLabels?.()&&(Y.forEach(K=>{(K.dataLabels||[]).forEach(L=>{L.shortened&&(L.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),L.shortened=!1)})}),p.prototype.drawDataLabels.apply(Q),Y.forEach(K=>{(K.dataLabels||[]).forEach((L,X)=>{let q=f[2]/2,le=L.options,D=_(le?.distance||0,q);X===0&&h[K.half].push(K),!S(le?.style?.width)&&L.getBBox().width>R&&(L.css({width:Math.round(.7*R)+"px"}),L.shortened=!0),L.dataLabelPosition=this.getDataLabelPosition(K,D),U=Math.max(U,D)})}),h.forEach((K,L)=>{let X=K.length,q=[],le,D,F=0,oe;X&&(Q.sortByAngle(K,L-.5),U>0&&(le=Math.max(0,b-w-U),D=Math.min(b+w+U,P.plotHeight),K.forEach(ne=>{(ne.dataLabels||[]).forEach((ae,fe)=>{let me=ae.dataLabelPosition;me&&me.distance>0&&(me.top=Math.max(0,b-w-me.distance),me.bottom=Math.min(b+w+me.distance,P.plotHeight),F=ae.getBBox().height||21,ne.distributeBox={target:(ae.dataLabelPosition?.natural.y||0)-me.top+F/2,size:F,rank:ne.y},q.push(ne.distributeBox))})}),g(q,oe=D+F-le,oe/5)),K.forEach(ne=>{(ne.dataLabels||[]).forEach(ae=>{let fe=ae.options||{},me=ne.distributeBox,G=ae.dataLabelPosition,se=G?.natural.y||0,ee=fe.connectorPadding||0,ue=0,de=se,W="inherit";if(G){if(q&&S(me)&&G.distance>0&&(me.pos===void 0?W="hidden":(V=me.size,de=x.radialDistributionY(ne,ae))),fe.justify)ue=x.justify(ne,ae,w,f);else switch(fe.alignTo){case"connectors":ue=x.alignToConnectors(K,L,j,v);break;case"plotEdges":ue=x.alignToPlotEdges(ae,L,j,v);break;default:ue=x.radialDistributionX(Q,ne,de,se,ae)}if(G.attribs={visibility:W,align:G.alignment},G.posAttribs={x:ue+(fe.x||0)+({left:ee,right:-ee}[G.alignment]||0),y:de+(fe.y||0)-ae.getBBox().height/2},G.computed.x=ue,G.computed.y=de,O(fe.crop,!0)){let z;ue-(B=ae.getBBox().width)<ee&&L===1?(z=Math.round(B-ue+ee),m[3]=Math.max(z,m[3])):ue+B>j-ee&&L===0&&(z=Math.round(ue+B-j+ee),m[1]=Math.max(z,m[1])),de-V/2<0?m[0]=Math.max(Math.round(-de+V/2),m[0]):de+V/2>A&&(m[2]=Math.max(Math.round(de+V/2-A),m[2])),G.sideOverflow=z}}})}))}),(C(m)===0||this.verifyDataLabelOverflow(m))&&(this.placeDataLabels(),this.points.forEach(K=>{(K.dataLabels||[]).forEach(L=>{let{connectorColor:X,connectorWidth:q=1}=L.options||{},le=L.dataLabelPosition;if(q){let D;I=L.connector,le&&le.distance>0?(D=!I,I||(L.connector=I=P.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+K.colorIndex+(K.className?" "+K.className:"")).add(Q.dataLabelsGroup)),P.styledMode||I.attr({"stroke-width":q,stroke:X||K.color||"#666666"}),I[D?"attr":"animate"]({d:K.getConnectorPath(L)}),I.attr({visibility:le.attribs?.visibility})):I&&(L.connector=I.destroy())}})})))}function $(){this.points.forEach(Q=>{(Q.dataLabels||[]).forEach(Y=>{let P=Y.dataLabelPosition;P?(P.sideOverflow&&(Y.css({width:Math.max(Y.getBBox().width-P.sideOverflow,0)+"px",textOverflow:(Y.options?.style||{}).textOverflow||"ellipsis"}),Y.shortened=!0),Y.attr(P.attribs),Y[Y.moved?"animate":"attr"](P.posAttribs),Y.moved=!0):Y&&Y.attr({y:-9999})}),delete Q.distributeBox},this)}function H(Q){let Y=this.center,P=this.options,j=P.center,A=P.minSize||80,v=A,R=P.size!==null;return!R&&(j[0]!==null?v=Math.max(Y[2]-Math.max(Q[1],Q[3]),A):(v=Math.max(Y[2]-Q[1]-Q[3],A),Y[0]+=(Q[3]-Q[1])/2),j[1]!==null?v=y(v,A,Y[2]-Math.max(Q[0],Q[2])):(v=y(v,A,Y[2]-Q[0]-Q[2]),Y[1]+=(Q[0]-Q[2])/2),v<Y[2]?(Y[2]=v,Y[3]=Math.min(P.thickness?Math.max(0,v-2*P.thickness):Math.max(0,_(P.innerSize||0,v)),v),this.translate(Y),this.drawDataLabels&&this.drawDataLabels()):R=!0),R}N.compose=function Q(Y){if(i.compose(p),M(c,Q)){let P=Y.prototype;P.dataLabelPositioners=E,P.alignDataLabel=u,P.drawDataLabels=ie,P.getDataLabelPosition=k,P.placeDataLabels=$,P.verifyDataLabelOverflow=H}}}(l||(l={})),l}),t(e,"Extensions/OverlappingDataLabels.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s){let{composed:r}=i,{addEvent:n,fireEvent:a,isNumber:l,objectEach:c,pick:u,pushUnique:g}=s;function p(S){let O=S.length,M=this.renderer,_=(Y,P)=>!(P.x>=Y.x+Y.width||P.x+P.width<=Y.x||P.y>=Y.y+Y.height||P.y+P.height<=Y.y),N=Y=>{let P=Y.box?0:Y.padding||0,j,A,v,R=0,f=0,w,b;if(Y&&(!Y.alignAttr||Y.placed))return j=Y.alignAttr||{x:Y.attr("x"),y:Y.attr("y")},A=Y.parentGroup,Y.width||(v=Y.getBBox(),Y.width=v.width,Y.height=v.height,R=M.fontMetrics(Y.element).h),w=Y.width-2*P,(b={left:"0",center:"0.5",right:"1"}[Y.alignValue])?f=+b*w:l(Y.x)&&Math.round(Y.x)!==Y.translateX&&(f=Y.x-(Y.translateX||0)),{x:j.x+(A.translateX||0)+P-(f||0),y:j.y+(A.translateY||0)+P-R,width:Y.width-2*P,height:(Y.height||0)-2*P}},E,k,ie,$,H,Q=!1;for(let Y=0;Y<O;Y++)(E=S[Y])&&(E.oldOpacity=E.opacity,E.newOpacity=1,E.absoluteBox=N(E));S.sort((Y,P)=>(P.labelrank||0)-(Y.labelrank||0));for(let Y=0;Y<O;++Y){$=(k=S[Y])&&k.absoluteBox;for(let P=Y+1;P<O;++P)H=(ie=S[P])&&ie.absoluteBox,$&&H&&k!==ie&&k.newOpacity!==0&&ie.newOpacity!==0&&k.visibility!=="hidden"&&ie.visibility!=="hidden"&&_($,H)&&((k.labelrank<ie.labelrank?k:ie).newOpacity=0)}for(let Y of S)C(Y,this)&&(Q=!0);Q&&a(this,"afterHideAllOverlappingLabels")}function C(S,O){let M,_=!1;return S&&(M=S.newOpacity,S.oldOpacity!==M&&(S.hasClass("highcharts-data-label")?(S[M?"removeClass":"addClass"]("highcharts-data-label-hidden"),_=!0,S[S.isOld?"animate":"attr"]({opacity:M},void 0,function(){O.styledMode||S.css({pointerEvents:M?"auto":"none"})}),a(O,"afterHideOverlappingLabel")):S.attr({opacity:M})),S.isOld=!0),_}function y(){let S=this,O=[];for(let M of S.labelCollectors||[])O=O.concat(M());for(let M of S.yAxis||[])M.stacking&&M.options.stackLabels&&!M.options.stackLabels.allowOverlap&&c(M.stacking.stacks,_=>{c(_,N=>{N.label&&O.push(N.label)})});for(let M of S.series||[])if(M.visible&&M.hasDataLabels?.()){let _=N=>{for(let E of N)E.visible&&(E.dataLabels||[]).forEach(k=>{let ie=k.options||{};k.labelrank=u(ie.labelrank,E.labelrank,E.shapeArgs?.height),ie.allowOverlap??Number(ie.distance)>0?(k.oldOpacity=k.opacity,k.newOpacity=1,C(k,S)):O.push(k)})};_(M.nodes||[]),_(M.points)}this.hideOverlappingLabels(O)}return{compose:function S(O){if(g(r,S)){let M=O.prototype;M.hideOverlappingLabels=p,n(O,"render",y)}}}}),t(e,"Extensions/BorderRadius.js",[e["Core/Defaults.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s,r){let{defaultOptions:n}=i,{composed:a,noop:l}=s,{addEvent:c,extend:u,isObject:g,merge:p,pushUnique:C,relativeLength:y}=r,S={radius:0,scope:"stack",where:void 0},O=l,M=l;function _($,H,Q,Y,P={}){let j=O($,H,Q,Y,P),{innerR:A=0,r:v=Q,start:R=0,end:f=0}=P;if(P.open||!P.borderRadius)return j;let w=f-R,b=Math.sin(w/2),h=Math.max(Math.min(y(P.borderRadius||0,v-A),(v-A)/2,v*b/(1+b)),0),m=Math.min(h,2*(w/Math.PI)*A),x=j.length-1;for(;x--;)(function(I,B,V){let U,K,L,X=I[B],q=I[B+1];if(q[0]==="Z"&&(q=I[0]),(X[0]==="M"||X[0]==="L")&&q[0]==="A"?(U=X,K=q,L=!0):X[0]==="A"&&(q[0]==="M"||q[0]==="L")&&(U=q,K=X),U&&K&&K.params){let le=K[1],D=K[5],F=K.params,{start:oe,end:ne,cx:ae,cy:fe}=F,me=D?le-V:le+V,G=me?Math.asin(V/me):0,se=D?G:-G,ee=Math.cos(G)*me;L?(F.start=oe+se,U[1]=ae+ee*Math.cos(oe),U[2]=fe+ee*Math.sin(oe),I.splice(B+1,0,["A",V,V,0,0,1,ae+le*Math.cos(F.start),fe+le*Math.sin(F.start)])):(F.end=ne-se,K[6]=ae+le*Math.cos(F.end),K[7]=fe+le*Math.sin(F.end),I.splice(B+1,0,["A",V,V,0,0,1,ae+ee*Math.cos(ne),fe+ee*Math.sin(ne)])),K[4]=Math.abs(F.end-F.start)<Math.PI?0:1}})(j,x,x>1?m:h);return j}function N(){if(this.options.borderRadius&&!(this.chart.is3d&&this.chart.is3d())){let{options:$,yAxis:H}=this,Q=$.stacking==="percent",Y=n.plotOptions?.[this.type]?.borderRadius,P=E($.borderRadius,g(Y)?Y:{}),j=H.options.reversed;for(let A of this.points){let{shapeArgs:v}=A;if(A.shapeType==="roundedRect"&&v){let{width:R=0,height:f=0,y:w=0}=v,b=w,h=f;if(P.scope==="stack"&&A.stackTotal){let B=H.translate(Q?100:A.stackTotal,!1,!0,!1,!0),V=H.translate($.threshold||0,!1,!0,!1,!0),U=this.crispCol(0,Math.min(B,V),0,Math.abs(B-V));b=U.y,h=U.height}let m=(A.negative?-1:1)*(j?-1:1)==-1,x=P.where;!x&&this.is("waterfall")&&Math.abs((A.yBottom||0)-(this.translatedThreshold||0))>this.borderWidth&&(x="all"),x||(x="end");let I=Math.min(y(P.radius,R),R/2,x==="all"?f/2:1/0)||0;x==="end"&&(m&&(b-=I),h+=I),u(v,{brBoxHeight:h,brBoxY:b,r:I})}}}}function E($,H){return g($)||($={radius:$||0}),p(S,H,$)}function k(){let $=E(this.options.borderRadius);for(let H of this.points){let Q=H.shapeArgs;Q&&(Q.borderRadius=y($.radius,(Q.r||0)-(Q.innerR||0)))}}function ie($,H,Q,Y,P={}){let j=M($,H,Q,Y,P),{r:A=0,brBoxHeight:v=Y,brBoxY:R=H}=P,f=H-R,w=R+v-(H+Y),b=f-A>-.1?0:A,h=w-A>-.1?0:A,m=Math.max(b&&f,0),x=Math.max(h&&w,0),I=[$+b,H],B=[$+Q-b,H],V=[$+Q,H+b],U=[$+Q,H+Y-h],K=[$+Q-h,H+Y],L=[$+h,H+Y],X=[$,H+Y-h],q=[$,H+b],le=(D,F)=>Math.sqrt(Math.pow(D,2)-Math.pow(F,2));if(m){let D=le(b,b-m);I[0]-=D,B[0]+=D,V[1]=q[1]=H+b-m}if(Y<b-m){let D=le(b,b-m-Y);V[0]=U[0]=$+Q-b+D,K[0]=Math.min(V[0],K[0]),L[0]=Math.max(U[0],L[0]),X[0]=q[0]=$+b-D,V[1]=q[1]=H+Y}if(x){let D=le(h,h-x);K[0]+=D,L[0]-=D,U[1]=X[1]=H+Y-h+x}if(Y<h-x){let D=le(h,h-x-Y);V[0]=U[0]=$+Q-h+D,B[0]=Math.min(V[0],B[0]),I[0]=Math.max(U[0],I[0]),X[0]=q[0]=$+h-D,U[1]=X[1]=H}return j.length=0,j.push(["M",...I],["L",...B],["A",b,b,0,0,1,...V],["L",...U],["A",h,h,0,0,1,...K],["L",...L],["A",h,h,0,0,1,...X],["L",...q],["A",b,b,0,0,1,...I],["Z"]),j}return{compose:function $(H,Q,Y,P){if(C(a,$)){let j=P.prototype.symbols;c(H,"afterColumnTranslate",N,{order:9}),c(Q,"afterTranslate",k),Y.symbolCustomAttribs.push("borderRadius","brBoxHeight","brBoxY"),O=j.arc,M=j.roundedRect,j.arc=_,j.roundedRect=ie}},optionsToObject:E}}),t(e,"Core/Responsive.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s){var r;let{composed:n}=i,{diffObjects:a,extend:l,find:c,merge:u,pick:g,pushUnique:p,uniqueKey:C}=s;return function(y){function S(M,_){let N=M.condition;(N.callback||function(){return this.chartWidth<=g(N.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=g(N.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=g(N.minWidth,0)&&this.chartHeight>=g(N.minHeight,0)}).call(this)&&_.push(M._id)}function O(M,_){let N=this.options.responsive,E=this.currentResponsive,k=[],ie;!_&&N&&N.rules&&N.rules.forEach(Q=>{Q._id===void 0&&(Q._id=C()),this.matchResponsiveRule(Q,k)},this);let $=u(...k.map(Q=>c((N||{}).rules||[],Y=>Y._id===Q)).map(Q=>Q&&Q.chartOptions));$.isResponsiveOptions=!0,k=k.toString()||void 0;let H=E&&E.ruleIds;k!==H&&(E&&this.update(E.undoOptions,M,!0),k?((ie=a($,this.options,!0,this.collectionsWithUpdate)).isResponsiveOptions=!0,this.currentResponsive={ruleIds:k,mergedOptions:$,undoOptions:ie},this.update($,M,!0)):this.currentResponsive=void 0)}y.compose=function M(_){return p(n,M)&&l(_.prototype,{matchResponsiveRule:S,setResponsive:O}),_}}(r||(r={})),r}),t(e,"masters/highcharts.src.js",[e["Core/Globals.js"],e["Core/Utilities.js"],e["Core/Defaults.js"],e["Core/Animation/Fx.js"],e["Core/Animation/AnimationUtilities.js"],e["Core/Renderer/HTML/AST.js"],e["Core/Templating.js"],e["Core/Renderer/RendererUtilities.js"],e["Core/Renderer/SVG/SVGElement.js"],e["Core/Renderer/SVG/SVGRenderer.js"],e["Core/Renderer/HTML/HTMLElement.js"],e["Core/Renderer/HTML/HTMLRenderer.js"],e["Core/Axis/Axis.js"],e["Core/Axis/DateTimeAxis.js"],e["Core/Axis/LogarithmicAxis.js"],e["Core/Axis/PlotLineOrBand/PlotLineOrBand.js"],e["Core/Axis/Tick.js"],e["Core/Tooltip.js"],e["Core/Series/Point.js"],e["Core/Pointer.js"],e["Core/Legend/Legend.js"],e["Core/Chart/Chart.js"],e["Extensions/ScrollablePlotArea.js"],e["Core/Axis/Stacking/StackingAxis.js"],e["Core/Axis/Stacking/StackItem.js"],e["Core/Series/Series.js"],e["Core/Series/SeriesRegistry.js"],e["Series/Column/ColumnSeries.js"],e["Series/Column/ColumnDataLabel.js"],e["Series/Pie/PieSeries.js"],e["Series/Pie/PieDataLabel.js"],e["Core/Series/DataLabel.js"],e["Extensions/OverlappingDataLabels.js"],e["Extensions/BorderRadius.js"],e["Core/Responsive.js"],e["Core/Color/Color.js"],e["Core/Time.js"]],function(i,s,r,n,a,l,c,u,g,p,C,y,S,O,M,_,N,E,k,ie,$,H,Q,Y,P,j,A,v,R,f,w,b,h,m,x,I,B){return i.animate=a.animate,i.animObject=a.animObject,i.getDeferredAnimation=a.getDeferredAnimation,i.setAnimation=a.setAnimation,i.stop=a.stop,i.timers=n.timers,i.AST=l,i.Axis=S,i.Chart=H,i.chart=H.chart,i.Fx=n,i.Legend=$,i.PlotLineOrBand=_,i.Point=k,i.Pointer=ie,i.Series=j,i.StackItem=P,i.SVGElement=g,i.SVGRenderer=p,i.Templating=c,i.Tick=N,i.Time=B,i.Tooltip=E,i.Color=I,i.color=I.parse,y.compose(p),C.compose(g),ie.compose(H),$.compose(H),i.defaultOptions=r.defaultOptions,i.getOptions=r.getOptions,i.time=r.defaultTime,i.setOptions=r.setOptions,i.dateFormat=c.dateFormat,i.format=c.format,i.numberFormat=c.numberFormat,s.extend(i,s),i.distribute=u.distribute,i.seriesType=A.seriesType,R.compose(v),m.compose(j,f,g,p),b.compose(j),O.compose(S),M.compose(S),h.compose(H),w.compose(f),_.compose(S),x.compose(H),Q.compose(S,H,j),Y.compose(S,H,j),E.compose(ie),i}),e["masters/highcharts.src.js"]._modules=e,e["masters/highcharts.src.js"]})});var q_=Ie((Mxe,ig)=>{"use strict";(function(o){typeof ig=="object"&&ig.exports?(o.default=o,ig.exports=o):typeof define=="function"&&define.amd?define("highcharts/modules/exporting",["highcharts"],function(e){return o(e),o.Highcharts=e,o}):o(typeof Highcharts<"u"?Highcharts:void 0)})(function(o){"use strict";var e=o?o._modules:{};function t(i,s,r,n){i.hasOwnProperty(s)||(i[s]=n.apply(null,r),typeof CustomEvent=="function"&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:s,module:i[s]}})))}t(e,"Core/Chart/ChartNavigationComposition.js",[],function(){var i;return function(s){s.compose=function(n){return n.navigation||(n.navigation=new r(n)),n};class r{constructor(a){this.updates=[],this.chart=a}addUpdate(a){this.chart.navigation.updates.push(a)}update(a,l){this.updates.forEach(c=>{c.call(this.chart,a,l)})}}s.Additions=r}(i||(i={})),i}),t(e,"Extensions/Exporting/ExportingDefaults.js",[e["Core/Globals.js"]],function(i){let{isTouchDevice:s}=i;return{exporting:{allowTableSorting:!0,type:"image/png",url:"https://export.highcharts.com/",pdfFont:{normal:void 0,bold:void 0,bolditalic:void 0,italic:void 0},printMaxWidth:780,scale:2,buttons:{contextButton:{className:"highcharts-contextbutton",menuClassName:"highcharts-contextmenu",symbol:"menu",titleKey:"contextButtonTitle",menuItems:["viewFullscreen","printChart","separator","downloadPNG","downloadJPEG","downloadPDF","downloadSVG"]}},menuItemDefinitions:{viewFullscreen:{textKey:"viewFullscreen",onclick:function(){this.fullscreen&&this.fullscreen.toggle()}},printChart:{textKey:"printChart",onclick:function(){this.print()}},separator:{separator:!0},downloadPNG:{textKey:"downloadPNG",onclick:function(){this.exportChart()}},downloadJPEG:{textKey:"downloadJPEG",onclick:function(){this.exportChart({type:"image/jpeg"})}},downloadPDF:{textKey:"downloadPDF",onclick:function(){this.exportChart({type:"application/pdf"})}},downloadSVG:{textKey:"downloadSVG",onclick:function(){this.exportChart({type:"image/svg+xml"})}}}},lang:{viewFullscreen:"View in full screen",exitFullscreen:"Exit from full screen",printChart:"Print chart",downloadPNG:"Download PNG image",downloadJPEG:"Download JPEG image",downloadPDF:"Download PDF document",downloadSVG:"Download SVG vector image",contextButtonTitle:"Chart context menu"},navigation:{buttonOptions:{symbolSize:14,symbolX:14.5,symbolY:13.5,align:"right",buttonSpacing:3,height:28,verticalAlign:"top",width:28,symbolFill:"#666666",symbolStroke:"#666666",symbolStrokeWidth:3,theme:{padding:5}},menuStyle:{border:"none",borderRadius:"3px",background:"#ffffff",padding:"0.5em"},menuItemStyle:{background:"none",borderRadius:"3px",color:"#333333",padding:"0.5em",fontSize:s?"0.9em":"0.8em",transition:"background 250ms, color 250ms"},menuItemHoverStyle:{background:"#f2f2f2"}}}}),t(e,"Extensions/Exporting/ExportingSymbols.js",[],function(){var i;return function(s){let r=[];function n(l,c,u,g){return[["M",l,c+2.5],["L",l+u,c+2.5],["M",l,c+g/2+.5],["L",l+u,c+g/2+.5],["M",l,c+g-1.5],["L",l+u,c+g-1.5]]}function a(l,c,u,g){let p=g/3-2;return[].concat(this.circle(u-p,c,p,p),this.circle(u-p,c+p+4,p,p),this.circle(u-p,c+2*(p+4),p,p))}s.compose=function(l){if(r.indexOf(l)===-1){r.push(l);let c=l.prototype.symbols;c.menu=n,c.menuball=a.bind(c)}}}(i||(i={})),i}),t(e,"Extensions/Exporting/Fullscreen.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s,r){let{composed:n}=s,{addEvent:a,fireEvent:l,pushUnique:c}=r;function u(){this.fullscreen=new g(this)}class g{static compose(C){c(n,this.compose)&&a(C,"beforeRender",u)}constructor(C){this.chart=C,this.isOpen=!1;let y=C.renderTo;!this.browserProps&&(typeof y.requestFullscreen=="function"?this.browserProps={fullscreenChange:"fullscreenchange",requestFullscreen:"requestFullscreen",exitFullscreen:"exitFullscreen"}:y.mozRequestFullScreen?this.browserProps={fullscreenChange:"mozfullscreenchange",requestFullscreen:"mozRequestFullScreen",exitFullscreen:"mozCancelFullScreen"}:y.webkitRequestFullScreen?this.browserProps={fullscreenChange:"webkitfullscreenchange",requestFullscreen:"webkitRequestFullScreen",exitFullscreen:"webkitExitFullscreen"}:y.msRequestFullscreen&&(this.browserProps={fullscreenChange:"MSFullscreenChange",requestFullscreen:"msRequestFullscreen",exitFullscreen:"msExitFullscreen"}))}close(){let C=this,y=C.chart,S=y.options.chart;l(y,"fullscreenClose",null,function(){C.isOpen&&C.browserProps&&y.container.ownerDocument instanceof Document&&y.container.ownerDocument[C.browserProps.exitFullscreen](),C.unbindFullscreenEvent&&(C.unbindFullscreenEvent=C.unbindFullscreenEvent()),y.setSize(C.origWidth,C.origHeight,!1),C.origWidth=void 0,C.origHeight=void 0,S.width=C.origWidthOption,S.height=C.origHeightOption,C.origWidthOption=void 0,C.origHeightOption=void 0,C.isOpen=!1,C.setButtonText()})}open(){let C=this,y=C.chart,S=y.options.chart;l(y,"fullscreenOpen",null,function(){if(S&&(C.origWidthOption=S.width,C.origHeightOption=S.height),C.origWidth=y.chartWidth,C.origHeight=y.chartHeight,C.browserProps){let O=a(y.container.ownerDocument,C.browserProps.fullscreenChange,function(){C.isOpen?(C.isOpen=!1,C.close()):(y.setSize(null,null,!1),C.isOpen=!0,C.setButtonText())}),M=a(y,"destroy",O);C.unbindFullscreenEvent=()=>{O(),M()};let _=y.renderTo[C.browserProps.requestFullscreen]();_&&_.catch(function(){alert("Full screen is not supported inside a frame.")})}})}setButtonText(){let C=this.chart,y=C.exportDivElements,S=C.options.exporting,O=S&&S.buttons&&S.buttons.contextButton.menuItems,M=C.options.lang;if(S&&S.menuItemDefinitions&&M&&M.exitFullscreen&&M.viewFullscreen&&O&&y){let _=y[O.indexOf("viewFullscreen")];_&&i.setElementHTML(_,this.isOpen?M.exitFullscreen:S.menuItemDefinitions.viewFullscreen.text||M.viewFullscreen)}}toggle(){this.isOpen?this.close():this.open()}}return g}),t(e,"Core/HttpUtilities.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s){let{doc:r,win:n}=i,{createElement:a,discardElement:l,merge:c,objectEach:u}=s,g={ajax:function(p){let C={json:"application/json",xml:"application/xml",text:"text/plain",octet:"application/octet-stream"},y=new XMLHttpRequest;function S(O,M){p.error&&p.error(O,M)}if(!p.url)return!1;y.open((p.type||"get").toUpperCase(),p.url,!0),p.headers&&p.headers["Content-Type"]||y.setRequestHeader("Content-Type",C[p.dataType||"json"]||C.text),u(p.headers,function(O,M){y.setRequestHeader(M,O)}),p.responseType&&(y.responseType=p.responseType),y.onreadystatechange=function(){let O;if(y.readyState===4){if(y.status===200){if(p.responseType!=="blob"&&(O=y.responseText,p.dataType==="json"))try{O=JSON.parse(O)}catch(M){if(M instanceof Error)return S(y,M)}return p.success&&p.success(O,y)}S(y,y.responseText)}},p.data&&typeof p.data!="string"&&(p.data=JSON.stringify(p.data)),y.send(p.data)},getJSON:function(p,C){g.ajax({url:p,success:C,dataType:"json",headers:{"Content-Type":"text/plain"}})},post:function(p,C,y){let S=new n.FormData;u(C,function(_,N){S.append(N,_)}),S.append("b64","true");let{filename:O,type:M}=C;return n.fetch(p,{method:"POST",body:S,...y}).then(_=>{_.ok&&_.text().then(N=>{let E=document.createElement("a");E.href=`data:${M};base64,${N}`,E.download=O,E.click(),l(E)})})}};return g}),t(e,"Extensions/Exporting/Exporting.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Chart/Chart.js"],e["Core/Chart/ChartNavigationComposition.js"],e["Core/Defaults.js"],e["Extensions/Exporting/ExportingDefaults.js"],e["Extensions/Exporting/ExportingSymbols.js"],e["Extensions/Exporting/Fullscreen.js"],e["Core/Globals.js"],e["Core/HttpUtilities.js"],e["Core/Utilities.js"]],function(i,s,r,n,a,l,c,u,g,p){var C;let{defaultOptions:y,setOptions:S}=n,{composed:O,doc:M,SVG_NS:_,win:N}=u,{addEvent:E,css:k,createElement:ie,discardElement:$,extend:H,find:Q,fireEvent:Y,isObject:P,merge:j,objectEach:A,pick:v,pushUnique:R,removeEvent:f,uniqueKey:w}=p;return function(b){let h,m=[/-/,/^(clipPath|cssText|d|height|width)$/,/^font$/,/[lL]ogical(Width|Height)$/,/^parentRule$/,/^(cssRules|ownerRules)$/,/perspective/,/TapHighlightColor/,/^transition/,/^length$/,/^[0-9]+$/],x=["fill","stroke","strokeLinecap","strokeLinejoin","strokeWidth","textAnchor","x","y"];b.inlineAllowlist=[];let I=["clipPath","defs","desc"];function B(ee){let ue,de,W=this,z=W.renderer,Z=j(W.options.navigation.buttonOptions,ee),te=Z.onclick,re=Z.menuItems,ce=Z.symbolSize||12;if(W.btnCount||(W.btnCount=0),W.exportDivElements||(W.exportDivElements=[],W.exportSVGElements=[]),Z.enabled===!1||!Z.theme)return;let Ce=Z.theme;W.styledMode||(Ce.fill=v(Ce.fill,"#ffffff"),Ce.stroke=v(Ce.stroke,"none")),te?de=function(ye){ye&&ye.stopPropagation(),te.call(W,ye)}:re&&(de=function(ye){ye&&ye.stopPropagation(),W.contextMenu(ge.menuClassName,re,ge.translateX||0,ge.translateY||0,ge.width||0,ge.height||0,ge),ge.setState(2)}),Z.text&&Z.symbol?Ce.paddingLeft=v(Ce.paddingLeft,30):Z.text||H(Ce,{width:Z.width,height:Z.height,padding:0}),W.styledMode||(Ce["stroke-linecap"]="round",Ce.fill=v(Ce.fill,"#ffffff"),Ce.stroke=v(Ce.stroke,"none"));let ge=z.button(Z.text,0,0,de,Ce,void 0,void 0,void 0,void 0,Z.useHTML).addClass(ee.className).attr({title:v(W.options.lang[Z._titleKey||Z.titleKey],"")});ge.menuClassName=ee.menuClassName||"highcharts-menu-"+W.btnCount++,Z.symbol&&(ue=z.symbol(Z.symbol,Z.symbolX-ce/2,Z.symbolY-ce/2,ce,ce,{width:ce,height:ce}).addClass("highcharts-button-symbol").attr({zIndex:1}).add(ge),W.styledMode||ue.attr({stroke:Z.symbolStroke,fill:Z.symbolFill,"stroke-width":Z.symbolStrokeWidth||1})),ge.add(W.exportingGroup).align(H(Z,{width:ge.width,x:v(Z.x,W.buttonOffset)}),!0,"spacingBox"),W.buttonOffset+=((ge.width||0)+Z.buttonSpacing)*(Z.align==="right"?-1:1),W.exportSVGElements.push(ge,ue)}function V(){if(!this.printReverseInfo)return;let{childNodes:ee,origDisplay:ue,resetParams:de}=this.printReverseInfo;this.moveContainers(this.renderTo),[].forEach.call(ee,function(W,z){W.nodeType===1&&(W.style.display=ue[z]||"")}),this.isPrinting=!1,de&&this.setSize.apply(this,de),delete this.printReverseInfo,h=void 0,Y(this,"afterPrint")}function U(){let ee=M.body,ue=this.options.exporting.printMaxWidth,de={childNodes:ee.childNodes,origDisplay:[],resetParams:void 0};this.isPrinting=!0,this.pointer.reset(null,0),Y(this,"beforePrint"),ue&&this.chartWidth>ue&&(de.resetParams=[this.options.chart.width,void 0,!1],this.setSize(ue,void 0,!1)),[].forEach.call(de.childNodes,function(z,Z){z.nodeType===1&&(de.origDisplay[Z]=z.style.display,z.style.display="none")}),this.moveContainers(ee),this.printReverseInfo=de}function K(ee){ee.renderExporting(),E(ee,"redraw",ee.renderExporting),E(ee,"destroy",ee.destroyExport)}function L(ee,ue,de,W,z,Z,te){let re=this,ce=re.options.navigation,Ce=re.chartWidth,ge=re.chartHeight,ye="cache-"+ee,Ee=Math.max(z,Z),Se,be=re[ye];be||(re.exportContextMenu=re[ye]=be=ie("div",{className:ee},{position:"absolute",zIndex:1e3,padding:Ee+"px",pointerEvents:"auto",...re.renderer.style},re.fixedDiv||re.container),Se=ie("ul",{className:"highcharts-menu"},re.styledMode?{}:{listStyle:"none",margin:0,padding:0},be),re.styledMode||k(Se,H({MozBoxShadow:"3px 3px 10px #888",WebkitBoxShadow:"3px 3px 10px #888",boxShadow:"3px 3px 10px #888"},ce.menuStyle)),be.hideMenu=function(){k(be,{display:"none"}),te&&te.setState(0),re.openMenu=!1,k(re.renderTo,{overflow:"hidden"}),k(re.container,{overflow:"hidden"}),p.clearTimeout(be.hideTimer),Y(re,"exportMenuHidden")},re.exportEvents.push(E(be,"mouseleave",function(){be.hideTimer=N.setTimeout(be.hideMenu,500)}),E(be,"mouseenter",function(){p.clearTimeout(be.hideTimer)}),E(M,"mouseup",function(Ae){re.pointer.inClass(Ae.target,ee)||be.hideMenu()}),E(be,"click",function(){re.openMenu&&be.hideMenu()})),ue.forEach(function(Ae){if(typeof Ae=="string"&&(Ae=re.options.exporting.menuItemDefinitions[Ae]),P(Ae,!0)){let Ne;Ae.separator?Ne=ie("hr",void 0,void 0,Se):(Ae.textKey==="viewData"&&re.isDataTableVisible&&(Ae.textKey="hideData"),Ne=ie("li",{className:"highcharts-menu-item",onclick:function(Me){Me&&Me.stopPropagation(),be.hideMenu(),typeof Ae!="string"&&Ae.onclick&&Ae.onclick.apply(re,arguments)}},void 0,Se),i.setElementHTML(Ne,Ae.text||re.options.lang[Ae.textKey]),re.styledMode||(Ne.onmouseover=function(){k(this,ce.menuItemHoverStyle)},Ne.onmouseout=function(){k(this,ce.menuItemStyle)},k(Ne,H({cursor:"pointer"},ce.menuItemStyle||{})))),re.exportDivElements.push(Ne)}}),re.exportDivElements.push(Se,be),re.exportMenuWidth=be.offsetWidth,re.exportMenuHeight=be.offsetHeight);let Re={display:"block"};de+re.exportMenuWidth>Ce?Re.right=Ce-de-z-Ee+"px":Re.left=de-Ee+"px",W+Z+re.exportMenuHeight>ge&&te.alignOptions.verticalAlign!=="top"?Re.bottom=ge-W-Ee+"px":Re.top=W+Z-Ee+"px",k(be,Re),k(re.renderTo,{overflow:""}),k(re.container,{overflow:""}),re.openMenu=!0,Y(re,"exportMenuShown")}function X(ee){let ue,de=ee?ee.target:this,W=de.exportSVGElements,z=de.exportDivElements,Z=de.exportEvents;W&&(W.forEach((te,re)=>{te&&(te.onclick=te.ontouchstart=null,de[ue="cache-"+te.menuClassName]&&delete de[ue],W[re]=te.destroy())}),W.length=0),de.exportingGroup&&(de.exportingGroup.destroy(),delete de.exportingGroup),z&&(z.forEach(function(te,re){te&&(p.clearTimeout(te.hideTimer),f(te,"mouseleave"),z[re]=te.onmouseout=te.onmouseover=te.ontouchstart=te.onclick=null,$(te))}),z.length=0),Z&&(Z.forEach(function(te){te()}),Z.length=0)}function q(ee,ue){let de=this.getSVGForExport(ee,ue);ee=j(this.options.exporting,ee),g.post(ee.url,{filename:ee.filename?ee.filename.replace(/\//g,"-"):this.getFilename(),type:ee.type,width:ee.width,scale:ee.scale,svg:de},ee.fetchOptions)}function le(){return this.styledMode&&this.inlineStyles(),this.container.innerHTML}function D(){let ee=this.userOptions.title&&this.userOptions.title.text,ue=this.options.exporting.filename;return ue?ue.replace(/\//g,"-"):(typeof ee=="string"&&(ue=ee.toLowerCase().replace(/<\/?[^>]+(>|$)/g,"").replace(/[\s_]+/g,"-").replace(/[^a-z0-9\-]/g,"").replace(/^[\-]+/g,"").replace(/[\-]+/g,"-").substr(0,24).replace(/[\-]+$/g,"")),(!ue||ue.length<5)&&(ue="chart"),ue)}function F(ee){let ue,de,W=j(this.options,ee);W.plotOptions=j(this.userOptions.plotOptions,ee&&ee.plotOptions),W.time=j(this.userOptions.time,ee&&ee.time);let z=ie("div",null,{position:"absolute",top:"-9999em",width:this.chartWidth+"px",height:this.chartHeight+"px"},M.body),Z=this.renderTo.style.width,te=this.renderTo.style.height,re=W.exporting.sourceWidth||W.chart.width||/px$/.test(Z)&&parseInt(Z,10)||(W.isGantt?800:600),ce=W.exporting.sourceHeight||W.chart.height||/px$/.test(te)&&parseInt(te,10)||400;H(W.chart,{animation:!1,renderTo:z,forExport:!0,renderer:"SVGRenderer",width:re,height:ce}),W.exporting.enabled=!1,delete W.data,W.series=[],this.series.forEach(function(ye){(de=j(ye.userOptions,{animation:!1,enableMouseTracking:!1,showCheckbox:!1,visible:ye.visible})).isInternal||W.series.push(de)});let Ce={};this.axes.forEach(function(ye){ye.userOptions.internalKey||(ye.userOptions.internalKey=w()),ye.options.isInternal||(Ce[ye.coll]||(Ce[ye.coll]=!0,W[ye.coll]=[]),W[ye.coll].push(j(ye.userOptions,{visible:ye.visible})))}),W.colorAxis=this.userOptions.colorAxis;let ge=new this.constructor(W,this.callback);return ee&&["xAxis","yAxis","series"].forEach(function(ye){let Ee={};ee[ye]&&(Ee[ye]=ee[ye],ge.update(Ee))}),this.axes.forEach(function(ye){let Ee=Q(ge.axes,function(Ae){return Ae.options.internalKey===ye.userOptions.internalKey}),Se=ye.getExtremes(),be=Se.userMin,Re=Se.userMax;Ee&&(be!==void 0&&be!==Ee.min||Re!==void 0&&Re!==Ee.max)&&Ee.setExtremes(be,Re,!0,!1)}),ue=ge.getChartHTML(),Y(this,"getSVG",{chartCopy:ge}),ue=this.sanitizeSVG(ue,W),W=null,ge.destroy(),$(z),ue}function oe(ee,ue){let de=this.options.exporting;return this.getSVG(j({chart:{borderRadius:0}},de.chartOptions,ue,{exporting:{sourceWidth:ee&&ee.sourceWidth||de.sourceWidth,sourceHeight:ee&&ee.sourceHeight||de.sourceHeight}}))}function ne(){let ee,ue=b.inlineAllowlist,de={},W=M.createElement("iframe");k(W,{width:"1px",height:"1px",visibility:"hidden"}),M.body.appendChild(W);let z=W.contentWindow&&W.contentWindow.document;z&&z.body.appendChild(z.createElementNS(_,"svg")),function Z(te){let re,ce,Ce,ge,ye,Ee,Se={};if(z&&te.nodeType===1&&I.indexOf(te.nodeName)===-1){if(re=N.getComputedStyle(te,null),ce=te.nodeName==="svg"?{}:N.getComputedStyle(te.parentNode,null),!de[te.nodeName]){ee=z.getElementsByTagName("svg")[0],Ce=z.createElementNS(te.namespaceURI,te.nodeName),ee.appendChild(Ce);let be=N.getComputedStyle(Ce,null),Re={};for(let Ae in be)typeof be[Ae]!="string"||/^[0-9]+$/.test(Ae)||(Re[Ae]=be[Ae]);de[te.nodeName]=Re,te.nodeName==="text"&&delete de.text.fill,ee.removeChild(Ce)}for(let be in re)(u.isFirefox||u.isMS||u.isSafari||Object.hasOwnProperty.call(re,be))&&function(Re,Ae){if(ge=ye=!1,ue.length){for(Ee=ue.length;Ee--&&!ye;)ye=ue[Ee].test(Ae);ge=!ye}for(Ae==="transform"&&Re==="none"&&(ge=!0),Ee=m.length;Ee--&&!ge;)ge=m[Ee].test(Ae)||typeof Re=="function";!ge&&(ce[Ae]!==Re||te.nodeName==="svg")&&de[te.nodeName][Ae]!==Re&&(x&&x.indexOf(Ae)===-1?Se[Ae]=Re:Re&&te.setAttribute(Ae.replace(/([A-Z])/g,function(Ne,Me){return"-"+Me.toLowerCase()}),Re))}(re[be],be);if(k(te,Se),te.nodeName==="svg"&&te.setAttribute("stroke-width","1px"),te.nodeName==="text")return;[].forEach.call(te.children||te.childNodes,Z)}}(this.container.querySelector("svg")),ee.parentNode.removeChild(ee),W.parentNode.removeChild(W)}function ae(ee){(this.fixedDiv?[this.fixedDiv,this.scrollingContainer]:[this.container]).forEach(function(ue){ee.appendChild(ue)})}function fe(){let ee=this,ue=(de,W,z)=>{ee.isDirtyExporting=!0,j(!0,ee.options[de],W),v(z,!0)&&ee.redraw()};ee.exporting={update:function(de,W){ue("exporting",de,W)}},r.compose(ee).navigation.addUpdate((de,W)=>{ue("navigation",de,W)})}function me(){let ee=this;ee.isPrinting||(h=ee,u.isSafari||ee.beforePrint(),setTimeout(()=>{N.focus(),N.print(),u.isSafari||setTimeout(()=>{ee.afterPrint()},1e3)},1))}function G(){let ee=this,ue=ee.options.exporting,de=ue.buttons,W=ee.isDirtyExporting||!ee.exportSVGElements;ee.buttonOffset=0,ee.isDirtyExporting&&ee.destroyExport(),W&&ue.enabled!==!1&&(ee.exportEvents=[],ee.exportingGroup=ee.exportingGroup||ee.renderer.g("exporting-group").attr({zIndex:3}).add(),A(de,function(z){ee.addButton(z)}),ee.isDirtyExporting=!1)}function se(ee,ue){let de=ee.indexOf("</svg>")+6,W=ee.substr(de);return ee=ee.substr(0,de),ue&&ue.exporting&&ue.exporting.allowHTML&&W&&(W='<foreignObject x="0" y="0" width="'+ue.chart.width+'" height="'+ue.chart.height+'"><body xmlns="http://www.w3.org/1999/xhtml">'+W.replace(/(<(?:img|br).*?(?=\>))>/g,"$1 />")+"</body></foreignObject>",ee=ee.replace("</svg>",W+"</svg>")),ee=ee.replace(/zIndex="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery[0-9]+="[^"]+"/g,"").replace(/url\(("|&quot;)(.*?)("|&quot;)\;?\)/g,"url($2)").replace(/url\([^#]+#/g,"url(#").replace(/<svg /,'<svg xmlns:xlink="http://www.w3.org/1999/xlink" ').replace(/ (|NS[0-9]+\:)href=/g," xlink:href=").replace(/\n/," ").replace(/(fill|stroke)="rgba\(([ 0-9]+,[ 0-9]+,[ 0-9]+),([ 0-9\.]+)\)"/g,'$1="rgb($2)" $1-opacity="$3"').replace(/&nbsp;/g,"\xA0").replace(/&shy;/g,"\xAD")}b.compose=function ee(ue,de){if(l.compose(de),c.compose(ue),R(O,ee)){let W=ue.prototype;W.afterPrint=V,W.exportChart=q,W.inlineStyles=ne,W.print=me,W.sanitizeSVG=se,W.getChartHTML=le,W.getSVG=F,W.getSVGForExport=oe,W.getFilename=D,W.moveContainers=ae,W.beforePrint=U,W.contextMenu=L,W.addButton=B,W.destroyExport=X,W.renderExporting=G,W.callbacks.push(K),E(ue,"init",fe),u.isSafari&&N.matchMedia("print").addListener(function(z){h&&(z.matches?h.beforePrint():h.afterPrint())}),y.exporting=j(a.exporting,y.exporting),y.lang=j(a.lang,y.lang),y.navigation=j(a.navigation,y.navigation)}}}(C||(C={})),C}),t(e,"masters/modules/exporting.src.js",[e["Core/Globals.js"],e["Extensions/Exporting/Exporting.js"],e["Core/HttpUtilities.js"]],function(i,s,r){i.HttpUtilities=r,i.ajax=r.ajax,i.getJSON=r.getJSON,i.post=r.post,s.compose(i.Chart,i.Renderer)})})});var K_=Ie((Oxe,sg)=>{"use strict";(function(o){typeof sg=="object"&&sg.exports?(o.default=o,sg.exports=o):typeof define=="function"&&define.amd?define("highcharts/modules/offline-exporting",["highcharts","highcharts/modules/exporting"],function(e){return o(e),o.Highcharts=e,o}):o(typeof Highcharts<"u"?Highcharts:void 0)})(function(o){"use strict";var e=o?o._modules:{};function t(i,s,r,n){i.hasOwnProperty(s)||(i[s]=n.apply(null,r),typeof CustomEvent=="function"&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:s,module:i[s]}})))}t(e,"Extensions/DownloadURL.js",[e["Core/Globals.js"]],function(i){let{isSafari:s,win:r,win:{document:n}}=i,a=r.URL||r.webkitURL||r;function l(c){let u=c.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);if(u&&u.length>3&&r.atob&&r.ArrayBuffer&&r.Uint8Array&&r.Blob&&a.createObjectURL){let g=r.atob(u[3]),p=new r.ArrayBuffer(g.length),C=new r.Uint8Array(p);for(let y=0;y<C.length;++y)C[y]=g.charCodeAt(y);return a.createObjectURL(new r.Blob([C],{type:u[1]}))}}return{dataURLtoBlob:l,downloadURL:function(c,u){let g=r.navigator,p=n.createElement("a");if(typeof c!="string"&&!(c instanceof String)&&g.msSaveOrOpenBlob){g.msSaveOrOpenBlob(c,u);return}c=""+c;let C=/Edge\/\d+/.test(g.userAgent);if((s&&typeof c=="string"&&c.indexOf("data:application/pdf")===0||C||c.length>2e6)&&!(c=l(c)||""))throw Error("Failed to convert to blob");if(p.download!==void 0)p.href=c,p.download=u,n.body.appendChild(p),p.click(),n.body.removeChild(p);else try{if(!r.open(c,"chart"))throw Error("Failed to open window")}catch{r.location.href=c}}}}),t(e,"Extensions/OfflineExporting/OfflineExportingDefaults.js",[],function(){return{libURL:"https://code.highcharts.com/11.3.0/lib/",menuItemDefinitions:{downloadPNG:{textKey:"downloadPNG",onclick:function(){this.exportChartLocal()}},downloadJPEG:{textKey:"downloadJPEG",onclick:function(){this.exportChartLocal({type:"image/jpeg"})}},downloadSVG:{textKey:"downloadSVG",onclick:function(){this.exportChartLocal({type:"image/svg+xml"})}},downloadPDF:{textKey:"downloadPDF",onclick:function(){this.exportChartLocal({type:"application/pdf"})}}}}}),t(e,"Extensions/OfflineExporting/OfflineExporting.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Chart/Chart.js"],e["Core/Defaults.js"],e["Extensions/DownloadURL.js"],e["Extensions/Exporting/Exporting.js"],e["Core/Globals.js"],e["Core/HttpUtilities.js"],e["Extensions/OfflineExporting/OfflineExportingDefaults.js"],e["Core/Utilities.js"]],function(i,s,r,n,a,l,c,u,g){var p;let{defaultOptions:C}=r,{downloadURL:y}=n,{composed:S,doc:O,win:M}=l,{ajax:_}=c,{addEvent:N,error:E,extend:k,fireEvent:ie,merge:$,pushUnique:H}=g;return i.allowedAttributes.push("data-z-index","fill-opacity","filter","rx","ry","stroke-dasharray","stroke-linejoin","stroke-opacity","text-anchor","transform","version","viewBox","visibility","xmlns","xmlns:xlink"),i.allowedTags.push("desc","clippath","g"),function(Q){function Y(f,w){let b=this,h=$(b.options.exporting,f),m=function(x){h.fallbackToExportServer===!1?h.error?h.error(h,x):E(28,!0):b.exportChart(h)};if(l.isMS&&b.styledMode&&!a.inlineAllowlist.length&&a.inlineAllowlist.push(/^blockSize/,/^border/,/^caretColor/,/^color/,/^columnRule/,/^columnRuleColor/,/^cssFloat/,/^cursor/,/^fill$/,/^fillOpacity/,/^font/,/^inlineSize/,/^length/,/^lineHeight/,/^opacity/,/^outline/,/^parentRule/,/^rx$/,/^ry$/,/^stroke/,/^textAlign/,/^textAnchor/,/^textDecoration/,/^transform/,/^vectorEffect/,/^visibility/,/^x$/,/^y$/),l.isMS&&(h.type==="application/pdf"||b.container.getElementsByTagName("image").length&&h.type!=="image/svg+xml")||h.type==="application/pdf"&&[].some.call(b.container.getElementsByTagName("image"),function(x){let I=x.getAttribute("href");return I!==""&&typeof I=="string"&&I.indexOf("data:")!==0})){m(Error("Image type not supported for this chart/browser."));return}b.getSVGForLocalExport(h,w||{},m,function(x){x.indexOf("<foreignObject")>-1&&h.type!=="image/svg+xml"&&(l.isMS||h.type==="application/pdf")?m(Error("Image type not supported for charts with embedded HTML")):Q.downloadSVGLocal(x,k({filename:b.getFilename()},h),m,()=>ie(b,"exportChartLocalSuccess"))})}function P(f,w){let b=O.getElementsByTagName("head")[0],h=O.createElement("script");h.type="text/javascript",h.src=f,h.onload=w,h.onerror=function(){E("Error loading script "+f)},b.appendChild(h)}function j(f,w,b,h){let m=this,x=D=>m.sanitizeSVG(D,K),I=()=>{X&&le===q&&h(x(U.innerHTML))},B=(D,F,oe)=>{++le,oe.imageElement.setAttributeNS("http://www.w3.org/1999/xlink","href",D),I()},V,U,K,L=null,X,q=0,le=0;m.unbindGetSVG=N(m,"getSVG",D=>{K=D.chartCopy.options,q=(X=(U=D.chartCopy.container.cloneNode(!0))&&U.getElementsByTagName("image")||[]).length}),m.getSVGForExport(f,w);try{if(!X||!X.length){h(x(U.innerHTML));return}for(let D=0;D<X.length;D++)(L=(V=X[D]).getAttributeNS("http://www.w3.org/1999/xlink","href"))?Q.imageToDataUrl(L,"image/png",{imageElement:V},f.scale,B,b,b,b):(le++,V.parentNode.removeChild(V),D--,I())}catch(D){b(D)}m.unbindGetSVG()}function A(f,w,b,h,m,x,I,B,V){let U=new M.Image,K,L=()=>{setTimeout(function(){let q,le=O.createElement("canvas"),D=le.getContext&&le.getContext("2d");try{if(D){le.height=U.height*h,le.width=U.width*h,D.drawImage(U,0,0,le.width,le.height);try{q=le.toDataURL(w),m(q,w,b,h)}catch{K(f,w,b,h)}}else I(f,w,b,h)}finally{V&&V(f,w,b,h)}},Q.loadEventDeferDelay)},X=()=>{B(f,w,b,h),V&&V(f,w,b,h)};K=()=>{U=new M.Image,K=x,U.crossOrigin="Anonymous",U.onload=L,U.onerror=X,U.src=f},U.onload=L,U.onerror=X,U.src=f}function v(f){let w=M.navigator.userAgent,b=w.indexOf("WebKit")>-1&&0>w.indexOf("Chrome");try{if(!b&&f.indexOf("<foreignObject")===-1)return Q.domurl.createObjectURL(new M.Blob([f],{type:"image/svg+xml;charset-utf-16"}))}catch{}return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(f)}function R(f,w,b,h){let m=(Number(f.getAttribute("width"))+2*w)*b,x=(Number(f.getAttribute("height"))+2*w)*b,I=new M.jspdf.jsPDF(x>m?"p":"l","pt",[m,x]);[].forEach.call(f.querySelectorAll('*[visibility="hidden"]'),function(V){V.parentNode.removeChild(V)});let B=f.querySelectorAll("linearGradient");for(let V=0;V<B.length;V++){let U=B[V],K=U.querySelectorAll("stop"),L=0;for(;L<K.length&&K[L].getAttribute("offset")==="0"&&K[L+1].getAttribute("offset")==="0";)K[L].remove(),L++}[].forEach.call(f.querySelectorAll("tspan"),V=>{V.textContent==="\u200B"&&(V.textContent=" ",V.setAttribute("dx",-5))}),I.svg(f,{x:0,y:0,width:m,height:x,removeInvalid:!0}).then(()=>h(I.output("datauristring")))}Q.CanVGRenderer={},Q.domurl=M.URL||M.webkitURL||M,Q.loadEventDeferDelay=l.isMS?150:0,Q.compose=function f(w){if(H(S,f)){let b=w.prototype;b.getSVGForLocalExport=j,b.exportChartLocal=Y,$(!0,C.exporting,u)}return w},Q.downloadSVGLocal=function(f,w,b,h){let m=O.createElement("div"),x=w.type||"image/png",I=(w.filename||"chart")+"."+(x==="image/svg+xml"?"svg":x.split("/")[1]),B=w.scale||1,V,U,K,L=w.libURL||C.exporting.libURL,X=!0,q=w.pdfFont;L=L.slice(-1)!=="/"?L+"/":L;let le=(F,oe)=>{var ne;let ae,fe=(se,ee)=>{M.jspdf.jsPDF.API.events.push(["initialized",function(){this.addFileToVFS(se,ee),this.addFont(se,"HighchartsFont",se),this.getFontList().HighchartsFont||this.setFont("HighchartsFont")}])};q&&(ne=F.textContent||"",!/[^\u0000-\u007F\u200B]+/.test(ne))&&(q=void 0);let me=["normal","italic","bold","bolditalic"],G=()=>{let se=me.shift();if(!se)return oe();let ee=q&&q[se];ee?_({url:ee,responseType:"blob",success:(ue,de)=>{let W=new FileReader;W.onloadend=function(){if(typeof this.result=="string"){let z=this.result.split(",")[1];fe(se,z),se==="normal"&&(ae=z)}G()},W.readAsDataURL(de.response)},error:G}):(ae&&fe(se,ae),G())};G()},D=()=>{let F,oe;i.setElementHTML(m,f);let ne=m.getElementsByTagName("text"),ae=function(me,G){let se=me;for(;se&&se!==m;){if(se.style[G]){let ee=se.style[G];G==="fontSize"&&/em$/.test(ee)&&(ee=Math.round(16*parseFloat(ee))+"px"),me.style[G]=ee;break}se=se.parentNode}};[].forEach.call(ne,function(me){for(["fontFamily","fontSize"].forEach(G=>{ae(me,G)}),me.style.fontFamily=q&&q.normal?"HighchartsFont":String(me.style.fontFamily&&me.style.fontFamily.split(" ").splice(-1)),F=me.getElementsByTagName("title"),[].forEach.call(F,function(G){me.removeChild(G)}),oe=me.getElementsByClassName("highcharts-text-outline");oe.length>0;)me.removeChild(oe[0])});let fe=m.querySelector("svg");fe&&le(fe,()=>{R(fe,0,B,me=>{try{y(me,I),h&&h()}catch(G){b(G)}})})};if(x==="image/svg+xml")try{M.MSBlobBuilder!==void 0?((U=new M.MSBlobBuilder).append(f),V=U.getBlob("image/svg+xml")):V=v(f),y(V,I),h&&h()}catch(F){b(F)}else x==="application/pdf"?M.jspdf&&M.jspdf.jsPDF?D():(X=!0,P(L+"jspdf.js",function(){P(L+"svg2pdf.js",D)})):(V=v(f),K=function(){try{Q.domurl.revokeObjectURL(V)}catch{}},A(V,x,{},B,function(F){try{y(F,I),h&&h()}catch(oe){b(oe)}},function(){let F=O.createElement("canvas"),oe=F.getContext("2d"),ne=f.match(/^<svg[^>]*width\s*=\s*\"?(\d+)\"?[^>]*>/)[1]*B,ae=f.match(/^<svg[^>]*height\s*=\s*\"?(\d+)\"?[^>]*>/)[1]*B,fe=function(){M.canvg.Canvg.fromString(oe,f).start();try{y(M.navigator.msSaveOrOpenBlob?F.msToBlob():F.toDataURL(x),I),h&&h()}catch(G){b(G)}finally{K()}};F.width=ne,F.height=ae,M.canvg?fe():(X=!0,P(L+"canvg.js",function(){fe()}))},b,b,function(){X&&K()}))},Q.getScript=P,Q.imageToDataUrl=A,Q.svgToDataUrl=v,Q.svgToPdf=R}(p||(p={})),p}),t(e,"masters/modules/offline-exporting.src.js",[e["Core/Globals.js"],e["Extensions/DownloadURL.js"],e["Extensions/OfflineExporting/OfflineExporting.js"]],function(i,s,r){i.dataURLtoBlob=s.dataURLtoBlob,i.downloadSVGLocal=r.downloadSVGLocal,i.downloadURL=s.downloadURL,r.compose(i.Chart)})})});var Z_=Ie((Axe,og)=>{"use strict";(function(o){typeof og=="object"&&og.exports?(o.default=o,og.exports=o):typeof define=="function"&&define.amd?define("highcharts/modules/annotations",["highcharts"],function(e){return o(e),o.Highcharts=e,o}):o(typeof Highcharts<"u"?Highcharts:void 0)})(function(o){"use strict";var e=o?o._modules:{};function t(i,s,r,n){i.hasOwnProperty(s)||(i[s]=n.apply(null,r),typeof CustomEvent=="function"&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:s,module:i[s]}})))}t(e,"Extensions/Annotations/AnnotationChart.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s){var r;let{composed:n}=i,{addEvent:a,erase:l,find:c,fireEvent:u,pick:g,pushUnique:p,wrap:C}=s;function y(E,k){let ie=this.initAnnotation(E);return this.options.annotations.push(ie.options),g(k,!0)&&(ie.redraw(),ie.graphic.attr({opacity:1})),ie}function S(){let E=this;E.plotBoxClip=this.renderer.clipRect(this.plotBox),E.controlPointsGroup=E.renderer.g("control-points").attr({zIndex:99}).clip(E.plotBoxClip).add(),E.options.annotations.forEach((k,ie)=>{if(!E.annotations.some($=>$.options===k)){let $=E.initAnnotation(k);E.options.annotations[ie]=$.options}}),E.drawAnnotations(),a(E,"redraw",E.drawAnnotations),a(E,"destroy",function(){E.plotBoxClip.destroy(),E.controlPointsGroup.destroy()}),a(E,"exportData",function(k){let ie=E.annotations,$=(this.options.exporting&&this.options.exporting.csv||{}).columnHeaderFormatter,H=!k.dataRows[1].xValues,Q=E.options.lang&&E.options.lang.exportData&&E.options.lang.exportData.annotationHeader,Y=k.dataRows[0].length,P=E.options.exporting&&E.options.exporting.csv&&E.options.exporting.csv.annotations&&E.options.exporting.csv.annotations.itemDelimiter,j=E.options.exporting&&E.options.exporting.csv&&E.options.exporting.csv.annotations&&E.options.exporting.csv.annotations.join;ie.forEach(R=>{R.options.labelOptions&&R.options.labelOptions.includeInDataExport&&R.labels.forEach(f=>{if(f.options.text){let w=f.options.text;f.points.forEach(b=>{let h=b.x,m=b.series.xAxis?b.series.xAxis.index:-1,x=!1;if(m===-1){let I=k.dataRows[0].length,B=Array(I);for(let V=0;V<I;++V)B[V]="";B.push(w),B.xValues=[],B.xValues[m]=h,k.dataRows.push(B),x=!0}if(x||k.dataRows.forEach(I=>{!x&&I.xValues&&m!==void 0&&h===I.xValues[m]&&(j&&I.length>Y?I[I.length-1]+=P+w:I.push(w),x=!0)}),!x){let I=k.dataRows[0].length,B=Array(I);for(let V=0;V<I;++V)B[V]="";B[0]=h,B.push(w),B.xValues=[],m!==void 0&&(B.xValues[m]=h),k.dataRows.push(B)}})}})});let A=0;k.dataRows.forEach(R=>{A=Math.max(A,R.length)});let v=A-k.dataRows[0].length;for(let R=0;R<v;R++){let f=function(w){let b;return $&&(b=$(w))!==!1?b:(b=Q+" "+w,H?{columnTitle:b,topLevelColumnTitle:b}:b)}(R+1);H?(k.dataRows[0].push(f.topLevelColumnTitle),k.dataRows[1].push(f.columnTitle)):k.dataRows[0].push(f)}})}function O(){this.plotBoxClip.attr(this.plotBox),this.annotations.forEach(E=>{E.redraw(),E.graphic.animate({opacity:1},E.animationConfig)})}function M(E){let k=this.annotations,ie=E.coll==="annotations"?E:c(k,function($){return $.options.id===E});ie&&(u(ie,"remove"),l(this.options.annotations,ie.options),l(k,ie),ie.destroy())}function _(){this.annotations=[],this.options.annotations||(this.options.annotations=[])}function N(E){this.chart.hasDraggedAnnotation||E.apply(this,Array.prototype.slice.call(arguments,1))}return(r||(r={})).compose=function E(k,ie,$){if(p(n,E)){let H=ie.prototype,Q=$.prototype;a(ie,"afterInit",_),H.addAnnotation=y,H.callbacks.push(S),H.collectionsWithInit.annotations=[y],H.collectionsWithUpdate.push("annotations"),H.drawAnnotations=O,H.removeAnnotation=M,H.initAnnotation=function(Y){let P=k.types[Y.type]||k,j=new P(this,Y);return this.annotations.push(j),j},C(Q,"onContainerMouseDown",N)}},r}),t(e,"Extensions/Annotations/AnnotationDefaults.js",[e["Core/Utilities.js"]],function(i){let{defined:s}=i;return{visible:!0,animation:{},crop:!0,draggable:"xy",labelOptions:{align:"center",allowOverlap:!1,backgroundColor:"rgba(0, 0, 0, 0.75)",borderColor:"#000000",borderRadius:3,borderWidth:1,className:"highcharts-no-tooltip",crop:!1,formatter:function(){return s(this.y)?""+this.y:"Annotation label"},includeInDataExport:!0,overflow:"justify",padding:5,shadow:!1,shape:"callout",style:{fontSize:"0.7em",fontWeight:"normal",color:"contrast"},useHTML:!1,verticalAlign:"bottom",x:0,y:-16},shapeOptions:{stroke:"rgba(0, 0, 0, 0.75)",strokeWidth:1,fill:"rgba(0, 0, 0, 0.75)",r:0,snap:2},controlPointOptions:{events:{},style:{cursor:"pointer",fill:"#ffffff",stroke:"#000000","stroke-width":2},height:10,symbol:"circle",visible:!1,width:10},events:{},zIndex:6}}),t(e,"Extensions/Annotations/EventEmitter.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s){let{doc:r,isTouchDevice:n}=i,{addEvent:a,fireEvent:l,objectEach:c,pick:u,removeEvent:g}=s;return class{addEvents(){let p=this,C=function(y){a(y,n?"touchstart":"mousedown",S=>{p.onMouseDown(S)},{passive:!1})};if(C(this.graphic.element),(p.labels||[]).forEach(y=>{y.options.useHTML&&y.graphic.text&&C(y.graphic.text.element)}),c(p.options.events,(y,S)=>{let O=function(M){S==="click"&&p.cancelClick||y.call(p,p.chart.pointer.normalize(M),p.target)};(p.nonDOMEvents||[]).indexOf(S)===-1?(a(p.graphic.element,S,O,{passive:!1}),p.graphic.div&&a(p.graphic.div,S,O,{passive:!1})):a(p,S,O,{passive:!1})}),p.options.draggable&&(a(p,"drag",p.onDrag),!p.graphic.renderer.styledMode)){let y={cursor:{x:"ew-resize",y:"ns-resize",xy:"move"}[p.options.draggable]};p.graphic.css(y),(p.labels||[]).forEach(S=>{S.options.useHTML&&S.graphic.text&&S.graphic.text.css(y)})}p.isUpdating||l(p,"add")}destroy(){this.removeDocEvents(),g(this),this.hcEvents=null}mouseMoveToRadians(p,C,y){let S=p.prevChartY-y,O=p.prevChartX-C,M=p.chartY-y,_=p.chartX-C,N;return this.chart.inverted&&(N=O,O=S,S=N,N=_,_=M,M=N),Math.atan2(M,_)-Math.atan2(S,O)}mouseMoveToScale(p,C,y){let S=p.prevChartX-C,O=p.prevChartY-y,M=p.chartX-C,_=p.chartY-y,N=(M||1)/(S||1),E=(_||1)/(O||1);if(this.chart.inverted){let k=E;E=N,N=k}return{x:N,y:E}}mouseMoveToTranslation(p){let C=p.chartX-p.prevChartX,y=p.chartY-p.prevChartY,S;return this.chart.inverted&&(S=y,y=C,C=S),{x:C,y}}onDrag(p){if(this.chart.isInsidePlot(p.chartX-this.chart.plotLeft,p.chartY-this.chart.plotTop,{visiblePlotOnly:!0})){let C=this.mouseMoveToTranslation(p);this.options.draggable==="x"&&(C.y=0),this.options.draggable==="y"&&(C.x=0),this.points.length?this.translate(C.x,C.y):(this.shapes.forEach(y=>y.translate(C.x,C.y)),this.labels.forEach(y=>y.translate(C.x,C.y))),this.redraw(!1)}}onMouseDown(p){if(p.preventDefault&&p.preventDefault(),p.button===2)return;let C=this,y=C.chart.pointer,S=p?.sourceCapabilities?.firesTouchEvents||!1,O=(p=y.normalize(p)).chartX,M=p.chartY;C.cancelClick=!1,C.chart.hasDraggedAnnotation=!0,C.removeDrag=a(r,n||S?"touchmove":"mousemove",function(_){C.hasDragged=!0,(_=y.normalize(_)).prevChartX=O,_.prevChartY=M,l(C,"drag",_),O=_.chartX,M=_.chartY},n||S?{passive:!1}:void 0),C.removeMouseUp=a(r,n||S?"touchend":"mouseup",function(_){let N=u(C.target&&C.target.annotation,C.target);N&&(N.cancelClick=C.hasDragged),C.cancelClick=C.hasDragged,C.hasDragged=!1,C.chart.hasDraggedAnnotation=!1,l(u(N,C),"afterUpdate"),C.onMouseUp(_)},n||S?{passive:!1}:void 0)}onMouseUp(p){let C=this.chart,y=this.target||this,S=C.options.annotations,O=C.annotations.indexOf(y);this.removeDocEvents(),S[O]=y.options}removeDocEvents(){this.removeDrag&&(this.removeDrag=this.removeDrag()),this.removeMouseUp&&(this.removeMouseUp=this.removeMouseUp())}}}),t(e,"Extensions/Annotations/ControlPoint.js",[e["Extensions/Annotations/EventEmitter.js"],e["Core/Utilities.js"]],function(i,s){let{merge:r,pick:n}=s;return class extends i{constructor(a,l,c,u){super(),this.nonDOMEvents=["drag"],this.chart=a,this.target=l,this.options=c,this.index=n(c.index,u)}destroy(){super.destroy(),this.graphic&&(this.graphic=this.graphic.destroy()),this.chart=null,this.target=null,this.options=null}redraw(a){this.graphic[a?"animate":"attr"](this.options.positioner.call(this,this.target))}render(){let a=this.chart,l=this.options;this.graphic=a.renderer.symbol(l.symbol,0,0,l.width,l.height).add(a.controlPointsGroup).css(l.style),this.setVisibility(l.visible),this.addEvents()}setVisibility(a){this.graphic[a?"show":"hide"](),this.options.visible=a}update(a){let l=this.chart,c=this.target,u=this.index,g=r(!0,this.options,a);this.destroy(),this.constructor(l,c,g,u),this.render(l.controlPointsGroup),this.redraw()}}}),t(e,"Extensions/Annotations/MockPoint.js",[e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(i,s){let{series:{prototype:r}}=i,{defined:n,fireEvent:a}=s;class l{static fromPoint(u){return new l(u.series.chart,null,{x:u.x,y:u.y,xAxis:u.series.xAxis,yAxis:u.series.yAxis})}static pointToPixels(u,g){let p=u.series,C=p.chart,y=u.plotX||0,S=u.plotY||0,O;return C.inverted&&(u.mock?(y=u.plotY,S=u.plotX):(y=C.plotWidth-(u.plotY||0),S=C.plotHeight-(u.plotX||0))),p&&!g&&(y+=(O=p.getPlotBox()).translateX,S+=O.translateY),{x:y,y:S}}static pointToOptions(u){return{x:u.x,y:u.y,xAxis:u.series.xAxis,yAxis:u.series.yAxis}}constructor(u,g,p){this.mock=!0,this.series={visible:!0,chart:u,getPlotBox:r.getPlotBox},this.target=g||null,this.options=p,this.applyOptions(this.getOptions())}applyOptions(u){this.command=u.command,this.setAxis(u,"x"),this.setAxis(u,"y"),this.refresh()}getLabelConfig(){return{x:this.x,y:this.y,point:this}}getOptions(){return this.hasDynamicOptions()?this.options(this.target):this.options}hasDynamicOptions(){return typeof this.options=="function"}isInsidePlot(){let u=this.plotX,g=this.plotY,p=this.series.xAxis,C=this.series.yAxis,y={x:u,y:g,isInsidePlot:!0,options:{}};return p&&(y.isInsidePlot=n(u)&&u>=0&&u<=p.len),C&&(y.isInsidePlot=y.isInsidePlot&&n(g)&&g>=0&&g<=C.len),a(this.series.chart,"afterIsInsidePlot",y),y.isInsidePlot}refresh(){let u=this.series,g=u.xAxis,p=u.yAxis,C=this.getOptions();g?(this.x=C.x,this.plotX=g.toPixels(C.x,!0)):(this.x=void 0,this.plotX=C.x),p?(this.y=C.y,this.plotY=p.toPixels(C.y,!0)):(this.y=null,this.plotY=C.y),this.isInside=this.isInsidePlot()}refreshOptions(){let u=this.series,g=u.xAxis,p=u.yAxis;this.x=this.options.x=g?this.options.x=g.toValue(this.plotX,!0):this.plotX,this.y=this.options.y=p?p.toValue(this.plotY,!0):this.plotY}rotate(u,g,p){if(!this.hasDynamicOptions()){let C=Math.cos(p),y=Math.sin(p),S=this.plotX-u,O=this.plotY-g;this.plotX=S*C-O*y+u,this.plotY=S*y+O*C+g,this.refreshOptions()}}scale(u,g,p,C){if(!this.hasDynamicOptions()){let y=this.plotX*p,S=this.plotY*C;this.plotX=(1-p)*u+y,this.plotY=(1-C)*g+S,this.refreshOptions()}}setAxis(u,g){let p=g+"Axis",C=u[p],y=this.series.chart;this.series[p]=typeof C=="object"?C:n(C)?y[p][C]||y.get(C):null}toAnchor(){let u=[this.plotX,this.plotY,0,0];return this.series.chart.inverted&&(u[0]=this.plotY,u[1]=this.plotX),u}translate(u,g,p,C){this.hasDynamicOptions()||(this.plotX+=p,this.plotY+=C,this.refreshOptions())}}return l}),t(e,"Extensions/Annotations/ControlTarget.js",[e["Extensions/Annotations/ControlPoint.js"],e["Extensions/Annotations/MockPoint.js"],e["Core/Utilities.js"]],function(i,s,r){var n;return function(a){function l(){let E=this.controlPoints,k=this.options.controlPoints||[];k.forEach((ie,$)=>{let H=r.merge(this.options.controlPointOptions,ie);H.index||(H.index=$),k[$]=H,E.push(new i(this.chart,this,H))})}function c(E){let k=E.series.getPlotBox(),ie=E.series.chart,$=E.mock?E.toAnchor():ie.tooltip&&ie.tooltip.getAnchor.call({chart:E.series.chart},E)||[0,0,0,0],H={x:$[0]+(this.options.x||0),y:$[1]+(this.options.y||0),height:$[2]||0,width:$[3]||0};return{relativePosition:H,absolutePosition:r.merge(H,{x:H.x+(E.mock?k.translateX:ie.plotLeft),y:H.y+(E.mock?k.translateY:ie.plotTop)})}}function u(){this.controlPoints.forEach(E=>E.destroy()),this.chart=null,this.controlPoints=null,this.points=null,this.options=null,this.annotation&&(this.annotation=null)}function g(){let E=this.options;return E.points||E.point&&r.splat(E.point)}function p(){let E,k,ie=this.getPointsOptions(),$=this.points,H=ie&&ie.length||0;for(E=0;E<H;E++){if(!(k=this.point(ie[E],$[E]))){$.length=0;return}k.mock&&k.refresh(),$[E]=k}return $}function C(E,k){if(E&&E.series)return E;if(!k||k.series===null){if(r.isObject(E))k=new s(this.chart,this,E);else if(r.isString(E))k=this.chart.get(E)||null;else if(typeof E=="function"){let ie=E.call(k,this);k=ie.series?ie:new s(this.chart,this,E)}}return k}function y(E){this.controlPoints.forEach(k=>k.redraw(E))}function S(){this.controlPoints.forEach(E=>E.render())}function O(E,k,ie,$,H){if(this.chart.inverted){let Q=k;k=ie,ie=Q}this.points.forEach((Q,Y)=>this.transformPoint(E,k,ie,$,H,Y),this)}function M(E,k,ie,$,H,Q){let Y=this.points[Q];Y.mock||(Y=this.points[Q]=s.fromPoint(Y)),Y[E](k,ie,$,H)}function _(E,k){this.transform("translate",null,null,E,k)}function N(E,k,ie){this.transformPoint("translate",null,null,E,k,ie)}a.compose=function(E){let k=E.prototype;k.addControlPoints||r.merge(!0,k,{addControlPoints:l,anchor:c,destroyControlTarget:u,getPointsOptions:g,linkPoints:p,point:C,redrawControlPoints:y,renderControlPoints:S,transform:O,transformPoint:M,translate:_,translatePoint:N})}}(n||(n={})),n}),t(e,"Extensions/Annotations/Controllables/Controllable.js",[e["Extensions/Annotations/ControlTarget.js"],e["Core/Utilities.js"]],function(i,s){let{merge:r}=s;class n{constructor(l,c,u,g){this.annotation=l,this.chart=l.chart,this.collection=g==="label"?"labels":"shapes",this.controlPoints=[],this.options=c,this.points=[],this.index=u,this.itemType=g,this.init(l,c,u)}attr(...l){this.graphic.attr.apply(this.graphic,arguments)}attrsFromOptions(l){let c,u,g=this.constructor.attrsMap,p={},C=this.chart.styledMode;for(c in l)u=g[c],g[c]===void 0||C&&["fill","stroke","stroke-width"].indexOf(u)!==-1||(p[u]=l[c]);return p}destroy(){this.graphic&&(this.graphic=this.graphic.destroy()),this.tracker&&(this.tracker=this.tracker.destroy()),this.destroyControlTarget()}init(l,c,u){this.annotation=l,this.chart=l.chart,this.options=c,this.points=[],this.controlPoints=[],this.index=u,this.linkPoints(),this.addControlPoints()}redraw(l){this.redrawControlPoints(l)}render(l){this.renderControlPoints()}rotate(l,c,u){this.transform("rotate",l,c,u)}scale(l,c,u,g){this.transform("scale",l,c,u,g)}setControlPointsVisibility(l){this.controlPoints.forEach(c=>{c.setVisibility(l)})}shouldBeDrawn(){return!!this.points.length}translateShape(l,c,u){let g=this.annotation.chart,p=this.annotation.userOptions,C=g.annotations.indexOf(this.annotation),y=g.options.annotations[C];this.translatePoint(l,c,0),u&&this.translatePoint(l,c,1),y[this.collection][this.index].point=this.options.point,p[this.collection][this.index].point=this.options.point}update(l){let c=this.annotation,u=r(!0,this.options,l),g=this.graphic.parentGroup,p=this.constructor;this.destroy();let C=new p(c,u,this.index,this.itemType);r(!0,this,C),this.render(g),this.redraw()}}return i.compose(n),n}),t(e,"Extensions/Annotations/Controllables/ControllableDefaults.js",[],function(){return{defaultMarkers:{arrow:{tagName:"marker",attributes:{id:"arrow",refY:5,refX:9,markerWidth:10,markerHeight:10},children:[{tagName:"path",attributes:{d:"M 0 0 L 10 5 L 0 10 Z","stroke-width":0}}]},"reverse-arrow":{tagName:"marker",attributes:{id:"reverse-arrow",refY:5,refX:1,markerWidth:10,markerHeight:10},children:[{tagName:"path",attributes:{d:"M 0 5 L 10 0 L 10 10 Z","stroke-width":0}}]}}}}),t(e,"Extensions/Annotations/Controllables/ControllablePath.js",[e["Extensions/Annotations/Controllables/Controllable.js"],e["Extensions/Annotations/Controllables/ControllableDefaults.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s,r,n){let{defaultMarkers:a}=s,{composed:l}=r,{addEvent:c,defined:u,extend:g,merge:p,pushUnique:C,uniqueKey:y}=n,S=_("marker-end"),O=_("marker-start"),M="rgba(192,192,192,"+(r.svg?1e-4:.002)+")";function _(ie){return function($){this.attr(ie,"url(#"+$+")")}}function N(){this.options.defs=p(a,this.options.defs||{})}function E(ie,$){let H={attributes:{id:ie}},Q={stroke:$.color||"none",fill:$.color||"rgba(0, 0, 0, 0.75)"};H.children=$.children&&$.children.map(function(j){return p(Q,j)});let Y=p(!0,{attributes:{markerWidth:20,markerHeight:20,refX:0,refY:0,orient:"auto"}},$,H),P=this.definition(Y);return P.id=ie,P}class k extends i{static compose($,H){if(C(l,this.compose)){let Q=H.prototype;c($,"afterGetContainer",N),Q.addMarker=E}}constructor($,H,Q){super($,H,Q,"shape"),this.type="path"}toD(){let $=this.options.d;if($)return typeof $=="function"?$.call(this):$;let H=this.points,Q=H.length,Y=[],P=Q,j=H[0],A=P&&this.anchor(j).absolutePosition,v=0,R;if(A)for(Y.push(["M",A.x,A.y]);++v<Q&&P;)R=(j=H[v]).command||"L",A=this.anchor(j).absolutePosition,R==="M"?Y.push([R,A.x,A.y]):R==="L"?Y.push([R,A.x,A.y]):R==="Z"&&Y.push([R]),P=j.series.visible;return P&&this.graphic?this.chart.renderer.crispLine(Y,this.graphic.strokeWidth()):null}shouldBeDrawn(){return super.shouldBeDrawn()||!!this.options.d}render($){let H=this.options,Q=this.attrsFromOptions(H);this.graphic=this.annotation.chart.renderer.path([["M",0,0]]).attr(Q).add($),H.className&&this.graphic.addClass(H.className),this.tracker=this.annotation.chart.renderer.path([["M",0,0]]).addClass("highcharts-tracker-line").attr({zIndex:2}).add($),this.annotation.chart.styledMode||this.tracker.attr({"stroke-linejoin":"round",stroke:M,fill:M,"stroke-width":this.graphic.strokeWidth()+2*H.snap}),super.render(),g(this.graphic,{markerStartSetter:O,markerEndSetter:S}),this.setMarkers(this)}redraw($){if(this.graphic){let H=this.toD(),Q=$?"animate":"attr";H?(this.graphic[Q]({d:H}),this.tracker[Q]({d:H})):(this.graphic.attr({d:"M 0 -9000000000"}),this.tracker.attr({d:"M 0 -9000000000"})),this.graphic.placed=this.tracker.placed=!!H}super.redraw($)}setMarkers($){let H=$.options,Q=$.chart,Y=Q.options.defs,P=H.fill,j=u(P)&&P!=="none"?P:H.stroke;["markerStart","markerEnd"].forEach(function(A){let v=H[A],R,f,w,b;if(v){for(w in Y)if((v===((R=Y[w]).attributes&&R.attributes.id)||v===R.id)&&R.tagName==="marker"){f=R;break}f&&(b=$[A]=Q.renderer.addMarker((H.id||y())+"-"+v,p(f,{color:j})),$.attr(A,b.getAttribute("id")))}})}}return k.attrsMap={dashStyle:"dashstyle",strokeWidth:"stroke-width",stroke:"stroke",fill:"fill",zIndex:"zIndex"},k}),t(e,"Extensions/Annotations/Controllables/ControllableRect.js",[e["Extensions/Annotations/Controllables/Controllable.js"],e["Extensions/Annotations/Controllables/ControllablePath.js"],e["Core/Utilities.js"]],function(i,s,r){let{merge:n}=r;class a extends i{constructor(c,u,g){super(c,u,g,"shape"),this.type="rect",this.translate=super.translateShape}render(c){let u=this.attrsFromOptions(this.options);this.graphic=this.annotation.chart.renderer.rect(0,-9e9,0,0).attr(u).add(c),super.render()}redraw(c){if(this.graphic){let u=this.anchor(this.points[0]).absolutePosition;u?this.graphic[c?"animate":"attr"]({x:u.x,y:u.y,width:this.options.width,height:this.options.height}):this.attr({x:0,y:-9e9}),this.graphic.placed=!!u}super.redraw(c)}}return a.attrsMap=n(s.attrsMap,{width:"width",height:"height"}),a}),t(e,"Extensions/Annotations/Controllables/ControllableCircle.js",[e["Extensions/Annotations/Controllables/Controllable.js"],e["Extensions/Annotations/Controllables/ControllablePath.js"],e["Core/Utilities.js"]],function(i,s,r){let{merge:n}=r;class a extends i{constructor(c,u,g){super(c,u,g,"shape"),this.type="circle",this.translate=super.translateShape}redraw(c){if(this.graphic){let u=this.anchor(this.points[0]).absolutePosition;u?this.graphic[c?"animate":"attr"]({x:u.x,y:u.y,r:this.options.r}):this.graphic.attr({x:0,y:-9e9}),this.graphic.placed=!!u}super.redraw.call(this,c)}render(c){let u=this.attrsFromOptions(this.options);this.graphic=this.annotation.chart.renderer.circle(0,-9e9,0).attr(u).add(c),super.render()}setRadius(c){this.options.r=c}}return a.attrsMap=n(s.attrsMap,{r:"r"}),a}),t(e,"Extensions/Annotations/Controllables/ControllableEllipse.js",[e["Extensions/Annotations/Controllables/Controllable.js"],e["Extensions/Annotations/Controllables/ControllablePath.js"],e["Core/Utilities.js"]],function(i,s,r){let{merge:n,defined:a}=r;class l extends i{constructor(u,g,p){super(u,g,p,"shape"),this.type="ellipse"}init(u,g,p){a(g.yAxis)&&g.points.forEach(C=>{C.yAxis=g.yAxis}),a(g.xAxis)&&g.points.forEach(C=>{C.xAxis=g.xAxis}),super.init(u,g,p)}render(u){this.graphic=this.annotation.chart.renderer.createElement("ellipse").attr(this.attrsFromOptions(this.options)).add(u),super.render()}translate(u,g){super.translateShape(u,g,!0)}getDistanceFromLine(u,g,p,C){return Math.abs((g.y-u.y)*p-(g.x-u.x)*C+g.x*u.y-g.y*u.x)/Math.sqrt((g.y-u.y)*(g.y-u.y)+(g.x-u.x)*(g.x-u.x))}getAttrs(u,g){let p=u.x,C=u.y,y=g.x,S=g.y,O=(p+y)/2,M=180*Math.atan((S-C)/(y-p))/Math.PI;O<p&&(M+=180);let _=this.getRY();return{cx:O,cy:(C+S)/2,rx:Math.sqrt((p-y)*(p-y)/4+(C-S)*(C-S)/4),ry:_,angle:M}}getRY(){let u=this.getYAxis();return a(u)?Math.abs(u.toPixels(this.options.ry)-u.toPixels(0)):this.options.ry}getYAxis(){let u=this.options.yAxis;return this.chart.yAxis[u]}getAbsolutePosition(u){return this.anchor(u).absolutePosition}redraw(u){if(this.graphic){let g=this.getAbsolutePosition(this.points[0]),p=this.getAbsolutePosition(this.points[1]),C=this.getAttrs(g,p);g?this.graphic[u?"animate":"attr"]({cx:C.cx,cy:C.cy,rx:C.rx,ry:C.ry,rotation:C.angle,rotationOriginX:C.cx,rotationOriginY:C.cy}):this.graphic.attr({x:0,y:-9e9}),this.graphic.placed=!!g}super.redraw(u)}setYRadius(u){let g=this.annotation.userOptions.shapes;this.options.ry=u,g&&g[0]&&(g[0].ry=u,g[0].ry=u)}}return l.attrsMap=n(s.attrsMap,{ry:"ry"}),l}),t(e,"Extensions/Annotations/Controllables/ControllableLabel.js",[e["Extensions/Annotations/Controllables/Controllable.js"],e["Core/Templating.js"],e["Core/Globals.js"],e["Extensions/Annotations/MockPoint.js"],e["Core/Utilities.js"]],function(i,s,r,n,a){let{format:l}=s,{composed:c}=r,{extend:u,isNumber:g,pick:p,pushUnique:C}=a;function y(O,M,_,N,E){let k=E&&E.anchorX,ie=E&&E.anchorY,$,H,Q=_/2;return g(k)&&g(ie)&&($=[["M",k,ie]],(H=M-ie)<0&&(H=-N-H),H<_&&(Q=k<O+_/2?H:_-H),ie>M+N?$.push(["L",O+Q,M+N]):ie<M?$.push(["L",O+Q,M]):k<O?$.push(["L",O,M+N/2]):k>O+_&&$.push(["L",O+_,M+N/2])),$||[]}class S extends i{static alignedPosition(M,_){let N=M.align,E=M.verticalAlign,k=(_.x||0)+(M.x||0),ie=(_.y||0)+(M.y||0),$,H;return N==="right"?$=1:N==="center"&&($=2),$&&(k+=(_.width-(M.width||0))/$),E==="bottom"?H=1:E==="middle"&&(H=2),H&&(ie+=(_.height-(M.height||0))/H),{x:Math.round(k),y:Math.round(ie)}}static compose(M){if(C(c,this.compose)){let _=M.prototype;_.symbols.connector=y}}static justifiedOptions(M,_,N,E){let k,ie=N.align,$=N.verticalAlign,H=_.box?0:_.padding||0,Q=_.getBBox(),Y={align:ie,verticalAlign:$,x:N.x,y:N.y,width:_.width,height:_.height},P=(E.x||0)-M.plotLeft,j=(E.y||0)-M.plotTop;return(k=P+H)<0&&(ie==="right"?Y.align="left":Y.x=(Y.x||0)-k),(k=P+Q.width-H)>M.plotWidth&&(ie==="left"?Y.align="right":Y.x=(Y.x||0)+M.plotWidth-k),(k=j+H)<0&&($==="bottom"?Y.verticalAlign="top":Y.y=(Y.y||0)-k),(k=j+Q.height-H)>M.plotHeight&&($==="top"?Y.verticalAlign="bottom":Y.y=(Y.y||0)+M.plotHeight-k),Y}constructor(M,_,N){super(M,_,N,"label")}translatePoint(M,_){super.translatePoint(M,_,0)}translate(M,_){let N=this.annotation.chart,E=this.annotation.userOptions,k=N.annotations.indexOf(this.annotation),ie=N.options.annotations,$=ie[k];if(N.inverted){let H=M;M=_,_=H}this.options.x+=M,this.options.y+=_,$[this.collection][this.index].x=this.options.x,$[this.collection][this.index].y=this.options.y,E[this.collection][this.index].x=this.options.x,E[this.collection][this.index].y=this.options.y}render(M){let _=this.options,N=this.attrsFromOptions(_),E=_.style;this.graphic=this.annotation.chart.renderer.label("",0,-9999,_.shape,null,null,_.useHTML,null,"annotation-label").attr(N).add(M),this.annotation.chart.styledMode||(E.color==="contrast"&&(E.color=this.annotation.chart.renderer.getContrast(S.shapesWithoutBackground.indexOf(_.shape)>-1?"#FFFFFF":_.backgroundColor)),this.graphic.css(_.style).shadow(_.shadow)),_.className&&this.graphic.addClass(_.className),this.graphic.labelrank=_.labelrank,super.render()}redraw(M){let _=this.options,N=this.text||_.format||_.text,E=this.graphic,k=this.points[0];if(!E){this.redraw(M);return}E.attr({text:N?l(String(N),k.getLabelConfig(),this.annotation.chart):_.formatter.call(k,this)});let ie=this.anchor(k),$=this.position(ie);$?(E.alignAttr=$,$.anchorX=ie.absolutePosition.x,$.anchorY=ie.absolutePosition.y,E[M?"animate":"attr"]($)):E.attr({x:0,y:-9999}),E.placed=!!$,super.redraw(M)}anchor(M){let _=super.anchor.apply(this,arguments),N=this.options.x||0,E=this.options.y||0;return _.absolutePosition.x-=N,_.absolutePosition.y-=E,_.relativePosition.x-=N,_.relativePosition.y-=E,_}position(M){let _=this.graphic,N=this.annotation.chart,E=N.tooltip,k=this.points[0],ie=this.options,$=M.absolutePosition,H=M.relativePosition,Q,Y,P,j,A=k.series.visible&&n.prototype.isInsidePlot.call(k);if(_&&A){let{width:v=0,height:R=0}=_;ie.distance&&E?Q=E.getPosition.call({chart:N,distance:p(ie.distance,16),getPlayingField:E.getPlayingField},v,R,{plotX:H.x,plotY:H.y,negative:k.negative,ttBelow:k.ttBelow,h:H.height||H.width}):ie.positioner?Q=ie.positioner.call(this):(Y={x:$.x,y:$.y,width:0,height:0},Q=S.alignedPosition(u(ie,{width:v,height:R}),Y),this.options.overflow==="justify"&&(Q=S.alignedPosition(S.justifiedOptions(N,_,ie,Q),Y))),ie.crop&&(P=Q.x-N.plotLeft,j=Q.y-N.plotTop,A=N.isInsidePlot(P,j)&&N.isInsidePlot(P+v,j+R))}return A?Q:null}}return S.attrsMap={backgroundColor:"fill",borderColor:"stroke",borderWidth:"stroke-width",zIndex:"zIndex",borderRadius:"r",padding:"padding"},S.shapesWithoutBackground=["connector"],S}),t(e,"Extensions/Annotations/Controllables/ControllableImage.js",[e["Extensions/Annotations/Controllables/Controllable.js"],e["Extensions/Annotations/Controllables/ControllableLabel.js"]],function(i,s){class r extends i{constructor(a,l,c){super(a,l,c,"shape"),this.type="image",this.translate=super.translateShape}render(a){let l=this.attrsFromOptions(this.options),c=this.options;this.graphic=this.annotation.chart.renderer.image(c.src,0,-9e9,c.width,c.height).attr(l).add(a),this.graphic.width=c.width,this.graphic.height=c.height,super.render()}redraw(a){if(this.graphic){let l=this.anchor(this.points[0]),c=s.prototype.position.call(this,l);c?this.graphic[a?"animate":"attr"]({x:c.x,y:c.y}):this.graphic.attr({x:0,y:-9e9}),this.graphic.placed=!!c}super.redraw(a)}}return r.attrsMap={width:"width",height:"height",zIndex:"zIndex"},r}),t(e,"Core/Chart/ChartNavigationComposition.js",[],function(){var i;return function(s){s.compose=function(n){return n.navigation||(n.navigation=new r(n)),n};class r{constructor(a){this.updates=[],this.chart=a}addUpdate(a){this.chart.navigation.updates.push(a)}update(a,l){this.updates.forEach(c=>{c.call(this.chart,a,l)})}}s.Additions=r}(i||(i={})),i}),t(e,"Extensions/Annotations/NavigationBindingsUtilities.js",[e["Core/Utilities.js"]],function(i){let{defined:s,isNumber:r,pick:n}=i,a={backgroundColor:"string",borderColor:"string",borderRadius:"string",color:"string",fill:"string",fontSize:"string",labels:"string",name:"string",stroke:"string",title:"string"};return{annotationsFieldsTypes:a,getAssignedAxis:function(l){return l.filter(c=>{let u=c.axis.getExtremes(),g=u.min,p=u.max,C=n(c.axis.minPointOffset,0);return r(g)&&r(p)&&c.value>=g-C&&c.value<=p+C&&!c.axis.options.isInternal})[0]},getFieldType:function(l,c){let u=a[l],g=typeof c;return s(u)&&(g=u),{string:"text",number:"number",boolean:"checkbox"}[g]}}}),t(e,"Extensions/Annotations/NavigationBindingsDefaults.js",[e["Extensions/Annotations/NavigationBindingsUtilities.js"],e["Core/Utilities.js"]],function(i,s){let{getAssignedAxis:r}=i,{isNumber:n,merge:a}=s;return{lang:{navigation:{popup:{simpleShapes:"Simple shapes",lines:"Lines",circle:"Circle",ellipse:"Ellipse",rectangle:"Rectangle",label:"Label",shapeOptions:"Shape options",typeOptions:"Details",fill:"Fill",format:"Text",strokeWidth:"Line width",stroke:"Line color",title:"Title",name:"Name",labelOptions:"Label options",labels:"Labels",backgroundColor:"Background color",backgroundColors:"Background colors",borderColor:"Border color",borderRadius:"Border radius",borderWidth:"Border width",style:"Style",padding:"Padding",fontSize:"Font size",color:"Color",height:"Height",shapes:"Shape options"}}},navigation:{bindingsClassName:"highcharts-bindings-container",bindings:{circleAnnotation:{className:"highcharts-circle-annotation",start:function(l){let c=this.chart.pointer.getCoordinates(l),u=r(c.xAxis),g=r(c.yAxis),p=this.chart.options.navigation;if(u&&g)return this.chart.addAnnotation(a({langKey:"circle",type:"basicAnnotation",shapes:[{type:"circle",point:{x:u.value,y:g.value,xAxis:u.axis.index,yAxis:g.axis.index},r:5}]},p.annotationsOptions,p.bindings.circleAnnotation.annotationsOptions))},steps:[function(l,c){let u,g=c.options.shapes,p=g&&g[0]&&g[0].point||{};if(n(p.xAxis)&&n(p.yAxis)){let C=this.chart.inverted,y=this.chart.xAxis[p.xAxis].toPixels(p.x),S=this.chart.yAxis[p.yAxis].toPixels(p.y);u=Math.max(Math.sqrt(Math.pow(C?S-l.chartX:y-l.chartX,2)+Math.pow(C?y-l.chartY:S-l.chartY,2)),5)}c.update({shapes:[{r:u}]})}]},ellipseAnnotation:{className:"highcharts-ellipse-annotation",start:function(l){let c=this.chart.pointer.getCoordinates(l),u=r(c.xAxis),g=r(c.yAxis),p=this.chart.options.navigation;if(u&&g)return this.chart.addAnnotation(a({langKey:"ellipse",type:"basicAnnotation",shapes:[{type:"ellipse",xAxis:u.axis.index,yAxis:g.axis.index,points:[{x:u.value,y:g.value},{x:u.value,y:g.value}],ry:1}]},p.annotationsOptions,p.bindings.ellipseAnnotation.annotationOptions))},steps:[function(l,c){let u=c.shapes[0],g=u.getAbsolutePosition(u.points[1]);u.translatePoint(l.chartX-g.x,l.chartY-g.y,1),u.redraw(!1)},function(l,c){let u=c.shapes[0],g=u.getAbsolutePosition(u.points[0]),p=u.getAbsolutePosition(u.points[1]),C=u.getDistanceFromLine(g,p,l.chartX,l.chartY),y=u.getYAxis(),S=Math.abs(y.toValue(0)-y.toValue(C));u.setYRadius(S),u.redraw(!1)}]},rectangleAnnotation:{className:"highcharts-rectangle-annotation",start:function(l){let c=this.chart.pointer.getCoordinates(l),u=r(c.xAxis),g=r(c.yAxis);if(!u||!g)return;let p=u.value,C=g.value,y=u.axis.index,S=g.axis.index,O=this.chart.options.navigation;return this.chart.addAnnotation(a({langKey:"rectangle",type:"basicAnnotation",shapes:[{type:"path",points:[{xAxis:y,yAxis:S,x:p,y:C},{xAxis:y,yAxis:S,x:p,y:C},{xAxis:y,yAxis:S,x:p,y:C},{xAxis:y,yAxis:S,x:p,y:C},{command:"Z"}]}]},O.annotationsOptions,O.bindings.rectangleAnnotation.annotationsOptions))},steps:[function(l,c){let u=c.options.shapes,g=u&&u[0]&&u[0].points||[],p=this.chart.pointer.getCoordinates(l),C=r(p.xAxis),y=r(p.yAxis);if(C&&y){let S=C.value,O=y.value;g[1].x=S,g[2].x=S,g[2].y=O,g[3].y=O,c.update({shapes:[{points:g}]})}}]},labelAnnotation:{className:"highcharts-label-annotation",start:function(l){let c=this.chart.pointer.getCoordinates(l),u=r(c.xAxis),g=r(c.yAxis),p=this.chart.options.navigation;if(u&&g)return this.chart.addAnnotation(a({langKey:"label",type:"basicAnnotation",labelOptions:{format:"{y:.2f}",overflow:"none",crop:!0},labels:[{point:{xAxis:u.axis.index,yAxis:g.axis.index,x:u.value,y:g.value}}]},p.annotationsOptions,p.bindings.labelAnnotation.annotationsOptions))}}},events:{},annotationsOptions:{animation:{defer:0}}}}}),t(e,"Extensions/Annotations/NavigationBindings.js",[e["Core/Chart/ChartNavigationComposition.js"],e["Core/Defaults.js"],e["Core/Templating.js"],e["Core/Globals.js"],e["Extensions/Annotations/NavigationBindingsDefaults.js"],e["Extensions/Annotations/NavigationBindingsUtilities.js"],e["Core/Utilities.js"]],function(i,s,r,n,a,l,c){let{setOptions:u}=s,{format:g}=r,{composed:p,doc:C,win:y}=n,{getFieldType:S}=l,{addEvent:O,attr:M,defined:_,fireEvent:N,isArray:E,isFunction:k,isNumber:ie,isObject:$,merge:H,objectEach:Q,pick:Y,pushUnique:P}=c;function j(){this.chart.navigationBindings&&this.chart.navigationBindings.deselectAnnotation()}function A(){this.navigationBindings&&this.navigationBindings.destroy()}function v(){let m=this.options;m&&m.navigation&&m.navigation.bindings&&(this.navigationBindings=new h(this,m.navigation),this.navigationBindings.initEvents(),this.navigationBindings.initUpdate())}function R(){let m=this.navigationBindings,x="highcharts-disabled-btn";if(this&&m){let I=!1;if(this.series.forEach(B=>{!B.options.isInternal&&B.visible&&(I=!0)}),this.navigationBindings&&this.navigationBindings.container&&this.navigationBindings.container[0]){let B=this.navigationBindings.container[0];Q(m.boundClassNames,(V,U)=>{let K=B.querySelectorAll("."+U);if(K)for(let L=0;L<K.length;L++){let X=K[L],q=X.className;V.noDataState==="normal"||I?q.indexOf(x)!==-1&&X.classList.remove(x):q.indexOf(x)===-1&&(X.className+=" "+x)}})}}}function f(){this.deselectAnnotation()}function w(){this.selectedButtonElement=null}function b(m){let x,I,B=m.prototype.defaultOptions.events&&m.prototype.defaultOptions.events.click;function V(U){let K=this,L=K.chart.navigationBindings,X=L.activeAnnotation;B&&B.call(K,U),X!==K?(L.deselectAnnotation(),L.activeAnnotation=K,K.setControlPointsVisibility(!0),N(L,"showPopup",{annotation:K,formType:"annotation-toolbar",options:L.annotationToFields(K),onSubmit:function(q){if(q.actionType==="remove")L.activeAnnotation=!1,L.chart.removeAnnotation(K);else{let le={};L.fieldsToOptions(q.fields,le),L.deselectAnnotation();let D=le.typeOptions;K.options.type==="measure"&&(D.crosshairY.enabled=D.crosshairY.strokeWidth!==0,D.crosshairX.enabled=D.crosshairX.strokeWidth!==0),K.update(le)}}})):N(L,"closePopup"),U.activeAnnotation=!0}H(!0,m.prototype.defaultOptions.events,{click:V,touchstart:function(U){x=U.touches[0].clientX,I=U.touches[0].clientY},touchend:function(U){!!x&&Math.sqrt(Math.pow(x-U.changedTouches[0].clientX,2)+Math.pow(I-U.changedTouches[0].clientY,2))>=4||V.call(this,U)}})}class h{static compose(x,I){P(p,this.compose)&&(O(x,"remove",j),b(x),Q(x.types,B=>{b(B)}),O(I,"destroy",A),O(I,"load",v),O(I,"render",R),O(h,"closePopup",f),O(h,"deselectButton",w),u(a))}constructor(x,I){this.boundClassNames=void 0,this.chart=x,this.options=I,this.eventsToUnbind=[],this.container=this.chart.container.getElementsByClassName(this.options.bindingsClassName||""),this.container.length||(this.container=C.getElementsByClassName(this.options.bindingsClassName||""))}initEvents(){let x=this,I=x.chart,B=x.container,V=x.options;x.boundClassNames={},Q(V.bindings||{},U=>{x.boundClassNames[U.className]=U}),[].forEach.call(B,U=>{x.eventsToUnbind.push(O(U,"click",K=>{let L=x.getButtonEvents(U,K);L&&!L.button.classList.contains("highcharts-disabled-btn")&&x.bindingsButtonClick(L.button,L.events,K)}))}),Q(V.events||{},(U,K)=>{k(U)&&x.eventsToUnbind.push(O(x,K,U,{passive:!1}))}),x.eventsToUnbind.push(O(I.container,"click",function(U){!I.cancelClick&&I.isInsidePlot(U.chartX-I.plotLeft,U.chartY-I.plotTop,{visiblePlotOnly:!0})&&x.bindingsChartClick(this,U)})),x.eventsToUnbind.push(O(I.container,n.isTouchDevice?"touchmove":"mousemove",function(U){x.bindingsContainerMouseMove(this,U)},n.isTouchDevice?{passive:!1}:void 0))}initUpdate(){let x=this;i.compose(this.chart).navigation.addUpdate(I=>{x.update(I)})}bindingsButtonClick(x,I,B){let V=this.chart,U=V.renderer.boxWrapper,K=!0;this.selectedButtonElement&&(this.selectedButtonElement.classList===x.classList&&(K=!1),N(this,"deselectButton",{button:this.selectedButtonElement}),this.nextEvent&&(this.currentUserDetails&&this.currentUserDetails.coll==="annotations"&&V.removeAnnotation(this.currentUserDetails),this.mouseMoveEvent=this.nextEvent=!1)),K?(this.selectedButton=I,this.selectedButtonElement=x,N(this,"selectButton",{button:x}),I.init&&I.init.call(this,x,B),(I.start||I.steps)&&V.renderer.boxWrapper.addClass("highcharts-draw-mode")):(V.stockTools&&V.stockTools.toggleButtonActiveClass(x),U.removeClass("highcharts-draw-mode"),this.nextEvent=!1,this.mouseMoveEvent=!1,this.selectedButton=null)}bindingsChartClick(x,I){x=this.chart;let B=this.activeAnnotation,V=this.selectedButton,U=x.renderer.boxWrapper;B&&(B.cancelClick||I.activeAnnotation||!I.target.parentNode||function(K,L){let X=y.Element.prototype,q=X.matches||X.msMatchesSelector||X.webkitMatchesSelector,le=null;if(X.closest)le=X.closest.call(K,L);else do{if(q.call(K,L))return K;K=K.parentElement||K.parentNode}while(K!==null&&K.nodeType===1);return le}(I.target,".highcharts-popup")?B.cancelClick&&setTimeout(()=>{B.cancelClick=!1},0):N(this,"closePopup")),V&&V.start&&(this.nextEvent?(this.nextEvent(I,this.currentUserDetails),this.steps&&(this.stepIndex++,V.steps[this.stepIndex]?this.mouseMoveEvent=this.nextEvent=V.steps[this.stepIndex]:(N(this,"deselectButton",{button:this.selectedButtonElement}),U.removeClass("highcharts-draw-mode"),V.end&&V.end.call(this,I,this.currentUserDetails),this.nextEvent=!1,this.mouseMoveEvent=!1,this.selectedButton=null))):(this.currentUserDetails=V.start.call(this,I),this.currentUserDetails&&V.steps?(this.stepIndex=0,this.steps=!0,this.mouseMoveEvent=this.nextEvent=V.steps[this.stepIndex]):(N(this,"deselectButton",{button:this.selectedButtonElement}),U.removeClass("highcharts-draw-mode"),this.steps=!1,this.selectedButton=null,V.end&&V.end.call(this,I,this.currentUserDetails))))}bindingsContainerMouseMove(x,I){this.mouseMoveEvent&&this.mouseMoveEvent(I,this.currentUserDetails)}fieldsToOptions(x,I){return Q(x,(B,V)=>{let U=parseFloat(B),K=V.split("."),L=K.length-1;if(!ie(U)||B.match(/px|em/g)||V.match(/format/g)||(B=U),B!=="undefined"){let X=I;K.forEach((q,le)=>{let D=Y(K[le+1],"");L===le?X[q]=B:(X[q]||(X[q]=D.match(/\d/g)?[]:{}),X=X[q])})}}),I}deselectAnnotation(){this.activeAnnotation&&(this.activeAnnotation.setControlPointsVisibility(!1),this.activeAnnotation=!1)}annotationToFields(x){let I=x.options,B=h.annotationsEditable,V=B.nestedOptions,U=Y(I.type,I.shapes&&I.shapes[0]&&I.shapes[0].type,I.labels&&I.labels[0]&&I.labels[0].type,"label"),K=h.annotationsNonEditable[I.langKey]||[],L={langKey:I.langKey,type:U};function X(q,le,D,F,oe){let ne;D&&_(q)&&K.indexOf(le)===-1&&((D.indexOf&&D.indexOf(le))>=0||D[le]||D===!0)&&(E(q)?(F[le]=[],q.forEach((ae,fe)=>{$(ae)?(F[le][fe]={},Q(ae,(me,G)=>{X(me,G,V[le],F[le][fe],le)})):X(ae,0,V[le],F[le],le)})):$(q)?(ne={},E(F)?(F.push(ne),ne[le]={},ne=ne[le]):F[le]=ne,Q(q,(ae,fe)=>{X(ae,fe,le===0?D:V[le],ne,le)})):le==="format"?F[le]=[g(q,x.labels[0].points[0]).toString(),"text"]:E(F)?F.push([q,S(oe,q)]):F[le]=[q,S(le,q)])}return Q(I,(q,le)=>{le==="typeOptions"?(L[le]={},Q(I[le],(D,F)=>{X(D,F,V,L[le],F)})):X(q,le,B[U],L,le)}),L}getClickedClassNames(x,I){let B=I.target,V=[],U;for(;B&&B.tagName&&((U=M(B,"class"))&&(V=V.concat(U.split(" ").map(K=>[K,B]))),(B=B.parentNode)!==x););return V}getButtonEvents(x,I){let B,V=this;return this.getClickedClassNames(x,I).forEach(K=>{V.boundClassNames[K[0]]&&!B&&(B={events:V.boundClassNames[K[0]],button:K[1]})}),B}update(x){this.options=H(!0,this.options,x),this.removeEvents(),this.initEvents()}removeEvents(){this.eventsToUnbind.forEach(x=>x())}destroy(){this.removeEvents()}}return h.annotationsEditable={nestedOptions:{labelOptions:["style","format","backgroundColor"],labels:["style"],label:["style"],style:["fontSize","color"],background:["fill","strokeWidth","stroke"],innerBackground:["fill","strokeWidth","stroke"],outerBackground:["fill","strokeWidth","stroke"],shapeOptions:["fill","strokeWidth","stroke"],shapes:["fill","strokeWidth","stroke"],line:["strokeWidth","stroke"],backgroundColors:[!0],connector:["fill","strokeWidth","stroke"],crosshairX:["strokeWidth","stroke"],crosshairY:["strokeWidth","stroke"]},circle:["shapes"],ellipse:["shapes"],verticalLine:[],label:["labelOptions"],measure:["background","crosshairY","crosshairX"],fibonacci:[],tunnel:["background","line","height"],pitchfork:["innerBackground","outerBackground"],rect:["shapes"],crookedLine:[],basicAnnotation:["shapes","labelOptions"]},h.annotationsNonEditable={rectangle:["crosshairX","crosshairY","labelOptions"],ellipse:["labelOptions"],circle:["labelOptions"]},h}),t(e,"Shared/BaseForm.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Utilities.js"]],function(i,s){let{addEvent:r,createElement:n}=s;return class{constructor(a,l){this.iconsURL=l,this.container=this.createPopupContainer(a),this.closeButton=this.addCloseButton()}createPopupContainer(a,l="highcharts-popup highcharts-no-tooltip"){return n("div",{className:l},void 0,a)}addCloseButton(a="highcharts-popup-close"){let l=this,c=this.iconsURL,u=n("div",{className:a},void 0,this.container);return u.style["background-image"]="url("+(c.match(/png|svg|jpeg|jpg|gif/ig)?c:c+"close.svg")+")",["click","touchstart"].forEach(g=>{r(u,g,l.closeButtonEvents.bind(l))}),r(document,"keydown",function(g){g.code==="Escape"&&l.closeButtonEvents()}),u}closeButtonEvents(){this.closePopup()}showPopup(a="highcharts-annotation-toolbar"){let l=this.container,c=this.closeButton;this.type=void 0,l.innerHTML=i.emptyHTML,l.className.indexOf(a)>=0&&(l.classList.remove(a),l.removeAttribute("style")),l.appendChild(c),l.style.display="block",l.style.height=""}closePopup(){this.container.style.display="none"}}}),t(e,"Extensions/Annotations/Popup/PopupAnnotations.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s){let{doc:r,isFirefox:n}=i,{createElement:a,isArray:l,isObject:c,objectEach:u,pick:g,stableSort:p}=s;function C(y,S,O,M,_,N){let E,k;if(!S)return;let ie=this.addInput,$=this.lang;u(M,(H,Q)=>{E=O!==""?O+"."+Q:Q,c(H)&&(!l(H)||l(H)&&c(H[0])?((k=$[Q]||Q).match(/\d/g)||_.push([!0,k,y]),C.call(this,y,S,E,H,_,!1)):_.push([this,E,"annotation",y,H]))}),N&&(p(_,H=>H[1].match(/format/g)?-1:1),n&&_.reverse(),_.forEach(H=>{H[0]===!0?a("span",{className:"highcharts-annotation-title"},void 0,H[2]).appendChild(r.createTextNode(H[1])):(H[4]={value:H[4][0],type:H[4][1]},ie.apply(H[0],H.splice(1)))}))}return{addForm:function(y,S,O,M){if(!y)return;let _=this.container,N=this.lang,E=a("h2",{className:"highcharts-popup-main-title"},void 0,_);E.appendChild(r.createTextNode(N[S.langKey]||S.langKey||"")),E=a("div",{className:"highcharts-popup-lhs-col highcharts-popup-lhs-full"},void 0,_);let k=a("div",{className:"highcharts-popup-bottom-row"},void 0,_);C.call(this,E,y,"",S,[],!0),this.addButton(k,M?N.addButton||"Add":N.saveButton||"Save",M?"add":"save",_,O)},addToolbar:function(y,S,O){let M=this.lang,_=this.container,N=this.showForm,E="highcharts-annotation-toolbar";_.className.indexOf(E)===-1&&(_.className+=" "+E+" highcharts-no-mousewheel"),y&&(_.style.top=y.plotTop+10+"px"),a("span",void 0,void 0,_).appendChild(r.createTextNode(g(M[S.langKey]||S.langKey,S.shapes&&S.shapes[0].type,"")));let k=this.addButton(_,M.removeButton||"Remove","remove",_,O);k.className+=" highcharts-annotation-remove-button",k.style["background-image"]="url("+this.iconsURL+"destroy.svg)",k=this.addButton(_,M.editButton||"Edit","edit",_,()=>{N.call(this,"annotation-edit",y,S,O)}),k.className+=" highcharts-annotation-edit-button",k.style["background-image"]="url("+this.iconsURL+"edit.svg)"}}}),t(e,"Extensions/Annotations/Popup/PopupIndicators.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Globals.js"],e["Extensions/Annotations/NavigationBindingsUtilities.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(i,s,r,n,a){var l,c;let{doc:u}=s,{annotationsFieldsTypes:g}=r,{seriesTypes:p}=n,{addEvent:C,createElement:y,defined:S,isArray:O,isObject:M,objectEach:_,stableSort:N}=a;(c=l||(l={}))[c["params.algorithm"]=0]="params.algorithm",c[c["params.average"]=1]="params.average";let E={"algorithm-pivotpoints":["standard","fibonacci","camarilla"],"average-disparityindex":["sma","ema","dema","tema","wma"]};function k(f){let w=y("div",{className:"highcharts-popup-lhs-col"},void 0,f),b=y("div",{className:"highcharts-popup-rhs-col"},void 0,f);return y("div",{className:"highcharts-popup-rhs-col-wrapper"},void 0,b),{lhsCol:w,rhsCol:b}}function ie(f,w,b,h){let m=w.params||w.options.params;h.innerHTML=i.emptyHTML,y("h3",{className:"highcharts-indicator-title"},void 0,h).appendChild(u.createTextNode(v(w,b).indicatorFullName)),y("input",{type:"hidden",name:"highcharts-type-"+b,value:b},void 0,h),R.call(this,b,"series",f,h,w,w.linkedParent&&w.linkedParent.options.id),m.volumeSeriesID&&R.call(this,b,"volume",f,h,w,w.linkedParent&&m.volumeSeriesID),H.call(this,f,"params",m,b,h)}function $(f,w,b,h){let m=this,x=m.lang,I=w.querySelectorAll(".highcharts-popup-lhs-col")[0],B=w.querySelectorAll(".highcharts-popup-rhs-col")[0],V=b==="edit",U=V?f.series:f.options.plotOptions||{};if(!f&&U)return;let K,L=[];V||O(U)?O(U)&&(L=A.call(this,U)):L=j.call(this,U,h),N(L,(le,D)=>{let F=le.indicatorFullName.toLowerCase(),oe=D.indicatorFullName.toLowerCase();return F<oe?-1:F>oe?1:0}),I.children[1]&&I.children[1].remove();let X=y("ul",{className:"highcharts-indicator-list"},void 0,I),q=B.querySelectorAll(".highcharts-popup-rhs-col-wrapper")[0];L.forEach(le=>{let{indicatorFullName:D,indicatorType:F,series:oe}=le;(K=y("li",{className:"highcharts-indicator-list"},void 0,X)).appendChild(u.createTextNode(D)),["click","touchstart"].forEach(ne=>{C(K,ne,function(){let ae=q.parentNode.children[1];ie.call(m,f,oe,F,q),ae&&(ae.style.display="block"),V&&oe.options&&y("input",{type:"hidden",name:"highcharts-id-"+F,value:oe.options.id},void 0,q).setAttribute("highcharts-data-series-id",oe.options.id)})})}),X.childNodes.length>0?X.childNodes[0].click():V||(i.setElementHTML(q.parentNode.children[0],x.noFilterMatch||""),q.parentNode.children[1].style.display="none")}function H(f,w,b,h,m){if(!f)return;let x=this.addInput;_(b,(I,B)=>{g[B];let V=w+"."+B;if(S(I)&&V)if(M(I)&&(x.call(this,V,h,m,{}),H.call(this,f,V,I,h,m)),V in l){let U=Y.call(this,h,V,m);P.call(this,f,w,U,h,B,I)}else V==="params.volumeSeriesID"||O(I)||x.call(this,V,h,m,{value:I,type:"number"})})}function Q(f,w){let b=this,h=w.querySelectorAll(".highcharts-popup-lhs-col")[0],m=this.lang.clearFilter,x=y("div",{className:"highcharts-input-wrapper"},void 0,h),I=function(U){$.call(b,f,b.container,"add",U)},B=this.addInput("searchIndicators","input",x,{value:"",type:"text",htmlFor:"search-indicators",labelClassName:"highcharts-input-search-indicators-label"}),V=y("a",{textContent:m},void 0,x);B.classList.add("highcharts-input-search-indicators"),V.classList.add("clear-filter-button"),C(B,"input",function(U){I(this.value),this.value.length?V.style.display="inline-block":V.style.display="none"}),["click","touchstart"].forEach(U=>{C(V,U,function(){B.value="",I(""),V.style.display="none"})})}function Y(f,w,b){let h=w.split("."),m=h[h.length-1],x="highcharts-"+w+"-type-"+f,I=this.lang;y("label",{htmlFor:x},null,b).appendChild(u.createTextNode(I[m]||w));let B=y("select",{name:x,className:"highcharts-popup-field",id:"highcharts-select-"+w},null,b);return B.setAttribute("id","highcharts-select-"+w),B}function P(f,w,b,h,m,x,I){w==="series"||w==="volume"?f.series.forEach(B=>{let V=B.options,U=V.name||V.params?B.name:V.id||"";V.id!=="highcharts-navigator-series"&&V.id!==(I&&I.options&&I.options.id)&&(S(x)||w!=="volume"||B.type!=="column"||(x=V.id),y("option",{value:V.id},void 0,b).appendChild(u.createTextNode(U)))}):h&&m&&E[m+"-"+h].forEach(V=>{y("option",{value:V},void 0,b).appendChild(u.createTextNode(V))}),S(x)&&(b.value=x)}function j(f,w){let b;this.indicators;let h=this.chart&&this.chart.options.lang,m=h&&h.navigation&&h.navigation.popup&&h.navigation.popup.indicatorAliases,x=[];return _(f,(I,B)=>{let V=I&&I.options;if(I.params||V&&V.params){let{indicatorFullName:U,indicatorType:K}=v(I,B);if(w){let L=w.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),X=RegExp(L,"i"),q=m&&m[K]&&m[K].join(" ")||"";(U.match(X)||q.match(X))&&(b={indicatorFullName:U,indicatorType:K,series:I},x.push(b))}else b={indicatorFullName:U,indicatorType:K,series:I},x.push(b)}}),x}function A(f){let w=[];return f.forEach(b=>{b.is("sma")&&w.push({indicatorFullName:b.name,indicatorType:b.type,series:b})}),w}function v(f,w){let b=f.options,h=p[w]&&p[w].prototype.nameBase||w.toUpperCase(),m=w;return b&&b.type&&(m=f.options.type,h=f.name),{indicatorFullName:h,indicatorType:m}}function R(f,w,b,h,m,x){if(this.indicators,!b)return;let I=Y.call(this,f,w,h);P.call(this,b,w,I,void 0,void 0,void 0,m),S(x)&&(I.value=x)}return{addForm:function(f,w,b){let h,m=this.lang;if(!f)return;this.tabs.init.call(this,f);let x=this.container.querySelectorAll(".highcharts-tab-item-content");k(x[0]),Q.call(this,f,x[0]),$.call(this,f,x[0],"add"),h=x[0].querySelectorAll(".highcharts-popup-rhs-col")[0],this.addButton(h,m.addButton||"add","add",h,b),k(x[1]),$.call(this,f,x[1],"edit"),h=x[1].querySelectorAll(".highcharts-popup-rhs-col")[0],this.addButton(h,m.saveButton||"save","edit",h,b),this.addButton(h,m.removeButton||"remove","remove",h,b)},getAmount:function(){let f=0;return this.series.forEach(w=>{(w.params||w.options.params)&&f++}),f}}}),t(e,"Extensions/Annotations/Popup/PopupTabs.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(i,s){let{doc:r}=i,{addEvent:n,createElement:a}=s;function l(){let C=this.container;return a("div",{className:"highcharts-tab-item-content highcharts-no-mousewheel"},void 0,C)}function c(C,y){let S=this.container,O=this.lang,M="highcharts-tab-item";y===0&&(M+=" highcharts-tab-disabled");let _=a("span",{className:M},void 0,S);return _.appendChild(r.createTextNode(O[C+"Button"]||C)),_.setAttribute("highcharts-data-tab-type",C),_}function u(){let C=this.container,y=C.querySelectorAll(".highcharts-tab-item"),S=C.querySelectorAll(".highcharts-tab-item-content");for(let O=0;O<y.length;O++)y[O].classList.remove("highcharts-tab-item-active"),S[O].classList.remove("highcharts-tab-item-show")}function g(C,y){let S=this.container.querySelectorAll(".highcharts-tab-item-content");C.className+=" highcharts-tab-item-active",S[y].className+=" highcharts-tab-item-show"}function p(C){let y=this;this.container.querySelectorAll(".highcharts-tab-item").forEach((M,_)=>{(C!==0||M.getAttribute("highcharts-data-tab-type")!=="edit")&&["click","touchstart"].forEach(N=>{n(M,N,function(){u.call(y),g.call(y,this,_)})})})}return{init:function(C){if(!C)return;let y=this.indicators.getAmount.call(C),S=c.call(this,"add");c.call(this,"edit",y),l.call(this),l.call(this),p.call(this,y),g.call(this,S,0)}}}),t(e,"Extensions/Annotations/Popup/Popup.js",[e["Shared/BaseForm.js"],e["Core/Globals.js"],e["Core/Defaults.js"],e["Extensions/Annotations/Popup/PopupAnnotations.js"],e["Extensions/Annotations/Popup/PopupIndicators.js"],e["Extensions/Annotations/Popup/PopupTabs.js"],e["Core/Utilities.js"]],function(i,s,r,n,a,l,c){let{doc:u}=s,{getOptions:g}=r,{addEvent:p,createElement:C,extend:y,fireEvent:S,pick:O}=c;class M extends i{constructor(N,E,k){super(N,E),this.chart=k,this.lang=(g().lang.navigation||{}).popup||{},p(this.container,"mousedown",()=>{let ie=k&&k.navigationBindings&&k.navigationBindings.activeAnnotation;if(ie){ie.cancelClick=!0;let $=p(u,"click",()=>{setTimeout(()=>{ie.cancelClick=!1},0),$()})}})}addInput(N,E,k,ie){let $=N.split("."),H=$[$.length-1],Q=this.lang,Y="highcharts-"+E+"-"+O(ie.htmlFor,H);H.match(/^\d+$/)||C("label",{htmlFor:Y,className:ie.labelClassName},void 0,k).appendChild(u.createTextNode(Q[H]||H));let P=C("input",{name:Y,value:ie.value,type:ie.type,className:"highcharts-popup-field"},void 0,k);return P.setAttribute("highcharts-data-name",N),P}closeButtonEvents(){if(this.chart){let N=this.chart.navigationBindings;S(N,"closePopup"),N&&N.selectedButtonElement&&S(N,"deselectButton",{button:N.selectedButtonElement})}else super.closeButtonEvents()}addButton(N,E,k,ie,$){let H=C("button",void 0,void 0,N);return H.appendChild(u.createTextNode(E)),$&&["click","touchstart"].forEach(Q=>{p(H,Q,()=>(this.closePopup(),$(function(Y,P){let j=Array.prototype.slice.call(Y.querySelectorAll("input")),A=Array.prototype.slice.call(Y.querySelectorAll("select")),v=Y.querySelectorAll("#highcharts-select-series > option:checked")[0],R=Y.querySelectorAll("#highcharts-select-volume > option:checked")[0],f={actionType:P,linkedTo:v&&v.getAttribute("value")||"",fields:{}};return j.forEach(w=>{let b=w.getAttribute("highcharts-data-name");w.getAttribute("highcharts-data-series-id")?f.seriesId=w.value:b?f.fields[b]=w.value:f.type=w.value}),A.forEach(w=>{let b=w.id;if(b!=="highcharts-select-series"&&b!=="highcharts-select-volume"){let h=b.split("highcharts-select-")[1];f.fields[h]=w.value}}),R&&(f.fields["params.volumeSeriesID"]=R.getAttribute("value")||""),f}(ie,k))))}),H}showForm(N,E,k,ie){E&&(this.showPopup(),N==="indicators"&&this.indicators.addForm.call(this,E,k,ie),N==="annotation-toolbar"&&this.annotations.addToolbar.call(this,E,k,ie),N==="annotation-edit"&&this.annotations.addForm.call(this,E,k,ie),N==="flag"&&this.annotations.addForm.call(this,E,k,ie,!0),this.type=N,this.container.style.height=this.container.offsetHeight+"px")}}return y(M.prototype,{annotations:n,indicators:a,tabs:l}),M}),t(e,"Extensions/Annotations/Popup/PopupComposition.js",[e["Core/Globals.js"],e["Extensions/Annotations/Popup/Popup.js"],e["Core/Utilities.js"]],function(i,s,r){let{composed:n}=i,{addEvent:a,pushUnique:l,wrap:c}=r;function u(){this.popup&&this.popup.closePopup()}function g(C){this.popup||(this.popup=new s(this.chart.container,this.chart.options.navigation.iconsURL||this.chart.options.stockTools&&this.chart.options.stockTools.gui.iconsURL||"https://code.highcharts.com/11.3.0/gfx/stock-icons/",this.chart)),this.popup.showForm(C.formType,this.chart,C.options,C.onSubmit)}function p(C,y){this.inClass(y.target,"highcharts-popup")||C.apply(this,Array.prototype.slice.call(arguments,1))}return{compose:function C(y,S){l(n,C)&&(a(y,"closePopup",u),a(y,"showPopup",g),c(S.prototype,"onContainerMouseDown",p))}}}),t(e,"Extensions/Annotations/Annotation.js",[e["Core/Animation/AnimationUtilities.js"],e["Extensions/Annotations/AnnotationChart.js"],e["Extensions/Annotations/AnnotationDefaults.js"],e["Extensions/Annotations/Controllables/ControllableRect.js"],e["Extensions/Annotations/Controllables/ControllableCircle.js"],e["Extensions/Annotations/Controllables/ControllableEllipse.js"],e["Extensions/Annotations/Controllables/ControllablePath.js"],e["Extensions/Annotations/Controllables/ControllableImage.js"],e["Extensions/Annotations/Controllables/ControllableLabel.js"],e["Extensions/Annotations/ControlPoint.js"],e["Extensions/Annotations/ControlTarget.js"],e["Extensions/Annotations/EventEmitter.js"],e["Extensions/Annotations/MockPoint.js"],e["Extensions/Annotations/NavigationBindings.js"],e["Extensions/Annotations/Popup/PopupComposition.js"],e["Core/Utilities.js"]],function(i,s,r,n,a,l,c,u,g,p,C,y,S,O,M,_){let{getDeferredAnimation:N}=i,{destroyObjectProperties:E,erase:k,fireEvent:ie,merge:$,pick:H,splat:Q}=_;function Y(j,A){let v={};return["labels","shapes"].forEach(R=>{let f=j[R];f&&(A[R]?v[R]=Q(A[R]).map(function(w,b){return $(f[b],w)}):v[R]=j[R])}),v}class P extends y{static compose(A,v,R){s.compose(P,A,v),g.compose(R),c.compose(A,R),O.compose(P,A),M.compose(O,v)}constructor(A,v){super(),this.coll="annotations",this.chart=A,this.points=[],this.controlPoints=[],this.coll="annotations",this.index=-1,this.labels=[],this.shapes=[],this.options=$(this.defaultOptions,v),this.userOptions=v;let R=Y(this.options,v);this.options.labels=R.labels,this.options.shapes=R.shapes,this.init(A,this.options)}addClipPaths(){this.setClipAxes(),this.clipXAxis&&this.clipYAxis&&this.options.crop&&(this.clipRect=this.chart.renderer.clipRect(this.getClipBox()))}addLabels(){let A=this.options.labels||[];A.forEach((v,R)=>{let f=this.initLabel(v,R);$(!0,A[R],f.options)})}addShapes(){let A=this.options.shapes||[];A.forEach((v,R)=>{let f=this.initShape(v,R);$(!0,A[R],f.options)})}destroy(){let A=this.chart,v=function(R){R.destroy()};this.labels.forEach(v),this.shapes.forEach(v),this.clipXAxis=null,this.clipYAxis=null,k(A.labelCollectors,this.labelCollector),super.destroy(),this.destroyControlTarget(),E(this,A)}destroyItem(A){k(this[A.itemType+"s"],A),A.destroy()}getClipBox(){if(this.clipXAxis&&this.clipYAxis)return{x:this.clipXAxis.left,y:this.clipYAxis.top,width:this.clipXAxis.width,height:this.clipYAxis.height}}initProperties(A,v){this.setOptions(v);let R=Y(this.options,v);this.options.labels=R.labels,this.options.shapes=R.shapes,this.chart=A,this.points=[],this.controlPoints=[],this.coll="annotations",this.userOptions=v,this.labels=[],this.shapes=[]}init(A,v,R=this.index){let f=this.chart,w=this.options.animation;this.index=R,this.linkPoints(),this.addControlPoints(),this.addShapes(),this.addLabels(),this.setLabelCollector(),this.animationConfig=N(f,w)}initLabel(A,v){let R=$(this.options.labelOptions,{controlPointOptions:this.options.controlPointOptions},A),f=new g(this,R,v);return f.itemType="label",this.labels.push(f),f}initShape(A,v){let R=$(this.options.shapeOptions,{controlPointOptions:this.options.controlPointOptions},A),f=new P.shapesMap[R.type](this,R,v);return f.itemType="shape",this.shapes.push(f),f}redraw(A){this.linkPoints(),this.graphic||this.render(),this.clipRect&&this.clipRect.animate(this.getClipBox()),this.redrawItems(this.shapes,A),this.redrawItems(this.labels,A),this.redrawControlPoints(A)}redrawItem(A,v){A.linkPoints(),A.shouldBeDrawn()?(A.graphic||this.renderItem(A),A.redraw(H(v,!0)&&A.graphic.placed),A.points.length&&function(R){let f=R.graphic,w=R.points.some(b=>b.series.visible!==!1&&b.visible!==!1);f&&(w?f.visibility==="hidden"&&f.show():f.hide())}(A)):this.destroyItem(A)}redrawItems(A,v){let R=A.length;for(;R--;)this.redrawItem(A[R],v)}remove(){return this.chart.removeAnnotation(this)}render(){let A=this.chart.renderer;this.graphic=A.g("annotation").attr({opacity:0,zIndex:this.options.zIndex,visibility:this.options.visible?"inherit":"hidden"}).add(),this.shapesGroup=A.g("annotation-shapes").add(this.graphic),this.options.crop&&this.shapesGroup.clip(this.chart.plotBoxClip),this.labelsGroup=A.g("annotation-labels").attr({translateX:0,translateY:0}).add(this.graphic),this.addClipPaths(),this.clipRect&&this.graphic.clip(this.clipRect),this.renderItems(this.shapes),this.renderItems(this.labels),this.addEvents(),this.renderControlPoints()}renderItem(A){A.render(A.itemType==="label"?this.labelsGroup:this.shapesGroup)}renderItems(A){let v=A.length;for(;v--;)this.renderItem(A[v])}setClipAxes(){let A=this.chart.xAxis,v=this.chart.yAxis,R=(this.options.labels||[]).concat(this.options.shapes||[]).reduce((f,w)=>{let b=w&&(w.point||w.points&&w.points[0]);return[A[b&&b.xAxis]||f[0],v[b&&b.yAxis]||f[1]]},[]);this.clipXAxis=R[0],this.clipYAxis=R[1]}setControlPointsVisibility(A){let v=function(R){R.setControlPointsVisibility(A)};this.controlPoints.forEach(R=>{R.setVisibility(A)}),this.shapes.forEach(v),this.labels.forEach(v)}setLabelCollector(){let A=this;A.labelCollector=function(){return A.labels.reduce(function(v,R){return R.options.allowOverlap||v.push(R.graphic),v},[])},A.chart.labelCollectors.push(A.labelCollector)}setOptions(A){this.options=$(this.defaultOptions,A)}setVisibility(A){let v=this.options,R=this.chart.navigationBindings,f=H(A,!v.visible);if(this.graphic.attr("visibility",f?"inherit":"hidden"),!f){let w=function(b){b.setControlPointsVisibility(f)};this.shapes.forEach(w),this.labels.forEach(w),R.activeAnnotation===this&&R.popup&&R.popup.type==="annotation-toolbar"&&ie(R,"closePopup")}v.visible=f}update(A,v){let R=this.chart,f=Y(this.userOptions,A),w=R.annotations.indexOf(this),b=$(!0,this.userOptions,A);b.labels=f.labels,b.shapes=f.shapes,this.destroy(),this.initProperties(R,b),this.init(R,b),R.options.annotations[w]=b,this.isUpdating=!0,H(v,!0)&&R.drawAnnotations(),ie(this,"afterUpdate"),this.isUpdating=!1}}return P.ControlPoint=p,P.MockPoint=S,P.shapesMap={rect:n,circle:a,ellipse:l,path:c,image:u},P.types={},P.prototype.defaultOptions=r,P.prototype.nonDOMEvents=["add","afterUpdate","drag","remove"],C.compose(P),P}),t(e,"masters/modules/annotations.src.js",[e["Core/Globals.js"],e["Extensions/Annotations/Annotation.js"]],function(i,s){i.Annotation=s,s.compose(i.Chart,i.Pointer,i.SVGRenderer)})})});var Q_=Ie((ES,TS)=>{"use strict";(function(o,e){typeof ES=="object"&&typeof TS<"u"?TS.exports=e():typeof define=="function"&&define.amd?define(e):(o=typeof globalThis<"u"?globalThis:o||self).dayjs=e()})(ES,function(){"use strict";var o=1e3,e=6e4,t=36e5,i="millisecond",s="second",r="minute",n="hour",a="day",l="week",c="month",u="quarter",g="year",p="date",C="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,S=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,O={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(j){var A=["th","st","nd","rd"],v=j%100;return"["+j+(A[(v-20)%10]||A[v]||A[0])+"]"}},M=function(j,A,v){var R=String(j);return!R||R.length>=A?j:""+Array(A+1-R.length).join(v)+j},_={s:M,z:function(j){var A=-j.utcOffset(),v=Math.abs(A),R=Math.floor(v/60),f=v%60;return(A<=0?"+":"-")+M(R,2,"0")+":"+M(f,2,"0")},m:function j(A,v){if(A.date()<v.date())return-j(v,A);var R=12*(v.year()-A.year())+(v.month()-A.month()),f=A.clone().add(R,c),w=v-f<0,b=A.clone().add(R+(w?-1:1),c);return+(-(R+(v-f)/(w?f-b:b-f))||0)},a:function(j){return j<0?Math.ceil(j)||0:Math.floor(j)},p:function(j){return{M:c,y:g,w:l,d:a,D:p,h:n,m:r,s,ms:i,Q:u}[j]||String(j||"").toLowerCase().replace(/s$/,"")},u:function(j){return j===void 0}},N="en",E={};E[N]=O;var k="$isDayjsObject",ie=function(j){return j instanceof Y||!(!j||!j[k])},$=function j(A,v,R){var f;if(!A)return N;if(typeof A=="string"){var w=A.toLowerCase();E[w]&&(f=w),v&&(E[w]=v,f=w);var b=A.split("-");if(!f&&b.length>1)return j(b[0])}else{var h=A.name;E[h]=A,f=h}return!R&&f&&(N=f),f||!R&&N},H=function(j,A){if(ie(j))return j.clone();var v=typeof A=="object"?A:{};return v.date=j,v.args=arguments,new Y(v)},Q=_;Q.l=$,Q.i=ie,Q.w=function(j,A){return H(j,{locale:A.$L,utc:A.$u,x:A.$x,$offset:A.$offset})};var Y=function(){function j(v){this.$L=$(v.locale,null,!0),this.parse(v),this.$x=this.$x||v.x||{},this[k]=!0}var A=j.prototype;return A.parse=function(v){this.$d=function(R){var f=R.date,w=R.utc;if(f===null)return new Date(NaN);if(Q.u(f))return new Date;if(f instanceof Date)return new Date(f);if(typeof f=="string"&&!/Z$/i.test(f)){var b=f.match(y);if(b){var h=b[2]-1||0,m=(b[7]||"0").substring(0,3);return w?new Date(Date.UTC(b[1],h,b[3]||1,b[4]||0,b[5]||0,b[6]||0,m)):new Date(b[1],h,b[3]||1,b[4]||0,b[5]||0,b[6]||0,m)}}return new Date(f)}(v),this.init()},A.init=function(){var v=this.$d;this.$y=v.getFullYear(),this.$M=v.getMonth(),this.$D=v.getDate(),this.$W=v.getDay(),this.$H=v.getHours(),this.$m=v.getMinutes(),this.$s=v.getSeconds(),this.$ms=v.getMilliseconds()},A.$utils=function(){return Q},A.isValid=function(){return this.$d.toString()!==C},A.isSame=function(v,R){var f=H(v);return this.startOf(R)<=f&&f<=this.endOf(R)},A.isAfter=function(v,R){return H(v)<this.startOf(R)},A.isBefore=function(v,R){return this.endOf(R)<H(v)},A.$g=function(v,R,f){return Q.u(v)?this[R]:this.set(f,v)},A.unix=function(){return Math.floor(this.valueOf()/1e3)},A.valueOf=function(){return this.$d.getTime()},A.startOf=function(v,R){var f=this,w=!!Q.u(R)||R,b=Q.p(v),h=function(L,X){var q=Q.w(f.$u?Date.UTC(f.$y,X,L):new Date(f.$y,X,L),f);return w?q:q.endOf(a)},m=function(L,X){return Q.w(f.toDate()[L].apply(f.toDate("s"),(w?[0,0,0,0]:[23,59,59,999]).slice(X)),f)},x=this.$W,I=this.$M,B=this.$D,V="set"+(this.$u?"UTC":"");switch(b){case g:return w?h(1,0):h(31,11);case c:return w?h(1,I):h(0,I+1);case l:var U=this.$locale().weekStart||0,K=(x<U?x+7:x)-U;return h(w?B-K:B+(6-K),I);case a:case p:return m(V+"Hours",0);case n:return m(V+"Minutes",1);case r:return m(V+"Seconds",2);case s:return m(V+"Milliseconds",3);default:return this.clone()}},A.endOf=function(v){return this.startOf(v,!1)},A.$set=function(v,R){var f,w=Q.p(v),b="set"+(this.$u?"UTC":""),h=(f={},f[a]=b+"Date",f[p]=b+"Date",f[c]=b+"Month",f[g]=b+"FullYear",f[n]=b+"Hours",f[r]=b+"Minutes",f[s]=b+"Seconds",f[i]=b+"Milliseconds",f)[w],m=w===a?this.$D+(R-this.$W):R;if(w===c||w===g){var x=this.clone().set(p,1);x.$d[h](m),x.init(),this.$d=x.set(p,Math.min(this.$D,x.daysInMonth())).$d}else h&&this.$d[h](m);return this.init(),this},A.set=function(v,R){return this.clone().$set(v,R)},A.get=function(v){return this[Q.p(v)]()},A.add=function(v,R){var f,w=this;v=Number(v);var b=Q.p(R),h=function(I){var B=H(w);return Q.w(B.date(B.date()+Math.round(I*v)),w)};if(b===c)return this.set(c,this.$M+v);if(b===g)return this.set(g,this.$y+v);if(b===a)return h(1);if(b===l)return h(7);var m=(f={},f[r]=e,f[n]=t,f[s]=o,f)[b]||1,x=this.$d.getTime()+v*m;return Q.w(x,this)},A.subtract=function(v,R){return this.add(-1*v,R)},A.format=function(v){var R=this,f=this.$locale();if(!this.isValid())return f.invalidDate||C;var w=v||"YYYY-MM-DDTHH:mm:ssZ",b=Q.z(this),h=this.$H,m=this.$m,x=this.$M,I=f.weekdays,B=f.months,V=f.meridiem,U=function(X,q,le,D){return X&&(X[q]||X(R,w))||le[q].slice(0,D)},K=function(X){return Q.s(h%12||12,X,"0")},L=V||function(X,q,le){var D=X<12?"AM":"PM";return le?D.toLowerCase():D};return w.replace(S,function(X,q){return q||function(le){switch(le){case"YY":return String(R.$y).slice(-2);case"YYYY":return Q.s(R.$y,4,"0");case"M":return x+1;case"MM":return Q.s(x+1,2,"0");case"MMM":return U(f.monthsShort,x,B,3);case"MMMM":return U(B,x);case"D":return R.$D;case"DD":return Q.s(R.$D,2,"0");case"d":return String(R.$W);case"dd":return U(f.weekdaysMin,R.$W,I,2);case"ddd":return U(f.weekdaysShort,R.$W,I,3);case"dddd":return I[R.$W];case"H":return String(h);case"HH":return Q.s(h,2,"0");case"h":return K(1);case"hh":return K(2);case"a":return L(h,m,!0);case"A":return L(h,m,!1);case"m":return String(m);case"mm":return Q.s(m,2,"0");case"s":return String(R.$s);case"ss":return Q.s(R.$s,2,"0");case"SSS":return Q.s(R.$ms,3,"0");case"Z":return b}return null}(X)||b.replace(":","")})},A.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},A.diff=function(v,R,f){var w,b=this,h=Q.p(R),m=H(v),x=(m.utcOffset()-this.utcOffset())*e,I=this-m,B=function(){return Q.m(b,m)};switch(h){case g:w=B()/12;break;case c:w=B();break;case u:w=B()/3;break;case l:w=(I-x)/6048e5;break;case a:w=(I-x)/864e5;break;case n:w=I/t;break;case r:w=I/e;break;case s:w=I/o;break;default:w=I}return f?w:Q.a(w)},A.daysInMonth=function(){return this.endOf(c).$D},A.$locale=function(){return E[this.$L]},A.locale=function(v,R){if(!v)return this.$L;var f=this.clone(),w=$(v,R,!0);return w&&(f.$L=w),f},A.clone=function(){return Q.w(this.$d,this)},A.toDate=function(){return new Date(this.valueOf())},A.toJSON=function(){return this.isValid()?this.toISOString():null},A.toISOString=function(){return this.$d.toISOString()},A.toString=function(){return this.$d.toUTCString()},j}(),P=Y.prototype;return H.prototype=P,[["$ms",i],["$s",s],["$m",r],["$H",n],["$W",a],["$M",c],["$y",g],["$D",p]].forEach(function(j){P[j[1]]=function(A){return this.$g(A,j[0],j[1])}}),H.extend=function(j,A){return j.$i||(j(A,Y,H),j.$i=!0),H},H.locale=$,H.isDayjs=ie,H.unix=function(j){return H(1e3*j)},H.en=E[N],H.Ls=E,H.p={},H})});var bF=rr(),xF=Zl(),SF=eh(),EF=CC(),TF=wC(),RF=Vi(),MF=RF(function(){return[].push.call({length:4294967296},1)!==4294967297}),OF=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(o){return o instanceof TypeError}},AF=MF||!OF();bF({target:"Array",proto:!0,arity:1,forced:AF},{push:function(e){var t=xF(this),i=SF(t),s=arguments.length;TF(i+s);for(var r=0;r<s;r++)t[i]=arguments[r],i++;return EF(t,i),i}});var pR=rr(),wB=pi(),Ws=ih(),gR=fR(),bC="WebAssembly",mR=wB[bC],tm=Error("e",{cause:7}).cause!==7,Qr=function(o,e){var t={};t[o]=gR(o,e,tm),pR({global:!0,constructor:!0,arity:1,forced:tm},t)},xC=function(o,e){if(mR&&mR[o]){var t={};t[o]=gR(bC+"."+o,e,tm),pR({target:bC,stat:!0,constructor:!0,arity:1,forced:tm},t)}};Qr("Error",function(o){return function(t){return Ws(o,this,arguments)}});Qr("EvalError",function(o){return function(t){return Ws(o,this,arguments)}});Qr("RangeError",function(o){return function(t){return Ws(o,this,arguments)}});Qr("ReferenceError",function(o){return function(t){return Ws(o,this,arguments)}});Qr("SyntaxError",function(o){return function(t){return Ws(o,this,arguments)}});Qr("TypeError",function(o){return function(t){return Ws(o,this,arguments)}});Qr("URIError",function(o){return function(t){return Ws(o,this,arguments)}});xC("CompileError",function(o){return function(t){return Ws(o,this,arguments)}});xC("LinkError",function(o){return function(t){return Ws(o,this,arguments)}});xC("RuntimeError",function(o){return function(t){return Ws(o,this,arguments)}});BR();XR();var ew={};Ri(ew,{HTML_CHARACTERS:()=>rM,addClass:()=>Te,addEvent:()=>hV,clearTextSelection:()=>hm,closest:()=>os,closestDown:()=>ca,empty:()=>li,fastInnerHTML:()=>Yi,fastInnerText:()=>ji,getCaretPosition:()=>dh,getComputedStyle:()=>as,getCssTransform:()=>dV,getFrameElement:()=>sM,getParent:()=>zC,getParentWindow:()=>nr,getScrollLeft:()=>ua,getScrollTop:()=>ar,getScrollableElement:()=>tn,getScrollbarWidth:()=>Rt,getSelectionEndPosition:()=>XC,getSelectionText:()=>qC,getStyle:()=>bo,getTrimmingContainer:()=>ns,getWindowScrollLeft:()=>As,getWindowScrollTop:()=>vo,hasAccessToParentWindow:()=>aV,hasClass:()=>Ve,hasHorizontalScrollbar:()=>ZC,hasVerticalScrollbar:()=>KC,index:()=>$C,innerHeight:()=>ls,innerWidth:()=>sn,isChildOf:()=>rs,isDetached:()=>fh,isInput:()=>rn,isOutsideInput:()=>da,isVisible:()=>wo,matchesCSSRules:()=>lV,observeVisibilityChangeOnce:()=>JC,offset:()=>Ot,outerHeight:()=>ft,outerWidth:()=>at,overlayContainsElement:()=>yo,removeClass:()=>je,removeEvent:()=>cV,removeTextNodes:()=>lm,resetCssTransform:()=>So,selectElementIfAllowed:()=>QC,setCaretPosition:()=>xo,setOverlayPosition:()=>on});var jC={};Ri(jC,{equalsIgnoreCase:()=>nV,isPercentValue:()=>ch,randomString:()=>hh,sanitize:()=>ha,stripTags:()=>am,substitute:()=>uh,toUpperCaseFirst:()=>$t});var iM=ri(qR(),1);var YC={};Ri(YC,{_injectProductInfo:()=>UC,isDefined:()=>Pe,isEmpty:()=>At,isRegExp:()=>WC,isUndefined:()=>nt,stringify:()=>vt});var BC=ri(Ui(),1);var FC={};Ri(FC,{arrayAvg:()=>eV,arrayEach:()=>we,arrayFilter:()=>zt,arrayFlatten:()=>ZR,arrayMap:()=>Ge,arrayMax:()=>QB,arrayMin:()=>JB,arrayReduce:()=>pt,arraySum:()=>KR,arrayUnique:()=>rh,extendArray:()=>sm,getDifferenceOfArrays:()=>om,getIntersectionOfArrays:()=>tV,getUnionOfArrays:()=>iV,pivot:()=>en,stringToArray:()=>rm,to2dArray:()=>HC});function HC(o){let e=o.length,t=0;for(;t<e;)o[t]=[o[t]],t+=1}function sm(o,e){let t=e.length,i=0;for(;i<t;)o.push(e[i]),i+=1}function en(o){let e=[];if(!o||o.length===0||!o[0]||o[0].length===0)return e;let t=o.length,i=o[0].length;for(let s=0;s<t;s++)for(let r=0;r<i;r++)e[r]||(e[r]=[]),e[r][s]=o[s][r];return e}function pt(o,e,t,i){let s=-1,r=o,n=t;Array.isArray(o)||(r=Array.from(o));let a=r.length;for(i&&a&&(s+=1,n=r[s]),s+=1;s<a;)n=e(n,r[s],s,r),s+=1;return n}function zt(o,e){let t=0,i=o;Array.isArray(o)||(i=Array.from(o));let s=i.length,r=[],n=-1;for(;t<s;){let a=i[t];e(a,t,i)&&(n+=1,r[n]=a),t+=1}return r}function Ge(o,e){let t=0,i=o;Array.isArray(o)||(i=Array.from(o));let s=i.length,r=[],n=-1;for(;t<s;){let a=i[t];n+=1,r[n]=e(a,t,i),t+=1}return r}function we(o,e){let t=0,i=o;Array.isArray(o)||(i=Array.from(o));let s=i.length;for(;t<s&&e(i[t],t,i)!==!1;)t+=1;return o}function KR(o){return pt(o,(e,t)=>e+t,0)}function QB(o){return pt(o,(e,t)=>e>t?e:t,Array.isArray(o)?o[0]:void 0)}function JB(o){return pt(o,(e,t)=>e<t?e:t,Array.isArray(o)?o[0]:void 0)}function eV(o){return o.length?KR(o)/o.length:0}function ZR(o){return pt(o,(e,t)=>e.concat(Array.isArray(t)?ZR(t):t),[])}function rh(o){let e=[];return we(o,t=>{e.indexOf(t)===-1&&e.push(t)}),e}function om(){for(var o=arguments.length,e=new Array(o),t=0;t<o;t++)e[t]=arguments[t];let[i,...s]=[...e],r=i;return we(s,n=>{r=r.filter(a=>!n.includes(a))}),r}function tV(){for(var o=arguments.length,e=new Array(o),t=0;t<o;t++)e[t]=arguments[t];let[i,...s]=[...e],r=i;return we(s,n=>{r=r.filter(a=>n.includes(a))}),r}function iV(){for(var o=arguments.length,e=new Array(o),t=0;t<o;t++)e[t]=arguments[t];let[i,...s]=[...e],r=new Set(i);return we(s,n=>{we(n,a=>{r.has(a)||r.add(a)})}),Array.from(r)}function rm(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return o.split(e)}function st(o){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return pt(o,(r,n,a)=>{let l=n.replace(/\r?\n\s*/g,""),c=t[a]?t[a]:"";return r+l+c},"").trim()}function vt(o){let e;switch(typeof o){case"string":case"number":e=`${o}`;break;case"object":e=o===null?"":o.toString();break;case"undefined":e="";break;default:e=o.toString();break}return e}function Pe(o){return typeof o<"u"}function nt(o){return typeof o>"u"}function At(o){return o===null||o===""||nt(o)}function WC(o){return Object.prototype.toString.call(o)==="[object RegExp]"}var nh="length",ah=o=>parseInt(o,16),QR=o=>parseInt(o,10),nm=(o,e,t)=>o.substr(e,t),lh=o=>o.codePointAt(0)-65,VC=o=>`${o}`.replace(/\-/g,""),sV=o=>ah(nm(VC(o),ah("12"),lh("F")))/(ah(nm(VC(o),lh("B"),~~![][nh]))||9),oV=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host),JR=!1,eM={invalid:()=>st`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:o=>{let{keyValidityDate:e,hotVersion:t}=o;return st`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>st`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},tM={invalid:()=>st`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:o=>{let{keyValidityDate:e,hotVersion:t}=o;return st`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>st`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function UC(o,e){let t=!At(o),i=typeof o=="string"&&o.toLowerCase()==="non-commercial-and-evaluation",s="13.1.0",r,n="invalid",a="invalid";o=VC(o||"");let l=rV(o);if(t||i||l)if(l){let c=(0,BC.default)("31/08/2023","DD/MM/YYYY"),u=Math.floor(c.toDate().getTime()/864e5),g=sV(o);r=(0,BC.default)((g+1)*864e5,"x").format("MMMM DD, YYYY"),u>g?(n="expired",a="expired"):(n="valid",a="valid")}else i?(n="non_commercial",a="valid"):(n="invalid",a="invalid");else n="missing",a="missing";if(oV()&&(n="valid",a="valid"),!JR&&n!=="valid"&&(eM[n]({keyValidityDate:r,hotVersion:s})&&console[n==="non_commercial"?"info":"warn"](eM[n]({keyValidityDate:r,hotVersion:s})),JR=!0),a!=="valid"&&e.parentNode&&tM[a]({keyValidityDate:r,hotVersion:s})){let u=document.createElement("div");u.className="hot-display-license-info",u.innerHTML=tM[a]({keyValidityDate:r,hotVersion:s}),e.parentNode.insertBefore(u,e.nextSibling)}}function rV(o){let e=[][nh],t=e;if(o[nh]!==lh("Z"))return!1;for(let i="",s="B<H4P+".split(""),r=lh(s.shift());r;r=lh(s.shift()||"A"))--r<""[nh]?t=t|(QR(`${QR(ah(i)+(ah(nm(o,Math.abs(r),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=nm(o,r,r?s[nh]===1?9:8:6);return t===e}function $t(o){return o[0].toUpperCase()+o.substr(1)}function nV(){let o=[];for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];let s=t.length;for(;s;){s-=1;let r=vt(t[s]).toLowerCase();o.indexOf(r)===-1&&o.push(r)}return o.length===1}function hh(){function o(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return o()+o()+o()+o()}function ch(o){return/^([0-9][0-9]?%$)|(^100%$)/.test(o)}function uh(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${o}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,i)=>t.charAt(0)==="\\"?t.substr(1,t.length-1):e[i]===void 0?"":e[i])}function am(o){return ha(`${o}`,{ALLOWED_TAGS:[]})}function ha(o,e){return iM.default.sanitize(o,e)}function zC(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,i=null,s=o;for(;s!==null;){if(t===e){i=s;break}s.host&&s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?s=s.host:(t+=1,s=s.parentNode)}return i}function sM(o){return Object.getPrototypeOf(o.parent)&&o.frameElement}function nr(o){return sM(o)&&o.parent}function aV(o){return!!Object.getPrototypeOf(o.parent)}function os(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0,{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:s}=Node,r=o;for(;r!=null&&r!==t;){let{nodeType:n,nodeName:a}=r;if(n===i&&(e.includes(a)||e.includes(r)))return r;let{host:l}=r;l&&n===s?r=l:r=r.parentNode}return null}function ca(o,e,t){let i=[],s=o;for(;s&&(s=os(s,e,t),!(!s||t&&!t.contains(s)));)i.push(s),s.host&&s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?s=s.host:s=s.parentNode;let r=i.length;return r?i[r-1]:null}function rs(o,e){let t=o.parentNode,i=[];for(typeof e=="string"?o.defaultView?i=Array.prototype.slice.call(o.querySelectorAll(e),0):i=Array.prototype.slice.call(o.ownerDocument.querySelectorAll(e),0):i.push(e);t!==null;){if(i.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function $C(o){let e=0,t=o;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}function yo(o,e,t){let i=t.parentElement.querySelector(`.ht_clone_${o}`);return i?i.contains(e):null}function oM(o){return!o||!o.length?[]:o.filter(e=>!!e)}function Ve(o,e){return o.classList===void 0||typeof e!="string"||e===""?!1:o.classList.contains(e)}function Te(o,e){typeof e=="string"&&(e=e.split(" ")),e=oM(e),e.length>0&&o.classList.add(...e)}function je(o,e){typeof e=="string"&&(e=e.split(" ")),e=oM(e),e.length>0&&o.classList.remove(...e)}function lm(o){if(o.nodeType===3)o.parentNode.removeChild(o);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(o.nodeName)>-1){let e=o.childNodes;for(let t=e.length-1;t>=0;t--)lm(e[t])}}function li(o){let e;for(;e=o.lastChild;)o.removeChild(e)}var rM=/(<(.*)>|&(.*);)/;function Yi(o,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;rM.test(e)?o.innerHTML=t?ha(e):e:ji(o,e)}function ji(o,e){let t=o.firstChild;t&&t.nodeType===3&&t.nextSibling===null?t.textContent=e:(li(o),o.appendChild(o.ownerDocument.createTextNode(e)))}function wo(o){let e=o.ownerDocument.documentElement,t=o;for(;t!==e;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return wo(t.host.impl);if(t.host)return wo(t.host);throw new Error("Lost in Web Components world")}else return!1;else if(t.style&&t.style.display==="none")return!1;t=t.parentNode}return!0}function Ot(o){let e=o.ownerDocument,t=e.defaultView,i=e.documentElement,s=o,r,n,a;for(r=s.offsetLeft,n=s.offsetTop,a=s;(s=s.offsetParent)&&s!==e.body;)r+=s.offsetLeft,n+=s.offsetTop,a=s;return a&&a.style.position==="fixed"&&(r+=t.pageXOffset||i.scrollLeft,n+=t.pageYOffset||i.scrollTop),{left:r,top:n}}function vo(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function As(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function ar(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return o===e?vo(e):o.scrollTop}function ua(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return o===e?As(e):o.scrollLeft}function tn(o){let e=o.ownerDocument,t=e?e.defaultView:void 0;e||(e=o.document?o.document:o,t=e.defaultView);let i=["auto","scroll"],s=o.parentNode;for(;s&&s.style&&e.body!==s;){let{overflow:r,overflowX:n,overflowY:a}=s.style;if([r,n,a].includes("scroll"))return s;if({overflow:r,overflowX:n,overflowY:a}=t.getComputedStyle(s),i.includes(r)||i.includes(n)||i.includes(a)||s.clientHeight<=s.scrollHeight+1&&(i.includes(a)||i.includes(r))||s.clientWidth<=s.scrollWidth+1&&(i.includes(n)||i.includes(r)))return s;s=s.parentNode}return t}function ns(o){let e=o.ownerDocument,t=e.defaultView,i=o.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;let s=as(i,t),r=["scroll","hidden","auto"],n=s.getPropertyValue("overflow"),a=s.getPropertyValue("overflow-y"),l=s.getPropertyValue("overflow-x");if(r.includes(n)||r.includes(a)||r.includes(l))return i;i=i.parentNode}return t}function bo(o,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(o){if(o===t)return e==="width"?`${t.innerWidth}px`:e==="height"?`${t.innerHeight}px`:void 0}else return;let i=o.style[e];if(i!==""&&i!==void 0)return i;let s=as(o,t);if(s[e]!==""&&s[e]!==void 0)return s[e]}function lV(o,e){let{selectorText:t}=e,i=!1;return e.type===CSSRule.STYLE_RULE&&t&&(o.msMatchesSelector?i=o.msMatchesSelector(t):o.matches&&(i=o.matches(t))),i}function as(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return o.currentStyle||e.getComputedStyle(o)}function at(o){return o.offsetWidth}function ft(o){return o.offsetHeight}function ls(o){return o.clientHeight||o.innerHeight}function sn(o){return o.clientWidth||o.innerWidth}function hV(o,e,t){o.addEventListener(e,t,!1)}function cV(o,e,t){o.removeEventListener(e,t,!1)}function dh(o){return o.selectionStart?o.selectionStart:0}function XC(o){return o.selectionEnd?o.selectionEnd:0}function qC(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=o.document,t="";return o.getSelection?t=o.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(t=e.selection.createRange().text),t}function hm(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;o.getSelection&&(o.getSelection().empty?o.getSelection().empty():o.getSelection().removeAllRanges&&o.getSelection().removeAllRanges())}function xo(o,e,t){if(t===void 0&&(t=e),o.setSelectionRange){o.focus();try{o.setSelectionRange(e,t)}catch{let s=o.parentNode,r=s.style.display;s.style.display="block",o.setSelectionRange(e,t),s.style.display=r}}}var GC;function uV(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=o.createElement("div");e.style.height="200px",e.style.width="100%";let t=o.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(o.body||o.documentElement).appendChild(t);let i=e.offsetWidth;t.style.overflow="scroll";let s=e.offsetWidth;return i===s&&(s=t.clientWidth),(o.body||o.documentElement).removeChild(t),i-s}function Rt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return GC===void 0&&(GC=uV(o)),GC}function KC(o){return o.offsetWidth!==o.clientWidth}function ZC(o){return o.offsetHeight!==o.clientHeight}function on(o,e,t){o.style.transform=`translate3d(${e},${t},0)`}function dV(o){let e;return o.style.transform&&(e=o.style.transform)!==""?["transform",e]:-1}function So(o){o.style.transform&&o.style.transform!==""&&(o.style.transform="")}function rn(o){return o&&(["INPUT","SELECT","TEXTAREA"].indexOf(o.nodeName)>-1||o.contentEditable==="true")}function da(o){return rn(o)&&o.hasAttribute("data-hot-input")===!1}function QC(o){let e=o.ownerDocument.activeElement;da(e)||o.select()}function fh(o){return!o.parentNode}function JC(o,e){new IntersectionObserver((i,s)=>{i.forEach(r=>{r.isIntersecting&&o.offsetParent!==null&&(e(),s.unobserve(o))})},{root:o.ownerDocument.body}).observe(o)}var iw={};Ri(iw,{curry:()=>tw,curryRight:()=>pV,debounce:()=>mh,fastCall:()=>fa,isFunction:()=>ht,partial:()=>ph,pipe:()=>mV,throttle:()=>nM,throttleAfterHits:()=>fV});function ht(o){return typeof o=="function"}function nM(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=0,i={lastCallThrottled:!0},s=null;function r(){for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];let c=Date.now(),u=!1;i.lastCallThrottled=!0,t||(t=c,u=!0);let g=e-(c-t);return u?(i.lastCallThrottled=!1,o.apply(this,a)):(s&&clearTimeout(s),s=setTimeout(()=>{i.lastCallThrottled=!1,o.apply(this,a),t=0,s=void 0},g)),i}return r}function fV(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,i=nM(o,e),s=t;function r(){s=t}function n(){for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];return s?(s-=1,o.apply(this,l)):i.apply(this,l)}return n.clearHits=r,n}function mh(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,i;function s(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t&&clearTimeout(t),t=setTimeout(()=>{i=o.apply(this,n)},e),i}return s}function mV(){for(var o=arguments.length,e=new Array(o),t=0;t<o;t++)e[t]=arguments[t];let[i,...s]=e;return function(){for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return pt(s,(c,u)=>u(c),i.apply(this,a))}}function ph(o){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return o.apply(this,t.concat(n))}}function tw(o){let e=o.length;function t(i){return function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];let l=i.concat(n),c;return l.length>=e?c=o.apply(this,l):c=t(l),c}}return t([])}function pV(o){let e=o.length;function t(i){return function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];let l=i.concat(n.reverse()),c;return l.length>=e?c=o.apply(this,l):c=t(l),c}}return t([])}function fa(o,e,t,i,s,r,n,a){return Pe(a)?o.call(e,t,i,s,r,n,a):Pe(n)?o.call(e,t,i,s,r,n):Pe(r)?o.call(e,t,i,s,r):Pe(s)?o.call(e,t,i,s):Pe(i)?o.call(e,t,i):Pe(t)?o.call(e,t):o.call(e)}var lw={};Ri(lw,{isChrome:()=>wh,isChromeWebKit:()=>rw,isEdge:()=>aw,isEdgeWebKit:()=>_V,isFirefox:()=>yh,isFirefoxWebKit:()=>nw,isIOS:()=>vh,isIpadOS:()=>bh,isLinuxOS:()=>NV,isMacOS:()=>pa,isMobileBrowser:()=>fi,isSafari:()=>IV,isWindowsOS:()=>um,setBrowserMeta:()=>SM,setPlatformMeta:()=>EM});var ow={};Ri(ow,{clone:()=>Ft,createObjectPropListener:()=>_s,deepClone:()=>Xt,deepExtend:()=>cr,deepObjectSize:()=>an,defineGetter:()=>hi,duckSchema:()=>hr,extend:()=>Ct,getProperty:()=>sw,hasOwnProperty:()=>St,inherit:()=>Is,isObject:()=>$e,isObjectEqual:()=>nn,mixin:()=>et,objectEach:()=>ze,setProperty:()=>Ch});var yV=rr(),yM=oa(),vM=ih(),vV=ql(),gh=yi(),bM=Vi(),dM=di(),fM=Wf(),xM=im(),bV=uM(),xV=Vf(),SV=String,lr=yM("JSON","stringify"),cm=gh(/./.exec),mM=gh("".charAt),EV=gh("".charCodeAt),TV=gh("".replace),RV=gh(1 .toString),MV=/[\uD800-\uDFFF]/g,pM=/^[\uD800-\uDBFF]$/,gM=/^[\uDC00-\uDFFF]$/,CM=!xV||bM(function(){var o=yM("Symbol")("stringify detection");return lr([o])!=="[null]"||lr({a:o})!=="{}"||lr(Object(o))!=="{}"}),wM=bM(function(){return lr("\uDF06\uD834")!=='"\\udf06\\ud834"'||lr("\uDEAD")!=='"\\udead"'}),OV=function(o,e){var t=xM(arguments),i=bV(e);if(!(!dM(i)&&(o===void 0||fM(o))))return t[1]=function(s,r){if(dM(i)&&(r=vV(i,this,SV(s),r)),!fM(r))return r},vM(lr,null,t)},AV=function(o,e,t){var i=mM(t,e-1),s=mM(t,e+1);return cm(pM,o)&&!cm(gM,s)||cm(gM,o)&&!cm(pM,i)?"\\u"+RV(EV(o,0),16):o};lr&&yV({target:"JSON",stat:!0,arity:3,forced:CM||wM},{stringify:function(e,t,i){var s=xM(arguments),r=vM(CM?OV:lr,null,s);return wM&&typeof r=="string"?TV(r,MV,AV):r}});function hr(o){let e;return Array.isArray(o)?e=o.length?new Array(o.length).fill(null):[]:(e={},ze(o,(t,i)=>{i!=="__children"&&(t&&typeof t=="object"&&!Array.isArray(t)?e[i]=hr(t):Array.isArray(t)?t.length&&typeof t[0]=="object"&&!Array.isArray(t[0])?e[i]=[hr(t[0])]:e[i]=[]:e[i]=null)})),e}function Is(o,e){return e.prototype.constructor=e,o.prototype=new e,o.prototype.constructor=o,o}function Ct(o,e,t){let i=Array.isArray(t);return ze(e,(s,r)=>{(i===!1||t.includes(r))&&(o[r]=s)}),o}function cr(o,e){ze(e,(t,i)=>{e[i]&&typeof e[i]=="object"?(o[i]||(Array.isArray(e[i])?o[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?o[i]=e[i]:o[i]={}),cr(o[i],e[i])):o[i]=e[i]})}function Xt(o){return typeof o=="object"?JSON.parse(JSON.stringify(o)):o}function Ft(o){let e={};return ze(o,(t,i)=>{e[i]=t}),e}function et(o){o.MIXINS||(o.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return we(t,s=>{o.MIXINS.push(s.MIXIN_NAME),ze(s,(r,n)=>{if(o.prototype[n]!==void 0)throw new Error(`Mixin conflict. Property '${n}' already exist and cannot be overwritten.`);if(typeof r=="function")o.prototype[n]=r;else{let a=function(u,g){let p=`_${u}`,C=y=>{let S=y;return(Array.isArray(S)||$e(S))&&(S=Xt(S)),S};return function(){return this[p]===void 0&&(this[p]=C(g)),this[p]}},l=function(u){let g=`_${u}`;return function(p){this[g]=p}};Object.defineProperty(o.prototype,n,{get:a(n,r),set:l(n),configurable:!0})}})}),o}function nn(o,e){return JSON.stringify(o)===JSON.stringify(e)}function $e(o){return Object.prototype.toString.call(o)==="[object Object]"}function hi(o,e,t,i){i.value=t,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(o,e,i)}function ze(o,e){for(let t in o)if((!o.hasOwnProperty||o.hasOwnProperty&&Object.prototype.hasOwnProperty.call(o,t))&&e(o[t],t,o)===!1)break;return o}function sw(o,e){let t=e.split("."),i=o;return ze(t,s=>{if(i=i[s],i===void 0)return i=void 0,!1}),i}function Ch(o,e,t){let i=e.split("."),s=o;i.forEach((r,n)=>{n!==i.length-1?(St(s,r)||(s[r]={}),s=s[r]):s[r]=t})}function an(o){if(!$e(o))return 0;let e=function(t){let i=0;return $e(t)?ze(t,(s,r)=>{r!=="__children"&&(i+=e(s))}):i+=1,i};return e(o)}function _s(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",t=`_${e}`,i={_touched:!1,[t]:o,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[t]},set(s){this._touched=!0,this[t]=s},enumerable:!0,configurable:!0}),i}function St(o,e){return Object.prototype.hasOwnProperty.call(o,e)}var hs=o=>{let e={value:!1};return e.test=(t,i)=>{e.value=o(t,i)},e},Eo={chrome:hs((o,e)=>/Chrome/.test(o)&&/Google/.test(e)),chromeWebKit:hs(o=>/CriOS/.test(o)),edge:hs(o=>/Edge/.test(o)),edgeWebKit:hs(o=>/EdgiOS/.test(o)),firefox:hs(o=>/Firefox/.test(o)),firefoxWebKit:hs(o=>/FxiOS/.test(o)),mobile:hs(o=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(o)),safari:hs((o,e)=>/Safari/.test(o)&&/Apple Computer/.test(e))},ma={mac:hs(o=>/^Mac/.test(o)),win:hs(o=>/^Win/.test(o)),linux:hs(o=>/^Linux/.test(o)),ios:hs(o=>/iPhone|iPad|iPod/i.test(o))};function SM(){let{userAgent:o=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ze(Eo,t=>{let{test:i}=t;return void i(o,e)})}function EM(){let{platform:o=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ze(ma,e=>{let{test:t}=e;return void t(o)})}SM();EM();function wh(){return Eo.chrome.value}function rw(){return Eo.chromeWebKit.value}function yh(){return Eo.firefox.value}function nw(){return Eo.firefoxWebKit.value}function IV(){return Eo.safari.value}function aw(){return Eo.edge.value}function _V(){return Eo.edgeWebKit.value}function fi(){return Eo.mobile.value}function vh(){return ma.ios.value}function bh(){let{maxTouchPoints:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return o>2&&ma.mac.value}function um(){return ma.win.value}function pa(){return ma.mac.value}function NV(){return ma.linux.value}var uw={};Ri(uw,{KEY_CODES:()=>Ue,isCtrlKey:()=>LV,isCtrlMetaKey:()=>cw,isFunctionKey:()=>xh,isKey:()=>Us,isPrintableChar:()=>hw});var Ue={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:yh()?182:174,AUDIO_MUTE:yh()?181:173,AUDIO_UP:yh()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},PV=[Ue.ALT,Ue.ARROW_DOWN,Ue.ARROW_LEFT,Ue.ARROW_RIGHT,Ue.ARROW_UP,Ue.AUDIO_DOWN,Ue.AUDIO_MUTE,Ue.AUDIO_UP,Ue.BACKSPACE,Ue.CAPS_LOCK,Ue.DELETE,Ue.END,Ue.ENTER,Ue.ESCAPE,Ue.F1,Ue.F2,Ue.F3,Ue.F4,Ue.F5,Ue.F6,Ue.F7,Ue.F8,Ue.F9,Ue.F10,Ue.F11,Ue.F12,Ue.F13,Ue.F14,Ue.F15,Ue.F16,Ue.F17,Ue.F18,Ue.F19,Ue.HOME,Ue.INSERT,Ue.MEDIA_NEXT,Ue.MEDIA_PLAY_PAUSE,Ue.MEDIA_PREV,Ue.MEDIA_STOP,Ue.NULL,Ue.NUM_LOCK,Ue.PAGE_DOWN,Ue.PAGE_UP,Ue.PAUSE,Ue.SCROLL_LOCK,Ue.SHIFT,Ue.TAB];function hw(o){return o===32||o>=48&&o<=57||o>=96&&o<=111||o>=186&&o<=192||o>=219&&o<=222||o>=226||o>=65&&o<=90}function xh(o){return PV.includes(o)}function LV(o){let e=[];return pa()?e.push(Ue.COMMAND_LEFT,Ue.COMMAND_RIGHT,Ue.COMMAND_FIREFOX):e.push(Ue.CONTROL),e.includes(o)}function cw(o){return[Ue.CONTROL,Ue.COMMAND_LEFT,Ue.COMMAND_RIGHT,Ue.COMMAND_FIREFOX].includes(o)}function Us(o,e){let t=e.split("|"),i=!1;return we(t,s=>{if(o===Ue[s])return i=!0,!1}),i}var dw={};Ri(dw,{isImmediatePropagationStopped:()=>To,isLeftClick:()=>ln,isRightClick:()=>Ni,stopImmediatePropagation:()=>ni});function ni(o){o.isImmediatePropagationEnabled=!1,o.cancelBubble=!0}function To(o){return o.isImmediatePropagationEnabled===!1}function Ni(o){return o.button===2}function ln(o){return o.button===0}function mt(){Pe(console)&&console.warn(...arguments)}function ga(){Pe(console)&&console.error(...arguments)}var Ca=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],DV=st`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,fw=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),mw=new Map([]),dm=class{static getSingleton(){return HV()}constructor(){this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){let e=Object.create(null);return we(Ca,t=>e[t]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(t))we(t,s=>this.add(e,s,i));else{fw.has(e)&&mt(uh(DV,{hookName:e,removedInVersion:fw.get(e)})),mw.has(e)&&mt(mw.get(e));let s=this.getBucket(i);if(typeof s[e]>"u"&&(this.register(e),s[e]=[]),t.skip=!1,s[e].indexOf(t)===-1){let r=!1;t.initialHook&&we(s[e],(n,a)=>{if(n.initialHook)return s[e][a]=t,r=!0,!1}),r||s[e].push(t)}}return this}once(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(t)?we(t,s=>this.once(e,s,i)):(t.runOnce=!0,this.add(e,t,i))}remove(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=this.getBucket(i);return typeof s[e]<"u"&&s[e].indexOf(t)>=0?(t.skip=!0,!0):!1}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=this.getBucket(t);return!!(i[e]!==void 0&&i[e].length)}run(e,t,i,s,r,n,a,l){{let c=this.globalBucket[t],u=c?c.length:0,g=0;if(u)for(;g<u;){if(!c[g]||c[g].skip){g+=1;continue}let p=fa(c[g],e,i,s,r,n,a,l);p!==void 0&&(i=p),c[g]&&c[g].runOnce&&this.remove(t,c[g]),g+=1}}{let c=this.getBucket(e)[t],u=c?c.length:0,g=0;if(u)for(;g<u;){if(!c[g]||c[g].skip){g+=1;continue}let p=fa(c[g],e,i,s,r,n,a,l);p!==void 0&&(i=p),c[g]&&c[g].runOnce&&this.remove(t,c[g],e),g+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ze(this.getBucket(e),(t,i,s)=>s[i].length=0)}register(e){this.isRegistered(e)||Ca.push(e)}deregister(e){this.isRegistered(e)&&Ca.splice(Ca.indexOf(e),1)}isDeprecated(e){return mw.has(e)||fw.has(e)}isRegistered(e){return Ca.indexOf(e)>=0}getRegistered(){return Ca}},kV=new dm;function HV(){return kV}var He=dm;var pw=new Map;function qt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";pw.has(o)||pw.set(o,new Map);let e=pw.get(o);function t(a,l){e.set(a,l)}function i(a){return e.get(a)}function s(a){return e.has(a)}function r(){return[...e.keys()]}function n(){return[...e.values()]}return{register:t,getItem:i,hasItem:s,getNames:r,getValues:n}}var gw=new WeakMap,{register:FV,getItem:TM,hasItem:Cw,getNames:RM,getValues:RX}=qt("editors");function BV(o){let e={},t=o;this.getConstructor=function(){return o},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new t(i)),e[i.guid]},He.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function fm(o,e){let t;if(typeof o=="function")gw.get(o)||gi(null,o),t=gw.get(o);else if(typeof o=="string")t=TM(o);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error(`No editor registered under name "${o}"`);return t.getInstance(e)}function wa(o){if(typeof o=="function")return o;if(!Cw(o))throw Error(`No registered editor found under "${o}" name`);return TM(o).getConstructor()}function gi(o,e){o&&typeof o!="string"&&(e=o,o=e.EDITOR_TYPE);let t=new BV(e);typeof o=="string"&&FV(o,t),gw.set(e,t)}var mm=0,ww=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function r(n){i.call(this,VV(n))}return this.context.eventListeners.push({element:e,event:t,callback:i,callbackProxy:r,options:s,eventManager:this}),e.addEventListener(t,r,s),mm+=1,()=>{this.removeEventListener(e,t,i)}}removeEventListener(e,t,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,r=this.context.eventListeners.length,n;for(;r;)if(r-=1,n=this.context.eventListeners[r],n.event===t&&n.element===e){if(i&&i!==n.callback||s&&n.eventManager!==this)continue;this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),mm-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;let i=this.context.eventListeners[t];e&&i.eventManager!==this||(this.context.eventListeners.splice(t,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),mm-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let i=e.document,s=e;i||(i=e.ownerDocument?e.ownerDocument:e,s=i.defaultView);let r={bubbles:!0,cancelable:t!=="mousemove",view:s,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},n;i.createEvent?(n=i.createEvent("MouseEvents"),n.initMouseEvent(t,r.bubbles,r.cancelable,r.view,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget||i.body.parentNode)):n=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(n):e.fireEvent(`on${t}`,n)}};function VV(o){let e=o.stopImmediatePropagation;return o.stopImmediatePropagation=function(){e.apply(this),ni(this)},o}var tt=ww;function MM(){return mm}var hn="editorManager.navigation",cn="editorManager.handlingEditor",Sh=class{constructor(e,t,i){this.instance=e,this.tableMeta=t,this.selection=i,this.eventManager=new tt(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.getShortcutManager().addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",r=>this.onAfterDocumentKeyDown(r)),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",r=>{!this.destroyed&&this.instance.isListening()&&this.openEditor("",r)}),this.instance.view._wt.update("onCellDblClick",(r,n,a)=>this.onCellDblClick(r,n,a))}registerShortcuts(){let e=this.instance.getShortcutManager(),t=e.getContext("grid"),i=e.getContext("editor"),s={group:cn};i.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(r,n)=>{this.closeEditorAndSaveChanges(e.isCtrlPressed()),this.moveSelectionAfterEnter(n.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>{this.closeEditorAndRestoreOriginalValue(e.isCtrlPressed()),this.activeEditor.focus()}}],s),t.addShortcuts([{keys:[["F2"]],callback:r=>{this.openEditor(null,r,!0)}},{keys:[["Backspace"],["Delete"]],callback:()=>{this.instance.emptySelectedCells(),this.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:(r,n)=>{this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.openEditor(null,r,!0):this.moveSelectionAfterEnter(n.includes("shift")),ni(r)}}],{...s,runOnlyIf:()=>Pe(this.instance.getSelected())})}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,l=>{l&&this.prepareEditor()});return}let{row:e,col:t}=this.instance.getSelectedRangeLast().highlight,i=this.instance.runHooks("modifyGetCellCoords",e,t),s=e,r=t;Array.isArray(i)&&([s,r]=i),this.cellProperties=this.instance.getCellMeta(s,r);let{activeElement:n}=this.instance.rootDocument;if(n&&da(n)&&n.blur(),!this.isCellEditable()){this.clearActiveEditor();return}let a=this.instance.getCell(e,t,!0);if(a){let l=this.instance.getCellEditor(this.cellProperties),c=this.instance.colToProp(r),u=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(s),r);this.activeEditor=fm(l,this.instance),this.activeEditor.prepare(e,t,c,a,u,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){let{row:s,col:r}=this.instance.getSelectedRangeLast().highlight,n=this.instance.rowIndexMapper.getRenderableFromVisualIndex(s),a=this.instance.columnIndexMapper.getRenderableFromVisualIndex(r);this.instance.view.scrollViewport(this.instance._createCellCoords(n,a)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,i){this.activeEditor?this.activeEditor.finishEditing(e,t,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){let e=this.instance.getCellEditor(this.cellProperties),{row:t,col:i}=this.instance.getSelectedRangeLast().highlight,{rowIndexMapper:s,columnIndexMapper:r}=this.instance,n=s.isHidden(this.instance.toPhysicalRow(t))||r.isHidden(this.instance.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!e||n)}moveSelectionAfterEnter(e){let t=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}onAfterDocumentKeyDown(e){if(!this.instance.isListening())return;let{keyCode:t}=e;if(!this.selection.isSelected())return;let i=(e.ctrlKey||e.metaKey)&&!e.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!xh(t)&&!cw(t)&&!i&&!this.isEditorOpened()){let r=this.instance.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>Pe(this.instance.getSelected()),group:hn};r.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.instance.selection.transformStart(0,-1*this.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.instance.selection.transformStart(0,this.instance.getDirectionFactor())}}],n),this.openEditor("",e)}}onCellDblClick(e,t,i){i.nodeName==="TD"&&this.openEditor(null,e,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}},OM=new WeakMap;Sh.getInstance=function(o,e,t){let i=OM.get(o);return i||(i=new Sh(o,e,t),OM.set(o,i)),i};var AM=Sh;var vw={};Ri(vw,{_dataToHTML:()=>gm,htmlToGridSettings:()=>yw,instanceToHTML:()=>pm});var IM={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},WV=new RegExp(Object.keys(IM).map(o=>`(${o})`).join("|"),"gi");function UV(o){return(o&&o.nodeName||"")==="TABLE"}function pm(o){let e=o.hasColHeaders(),t=o.hasRowHeaders(),i=[e?-1:0,t?-1:0,o.countRows()-1,o.countCols()-1],s=o.getData(...i),r=s.length,n=r>0?s[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],u=t?1:0,g=e?1:0;for(let p=0;p<r;p+=1){let C=e&&p===0,y=[];for(let O=0;O<n;O+=1){let M=!C&&t&&O===0,_="";if(C)_=`<th>${o.getColHeader(O-u)}</th>`;else if(M)_=`<th>${o.getRowHeader(p-g)}</th>`;else{let N=s[p][O],{hidden:E,rowspan:k,colspan:ie}=o.getCellMeta(p-g,O-u);if(!E){let $=[];if(k&&$.push(`rowspan="${k}"`),ie&&$.push(`colspan="${ie}"`),At(N))_=`<td ${$.join(" ")}></td>`;else{let H=N.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");_=`<td ${$.join(" ")}>${H}</td>`}}}y.push(_)}let S=["<tr>",...y,"</tr>"].join("");C?l.splice(1,0,S):c.splice(-1,0,S)}return a.splice(1,0,l.join(""),c.join("")),a.join("")}function gm(o){let e=o.length,t=["<table>"];for(let i=0;i<e;i+=1){let s=o[i],r=s.length,n=[];i===0&&t.push("<tbody>");for(let a=0;a<r;a+=1){let l=s[a],c=At(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,u=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(u.length-1)} </span>`).replace(/\t/gi,"&#9;");n.push(`<td>${c}</td>`)}t.push("<tr>",...n,"</tr>"),i+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function yw(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,t={},i=e.createDocumentFragment(),s=e.createElement("div");i.appendChild(s);let r=o;if(typeof r=="string"){let N=r.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,E=>{let k=E.match(/<td\b[^>]*?>/g)[0],ie=E.substring(k.length,E.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${k}${ie}</td>`});s.insertAdjacentHTML("afterbegin",`${N}`),r=s.querySelector("table")}if(!r||!UV(r))return;let n=s.querySelector('meta[name$="enerator"]'),a=r.querySelector("tbody th")!==null,l=r.querySelector("tr"),c=l?Array.from(l.cells).reduce((N,E)=>N+E.colSpan,0)-(a?1:0):0,u=r.tFoot&&Array.from(r.tFoot.rows)||[],g=[],p=!1,C=0,y=0;if(r.tHead){let N=Array.from(r.tHead.rows).filter(E=>{let k=E.querySelector("td")!==null;return k&&g.push(E),!k});C=N.length,p=C>0,C>1?t.nestedHeaders=Array.from(N).reduce((E,k)=>{let ie=Array.from(k.cells).reduce(($,H,Q)=>{if(a&&Q===0)return $;let{colSpan:Y,innerHTML:P}=H,j=Y>1?{label:P,colspan:Y}:P;return $.push(j),$},[]);return E.push(ie),E},[]):p&&(t.colHeaders=Array.from(N[0].children).reduce((E,k,ie)=>(a&&ie===0||E.push(k.innerHTML),E),[]))}g.length&&(t.fixedRowsTop=g.length),u.length&&(t.fixedRowsBottom=u.length);let S=[...g,...Array.from(r.tBodies).reduce((N,E)=>(N.push(...Array.from(E.rows)),N),[]),...u];y=S.length;let O=new Array(y);for(let N=0;N<y;N++)O[N]=new Array(c);let M=[],_=[];for(let N=0;N<y;N++){let E=S[N],k=Array.from(E.cells),ie=k.length;for(let $=0;$<ie;$++){let H=k[$],{nodeName:Q,innerHTML:Y,rowSpan:P,colSpan:j}=H,A=O[N].findIndex(v=>v===void 0);if(Q==="TD"){if(P>1||j>1){for(let w=N;w<N+P;w++)if(w<y)for(let b=A;b<A+j;b++)O[w][b]=null;let R=H.getAttribute("style");R&&R.includes("mso-ignore:colspan")||M.push({col:A,row:N,rowspan:P,colspan:j})}let v="";n&&/excel/gi.test(n.content)?v=Y.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):v=Y.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),O[N][A]=v.replace(WV,R=>IM[R])}else _.push(Y)}}return M.length&&(t.mergeCells=M),_.length&&(t.rowHeaders=_),O.length&&(t.data=O),t}var xw={};Ri(xw,{isNumeric:()=>ii,isNumericLike:()=>bw,rangeEach:()=>ke,rangeEachReverse:()=>ya,valueAccordingPercent:()=>Eh});function ii(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=typeof o;if(t==="number")return!isNaN(o)&&isFinite(o);if(t==="string"){if(o.length===0)return!1;if(o.length===1)return/\d/.test(o);let i=Array.from(new Set([".",...e])).map(s=>`\\${s}`).join("|");return new RegExp(`^[+-]?\\s*(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(o.trim())}else if(t==="object")return!!o&&typeof o.valueOf()=="number"&&!(o instanceof Date);return!1}function bw(o){return ii(o,[","])}function ke(o,e,t){let i=-1;for(typeof e=="function"?(t=e,e=o):i=o-1;++i<=e&&t(i)!==!1;);}function ya(o,e,t){let i=o+1;for(typeof e=="function"&&(t=e,e=0);--i>=e&&t(i)!==!1;);}function Eh(o,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(o*e/100,10)}var Sw="asc",YV="desc",_M=new Map([[Sw,[-1,1]],[YV,[1,-1]]]),jV=o=>`The priority '${o}' is already declared in a map.`,GV=o=>`The priority '${o}' is not a number.`;function NM(){let{errorPriorityExists:o,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=new Map;o=ht(o)?o:jV,e=ht(e)?e:GV;function i(r,n){if(!ii(r))throw new Error(e(r));if(t.has(r))throw new Error(o(r));t.set(r,n)}function s(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Sw,[n,a]=_M.get(r)||_M.get(Sw);return[...t].sort((l,c)=>l[0]<c[0]?n:a).map(l=>l[1])}return{addItem:i,getItems:s}}var zV=o=>`The id '${o}' is already declared in a map.`;function ur(){let{errorIdExists:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=new Map;o=ht(o)?o:zV;function t(c,u){if(l(c))throw new Error(o(c));e.set(c,u)}function i(c){return e.delete(c)}function s(){e.clear()}function r(c){let[u]=a().find(g=>{let[p,C]=g;return c===C?p:!1})||[null];return u}function n(c){return e.get(c)}function a(){return[...e]}function l(c){return e.has(c)}return{addItem:t,clear:s,getId:r,getItem:n,getItems:a,hasItem:l,removeItem:i}}var $V=o=>`'${o}' value is already declared in a unique set.`;function PM(){let{errorItemExists:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=new Set;o=ht(o)?o:$V;function t(r){if(e.has(r))throw new Error(o(r));e.add(r)}function i(){return[...e]}function s(){e.clear()}return{addItem:t,clear:s,getItems:i}}var Tw=o=>`There is already registered "${o}" plugin.`,XV=o=>`There is already registered plugin on priority "${o}".`,qV=o=>`The priority "${o}" is not a number.`,LM=NM({errorPriorityExists:XV,errorPriorityNaN:qV}),DM=PM({errorItemExists:Tw}),Ew=ur({errorIdExists:Tw});function va(){return[...LM.getItems(),...DM.getItems()]}function un(o){let e=$t(o);return Ew.getItem(e)}function kM(o){return!!un(o)}function yt(o,e,t){[o,e,t]=ZV(o,e,t),un(o)===void 0&&KV(o,e,t)}function KV(o,e,t){let i=$t(o);if(Ew.hasItem(i))throw new Error(Tw(i));t===void 0?DM.addItem(i):LM.addItem(t,i),Ew.addItem(i,e)}function ZV(o,e,t){return typeof o=="function"&&(e=o,o=e.PLUGIN_KEY,t=e.PLUGIN_PRIORITY),[o,e,t]}var{register:QV,getItem:JV,hasItem:Rw,getNames:HM,getValues:oq}=qt("renderers");function ba(o){if(typeof o=="function")return o;if(!Rw(o))throw Error(`No registered renderer found under "${o}" name`);return JV(o)}function Gi(o,e){typeof o!="string"&&(e=o,o=e.RENDERER_TYPE),QV(o,e)}var{register:eW,getItem:tW,hasItem:Mw,getNames:FM,getValues:lq}=qt("validators");function Th(o){if(typeof o=="function")return o;if(!Mw(o))throw Error(`No registered validator found under "${o}" name`);return tW(o)}function Ro(o,e){typeof o!="string"&&(e=o,o=e.VALIDATOR_TYPE),eW(o,e)}var vW=rr(),bW=Zl(),xW=eh(),SW=Qf(),EW=QM();vW({target:"Array",proto:!0},{at:function(e){var t=bW(this),i=xW(t),s=SW(e),r=s>=0?s:i+s;return r<0||r>=i?void 0:t[r]}});EW("at");var xa=new WeakMap,Pw=class o{static get DEFAULT_WIDTH(){return 50}constructor(){let{viewportSize:e,scrollOffset:t,totalItems:i,itemSizeFn:s,overrideFn:r,calculationType:n,stretchMode:a,stretchingItemWidthFn:l=u=>u,inlineStartOffset:c}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};xa.set(this,{viewportWidth:e,scrollOffset:t,totalColumns:i,columnWidthFn:s,overrideFn:r,calculationType:n,stretchingColumnWidthFn:l,inlineStartOffset:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=a,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}calculate(){let e=0,t=!0,i=[],s,r=0,n=0,a=xa.get(this),l=a.calculationType,c=a.overrideFn,u=a.scrollOffset,g=Math.max(a.scrollOffset,0),p=a.totalColumns,C=a.viewportWidth,y=g>0?C+1:C;for(let _=0;_<p;_++)if(s=this._getColumnWidth(_),e<=g&&l!==2&&(this.startColumn=_,r=s),e>=g&&e+(l===2?s:0)<=g+y&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=_,r=s),this.endColumn=_),i.push(e),e+=s,n=s,l!==2&&(this.endColumn=_),e>=g+C){t=!1;break}let S=u+C-y,O=l===2?0:n,M=l===2?r:0;if(S<-1*a.inlineStartOffset||u>i.at(-1)+O||-1*a.scrollOffset-a.viewportWidth>-1*M?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===p-1&&t)for(this.startColumn=this.endColumn;this.startColumn>0;){let _=i[this.endColumn]+s-i[this.startColumn-1];if((_<=C||l!==2)&&(this.startColumn-=1),_>C)break}l===1&&this.startColumn!==null&&c&&c(this),this.startPosition=i[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),p<this.endColumn&&(this.endColumn=p-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(this.stretch==="none")return;let t=e;this.totalTargetWidth=t;let i=xa.get(this),s=i.totalColumns,r=0;for(let a=0;a<s;a++){let l=this._getColumnWidth(a),c=i.stretchingColumnWidthFn(void 0,a);typeof c=="number"?t-=c:r+=l}let n=t-r;if(this.stretch==="all"&&n>0)this.stretchAllRatio=t/r,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&t!==1/0){let a=this._getColumnWidth(s-1),l=n+a;this.stretchLastWidth=l>=0?l:a}}getStretchedColumnWidth(e,t){let i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(e,t):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(e)),i}_getStretchedAllColumnWidth(e,t){let i=0,s=xa.get(this),r=s.totalColumns;if(!this.stretchAllColumnsWidth[e]){let n=Math.round(t*this.stretchAllRatio),a=s.stretchingColumnWidthFn(n,e);a===void 0?this.stretchAllColumnsWidth[e]=n:this.stretchAllColumnsWidth[e]=isNaN(a)?this._getColumnWidth(e):a}if(this.stretchAllColumnsWidth.length===r&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let n=0;n<this.stretchAllColumnsWidth.length;n++)i+=this.stretchAllColumnsWidth[n];i!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-i)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){let i=xa.get(this).totalColumns;return e===i-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=xa.get(this).columnWidthFn(e);return isNaN(t)&&(t=o.DEFAULT_WIDTH),t}},dr=Pw;var JM=new WeakMap,Lw=class o{static get DEFAULT_HEIGHT(){return 23}constructor(){let{viewportSize:e,scrollOffset:t,totalItems:i,itemSizeFn:s,overrideFn:r,calculationType:n,scrollbarHeight:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};JM.set(this,{viewportHeight:e,scrollOffset:t,totalRows:i,rowHeightFn:s,overrideFn:r,calculationType:n,horizontalScrollbarHeight:a}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}calculate(){let e=JM.get(this),t=e.calculationType,i=e.overrideFn,s=e.rowHeightFn,r=e.scrollOffset,n=Math.max(e.scrollOffset,0),a=e.totalRows,l=e.viewportHeight,c=e.horizontalScrollbarHeight||0,u=0,g=!0,p=[],C,y=0,S=0;for(let N=0;N<a;N++)if(C=s(N),isNaN(C)&&(C=o.DEFAULT_HEIGHT),u<=n&&t!==2&&(this.startRow=N,y=C),u>=n&&u+(t===2?C:0)<=n+l-c&&(this.startRow===null&&(this.startRow=N,y=C),this.endRow=N),p.push(u),u+=C,S=C,t!==2&&(this.endRow=N),u>=n+l-c){g=!1;break}let O=r+l-c,M=t===2?y:0,_=t===2?0:S;if(O<M||r>p.at(-1)+_?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===a-1&&g)for(this.startRow=this.endRow;this.startRow>0;){let N=p[this.endRow]+C-p[this.startRow-1];if((N<=l-c||t!==2)&&(this.startRow-=1),N>=l-c)break}t===1&&this.startRow!==null&&i&&i(this),this.startPosition=p[this.startRow],this.startPosition===void 0&&(this.startPosition=null),a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}},Sa=Lw;function TW(o,e,t){RW(o,e),e.set(o,t)}function RW(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eO(o,e,t){return e=MW(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function MW(o){var e=OW(o,"string");return typeof e=="symbol"?e:String(e)}function OW(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}function Rh(o,e){var t=tO(o,e,"get");return AW(o,t)}function AW(o,e){return e.get?e.get.call(o):e.value}function IW(o,e,t){var i=tO(o,e,"set");return _W(o,i,t),t}function tO(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function _W(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var fn=new WeakMap,Dw=class o{constructor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;eO(this,"row",null),eO(this,"col",null),TW(this,fn,{writable:!0,value:!1}),IW(this,fn,i),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isSouthEastOf(e){return this.row>=e.row&&(Rh(this,fn)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Rh(this,fn)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Rh(this,fn)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Rh(this,fn)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}clone(){return new o(this.row,this.col,Rh(this,fn))}toObject(){return{row:this.row,col:this.col}}},Mo=Dw;function NW(o,e,t){PW(o,e),e.set(o,t)}function PW(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kw(o,e,t){return e=LW(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function LW(o){var e=DW(o,"string");return typeof e=="symbol"?e:String(e)}function DW(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}function Ys(o,e){var t=iO(o,e,"get");return kW(o,t)}function kW(o,e){return e.get?e.get.call(o):e.value}function HW(o,e,t){var i=iO(o,e,"set");return FW(o,i,t),t}function iO(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function FW(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var cs=new WeakMap,Hw=class o{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;kw(this,"highlight",null),kw(this,"from",null),kw(this,"to",null),NW(this,cs,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=t.clone(),this.to=i.clone(),HW(this,cs,s)}setHighlight(e){return this.highlight=e.clone().normalize(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;let e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;let e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){let{row:t,col:i}=e,s=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return s.row<=t&&r.row>=t&&s.col<=i&&r.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){let t=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<t.row||e.col<t.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;let t=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),s=this.getDirection(),r=e.getOuterTopStartCorner(),n=e.getOuterBottomEndCorner(),a=Math.min(t.row,r.row),l=Math.min(t.col,r.col),c=Math.max(i.row,n.row),u=Math.max(i.col,n.col),g=this._createCellCoords(a,l),p=this._createCellCoords(c,u);return this.from=g,this.to=p,this.setDirection(s),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break;default:break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Ys(this,cs)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Ys(this,cs)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Ys(this,cs)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Ys(this,cs)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Ys(this,cs)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Ys(this,cs)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Ys(this,cs)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Ys(this,cs)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,t){return t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(t.to.row,t.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,t){if(!(e instanceof Mo))return!1;if(t){let{from:i,to:s}=t;if(t.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(i.row,s.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(s.row,i.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(s.row,s.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];let t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},s=[];return t.top===i.top&&s.push("top"),t.right===i.right&&s.push("right"),t.bottom===i.bottom&&s.push("bottom"),t.left===i.left&&s.push("left"),s}getInner(){let e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),i=[];for(let s=e.row;s<=t.row;s++)for(let r=e.col;r<=t.col;r++)!(this.from.row===s&&this.from.col===r)&&!(this.to.row===s&&this.to.col===r)&&i.push(this._createCellCoords(s,r));return i}getAll(){let e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),i=[];for(let s=e.row;s<=t.row;s++)for(let r=e.col;r<=t.col;r++)e.row===s&&e.col===r?i.push(e):t.row===s&&t.col===r?i.push(t):i.push(this._createCellCoords(s,r));return i}forAll(e){let t=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let s=t.row;s<=i.row;s++)for(let r=t.col;r<=i.col;r++)if(e(s,r)===!1)return}clone(){return new o(this.highlight,this.from,this.to,Ys(this,cs))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new Mo(e,t,Ys(this,cs))}},fr=Hw;var Bw={};Ri(Bw,{cancelAnimationFrame:()=>pn,getComparisonFunction:()=>Fw,isTouchSupported:()=>Mh,requestAnimationFrame:()=>mn});function mn(o){return window.requestAnimationFrame(o)}function pn(o){window.cancelAnimationFrame(o)}function Mh(){return"ontouchstart"in window}var Ea;function Fw(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ea||(typeof Intl=="object"?Ea=new Intl.Collator(o,e).compare:typeof String.prototype.localeCompare=="function"?Ea=(t,i)=>`${t}`.localeCompare(i):Ea=(t,i)=>t===i?0:t>i?-1:1,Ea)}var Ta=new WeakMap,Vw=class{constructor(e,t,i,s,r,n){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;this.wtSettings=i,this.domBindings=t,this.wtTable=r,this.selections=n,this.parent=a,this.eventManager=s,this.facadeGetter=e,Ta.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}registerEvents(){this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",i=>this.onContextMenu(i)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",i=>this.onMouseOver(i)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",i=>this.onMouseOut(i));let e=()=>{this.eventManager.addEventListener(this.wtTable.holder,"touchstart",i=>this.onTouchStart(i)),this.eventManager.addEventListener(this.wtTable.holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),this.eventManager.addEventListener(this.wtTable.holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||this.wtSettings.getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,this.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},t=()=>{this.eventManager.addEventListener(this.wtTable.holder,"mouseup",i=>this.onMouseUp(i)),this.eventManager.addEventListener(this.wtTable.holder,"mousedown",i=>this.onMouseDown(i))};fi()?e():(Mh()&&e(),t())}selectedCellWasTouched(e){let t=Ta.get(this),s=this.parentCell(e).coords;if(t.selectedCellBeforeTouchEnd&&s){let[r,n]=[s.row,t.selectedCellBeforeTouchEnd.from.row],[a,l]=[s.col,t.selectedCellBeforeTouchEnd.from.col];return r===n&&a===l}return!1}parentCell(e){let t={},i=this.wtTable.TABLE,s=ca(e,["TD","TH"],i);return s?(t.coords=this.wtTable.getCoords(s),t.TD=s):Ve(e,"wtBorder")&&Ve(e,"current")?(t.coords=this.selections.getCell().cellRange.highlight,t.TD=this.wtTable.getCell(t.coords)):Ve(e,"wtBorder")&&Ve(e,"area")&&this.selections.createOrGetArea().cellRange&&(t.coords=this.selections.createOrGetArea().cellRange.to,t.TD=this.wtTable.getCell(t.coords)),t}onMouseDown(e){let t=Ta.get(this),i=this.domBindings.rootDocument.activeElement,s=ph(zC,e.target),r=e.target;if(r===i||s(0)===i||s(1)===i)return;let n=this.parentCell(r);Ve(r,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,r):n.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,n.coords,n.TD),(e.button===0||this.touchApplied)&&n.TD&&(t.dblClickOrigin[0]=n.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout(()=>{t.dblClickOrigin[0]=null},1e3))}onContextMenu(e){if(this.wtSettings.has("onCellContextMenu")){let t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!this.wtSettings.has("onCellMouseOver"))return;let t=this.wtTable.TABLE,i=ca(e.target,["TD","TH"],t),s=this.parent||this;i&&i!==s.lastMouseOver&&rs(i,t)&&(s.lastMouseOver=i,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(i),i))}onMouseOut(e){if(!this.wtSettings.has("onCellMouseOut"))return;let t=this.wtTable.TABLE,i=ca(e.target,["TD","TH"],t),s=ca(e.relatedTarget,["TD","TH"],t),r=this.parent||this;i&&i!==s&&rs(i,t)&&(this.callListener("onCellMouseOut",e,this.wtTable.getCoords(i),i),s===null&&(r.lastMouseOver=null))}onMouseUp(e){let t=Ta.get(this),i=this.parentCell(e.target);i.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,i.coords,i.TD),!(e.button!==0&&!this.touchApplied)&&(i.TD===t.dblClickOrigin[0]&&i.TD===t.dblClickOrigin[1]?(Ve(e.target,"corner")?this.callListener("onCellCornerDblClick",e,i.coords,i.TD):this.callListener("onCellDblClick",e,i.coords,i.TD),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):i.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=i.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout(()=>{t.dblClickOrigin[1]=null},500)))}onTouchStart(e){let t=Ta.get(this);t.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;let i=e.target,s=(t=this.parentCell(i))===null||t===void 0?void 0:t.coords,r=Pe(s)&&s.row>=0&&s.col>=0;if(e.cancelable&&r&&this.wtSettings.getSetting("isDataViewInstance")){let a=["A","BUTTON","INPUT"];vh()&&(rw()||nw())&&this.selectedCellWasTouched(i)&&!a.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,i,s){let r=this.wtSettings.getSettingPure(e);r&&r(t,i,s,this.facadeGetter())}destroy(){let e=Ta.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}},ym=Vw;var Ww=class{constructor(e,t,i){this.offset=e,this.total=t,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}},sO=Ww;var Uw=class{constructor(e,t,i){this.offset=e,this.total=t,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}},oO=Uw;var Ra=class{constructor(){this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}};var Oh=class{constructor(){this.size=new Ra,this.workingSpace=0,this.sharedSize=null}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof Ra}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}};var mr=class{constructor(e,t,i){this.rootNode=e,this.nodesPool=t,this.sizeSet=new Oh,this.childNodeType=i.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){let e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){let{rootNode:e,sizeSet:t}=this,i=0;if(this.isSharedViewSet()){let s=e.firstElementChild;for(;s;){if(s.tagName===this.childNodeType)i+=1;else if(t.isPlaceOn(1))break;s=s.nextElementSibling}}else i=e.childElementCount;return i}start(){this.collectedNodes.length=0,this.visualIndex=0;let{rootNode:e,sizeSet:t}=this,i=this.isSharedViewSet(),{nextSize:s}=t.getViewSize(),r=this.getRenderedChildCount();for(;r<s;){let a=this.nodesPool();!i||i&&t.isPlaceOn(2)?e.appendChild(a):e.insertBefore(a,e.firstChild),r+=1}let n=i&&t.isPlaceOn(1);for(;r>s;)e.removeChild(n?e.firstChild:e.lastChild),r-=1}render(){let{rootNode:e,sizeSet:t}=this,i=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(2)&&(i+=t.sharedSize.nextSize);let s=e.childNodes[i];if(s.tagName!==this.childNodeType){let r=this.nodesPool();e.replaceChild(r,s),s=r}this.collectedNodes.push(s),this.visualIndex+=1}end(){}};var pr=class extends mr{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}};var Ah=class{constructor(e){this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}};var zi=class{constructor(e,t){this.nodesPool=typeof e=="string"?new Ah(e):null,this.nodeType=e,this.rootNode=t,this.table=null,this.renderedNodes=0}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}};var Ih=class extends zi{constructor(){super("TH"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new pr(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,t)),t}render(){let{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:i,rows:s,cells:r}=this.table;for(let n=0;n<e;n++){let a=this.table.renderedRowToSource(n),l=s.getRenderedNode(n);this.sourceRowIndex=a;let c=this.obtainOrderView(l),u=r.obtainOrderView(l);c.appendView(u).setSize(i).setOffset(this.table.renderedColumnToSource(0)).start();for(let g=0;g<i;g++){c.render();let p=c.getCurrentNode();p.className="",p.removeAttribute("style"),t[g](a,p,g)}c.end()}}};var _h=class extends zi{constructor(e){super(null,e)}adjust(){let{columnHeadersCount:e,rowHeadersCount:t}=this.table,i=this.rootNode.firstChild;if(e){let{columnsToRender:s}=this.table,r=s+t;for(let a=0,l=e;a<l;a++){for(i=this.rootNode.childNodes[a],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<r;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>r;)i.removeChild(i.lastChild),this.renderedNodes-=1}let n=this.rootNode.childNodes.length;if(n>e)for(let a=e;a<n;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&li(i)}render(){let{columnHeadersCount:e}=this.table;for(let t=0;t<e;t+=1){let{columnHeaderFunctions:i,columnsToRender:s,rowHeadersCount:r}=this.table,n=this.rootNode.childNodes[t];for(let a=-1*r;a<s;a+=1){let l=this.table.renderedColumnToSource(a),c=n.childNodes[a+r];c.className="",c.removeAttribute("style"),i[t](l,c,t)}}}};var Nh=class extends zi{constructor(e){super(null,e)}adjust(){let{columnsToRender:e,rowHeadersCount:t}=this.table,i=e+t;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();let{columnsToRender:e,rowHeadersCount:t}=this.table;for(let s=0;s<t;s++){let r=this.table.renderedColumnToSource(s),n=this.table.columnUtils.getHeaderWidth(r);this.rootNode.childNodes[s].style.width=`${n}px`}for(let s=0;s<e;s++){let r=this.table.renderedColumnToSource(s),n=this.table.columnUtils.getStretchedColumnWidth(r);this.rootNode.childNodes[s+t].style.width=`${n}px`}let i=this.rootNode.firstChild;i&&Te(i,"rowHeader")}};var rO=!1,Ph=class extends zi{constructor(e){super("TR",e),this.orderView=new mr(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){let{rowsToRender:e}=this.table;!rO&&e>1e3&&(rO=!0,mt(st`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let t=0;t<e;t++)this.orderView.render();this.orderView.end()}};var Lh=class extends zi{constructor(){super("TD"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new pr(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,t)),t}render(){let{rowsToRender:e,columnsToRender:t,rows:i,rowHeaders:s}=this.table;for(let r=0;r<e;r++){let n=this.table.renderedRowToSource(r),a=i.getRenderedNode(r);this.sourceRowIndex=n;let l=this.obtainOrderView(a),c=s.obtainOrderView(a);l.prependView(c).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let u=0;u<t;u++){l.render();let g=l.getCurrentNode(),p=this.table.renderedColumnToSource(u);Ve(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),this.table.cellRenderer(n,p,g)}l.end()}}};var Dh=class{constructor(e){let{cellRenderer:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=t}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:i,rows:s,cells:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),i.setTable(this),s.setTable(this),r.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=i,this.rows=s,this.cells=r}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();let{rowsToRender:e,rows:t}=this;for(let i=0;i<e;i++){let s=t.getRenderedNode(i);if(s.firstChild){let r=this.renderedRowToSource(i),n=this.rowUtils.getHeight(r);n?s.firstChild.style.height=`${n-1}px`:s.firstChild.style.height=""}}}};var vm=class{constructor(){let{TABLE:e,THEAD:t,COLGROUP:i,TBODY:s,rowUtils:r,columnUtils:n,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Dh(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new Ih,columnHeaders:new _h(t),colGroup:new Nh(i),rows:new Ph(s),cells:new Lh}),this.renderer.setAxisUtils(r,n)}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}};var kh=class{constructor(e,t){this.dataAccessObject=e,this.wtSettings=t,this.headerWidths=new Map}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let t=this.dataAccessObject.wtViewport.columnsRenderCalculator,i=this.getWidth(e);if(t){let s=t.getStretchedColumnWidth(e,i);s&&(i=s)}return i}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight"),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(t=t?Math.max(t,i):i),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){let{wtSettings:e}=this,{wtTable:t,wtViewport:i,cloneSource:s}=this.dataAccessObject,r=s?s.wtTable.holder:t.holder,n=r.offsetHeight<r.scrollHeight?Rt():0,a=e.getSetting("rowHeaderWidth");if(i.columnsRenderCalculator.refreshStretching(i.getViewportWidth()-n),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){let l=e.getSetting("rowHeaders").length,c=e.getSetting("defaultColumnWidth");for(let u=0;u<l;u++){let g=Array.isArray(a)?a[u]:a;g=g??c,this.headerWidths.set(u,g)}}}};var Hh=class{constructor(e,t){this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e),i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(t=t===void 0?i:Math.max(t,i)),t}};function js(o,e,t){return e=BW(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function BW(o){var e=VW(o,"string");return typeof e=="symbol"?e:String(e)}function VW(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var Gw=class{constructor(e,t,i,s,r){js(this,"wtSettings",null),js(this,"domBindings",void 0),js(this,"TBODY",null),js(this,"THEAD",null),js(this,"COLGROUP",null),js(this,"hasTableHeight",!0),js(this,"hasTableWidth",!0),js(this,"isTableVisible",!1),js(this,"tableOffset",0),js(this,"holderOffset",0),this.domBindings=i,this.isMaster=r==="master",this.name=r,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=s,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,lm(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;let n=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(n)),this.rowUtils=new Hh(this.dataAccessObject,this.wtSettings),this.columnUtils=new kh(this.dataAccessObject,this.wtSettings),this.tableRenderer=new vm({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){let e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){let t=e.parentNode,i;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Ve(t,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",t&&t.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",i}createHider(e){let t=e.parentNode,i;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Ve(t,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",t&&t.insertBefore(i,e),i.appendChild(e)),i}createHolder(e){let t=e.parentNode,i;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Ve(t,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",t&&t.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),i.appendChild(e)),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,{wtSettings:t}=this,{wtOverlays:i,wtViewport:s}=this.dataAccessObject,r=t.getSetting("totalRows"),n=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),l=a.length,c=t.getSetting("columnHeaders"),u=c.length,g=!1,p=e;if(this.isMaster&&(this.holderOffset=Ot(this.holder),p=s.createRenderCalculators(p),l&&!t.getSetting("fixedColumnsStart"))){let y=i.inlineStartOverlay.getScrollPosition(),S=this.correctHeaderWidth;this.correctHeaderWidth=y!==0,S!==this.correctHeaderWidth&&(p=!1)}if(this.isMaster&&(g=i.updateStateOfRendering()),p)this.isMaster&&s.createVisibleCalculators(),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=Ot(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;let y=r>0?this.getFirstRenderedRow():0,S=n>0?this.getFirstRenderedColumn():0;this.rowFilter=new oO(y,r,u),this.columnFilter=new sO(S,n,l);let O=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();let M={};this.wtSettings.getSetting("beforeDraw",!0,M),O=M.skipRender!==!0}if(O){this.tableRenderer.setHeaderContentRenderers(a,c),(this.is($i)||this.is(Ns))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let M;if(this.isMaster&&(M=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is($i))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();let _=at(this.hider),N=at(this.TABLE);_!==0&&N!==_&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),M!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is($i)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let C=!1;return this.isMaster&&(C=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(C=i.bottomOverlay.resetFixedPosition()||C),C=i.inlineStartOverlay.resetFixedPosition()||C,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),C?(i.refreshAll(),i.adjustElementsSize()):this.refreshSelections(p),g&&i.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){let t=this.columnFilter.renderedToSource(e),i=this.wtSettings.getSetting("columnHeaders").length,s=this.wtSettings.getSetting("defaultRowHeight"),r,n,a,l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,r=this.getColumnHeaderHeight(i),n=this.getColumnHeader(t,i),n&&(a=ls(n),(!r&&s<a||r<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=a),Array.isArray(l)?l[i]!==null&&l[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(l[i]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]||l))}adjustColumnHeaderHeights(){let{wtSettings:e}=this,t=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,s=e.getSetting("columnHeaders");for(let r=0,n=s.length;r<n;r++)if(i[r]){if(!t[r]||t[r].childNodes.length===0)return;t[r].childNodes[0].style.height=`${i[r]}px`}}resetOversizedRows(){let{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is($i))&&!e.getSetting("externalRowCalculator")){let i=this.getRenderedRowsCount();for(let s=0;s<i;s++){let r=this.rowFilter.renderedToSource(s);t.oversizedRows&&t.oversizedRows[r]&&(t.oversizedRows[r]=void 0)}}}removeClassFromCells(e){let t=this.TABLE.querySelectorAll(`.${e}`);for(let i=0,s=t.length;i<s;i++)je(t[i],e)}refreshSelections(e){let{wtSettings:t}=this,{selections:i}=this.dataAccessObject;if(!i)return;let s=Array.from(i),r=s.length;if(e){let n=[];for(let c=0;c<r;c++){let{highlightHeaderClassName:u,highlightRowClassName:g,highlightColumnClassName:p}=s[c].settings,C=s[c].classNames,y=C.length;for(let S=0;S<y;S++)n.includes(C[S])||n.push(C[S]);u&&!n.includes(u)&&n.push(u),g&&!n.includes(g)&&n.push(g),p&&!n.includes(p)&&n.push(p)}let a=t.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(a))for(let c=0;c<a.length;c++)n.push(a[c]);let l=n.length;for(let c=0;c<l;c++)this.removeClassFromCells(n[c])}for(let n=0;n<r;n++)s[n].draw(this.facadeGetter(),e)}getCell(e){let t=e.row,i=e.col,s=this.wtSettings.getSetting("onModifyGetCellCoords",t,i);if(s&&Array.isArray(s)&&([t,i]=s),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;let r=this.getRow(t);if(!r&&t>=0)throw new Error("TR was expected to be rendered but is not");let n=r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!n&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return n}getRow(e){let t=null,i=null;if(e<0){var s;t=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var r;t=(r=this.rowFilter)===null||r===void 0?void 0:r.sourceToRendered(e),i=this.TBODY}return t!==void 0&&i!==void 0?i.childNodes.length<t+1?!1:i.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=this.THEAD.childNodes[t];return i?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){let t=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(s=>{let r=s.childNodes[i];r&&t.push(r)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return;let i=this.wtSettings.getSetting("rowHeaders").length;if(t>=i)return;let s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return s?.childNodes[t]}getRowHeaders(e){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];let t=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let s=0;s<i;s++){let r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],n=r?.childNodes[s];n&&t.push(n)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=os(t,["TD","TH"])),t===null)return null;let i=t.parentNode,s=i.parentNode,r=$C(i),n=t.cellIndex;return yo(Gs,t,this.wtRootElement)||yo(Ps,t,this.wtRootElement)?s.nodeName==="THEAD"&&(r-=s.childNodes.length):yo(Ns,t,this.wtRootElement)||yo($i,t,this.wtRootElement)?r=this.wtSettings.getSetting("totalRows")-s.childNodes.length+r:s===this.THEAD?r=this.rowFilter.visibleColHeadedRowToSourceRow(r):r=this.rowFilter.renderedToSource(r),yo(Gs,t,this.wtRootElement)||yo(Ls,t,this.wtRootElement)||yo(Ns,t,this.wtRootElement)?n=this.columnFilter.offsettedTH(n):n=this.columnFilter.visibleRowHeadedColumnToSourceColumn(n),this.wot.createCellCoords(r,n)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length,t=e*this.wtSettings.getSetting("defaultRowHeight"),i=ls(this.TBODY)-1,s,r,n,a,l;if(!(t===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,n=this.rowFilter.renderedToSource(e),s=this.getRowHeight(n),a=this.getTrForRow(n),l=a.querySelector("th"),l?r=ls(l):r=ls(a)-1,(!s&&this.wtSettings.getSetting("defaultRowHeight")<r||s<r)&&(r+=1,this.dataAccessObject.wtViewport.oversizedRows[n]=r)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;let i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;let i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){let t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){let t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return at(this.TABLE)}getHeight(){return ft(this.TABLE)}getTotalWidth(){let e=at(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){let e=ft(this.hider);return e!==0?e:this.getHeight()}isVisible(){return wo(this.TABLE)}_modifyRowHeaderWidth(e){let t=ht(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}},us=Gw;var WW="stickyRowsBottom",nO={getFirstRenderedRow(){let o=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=o-e;return o===0||e===0?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let o=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),o)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};hi(nO,"MIXIN_NAME",WW,{writable:!1,enumerable:!1});var bm=nO;var UW="stickyColumnsStart",aO={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){let o=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),o)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()}};hi(aO,"MIXIN_NAME",UW,{writable:!1,enumerable:!1});var Ma=aO;var Fh=class extends us{constructor(e,t,i,s){super(e,t,i,s,Ns)}};et(Fh,bm);et(Fh,Ma);var lO=Fh;var Ps="top",$i="bottom",Ls="inline_start",Gs="top_inline_start_corner",Ns="bottom_inline_start_corner",hO=[Ps,$i,Ls,Gs,Ns],cO=new Map([[Ps,`ht_clone_${Ps}`],[$i,`ht_clone_${$i}`],[Ls,`ht_clone_${Ls} ht_clone_left`],[Gs,`ht_clone_${Gs} ht_clone_top_left_corner`],[Ns,`ht_clone_${Ns} ht_clone_bottom_left_corner`]]);function zw(o,e,t){return e=YW(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function YW(o){var e=jW(o,"string");return typeof e=="symbol"?e:String(e)}function jW(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var $w=class{constructor(e){zw(this,"dataAccessObject",void 0),zw(this,"lastScrolledColumnPos",-1),zw(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,t,i,s,r){let n=this.scrollViewportHorizontally(e.col,i,r),a=this.scrollViewportVertically(e.row,t,s);return n||a}scrollViewportHorizontally(e,t,i){let{drawn:s,totalColumns:r}=this.dataAccessObject;if(!s||!Number.isInteger(e)||e<0||e>r)return!1;let n=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=t===void 0&&i===void 0,{fixedColumnsStart:c,inlineStartOverlay:u}=this.dataAccessObject;if(l&&e<c)return!1;let g=!1;return n===-1?g=u.scrollTo(e,l?e>this.lastScrolledColumnPos:t):(l&&(e<n||e>a)||!l)&&(g=u.scrollTo(e,l?e>a:t)),g&&(this.lastScrolledColumnPos=e),g}scrollViewportVertically(e,t,i){let{drawn:s,totalRows:r}=this.dataAccessObject;if(!s||!Number.isInteger(e)||e<0||e>r)return!1;let n=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=t===void 0&&i===void 0,{fixedRowsBottom:c,fixedRowsTop:u,topOverlay:g}=this.dataAccessObject;if(l&&(e<u||e>r-c-1))return!1;let p=!1;return n===-1?p=g.scrollTo(e,l?e>this.lastScrolledRowPos:i):(l&&(e<n||e>a)||!l)&&(p=g.scrollTo(e,l?e>a:i)),p&&(this.lastScrolledRowPos=e),p}getFirstVisibleRow(){let{topOverlay:e,wtTable:t,wtViewport:i,totalRows:s,fixedRowsTop:r,rootWindow:n}=this.dataAccessObject,a=t.getFirstVisibleRow();if(e.mainTableScrollableElement===n){let l=Ot(t.wtRootElement),c=ls(t.hider),u=ls(n),g=ar(n,n);if(l.top+c-u<=g){let p=i.getColumnHeaderHeight();p+=e.sumCellSizes(0,r);for(let C=s;C>0;C--)if(p+=e.sumCellSizes(C-1,C),l.top+c-p<=g){a=C;break}}}return a}getLastVisibleRow(){let{topOverlay:e,wtTable:t,wtViewport:i,totalRows:s,rootWindow:r}=this.dataAccessObject,n=t.getLastVisibleRow();if(e.mainTableScrollableElement===r){let a=Ot(t.wtRootElement),l=ar(r,r);if(a.top>l){let c=ls(r),u=i.getColumnHeaderHeight();for(let g=1;g<=s;g++)if(u+=e.sumCellSizes(g-1,g),a.top+u-l>=c){n=g-2;break}}}return n}getFirstVisibleColumn(){let{inlineStartOverlay:e,wtTable:t,wtViewport:i,totalColumns:s,rootWindow:r}=this.dataAccessObject,n=t.getFirstVisibleColumn();if(e.mainTableScrollableElement===r){let a=Ot(t.wtRootElement),l=sn(t.hider),c=sn(r),u=Math.abs(ua(r,r));if(a.left+l-c<=u){let g=i.getRowHeaderWidth();for(let p=s;p>0;p--)if(g+=e.sumCellSizes(p-1,p),a.left+l-g<=u){n=p;break}}}return n}getLastVisibleColumn(){let{wtSettings:e,inlineStartOverlay:t,wtTable:i,wtViewport:s,totalColumns:r,rootWindow:n}=this.dataAccessObject,a=i.getLastVisibleColumn();if(t.mainTableScrollableElement===n){let l=e.getSetting("rtlMode"),c=null;if(l){let g=i.TABLE.getBoundingClientRect(),C=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;c=Math.abs(g.right-C)}else c=Ot(i.wtRootElement).left;let u=Math.abs(ua(n,n));if(c>u){let g=sn(n),p=s.getRowHeaderWidth();for(let C=1;C<=r;C++)if(p+=t.sumCellSizes(C-1,C),c+p-u>=g){a=C-2;break}}}return a}},uO=$w;function Ds(o,e,t){return e=GW(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function GW(o){var e=zW(o,"string");return typeof e=="symbol"?e:String(e)}function zW(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var Oo=class{get eventManager(){return new tt(this)}constructor(e,t){Ds(this,"wtTable",void 0),Ds(this,"wtScroll",void 0),Ds(this,"wtViewport",void 0),Ds(this,"wtOverlays",void 0),Ds(this,"selections",void 0),Ds(this,"wtEvent",void 0),Ds(this,"guid",`wt_${hh()}`),Ds(this,"drawInterrupted",!1),Ds(this,"drawn",!1),Ds(this,"domBindings",void 0),Ds(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new uO(this.createScrollDao())}findOriginalHeaders(){let e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;t<i;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,i){ji(i,e[t])}])}}createCellCoords(e,t){return new Mo(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,i){return new fr(e,t,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);let i=this.wtSettings.getSetting("totalRows"),s=this.wtSettings.getSetting("fixedRowsTop"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<s&&e.col<n)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<s)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<n&&e.row>=i-r){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<n)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-r&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,i,s,r){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,t,i,s,r)}scrollViewportHorizontally(e,t,i){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,t,i)}scrollViewportVertically(e,t,i){return e<0?!1:this.wtScroll.scrollViewportVertically(e,t,i)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){let e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){let e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selections(){return e.selections},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count}}}};function dO(o,e,t){return e=$W(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function $W(o){var e=XW(o,"string");return typeof e=="symbol"?e:String(e)}function XW(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var Bh=class extends Oo{constructor(e,t,i){super(e,t),dO(this,"cloneSource",void 0),dO(this,"cloneOverlay",void 0);let s=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),s,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selections=i.selections,this.wtEvent=new ym(s,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections,i.event),this.findOriginalHeaders()}};function qW(o,e,t){return e=KW(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function KW(o){var e=ZW(o,"string");return typeof e=="symbol"?e:String(e)}function ZW(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var ds=class{constructor(e,t,i,s,r){qW(this,"wtSettings",null),hi(this,"wot",e,{writable:!1}),this.domBindings=r,this.facadeGetter=t,this.wtSettings=s;let{TABLE:n,hider:a,spreader:l,holder:c,wtRootElement:u}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=n,this.hider=a,this.spreader=l,this.holder=c,this.wtRootElement=u,this.trimmingContainer=ns(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){let e=this.needFullRender;this.needFullRender=this.shouldBeRendered();let t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=ns(this.hider.parentNode.parentNode)}updateMainScrollableElement(){let{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=tn(e.TABLE)}getRelativeCellPosition(e,t,i){if(this.clone.wtTable.holder.contains(e)===!1){mt(`The provided element is not a child of the ${this.type} overlay`);return}let s=this.mainTableScrollableElement===this.domBindings.rootWindow,r=i<this.wtSettings.getSetting("fixedColumnsStart"),n=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(l),top:l.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop},g=null;return s?g=this.getRelativeCellPositionWithinWindow(n,r,u,c):g=this.getRelativeCellPositionWithinHolder(n,a,r,u,c),g}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,i,s){let r=this.wot.wtTable.wtRootElement.getBoundingClientRect(),n=0,a=0;if(!t)n=s.start;else{let l=r.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(r.left+r.width+Rt())),n=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-r.top:a=s.top,{start:i.start+n,top:i.top+a}}getRelativeCellPositionWithinHolder(e,t,i,s,r){let n={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},a=0,l=0;if(i||(a=n.horizontal-r.start),t){let c=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+c.top}else e||(l=n.vertical-r.top);return{start:s.start-a,top:s.top-l}}makeClone(){if(hO.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);let{wtTable:e}=this.wot,{rootDocument:t,rootWindow:i}=this.domBindings,s=t.createElement("DIV"),r=t.createElement("TABLE"),n=e.wtRootElement.parentNode;s.className=`${cO.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,r.className=e.TABLE.className,s.appendChild(r),n.appendChild(s);let a=this.wtSettings.getSetting("preventOverflow");return a===!0||a==="horizontal"&&this.type===Ps||a==="vertical"&&this.type===Ls?this.mainTableScrollableElement=i:i.getComputedStyle(n).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=tn(e.TABLE),new Bh(r,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}reset(){if(!this.clone)return;let e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,i=e.style,s=t.style,r=e.parentNode.style;we([i,s,r],n=>{n.width="",n.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}};var Vh=class extends ds{constructor(e,t,i,s,r,n){super(e,t,Ns,i,s),this.bottomOverlay=r,this.inlineStartOverlay=n}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new lO(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;let t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){let r=this.inlineStartOverlay.getOverlayOffset(),n=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${r}px`,t.style.bottom=`${n}px`}else So(t),this.repositionOverlay();let i=ft(this.clone.wtTable.TABLE),s=at(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),t.style.height=`${i}px`,t.style.width=`${s}px`,!1}repositionOverlay(){let{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode,r=0;t.hasVerticalScroll()||(r+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(r+=Rt(i)),s.style.bottom=`${r}px`}};var QW="calculatedColumns",fO={getFirstRenderedColumn(){let o=this.dataAccessObject.startColumnRendered;return o===null?-1:o},getFirstVisibleColumn(){let o=this.dataAccessObject.startColumnVisible;return o===null?-1:o},getLastRenderedColumn(){let o=this.dataAccessObject.endColumnRendered;return o===null?-1:o},getLastVisibleColumn(){let o=this.dataAccessObject.endColumnVisible;return o===null?-1:o},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible}};hi(fO,"MIXIN_NAME",QW,{writable:!1,enumerable:!1});var Oa=fO;var Wh=class extends us{constructor(e,t,i,s){super(e,t,i,s,$i)}};et(Wh,bm);et(Wh,Oa);var mO=Wh;function JW(o,e,t){return e=eU(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function eU(o){var e=tU(o,"string");return typeof e=="symbol"?e:String(e)}function tU(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var Uh=class extends ds{constructor(e,t,i,s){super(e,t,$i,i,s),JW(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new mO(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;let{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let i=0,s=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!s||s!=="vertical")?(i=this.getOverlayOffset(),t.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());let r=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),r}repositionOverlay(){let{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode,r=0;t.hasVerticalScroll()||(r+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(r+=Rt(i)),s.style.bottom=`${r}px`}setScrollPosition(e){let{rootWindow:t}=this.domBindings,i=!1;return this.mainTableScrollableElement===t?(t.scrollTo(As(t),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){let{wtTable:i,wtSettings:s}=this.wot,r=s.getSetting("defaultRowHeight"),n=e,a=0;for(;n<t;){let l=i.getRowHeight(n);a+=l===void 0?r:l,n+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i,rootWindow:s}=this.domBindings,r=Rt(i),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||l==="horizontal"){let u=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=r),u=Math.min(u,e.wtRootElement.scrollWidth),a.width=`${u}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let c=ft(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(c=0),a.height=`${c}px`}adjustRootChildrenSize(){let{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){let e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let i=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,n=0;t&&r.offsetHeight!==r.clientHeight&&(n=Rt(this.domBindings.rootDocument)),t?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=n,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ar(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){let s=this.wot.wtTable.getTotalHeight(),r=this.clone.wtTable.getTotalHeight(),n=s-r,a=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+s,0),i>n&&(i=0)}return i}adjustHeaderBordersPosition(e){let t=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==t,s=this.wtSettings.getSetting("columnHeaders"),r=!1;if((i||t===0)&&s.length>0){let n=this.wot.wtTable.holder.parentNode,a=Ve(n,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Te(n,"innerBorderBottom"),r=!a):(je(n,"innerBorderBottom"),r=a)}return r}};var iU="calculatedRows",pO={getFirstRenderedRow(){let o=this.dataAccessObject.startRowRendered;return o===null?-1:o},getFirstVisibleRow(){let o=this.dataAccessObject.startRowVisible;return o===null?-1:o},getLastRenderedRow(){let o=this.dataAccessObject.endRowRendered;return o===null?-1:o},getLastVisibleRow(){let o=this.dataAccessObject.endRowVisible;return o===null?-1:o},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible}};hi(pO,"MIXIN_NAME",iU,{writable:!1,enumerable:!1});var xm=pO;var Yh=class extends us{constructor(e,t,i,s){super(e,t,i,s,Ls)}};et(Yh,xm);et(Yh,Ma);var gO=Yh;var jh=class extends ds{constructor(e,t,i,s){super(e,t,Ls,i,s)}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new gO(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;let{rootWindow:t}=this.domBindings,i=this.clone.wtTable.holder.parentNode,s=this.wtSettings.getSetting("preventOverflow"),r=0;this.trimmingContainer===t&&(!s||s!=="horizontal")?(r=this.getOverlayOffset()*(this.isRtl()?-1:1),on(i,`${r}px`,"0px")):(r=this.getScrollPosition(),So(i));let n=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),n}setScrollPosition(e){let{rootWindow:t}=this.domBindings,i=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,vo(t)),i=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){let i=this.wtSettings.getSetting("defaultColumnWidth"),s=e,r=0;for(;s<t;)r+=this.wot.wtTable.getStretchedColumnWidth(s)||i,s+=1;return r}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e}=this.wot,{rootDocument:t,rootWindow:i}=this.domBindings,s=Rt(t),n=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let c=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(c-=s),c=Math.min(c,e.wtRootElement.scrollHeight),n.height=`${c}px`}else n.height="";this.clone.wtTable.holder.style.height=n.height;let l=at(this.clone.wtTable.TABLE);n.width=`${l}px`}adjustRootChildrenSize(){var e;let{holder:t}=this.clone.wtTable,{selections:i}=this.wot,s=this.facadeGetter(),r=Math.abs((e=i?.getCell().getBorder(s).cornerCenterPointOffset)!==null&&e!==void 0?e:0);this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+r}px`}applyToDOM(){let e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){let i=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,n=0;if(t){let a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(t=!1)}return t&&r.offsetWidth!==r.clientWidth&&(n=Rt(this.domBindings.rootDocument)),t?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportWidth()):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),i+=n,this.setScrollPosition(i)}getTableParentOffset(){let e=this.wtSettings.getSetting("preventOverflow"),t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(ua(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){let{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);let s=this.wot.wtTable.getTotalWidth(),r=this.clone.wtTable.getTotalWidth(),n=s-r;i>n&&(i=0)}return i}adjustHeaderBordersPosition(e){let t=this.wot.wtTable.holder.parentNode,i=this.wtSettings.getSetting("rowHeaders"),s=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?je(t,"emptyRows"):Te(t,"emptyRows");let n=!1;if(s&&!i.length)Te(t,"innerBorderLeft innerBorderInlineStart");else if(!s&&i.length){let a=Ve(t,"innerBorderInlineStart");e?(Te(t,"innerBorderLeft innerBorderInlineStart"),n=!a):(je(t,"innerBorderLeft innerBorderInlineStart"),n=a)}return n}};var sU="stickyRowsTop",CO={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let o=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),o)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};hi(CO,"MIXIN_NAME",sU,{writable:!1,enumerable:!1});var Sm=CO;var Gh=class extends us{constructor(e,t,i,s){super(e,t,i,s,Gs)}};et(Gh,Sm);et(Gh,Ma);var wO=Gh;function yO(o,e,t){return e=oU(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function oU(o){var e=rU(o,"string");return typeof e=="symbol"?e:String(e)}function rU(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var zh=class extends ds{constructor(e,t,i,s,r,n){super(e,t,Gs,i,s),yO(this,"topOverlay",void 0),yO(this,"inlineStartOverlay",void 0),this.topOverlay=r,this.inlineStartOverlay=n}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new wO(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){let s=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),r=this.topOverlay.getOverlayOffset();on(e,`${s}px`,`${r}px`)}else So(e);let t=ft(this.clone.wtTable.TABLE),i=at(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${i}px`,!1}};var $h=class extends us{constructor(e,t,i,s){super(e,t,i,s,Ps)}};et($h,Sm);et($h,Oa);var vO=$h;function nU(o,e,t){return e=aU(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function aU(o){var e=lU(o,"string");return typeof e=="symbol"?e:String(e)}function lU(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var Xh=class extends ds{constructor(e,t,i,s){super(e,t,Ps,i,s),nU(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new vO(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow"),s=0,r=!1;if(this.trimmingContainer===t&&(!i||i!=="vertical")){let{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),c=Math.ceil(l.bottom),u=e.offsetHeight;r=c===u,s=this.getOverlayOffset(),on(e,"0px",`${s}px`)}else s=this.getScrollPosition(),So(e);let n=this.adjustHeaderBordersPosition(s,r);return this.adjustElementsSize(),n}setScrollPosition(e){let t=this.domBindings.rootWindow,i=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(As(t),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){let i=this.wtSettings.getSetting("defaultRowHeight"),s=e,r=0;for(;s<t;){let n=this.wot.wtTable.getRowHeight(s);r+=n===void 0?i:n,s+=1}return r}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e}=this.wot,{rootDocument:t,rootWindow:i}=this.domBindings,s=Rt(t),n=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let c=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=s),c=Math.min(c,e.wtRootElement.scrollWidth),n.width=`${c}px`}else n.width="";this.clone.wtTable.holder.style.width=n.width;let l=ft(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),n.height=`${l}px`}adjustRootChildrenSize(){var e;let{holder:t}=this.clone.wtTable,{selections:i}=this.wot,s=this.facadeGetter(),r=Math.abs((e=i?.getCell().getBorder(s).cornerCenterPointOffset)!==null&&e!==void 0?e:0);this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+r}px`}applyToDOM(){let e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let{wot:i,wtSettings:s}=this,n=(i.cloneSource?i.cloneSource:i).wtTable.holder,a=this.getTableParentOffset(),l=0;if(t){let c=this.wot.wtTable.getRowHeight(e),u=this.wot.wtViewport.getViewportHeight();c>u&&(t=!1)}if(t&&n.offsetHeight!==n.clientHeight&&(l=Rt(this.domBindings.rootDocument)),t){let c=s.getSetting("fixedRowsBottom"),u=s.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=i.wtViewport.getViewportHeight()-this.sumCellSizes(u-c,u),a+=1}else a+=this.sumCellSizes(s.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ar(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){let s=this.wot.wtTable.getTotalHeight(),r=this.clone.wtTable.getTotalHeight(),n=s-r;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>n&&(i=0)}return i}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?je(i,"emptyColumns"):Te(i,"emptyColumns");let r=!1;if(!t){let n=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==n,l=this.wtSettings.getSetting("columnHeaders");if((a||n===0)&&l.length>0){let c=Ve(i,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(Te(i,"innerBorderTop"),r=!c):(je(i,"innerBorderTop"),r=c)}}return r}};function Ao(o,e,t){return e=hU(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function hU(o){var e=cU(o,"string");return typeof e=="symbol"?e:String(e)}function cU(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var Xw=class{constructor(e,t,i,s,r,n){Ao(this,"wot",null),Ao(this,"topOverlay",null),Ao(this,"bottomOverlay",null),Ao(this,"inlineStartOverlay",null),Ao(this,"topInlineStartCornerOverlay",null),Ao(this,"bottomInlineStartCornerOverlay",null),Ao(this,"browserLineHeight",void 0),Ao(this,"wtSettings",null),Ao(this,"resizeObserver",new ResizeObserver(u=>{mn(()=>{!Array.isArray(u)||!u.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=s,this.domBindings=i,this.facadeGetter=t,this.wtTable=n;let{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=r,this.scrollbarSize=Rt(a);let c=l.getComputedStyle(n.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?n.holder:tn(n.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){let{rootWindow:e,rootDocument:t}=this.domBindings,i=e.getComputedStyle(t.body),s=parseInt(i.lineHeight,10),r=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=s||r}initOverlays(){let e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Xh(...e),this.bottomOverlay=new Uh(...e),this.inlineStartOverlay=new jh(...e),this.topInlineStartCornerOverlay=new zh(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new Vh(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){let{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:s}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",g=>this.onKeyDown(g)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",g=>this.onTableScroll(g),{passive:!0}),i!==s&&this.eventManager.addEventListener(s,"scroll",g=>this.onTableScroll(g),{passive:!0});let r=t.devicePixelRatio&&t.devicePixelRatio>1,n=this.scrollableElement===t,a=this.wtSettings.getSetting("preventWheel"),l={passive:n};(a||r||!wh())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",g=>this.onCloneWheel(g,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(g=>{if(g&&g.needFullRender){let{holder:p}=g.clone.wtTable;this.eventManager.addEventListener(p,"wheel",C=>this.onCloneWheel(C,a),l)}});let u;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(u),u=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),n||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){let t=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,r=e.target;this.keyPressed&&(s!==t&&r!==t&&!e.target.contains(s)||i!==t&&r!==t&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,t){let{rootWindow:i}=this.domBindings,s=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,n=e.target,a=r!==i&&n!==i&&!n.contains(r),l=s!==i&&n!==i&&!n.contains(s);if(this.keyPressed&&(a||l))return;let c=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==i&&c)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Us(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,t+=t*this.browserLineHeight);let s=this.scrollVertically(t),r=this.scrollHorizontally(i);return s||r}scrollVertically(e){let t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){let t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;let{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,[s,r]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==s||this.lastScrollX!==e.scrollX,this.verticalScrolling=i.scrollTop!==r||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=s;let n=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;n&&(n.scrollLeft=s)}this.verticalScrolling&&(i.scrollTop=r),this.refreshAll()}syncScrollWithMaster(){let e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();let{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=tn(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){let e=this.wtTable.spreader,t=e.clientWidth,i=e.clientHeight,s=t!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return s&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=i),s}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,{wtViewport:t}=this.wot,{wtTable:i}=this,s=this.wtSettings.getSetting("totalColumns"),r=this.wtSettings.getSetting("totalRows"),n=t.getRowHeaderWidth(),a=t.getColumnHeaderHeight(),l=i.hider.style;if(l.width=`${n+this.inlineStartOverlay.sumCellSizes(0,s)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,r)+1}px`,this.scrollbarSize>0){let{scrollHeight:c,scrollWidth:u}=i.wtRootElement,{scrollHeight:g,scrollWidth:p}=i.holder;this.hasScrollbarRight=c<g,this.hasScrollbarBottom=u<p,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>u?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;let t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return we(t,s=>{s&&s.clone&&s.clone.wtTable.TABLE.contains(e)&&(i=s.clone)}),i}syncOverlayTableClassNames(){let e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];we(t,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}},bO=Xw;function xO(o,e,t){return e=uU(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function uU(o){var e=dU(o,"string");return typeof e=="symbol"?e:String(e)}function dU(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var qh=class{constructor(e){xO(this,"settings",{}),xO(this,"defaults",Object.freeze(this.getDefaults())),ze(this.defaults,(t,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(t===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,i)=>{let s=this.getSetting("data",e,t);ji(i,s??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}update(e,t){return t===void 0?ze(e,(i,s)=>{this.settings[s]=i}):this.settings[e]=t,this}getSetting(e,t,i,s,r){return typeof this.settings[e]=="function"?this.settings[e](t,i,s,r):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}};var Kh=class extends us{constructor(e,t,i,s){super(e,t,i,s,"master")}alignOverlaysWithTrimmingContainer(){let e=ns(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{let i=e.parentElement,s=bo(e,"height",t),r=bo(e,"overflow",t),n=this.holder.style,{scrollWidth:a,scrollHeight:l}=e,{width:c,height:u}=e.getBoundingClientRect();if(i&&["auto","hidden","scroll"].includes(r)){let p=e.cloneNode(!1);p.style.overflow="auto",p.style.position="absolute",e.nextElementSibling?i.insertBefore(p,e.nextElementSibling):i.appendChild(p);let C=parseInt(as(p,t).height,10);i.removeChild(p),C===0&&(u=0)}u=Math.min(u,l),n.height=s==="auto"?"auto":`${u}px`,c=Math.min(c,a),n.width=`${c}px`,n.overflow="",this.hasTableHeight=n.height==="auto"?!0:u>0,this.hasTableWidth=c>0}this.isTableVisible=wo(this.TABLE)}markOversizedColumnHeaders(){let{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,i="master",r=e.getSetting("columnHeaders").length;if(r&&!t.hasOversizedColumnHeadersMarked[i]){let a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let c=0;c<r;c++)for(let u=-1*a;u<l;u++)this.markIfOversizedColumnHeader(u);t.hasOversizedColumnHeadersMarked[i]=!0}}};et(Kh,xm);et(Kh,Oa);var SO=Kh;var qw=class{constructor(e,t,i,s,r){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=i,this.wtTable=r,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=s,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){let e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer,i=0;return t===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=ft(t)>0&&t.clientHeight>0?t.clientHeight:1/0,i}getWorkspaceWidth(){let{wtSettings:e}=this,{rootDocument:t,rootWindow:i}=this.domBindings,s=this.dataAccessObject.inlineStartOverlayTrimmingContainer,r=t.documentElement.offsetWidth,n=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),u=l?c.right-r:c.left,g=r-u,p,C;if(a)return at(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?p=Math.min(g,r):p=Math.min(this.getContainerFillWidth(),g,r),s===i&&n>0&&this.sumColumnWidths(0,n-1)>p)return t.documentElement.clientWidth;if(s!==i&&(C=bo(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),C==="scroll"||C==="hidden"||C==="auto"))return Math.max(p,s.clientWidth);let y=e.getSetting("stretchH");return y==="none"||!y?Math.max(p,at(this.wtTable.TABLE)):p}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let i=0,s=e;for(;s<t;)i+=this.wtTable.getColumnWidth(s),s+=1;return i}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;let e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);let i=t.offsetWidth;return this.containerWidth=i,e.removeChild(t),i}getWorkspaceOffset(){return Ot(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=ft(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;let t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){let e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,s=t.length;i<s;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let s=0,r=t.length;s<r;s++)i?(this.rowHeaderWidth+=at(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){let e=this.getWorkspaceWidth();if(e===1/0)return e;let t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{wtSettings:t,wtTable:i}=this,s,r,n;this.rowHeaderWidth=NaN,t.getSetting("renderAllRows")&&e===1?s=1/0:s=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,l=t.getSetting("fixedRowsTop"),c=t.getSetting("fixedRowsBottom"),u=t.getSetting("totalRows");return l&&a>=0&&(n=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=n,s-=n),c&&this.dataAccessObject.bottomOverlay.clone&&(n=this.dataAccessObject.bottomOverlay.sumCellSizes(u-c,u),s-=n),i.holder.clientHeight===i.holder.offsetHeight?r=0:r=Rt(this.domBindings.rootDocument),new Sa({viewportSize:s,scrollOffset:a,totalItems:t.getSetting("totalRows"),itemSizeFn:g=>i.getRowHeight(g),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,scrollbarHeight:r})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{wtSettings:t,wtTable:i}=this,s=this.getViewportWidth(),r=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;let n=t.getSetting("fixedColumnsStart");if(n&&r>=0){let a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,n);r+=a,s-=a}return i.holder.clientWidth!==i.holder.offsetWidth&&(s-=Rt(this.domBindings.rootDocument)),new dr({viewportSize:s,scrollOffset:r,totalItems:t.getSetting("totalColumns"),itemSizeFn:a=>i.getColumnWidth(a),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:(a,l)=>t.getSetting("onBeforeStretchingColumnWidth",a,l),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(t){let i=this.createRowsCalculator(2),s=this.createColumnsCalculator(2);this.areAllProposedVisibleRowsAlreadyRendered(i)&&this.areAllProposedVisibleColumnsAlreadyRendered(s)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(1),this.columnsRenderCalculator=this.createColumnsCalculator(1)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(2),this.columnsVisibleCalculator=this.createColumnsCalculator(2)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:i,isVisibleInTrimmingContainer:s}=e;if(t===null&&i===null)return!s;let{startRow:r,endRow:n}=this.rowsRenderCalculator;return t<r||t===r&&t>0?!1:!(i>n||i===n&&i<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:i,isVisibleInTrimmingContainer:s}=e;if(t===null&&i===null)return!s;let{startColumn:r,endColumn:n}=this.columnsRenderCalculator;return t<r||t===r&&t>0?!1:!(i>n||i===n&&i<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){ze(this.hasOversizedColumnHeadersMarked,(e,t,i)=>{i[t]=void 0})}},EO=qw;var Zh=class extends Oo{constructor(e,t){super(e,new qh(t));let i=this.wtSettings.getSetting("facade",this);this.wtTable=new SO(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new EO(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selections=this.wtSettings.getSetting("selections"),this.wtEvent=new ym(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections),this.wtOverlays=new bO(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){let e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],i=[];ze(e,(s,r)=>{this.wtSettings.getSetting(r).length&&i.push(s),t.push(s)}),je(this.wtTable.wtRootElement.parentNode,t),Te(this.wtTable.wtRootElement.parentNode,i)}getViewportDao(){let e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}};var Aa=class o{constructor(e){e instanceof Oo?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{let i=new o(t);return()=>i},this._wot=new Zh(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selections(){return this._wot.selections}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,i){return this._wot.createCellRange(e,t,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,i,s,r){return this._wot.scrollViewport(e,t,i,s,r)}scrollViewportHorizontally(e,t,i){return this._wot.scrollViewportHorizontally(e,t,i)}scrollViewportVertically(e,t,i){return this._wot.scrollViewportVertically(e,t,i)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,i,s,r){return this._wot.wtSettings.getSetting(e,t,i,s,r)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}};var Kw=class{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){let e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,i=this.main.childNodes.length;t<i;t++){let s=this.main.childNodes[t];this.eventManager.addEventListener(s,"mouseenter",r=>this.onMouseEnter(r,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),ni(e);let i=this,s=this.wot.rootDocument.body,r=t.getBoundingClientRect();t.style.display="none";function n(l){if(l.clientY<Math.floor(r.top)||l.clientY>Math.ceil(r.top+r.height)||l.clientX<Math.floor(r.left)||l.clientX>Math.ceil(r.left+r.width))return!0}function a(l){n(l)&&(i.eventManager.removeEventListener(s,"mousemove",a),t.style.display="block")}this.eventManager.addEventListener(s,"mousemove",a)}createBorders(e){let{rootDocument:t}=this.wot;this.main=t.createElement("div");let i=["top","start","bottom","end","corner"],s=this.main.style;s.position="absolute",s.top=0,s.left=0;for(let a=0;a<5;a++){let l=i[a],c=t.createElement("div");c.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(c.className+=" hidden"),s=c.style,s.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,s.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,s.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(c)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),fi()&&this.createMultipleSelectorHandles(),this.disappear();let{wtTable:r}=this.wot,n=r.bordersHolder;n||(n=t.createElement("div"),n.className="htBorders",r.bordersHolder=n,r.spreader.appendChild(n)),n.appendChild(this.main)}createMultipleSelectorHandles(){let{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};let t=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};let s={position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${parseInt(i/1.5,10)}px`};ze(s,(n,a)=>{this.selectionHandles.styles.bottomHitArea[a]=n,this.selectionHandles.styles.topHitArea[a]=n});let r={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};ze(r,(n,a)=>{this.selectionHandles.styles.bottom[a]=n,this.selectionHandles.styles.top[a]=n}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){let i=this.wot.selections.createOrGetArea();return!!(i.cellRange&&(e!==i.cellRange.to.row||t!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,i,s,r,n){let l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:c,topHitArea:u,bottom:g,bottomHitArea:p}=this.selectionHandles.styles,C=parseInt(c.borderWidth,10),y=parseInt(c.width,10),S=parseInt(u.width,10),O=this.wot.wtTable.getWidth(),M=this.wot.wtTable.getHeight();c.top=`${parseInt(i-y-1,10)}px`,c[l]=`${parseInt(s-y-1,10)}px`,u.top=`${parseInt(i-S/4*3,10)}px`,u[l]=`${parseInt(s-S/4*3,10)}px`;let _=Math.min(parseInt(s+r,10),O-y-C*2),N=Math.min(parseInt(s+r-S/4,10),O-S-C*2);g[l]=`${_}px`,p[l]=`${N}px`;let E=Math.min(parseInt(i+n,10),M-y-C*2),k=Math.min(parseInt(i+n-S/4,10),M-S-C*2);g.top=`${E}px`,p.top=`${k}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",u.display="block",this.isPartRange(e,t)?(g.display="none",p.display="none"):(g.display="block",p.display="block")):(c.display="none",g.display="none",u.display="none",p.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",u.zIndex="9999"):(c.zIndex="",u.zIndex="")}appear(e){if(this.disabled)return;let{wtTable:t,rootDocument:i,rootWindow:s}=this.wot,r,n,a,l,c,u,g=t.getRenderedRowsCount();for(let b=0;b<g;b+=1){let h=t.rowFilter.renderedToSource(b);if(h>=e[0]&&h<=e[2]){r=h,c=e[0];break}}for(let b=g-1;b>=0;b-=1){let h=t.rowFilter.renderedToSource(b);if(h>=e[0]&&h<=e[2]){n=h;break}}let p=t.getRenderedColumnsCount();for(let b=0;b<p;b+=1){let h=t.columnFilter.renderedToSource(b);if(h>=e[1]&&h<=e[3]){a=h,u=e[1];break}}for(let b=p-1;b>=0;b-=1){let h=t.columnFilter.renderedToSource(b);if(h>=e[1]&&h<=e[3]){l=h;break}}if(r===void 0||a===void 0){this.disappear();return}let C=t.getCell(this.wot.createCellCoords(r,a)),y=r!==n||a!==l,S=y?t.getCell(this.wot.createCellCoords(n,l)):C,O=Ot(C),M=y?Ot(S):O,_=Ot(t.TABLE),N=at(t.TABLE),E=O.top,k=O.left,ie=this.wot.wtSettings.getSetting("rtlMode"),$=0,H=0;if(ie){let b=at(C),h=s.innerWidth-_.left-N;H=k+b-M.left,$=s.innerWidth-k-b-h-1}else H=M.left+at(S)-k,$=k-_.left-1;if(this.isEntireColumnSelected(r,n)){let b=this.getDimensionsFromHeader("columns",a,l,c,_),h=null;b&&([h,$,H]=b),h&&(C=h)}let Q=E-_.top-1,Y=M.top+ft(S)-E;if(this.isEntireRowSelected(a,l)){let b=this.getDimensionsFromHeader("rows",r,n,u,_),h=null;b&&([h,Q,Y]=b),h&&(C=h)}let P=as(C,s);parseInt(P.borderTopWidth,10)>0&&(Q+=1,Y=Y>0?Y-1:0),parseInt(P[ie?"borderRightWidth":"borderLeftWidth"],10)>0&&($+=1,H=H>0?H-1:0);let j=ie?"right":"left";this.topStyle.top=`${Q}px`,this.topStyle[j]=`${$}px`,this.topStyle.width=`${H}px`,this.topStyle.display="block",this.startStyle.top=`${Q}px`,this.startStyle[j]=`${$}px`,this.startStyle.height=`${Y}px`,this.startStyle.display="block";let A=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${Q+Y-A}px`,this.bottomStyle[j]=`${$}px`,this.bottomStyle.width=`${H}px`,this.bottomStyle.display="block",this.endStyle.top=`${Q}px`,this.endStyle[j]=`${$+H-A}px`,this.endStyle.height=`${Y+1}px`,this.endStyle.display="block";let v=this.settings.border.cornerVisible;v=typeof v=="function"?v(this.settings.layerLevel):v;let R=this.wot.getSetting("onModifyGetCellCoords",n,l),[f,w]=[n,l];if(R&&Array.isArray(R)&&([,,f,w]=R),fi()||!v||this.isPartRange(f,w))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Q+Y+this.cornerCenterPointOffset-1}px`,this.cornerStyle[j]=`${$+H+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let b=ns(t.TABLE),h=b===s;h&&(b=i.documentElement);let m=parseInt(this.cornerDefaultStyle.width,10)/2,x=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){let I=h?S.getBoundingClientRect().left:S.offsetLeft,B=!1,V=0;ie?(V=I-parseInt(this.cornerDefaultStyle.width,10)/2,B=V<0):(V=I+at(S)+parseInt(this.cornerDefaultStyle.width,10)/2,B=V>=sn(b)),B&&(this.cornerStyle[j]=`${Math.floor($+H+this.cornerCenterPointOffset-m)}px`,this.cornerStyle[ie?"borderLeftWidth":"borderRightWidth"]=0)}n===this.wot.getSetting("totalRows")-1&&(h?S.getBoundingClientRect().top:S.offsetTop)+ft(S)+parseInt(this.cornerDefaultStyle.height,10)/2>=ls(b)&&(this.cornerStyle.top=`${Math.floor(Q+Y+this.cornerCenterPointOffset-x)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}fi()&&this.updateMultipleSelectionHandlesPosition(n,l,Q,$,H,Y)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,i,s,r){let{wtTable:n}=this.wot,a=n.wtRootElement.parentNode,l=null,c=null,u=null,g=null,p=null,C=null,y=null,S=null;switch(e){case"rows":l=function(){return n.getRowHeader(...arguments)},c=function(){return ft(...arguments)},u="ht__selection--rows",C="top";break;case"columns":l=function(){return n.getColumnHeader(...arguments)},c=function(){return at(...arguments)},u="ht__selection--columns",C="left";break;default:}if(a.classList.contains(u)){let O=this.wot.getSetting("columnHeaders").length;if(y=l(t,O-s),S=l(i,O-s),!y||!S)return!1;let M=Ot(y),_=Ot(S);return y&&S&&(g=M[C]-r[C]-1,p=_[C]+c(S)-M[C]),[y,g,p]}return!1}changeBorderStyle(e,t){let i=this[e].style,s=t[e];!s||s.hide?Te(this[e],"hidden"):(Ve(this[e],"hidden")&&je(this[e],"hidden"),i.backgroundColor=s.color,(e==="top"||e==="bottom")&&(i.height=`${s.width}px`),(e==="start"||e==="end")&&(i.width=`${s.width}px`))}changeBorderToDefaultStyle(e){let t={width:1,color:"#000"},i=this[e].style;i.backgroundColor=t.color,i.width=`${t.width}px`,i.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?Te(this[e],"hidden"):je(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",fi()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}},TO=Kw;var Zw=class{constructor(e,t){this.settings=e,this.cellRange=t||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}getBorder(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new TO(e,this.settings)),this.instanceBorders[e.guid]}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){let e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}addClassAtCoords(e,t,i,s){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,n=e.wtTable.getCell(this.settings.createCellCoords(t,i));if(typeof n=="object"){let a=s;r&&(a=this.classNameGenerator(n),this.classNames.includes(a)||this.classNames.push(a)),Te(n,a)}return this}linearClassNameGenerator(e,t){return function i(s){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(t===0||r===0)return e;let n=r>=0?r:t,a=e;n-=1;let l=n===0?e:`${e}-${n}`;if(Ve(s,l)){let c=n+1;a=`${e}-${c}`}else a=i(s,n);return a}}draw(e){if(this.isEmpty()){this.settings.border&&this.getBorder(e).disappear();return}let t=e.wtTable.getRenderedRowsCount(),i=e.wtTable.getRenderedColumnsCount(),s=this.getCorners(),[r,n,a,l]=s,{highlightHeaderClassName:c,highlightColumnClassName:u,highlightRowClassName:g,highlightOnlyClosestHeader:p,selectionType:C}=this.settings,y=C===void 0||["active-header","header"].includes(C);if(y&&n!==null&&l!==null){let S=0;for(let O=0;O<i;O+=1){let M=e.wtTable.columnFilter.renderedToSource(O);if(M>=n&&M<=l){let _=e.wtTable.getColumnHeaders(M),N=_.length-1;p&&_.length>1&&(_=[_[N]]);for(let E=0;E<_.length;E+=1){let k=[],ie=_[E];c&&k.push(c),u&&k.push(u),E=p?N:E;let $=e.getSetting("onBeforeHighlightingColumnHeader",M,E,{selectionType:C,columnCursor:S,selectionWidth:l-n+1,classNames:k});$!==M&&(ie=e.wtTable.getColumnHeader($,E)),Te(ie,k)}S+=1}}}if(r!==null&&a!==null){let S=0;for(let O=0;O<t;O+=1){let M=e.wtTable.rowFilter.renderedToSource(O);if(y&&M>=r&&M<=a){let _=e.wtTable.getRowHeaders(M),N=_.length-1;p&&_.length>1&&(_=[_[N]]);for(let E=0;E<_.length;E+=1){let k=[],ie=_[E];c&&k.push(c),g&&k.push(g),E=p?N:E;let $=e.getSetting("onBeforeHighlightingRowHeader",M,E,{selectionType:C,rowCursor:S,selectionHeight:a-r+1,classNames:k});$!==M&&(ie=e.wtTable.getRowHeader($,E)),Te(ie,k)}S+=1}if(n!==null&&l!==null)for(let _=0;_<i;_+=1){let N=e.wtTable.columnFilter.renderedToSource(_);M>=r&&M<=a&&N>=n&&N<=l?this.settings.className&&this.addClassAtCoords(e,M,N,this.settings.className,this.settings.markIntersections):M>=r&&M<=a?g&&this.addClassAtCoords(e,M,N,g):N>=n&&N<=l&&u&&this.addClassAtCoords(e,M,N,u);let E=e.getSetting("onAfterDrawSelection",M,N,this.settings.layerLevel);typeof E=="string"&&this.addClassAtCoords(e,M,N,E)}}}e.getSetting("onBeforeDrawBorders",s,this.settings.className),this.settings.border&&this.getBorder(e).appear(s)}destroy(){Object.values(this.instanceBorders).forEach(e=>e.destroy())}},Qw=Zw;function RO(o){let{isShiftKey:e,isLeftClick:t,isRightClick:i,coords:s,selection:r,controller:n,cellCoordsFactory:a}=o,l=r.isSelected()?r.getSelectedRange().current():null,c=r.isSelectedByCorner(),u=r.isSelectedByRowHeader();if(e&&l)s.row>=0&&s.col>=0&&!n.cell?r.setRangeEnd(s):(c||u)&&s.row>=0&&s.col>=0&&!n.cell?r.setRangeEnd(a(s.row,s.col)):c&&s.row<0&&!n.column?r.setRangeEnd(a(l.to.row,s.col)):u&&s.col<0&&!n.row?r.setRangeEnd(a(s.row,l.to.col)):(!c&&!u&&s.col<0||c&&s.col<0)&&!n.row?r.selectRows(Math.max(l.from.row,0),s.row,s.col):(!c&&!u&&s.row<0||u&&s.row<0)&&!n.column&&r.selectColumns(Math.max(l.from.col,0),s.col,s.row);else{let g=!r.inInSelection(s),p=t||i&&g;s.row<0&&s.col>=0&&!n.column?p&&r.selectColumns(s.col,s.col,s.row):s.col<0&&s.row>=0&&!n.row?p&&r.selectRows(s.row,s.row,s.col):s.col>=0&&s.row>=0&&!n.cell?p&&r.setRangeStart(s):s.col<0&&s.row<0&&r.selectAll(!0,!0)}}function fU(o){let{isLeftClick:e,coords:t,selection:i,controller:s,cellCoordsFactory:r}=o;if(!e)return;let n=i.isSelectedByRowHeader(),a=i.isSelectedByColumnHeader(),l=i.tableProps.countCols(),c=i.tableProps.countRows();a&&!s.column?i.setRangeEnd(r(c-1,t.col)):n&&!s.row?i.setRangeEnd(r(t.row,l-1)):s.cell||i.setRangeEnd(t)}var mU=new Map([["mousedown",RO],["mouseover",fU],["touchstart",RO]]);function Jw(o,e){let{coords:t,selection:i,controller:s,cellCoordsFactory:r}=e;mU.get(o.type)({coords:t,selection:i,controller:s,cellCoordsFactory:r,isShiftKey:o.shiftKey,isLeftClick:ln(o)||o.type==="touchstart",isRightClick:Ni(o)})}var MO=new WeakMap,Em=Symbol("rootInstance");function OO(o){MO.set(o,!0)}function AO(o){return o===Em}function Qh(o){return MO.has(o)}function IO(o,e,t){pU(o,e),e.set(o,t)}function pU(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gr(o,e,t){return e=gU(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function gU(o){var e=CU(o,"string");return typeof e=="symbol"?e:String(e)}function CU(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}function _O(o,e){var t=PO(o,e,"get");return wU(o,t)}function wU(o,e){return e.get?e.get.call(o):e.value}function NO(o,e,t){var i=PO(o,e,"set");return yU(o,i,t),t}function PO(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function yU(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var gn=new WeakMap,ey=new WeakMap,ty=new WeakMap,iy=class{constructor(e){gr(this,"instance",void 0),gr(this,"eventManager",void 0),gr(this,"settings",void 0),gr(this,"THEAD",void 0),gr(this,"TBODY",void 0),gr(this,"_wt",void 0),gr(this,"activeWt",void 0),IO(this,ey,{writable:!0,value:0}),IO(this,ty,{writable:!0,value:0}),gr(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new tt(this.instance),this.settings=this.instance.getSettings(),gn.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,t){let i=this._wt.getCell(e,t);return i<0?null:i}scrollViewport(e,t,i,s,r){return this._wt.scrollViewport(e,t,i,s,r)}scrollViewportHorizontally(e,t,i){return this._wt.scrollViewportHorizontally(e,t,i)}scrollViewportVertically(e,t,i){return this._wt.scrollViewportVertically(e,t,i)}createElements(){let e=gn.get(this),{rootElement:t,rootDocument:i}=this.instance,s=t.getAttribute("style");s&&t.setAttribute("data-originalstyle",s),Te(t,"handsontable"),e.table=i.createElement("TABLE"),Te(e.table,"htCore"),this.instance.getSettings().tableClassName&&Te(e.table,this.instance.getSettings().tableClassName),this.THEAD=i.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=i.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}registerEvents(){let e=gn.get(this),{rootElement:t,rootDocument:i,selection:s}=this.instance,r=i.documentElement;this.eventManager.addEventListener(t,"mousedown",n=>{if(e.selectionMouseDown=!0,!this.isTextSelectionAllowed(n.target)){let{rootWindow:a}=this.instance;hm(a),n.preventDefault(),a.focus()}}),this.eventManager.addEventListener(t,"mouseup",()=>{e.selectionMouseDown=!1}),this.eventManager.addEventListener(t,"mousemove",n=>{e.selectionMouseDown&&!this.isTextSelectionAllowed(n.target)&&(this.settings.fragmentSelection&&hm(this.instance.rootWindow),n.preventDefault())}),this.eventManager.addEventListener(r,"keyup",n=>{s.isInProgress()&&!n.shiftKey&&s.finish()}),this.eventManager.addEventListener(r,"mouseup",n=>{s.isInProgress()&&ln(n)&&s.finish(),e.mouseDown=!1,(da(i.activeElement)||!s.isSelected()&&!s.isSelectedByAnyHeader()&&!t.contains(n.target)&&!Ni(n))&&this.instance.unlisten()}),this.eventManager.addEventListener(r,"contextmenu",n=>{s.isInProgress()&&Ni(n)&&(s.finish(),e.mouseDown=!1)}),this.eventManager.addEventListener(r,"touchend",()=>{s.isInProgress()&&s.finish(),e.mouseDown=!1}),this.eventManager.addEventListener(r,"mousedown",n=>{let a=n.target,l=n.x||n.clientX,c=n.y||n.clientY,u=n.target;if(e.mouseDown||!t||!this.instance.view)return;let{holder:g}=this.instance.view._wt.wtTable;if(u===g){let C=Rt(i);if(i.elementFromPoint(l+C,c)!==g||i.elementFromPoint(l,c+C)!==g)return}else for(;u!==r;){if(u===null){if(n.isTargetWebComponent)break;return}if(u===t)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(a):this.settings.outsideClickDeselects)?this.instance.deselectCell():this.instance.destroyEditor(!1,!1)}),this.eventManager.addEventListener(e.table,"selectstart",n=>{this.settings.fragmentSelection||rn(n.target)||n.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:i}=e;return this.instance._createCellCoords(...this.translateFromRenderableToVisualIndex(t,i))}translateFromRenderableToVisualIndex(e,t){let i=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,s=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return i===null&&(i=e),s===null&&(s=t),[i,s]}countRenderableIndexes(e,t){let i=Math.min(e.getNotTrimmedIndexesLength(),t),s=e.getNearestNotHiddenIndex(i-1,-1);return s===null?0:e.getRenderableFromVisualIndex(s)+1}countRenderableColumns(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,i,s){if(isNaN(e)||e<0)return 0;let r=i.getNearestNotHiddenIndex(e,t),n=i.getRenderableFromVisualIndex(r);if(!Number.isInteger(n))return 0;let a=0;return t<0?a=n+1:t>0&&(a=s-n),a}countNotHiddenFixedColumnsStart(){let e=this.instance.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){let e=this.instance.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){let e=this.instance.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}isMainTableNotFullyCoveredByOverlays(){let e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>t}initializeWalkontable(){let e=gn.get(this),t={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e.table,isDataViewInstance:()=>Qh(this.instance),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(n,a)=>this.instance.getDataAtCell(...this.translateFromRenderableToVisualIndex(n,a)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{let n=[];return this.instance.hasRowHeaders()&&n.push((a,l)=>{let c=a>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(a):a;this.appendRowHeader(c,l)}),this.instance.runHooks("afterGetRowHeaderRenderers",n),NO(this,ty,n.length),n},columnHeaders:()=>{let n=[];return this.instance.hasColHeaders()&&n.push((a,l)=>{let c=a>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(a):a;this.appendColHeader(c,l)}),this.instance.runHooks("afterGetColumnHeaderRenderers",n),NO(this,ey,n.length),n},columnWidth:n=>{let a=this.instance.columnIndexMapper.getVisualFromRenderableIndex(n);return this.instance.getColWidth(a===null?n:a)},rowHeight:n=>{let a=this.instance.rowIndexMapper.getVisualFromRenderableIndex(n);return this.instance.getRowHeight(a===null?n:a)},cellRenderer:(n,a,l)=>{let[c,u]=this.translateFromRenderableToVisualIndex(n,a),g=this.instance.runHooks("modifyGetCellCoords",c,u),p=c,C=u;Array.isArray(g)&&([p,C]=g);let y=this.instance.getCellMeta(p,C),S=this.instance.colToProp(C),O=this.instance.getDataAtRowProp(p,S);this.instance.hasHook("beforeValueRender")&&(O=this.instance.runHooks("beforeValueRender",O,y)),this.instance.runHooks("beforeRenderer",l,c,u,S,O,y),this.instance.getCellRenderer(y)(this.instance,l,c,u,S,O,y),this.instance.runHooks("afterRenderer",l,c,u,S,O,y)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onContainerElementResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onCellMouseDown:(n,a,l,c)=>{let u=this.translateFromRenderableToVisualCoords(a),g={row:!1,column:!1,cell:!1};this.instance.listen(),this.activeWt=c,e.mouseDown=!0,this.instance.runHooks("beforeOnCellMouseDown",n,u,l,g),!To(n)&&(Jw(n,{coords:u,selection:this.instance.selection,controller:g,cellCoordsFactory:(p,C)=>this.instance._createCellCoords(p,C)}),this.instance.runHooks("afterOnCellMouseDown",n,u,l),this.activeWt=this._wt)},onCellContextMenu:(n,a,l,c)=>{let u=this.translateFromRenderableToVisualCoords(a);this.activeWt=c,e.mouseDown=!1,this.instance.selection.isInProgress()&&this.instance.selection.finish(),this.instance.runHooks("beforeOnCellContextMenu",n,u,l),!To(n)&&(this.instance.runHooks("afterOnCellContextMenu",n,u,l),this.activeWt=this._wt)},onCellMouseOut:(n,a,l,c)=>{let u=this.translateFromRenderableToVisualCoords(a);this.activeWt=c,this.instance.runHooks("beforeOnCellMouseOut",n,u,l),!To(n)&&(this.instance.runHooks("afterOnCellMouseOut",n,u,l),this.activeWt=this._wt)},onCellMouseOver:(n,a,l,c)=>{let u=this.translateFromRenderableToVisualCoords(a),g={row:!1,column:!1,cell:!1};this.activeWt=c,this.instance.runHooks("beforeOnCellMouseOver",n,u,l,g),!To(n)&&(e.mouseDown&&Jw(n,{coords:u,selection:this.instance.selection,controller:g,cellCoordsFactory:(p,C)=>this.instance._createCellCoords(p,C)}),this.instance.runHooks("afterOnCellMouseOver",n,u,l),this.activeWt=this._wt)},onCellMouseUp:(n,a,l,c)=>{let u=this.translateFromRenderableToVisualCoords(a);this.activeWt=c,this.instance.runHooks("beforeOnCellMouseUp",n,u,l),!(To(n)||this.instance.isDestroyed)&&(this.instance.runHooks("afterOnCellMouseUp",n,u,l),this.activeWt=this._wt)},onCellCornerMouseDown:n=>{n.preventDefault(),this.instance.runHooks("afterOnCellCornerMouseDown",n)},onCellCornerDblClick:n=>{n.preventDefault(),this.instance.runHooks("afterOnCellCornerDblClick",n)},beforeDraw:(n,a)=>this.beforeRender(n,a),onDraw:n=>this.afterRender(n),onScrollVertically:()=>this.instance.runHooks("afterScrollVertically"),onScrollHorizontally:()=>this.instance.runHooks("afterScrollHorizontally"),onBeforeRemoveCellClassNames:()=>this.instance.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(n,a,l)=>{let c=this.instance.rowIndexMapper,u=c.getVisualFromRenderableIndex(n),g=this.instance.runHooks("beforeHighlightingRowHeader",u,a,l);return c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(g,1))},onBeforeHighlightingColumnHeader:(n,a,l)=>{let c=this.instance.columnIndexMapper,u=c.getVisualFromRenderableIndex(n),g=this.instance.runHooks("beforeHighlightingColumnHeader",u,a,l);return c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(g,1))},onAfterDrawSelection:(n,a,l)=>{let c,[u,g]=this.translateFromRenderableToVisualIndex(n,a),p=this.instance.selection.getSelectedRange(),C=p.size();if(C>0){let y=(l??0)+1-C,S=p.peekByIndex(y);c=[S.from.row,S.from.col,S.to.row,S.to.col]}return this.instance.runHooks("afterDrawSelection",u,g,c,l)},onBeforeDrawBorders:(n,a)=>{let[l,c,u,g]=n,p=[this.instance.rowIndexMapper.getVisualFromRenderableIndex(l),this.instance.columnIndexMapper.getVisualFromRenderableIndex(c),this.instance.rowIndexMapper.getVisualFromRenderableIndex(u),this.instance.columnIndexMapper.getVisualFromRenderableIndex(g)];return this.instance.runHooks("beforeDrawBorders",p,a)},onBeforeTouchScroll:()=>this.instance.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.instance.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(n,a)=>{let l=this.instance.columnIndexMapper.getVisualFromRenderableIndex(a);return this.instance.runHooks("beforeStretchingColumnWidth",n,l)},onModifyRowHeaderWidth:n=>this.instance.runHooks("modifyRowHeaderWidth",n),onModifyGetCellCoords:(n,a,l)=>{let c=this.instance.rowIndexMapper,u=this.instance.columnIndexMapper,g=a>=0?u.getVisualFromRenderableIndex(a):a,p=n>=0?c.getVisualFromRenderableIndex(n):n,C=this.instance.runHooks("modifyGetCellCoords",p,g,l);if(Array.isArray(C)){let[y,S,O,M]=C;return[y>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(y,1)):y,S>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(S,1)):S,O>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(O,-1)):O,M>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(M,-1)):M]}},viewportRowCalculatorOverride:n=>{let a=this.settings.viewportRowRenderingOffset;if(a==="auto"&&this.settings.fixedRowsTop&&(a=10),a>0||a==="auto"){let l=this.countRenderableRows(),c=n.startRow,u=n.endRow;if(typeof a=="number")n.startRow=Math.max(c-a,0),n.endRow=Math.min(u+a,l-1);else if(a==="auto"){let g=Math.ceil(u/l*12);n.startRow=Math.max(c-g,0),n.endRow=Math.min(u+g,l-1)}}this.instance.runHooks("afterViewportRowCalculatorOverride",n)},viewportColumnCalculatorOverride:n=>{let a=this.settings.viewportColumnRenderingOffset;if(a==="auto"&&this.settings.fixedColumnsStart&&(a=10),a>0||a==="auto"){let l=this.countRenderableColumns(),c=n.startColumn,u=n.endColumn;if(typeof a=="number"&&(n.startColumn=Math.max(c-a,0),n.endColumn=Math.min(u+a,l-1)),a==="auto"){let g=Math.ceil(u/l*6);n.startColumn=Math.max(c-g,0),n.endColumn=Math.min(u+g,l-1)}}this.instance.runHooks("afterViewportColumnCalculatorOverride",n)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{let n=this.instance.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||n}};this.instance.runHooks("beforeInitWalkontable",t),this._wt=new Aa(t),this.activeWt=this._wt;let i=this._wt.wtTable.spreader,{width:s,height:r}=this.instance.rootElement.getBoundingClientRect();this.setLastSize(s,r),this.eventManager.addEventListener(i,"mousedown",n=>{n.target===i&&n.which===3&&n.stopPropagation()}),this.eventManager.addEventListener(i,"contextmenu",n=>{n.target===i&&n.which===3&&n.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.instance.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(rn(e))return!0;let t=rs(e,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return gn.get(this).mouseDown}isSelectedOnlyCell(){var e,t;return(e=(t=this.instance.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())!==null&&e!==void 0?e:!1}isCellEdited(){let e=this.instance.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,t)}afterRender(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){let i=t.firstChild;if(!Ve(i,"relative")){li(t),this.appendRowHeader(e,t);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{let{rootDocument:i,getRowHeader:s}=this.instance,r=i.createElement("div"),n=i.createElement("span");r.className="relative",n.className="rowHeader",this.updateCellHeader(n,e,s),r.appendChild(n),t.appendChild(r)}this.instance.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(t.firstChild){let r=t.firstChild;Ve(r,"relative")?this.updateCellHeader(r.querySelector(".colHeader"),e,i,s):(li(t),this.appendColHeader(e,t,i,s))}else{let{rootDocument:r}=this.instance,n=r.createElement("div"),a=r.createElement("span");n.className="relative",a.className="colHeader",this.updateCellHeader(a,e,i,s),n.appendChild(a),t.appendChild(n)}this.instance.runHooks("afterGetColHeader",e,t,s)}updateCellHeader(e,t,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,r=t,n=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ve(e,"colHeader")?r=n.wtTable.columnFilter.sourceToRendered(t):Ve(e,"rowHeader")&&(r=n.wtTable.rowFilter.sourceToRendered(t))),r>-1?Yi(e,i(t,s)):(ji(e,String.fromCharCode(160)),Te(e,"cornerHeader"))}maximumVisibleElementWidth(e){let i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){let i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,t){let i=gn.get(this);[i.lastWidth,i.lastHeight]=[e,t]}getLastSize(){let e=gn.get(this);return{width:e.lastWidth,height:e.lastHeight}}getFirstFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return _O(this,ey)}getRowHeadersCount(){return _O(this,ty)}destroy(){this._wt.destroy(),this.eventManager.destroy()}},LO=iy;var ny={};Ri(ny,{countFirstRowKeys:()=>ec,createEmptySpreadsheetData:()=>SU,createSpreadsheetData:()=>bU,createSpreadsheetObjectData:()=>xU,dataRowToChangesArray:()=>Tm,isArrayOfArrays:()=>oy,isArrayOfObjects:()=>ry,spreadsheetColumnIndex:()=>vU,spreadsheetColumnLabel:()=>Jh});var DO="ABCDEFGHIJKLMNOPQRSTUVWXYZ",sy=DO.length;function Jh(o){let e=o+1,t="",i;for(;e>0;)i=(e-1)%sy,t=String.fromCharCode(65+i)+t,e=parseInt((e-i)/sy,10);return t}function vU(o){let e=0;if(o)for(let t=0,i=o.length-1;t<o.length;t+=1,i-=1)e+=sy**i*(DO.indexOf(o[t])+1);return e-=1,e}function bU(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,t=[],i,s;for(i=0;i<o;i++){let r=[];for(s=0;s<e;s++)r.push(Jh(s)+(i+1));t.push(r)}return t}function xU(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,t=[],i,s;for(i=0;i<o;i++){let r={};for(s=0;s<e;s++)r[`prop${s}`]=Jh(s)+(i+1);t.push(r)}return t}function SU(o,e){let t=[],i;for(let s=0;s<o;s++){i=[];for(let r=0;r<e;r++)i.push("");t.push(i)}return t}function Tm(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=o,i=[];return(!Array.isArray(o)||!Array.isArray(o[0]))&&(t=[o]),t.forEach((s,r)=>{Array.isArray(s)?s.forEach((n,a)=>{i.push([r+e,a,n])}):Object.keys(s).forEach(n=>{i.push([r+e,n,s[n]])})}),i}function ec(o){let e=0;return Array.isArray(o)&&(o[0]&&Array.isArray(o[0])?e=o[0].length:o[0]&&$e(o[0])&&(e=an(o[0]))),e}function oy(o){return!!(Array.isArray(o)&&o.length&&o.every(e=>Array.isArray(e)))}function ry(o){return!!(Array.isArray(o)&&o.length&&o.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}var ay=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.hot=e,this.data=t,this.dataType="array",this.colToProp=()=>{},this.propToCol=()=>{}}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){let t=[];return we(this.data,(i,s)=>{let r=this.getAtCell(s,e);t.push(r)}),t}getAtRow(e,t,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,r=t===void 0&&i===void 0,n=null,a=null;if(n=this.modifyRowData(e),Array.isArray(n))a=[],r?n.forEach((l,c)=>{a[c]=this.getAtPhysicalCell(e,c,n)}):ke(t,i,l=>{a[l-t]=this.getAtPhysicalCell(e,l,n)});else if($e(n)||ht(n))if(s?a=[]:a={},!r||s){let c=this.countFirstRowKeys()-1;ke(0,c,u=>{let g=this.colToProp(u);if(u>=(t||0)&&u<=(i||c)&&!Number.isInteger(g)){let p=this.getAtPhysicalCell(e,g,n);s?a.push(p):Ch(a,g,p)}})}else ze(n,(l,c)=>{Ch(a,c,this.getAtPhysicalCell(e,c,n))});return a}setAtCell(e,t,i){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){let s=_s(i);this.hot.runHooks("modifySourceData",e,t,s,"set"),s.isTouched()&&(i=s.value)}Number.isInteger(t)?this.data[e][t]=i:Ch(this.data[e],t,i)}}getAtPhysicalCell(e,t,i){let s=null;if(i&&(typeof t=="string"?s=sw(i,t):typeof t=="function"?s=t(i):s=i[t]),this.hot.hasHook("modifySourceData")){let r=_s(s);this.hot.runHooks("modifySourceData",e,t,r,"get"),r.isTouched()&&(s=r.value)}return s}getAtCell(e,t){let i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=!1,r=null,n=null,a=null,l=null;e===null||t===null?(s=!0,r=0,a=this.countRows()-1):(r=Math.min(e.row,t.row),n=Math.min(e.col,t.col),a=Math.max(e.row,t.row),l=Math.max(e.col,t.col));let c=[];return ke(r,a,u=>{c.push(s?this.getAtRow(u,void 0,void 0,i):this.getAtRow(u,n,l,i))}),c}countRows(){if(this.hot.hasHook("modifySourceLength")){let e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return ec(this.data)}destroy(){this.data=null,this.hot=null}},kO=ay;var EU="localHooks",HO={_localHooks:Object.create(null),addLocalHook(o,e){return this._localHooks[o]||(this._localHooks[o]=[]),this._localHooks[o].push(e),this},runLocalHooks(o,e,t,i,s,r,n){if(this._localHooks[o]){let a=this._localHooks[o].length;for(let l=0;l<a;l++)fa(this._localHooks[o][l],this,e,t,i,s,r,n)}},clearLocalHooks(){return this._localHooks={},this}};hi(HO,"MIXIN_NAME",EU,{writable:!1,enumerable:!1});var Nt=HO;var Mi=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.indexedValues=[],this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){let t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ht(this.initValueOrFn)?ke(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):ke(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}};et(Mi,Nt);function Ia(o,e,t,i){let s=t.length?t[0]:void 0;return[...o.slice(0,s),...t.map((r,n)=>ht(i)?i(r,n):i),...s===void 0?[]:o.slice(s)]}function _a(o,e){return zt(o,(t,i)=>e.includes(i)===!1)}var mi=class extends Mi{insert(e,t){this.indexedValues=Ia(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=_a(this.indexedValues,e),super.remove(e)}};var zs=class extends mi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return pt(this.getValues(),(e,t,i)=>(t&&e.push(i),e),[])}};function Na(o,e,t){return[...o.slice(0,e),...t,...o.slice(e)]}function Io(o,e){return zt(o,t=>e.includes(t)===!1)}function Cr(o,e){return Ge(o,t=>t-e.filter(i=>i<t).length)}function wr(o,e){let t=e[0],i=e.length;return Ge(o,s=>s>=t?s+i:s)}function TU(o,e,t){return e=RU(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function RU(o){var e=MU(o,"string");return typeof e=="symbol"?e:String(e)}function MU(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var $s=class extends Mi{constructor(){super(...arguments),TU(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Io(this.orderOfIndexes,[e]),ht(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=Ia(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=wr(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=_a(this.indexedValues,e),this.orderOfIndexes=Io(this.orderOfIndexes,e),this.orderOfIndexes=Cr(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}};var fs=class extends mi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return pt(this.getValues(),(e,t,i)=>(t&&e.push(i),e),[])}};var FO=new Map([["indexesSequence",{getListWithInsertedItems:Na,getListWithRemovedItems:Io}],["physicallyIndexed",{getListWithInsertedItems:Ia,getListWithRemovedItems:_a}]]),tc=o=>{if(FO.has(o)===!1)throw new Error(`Alter strategy with ID '${o}' does not exist.`);return FO.get(o)};var Pa=class extends Mi{constructor(){super(e=>e)}insert(e,t){let i=wr(this.indexedValues,t);this.indexedValues=Na(i,e,t),super.insert(e,t)}remove(e){let t=Io(this.indexedValues,e);this.indexedValues=Cr(t,e),super.remove(e)}};var BO=new Map([["hiding",zs],["index",Mi],["linkedPhysicalIndexToValue",$s],["physicalIndexToValue",mi],["trimming",fs]]);function VO(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!BO.has(o))throw new Error(`The provided map type ("${o}") does not exist.`);return new(BO.get(o))(e)}var ly=0,Cn=class{constructor(){this.collection=new Map}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)),ly+=1)}unregister(e){let t=this.collection.get(e);Pe(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),ly-=1)}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return nt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(i=>{i.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}};et(Cn,Nt);function hy(){return ly}var ic=class extends Cn{constructor(e,t){super(),this.mergedValuesCache=[],this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];let t=Ge(this.get(),r=>r.getValues()),i=[],s=Pe(t[0])&&t[0].length||0;for(let r=0;r<s;r+=1){let n=[];for(let a=0;a<this.getLength();a+=1)n.push(t[a][r]);i.push(n)}return Ge(i,this.aggregationFunction)}getMergedValueAtIndex(e,t){let i=this.getMergedValues(t)[e];return Pe(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}};function OU(o,e,t){AU(o,e),e.set(o,t)}function AU(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IU(o,e,t){var i=WO(o,e,"set");return _U(o,i,t),t}function _U(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function NU(o,e){var t=WO(o,e,"get");return PU(o,t)}function WO(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function PU(o,e){return e.get?e.get.call(o):e.value}var cy=new WeakMap,sc=class{constructor(){OU(this,cy,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(NU(this,cy)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){IU(this,cy,e)}};et(sc,Nt);function uy(o,e){let t=[],i=0,s=0;for(;i<o.length&&s<e.length;i++,s++)o[i]!==e[s]&&t.push({op:"replace",index:s,oldValue:o[i],newValue:e[s]});for(;i<e.length;i++)t.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;s<o.length;s++)t.push({op:"remove",index:s,oldValue:o[s],newValue:void 0});return t}function oc(o,e,t){LU(o,e),e.set(o,t)}function LU(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ms(o,e){var t=UO(o,e,"get");return DU(o,t)}function DU(o,e){return e.get?e.get.call(o):e.value}function Rm(o,e,t){var i=UO(o,e,"set");return kU(o,i,t),t}function UO(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function kU(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Mm=new WeakMap,rc=new WeakMap,Om=new WeakMap,Am=new WeakMap,Im=new WeakMap,_m=class{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};oc(this,Mm,{writable:!0,value:new Set}),oc(this,rc,{writable:!0,value:[]}),oc(this,Om,{writable:!0,value:[]}),oc(this,Am,{writable:!0,value:!1}),oc(this,Im,{writable:!0,value:!1}),Rm(this,Im,e??!1)}createObserver(){let e=new sc;return ms(this,Mm).add(e),e.addLocalHook("unsubscribe",()=>{ms(this,Mm).delete(e)}),e._writeInitialChanges(uy(ms(this,rc),ms(this,Om))),e}emit(e){let t=ms(this,Om);(!ms(this,Am)||ms(this,rc).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(ms(this,Im)):Rm(this,rc,new Array(e.length).fill(ms(this,Im))),ms(this,Am)||(Rm(this,Am,!0),t=ms(this,rc)));let i=uy(t,e);ms(this,Mm).forEach(s=>s._write(i)),Rm(this,Om,e)}};var wn=class{constructor(){this.indexesSequence=new Pa,this.trimmingMapsCollection=new ic(e=>e.some(t=>t===!0),!1),this.hidingMapsCollection=new ic(e=>e.some(t=>t===!0),!1),this.variousMapsCollection=new Cn,this.hidingChangesObservable=new _m({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,i){return this.registerMap(e,VO(t,i))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof fs?this.trimmingMapsCollection.register(e,t):t instanceof zs?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);let i=this.getNumberOfIndexes();return i>0&&t.init(i),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){let t=this.notTrimmedIndexesCache[e];return Pe(t)?t:null}getPhysicalFromRenderableIndex(e){let t=this.renderablePhysicalIndexesCache[e];return Pe(t)?t:null}getVisualFromPhysicalIndex(e){let t=this.fromPhysicalToVisualIndexesCache.get(e);return Pe(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){let t=this.fromVisualToRenderableIndexesCache.get(e);return Pe(t)?t:null}getNearestNotHiddenIndex(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;let r=Array.from(this.fromVisualToRenderableIndexesCache.keys()),n=-1;return t>0?n=r.findIndex(a=>a>e):n=r.reverse().findIndex(a=>a<e),n===-1?i?this.getNearestNotHiddenIndex(e,-t,!1):null:r[n]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){let t=this.getNumberOfIndexes();if(e<t){let i=[...Array(this.getNumberOfIndexes()-e).keys()].map(s=>s+e);this.removeIndexes(i)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);let i=Ge(e,c=>this.getPhysicalFromVisualIndex(c)),s=this.getNotTrimmedIndexesLength(),r=e.length,n=Io(this.getIndexesSequence(),i),a=n.filter(c=>this.isTrimmed(c)===!1),l=n.indexOf(a[a.length-1])+1;if(t+r<s){let c=a[t];l=n.indexOf(c)}this.indexesChangeSource="move",this.setIndexesSequence(Na(n,l,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){let i=this.getNotTrimmedIndexes()[e],s=Pe(i)?i:this.getNumberOfIndexes(),r=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),n=Ge(new Array(t).fill(s),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(r,n),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(r,n),this.hidingMapsCollection.insertToEvery(r,n),this.variousMapsCollection.insertToEvery(r,n),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){let e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){let i=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(i,t)}}cacheFromVisualToRenderableIndexes(){let e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){let i=this.getPhysicalFromRenderableIndex(t),s=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(s,t)}}};et(wn,Nt);function YO(o,e){return ze(e,(t,i)=>{nt(o[i])&&(o[i]=t)}),o}function Nm(o){let t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(o);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:o}function Pm(o){Pe(o)&&ga(st`Language with code "${o}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function dy(o,e){return Array.isArray(o)&&Number.isInteger(e)?o[e]:o}var{register:HU,getValues:FU}=qt("phraseFormatters");function BU(o,e){HU(o,e)}function jO(){return FU()}BU("pluralize",dy);var Xe={};Ri(Xe,{CONTEXTMENU_ITEMS_ADD_COMMENT:()=>Rc,CONTEXTMENU_ITEMS_ALIGNMENT:()=>Ic,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:()=>Hc,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:()=>Nc,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:()=>Lc,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:()=>_c,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:()=>kc,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:()=>Pc,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:()=>Dc,CONTEXTMENU_ITEMS_BORDERS:()=>Fc,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:()=>Wc,CONTEXTMENU_ITEMS_BORDERS_LEFT:()=>Uc,CONTEXTMENU_ITEMS_BORDERS_RIGHT:()=>Vc,CONTEXTMENU_ITEMS_BORDERS_TOP:()=>Bc,CONTEXTMENU_ITEMS_CLEAR_COLUMN:()=>gc,CONTEXTMENU_ITEMS_COPY:()=>Cc,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:()=>vc,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:()=>yc,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:()=>wc,CONTEXTMENU_ITEMS_CUT:()=>bc,CONTEXTMENU_ITEMS_EDIT_COMMENT:()=>Mc,CONTEXTMENU_ITEMS_FREEZE_COLUMN:()=>xc,CONTEXTMENU_ITEMS_HIDE_COLUMN:()=>zc,CONTEXTMENU_ITEMS_HIDE_ROW:()=>Xc,CONTEXTMENU_ITEMS_INSERT_LEFT:()=>hc,CONTEXTMENU_ITEMS_INSERT_RIGHT:()=>cc,CONTEXTMENU_ITEMS_MERGE_CELLS:()=>Ec,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:()=>Gc,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:()=>jc,CONTEXTMENU_ITEMS_NO_ITEMS:()=>nc,CONTEXTMENU_ITEMS_READ_ONLY:()=>pc,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:()=>Ac,CONTEXTMENU_ITEMS_REDO:()=>mc,CONTEXTMENU_ITEMS_REMOVE_BORDERS:()=>Yc,CONTEXTMENU_ITEMS_REMOVE_COLUMN:()=>dc,CONTEXTMENU_ITEMS_REMOVE_COMMENT:()=>Oc,CONTEXTMENU_ITEMS_REMOVE_ROW:()=>uc,CONTEXTMENU_ITEMS_ROW_ABOVE:()=>ac,CONTEXTMENU_ITEMS_ROW_BELOW:()=>lc,CONTEXTMENU_ITEMS_SHOW_COLUMN:()=>$c,CONTEXTMENU_ITEMS_SHOW_ROW:()=>qc,CONTEXTMENU_ITEMS_UNDO:()=>fc,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:()=>Sc,CONTEXTMENU_ITEMS_UNMERGE_CELLS:()=>Tc,CONTEXT_MENU_ITEMS_NAMESPACE:()=>GO,FILTERS_BUTTONS_CANCEL:()=>bu,FILTERS_BUTTONS_CLEAR:()=>yu,FILTERS_BUTTONS_OK:()=>vu,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:()=>xu,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:()=>Eu,FILTERS_BUTTONS_PLACEHOLDER_VALUE:()=>Su,FILTERS_BUTTONS_SELECT_ALL:()=>wu,FILTERS_CONDITIONS_AFTER:()=>cu,FILTERS_CONDITIONS_BEFORE:()=>uu,FILTERS_CONDITIONS_BEGINS_WITH:()=>eu,FILTERS_CONDITIONS_BETWEEN:()=>lu,FILTERS_CONDITIONS_BY_VALUE:()=>VU,FILTERS_CONDITIONS_CONTAINS:()=>iu,FILTERS_CONDITIONS_EMPTY:()=>Kc,FILTERS_CONDITIONS_ENDS_WITH:()=>tu,FILTERS_CONDITIONS_EQUAL:()=>Qc,FILTERS_CONDITIONS_GREATER_THAN:()=>ou,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:()=>ru,FILTERS_CONDITIONS_LESS_THAN:()=>nu,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:()=>au,FILTERS_CONDITIONS_NAMESPACE:()=>Wt,FILTERS_CONDITIONS_NONE:()=>yn,FILTERS_CONDITIONS_NOT_BETWEEN:()=>hu,FILTERS_CONDITIONS_NOT_CONTAIN:()=>su,FILTERS_CONDITIONS_NOT_EMPTY:()=>Zc,FILTERS_CONDITIONS_NOT_EQUAL:()=>Jc,FILTERS_CONDITIONS_TODAY:()=>du,FILTERS_CONDITIONS_TOMORROW:()=>fu,FILTERS_CONDITIONS_YESTERDAY:()=>mu,FILTERS_DIVS_FILTER_BY_CONDITION:()=>pu,FILTERS_DIVS_FILTER_BY_VALUE:()=>gu,FILTERS_LABELS_CONJUNCTION:()=>Cu,FILTERS_LABELS_DISJUNCTION:()=>vn,FILTERS_NAMESPACE:()=>bi,FILTERS_VALUES_BLANK_CELLS:()=>La});var GO="ContextMenu:items",ot=GO,nc=`${ot}.noItems`,ac=`${ot}.insertRowAbove`,lc=`${ot}.insertRowBelow`,hc=`${ot}.insertColumnOnTheLeft`,cc=`${ot}.insertColumnOnTheRight`,uc=`${ot}.removeRow`,dc=`${ot}.removeColumn`,fc=`${ot}.undo`,mc=`${ot}.redo`,pc=`${ot}.readOnly`,gc=`${ot}.clearColumn`,Cc=`${ot}.copy`,wc=`${ot}.copyWithHeaders`,yc=`${ot}.copyWithGroupHeaders`,vc=`${ot}.copyHeadersOnly`,bc=`${ot}.cut`,xc=`${ot}.freezeColumn`,Sc=`${ot}.unfreezeColumn`,Ec=`${ot}.mergeCells`,Tc=`${ot}.unmergeCells`,Rc=`${ot}.addComment`,Mc=`${ot}.editComment`,Oc=`${ot}.removeComment`,Ac=`${ot}.readOnlyComment`,Ic=`${ot}.align`,_c=`${ot}.align.left`,Nc=`${ot}.align.center`,Pc=`${ot}.align.right`,Lc=`${ot}.align.justify`,Dc=`${ot}.align.top`,kc=`${ot}.align.middle`,Hc=`${ot}.align.bottom`,Fc=`${ot}.borders`,Bc=`${ot}.borders.top`,Vc=`${ot}.borders.right`,Wc=`${ot}.borders.bottom`,Uc=`${ot}.borders.left`,Yc=`${ot}.borders.remove`,jc=`${ot}.nestedHeaders.insertChildRow`,Gc=`${ot}.nestedHeaders.detachFromParent`,zc=`${ot}.hideColumn`,$c=`${ot}.showColumn`,Xc=`${ot}.hideRow`,qc=`${ot}.showRow`,bi="Filters:",Wt=`${bi}conditions`,yn=`${Wt}.none`,Kc=`${Wt}.isEmpty`,Zc=`${Wt}.isNotEmpty`,Qc=`${Wt}.isEqualTo`,Jc=`${Wt}.isNotEqualTo`,eu=`${Wt}.beginsWith`,tu=`${Wt}.endsWith`,iu=`${Wt}.contains`,su=`${Wt}.doesNotContain`,VU=`${Wt}.byValue`,ou=`${Wt}.greaterThan`,ru=`${Wt}.greaterThanOrEqualTo`,nu=`${Wt}.lessThan`,au=`${Wt}.lessThanOrEqualTo`,lu=`${Wt}.isBetween`,hu=`${Wt}.isNotBetween`,cu=`${Wt}.after`,uu=`${Wt}.before`,du=`${Wt}.today`,fu=`${Wt}.tomorrow`,mu=`${Wt}.yesterday`,pu=`${bi}labels.filterByCondition`,gu=`${bi}labels.filterByValue`,Cu=`${bi}labels.conjunction`,vn=`${bi}labels.disjunction`,La=`${bi}values.blankCells`,wu=`${bi}buttons.selectAll`,yu=`${bi}buttons.clear`,vu=`${bi}buttons.ok`,bu=`${bi}buttons.cancel`,xu=`${bi}buttons.placeholder.search`,Su=`${bi}buttons.placeholder.value`,Eu=`${bi}buttons.placeholder.secondValue`;var WU={languageCode:"en-US",[nc]:"No available options",[ac]:"Insert row above",[lc]:"Insert row below",[hc]:"Insert column left",[cc]:"Insert column right",[uc]:["Remove row","Remove rows"],[dc]:["Remove column","Remove columns"],[fc]:"Undo",[mc]:"Redo",[pc]:"Read only",[gc]:"Clear column",[Ic]:"Alignment",[_c]:"Left",[Nc]:"Center",[Pc]:"Right",[Lc]:"Justify",[Dc]:"Top",[kc]:"Middle",[Hc]:"Bottom",[xc]:"Freeze column",[Sc]:"Unfreeze column",[Fc]:"Borders",[Bc]:"Top",[Vc]:"Right",[Wc]:"Bottom",[Uc]:"Left",[Yc]:"Remove border(s)",[Rc]:"Add comment",[Mc]:"Edit comment",[Oc]:"Delete comment",[Ac]:"Read-only comment",[Ec]:"Merge cells",[Tc]:"Unmerge cells",[Cc]:"Copy",[wc]:["Copy with header","Copy with headers"],[yc]:["Copy with group header","Copy with group headers"],[vc]:["Copy header only","Copy headers only"],[bc]:"Cut",[jc]:"Insert child row",[Gc]:"Detach from parent",[zc]:["Hide column","Hide columns"],[$c]:["Show column","Show columns"],[Xc]:["Hide row","Hide rows"],[qc]:["Show row","Show rows"],[yn]:"None",[Kc]:"Is empty",[Zc]:"Is not empty",[Qc]:"Is equal to",[Jc]:"Is not equal to",[eu]:"Begins with",[tu]:"Ends with",[iu]:"Contains",[su]:"Does not contain",[ou]:"Greater than",[ru]:"Greater than or equal to",[nu]:"Less than",[au]:"Less than or equal to",[lu]:"Is between",[hu]:"Is not between",[cu]:"After",[uu]:"Before",[du]:"Today",[fu]:"Tomorrow",[mu]:"Yesterday",[La]:"Blank cells",[pu]:"Filter by condition",[gu]:"Filter by value",[Cu]:"And",[vn]:"Or",[wu]:"Select all",[yu]:"Clear",[vu]:"OK",[bu]:"Cancel",[xu]:"Search",[Su]:"Value",[Eu]:"Second value"},fy=WU;var zO=Xe,my=fy.languageCode,{register:UU,getItem:$O,hasItem:YU,getValues:jU}=qt("languagesDictionaries");py(fy);function py(o,e){let t=o,i=e;return $e(o)&&(i=o,t=i.languageCode),GU(t,i),UU(t,Xt(i)),Xt(i)}function GU(o,e){o!==my&&YO(e,$O(my))}function gy(o){return Lm(o)?Xt($O(o)):null}function Lm(o){return YU(o)}function XO(){return jU()}function Dm(o,e,t){let i=gy(o);if(i===null)return null;let s=i[e];if(nt(s))return null;let r=zU(s,t);return Array.isArray(r)?r[0]:r}function zU(o,e){let t=o;return we(jO(),i=>{t=i(o,e)}),t}function qO(o){let e=Nm(o);return Lm(e)||(e=my,Pm(o)),e}var yr="active-header",vr="area",_o="cell",Da="fill",Xs="header",ka="custom-selection";function $U(o,e,t){return e=XU(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function XU(o){var e=qU(o,"string");return typeof e=="symbol"?e:String(e)}function qU(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var Cy=class extends Qw{constructor(e,t){super(e,null),$U(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:i}=e,s=this.getNearestNotHiddenCoords(t,1),r=this.getNearestNotHiddenCoords(i,-1);if(s===null||r===null)return null;if(s.row>r.row||s.col>r.col){if(!(this.settings.type==="header"||this.settings.type==="active-header"))return null;s=t,r=i}return this.settings.createCellRange(s,s,r)}getNearestNotHiddenCoords(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,s=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),e.row,t);if(s===null)return null;let r=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),e.col,i);return r===null?null:this.settings.createCellCoords(s,r)}getNearestNotHiddenIndex(e,t,i){if(t<0)return t;let s=e.getNearestNotHiddenIndex(t,i);return(this.settings.type==="header"||this.settings.type==="active-header")&&s===null?-1:s}commit(){if(this.visualCellRange===null)return this;let e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){let t=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,s=this.getNearestNotHiddenCoords(e.from.clone().normalize(),t,i);if(s!==null&&e.overlaps(s)){if(this.cellRange===null){let r=this.settings.visualToRenderableCoords(s);this.cellRange=this.settings.createCellRange(r)}return e.setHighlight(s),this}return e.setHighlight(e.from),this}getCorners(){let{from:e,to:t}=this.cellRange,i=e.row===null||t.row===null,s=e.col===null||t.col===null,r=this.settings.createCellCoords(i?null:Math.min(e.row,t.row),s?null:Math.min(e.col,t.col)),n=this.settings.createCellCoords(i?null:Math.max(e.row,t.row),s?null:Math.max(e.col,t.col));return[r.row,r.col,n.row,n.col]}getVisualCorners(){let e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){let i=this.settings.visualToRenderableCoords(e),s=this.settings.visualToRenderableCoords(t);return this.settings.createCellRange(i,i,s)}},ps=Cy;function KU(o){let{activeHeaderClassName:e,...t}=o;return new ps({highlightHeaderClassName:e,...t,selectionType:yr})}var KO=KU;function ZU(o){let{layerLevel:e,areaCornerVisible:t,...i}=o;return new ps({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:t},...i,selectionType:vr})}var ZO=ZU;function QU(o){let{cellCornerVisible:e,...t}=o;return new ps({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e},...t,selectionType:_o})}var QO=QU;function JU(o){let{border:e,visualCellRange:t,...i}=o;return new ps({...e,...i,selectionType:ka},t)}var JO=JU;function eY(o){let{...e}=o;return new ps({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:Da})}var eA=eY;function tY(o){let{headerClassName:e,rowClassName:t,columnClassName:i,...s}=o;return new ps({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:t,highlightColumnClassName:i,...s,highlightOnlyClosestHeader:!0,selectionType:Xs})}var tA=tY;var{register:Ha,getItem:iY}=qt("highlight/types");Ha(yr,KO);Ha(vr,ZO);Ha(_o,QO);Ha(ka,JO);Ha(Da,eA);Ha(Xs,tA);function bn(o,e){return iY(o)({type:o,...e})}var wy=class{constructor(e){this.options=e,this.layerLevel=0,this.cell=bn(_o,e),this.fill=bn(Da,e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}isEnabledFor(e,t){let i=e;e===_o&&(i="current");let s=this.options.disabledCellSelection(t.row,t.col);return typeof s=="string"&&(s=[s]),s===!1||Array.isArray(s)&&!s.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getCell(){return this.cell}getFill(){return this.fill}createOrGetArea(){let e=this.layerLevel,t;return this.areas.has(e)?t=this.areas.get(e):(t=bn(vr,{layerLevel:e,...this.options}),this.areas.set(e,t)),t}getAreas(){return[...this.areas.values()]}createOrGetHeader(){let e=this.layerLevel,t;return this.headers.has(e)?t=this.headers.get(e):(t=bn(Xs,{...this.options}),this.headers.set(e,t)),t}getHeaders(){return[...this.headers.values()]}createOrGetActiveHeader(){let e=this.layerLevel,t;return this.activeHeaders.has(e)?t=this.activeHeaders.get(e):(t=bn(yr,{...this.options}),this.activeHeaders.set(e,t)),t}getActiveHeaders(){return[...this.activeHeaders.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(bn(ka,{...this.options,...e}))}clear(){this.cell.clear(),this.fill.clear(),we(this.areas.values(),e=>void e.clear()),we(this.headers.values(),e=>void e.clear()),we(this.activeHeaders.values(),e=>void e.clear())}[Symbol.iterator](){return[this.cell,this.fill,...this.areas.values(),...this.headers.values(),...this.activeHeaders.values(),...this.customSelections][Symbol.iterator]()}},iA=wy;var yy=class{constructor(e){this.ranges=[],this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(0)}previous(){return this.peekByIndex(-1)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=this.size()+e-1,i;return t>=0&&(i=this.ranges[t]),i}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}},sA=yy;var km=class{constructor(e,t){this.range=e,this.options=t}transformStart(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this.options.createCellCoords(e,t),r=this.range.current().highlight,{row:n,col:a}=this.options.visualToRenderableCoords(r),l=r,c=0,u=0;if(this.runLocalHooks("beforeTransformStart",s),n!==null&&a!==null){let g=this.options.countRows(),p=this.options.countCols(),C=this.options.fixedRowsBottom(),y=this.options.minSpareRows(),S=this.options.minSpareCols(),O=this.options.autoWrapRow(),M=this.options.autoWrapCol();n+e>g-1?i&&y>0&&!(C&&n>=g-C-1)?(this.runLocalHooks("insertRowRequire",g),g=this.options.countRows()):M&&(s.row=1-g,s.col=a+s.col===p-1?1-p:1):M&&n+s.row<0&&a+s.col>=0&&(s.row=g-1,s.col=a+s.col===0?p-1:-1),a+s.col>p-1?i&&S>0?(this.runLocalHooks("insertColRequire",p),p=this.options.countCols()):O&&(s.row=n+s.row===g-1?1-g:1,s.col=1-p):O&&a+s.col<0&&n+s.row>=0&&(s.row=n+s.row===0?g-1:-1,s.col=p-1);let _=this.options.createCellCoords(n+s.row,a+s.col);c=0,u=0,_.row<0?(c=-1,_.row=0):_.row>0&&_.row>=g&&(c=1,_.row=g-1),_.col<0?(u=-1,_.col=0):_.col>0&&_.col>=p&&(u=1,_.col=p-1),l=this.options.renderableToVisualCoords(_)}return this.runLocalHooks("afterTransformStart",l,c,u),l}transformEnd(e,t){let i=this.options.createCellCoords(e,t),s=this.range.current(),r=s.to,n=0,a=0;this.runLocalHooks("beforeTransformEnd",i);let{row:l,col:c}=this.options.visualToRenderableCoords(s.highlight);if(l!==null&&c!==null){let u=this.options.countRows(),g=this.options.countCols(),{row:p,col:C}=this.options.visualToRenderableCoords(s.to),y=this.options.createCellCoords(p+i.row,C+i.col);n=0,a=0,y.row<0?(n=-1,y.row=0):y.row>0&&y.row>=u&&(n=1,y.row=u-1),y.col<0?(a=-1,y.col=0):y.col>0&&y.col>=g&&(a=1,y.col=g-1),r=this.options.renderableToVisualCoords(y)}return this.runLocalHooks("afterTransformEnd",r,n,a),r}};et(km,Nt);var oA=km;var Tu=0,Ru=1,nA=2,by=3,sY=[by,nA],oY=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],vy=Symbol("root"),rA=Symbol("child");function No(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vy;if(e!==vy&&e!==rA)throw new Error("The second argument is used internally only and cannot be overwritten.");let t=Array.isArray(o),i=e===vy,s=Tu;if(t){let r=o[0];o.length===0?s=Ru:i&&r instanceof fr?s=by:i&&Array.isArray(r)?s=No(r,rA):o.length>=2&&o.length<=4&&!o.some((a,l)=>!oY[l].includes(typeof a))&&(s=nA)}return s}function br(o){let{keepDirection:e=!1,propToCol:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!sY.includes(o))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){let s=o===by,r=s?i.from.row:i[0],n=s?i.from.col:i[1],a=s?i.to.row:i[2],l=s?i.to.col:i[3];if(typeof t=="function"&&(typeof n=="string"&&(n=t(n)),typeof l=="string"&&(l=t(l))),nt(a)&&(a=r),nt(l)&&(l=n),!e){let c=r,u=n,g=a,p=l;r=Math.min(c,g),n=Math.min(u,p),a=Math.max(c,g),l=Math.max(u,p)}return[r,n,a,l]}}function aA(o){let e=No(o);if(e===Tu||e===Ru)return[];let t=br(e),i=new Set;we(o,n=>{let[,a,,l]=t(n),c=Math.max(a,0),u=l-c+1;we(Array.from(new Array(u),(g,p)=>c+p),g=>{i.has(g)||i.add(g)})});let s=Array.from(i).sort((n,a)=>n-a);return pt(s,(n,a,l,c)=>(l!==0&&a===c[l-1]+1?n[n.length-1][1]+=1:n.push([a,1]),n),[])}function lA(o){let e=No(o);if(e===Tu||e===Ru)return[];let t=br(e),i=new Set;we(o,n=>{let[a,,l]=t(n),c=Math.max(a,0),u=l-c+1;we(Array.from(new Array(u),(g,p)=>c+p),g=>{i.has(g)||i.add(g)})});let s=Array.from(i).sort((n,a)=>n-a);return pt(s,(n,a,l,c)=>(l!==0&&a===c[l-1]+1?n[n.length-1][1]+=1:n.push([a,1]),n),[])}function Po(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof o=="number"&&o>=0&&o<e}var Hm=class{constructor(e,t){var i=this;this.settings=e,this.tableProps=t,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new sA((s,r,n)=>this.tableProps.createCellRange(s,r,n)),this.highlight=new iA({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:(s,r)=>this.tableProps.isDisabledCellSelection(s,r),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),createCellCoords:(s,r)=>this.tableProps.createCellCoords(s,r),createCellRange:(s,r,n)=>this.tableProps.createCellRange(s,r,n),rowIndexMapper:()=>this.tableProps.rowIndexMapper(),columnIndexMapper:()=>this.tableProps.columnIndexMapper()}),this.transformation=new oA(this.selectedRange,{countRows:()=>this.tableProps.countRowsTranslated(),countCols:()=>this.tableProps.countColsTranslated(),visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),createCellCoords:(s,r)=>this.tableProps.createCellCoords(s,r),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return i.runLocalHooks("beforeModifyTransformStart",...r)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return i.runLocalHooks("afterModifyTransformStart",...r)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return i.runLocalHooks("beforeModifyTransformEnd",...r)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return i.runLocalHooks("afterModifyTransformEnd",...r)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return i.runLocalHooks("insertRowRequire",...r)}),this.transformation.addLocalHook("insertColRequire",function(){for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return i.runLocalHooks("insertColRequire",...r)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this.settings.selectionMode==="multiple",r=nt(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,n=e.row<0,a=e.col<0,l=n&&a,c=e.clone();this.selectedByCorner=l,this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,c),(!s||s&&!r&&nt(t))&&this.selectedRange.clear(),this.selectedRange.add(c),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!l&&a&&this.selectedByRowHeader.add(this.getLayerLevel()),!l&&n&&this.selectedByColumnHeader.add(this.getLayerLevel()),i||this.setRangeEnd(e)}setRangeStartOnly(e,t){this.setRangeStart(e,t,!0)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;let t=e.clone();this.runLocalHooks("beforeSetRangeEnd",t),this.begin();let i=this.selectedRange.current();this.settings.selectionMode!=="single"&&i.setTo(this.tableProps.createCellCoords(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(_o,i.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(i);let s=this.getLayerLevel();s<this.highlight.layerLevel&&(we(this.highlight.getAreas(),l=>void l.clear()),we(this.highlight.getHeaders(),l=>void l.clear()),we(this.highlight.getActiveHeaders(),l=>void l.clear())),this.highlight.useLayerLevel(s);let r=this.highlight.createOrGetArea(),n=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();if(r.clear(),n.clear(),a.clear(),this.highlight.isEnabledFor(vr,i.highlight)&&(this.isMultiple()||s>=1)&&(r.add(i.from).add(i.to).commit(),s===1)){let l=this.selectedRange.previous();this.highlight.useLayerLevel(s-1).createOrGetArea().add(l.from).commit().syncWith(l),this.highlight.useLayerLevel(s)}if(this.highlight.isEnabledFor(Xs,i.highlight)){let l=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,u=i;(l||c)&&(u=i.clone()),l&&(u.from.row=-1),c&&(u.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&u.from.normalize(),n.add(u.from).commit()):n.add(u.from).add(u.to).commit(),this.isEntireRowSelected()&&this.tableProps.countCols()===i.getWidth()&&a.add(this.tableProps.createCellCoords(i.from.row,-1)).add(this.tableProps.createCellCoords(i.to.row,-1)).commit(),this.isEntireColumnSelected()&&this.tableProps.countRows()===i.getHeight()&&a.add(this.tableProps.createCellCoords(-1,i.from.col)).add(this.tableProps.createCellCoords(-1,i.to.col)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){let e=_s(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,t,i))}transformEnd(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByCorner}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.tableProps.countRows(),s=this.tableProps.countCols();if(!e&&!t&&(i===0||s===0))return;let r=this.tableProps.createCellCoords(t?-1:0,e?-1:0),n=this.tableProps.createCellCoords(i-1,s-1);this.clear(),this.setRangeStartOnly(r),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(n),this.finish()}selectCells(e){let t=No(e);if(t===Ru)return!1;if(t===Tu)throw new Error(st`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);let i=br(t,{propToCol:a=>this.tableProps.propToCol(a),keepDirection:!0}),s=this.tableProps.countRows(),r=this.tableProps.countCols(),n=!e.some(a=>{let[l,c,u,g]=i(a);return!(Po(l,s)&&Po(c,r)&&Po(u,s)&&Po(g,r))});return n&&(this.clear(),we(e,a=>{let[l,c,u,g]=i(a);this.setRangeStartOnly(this.tableProps.createCellCoords(l,c),!1),this.setRangeEnd(this.tableProps.createCellCoords(u,g)),this.finish()})),n}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,s=typeof e=="string"?this.tableProps.propToCol(e):e,r=typeof t=="string"?this.tableProps.propToCol(t):t,n=this.tableProps.countCols(),a=this.tableProps.countRows(),l=Po(s,n)&&Po(r,n);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(i,s)),this.setRangeEnd(this.tableProps.createCellCoords(a-1,r)),this.finish()),l}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,s=this.tableProps.countRows(),r=this.tableProps.countCols(),n=Po(e,s)&&Po(t,s);return n&&(this.setRangeStartOnly(this.tableProps.createCellCoords(e,i)),this.setRangeEnd(this.tableProps.createCellCoords(t,r-1)),this.finish()),n}refresh(){if(this.highlight.getCustomSelections().forEach(s=>{s.commit()}),!this.isSelected())return;let t=this.highlight.getCell(),i=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let s=0;s<this.selectedRange.size();s+=1){this.highlight.useLayerLevel(s);let r=this.highlight.createOrGetArea(),n=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();r.commit(),n.commit(),a.commit()}this.highlight.useLayerLevel(i)}};et(Hm,Nt);var xy=Hm;var hA=/^(\r\n|\n\r|\r|\n)/,rY=/^[^\t\r\n]+/,cA=/^\t/;function Sy(o){let e=[[""]];if(o.length===0)return e;let t=0,i=0,s;for(;o.length>0&&s!==o.length;)if(s=o.length,o.match(cA))o=o.replace(cA,""),t+=1,e[i][t]="";else if(o.match(hA))o=o.replace(hA,""),t=0,i+=1,e[i]=[""];else{let r="";if(o.startsWith('"')){let n=0,a=!0;for(;a;){let l=o.slice(0,1);l==='"'&&(n+=1),r+=l,o=o.slice(1),(o.length===0||o.match(/^[\t\r\n]/)&&n%2===0)&&(a=!1)}r=r.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{let n=o.match(rY);r=n?n[0]:"",o=o.slice(r.length)}e[i][t]=r}return e}function xr(o){let e,t,i,s,r="",n;for(e=0,t=o.length;e<t;e+=1){for(s=o[e].length,i=0;i<s;i+=1)i>0&&(r+="	"),n=o[e][i],typeof n=="string"?n.indexOf(`
`)>-1?r+=`"${n.replace(/"/g,'""')}"`:r+=n:n==null?r+="":r+=n;e!==t-1&&(r+=`
`)}return r}var Ey=class o{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,i){this.instance=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}createMap(){let e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");let t=this.tableMeta.columns,i;if(this.colToPropCache=[],this.propToColCache=new Map,t){let s=0,r=0,n=!1;if(typeof t=="function"){let a=an(e);s=a>0?a:this.countFirstRowKeys(),n=!0}else{let a=this.tableMeta.maxCols;s=Math.min(a,t.length)}for(i=0;i<s;i++){let a=n?t(i):t[i];if($e(a)){if(typeof a.data<"u"){let l=n?r:i;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}r+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return ec(this.dataSource)}recursiveDuckColumns(e,t,i){let s=t,r=i,n;return typeof s>"u"&&(s=0,r=""),typeof e=="object"&&!Array.isArray(e)&&ze(e,(a,l)=>{a===null?(n=r+l,this.colToPropCache.push(n),this.propToColCache.set(n,s),s+=1):s=this.recursiveDuckColumns(a,s,`${l}.`)}),s}colToProp(e){if(Number.isInteger(e)===!1)return e;let t=this.instance.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&Pe(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){let t=this.propToColCache.get(e);if(Pe(t))return this.instance.toVisualColumn(t);let i=this.instance.toVisualColumn(e);return i===null?e:i}getSchema(){let e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?hr(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:s="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=this.instance.countSourceRows(),n=r,a=0,l=e;if((typeof l!="number"||l>=r)&&(l=r),l<this.instance.countRows()&&(n=this.instance.toPhysicalRow(l)),this.instance.runHooks("beforeCreateRow",l,t,i)===!1||n===null)return{delta:0};let u=this.tableMeta.maxRows,g=this.getSchema().length,p=[];for(;a<t&&r+a<u;){let y=null;this.instance.dataType==="array"?this.tableMeta.dataSchema?y=Xt(this.getSchema()):(y=[],ke(g-1,()=>y.push(null))):this.instance.dataType==="function"?y=this.tableMeta.dataSchema(l+a):(y={},cr(y,this.getSchema())),p.push(y),a+=1}this.instance.rowIndexMapper.insertIndexes(l,a),s==="below"&&(n=Math.min(n+1,r)),this.spliceData(n,0,p);let C=this.instance.toVisualRow(n);return this.instance.countSourceRows()===p.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):i!=="auto"&&this.metaManager.createRow(n,t)),this.instance.runHooks("afterCreateRow",C,a,i),this.instance.forceFullRender=!0,{delta:a,startPhysicalIndex:n}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:s="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");let r=this.dataSource,n=this.tableMeta.maxCols,a=this.instance.countSourceCols(),l=e;if((typeof l!="number"||l>=a)&&(l=a),this.instance.runHooks("beforeCreateCol",l,t,i)===!1)return{delta:0};let u=a;l<this.instance.countCols()&&(u=this.instance.toPhysicalColumn(l));let g=this.instance.countSourceRows(),p=this.instance.countCols(),C=0,y=u;s==="end"&&(y=Math.min(y+1,a));let S=y;for(;C<t&&p<n;){if(typeof l!="number"||l>=p)if(g>0)for(let M=0;M<g;M+=1)typeof r[M]>"u"&&(r[M]=[]),r[M].push(null);else r.push([null]);else for(let M=0;M<g;M++)r[M].splice(y,0,null);C+=1,y+=1,p+=1}this.instance.columnIndexMapper.insertIndexes(l,C),C>0&&(e==null?this.metaManager.createColumn(null,C):i!=="auto"&&this.metaManager.createColumn(S,t));let O=this.instance.toVisualColumn(S);return this.instance.runHooks("afterCreateCol",O,C,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:C,startPhysicalIndex:S}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,s=Number.isInteger(e)?e:-t,r=this.visualRowsToPhysical(s,t),n=this.instance.countSourceRows();if(s=(n+s)%n,this.instance.runHooks("beforeRemoveRow",s,r.length,r,i)===!1)return!1;let l=r.length;if(this.filterData(s,l,r),s<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(r);let u=Pe(this.tableMeta.columns)||Pe(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&u===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}return r.slice(0).sort((u,g)=>g-u).forEach(u=>{this.metaManager.removeRow(u,1)}),this.instance.runHooks("afterRemoveRow",s,l,r,i),this.instance.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let s=typeof e!="number"?-t:e;s=(this.instance.countCols()+s)%this.instance.countCols();let r=this.visualColumnsToPhysical(s,t),n=r.slice(0).sort((g,p)=>p-g);if(this.instance.runHooks("beforeRemoveCol",s,t,r,i)===!1)return!1;let l=!0,c=n.length,u=this.dataSource;for(let g=0;g<c;g++)l&&r[0]!==r[g]-g&&(l=!1);if(l)for(let g=0,p=this.instance.countSourceRows();g<p;g++)u[g].splice(r[0],t),g===0&&this.metaManager.removeColumn(r[0],t);else for(let g=0,p=this.instance.countSourceRows();g<p;g++)for(let C=0;C<c;C++)u[g].splice(n[C],1),g===0&&this.metaManager.removeColumn(n[C],1);return s<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(r),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",s,t,r,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,i){let s=this.instance.getDataAtCol(e),r=s.slice(t,t+i),n=s.slice(t+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),c=3;c<a;c++)l[c-3]=arguments[c];sm(l,n);let u=0;for(;u<i;)l.push(null),u+=1;return HC(l),this.instance.populateFromArray(t,e,l,null,null,"spliceCol"),r}spliceRow(e,t,i){let s=this.instance.getSourceDataAtRow(e),r=s.slice(t,t+i),n=s.slice(t+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),c=3;c<a;c++)l[c-3]=arguments[c];sm(l,n);let u=0;for(;u<i;)l.push(null),u+=1;return this.instance.populateFromArray(e,t,[l],null,null,"spliceRow"),r}spliceData(e,t,i){if(this.instance.runHooks("beforeDataSplice",e,t,i)!==!1){let r=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,r.forEach(n=>this.dataSource.push(n))}}filterData(e,t,i){let s=this.instance.runHooks("filterData",e,t,i);Array.isArray(s)===!1&&(s=this.dataSource.filter((r,n)=>i.indexOf(n)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,s)}get(e,t){let i=this.instance.toPhysicalRow(e),s=this.dataSource[i],r=this.instance.runHooks("modifyRowData",i);s=isNaN(r)?r:s;let n=null;if(s&&s.hasOwnProperty&&St(s,t))n=s[t];else if(typeof t=="string"&&t.indexOf(".")>-1){let a=t.split("."),l=s;if(!l)return null;for(let c=0,u=a.length;c<u;c++)if(l=l[a[c]],typeof l>"u")return null;n=l}else typeof t=="function"&&(n=t(this.dataSource.slice(i,i+1)[0]));if(this.instance.hasHook("modifyData")){let a=_s(n);this.instance.runHooks("modifyData",i,this.propToCol(t),a,"get"),a.isTouched()&&(n=a.value)}return n}getCopyable(e,t){return this.instance.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,i){let s=this.instance.toPhysicalRow(e),r=i,n=this.dataSource[s],a=this.instance.runHooks("modifyRowData",s);if(n=isNaN(a)?a:n,this.instance.hasHook("modifyData")){let l=_s(r);this.instance.runHooks("modifyData",s,this.propToCol(t),l,"set"),l.isTouched()&&(r=l.value)}if(n&&n.hasOwnProperty&&St(n,t))n[t]=r;else if(typeof t=="string"&&t.indexOf(".")>-1){let l=t.split("."),c=n,u=0,g;for(u=0,g=l.length-1;u<g;u++)typeof c[l[u]]>"u"&&(c[l[u]]={}),c=c[l[u]];c[l[u]]=r}else typeof t=="function"?t(this.dataSource.slice(s,s+1)[0],r):n[t]=r}visualRowsToPhysical(e,t){let i=this.instance.countSourceRows(),s=[],r=(i+e)%i,n=t,a;for(;r<i&&n;)a=this.instance.toPhysicalRow(r),s.push(a),n-=1,r+=1;return s}visualColumnsToPhysical(e,t){let i=this.instance.countCols(),s=[],r=(i+e)%i,n=t;for(;r<i&&n;){let a=this.instance.toPhysicalColumn(r);s.push(a),n-=1,r+=1}return s}clear(){for(let e=0;e<this.instance.countSourceRows();e++)for(let t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){let e=this.tableMeta.maxRows,t;e<0||e===0?t=0:t=e||1/0;let i=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,t)}getAll(){let e={row:0,col:0},t={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-t.row===0&&!this.instance.countSourceRows()?[]:this.getRange(e,t,o.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,i){let s=[],r,n,a,l=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(l===0||c===0)return[];let u=i===o.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,g=Math.min(Math.max(l-1,0),Math.max(e.row,t.row)),p=Math.min(Math.max(c-1,0),Math.max(e.col,t.col));for(r=Math.min(e.row,t.row);r<=g;r++){a=[];let C=r>=0?this.instance.toPhysicalRow(r):r;for(n=Math.min(e.col,t.col);n<=p&&C!==null;n++)a.push(u.call(this,r,this.colToProp(n)));C!==null&&s.push(a)}return s}getText(e,t){return xr(this.getRange(e,t,o.DESTINATION_RENDERER))}getCopyableText(e,t){return xr(this.getRange(e,t,o.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}},uA=Ey;var{register:nY,getItem:aY,hasItem:Ty,getNames:dA,getValues:y7}=qt("cellTypes");function Mu(o){if(!Ty(o))throw Error(`You declared cell type "${o}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return aY(o)}function Pi(o,e){typeof o!="string"&&(e=o,o=e.CELL_TYPE);let{editor:t,renderer:i,validator:s}=e;t&&gi(o,t),i&&Gi(o,i),s&&Ro(o,s),nY(o,e)}function lY(o,e){var t;return o==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(o))||!St(e,o)}function Sr(o,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o,i=typeof e.type=="string"?Mu(e.type):e.type;if(o._automaticallyAssignedMetaProps&&ze(e,(r,n)=>void o._automaticallyAssignedMetaProps.delete(n)),!$e(i))return;t===o&&!o._automaticallyAssignedMetaProps&&(o._automaticallyAssignedMetaProps=new Set);let s={};ze(i,(r,n)=>{if(lY(n,t)){var a;s[n]=r,(a=o._automaticallyAssignedMetaProps)===null||a===void 0||a.add(n)}}),Ct(o,s)}function fA(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}Is(t,o);for(let i=0;i<e.length;i++)t.prototype[e[i]]=void 0;return t}function Fa(o){return Number.isInteger(o)&&o>=0}function Ba(o,e){if(!o())throw new Error(`Assertion failed: ${e}`)}function Ou(o){return o==null}var Au=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol(o){let e,t,i;for(e=0,t=this.countRows();e<t;e++)if(i=this.getDataAtCell(e,o),At(i)===!1)return!1;return!0},isEmptyRow(o){let e,t,i,s;for(e=0,t=this.countCols();e<t;e++)if(i=this.getDataAtCell(o,e),At(i)===!1)return typeof i=="object"?(s=this.getCellMeta(o,e),nn(this.getSchema()[s.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function hY(){return class{}}var Iu=class{constructor(e){this.metaCtor=hY(),this.meta=this.metaCtor.prototype,Ct(this.meta,Au()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;Ct(this.meta,e),Sr(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}};var _u=class{constructor(e){let t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){Ct(this.meta,e),Sr(this.meta,e,e)}};var Er=class{constructor(e){this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}obtain(e){Ba(()=>Fa(e),"Expecting an unsigned number.");let t=this._getStorageIndexByKey(e),i;if(t>=0)i=this.data[t],i===void 0&&(i=this.valueFactory(e),this.data[t]=i);else if(i=this.valueFactory(e),this.holes.size>0){let s=this.holes.values().next().value;this.holes.delete(s),this.data[s]=i,this.index[e]=s}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Ba(()=>Fa(e)||Ou(e),"Expecting an unsigned number or null/undefined argument.");let i=[],s=this.data.length;for(let n=0;n<t;n++)i.push(s+n),this.data.push(void 0);let r=Ou(e)?this.index.length:e;this.index=[...this.index.slice(0,r),...i,...this.index.slice(r)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Ba(()=>Fa(e)||Ou(e),"Expecting an unsigned number or null/undefined argument.");let i=this.index.splice(Ou(e)?this.index.length-t:e,t);for(let s=0;s<i.length;s++){let r=i[s];typeof r=="number"&&this.holes.add(r)}}size(){return this.data.length-this.holes.size}values(){return zt(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){let e=[];for(let i=0;i<this.data.length;i++){let s=this._getKeyByStorageIndex(i);s!==-1&&e.push([s,this.data[i]])}let t=0;return{next:()=>{if(t<e.length){let i=e[t];return t+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}};var cY=["data","width"],Nu=class{constructor(e){this.globalMeta=e,this.metas=new Er(()=>this._createMeta())}updateMeta(e,t){let i=this.getMeta(e);Ct(i,t),Sr(i,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return fA(this.globalMeta.getMetaConstructor(),cY).prototype}};var Pu=class{constructor(e){this.columnMeta=e,this.metas=new Er(()=>this._createRow())}updateMeta(e,t,i){let s=this.getMeta(e,t);Ct(s,i),Sr(s,i)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,t)}getMeta(e,t,i){let s=this.metas.obtain(e).obtain(t);return i===void 0?s:s[i]}setMeta(e,t,i,s){var r;let n=this.metas.obtain(e).obtain(t);(r=n._automaticallyAssignedMetaProps)===null||r===void 0||r.delete(i),n[i]=s}removeMeta(e,t,i){let s=this.metas.obtain(e).obtain(t);delete s[i]}getMetas(){let e=[],t=Array.from(this.metas.values());for(let i=0;i<t.length;i++)e.push(...t[i].values());return e}getMetasAtRow(e){Ba(()=>Fa(e),"Expecting an unsigned number.");let t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Er(e=>this._createMeta(e))}_createMeta(e){let t=this.columnMeta.getMetaConstructor(e);return new t}};var xn=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Iu(e),this.tableMeta=new _u(this.globalMeta),this.columnMeta=new Nu(this.globalMeta),this.cellMeta=new Pu(this.columnMeta),i.forEach(s=>new s(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,i){let{visualRow:s,visualColumn:r}=i,n=this.cellMeta.getMeta(e,t);return n.visualRow=s,n.visualCol=r,n.row=e,n.col=t,this.runLocalHooks("afterGetCellMeta",n),n}getCellMetaKeyValue(e,t,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,i)}setCellMeta(e,t,i,s){this.cellMeta.setMeta(e,t,i,s)}updateCellMeta(e,t,i){this.cellMeta.updateMeta(e,t,i)}removeCellMeta(e,t,i){this.cellMeta.removeMeta(e,t,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}};et(xn,Nt);function Fm(o,e,t,i){let{hotInstance:s,dataMap:r,dataSource:n,internalSource:a,source:l,metaManager:c,firstRun:u}=i,g=$t(a),p=s.getSettings();Array.isArray(p.dataSchema)?s.dataType="array":ht(p.dataSchema)?s.dataType="function":s.dataType="object",r&&r.destroy(),o=s.runHooks(`before${g}`,o,u,l);let C=new uA(s,o,c);if(e(C),typeof o=="object"&&o!==null)o.push&&o.splice||(o=[o]);else if(o===null){let y=C.getSchema();o=[];let S,O=0,M=0;for(O=0,M=p.startRows;O<M;O++)if((s.dataType==="object"||s.dataType==="function")&&p.dataSchema)S=Xt(y),o.push(S);else if(s.dataType==="array")S=Xt(y[0]),o.push(S);else{S=[];for(let _=0,N=p.startCols;_<N;_++)S.push(null);o.push(S)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof o} given)`);Array.isArray(o[0])&&(s.dataType="array"),p.data=o,C.dataSource=o,n.data=o,n.dataType=s.dataType,n.colToProp=C.colToProp.bind(C),n.propToCol=C.propToCol.bind(C),n.countCachedColumns=C.countCachedColumns.bind(C),t(C),s.runHooks(`after${g}`,o,u,l),u||(s.runHooks("afterChange",null,a),s.render())}var Lu=class{constructor(e){this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),He.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;let{row:i,col:s}=e;if((t=this.metaSyncMemo.get(i))!==null&&t!==void 0&&t.has(s))return;let{visualRow:r,visualCol:n}=e,a=this.metaManager.hot,l=a.colToProp(n);e.prop=l,a.runHooks("beforeGetCellMeta",r,n,e);let c=St(e,"type")?e.type:null,u=ht(e.cells)?e.cells(i,s,l):null;if(c)if(u){var g;u.type=(g=u.type)!==null&&g!==void 0?g:c}else u={type:c};u&&this.metaManager.updateCellMeta(i,s,u),a.runHooks("afterGetCellMeta",r,n,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(s)}};var Du=class{constructor(e){this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,i,s){if(!s)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]]),this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{let{target:i,onChange:s=()=>{}}=e,r=typeof i=="string",n=r?i:t,a=`_${n}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[n],this.installPropWatcher(t,a,s),r&&this.installPropWatcher(i,a,s)})}installPropWatcher(e,t,i){let s=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(r){let n=!s.usageTracker.has(e);s.usageTracker.add(e),i.call(s,e,r,n),this[t]=r},enumerable:!0,configurable:!0})}};var mA=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),ku=o=>o.map(e=>{let t=e.toLowerCase();return mA.has(t)?mA.get(t):t}).sort().join("+"),pA=o=>o.split("+"),Ry=o=>o.toLowerCase();var gA=o=>{let e=ur({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${o}" context.`}),t=function(){let{keys:l,callback:c,group:u,runOnlyIf:g=()=>!0,captureCtrl:p=!1,preventDefault:C=!0,stopPropagation:y=!1,relativeToGroup:S,position:O}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(nt(u))throw new Error("You need to define the shortcut's group.");if(ht(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(st`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);let M={callback:c,group:u,runOnlyIf:g,captureCtrl:p,preventDefault:C,stopPropagation:y};Pe(S)&&([M.relativeToGroup,M.position]=[S,O]),l.forEach(_=>{let N=ku(_);if(e.hasItem(N)){let k=e.getItem(N),ie=k.findIndex($=>$.group===S);ie!==-1?O==="before"?ie-=1:ie+=1:ie=k.length,k.splice(ie,0,M)}else e.addItem(N,[M])})},i=function(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(u=>{ze(c,(g,p)=>{Object.prototype.hasOwnProperty.call(u,p)===!1&&(u[p]=c[p])}),t(u)})},s=l=>{let c=ku(l);e.removeItem(c)};return{addShortcut:t,addShortcuts:i,getShortcuts:l=>{let c=ku(l),u=e.getItem(c);return Pe(u)?u.slice():[]},hasShortcut:l=>{let c=ku(l);return e.hasItem(c)},removeShortcutsByKeys:s,removeShortcutsByGroup:l=>{e.getItems().forEach(u=>{let[g,p]=u,C=p.filter(y=>y.group!==l);C.length===0?s(pA(g)):(p.length=0,p.push(...C))})}}};function CA(){let o=new Set;return{press(e){o.add(e)},release(e){o.delete(e)},releaseAll(){o.clear()},isPressed(e){return o.has(e)}}}var uY=["meta","alt","shift","control"],Hu=CA();function wA(o,e,t,i,s){let r=p=>uY.includes(p),n=function(p){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=[];return p.altKey&&y.push("alt"),C&&(p.ctrlKey||p.metaKey)?y.push("control/meta"):(p.ctrlKey&&y.push("control"),p.metaKey&&y.push("meta")),p.shiftKey&&y.push("shift"),y},a=p=>{if(e(p)===!1)return;let C=t(p);if(p.keyCode===229||C===!1||To(p))return;let y=Ry(p.key),S=[];r(y)?Hu.press(y):S=n(p);let O=[y].concat(S);!s(p,O)&&(pa()&&S.includes("meta")||!pa()&&S.includes("control"))&&s(p,[y].concat(n(p,!0))),i(p)},l=p=>{if(e(p)===!1)return;let C=Ry(p.key);r(C)!==!1&&Hu.release(C)},c=()=>{Hu.releaseAll()};return{mount:()=>{let p=o;for(;p;)p.document.documentElement.addEventListener("keydown",a),p.document.documentElement.addEventListener("keyup",l),p.document.documentElement.addEventListener("blur",c),p=nr(p)},unmount:()=>{let p=o;for(;p;)p.document.documentElement.removeEventListener("keydown",a),p.document.documentElement.removeEventListener("keyup",l),p.document.documentElement.removeEventListener("blur",c),p=nr(p)},isPressed:p=>Hu.isPressed(p),releasePressedKeys:()=>Hu.releaseAll()}}var My=o=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:i,afterKeyDown:s}=o,r=ur({errorIdExists:C=>`The "${C}" context name is already registered.`}),n="grid",a=C=>{let y=gA(C);return r.addItem(C,y),y},l=()=>n,c=C=>r.getItem(C),u=C=>{n=C},g=!1,p=wA(e,t,i,s,(C,y)=>{let S=c(l()),O=!1;if(!S.hasShortcut(y))return O;let M=S.getShortcuts(y);for(let _=0;_<M.length;_++){let{callback:N,runOnlyIf:E,preventDefault:k,stopPropagation:ie,captureCtrl:$}=M[_];if(E(C)!==!1&&(g=$,O=N(C,y)===!1,g=!1,k&&C.preventDefault(),ie&&C.stopPropagation(),O))break}return O});return p.mount(),{addContext:a,getActiveContextName:l,getContext:c,setActiveContextName:u,isCtrlPressed:()=>!g&&(p.isPressed("control")||p.isPressed("meta")),releasePressedKeys:()=>p.releasePressedKeys(),destroy:()=>p.unmount()}};var dY="gridDefault",Oy=null;function Va(o,e){var t;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=!1,r=this,n=new tt(r),a,l,c,u,g=!0;AO(i)&&OO(this),this.rootElement=o,this.rootDocument=o.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;let p=(t=e?.layoutDirection)!==null&&t!==void 0?t:"inherit",C=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",C),this.isRtl=function(){return C==="rtl"},this.isLtr=function(){return!r.isRtl()},this.getDirectionFactor=function(){return r.isLtr()?1:-1},e.language=qO(e.language);let y=new xn(r,e,[Lu,Du]),S=y.getTableMeta(),O=y.getGlobalMeta(),M=ur();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,o.insertBefore(this.container,o.firstChild),Qh(this)&&UC(e.licenseKey,o),this.guid=`ht_${hh()}`,this.columnIndexMapper=new wn,this.rowIndexMapper=new wn,this.columnIndexMapper.addLocalHook("indexesSequenceChange",h=>{r.runHooks("afterColumnSequenceChange",h)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",h=>{r.runHooks("afterRowSequenceChange",h)}),l=new kO(r),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);let _=h=>{let{row:m,col:x}=h;return r._createCellCoords(m>=0?r.rowIndexMapper.getRenderableFromVisualIndex(m):m,x>=0?r.columnIndexMapper.getRenderableFromVisualIndex(x):x)},N=h=>{let{row:m,col:x}=h;return r._createCellCoords(m>=0?r.rowIndexMapper.getVisualFromRenderableIndex(m):m,x>=0?r.columnIndexMapper.getVisualFromRenderableIndex(x):x)},E=new xy(S,{rowIndexMapper:()=>r.rowIndexMapper,columnIndexMapper:()=>r.columnIndexMapper,countCols:()=>r.countCols(),countRows:()=>r.countRows(),propToCol:h=>a.propToCol(h),isEditorOpened:()=>r.getActiveEditor()?r.getActiveEditor().isOpened():!1,countColsTranslated:()=>this.view.countRenderableColumns(),countRowsTranslated:()=>this.view.countRenderableRows(),getShortcutManager:()=>r.getShortcutManager(),createCellCoords:(h,m)=>r._createCellCoords(h,m),createCellRange:(h,m,x)=>r._createCellRange(h,m,x),visualToRenderableCoords:_,renderableToVisualCoords:N,isDisabledCellSelection:(h,m)=>r.getCellMeta(h,m).disableVisualSelection});this.selection=E;let k=h=>{let{hiddenIndexesChanged:m}=h;m&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",k),this.rowIndexMapper.addLocalHook("cacheUpdated",k),this.selection.addLocalHook("beforeSetRangeStart",h=>{this.runHooks("beforeSetRangeStart",h)}),this.selection.addLocalHook("beforeSetRangeStartOnly",h=>{this.runHooks("beforeSetRangeStartOnly",h)}),this.selection.addLocalHook("beforeSetRangeEnd",h=>{this.runHooks("beforeSetRangeEnd",h),h.row<0&&(h.row=this.view._wt.wtTable.getFirstVisibleRow()),h.col<0&&(h.col=this.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",h=>{let m=_s(!1),x=this.selection.getSelectedRange(),{from:I,to:B}=x.current(),V=x.size()-1;this.runHooks("afterSelection",I.row,I.col,B.row,B.col,m,V),this.runHooks("afterSelectionByProp",I.row,r.colToProp(I.col),B.row,r.colToProp(B.col),m,V);let U=this.selection.isSelectedByAnyHeader(),K=this.selection.selectedRange.current(),L=!0;s&&(L=!1),m.isTouched()&&(L=!m.value);let X=this.selection.isSelectedByRowHeader(),q=this.selection.isSelectedByColumnHeader();L!==!1&&(U?X?this.view.scrollViewportVertically(r.rowIndexMapper.getRenderableFromVisualIndex(h.row)):q&&this.view.scrollViewportHorizontally(r.columnIndexMapper.getRenderableFromVisualIndex(h.col)):K&&!this.selection.isMultiple()?this.view.scrollViewport(_(K.from)):this.view.scrollViewport(_(h))),X&&q?Te(this.rootElement,["ht__selection--rows","ht__selection--columns"]):X?(je(this.rootElement,"ht__selection--columns"),Te(this.rootElement,"ht__selection--rows")):q?(je(this.rootElement,"ht__selection--rows"),Te(this.rootElement,"ht__selection--columns")):je(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",h=>{let m=h.length-1,{from:x,to:I}=h[m];this.runHooks("afterSelectionEnd",x.row,x.col,I.row,I.col,m),this.runHooks("afterSelectionEndByProp",x.row,r.colToProp(x.col),I.row,r.colToProp(I.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",h=>{let m=this.runHooks("afterIsMultipleSelection",h.value);h.value&&(h.value=m)}),this.selection.addLocalHook("beforeModifyTransformStart",h=>{this.runHooks("modifyTransformStart",h)}),this.selection.addLocalHook("afterModifyTransformStart",(h,m,x)=>{this.runHooks("afterModifyTransformStart",h,m,x)}),this.selection.addLocalHook("beforeModifyTransformEnd",h=>{this.runHooks("modifyTransformEnd",h)}),this.selection.addLocalHook("afterModifyTransformEnd",(h,m,x)=>{this.runHooks("afterModifyTransformEnd",h,m,x)}),this.selection.addLocalHook("afterDeselect",()=>{u.destroyEditor(),this._refreshBorders(),je(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",h=>{this.alter("insert_row_above",h,1,"auto")}),this.selection.addLocalHook("insertColRequire",h=>{this.alter("insert_col_start",h,1,"auto")}),c={alter(h,m){var x,I;let B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,V=arguments.length>3?arguments[3]:void 0,U=arguments.length>4?arguments[4]:void 0,K=L=>{if(L.length===0)return[];let X=[...L];return X.sort((le,D)=>{let[F]=le,[oe]=D;return F===oe?0:F>oe?1:-1}),pt(X,(le,D)=>{let[F,oe]=D,ne=le[le.length-1],[ae,fe]=ne,me=ae+fe;if(F<=me){let G=Math.max(oe-(me-F),0);ne[1]+=G}else le.push([F,oe]);return le},[X[0]])};switch(h){case"insert_row_below":case"insert_row_above":let L=r.countSourceRows();if(S.maxRows===L)return;let X=h==="insert_row_below"?"below":"above";m=(x=m)!==null&&x!==void 0?x:X==="below"?L:0;let{delta:q,startPhysicalIndex:le}=a.createRow(m,B,{source:V,mode:X});if(q){let fe=E.selectedRange.current(),me=fe?.from,G=me?.row,se=r.toVisualRow(le);if(E.isSelectedByCorner())r.selectAll();else if(Pe(G)&&G>=se){let{row:ee,col:ue}=fe.to,de=me.col;E.isSelectedByRowHeader()&&(de=-1),E.getSelectedRange().pop(),E.setRangeStartOnly(r._createCellCoords(G+q,de),!0),E.setRangeEnd(r._createCellCoords(ee+q,ue))}else r._refreshBorders()}break;case"insert_col_start":case"insert_col_end":let D=h==="insert_col_end"?"end":"start";m=(I=m)!==null&&I!==void 0?I:D==="end"?r.countSourceCols():0;let{delta:F,startPhysicalIndex:oe}=a.createCol(m,B,{source:V,mode:D});if(F){if(Array.isArray(S.colHeaders)){let ee=[r.toVisualColumn(oe),0];ee.length+=F,Array.prototype.splice.apply(S.colHeaders,ee)}let fe=E.selectedRange.current(),me=fe?.from,G=me?.col,se=r.toVisualColumn(oe);if(E.isSelectedByCorner())r.selectAll();else if(Pe(G)&&G>=se){let{row:ee,col:ue}=fe.to,de=me.row;E.isSelectedByColumnHeader()&&(de=-1),E.getSelectedRange().pop(),E.setRangeStartOnly(r._createCellCoords(de,G+F),!0),E.setRangeEnd(r._createCellCoords(ee,ue+F))}else r._refreshBorders()}break;case"remove_row":let ne=fe=>{let me=0;we(fe,G=>{let[se,ee]=G,ue=At(se)?r.countRows()-1:Math.max(se-me,0);if(Number.isInteger(se)&&(se=Math.max(se-me,0)),!a.removeRow(se,ee,V))return;let W=r.countRows(),z=S.fixedRowsTop;z>=ue+1&&(S.fixedRowsTop-=Math.min(ee,z-ue));let Z=S.fixedRowsBottom;Z&&ue>=W-Z&&(S.fixedRowsBottom-=Math.min(ee,Z)),me+=ee})};Array.isArray(m)?ne(K(m)):ne([[m,B]]),c.adjustRowsAndCols(),r._refreshBorders();break;case"remove_col":let ae=fe=>{let me=0;we(fe,G=>{let[se,ee]=G,ue=At(se)?r.countCols()-1:Math.max(se-me,0),de=r.toPhysicalColumn(ue);if(Number.isInteger(se)&&(se=Math.max(se-me,0)),!a.removeCol(se,ee,V))return;let z=S.fixedColumnsStart;z>=ue+1&&(S.fixedColumnsStart-=Math.min(ee,z-ue)),Array.isArray(S.colHeaders)&&(typeof de>"u"&&(de=-1),S.colHeaders.splice(de,ee)),me+=ee})};Array.isArray(m)?ae(K(m)):ae([[m,B]]),c.adjustRowsAndCols(),r._refreshBorders();break;default:throw new Error(`There is no such action "${h}"`)}U||c.adjustRowsAndCols()},adjustRowsAndCols(){let h=S.minRows,m=S.minSpareRows,x=S.minCols,I=S.minSpareCols;if(r.countRows()===0&&r.countCols()===0&&E.deselect(),h){let B=r.countRows();B<h&&a.createRow(B,h-B,{source:"auto"})}if(m){let B=r.countEmptyRows(!0);if(B<m){let V=m-B,U=Math.min(V,S.maxRows-r.countSourceRows());a.createRow(r.countRows(),U,{source:"auto"})}}{let B;(x||I)&&(B=r.countEmptyCols(!0));let V=r.countCols();if(x&&!S.columns&&V<x){let U=x-V;B+=U,a.createCol(V,U,{source:"auto"})}if(I&&!S.columns&&r.dataType==="array"&&B<I){V=r.countCols();let U=I-B,K=Math.min(U,S.maxCols-V);a.createCol(V,K,{source:"auto"})}}if(E.isSelected()){let B=r.countRows(),V=r.countCols();we(E.selectedRange,U=>{let K=!1,L=U.from.row,X=U.from.col,q=U.to.row,le=U.to.col;L>B-1?(L=B-1,K=!0,q>L&&(q=L)):q>B-1&&(q=B-1,K=!0,L>q&&(L=q)),X>V-1?(X=V-1,K=!0,le>X&&(le=X)):le>V-1&&(le=V-1,K=!0,X>le&&(X=le)),K&&r.selectCell(L,X,q,le)})}r.view&&r.view.adjustElementsSize()},populateFromArray(h,m,x,I,B){let V,U,K,L,X=[],q={},le=[],D=h.row,F=h.col;if(U=m.length,U===0)return!1;let oe=0,ne=0;switch($e(x)&&(oe=x.col-F+1,ne=x.row-D+1),B){case"shift_down":let ae=en(m),fe=ae.length,me=Math.max(fe,oe),G=r.getData().slice(D),se=en(G).slice(F,F+me);for(K=0;K<me;K+=1)if(K<fe){for(V=0,U=ae[K].length;V<ne-U;V+=1)ae[K].push(ae[K][V%U]);K<se.length?le.push(ae[K].concat(se[K])):le.push(ae[K].concat(new Array(G.length).fill(null)))}else le.push(ae[K%fe].concat(se[K]));r.populateFromArray(D,F,en(le));break;case"shift_right":let ee=m.length,ue=Math.max(ee,ne),de=r.getData().slice(D).map(ge=>ge.slice(F));for(V=0;V<ue;V+=1)if(V<ee){for(K=0,L=m[V].length;K<oe-L;K+=1)m[V].push(m[V][K%L]);if(V<de.length)for(let ge=0;ge<de[V].length;ge+=1)m[V].push(de[V][ge]);else m[V].push(...new Array(de[0].length).fill(null))}else m.push(m[V%U].slice(0,ue).concat(de[V]));r.populateFromArray(D,F,m);break;case"overwrite":default:q.row=h.row,q.col=h.col;let W=0,z=0,Z=!0,te,re=function(ye){let Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,Se=m[ye%m.length];return Ee!==null?Se[Ee%Se.length]:Se},ce=m.length,Ce=x?x.row-h.row+1:0;for(x?U=Ce:U=Math.max(ce,Ce),V=0;V<U&&!(x&&q.row>x.row&&Ce>ce||!S.allowInsertRow&&q.row>r.countRows()-1||q.row>=S.maxRows);V++){let ge=V-W,ye=re(ge).length,Ee=x?x.col-h.col+1:0;if(x?L=Ee:L=Math.max(ye,Ee),q.col=h.col,te=r.getCellMeta(q.row,q.col),(I==="CopyPaste.paste"||I==="Autofill.fill")&&te.skipRowOnPaste){W+=1,q.row+=1,U+=1;continue}for(z=0,K=0;K<L&&!(x&&q.col>x.col&&Ee>ye||!S.allowInsertColumn&&q.col>r.countCols()-1||q.col>=S.maxCols);K++){if(te=r.getCellMeta(q.row,q.col),(I==="CopyPaste.paste"||I==="Autofill.fill")&&te.skipColumnOnPaste){z+=1,q.col+=1,L+=1;continue}if(te.readOnly&&I!=="UndoRedo.undo"){q.col+=1;continue}let Se=K-z,be=re(ge,Se),Re=r.getDataAtCell(q.row,q.col);if(be!==null&&typeof be=="object")if(Array.isArray(be)&&Re===null&&(Re=[]),Re===null||typeof Re!="object")Z=!1;else{let Ae=hr(Array.isArray(Re)?Re:Re[0]||Re),Ne=hr(Array.isArray(be)?be:be[0]||be);nn(Ae,Ne)||Array.isArray(Ae)&&Array.isArray(Ne)?be=Xt(be):Z=!1}else Re!==null&&typeof Re=="object"&&(Z=!1);Z&&X.push([q.row,q.col,be]),Z=!0,q.col+=1}q.row+=1}r.setDataAtCell(X,null,null,I||"populateFromArray");break}}};function ie(h){let m=Nm(h);Lm(m)?(r.runHooks("beforeLanguageChange",m),O.language=m,r.runHooks("afterLanguageChange",m)):Pm(h)}function $(h,m){let x=h==="className"?r.rootElement:r.table;if(g)Te(x,m);else{let I=[],B=[];O[h]&&(I=Array.isArray(O[h])?O[h]:rm(O[h])),m&&(B=Array.isArray(m)?m:rm(m));let V=om(I,B),U=om(B,I);V.length&&je(x,V),U.length&&Te(x,U)}O[h]=m}this.init=function(){l.setData(S.data),r.runHooks("beforeInit"),(fi()||bh())&&Te(r.rootElement,"mobile"),this.updateSettings(S,!0),this.view=new LO(this),u=AM.getInstance(r,S,E),r.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&r.rootElement.offsetParent===null&&JC(r.rootElement,()=>{r.view._wt.wtOverlays.updateLastSpreaderSize(),r.render(),r.view.adjustElementsSize()}),typeof g=="object"&&(r.runHooks("afterChange",g[0],g[1]),g=!1),r.runHooks("afterInit")};function H(){let h=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,h=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&h===!1&&(h=!0,this.onQueueEmpty(this.valid))}}}function Q(h){let m=h.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):h}function Y(h,m,x){if(!h.length)return;let I=r.getActiveEditor(),B=new H,V=!0;B.onQueueEmpty=U=>{I&&V&&I.cancelChanges(),x(U)};for(let U=h.length-1;U>=0;U--){let[K,L,,X]=h[U],q=a.propToCol(L),le=r.getCellMeta(K,q);le.type==="numeric"&&typeof X=="string"&&bw(X)&&(h[U][3]=Q(X)),r.getCellValidator(le)&&(B.addValidatorToQueue(),r.validateCell(h[U][3],le,function(D,F){return function(oe){if(typeof oe!="boolean")throw new Error("Validation error: result is not boolean");if(oe===!1&&F.allowInvalid===!1){V=!1,h.splice(D,1),F.valid=!0;let ne=r.getCell(F.visualRow,F.visualCol);ne!==null&&je(ne,S.invalidCellClassName)}B.removeValidatorFormQueue()}}(U,le),m))}B.checkIfQueueIsEmpty()}function P(h,m){let x=h.length-1;if(x<0)return;for(;x>=0;x--){let B=!1;if(h[x]===null){h.splice(x,1);continue}if(!((h[x][2]===null||h[x][2]===void 0)&&(h[x][3]===null||h[x][3]===void 0))){if(S.allowInsertRow)for(;h[x][0]>r.countRows()-1;){let{delta:V}=a.createRow(void 0,void 0,{source:m});if(V===0){B=!0;break}}if(r.dataType==="array"&&(!S.columns||S.columns.length===0)&&S.allowInsertColumn)for(;a.propToCol(h[x][1])>r.countCols()-1;){let{delta:V}=a.createCol(void 0,void 0,{source:m});if(V===0){B=!0;break}}B||a.set(h[x][0],h[x][1],h[x][3])}}r.forceFullRender=!0,c.adjustRowsAndCols(),r.runHooks("beforeChangeRender",h,m),u.lockEditor(),r._refreshBorders(null),u.unlockEditor(),r.view.adjustElementsSize(),r.runHooks("afterChange",h,m||"edit");let I=r.getActiveEditor();I&&Pe(I.refreshValue)&&I.refreshValue()}this._createCellCoords=function(h,m){return r.view._wt.createCellCoords(h,m)},this._createCellRange=function(h,m,x){return r.view._wt.createCellRange(h,m,x)},this.validateCell=function(h,m,x,I){let B=r.getCellValidator(m);function V(U){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){x(U);return}let L=m.visualCol,X=m.visualRow,q=r.getCell(X,L,!0);if(q&&q.nodeName!=="TH"){let le=r.rowIndexMapper.getRenderableFromVisualIndex(X),D=r.columnIndexMapper.getRenderableFromVisualIndex(L);r.view._wt.getSetting("cellRenderer",le,D,q)}x(U)}WC(B)&&(B=function(U){return function(K,L){L(U.test(K))}}(B)),ht(B)?(h=r.runHooks("beforeValidate",h,m.visualRow,m.prop,I),r._registerImmediate(()=>{B.call(m,h,U=>{r&&(U=r.runHooks("afterValidate",U,h,m.visualRow,m.prop,I),m.valid=U,V(U),r.runHooks("postAfterValidate",U,h,m.visualRow,m.prop,I))})})):r._registerImmediate(()=>{m.valid=!0,V(m.valid,!1)})};function j(h,m,x){return Array.isArray(h)?h:[[h,m,x]]}function A(h,m){let x=r.getActiveEditor(),I=r.runHooks("beforeChange",h,m||"edit"),B=h.filter(V=>V!==null);return I===!1||B.length===0?(x&&x.cancelChanges(),[]):B}this.setDataAtCell=function(h,m,x,I){let B=j(h,m,x),V=[],U=I,K,L,X;for(K=0,L=B.length;K<L;K++){if(typeof B[K]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof B[K][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");B[K][1]>=this.countCols()?X=B[K][1]:X=a.colToProp(B[K][1]),V.push([B[K][0],X,l.getAtCell(this.toPhysicalRow(B[K][0]),B[K][1]),B[K][2]])}!U&&typeof h=="object"&&(U=m);let q=A(V,I);r.runHooks("afterSetDataAtCell",q,U),Y(q,U,()=>{P(q,U)})},this.setDataAtRowProp=function(h,m,x,I){let B=j(h,m,x),V=[],U=I,K,L;for(K=0,L=B.length;K<L;K++)V.push([B[K][0],B[K][1],l.getAtCell(this.toPhysicalRow(B[K][0]),B[K][1]),B[K][2]]);!U&&typeof h=="object"&&(U=m);let X=A(V,I);r.runHooks("afterSetDataAtRowProp",X,U),Y(X,U,()=>{P(X,U)})},this.listen=function(){r&&!r.isListening()&&(Oy=r.guid,r.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Oy=null,r.runHooks("afterUnlisten"))},this.isListening=function(){return Oy===r.guid},this.destroyEditor=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;r._refreshBorders(h,m)},this.populateFromArray=function(h,m,x,I,B,V,U){if(!(typeof x=="object"&&typeof x[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");let K=typeof I=="number"?r._createCellCoords(I,B):null;return c.populateFromArray(r._createCellCoords(h,m),x,K,V,U)},this.spliceCol=function(h,m,x){for(var I=arguments.length,B=new Array(I>3?I-3:0),V=3;V<I;V++)B[V-3]=arguments[V];return a.spliceCol(h,m,x,...B)},this.spliceRow=function(h,m,x){for(var I=arguments.length,B=new Array(I>3?I-3:0),V=3;V<I;V++)B[V-3]=arguments[V];return a.spliceRow(h,m,x,...B)},this.getSelected=function(){if(E.isSelected())return Ge(E.getSelectedRange(),h=>{let{from:m,to:x}=h;return[m.row,m.col,x.row,x.col]})},this.getSelectedLast=function(){let h=this.getSelected(),m;return h&&h.length>0&&(m=h[h.length-1]),m},this.getSelectedRange=function(){if(E.isSelected())return Array.from(E.getSelectedRange())},this.getSelectedRangeLast=function(){let h=this.getSelectedRange(),m;return h&&h.length>0&&(m=h[h.length-1]),m},this.emptySelectedCells=function(h){if(!E.isSelected()||this.countRows()===0||this.countCols()===0)return;let m=[];we(E.getSelectedRange(),x=>{let I=x.getTopStartCorner(),B=x.getBottomEndCorner();ke(I.row,B.row,V=>{ke(I.col,B.col,U=>{this.getCellMeta(V,U).readOnly||m.push([V,U,null])})})}),m.length>0&&this.setDataAtCell(m,h)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){let h=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(h,0),!this.isRenderSuspended()&&h===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(u.lockEditor(),this._refreshBorders(null),u.unlockEditor()))},this.batchRender=function(h){this.suspendRender();let m=h();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||h)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(h){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();let x=h();return this.resumeExecution(m),x},this.batch=function(h){this.suspendRender(),this.suspendExecution();let m=h();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!r.view)return;let{width:h,height:m}=r.view.getLastSize(),{width:x,height:I}=r.rootElement.getBoundingClientRect(),B=x!==h||I!==m;r.runHooks("beforeRefreshDimensions",{width:h,height:m},{width:x,height:I},B)!==!1&&((B||r.view._wt.wtOverlays.scrollableElement===r.rootWindow)&&(r.view.setLastSize(x,I),r.render()),r.runHooks("afterRefreshDimensions",{width:h,height:m},{width:x,height:I},B))},this.updateData=function(h,m){Fm(h,x=>{a=x},x=>{a=x,r.columnIndexMapper.fitToLength(this.getInitialColumnCount()),r.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:r,dataMap:a,dataSource:l,internalSource:"updateData",source:m,metaManager:y,firstRun:g})},this.loadData=function(h,m){Fm(h,x=>{a=x},()=>{y.clearCellsCache(),r.initIndexMappers(),c.adjustRowsAndCols(),g&&(g=[null,"loadData"])},{hotInstance:r,dataMap:a,dataSource:l,internalSource:"loadData",source:m,metaManager:y,firstRun:g})},this.getInitialColumnCount=function(){let h=S.columns,m=0;if(Array.isArray(h))m=h.length;else if(ht(h))if(r.dataType==="array"){let x=this.countSourceCols();for(let I=0;I<x;I+=1)h(I)&&(m+=1)}else(r.dataType==="object"||r.dataType==="function")&&(m=a.colToPropCache.length);else if(Pe(S.dataSchema)){let x=a.getSchema();m=Array.isArray(x)?x.length:an(x)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(h,m,x,I){return nt(h)?a.getAll():a.getRange(r._createCellCoords(h,m),r._createCellCoords(x,I),a.DESTINATION_RENDERER)},this.getCopyableText=function(h,m,x,I){return a.getCopyableText(r._createCellCoords(h,m),r._createCellCoords(x,I))},this.getCopyableData=function(h,m){return a.getCopyable(h,a.colToProp(m))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(h){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,x=(g?r.loadData:r.updateData).bind(this),I=!1,B,V;if(Pe(h.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Pe(h.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Pe(h.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(B in h)B==="data"||(B==="language"?ie(h.language):B==="className"?$("className",h.className):B==="tableClassName"&&r.table?($("tableClassName",h.tableClassName),r.view._wt.wtOverlays.syncOverlayTableClassNames()):He.getSingleton().isRegistered(B)||He.getSingleton().isDeprecated(B)?(ht(h[B])||Array.isArray(h[B]))&&(h[B].initialHook=!0,r.addHook(B,h[B])):!m&&St(h,B)&&(O[B]=h[B]));h.data===void 0&&S.data===void 0?x(null,"updateSettings"):h.data!==void 0?x(h.data,"updateSettings"):h.columns!==void 0&&(a.createMap(),r.initIndexMappers());let U=r.countCols(),K=S.columns;if(K&&ht(K)&&(I=!0),(h.cell!==void 0||h.cells!==void 0||h.columns!==void 0)&&y.clearCache(),U>0)for(B=0,V=0;B<U;B++){if(K){let q=I?K(B):K[V];q&&y.updateColumnMeta(V,q)}V+=1}Pe(h.cell)&&ze(h.cell,q=>{r.setCellMetaObject(q.row,q.col,q)}),r.runHooks("afterCellMetaReset");let L=r.rootElement.style.height;L!==""&&(L=parseInt(r.rootElement.style.height,10));let X=h.height;if(ht(X)&&(X=X()),m&&r.rootElement.getAttribute("style")&&r.rootElement.setAttribute("data-initialstyle",r.rootElement.getAttribute("style")),X===null){let q=r.rootElement.getAttribute("data-initialstyle");q&&(q.indexOf("height")>-1||q.indexOf("overflow")>-1)?r.rootElement.setAttribute("style",q):(r.rootElement.style.height="",r.rootElement.style.overflow="")}else X!==void 0&&(r.rootElement.style.height=isNaN(X)?`${X}`:`${X}px`,r.rootElement.style.overflow="hidden");if(typeof h.width<"u"){let q=h.width;ht(q)&&(q=q()),r.rootElement.style.width=isNaN(q)?`${q}`:`${q}px`}m||(r.view&&(r.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),r.view._wt.exportSettingsAsClassNames()),r.runHooks("afterUpdateSettings",h)),c.adjustRowsAndCols(),r.view&&!g&&(r.forceFullRender=!0,u.lockEditor(),r._refreshBorders(null),r.view._wt.wtOverlays.adjustElementsSize(),u.unlockEditor()),!m&&r.view&&(L===""||X===""||X===void 0)&&L!==X&&r.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){let h=r.getSelectedLast();if(S.getValue){if(ht(S.getValue))return S.getValue.call(r);if(h)return r.getData()[h[0][0]][S.getValue]}else if(h)return r.getDataAtCell(h[0],h[1])},this.getSettings=function(){return S},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(h,m,x,I,B){c.alter(h,m,x,I,B)},this.getCell=function(h,m){let x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,I=m,B=h;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;I=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(h>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(h)))return null;B=this.rowIndexMapper.getRenderableFromVisualIndex(h)}return B===null||I===null?null:r.view.getCellAtCoords(r._createCellCoords(B,I),x)},this.getCoords=function(h){let m=this.view._wt.wtTable.getCoords(h);if(m===null)return null;let{row:x,col:I}=m,B=x,V=I;return x>=0&&(B=this.rowIndexMapper.getVisualFromRenderableIndex(x)),I>=0&&(V=this.columnIndexMapper.getVisualFromRenderableIndex(I)),r._createCellCoords(B,V)},this.colToProp=function(h){return a.colToProp(h)},this.propToCol=function(h){return a.propToCol(h)},this.toVisualRow=h=>this.rowIndexMapper.getVisualFromPhysicalIndex(h),this.toVisualColumn=h=>this.columnIndexMapper.getVisualFromPhysicalIndex(h),this.toPhysicalRow=h=>this.rowIndexMapper.getPhysicalFromVisualIndex(h),this.toPhysicalColumn=h=>this.columnIndexMapper.getPhysicalFromVisualIndex(h),this.getDataAtCell=function(h,m){return a.get(h,a.colToProp(m))},this.getDataAtRowProp=function(h,m){return a.get(h,m)},this.getDataAtCol=function(h){let m=[],x=a.getRange(r._createCellCoords(0,h),r._createCellCoords(S.data.length-1,h),a.DESTINATION_RENDERER);for(let I=0;I<x.length;I+=1)for(let B=0;B<x[I].length;B+=1)m.push(x[I][B]);return m},this.getDataAtProp=function(h){let m=[],x=a.getRange(r._createCellCoords(0,a.propToCol(h)),r._createCellCoords(S.data.length-1,a.propToCol(h)),a.DESTINATION_RENDERER);for(let I=0;I<x.length;I+=1)for(let B=0;B<x[I].length;B+=1)m.push(x[I][B]);return m},this.getSourceData=function(h,m,x,I){let B;return h===void 0?B=l.getData():B=l.getByRange(r._createCellCoords(h,m),r._createCellCoords(x,I)),B},this.getSourceDataArray=function(h,m,x,I){let B;return h===void 0?B=l.getData(!0):B=l.getByRange(r._createCellCoords(h,m),r._createCellCoords(x,I),!0),B},this.getSourceDataAtCol=function(h){return l.getAtColumn(h)},this.setSourceDataAtCell=function(h,m,x,I){let B=j(h,m,x),V=this.hasHook("afterSetSourceDataAtCell"),U=[];V&&we(B,L=>{let[X,q,le]=L;U.push([X,q,l.getAtCell(X,q),le])}),we(B,L=>{let[X,q,le]=L;l.setAtCell(X,q,le)}),V&&this.runHooks("afterSetSourceDataAtCell",U,I),this.render();let K=r.getActiveEditor();K&&Pe(K.refreshValue)&&K.refreshValue()},this.getSourceDataAtRow=function(h){return l.getAtRow(h)},this.getSourceDataAtCell=function(h,m){return l.getAtCell(h,m)},this.getDataAtRow=function(h){return a.getRange(r._createCellCoords(h,0),r._createCellCoords(h,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(h,m,x,I){let B=h===void 0?[0,0,this.countRows(),this.countCols()]:[h,m,x,I],[V,U]=B,[,,K,L]=B,X=null,q=null;K===void 0&&(K=V),L===void 0&&(L=U);let le="mixed";return ke(Math.max(Math.min(V,K),0),Math.max(V,K),D=>{let F=!0;return ke(Math.max(Math.min(U,L),0),Math.max(U,L),oe=>(q=this.getCellMeta(D,oe).type,X?F=X===q:X=q,F)),le=F?q:"mixed",F}),le},this.removeCellMeta=function(h,m,x){let[I,B]=[this.toPhysicalRow(h),this.toPhysicalColumn(m)],V=y.getCellMetaKeyValue(I,B,x);r.runHooks("beforeRemoveCellMeta",h,m,x,V)!==!1&&(y.removeCellMeta(I,B,x),r.runHooks("afterRemoveCellMeta",h,m,x,V)),V=null},this.spliceCellsMeta=function(h){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var x=arguments.length,I=new Array(x>2?x-2:0),B=2;B<x;B++)I[B-2]=arguments[B];if(I.length>0&&!Array.isArray(I[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&y.removeRow(this.toPhysicalRow(h),m),I.length>0&&we(I.reverse(),V=>{y.createRow(this.toPhysicalRow(h)),we(V,(U,K)=>this.setCellMetaObject(h,K,U))}),r.render()},this.setCellMetaObject=function(h,m,x){typeof x=="object"&&ze(x,(I,B)=>{this.setCellMeta(h,m,B,I)})},this.setCellMeta=function(h,m,x,I){if(r.runHooks("beforeSetCellMeta",h,m,x,I)===!1)return;let V=h,U=m;h<this.countRows()&&(V=this.toPhysicalRow(h)),m<this.countCols()&&(U=this.toPhysicalColumn(m)),y.setCellMeta(V,U,x,I),r.runHooks("afterSetCellMeta",h,m,x,I)},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(h,m){let x=this.toPhysicalRow(h),I=this.toPhysicalColumn(m);return x===null&&(x=h),I===null&&(I=m),y.getCellMeta(x,I,{visualRow:h,visualColumn:m})},this.getCellMetaAtRow=function(h){return y.getCellsMetaAtRow(h)},this.isColumnModificationAllowed=function(){return!(r.dataType==="object"||S.columns)},this.getCellRenderer=function(h,m){let x=typeof h=="number"?r.getCellMeta(h,m).renderer:h.renderer;return typeof x=="string"?ba(x):nt(x)?ba("text"):x},this.getCellEditor=function(h,m){let x=typeof h=="number"?r.getCellMeta(h,m).editor:h.editor;return typeof x=="string"?wa(x):nt(x)?wa("text"):x},this.getCellValidator=function(h,m){let x=typeof h=="number"?r.getCellMeta(h,m).validator:h.validator;return typeof x=="string"?Th(x):x},this.validateCells=function(h){this._validateCells(h)},this.validateRows=function(h,m){if(!Array.isArray(h))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,h)},this.validateColumns=function(h,m){if(!Array.isArray(h))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,h)},this._validateCells=function(h,m,x){let I=new H;h&&(I.onQueueEmpty=h);let B=r.countRows()-1;for(;B>=0;){if(m!==void 0&&m.indexOf(B)===-1){B-=1;continue}let V=r.countCols()-1;for(;V>=0;){if(x!==void 0&&x.indexOf(V)===-1){V-=1;continue}I.addValidatorToQueue(),r.validateCell(r.getDataAtCell(B,V),r.getCellMeta(B,V),U=>{if(typeof U!="boolean")throw new Error("Validation error: result is not boolean");U===!1&&(I.valid=!1),I.removeValidatorFormQueue()},"validateCells"),V-=1}B-=1}I.checkIfQueueIsEmpty()},this.getRowHeader=function(h){let m=S.rowHeaders,x=h;return x!==void 0&&(x=r.runHooks("modifyRowHeader",x)),x===void 0?(m=[],ke(r.countRows()-1,I=>{m.push(r.getRowHeader(I))})):Array.isArray(m)&&m[x]!==void 0?m=m[x]:ht(m)?m=m(x):m&&typeof m!="string"&&typeof m!="number"&&(m=x+1),m},this.hasRowHeaders=function(){return!!S.rowHeaders},this.hasColHeaders=function(){if(S.colHeaders!==void 0&&S.colHeaders!==null)return!!S.colHeaders;for(let h=0,m=r.countCols();h<m;h++)if(r.getColHeader(h))return!0;return!1},this.getColHeader=function(h){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,x=r.runHooks("modifyColHeader",h);if(x===void 0){let K=[],L=r.countCols();for(let X=0;X<L;X++)K.push(r.getColHeader(X));return K}let I=S.colHeaders,B=function(K){let L=[],X=r.countCols(),q=0;for(;q<X;q++)ht(S.columns)&&S.columns(q)&&L.push(q);return L[K]},V=r.toPhysicalColumn(x),U=B(V);return S.colHeaders===!1?I=null:S.columns&&ht(S.columns)&&S.columns(U)&&S.columns(U).title?I=S.columns(U).title:S.columns&&S.columns[V]&&S.columns[V].title?I=S.columns[V].title:Array.isArray(S.colHeaders)&&S.colHeaders[V]!==void 0?I=S.colHeaders[V]:ht(S.colHeaders)?I=S.colHeaders(V):S.colHeaders&&typeof S.colHeaders!="string"&&typeof S.colHeaders!="number"&&(I=Jh(x)),I=r.runHooks("modifyColumnHeaderValue",I,h,m),I},this._getColWidthFromSettings=function(h){let m;if(h>=0&&(m=r.getCellMeta(0,h).width),(m===void 0||m===S.width)&&(m=S.colWidths),m!=null){switch(typeof m){case"object":m=m[h];break;case"function":m=m(h);break;default:break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(h){let m=r._getColWidthFromSettings(h);return m=r.runHooks("modifyColWidth",m,h),m===void 0&&(m=dr.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(h){let m=S.rowHeights;if(m!=null){switch(typeof m){case"object":m=m[h];break;case"function":m=m(h);break;default:break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(h){let m=r._getRowHeightFromSettings(h);return m=r.runHooks("modifyRowHeight",m,h),m},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){let h=S.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(h,m)},this.countRenderedRows=function(){return r.view._wt.drawn?r.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return r.view._wt.drawn?r.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return r.view._wt.drawn?r.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return r.view._wt.drawn?r.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return ya(r.countRows()-1,x=>{if(r.isEmptyRow(x))m+=1;else if(h===!0)return!1}),m},this.countEmptyCols=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return ya(r.countCols()-1,x=>{if(r.isEmptyCol(x))m+=1;else if(h===!0)return!1}),m},this.isEmptyRow=function(h){return S.isEmptyRow.call(r,h)},this.isEmptyCol=function(h){return S.isEmptyCol.call(r,h)},this.selectCell=function(h,m,x,I){let B=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,V=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return nt(h)||nt(m)?!1:this.selectCells([[h,m,x,I]],B,V)},this.selectCells=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(s=!0);let I=E.selectCells(h);return I&&x&&r.listen(),s=!1,I},this.selectColumns=function(h){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h;return E.selectColumns(h,m)},this.selectRows=function(h){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h;return E.selectRows(h,m)},this.deselectCell=function(){E.deselect()},this.selectAll=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=h&&this.hasRowHeaders(),x=h&&this.hasColHeaders();s=!0,E.selectAll(m,x),s=!1};let v=(h,m)=>h.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(h,m){let x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,I=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,B=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,V=!x,U=!I,K=h,L=m;if(B){let le=Number.isInteger(h),D=Number.isInteger(m),F=le?v(this.rowIndexMapper,h):void 0,oe=D?v(this.columnIndexMapper,m):void 0;if(F===null||oe===null)return!1;K=le?r.rowIndexMapper.getRenderableFromVisualIndex(F):void 0,L=D?r.columnIndexMapper.getRenderableFromVisualIndex(oe):void 0}let X=Number.isInteger(K),q=Number.isInteger(L);return X&&q?r.view.scrollViewport(r._createCellCoords(K,L),V,I,x,U):X&&q===!1?r.view.scrollViewportVertically(K,V,x):q&&X===!1?r.view.scrollViewportHorizontally(L,I,U):!1},this.destroy=function(){if(r._clearTimeouts(),r._clearImmediates(),r.view&&r.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),y.clearCache(),Qh(r)){let h=this.rootDocument.querySelector(".hot-display-license-info");h&&h.parentNode.removeChild(h)}li(r.rootElement),n.destroy(),u&&u.destroy(),r.batchExecution(()=>{r.rowIndexMapper.unregisterAll(),r.columnIndexMapper.unregisterAll(),M.getItems().forEach(h=>{let[,m]=h;m.destroy()}),M.clear(),r.runHooks("afterDestroy")},!0),He.getSingleton().destroy(r),ze(r,(h,m,x)=>{ht(h)?x[m]=R(m):m!=="guid"&&(x[m]=null)}),r.isDestroyed=!0,a&&a.destroy(),a=null,c=null,E=null,u=null,r=null};function R(h){return()=>{throw new Error(`The "${h}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return u.getActiveEditor()},this.getPlugin=function(h){let m=$t(h);return m==="UndoRedo"?this.undoRedo:M.getItem(m)},this.getPluginName=function(h){return h===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:M.getId(h)},this.getInstance=function(){return r},this.addHook=function(h,m){He.getSingleton().add(h,m,r)},this.hasHook=function(h){return He.getSingleton().has(h,r)||He.getSingleton().has(h)},this.addHookOnce=function(h,m){He.getSingleton().once(h,m,r)},this.removeHook=function(h,m){He.getSingleton().remove(h,m,r)},this.runHooks=function(h,m,x,I,B,V,U){return He.getSingleton().run(r,h,m,x,I,B,V,U)},this.getTranslatedPhrase=function(h,m){return Dm(S.language,h,m)},this.toHTML=()=>pm(this),this.toTableElement=()=>{let h=this.rootDocument.createElement("div");return h.insertAdjacentHTML("afterbegin",pm(this)),h.firstElementChild},this.timeouts=[],this._registerTimeout=function(h){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,x=h;typeof x=="function"&&(x=setTimeout(x,m)),this.timeouts.push(x)},this._clearTimeouts=function(){we(this.timeouts,h=>{clearTimeout(h)})},this.immediates=[],this._registerImmediate=function(h){this.immediates.push(setImmediate(h))},this._clearImmediates=function(){we(this.immediates,h=>{clearImmediate(h)})},this._refreshBorders=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;u.destroyEditor(h),r.view.render(),m&&E.isSelected()&&u.prepareEditor()},this.isRtl=function(){return r.rootWindow.getComputedStyle(r.rootElement).direction==="rtl"},this.isLtr=function(){return!r.isRtl()},this.getDirectionFactor=function(){return r.isLtr()?1:-1};let f=My({handleEvent(h){let m=r.isListening(),x=h?.key!==void 0;return m&&x},beforeKeyDown:h=>this.runHooks("beforeKeyDown",h),afterKeyDown:h=>{this.isDestroyed||r.runHooks("afterDocumentKeyDown",h)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",h=>{h.ctrlKey===!1&&h.metaKey===!1&&f.releasePressedKeys()}),this.getShortcutManager=function(){return f};let w=f.addContext("grid"),b={runOnlyIf:()=>Pe(r.getSelected())&&r.countRenderedRows()>0&&r.countRenderedCols()>0,group:dY};f.setActiveContextName("grid"),w.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>{r.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:()=>{let h=r.getSelectedRange(),{row:m,col:x}=h[h.length-1].highlight,I=r.getDataAtCell(m,x),B=new Map;for(let V=0;V<h.length;V++)h[V].forAll((U,K)=>{if(U>=0&&K>=0&&(U!==m||K!==x)){let{readOnly:L}=r.getCellMeta(U,K);L||B.set(`${U}x${K}`,[U,K,I])}});r.setDataAtCell(Array.from(B.values()))},runOnlyIf:()=>r.getSelectedRangeLast().getCellsCount()>1},{keys:[["ArrowUp"]],callback:()=>{E.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>{E.setRangeStart(r._createCellCoords(r.rowIndexMapper.getNearestNotHiddenIndex(0,1),r.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:()=>{E.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{let{from:h,to:m}=r.getSelectedRangeLast(),x=r.rowIndexMapper.getNearestNotHiddenIndex(0,1);E.setRangeStart(h.clone()),E.setRangeEnd(r._createCellCoords(x,m.col))},runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>{E.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>{E.setRangeStart(r._createCellCoords(r.rowIndexMapper.getNearestNotHiddenIndex(r.countRows()-1,-1),r.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:()=>{E.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{let{from:h,to:m}=r.getSelectedRangeLast(),x=r.rowIndexMapper.getNearestNotHiddenIndex(r.countRows()-1,-1);E.setRangeStart(h.clone()),E.setRangeEnd(r._createCellCoords(x,m.col))},runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>{E.transformStart(0,-1*r.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>{let h=r.getSelectedRangeLast().highlight.row,m=r.columnIndexMapper.getNearestNotHiddenIndex(...r.isRtl()?[r.countCols()-1,-1]:[0,1]);E.setRangeStart(r._createCellCoords(h,m))}},{keys:[["ArrowLeft","Shift"]],callback:()=>{E.transformEnd(0,-1*r.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{let{from:h,to:m}=r.getSelectedRangeLast(),x=r.columnIndexMapper.getNearestNotHiddenIndex(...r.isRtl()?[r.countCols()-1,-1]:[0,1]);E.setRangeStart(h.clone()),E.setRangeEnd(r._createCellCoords(m.row,x))},runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>{E.transformStart(0,r.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>{let h=r.getSelectedRangeLast().highlight.row,m=r.columnIndexMapper.getNearestNotHiddenIndex(...r.isRtl()?[0,1]:[r.countCols()-1,-1]);E.setRangeStart(r._createCellCoords(h,m))}},{keys:[["ArrowRight","Shift"]],callback:()=>{E.transformEnd(0,r.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{let{from:h,to:m}=r.getSelectedRangeLast(),x=r.columnIndexMapper.getNearestNotHiddenIndex(...r.isRtl()?[0,1]:[r.countCols()-1,-1]);E.setRangeStart(h.clone()),E.setRangeEnd(r._createCellCoords(m.row,x))},runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>{let h=parseInt(r.getSettings().fixedColumnsStart,10),m=r.getSelectedRangeLast().highlight.row,x=r.columnIndexMapper.getNearestNotHiddenIndex(h,1);E.setRangeStart(r._createCellCoords(m,x))},runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>{E.setRangeEnd(r._createCellCoords(E.selectedRange.current().from.row,r.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>{let h=parseInt(r.getSettings().fixedRowsTop,10),m=parseInt(r.getSettings().fixedColumnsStart,10),x=r.rowIndexMapper.getNearestNotHiddenIndex(h,1),I=r.columnIndexMapper.getNearestNotHiddenIndex(m,1);E.setRangeStart(r._createCellCoords(x,I))},runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>{E.setRangeStart(r._createCellCoords(r.getSelectedRangeLast().highlight.row,r.columnIndexMapper.getNearestNotHiddenIndex(r.countCols()-1,-1)))},runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>{E.setRangeEnd(r._createCellCoords(E.selectedRange.current().from.row,r.columnIndexMapper.getNearestNotHiddenIndex(r.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>{let h=parseInt(r.getSettings().fixedRowsBottom,10),m=r.rowIndexMapper.getNearestNotHiddenIndex(r.countRows()-h-1,-1),x=r.columnIndexMapper.getNearestNotHiddenIndex(r.countCols()-1,-1);E.setRangeStart(r._createCellCoords(m,x))},runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>{E.transformStart(-r.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:()=>{let{to:h}=r.getSelectedRangeLast(),m=Math.max(h.row-r.countVisibleRows(),0),x=r.rowIndexMapper.getNearestNotHiddenIndex(m,1);if(x!==null){let I=r._createCellCoords(x,h.col),B=h.row-r.view.getFirstFullyVisibleRow(),V=Math.max(I.row-B,0);E.setRangeEnd(I),r.scrollViewportTo(V)}}},{keys:[["PageDown"]],callback:()=>{E.transformStart(r.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:()=>{let{to:h}=r.getSelectedRangeLast(),m=Math.min(h.row+r.countVisibleRows(),r.countRows()-1),x=r.rowIndexMapper.getNearestNotHiddenIndex(m,-1);if(x!==null){let I=r._createCellCoords(x,h.col),B=h.row-r.view.getFirstFullyVisibleRow(),V=Math.min(I.row-B,r.countRows()-1);E.setRangeEnd(I),r.scrollViewportTo(V)}}},{keys:[["Tab"]],callback:h=>{let m=typeof S.tabMoves=="function"?S.tabMoves(h):S.tabMoves;E.transformStart(m.row,m.col,!0)}},{keys:[["Shift","Tab"]],callback:h=>{let m=typeof S.tabMoves=="function"?S.tabMoves(h):S.tabMoves;E.transformStart(-m.row,-m.col)}}],b),va().forEach(h=>{let m=un(h);M.addItem(h,new m(this))}),He.getSingleton().run(r,"construct")}var fY="hooksRefRegisterer",yA={_hooksStorage:Object.create(null),addHook(o,e){return this._hooksStorage[o]||(this._hooksStorage[o]=[]),this.hot.addHook(o,e),this._hooksStorage[o].push(e),this},removeHooksByKey(o){we(this._hooksStorage[o]||[],e=>{this.hot.removeHook(o,e)})},clearHooks(){ze(this._hooksStorage,(o,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};hi(yA,"MIXIN_NAME",fY,{writable:!1,enumerable:!1});var vA=yA;var Ay="base",si=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Bm="baseEditor",Li=class{static get EDITOR_TYPE(){return Ay}constructor(e){this.hot=e,this.instance=e,this.state=si.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,i,s,r,n){this.TD=s,this.row=e,this.col=t,this.prop=i,this.originalValue=r,this.cellProperties=n,this.state=si.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let i,s,r,n;if(t){let g=this.hot.getSelectedLast();i=Math.max(Math.min(g[0],g[2]),0),s=Math.max(Math.min(g[1],g[3]),0),r=Math.max(g[0],g[2]),n=Math.max(g[1],g[3])}else[i,s,r,n]=[this.row,this.col,null,null];let a=this.hot.runHooks("modifyGetCellCoords",i,s);Array.isArray(a)&&([i,s]=a);let c=this.hot.getShortcutManager().getContext("editor"),u={runOnlyIf:()=>Pe(this.hot.getSelected()),group:Bm};this.isInFullEditMode()&&c.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],u),this.hot.populateFromArray(i,s,e,r,n,"edit")}beginEditing(e,t){if(this.state!==si.VIRGIN)return;let i=this.hot,s=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),r=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(s,r)),this.state=si.EDITING,this.isInFullEditMode()){let n=typeof e=="string"?e:vt(this.originalValue);this.setValue(n)}this.open(t),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,i){let s;if(i){let a=this._closeCallback;this._closeCallback=l=>{a&&a(l),i(l),this.hot.view.render()}}if(this.isWaiting())return;let n=this.hot.getShortcutManager().getContext("editor");if(n.removeShortcutsByGroup(Bm),n.removeShortcutsByGroup(hn),this.state===si.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===si.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}let a=this.getValue();this.cellProperties.trimWhitespace?s=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:s=[[a]],this.state=si.WAITING,this.saveValue(s,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=si.FINISHED,this.discardEditor(l)}):(this.state=si.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=si.FINISHED,this.discardEditor()}discardEditor(e){this.state===si.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=si.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=si.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===si.WAITING}getEditedCellRect(){var e;let t=this.getEditedCell();if(!t)return;let{wtOverlays:i,wtViewport:s}=this.hot.view._wt,r=this.hot.rootWindow,n=Ot(t),a=at(t),l=Ot(this.hot.rootElement),c=at(this.hot.rootElement),u=i.topOverlay.holder,g=i.inlineStartOverlay.holder,p=u!==r?u.scrollTop:0,C=g!==r?g.scrollLeft:0,y=r.innerWidth-l.left-c,{wtTable:S}=(e=i.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,O=S.name,M=["master","inline_start"].includes(O)?p:0,_=["master","top","bottom"].includes(O)?C:0,N=n.top===l.top?0:1,E=n.top-l.top-N-M,k=0;this.hot.isRtl()?k=r.innerWidth-n.left-a-y-1+_:k=n.left-l.left-1-_,["top","top_inline_start_corner"].includes(O)&&(E+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(O)&&(k+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));let ie=this.hot.hasColHeaders(),$=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),H=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),Y=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(ie&&$<=0||$===Y)&&(E+=1),H<=0&&(k+=1);let P=s.rowsRenderCalculator.startPosition,j=s.columnsRenderCalculator.startPosition,A=Math.abs(i.inlineStartOverlay.getScrollPosition()),v=i.topOverlay.getScrollPosition(),R=Rt(this.hot.rootDocument),f=t.offsetTop+P-v,w=0;if(this.hot.isRtl()){let X=t.offsetLeft;X>=0?w=S.getWidth()-t.offsetLeft:w=Math.abs(X),w+=j-A-a}else w=t.offsetLeft+j-A;let b=as(this.TD,this.hot.rootWindow),h=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",m=parseInt(b[h],10)>0?0:1,x=parseInt(b.borderTopWidth,10)>0?0:1,I=at(t)+m,B=ft(t)+x,V=KC(u)?R:0,U=ZC(g)?R:0,K=this.hot.view.maximumVisibleElementWidth(w)-V+m,L=Math.max(this.hot.view.maximumVisibleElementHeight(f)-U+x,23);return{top:E,start:k,height:B,maxHeight:L,width:I,maxWidth:K}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){let e=this.hot.countRows(),t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}};et(Li,vA);function Iy(){var o={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},e,t=document.body,i=document.createTextNode(""),s=document.createElement("SPAN"),r=function(p,C,y){p.addEventListener(C,y,!1)},n=function(p,C,y){p.removeEventListener(C,y,!1)},a=function(p){var C,y;p?/^[a-zA-Z \.,\\\/\|0-9]$/.test(p)||(p="."):p="",i.textContent!==void 0?i.textContent=e.value+p:i.data=e.value+p,s.style.position="absolute",s.style.fontSize=g(e).fontSize,s.style.fontFamily=g(e).fontFamily,s.style.whiteSpace="pre",t.appendChild(s),C=s.clientWidth+2,t.removeChild(s),e.style.height=o.minHeight+"px",o.minWidth>C?e.style.width=o.minWidth+"px":C>o.maxWidth?e.style.width=o.maxWidth+"px":e.style.width=C+"px",y=e.scrollHeight?e.scrollHeight-1:0,o.minHeight>y?e.style.height=o.minHeight+"px":o.maxHeight<y?(e.style.height=o.maxHeight+"px",e.style.overflowY="visible"):e.style.height=y+"px"},l=function(){window.setTimeout(a,0)},c=function(p){if(p&&p.minHeight)if(p.minHeight=="inherit")o.minHeight=e.clientHeight;else{var C=parseInt(p.minHeight);isNaN(C)||(o.minHeight=C)}if(p&&p.maxHeight)if(p.maxHeight=="inherit")o.maxHeight=e.clientHeight;else{var y=parseInt(p.maxHeight);isNaN(y)||(o.maxHeight=y)}if(p&&p.minWidth)if(p.minWidth=="inherit")o.minWidth=e.clientWidth;else{var S=parseInt(p.minWidth);isNaN(S)||(o.minWidth=S)}if(p&&p.maxWidth)if(p.maxWidth=="inherit")o.maxWidth=e.clientWidth;else{var O=parseInt(p.maxWidth);isNaN(O)||(o.maxWidth=O)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(i))},u=function(p,C,y){e=p,c(C),e.nodeName=="TEXTAREA"&&(e.style.resize="none",e.style.overflowY="",e.style.height=o.minHeight+"px",e.style.minWidth=o.minWidth+"px",e.style.maxWidth=o.maxWidth+"px",e.style.overflowY="hidden"),y&&(r(e,"change",a),r(e,"cut",l),r(e,"paste",l),r(e,"drop",l),r(e,"keydown",l),r(e,"focus",a),r(e,"compositionstart",l),r(e,"compositionupdate",l),r(e,"compositionend",l)),a()};function g(p){return p.currentStyle||document.defaultView.getComputedStyle(p)}return{init:function(p,C,y){u(p,C,y)},unObserve:function(){n(e,"change",a),n(e,"cut",l),n(e,"paste",l),n(e,"drop",l),n(e,"keydown",l),n(e,"focus",a),n(e,"compositionstart",l),n(e,"compositionupdate",l),n(e,"compositionend",l)},resize:a}}function _y(o,e){let t=dh(e),i=e.value.split(`
`),s=t,r=0;for(let n=0;n<i.length;n++){let a=i[n];n!==0&&(r+=i[n-1].length+1);let l=r+a.length;if(o==="home"?s=r:o==="end"&&(s=l),t<=l)break}xo(e,s)}var mY="ht_editor_visible",Vm="ht_editor_hidden",bA="textEditor",Ny="text",Ci=class extends Li{static get EDITOR_TYPE(){return Ny}constructor(e){super(e),this.eventManager=new tt(this),this.autoResize=Iy(),this.TEXTAREA=void 0,this.textareaStyle=void 0,this.TEXTAREA_PARENT=void 0,this.textareaParentStyle=void 0,this.layerClass=void 0,this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",t=>this.onAfterDocumentKeyDown(t)),this.registerShortcuts()}close(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(e,t,i,s,r,n){let a=this.state;if(super.prepare(e,t,i,s,r,n),!n.readOnly){this.refreshDimensions(!0);let{allowInvalid:l,fragmentSelection:c}=n;l&&(this.TEXTAREA.value=""),a!==si.FINISHED&&this.hideEditableElement(),!c&&!fi()&&this.focus()}}beginEditing(e,t){this.state===si.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),xo(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){let{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Te(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Te(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ve(this.TEXTAREA_PARENT,this.layerClass)&&je(this.TEXTAREA_PARENT,this.layerClass),Te(this.TEXTAREA_PARENT,Vm),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){aw()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",je(this.TEXTAREA_PARENT,this.layerClass),Te(this.TEXTAREA_PARENT,Vm)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";let e=this.TEXTAREA_PARENT.childNodes,t=!1;ke(e.length-1,i=>{let s=e[i];if(Ve(s,"handsontableEditor"))return t=!0,!1}),Ve(this.TEXTAREA_PARENT,Vm)&&je(this.TEXTAREA_PARENT,Vm),t?(this.layerClass=mY,Te(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Te(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){let e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==si.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}let{top:t,start:i,width:s,maxWidth:r,height:n,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();let l=as(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;let c=as(this.TEXTAREA),u=parseInt(c.paddingLeft,10)+parseInt(c.paddingRight,10),g=parseInt(c.paddingTop,10)+parseInt(c.paddingBottom,10),p=s-u,C=n-g,y=r-u,S=a-g;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(p,y),minHeight:Math.min(C,S),maxWidth:y,maxHeight:S},!0)}bindEvents(){this.eventManager.addEventListener(this.TEXTAREA,"cut",e=>e.stopPropagation()),this.eventManager.addEventListener(this.TEXTAREA,"paste",e=>e.stopPropagation()),vh()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){let t=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>Pe(this.hot.getSelected()),group:bA},s=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Tab"]],callback:r=>{let n=this.hot.getSettings(),a=typeof n.tabMoves=="function"?n.tabMoves(r):n.tabMoves;this.hot.selection.transformStart(a.row,a.col,!0)}},{keys:[["Shift","Tab"]],callback:r=>{let n=this.hot.getSettings(),a=typeof n.tabMoves=="function"?n.tabMoves(r):n.tabMoves;this.hot.selection.transformStart(-a.row,-a.col)}},{keys:[["Control","Enter"]],callback:()=>(s(),!1),runOnlyIf:r=>!this.hot.selection.isMultiple()&&!r.altKey,relativeToGroup:cn,position:"before"},{keys:[["Meta","Enter"]],callback:()=>(s(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple(),relativeToGroup:cn,position:"before"},{keys:[["Alt","Enter"]],callback:()=>(s(),!1),relativeToGroup:cn,position:"before"},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(r,n)=>{let[a]=n;_y(a,this.TEXTAREA)}},{keys:[["End"]],callback:(r,n)=>{let[a]=n;_y(a,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}}],i)}unregisterShortcuts(){let t=this.hot.getShortcutManager().getContext("editor");t.removeShortcutsByGroup(hn),t.removeShortcutsByGroup(bA),t.removeShortcutsByGroup(Bm)}onAfterDocumentKeyDown(e){[Ue.ARROW_UP,Ue.ARROW_RIGHT,Ue.ARROW_DOWN,Ue.ARROW_LEFT].indexOf(e.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(e.keyCode))}};var Py="base";function qs(o,e,t,i,s,r,n){let a=[],l=[];n.className&&Te(e,n.className),n.readOnly&&a.push(n.readOnlyCellClassName),n.valid===!1&&n.invalidCellClassName?a.push(n.invalidCellClassName):l.push(n.invalidCellClassName),n.wordWrap===!1&&n.noWordWrapClassName&&a.push(n.noWordWrapClassName),!r&&n.placeholder&&a.push(n.placeholderCellClassName),je(e,l),Te(e,a)}qs.RENDERER_TYPE=Py;var Ly="text";function xi(o,e,t,i,s,r,n){qs.apply(this,[o,e,t,i,s,r,n]);let a=r;if(!a&&n.placeholder&&(a=n.placeholder),a=vt(a),n.trimWhitespace&&(a=a.trim()),n.rendererTemplate){li(e);let l=o.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=n.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=o.getSourceDataAtRow(t),e.appendChild(l)}else ji(e,a)}xi.RENDERER_TYPE=Ly;var Dy="text",Fu={CELL_TYPE:Dy,editor:Ci,renderer:xi};Pi(Fu);ks.editors={BaseEditor:Li};function ks(o,e){let t=new Va(o,e||{},Em);return t.init(),t}ks.Core=function(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Va(o,e,Em)};ks.DefaultSettings=Au();ks.hooks=He.getSingleton();ks.CellCoords=Mo;ks.CellRange=fr;ks.packageName="handsontable";ks.buildDate="31/08/2023 08:23:33";ks.version="13.1.0";ks.languages={dictionaryKeys:zO,getLanguageDictionary:gy,getLanguagesDictionaries:XO,registerLanguageDictionary:py,getTranslatedPhrase:Dm};var gt=ks;var xA="handsontableEditor",ky="handsontable",Lo=class extends Ci{static get EDITOR_TYPE(){return ky}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),xo(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,i,s,r,n){super.prepare(e,t,i,s,r,n);let a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown(c,u){let g=this.getSourceData(u.row,u.col);g!==void 0&&a.setValue(g),a.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Ct(l,n.handsontable),this.htOptions=l}beginEditing(e,t){let i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,t)}createElements(){super.createElements();let e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){let s=this.htEditor.getInstance().getValue();s!==void 0&&this.setValue(s)}super.finishEditing(e,t,i)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){let t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();let i={group:xA,relativeToGroup:hn,position:"before"},s=(r,n)=>{let a=this.htEditor.getInstance();if(r!==void 0&&(r<0||a.flipped&&r>a.countRows()-1?a.deselectCell():a.selectCell(r,0),a.getData().length))return n.preventDefault(),ni(n),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:r=>{let n=this.htEditor.getInstance(),a,l;return!n.getSelectedLast()&&n.flipped?a=n.countRows()-1:n.getSelectedLast()&&(n.flipped?(l=n.getSelectedLast()[0],a=Math.max(0,l-1)):(l=n.getSelectedLast()[0],a=l-1)),s(a,r)},preventDefault:!1},{keys:[["ArrowDown"]],callback:r=>{let n=this.htEditor.getInstance(),a,l;if(!n.getSelectedLast()&&!n.flipped)a=0;else if(n.getSelectedLast()){if(n.flipped)a=n.getSelectedLast()[0]+1;else if(!n.flipped){let c=n.countRows()-1;l=n.getSelectedLast()[0],a=Math.min(c,l+1)}}return s(a,r)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(xA)}};function pY(o,e,t){return e=gY(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function gY(o){var e=CY(o,"string");return typeof e=="symbol"?e:String(e)}function CY(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var Hy=new WeakMap,Fy="autocomplete",Do=class extends Lo{static get EDITOR_TYPE(){return Fy}constructor(e){super(e),pY(this,"sortByRelevance",function(t,i,s){let r=[],n=[],a=t.length,l=i.length,c,u,g,p;if(a===0){for(g=0;g<l;g++)n.push(g);return n}for(g=0;g<l;g++){if(u=am(vt(i[g])),s)p=u.indexOf(t);else{let C=this.cellProperties.locale;p=u.toLocaleLowerCase(C).indexOf(t.toLocaleLowerCase(C))}p!==-1&&(c=u.length-p-a,r.push({baseIndex:g,index:p,charsLeft:c,value:u}))}for(r.sort((C,y)=>{if(y.index===-1)return-1;if(C.index===-1)return 1;if(C.index<y.index)return-1;if(y.index<C.index)return 1;if(C.index===y.index){if(C.charsLeft<y.charsLeft)return-1;if(C.charsLeft>y.charsLeft)return 1}return 0}),g=0,l=r.length;g<l;g++)n.push(r[g].baseIndex);return n}),this.query=null,this.strippedChoices=[],this.rawChoices=[],Hy.set(this,{skipOne:!1,isMacOS:this.hot.rootWindow.navigator.platform.indexOf("Mac")>-1})}getValue(){let e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return Pe(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Te(this.htContainer,"autocompleteEditor"),Te(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}open(){let e=Hy.get(this);super.open();let t=this.htEditor.getInstance(),i=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();let s=Rt();s===0&&e.isMacOS&&(s+=15),this.addHook("beforeKeyDown",r=>this.onBeforeKeyDown(r)),t.updateSettings({colWidths:i?[at(this.TEXTAREA)-2]:void 0,width:i?at(this.TEXTAREA)+s:void 0,renderer:(r,n,a,l,c,u,g)=>{xi(r,n,a,l,c,u,g);let{filteringCaseSensitive:p,allowHtml:C,locale:y}=this.cellProperties,S=this.query,O=vt(u),M,_;O&&!C&&(M=p===!0?O.indexOf(S):O.toLocaleLowerCase(y).indexOf(S.toLocaleLowerCase(y)),M!==-1&&(_=O.substr(M,S.length),O=O.replace(_,`<strong>${_}</strong>`))),n.innerHTML=O},autoColumnSize:!0}),e.skipOne&&(e.skipOne=!1),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close()}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){let t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){let t=dh(this.TEXTAREA),i=XC(this.TEXTAREA),s=this.cellProperties.sortByRelevance,r=this.cellProperties.filter,n=null,a=null,l=e;s&&(n=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));let c=Array.isArray(n)?n.length:0;if(r===!1)c&&(a=n[0]);else{let u=[];for(let g=0,p=l.length;g<p&&!(s&&c<=g);g++)c?u.push(l[n[g]]):u.push(l[g]);a=0,l=u}this.strippedChoices=l,this.htEditor.loadData(en([l])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a),this.hot.listen(),xo(this.TEXTAREA,t,t===i?void 0:i)}flipDropdownIfNeeded(){let e=ns(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,i=this.cellProperties.preventOverflow;if(t||!t&&(i||i==="horizontal"))return!1;let s=Ot(this.TEXTAREA),r=ft(this.TEXTAREA),n=this.getDropdownHeight(),a=e.scrollTop,l=ft(this.hot.view._wt.wtTable.THEAD),c=Ot(e),u=s.top-c.top-l+a,g=e.scrollHeight-u-l-r,p=n>g&&u>g;return p?this.flipDropdown(n):this.unflipDropdown(),this.limitDropdownIfNeeded(p?u:g,n),p}limitDropdownIfNeeded(e,t){if(t>e){let i=0,s=0,r=0,n=null;do r=this.htEditor.getRowHeight(s)||this.htEditor.view._wt.getSetting("defaultRowHeight"),i+=r,s+=1;while(i<e);n=i-r,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-n}px`),this.setDropdownHeight(i-r)}}flipDropdown(e){let t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){let e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){let e=this.htEditor.getColWidth(0)+Rt(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){let e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){let{allowHtml:t}=this.cellProperties,i=Ge(e,r=>vt(r));return Ge(i,r=>t?r:am(r))}allowKeyEventPropagation(e){let t=this.htEditor.getSelectedRangeLast(),i={row:t?t.from.row:-1},s=!1;return e===Ue.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(s=!0),e===Ue.ARROW_UP&&i.row>-1&&(s=!0),s}onBeforeKeyDown(e){let t=Hy.get(this);if(t.skipOne=!1,hw(e.keyCode)||e.keyCode===Ue.BACKSPACE||e.keyCode===Ue.DELETE||e.keyCode===Ue.INSERT){let i=10;if(e.keyCode===Ue.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(i+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value),t.skipOne=!0},i)}}};var By="checkbox",Sn=class extends Li{static get EDITOR_TYPE(){return By}beginEditing(e,t){if(t&&t.type==="mouseup"){let i=this.TD.querySelector('input[type="checkbox"]');Ve(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}};var En=ri(Ui(),1),Wy=ri(EA(),1);var Bu="date",TA="dateEditor",Tn=class extends Ci{static get EDITOR_TYPE(){return Bu}constructor(e){super(e),this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,this.$datePicker=null}init(){if(typeof En.default!="function")throw new Error("You need to include moment.js to your project.");if(typeof Wy.default!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.instance.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Te(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),new tt(this).addEventListener(this.datePicker,"mousedown",t=>t.stopPropagation())}destroyElements(){let e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,i,s,r,n){super.prepare(e,t,i,s,r,n)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),i.addShortcut({keys:[["Enter"]],callback:s=>{s.stopPropagation()},group:TA})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(()=>{this.instance._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(TA),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){let i=this.originalValue;i!==void 0&&this.setValue(i)}super.finishEditing(e,t)}showDatepicker(e){let t=this.TD.getBoundingClientRect(),i=this.cellProperties.dateFormat||this.defaultDateFormat,s=this.instance.view.isMouseDown(),r=e?xh(e.keyCode):!1,n;this.datePicker.style.display="block",this.$datePicker=new Wy.default(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+t.top+ft(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=t.right-at(this.datePicker):a=t.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(n=this.originalValue,(0,En.default)(n,i,!0).isValid()&&this.$datePicker.setMoment((0,En.default)(n,i),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!r&&!s&&this.setValue("")):this.cellProperties.defaultDate?(n=this.cellProperties.defaultDate,(0,En.default)(n,i,!0).isValid()&&this.$datePicker.setMoment((0,En.default)(n,i),!0),!r&&!s&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){let e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&cr(t,this.cellProperties.datePickerConfig);let i=t.onSelect,s=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=r=>{let n=r;isNaN(n.getTime())||(n=(0,En.default)(n).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(n),this.hideDatepicker(),i&&i()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),s&&s()},t}};var Uy="dropdown",Tr=class extends Do{static get EDITOR_TYPE(){return Uy}prepare(e,t,i,s,r,n){super.prepare(e,t,i,s,r,n),this.cellProperties.filter=!1,this.cellProperties.strict=!0}};He.getSingleton().add("beforeValidate",function(o,e,t){let i=this.getCellMeta(e,this.propToCol(t));i.editor===Tr&&i.strict===void 0&&(i.filter=!1,i.strict=!0)});var Yy="numeric",Rn=class extends Ci{static get EDITOR_TYPE(){return Yy}};var jy="password",Mn=class extends Ci{static get EDITOR_TYPE(){return jy}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,li(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}};var Gy="ht_editor_visible",RA="selectEditor",zy="select",Vu=class extends Li{static get EDITOR_TYPE(){return zy}init(){this.select=this.hot.rootDocument.createElement("SELECT"),Te(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Ve(this.select,Gy)&&je(this.select,Gy),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,i,s,r,n){super.prepare(e,t,i,s,r,n);let a=this.cellProperties.selectOptions,l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),li(this.select),ze(l,(c,u)=>{let g=this.hot.rootDocument.createElement("OPTION");g.value=u,Yi(g,c),this.select.appendChild(g)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let i=0,s=e.length;i<s;i++)t[e[i]]=e[i];else typeof e=="object"&&(t=e);return t}refreshValue(){let e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==si.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}let{top:e,start:t,width:i,height:s}=this.getEditedCellRect(),r=this.select.style;r.height=`${s}px`,r.width=`${i}px`,r.top=`${e}px`,r[this.hot.isRtl()?"right":"left"]=`${t}px`,r.margin="0px",Te(this.select,Gy)}registerShortcuts(){let t=this.hot.getShortcutManager().getContext("editor"),i={group:RA};this.isInFullEditMode()!==!1&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{let s=this.select.selectedIndex-1;s>=0&&(this.select[s].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{let s=this.select.selectedIndex+1;s<=this.select.length-1&&(this.select[s].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(RA)}};var $y="time",On=class extends Ci{static get EDITOR_TYPE(){return $y}prepare(e,t,i,s,r,n){super.prepare(e,t,i,s,r,n),this.TEXTAREA.dir="ltr"}};function MA(){gi(Li),gi(Do),gi(Sn),gi(Tn),gi(Tr),gi(Lo),gi(Rn),gi(Mn),gi(Vu),gi(Ci),gi(On)}var Xy="html";function Wa(o,e,t,i,s,r,n){qs.apply(this,[o,e,t,i,s,r,n]),Yi(e,r??"",!1)}Wa.RENDERER_TYPE=Xy;var qy="autocomplete";function gs(o,e,t,i,s,r,n){let{rootDocument:a}=o,l=n.allowHtml?Wa:xi,c=a.createElement("DIV");if(c.className="htAutocompleteArrow",c.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[o,e,t,i,s,r,n]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(c,e.firstChild),Te(e,"htAutocomplete"),!o.acArrowListener){let u=new tt(o);o.acArrowListener=function(g){Ve(g.target,"htAutocompleteArrow")&&o.view._wt.getSetting("onCellDblClick",null,o._createCellCoords(t,i),e)},u.addEventListener(o.rootElement,"mousedown",o.acArrowListener),o.addHookOnce("afterDestroy",()=>{u.destroy()})}}gs.RENDERER_TYPE=qy;var OA=new WeakMap,AA=new WeakMap,wY="htBadValue",Ua="data-row",Ya="data-col",yY="checkboxRenderer",Wm="checkbox";He.getSingleton().add("modifyAutoColumnSizeSeed",function(o,e,t){let{label:i,type:s,row:r,column:n,prop:a}=e;if(s===Wm){if(i){let{value:l,property:c}=i,u=t;if(l)u=typeof l=="function"?l(r,n,a,t):l;else if(c){let g=this.getDataAtRowProp(r,c);u=g!==null?g:t}o=u}return o}});function ja(o,e,t,i,s,r,n){let{rootDocument:a}=o;qs.apply(this,[o,e,t,i,s,r,n]),vY(o);let l=bY(a),c=n.label,u=!1;if(typeof n.checkedTemplate>"u"&&(n.checkedTemplate=!0),typeof n.uncheckedTemplate>"u"&&(n.uncheckedTemplate=!1),li(e),r===n.checkedTemplate||vt(r).toLocaleLowerCase(n.locale)===vt(n.checkedTemplate).toLocaleLowerCase(n.locale)?l.checked=!0:r===n.uncheckedTemplate||vt(r).toLocaleLowerCase(n.locale)===vt(n.uncheckedTemplate).toLocaleLowerCase(n.locale)?l.checked=!1:At(r)?Te(l,"noValue"):(l.style.display="none",Te(l,wY),u=!0),l.setAttribute(Ua,t),l.setAttribute(Ya,i),!u&&c){let y="";if(c.value)y=typeof c.value=="function"?c.value.call(this,t,i,s,r):c.value;else if(c.property){let O=o.getDataAtRowProp(t,c.property);y=O!==null?O:""}let S=xY(a,y,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(S),e.appendChild(l)):(S.appendChild(l),l=S):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(l),e.appendChild(S)):(S.insertBefore(l,S.firstChild),l=S))}(!c||c&&!c.separated)&&e.appendChild(l),u&&e.appendChild(a.createTextNode("#bad-value#")),OA.has(o)||(OA.set(o,!0),g());function g(){let S=o.getShortcutManager().getContext("grid"),O={group:yY};S.addShortcuts([{keys:[["space"]],callback:()=>(p(),!C())},{keys:[["enter"]],callback:()=>(p(),!C()),runOnlyIf:()=>o.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(p(!0),!C()),relativeToGroup:cn,position:"before"}],O)}function p(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=o.getSelectedRange();if(S)for(let O=0;O<S.length;O++){let{row:M,col:_}=S[O].getTopStartCorner(),{row:N,col:E}=S[O].getBottomEndCorner(),k=[];for(let ie=M;ie<=N;ie+=1)for(let $=_;$<=E;$+=1){let H=o.getCellMeta(ie,$);if(H.type!=="checkbox")return;if(H.readOnly===!0)continue;typeof H.checkedTemplate>"u"&&(H.checkedTemplate=!0),typeof H.uncheckedTemplate>"u"&&(H.uncheckedTemplate=!1);let Q=o.getDataAtCell(ie,$);y===!1?[H.checkedTemplate,H.checkedTemplate.toString()].includes(Q)?k.push([ie,$,H.uncheckedTemplate]):[H.uncheckedTemplate,H.uncheckedTemplate.toString(),null,void 0].includes(Q)&&k.push([ie,$,H.checkedTemplate]):k.push([ie,$,H.uncheckedTemplate])}k.length>0&&o.setDataAtCell(k)}}function C(){let y=o.getSelectedRange();if(y){for(let S=0;S<y.length;S++){let O=y[S].getTopStartCorner(),M=y[S].getBottomEndCorner();for(let _=O.row;_<=M.row;_++)for(let N=O.col;N<=M.col;N++){let E=o.getCellMeta(_,N);if(E.type!=="checkbox")return!1;let k=o.getCell(_,N);if(k==null)return!0;if(k.querySelectorAll("input[type=checkbox]").length>0&&!E.readOnly)return!0}}return!1}}}ja.RENDERER_TYPE=Wm;function vY(o){let e=AA.get(o);if(!e){let{rootElement:t}=o;e=new tt(o),e.addEventListener(t,"click",i=>EY(i,o)),e.addEventListener(t,"mouseup",i=>SY(i,o)),e.addEventListener(t,"change",i=>TY(i,o)),AA.set(o,e)}return e}function bY(o){let e=o.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function xY(o,e,t){let i=o.createElement("label");return i.className=`htCheckboxRendererLabel ${t?"fullWidth":""}`,i.appendChild(o.createTextNode(e)),i.cloneNode(!0)}function SY(o,e){let{target:t}=o;Ky(t)&&(!t.hasAttribute(Ua)||!t.hasAttribute(Ya)||setTimeout(e.listen,10))}function EY(o,e){let{target:t}=o;if(!Ky(t)||!t.hasAttribute(Ua)||!t.hasAttribute(Ya))return;let i=parseInt(t.getAttribute(Ua),10),s=parseInt(t.getAttribute(Ya),10);e.getCellMeta(i,s).readOnly&&o.preventDefault()}function TY(o,e){let{target:t}=o;if(!Ky(t)||!t.hasAttribute(Ua)||!t.hasAttribute(Ya))return;let i=parseInt(t.getAttribute(Ua),10),s=parseInt(t.getAttribute(Ya),10),r=e.getCellMeta(i,s);if(!r.readOnly){let n=null;o.target.checked?n=r.uncheckedTemplate===void 0?!0:r.checkedTemplate:n=r.uncheckedTemplate===void 0?!1:r.uncheckedTemplate,e.setDataAtCell(i,s,n)}}function Ky(o){return o.tagName==="INPUT"&&o.getAttribute("type")==="checkbox"}var Rr=ri(_A(),1);var Qy="numeric";function Ga(o,e,t,i,s,r,n){let a=r;if(ii(a)){let l=n.numericFormat,c=l&&l.culture||"-",u=l&&l.pattern,g=n.className||"",p=g.length?g.split(" "):[];if(typeof c<"u"&&!Rr.default.languages()[c]){let C=c.replace("-",""),y=Rr.default.allLanguages?Rr.default.allLanguages[c]:Rr.default[C];y&&Rr.default.registerLanguage(y)}Rr.default.setLanguage(c),a=(0,Rr.default)(a).format(u||"0"),p.indexOf("htLeft")<0&&p.indexOf("htCenter")<0&&p.indexOf("htRight")<0&&p.indexOf("htJustify")<0&&p.push("htRight"),p.indexOf("htNumeric")<0&&p.push("htNumeric"),n.className=p.join(" "),e.dir="ltr"}xi(o,e,t,i,s,a,n)}Ga.RENDERER_TYPE=Qy;var Jy="password";function za(o,e,t,i,s,r,n){xi.apply(this,[o,e,t,i,s,r,n]);let a=n.hashLength||e.innerHTML.length,l=n.hashSymbol||"*",c="";ke(a-1,()=>{c+=l}),Yi(e,c)}za.RENDERER_TYPE=Jy;var ev="time";function $a(o,e,t,i,s,r,n){xi.apply(this,[o,e,t,i,s,r,n]),e.dir="ltr"}$a.RENDERER_TYPE=ev;function NA(){Gi(gs),Gi(qs),Gi(ja),Gi(Wa),Gi(Ga),Gi(za),Gi(xi),Gi($a)}var tv="autocomplete";function Mr(o,e){let t=o;if(t==null&&(t=""),this.allowEmpty&&t===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,PA(t,e)):PA(t,e)(this.source):e(!0)}Mr.VALIDATOR_TYPE=tv;function PA(o,e){let t=o;return function(i){let s=!1;for(let r=0,n=i.length;r<n;r++)if(t===i[r]){s=!0;break}e(s)}}var Wu=ri(Ui(),1);var sv={};Ri(sv,{getNormalizedDate:()=>iv});function iv(o){let e=new Date(o);return isNaN(new Date(`${o}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}var ov="date";function Xa(o,e){let t=fm(Bu,this.instance),i=o,s=!0;i==null&&(i="");let r=(0,Wu.default)(i,this.dateFormat||t.defaultDateFormat,!0).isValid(),n=(0,Wu.default)(new Date(i)).isValid()||r;if(this.allowEmpty&&i===""&&(n=!0,r=!0),n||(s=!1),!n&&r&&(s=!0),n&&!r)if(this.correctFormat===!0){let a=LA(i,this.dateFormat),l=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,c,a,"dateValidator"),s=!0}else s=!1;e(s)}Xa.VALIDATOR_TYPE=ov;function LA(o,e){let t=(0,Wu.default)(iv(o)),i=(0,Wu.default)(o,e),s=o.search(/[A-z]/g)>-1,r;return t.isValid()&&t.format("x")===i.format("x")||!i.isValid()||s?r=t:r=i,r.format(e)}var rv="numeric";function qa(o,e){let t=o;t==null&&(t=""),this.allowEmpty&&t===""?e(!0):e(t===""?!1:ii(o))}qa.VALIDATOR_TYPE=rv;var Uu=ri(Ui(),1),RY=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],nv="time";function Ka(o,e){let t=this.timeFormat||"h:mm:ss a",i=!0,s=o;s===null&&(s=""),s=/^\d{3,}$/.test(s)?parseInt(s,10):s;let r=/^\d{1,2}$/.test(s);r&&(s+=":00");let n=(0,Uu.default)(s,RY,!0).isValid()?(0,Uu.default)(s):(0,Uu.default)(s,t),a=n.isValid(),l=(0,Uu.default)(s,t,!0).isValid()&&!r;if(this.allowEmpty&&s===""&&(a=!0,l=!0),a||(i=!1),!a&&l&&(i=!0),a&&!l)if(this.correctFormat===!0){let c=n.format(t),u=this.instance.toVisualRow(this.row),g=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(u,g,c,"timeValidator"),i=!0}else i=!1;e(i)}Ka.VALIDATOR_TYPE=nv;function DA(){Ro(Mr),Ro(Xa),Ro(qa),Ro(Ka)}var av="autocomplete",lv={CELL_TYPE:av,editor:Do,renderer:gs,validator:Mr};var hv="checkbox",cv={CELL_TYPE:hv,editor:Sn,renderer:ja};var uv="date",dv={CELL_TYPE:uv,editor:Tn,renderer:gs,validator:Xa};var fv="dropdown",mv={CELL_TYPE:fv,editor:Tr,renderer:gs,validator:Mr};var pv="handsontable",gv={CELL_TYPE:pv,editor:Lo,renderer:gs};var Cv="numeric",wv={CELL_TYPE:Cv,editor:Rn,renderer:Ga,validator:qa,dataType:"number"};var yv="password",vv={CELL_TYPE:yv,editor:Mn,renderer:za,copyable:!1};var bv="time",xv={CELL_TYPE:bv,editor:On,renderer:$a,validator:Ka};function kA(){Pi(lv),Pi(cv),Pi(dv),Pi(mv),Pi(gv),Pi(wv),Pi(vv),Pi(Fu),Pi(xv)}function MY(o,e){OY(o,e),e.add(o)}function OY(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AY(o,e,t){if(!e.has(o))throw new TypeError("attempted to get private field on non-instance");return t}var HA=new Map([["plugin",kM],["cell-type",Ty],["editor",Cw],["renderer",Rw],["validator",Mw]]),BA="base",An=new WeakMap,Sv=[],Ks=null,FA=new WeakSet,Ye=class{static get PLUGIN_KEY(){return BA}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){MY(this,FA),hi(this,"hot",e,{writable:!1}),An.set(this,{hooks:{}}),Ks=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);let e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){let s=[];if(t.forEach(r=>{let[n,a]=r.split(":");if(!HA.has(n))throw new Error(`Unknown plugin dependency type "${n}" was found.`);HA.get(n)(a)||s.push(` - ${a} (${n})`)}),s.length>0){let r=[`The ${this.pluginName} plugin requires the following modules:
`,`${s.join(`
`)}
`].join("");Sv.push(r)}}if(Ks||(Ks=va()),Ks.indexOf("UndoRedo")>=0&&Ks.splice(Ks.indexOf("UndoRedo"),1),Ks.indexOf(this.pluginName)>=0&&Ks.splice(Ks.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Ks.length===0){if(Sv.length>0){let s=[`${Sv.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t){An.get(this).hooks[e]=An.get(this).hooks[e]||[];let i=An.get(this).hooks[e];this.hot.addHook(e,t),i.push(t),An.get(this).hooks[e]=i}removeHooks(e){we(An.get(this).hooks[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){let e=An.get(this).hooks;ze(e,(t,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){we(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){let t=AY(this,FA,IY).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){this.eventManager&&this.eventManager.destroy(),this.clearHooks(),ze(this,(e,t)=>{t!=="hot"&&(this[t]=null)}),delete this.t,delete this.hot}};function IY(o){if(!o)return!1;let e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let t=0;t<e.length;t++)if(o[e[t]]!==void 0)return!0;return!1}var Ev=class{constructor(e){this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));let i={row:e};this.rows.push(i),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){let t=this.hot.getColHeader(0);if(t!=null){let i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));let i={col:e};this.columns.push(i),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),we(this.rows,t=>{e(t.row,ft(t.table)-1)})}getWidths(e){this.injected||this.injectTable(),we(this.columns,t=>{let{width:i}=t.table.getBoundingClientRect();e(t.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(){let e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1)),this.samples.forEach(t=>{we(t.strings,i=>{e.appendChild(this.createColElement(i.col))})}),e}createRow(e){let{rootDocument:t}=this.hot,i=t.createDocumentFragment(),s=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,s),i.appendChild(s)),this.samples.forEach(r=>{we(r.strings,n=>{let a=n.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;let c=this.hot.getCellRenderer(l),u=t.createElement("td");u.setAttribute("ghost-table",1),c(this.hot,u,e,a,this.hot.colToProp(a),n.value,l),i.appendChild(u)})}),i}appendColumnHeadersRow(){let{rootDocument:e}=this.hot,t=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){let s=e.createElement("th");i.push([-1,s]),t.appendChild(s)}this.samples.forEach(s=>{we(s.strings,r=>{let n=r.col,a=e.createElement("th");i.push([n,a]),t.appendChild(a)})}),this.table.tHead.appendChild(t),we(i,s=>{let[r,n]=s;this.hot.view.appendColHeader(r,n)})}createCol(e){let{rootDocument:t}=this.hot,i=t.createDocumentFragment();return this.samples.forEach(s=>{we(s.strings,r=>{let n=r.row,a=this.hot.getCellMeta(n,e);a.col=e,a.row=n;let l=this.hot.getCellRenderer(a),c=t.createElement("td"),u=t.createElement("tr");c.setAttribute("ghost-table",1),l(this.hot,c,n,e,this.hot.colToProp(e),r.value,a),u.appendChild(c),i.appendChild(u)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e){let t=this.hot.rootDocument.createElement("col");return t.style.width=`${this.hot.view._wt.wtTable.getStretchedColumnWidth(e)}px`,t}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",{rootDocument:t}=this.hot,i=t.createDocumentFragment(),s=t.createElement("table"),r=t.createElement("thead"),n=t.createElement("tbody"),a=t.createElement("colgroup"),l=t.createElement("tr"),c=t.createElement("th");return this.isVertical()&&s.appendChild(a),this.isHorizontal()&&(l.appendChild(c),r.appendChild(l),s.style.tableLayout="auto",s.style.width="auto"),s.appendChild(r),this.isVertical()&&n.appendChild(l),s.appendChild(n),Te(s,e),i.appendChild(s),{fragment:i,table:s,tHead:r,tBody:n,colGroup:a,tr:l,th:c}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",{rootDocument:t}=this.hot,i=t.createDocumentFragment(),s=t.createElement("div"),r=`htGhostTable htAutoSize ${e.trim()}`;return Te(s,r),i.appendChild(s),{fragment:i,container:s}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}},Za=Ev;var Tv=class o{static get SAMPLE_COUNT(){return 3}constructor(e){this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}getSampleCount(){return this.customSampleCount?this.customSampleCount:o.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,i){let s=new Map,{from:r,to:n}=typeof i=="number"?{from:i,to:i}:i;return ke(r,n,a=>{let l=this.generateSample(e,t,a);s.set(a,l)}),s}generateSample(e,t,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");let s=new Map,r=e==="row"?"col":"row",n=[];return ke(t.from,t.to,a=>{let{value:l,bundleSeed:c}=e==="row"?this.dataFactory(i,a):this.dataFactory(a,i),u=typeof c=="string"&&c.length>0,g;u?g=c:$e(l)?g=`${Object.keys(l).length}`:Array.isArray(l)?g=`${l.length}`:g=`${vt(l).length}`,s.has(g)||s.set(g,{needed:this.getSampleCount(),strings:[]});let p=s.get(g);p.needed&&(!(n.indexOf(l)>-1)||this.allowDuplicates||u)&&(p.strings.push({value:l,[r]:a}),n.push(l),p.needed-=1)}),s}},Um=Tv;He.getSingleton().register("modifyAutoColumnSizeSeed");var Qa="autoColumnSize",VA=10,Rv=new WeakMap,_Y="autoColumnSize",Yu=class o extends Ye{static get PLUGIN_KEY(){return Qa}static get PLUGIN_PRIORITY(){return VA}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Rv.set(this,{cachedColumnHeaders:[]}),this.ghostTable=new Za(this.hot),this.samplesGenerator=new Um((t,i)=>{let s=this.hot.getCellMeta(t,i),r="";s.spanned||(r=this.hot.getDataAtCell(t,i));let n="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(n=this.hot.runHooks("modifyAutoColumnSizeSeed",n,s,r)),{value:r,bundleSeed:n}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredColumns=0,this.columnWidthsMap=new mi,this.hot.columnIndexMapper.registerMap(_Y,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,i,s)=>this.onBeforeColumnResize(t,i,s))}isEnabled(){return this.hot.getSettings()[Qa]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;let t=this.hot.getSettings()[Qa];t&&t.useHeaders!==null&&t.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",i=>this.onBeforeChange(i)),this.addHook("afterFormulasValuesUpdate",i=>this.onAfterFormulasValuesUpdate(i)),this.addHook("beforeViewRender",i=>this.onBeforeViewRender(i)),this.addHook("modifyColWidth",(i,s)=>this.getColumnWidth(s,i)),this.addHook("afterInit",()=>this.onAfterInit()),super.enablePlugin()}updatePlugin(){let e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,i)=>this.onBeforeColumnResize(e,t,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;let t=this.hot.renderCall,i=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn();i===-1||s===-1||this.calculateColumnsWidth({from:i,to:s},void 0,t)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof e=="number"?{from:e,to:e}:e,r=typeof t=="number"?{from:t,to:t}:t;ke(s.from,s.to,n=>{let a=this.hot.toPhysicalColumn(n);if(a===null&&(a=n),i||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){let l=this.samplesGenerator.generateColumnSamples(n,r);we(l,c=>{let[u,g]=c;return this.ghostTable.addColumn(u,g)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((n,a)=>{let l=this.hot.toPhysicalColumn(n);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=0,i=this.hot.countCols()-1,s=null;this.inProgress=!0;let r=()=>{if(!this.hot){pn(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:t,to:Math.min(t+o.CALCULATION_STEP,i)},e),t=t+o.CALCULATION_STEP+1,t<i?s=mn(r):(pn(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},n=this.getSyncCalculationLimit();this.firstCalculation&&n>=0&&(this.calculateColumnsWidth({from:0,to:n},e),this.firstCalculation=!1,t=n+1),t<i?r():this.inProgress=!1}setSamplingOptions(){let e=this.hot.getSettings()[Qa],t=e&&St(e,"samplingRatio")?e.samplingRatio:void 0,i=e&&St(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){let e=this.hot.getSettings()[Qa],t=o.SYNC_CALCULATION_LIMIT,i=this.hot.countCols()-1;return $e(e)&&(t=e.syncLimit,ch(t)?t=Eh(i,t):t>>=0),Math.min(t,i)}getColumnWidth(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=t;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof s=="number"&&(s=Math.max(s,dr.DEFAULT_WIDTH))),s}getFirstVisibleColumn(){let e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){let t=e.wtTable.getFirstVisibleColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){let t=e.wtTable.getFirstRenderedColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}getLastVisibleColumn(){let e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){let t=e.wtTable.getLastVisibleColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){let t=e.wtTable.getLastRenderedColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}findColumnsWhereHeaderWasChanged(){let e=this.hot.getColHeader(),{cachedColumnHeaders:t}=Rv.get(this);return pt(e,(s,r,n)=>{let a=t.length;return(a-1<n||t[n]!==r)&&s.push(n),a-1<n?t.push(r):t[n]=r,s},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{we(e,t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!zt(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}onBeforeViewRender(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}onAfterLoadData(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}onBeforeChange(e){let t=Ge(e,i=>{let[,s]=i;return this.hot.toPhysicalColumn(this.hot.propToCol(s))});this.clearCache(Array.from(new Set(t)))}onBeforeColumnResize(e,t,i){let s=e;return i&&(this.calculateColumnsWidth(t,void 0,!0),s=this.getColumnWidth(t,void 0,!1)),s}onAfterInit(){Rv.get(this).cachedColumnHeaders=this.hot.getColHeader()}onAfterFormulasValuesUpdate(e){let t=zt(e,s=>{var r;return Pe((r=s.address)===null||r===void 0?void 0:r.col)}),i=Ge(t,s=>s.address.col);this.clearCache(Array.from(new Set(i)))}destroy(){this.ghostTable.clean(),super.destroy()}};var Or={horizontal:"horizontal",vertical:"vertical"};function WA(o,e,t){let i,s,r;return e[0]===o[0]&&e[1]<o[1]?(r="left",i=t(e[0],e[1]),s=t(e[2],o[1]-1)):e[2]===o[2]&&e[0]===o[0]&&e[3]>o[3]?(r="right",i=t(e[0],o[3]+1),s=t(e[2],e[3])):e[0]<o[0]&&e[1]===o[1]?(r="up",i=t(e[0],e[1]),s=t(o[0]-1,e[3])):e[2]>o[2]&&e[1]===o[1]&&(r="down",i=t(o[2]+1,e[1]),s=t(e[2],e[3])),i&&i.normalize(),s&&s.normalize(),{directionOfDrag:r,startOfDragCoords:i,endOfDragCoords:s}}function UA(o){let e={};return o===!0?(e.directions=Object.keys(Or),e.autoInsertRow=!0):$e(o)?(Pe(o.autoInsertRow)?o.direction===Or.horizontal?e.autoInsertRow=!1:e.autoInsertRow=o.autoInsertRow:e.autoInsertRow=!1,Pe(o.direction)?e.directions=[o.direction]:e.directions=Object.keys(Or)):typeof o=="string"?(e.directions=[o],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}He.getSingleton().register("modifyAutofillRange");He.getSingleton().register("beforeAutofill");He.getSingleton().register("afterAutofill");var Mv="autofill",YA=20,NY=["fillHandle"],PY="insert_row_below",LY=200,ju=class extends Ye{static get PLUGIN_KEY(){return Mv}static get PLUGIN_PRIORITY(){return YA}static get SETTING_KEYS(){return[Mv,...NY]}constructor(e){super(e),this.eventManager=new tt(this),this.addingStarted=!1,this.mouseDownOnCellCorner=!1,this.mouseDragOutside=!1,this.handleDraggedCells=0,this.directions=[],this.autoInsertRow=!1}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>this.onAfterCellCornerMouseDown(e)),this.addHook("afterOnCellCornerDblClick",e=>this.onCellCornerDblClick(e)),this.addHook("beforeOnCellMouseOver",(e,t)=>this.onBeforeCellMouseOver(t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let e=this.hot.getSelectedRangeLast(),{row:t,col:i}=e.getTopStartCorner(),{row:s,col:r}=e.getBottomEndCorner(),n=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:i,endRow:s,endCol:r}]),a=[],l=[],c=[];return we(n,u=>{for(let g=u.startRow;g<=u.endRow;g+=1)a.indexOf(g)===-1&&a.push(g);for(let g=u.startCol;g<=u.endCol;g+=1)l.indexOf(g)===-1&&l.push(g)}),we(a,u=>{let g=[];we(l,p=>{g.push(this.hot.getCopyableData(u,p))}),c.push(g)}),c}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;let[e,t,i,s]=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.getSelectedRangeLast(),n=r.getTopStartCorner(),a=r.getBottomEndCorner();this.resetSelectionOfDraggedArea();let l=[n.row,n.col,a.row,a.col],c=this.hot.runHooks("modifyAutofillRange",[Math.min(n.row,e),Math.min(n.col,t),Math.max(a.row,i),Math.max(a.col,s)],l),{directionOfDrag:u,startOfDragCoords:g,endOfDragCoords:p}=WA(l,c,(C,y)=>this.hot._createCellCoords(C,y));if(g&&g.row>-1&&g.col>-1){let C=this.getSelectionData(),y=r.clone(),S=this.hot._createCellRange(g,g,p),O=this.hot.runHooks("beforeAutofill",C,y,S,u);if(O===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let M=O,_=O;if(["up","left"].indexOf(u)>-1&&!(_.length===1&&_[0].length===0))if(M=[],u==="up"){let N=p.row-g.row+1,E=N%_.length;for(let k=0;k<N;k++)M.push(_[(k+(_.length-E))%_.length])}else{let N=p.col-g.col+1,E=N%_[0].length;for(let k=0;k<_.length;k++){M.push([]);for(let ie=0;ie<N;ie++)M[k].push(_[k][(ie+(_[k].length-E))%_[k].length])}}this.hot.populateFromArray(g.row,g.col,M,p.row,p.col,`${this.pluginName}.fill`,null),this.setSelection(c),this.hot.runHooks("afterAutofill",M,y,S,u),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){let t=this.hot.getSelectedRangeLast(),i=t.getBottomEndCorner(),s=e;if(this.directions.includes(Or.vertical)&&this.directions.includes(Or.horizontal)){let r=t.getTopStartCorner();(i.col<=e.col||r.col>=e.col)&&(s=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||r.row>e.row)&&(s=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(Or.vertical))s=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(Or.horizontal))s=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(s)}showBorder(e){let t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(PY,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},LY)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){let e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&t[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){let t=this.hot.getData(),i=this.hot.countRows(),s;for(let r=e[2]+1;r<i;r++){for(let l=e[1];l<=e[3];l++)if(t[r][l])return-1;let n=t[r][e[1]-1],a=t[r][e[3]+1];(n||a)&&(s=r)}return s}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ge(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){let e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){let{documentElement:t}=this.hot.rootDocument,i=Ot(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+ft(this.hot.table),s=Ot(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+at(this.hot.table);return e.clientY>i&&e.clientX<=s}registerEvents(){let{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t))}onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}onBeforeCellMouseOver(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}onMouseUp(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}onMouseMove(e){let t=this.getIfMouseWasDraggedOutside(e);this.addingStarted===!1&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){let e=UA(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}};var Gu="autoRowSize",jA=40,DY="autoRowSize",zu=class o extends Ye{static get PLUGIN_KEY(){return Gu}static get PLUGIN_PRIORITY(){return jA}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),this.rowHeightsMap=void 0,this.headerHeight=null,this.ghostTable=new Za(this.hot),this.samplesGenerator=new Um((t,i)=>{let s;return t>=0?s=this.hot.getDataAtCell(t,i):t===-1&&(s=this.hot.getColHeader(i)),{value:s}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredRows=0,this.rowHeightsMap=new mi,this.hot.rowIndexMapper.registerMap(DY,this.rowHeightsMap),this.addHook("beforeRowResize",(t,i,s)=>this.onBeforeRowResize(t,i,s))}isEnabled(){let e=this.hot.getSettings()[Gu];return e===!0||$e(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",t=>this.onBeforeChange(t)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",t=>this.onBeforeViewRender(t)),this.addHook("modifyRowHeight",(t,i)=>this.getRowHeight(i,t)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,i)=>this.onBeforeRowResize(e,t,i))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof e=="number"?{from:e,to:e}:e,r=typeof t=="number"?{from:t,to:t}:t;if(this.hot.getColHeader(0)!==null){let n=this.samplesGenerator.generateRowSamples(-1,r);this.ghostTable.addColumnHeadersRow(n.get(-1))}ke(s.from,s.to,n=>{if(i||this.rowHeightsMap.getValueAtIndex(n)===null){let a=this.samplesGenerator.generateRowSamples(n,r);we(a,l=>{let[c,u]=l;return this.ghostTable.addRow(c,u)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,a)=>{n<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(n),a)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=0,i=this.hot.countRows()-1,s=null;this.inProgress=!0;let r=()=>{if(!this.hot){pn(s),this.inProgress=!1;return}this.calculateRowsHeight({from:t,to:Math.min(t+o.CALCULATION_STEP,i)},e),t=t+o.CALCULATION_STEP+1,t<i?s=mn(r):(pn(s),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},n=this.getSyncCalculationLimit();this.firstCalculation&&n>=0&&(this.calculateRowsHeight({from:0,to:n},e),this.firstCalculation=!1,t=n+1),t<i?r():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){let e=this.hot.getSettings()[Gu],t=e&&St(e,"samplingRatio")?e.samplingRatio:void 0,i=e&&St(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllRowsHeight(){wo(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){let e=this.hot.getSettings()[Gu],t=o.SYNC_CALCULATION_LIMIT,i=this.hot.countRows()-1;return $e(e)&&(t=e.syncLimit,ch(t)?t=Eh(i,t):t>>=0),Math.min(t,i)}getRowHeight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,i=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e)),s=t;return i!==null&&i>(t||0)&&(s=i),s}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){let e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){let e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){let{from:t,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{ke(Math.min(t,i),Math.max(t,i),s=>{this.rowHeightsMap.setValueAtIndex(s,null)})},!0)}isNeedRecalculate(){return!!zt(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}onBeforeViewRender(){let e=this.hot.renderCall,t=this.hot.getSettings().fixedRowsBottom,i=this.getFirstVisibleRow(),s=this.getLastVisibleRow();if(!(i===-1||s===-1)){if(this.calculateRowsHeight({from:i,to:s},void 0,e),t){let r=this.hot.countRows()-1;this.calculateRowsHeight({from:r-t,to:r})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}onBeforeRowMove(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()}onBeforeRowResize(e,t,i){let s=e;return i&&(this.calculateRowsHeight(t,void 0,!0),s=this.getRowHeight(t)),s}onAfterLoadData(){this.hot.view?this.recalculateAllRowsHeight():setTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()},0)}onBeforeChange(e){let t=null;e.length===1?t=e[0][0]:e.length>1&&(t={from:e[0][0],to:e[e.length-1][0]}),t!==null&&this.clearCacheByRange(t)}destroy(){this.ghostTable.clean(),super.destroy()}};var{getListWithInsertedItems:kY,getListWithRemovedItems:HY}=tc("physicallyIndexed"),Ov=class extends Mi{constructor(){super(e=>e)}insert(e,t){let i=wr(this.indexedValues,t);this.indexedValues=kY(i,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){let t=HY(this.indexedValues,e);this.indexedValues=Cr(t,e),super.remove(e)}},GA=Ov;var{getListWithInsertedItems:FY,getListWithRemovedItems:BY}=tc("physicallyIndexed"),Av=class extends Mi{constructor(){super(e=>e)}insert(e,t){this.indexedValues=FY(this.indexedValues,e,t,(i,s)=>this.getNextValue(s)),super.insert(e,t)}remove(e){this.indexedValues=BY(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}},zA=Av;var Ym="bindRowsWithHeaders",$A=210,VY="loose",WY=new Map([["loose",GA],["strict",zA]]),$u=class extends Ye{static get PLUGIN_KEY(){return Ym}static get PLUGIN_PRIORITY(){return $A}constructor(e){super(e),this.headerIndexes=null}isEnabled(){return!!this.hot.getSettings()[Ym]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[Ym];typeof e!="string"&&(e=VY);let t=WY.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",i=>this.onModifyRowHeader(i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}onModifyRowHeader(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}destroy(){super.destroy()}};function UY(o,e,t){YY(o,e),e.set(o,t)}function YY(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Iv(o,e,t){return e=jY(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function jY(o){var e=GY(o,"string");return typeof e=="symbol"?e:String(e)}function GY(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}function XA(o,e){var t=KA(o,e,"get");return zY(o,t)}function zY(o,e){return e.get?e.get.call(o):e.value}function _v(o,e,t){var i=KA(o,e,"set");return $Y(o,i,t),t}function KA(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function $Y(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var jm="collapsibleColumns",ZA=290,XY=["nestedHeaders"],Ja="collapsibleIndicator",qA=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),el=new WeakMap,Xu=class extends Ye{constructor(){super(...arguments),Iv(this,"nestedHeadersPlugin",null),Iv(this,"eventManager",new tt(this)),Iv(this,"headerStateManager",null),UY(this,el,{writable:!0,value:null})}static get PLUGIN_KEY(){return jm}static get PLUGIN_PRIORITY(){return ZA}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[jm,...XY]}isEnabled(){return!!this.hot.getSettings()[jm]}enablePlugin(){var e=this;if(this.enabled)return;let{nestedHeaders:t}=this.hot.getSettings();t||mt("You need to configure the Nested Headers plugin in order to use collapsible headers."),_v(this,el,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("afterGetColHeader",function(){return e.onAfterGetColHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",(i,s,r)=>this.onBeforeOnCellMouseDown(i,s,r)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){let{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_v(this,el,null),this.nestedHeadersPlugin=null,this.clearButtons(),super.disablePlugin()}clearButtons(){if(!this.hot.view)return;let e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,r=function(n){n&&n.parentNode.removeChild(n)};ke(0,e-1,n=>{let a=t.childNodes[n],l=i.childNodes[n],c=s?s.childNodes[n]:null;ke(0,a.childNodes.length-1,u=>{let g=a.childNodes[u].querySelector(`.${Ja}`);r(g),l&&l.childNodes[u]&&(g=l.childNodes[u].querySelector(`.${Ja}`),r(g)),s&&c&&c.childNodes[u]&&(g=c.childNodes[u].querySelector(`.${Ja}`),r(g))})},!0)}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){let t=this.headerStateManager.mapNodes(i=>{let{collapsible:s,origColspan:r,headerLevel:n,columnIndex:a,isCollapsed:l}=i;if(s===!0&&r>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(n),col:a}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!qA.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;let i=zt(e,p=>{let{row:C}=p;return C<0}),s=i.length>0;we(i,p=>{var C;let{row:y,col:S}=p,{collapsible:O,isCollapsed:M}=(C=this.headerStateManager.getHeaderSettings(y,S))!==null&&C!==void 0?C:{};if(!O||M&&t==="collapse"||!M&&t==="expand")return s=!1,!1});let r=[],n=[];s&&we(i,p=>{let{row:C,col:y}=p,{colspanCompensation:S,affectedColumns:O,rollbackModification:M}=this.headerStateManager.triggerNodeModification(t,C,y);S>0&&(n.push(...O),r.push(M))});let a=this.getCollapsedColumns(),l=[];t==="collapse"?l=rh([...a,...n]):t==="expand"&&(l=zt(a,p=>!n.includes(p)));let c=qA.get(t);if(this.hot.runHooks(c.beforeHook,a,l,s)===!1){we(r,p=>{p()});return}this.hot.batchExecution(()=>{we(n,p=>{XA(this,el).setValueAtIndex(this.hot.toPhysicalColumn(p),c.hideColumn)})},!0);let g=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(c.afterHook,a,l,s,g),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return XA(this,el).getHiddenIndexes()}onAfterGetColHeader(e,t,i){var s;let{collapsible:r,origColspan:n,isCollapsed:a}=(s=this.headerStateManager.getHeaderSettings(i,e))!==null&&s!==void 0?s:{},l=r&&n>1&&e>=this.hot.getSettings().fixedColumnsStart,c=t.querySelector(`.${Ja}`);if(l)c||(c=this.hot.rootDocument.createElement("div"),Te(c,Ja),t.querySelector("div:first-child").appendChild(c)),je(c,["collapsed","expanded"]),a?(Te(c,"collapsed"),ji(c,"+")):(Te(c,"expanded"),ji(c,"-"));else{var u;(u=c)===null||u===void 0||u.remove()}}onBeforeOnCellMouseDown(e,t){Ve(e.target,Ja)&&(Ve(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):Ve(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),ni(e))}onInit(){this.updatePlugin()}onAfterLoadData(e,t){t||this.updatePlugin()}destroy(){_v(this,el,null),super.destroy()}};var qY=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],KY=!1,ZY=!0,QY=!0,Gm=class{constructor(e,t){this.hot=e,this.sortingStates=new $s,this.sortEmptyCells=KY,this.indicator=ZY,this.headerAction=QY,this.compareFunctionFactory=void 0,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){$e(e)&&ze(e,(t,i)=>{qY.includes(i)&&(this[i]=t)})}getAllColumnsProperties(){let e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[i]=t;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return $e(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[i,s]=t;return{column:this.hot.toVisualColumn(i),...s}})}getColumnSortState(e){let t=this.getSortOrderOfColumn(e);if(Pe(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}};var qu="asc",Ku="desc",JY="colHeader";function ej(o){if($e(o)===!1)return!1;let{column:e,sortOrder:t}=o;return Number.isInteger(e)&&[qu,Ku].includes(t)}function QA(o){if(o.some(t=>ej(t)===!1))return!1;let e=o.map(t=>{let{column:i}=t;return i});return new Set(e).size===e.length}function Nv(o){if(o!==Ku)return o===qu?Ku:qu}function Pv(o){return o.querySelector(`.${JY}`)}function Lv(o,e){if(o<0||!e.parentNode)return!1;let t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length===-1}function Zu(o,e,t){return o===-1&&e>=0&&Ni(t)===!1}var tj="ascending",ij="descending",JA="indicatorDisabled",eI="columnSorting",tI="sortAction",iI=new Map([[qu,tj],[Ku,ij]]);function sI(o,e,t,i){let s=[eI];if(i&&s.push(tI),t===!1)return s.push(JA),s;let r=o.getSortOrderOfColumn(e);return Pe(r)&&s.push(iI.get(r)),s}function oI(){return Array.from(iI.values()).concat(tI,JA,eI)}function zm(o,e,t){let i=e.locale;return function(s,r){let{sortEmptyCells:n}=t;return typeof s=="string"&&(s=s.toLocaleLowerCase(i)),typeof r=="string"&&(r=r.toLocaleLowerCase(i)),s===r?Si:At(s)?At(r)?Si:n?o==="asc"?Pt:Lt:Lt:At(r)?n?o==="asc"?Lt:Pt:Pt:isNaN(s)&&!isNaN(r)?o==="asc"?Lt:Pt:!isNaN(s)&&isNaN(r)?o==="asc"?Pt:Lt:(isNaN(s)||isNaN(r)||(s=parseFloat(s),r=parseFloat(r)),s<r?o==="asc"?Pt:Lt:s>r?o==="asc"?Lt:Pt:Si)}}var Dv="default";function rI(o,e,t){return function(i,s){let r=parseFloat(i),n=parseFloat(s),{sortEmptyCells:a}=t;if(r===n||isNaN(r)&&isNaN(n))return Si;if(a){if(At(i))return o==="asc"?Pt:Lt;if(At(s))return o==="asc"?Lt:Pt}return isNaN(r)?Lt:isNaN(n)?Pt:r<n?o==="asc"?Pt:Lt:r>n?o==="asc"?Lt:Pt:Si}}var nI="numeric";function aI(o,e,t){let i=e.checkedTemplate,s=e.uncheckedTemplate,{sortEmptyCells:r}=t;return function(n,a){let l=At(n),c=At(a),u=l?s:n,g=c?s:a,p=u===s||u===i,C=g===s||g===i;if(r===!1){if(l&&c===!1)return Lt;if(l===!1&&c)return Pt}return p===!1&&C?o==="asc"?Pt:Lt:p&&C===!1?o==="asc"?Lt:Pt:p===!1&&C===!1?zm(o,e,t)(n,a):u===s&&g===i?o==="asc"?Pt:Lt:u===i&&g===s?o==="asc"?Lt:Pt:Si}}var lI="checkbox";var kv=ri(Ui(),1);function hI(o,e,t){return function(i,s){let{sortEmptyCells:r}=t;if(i===s)return Si;if(At(i))return At(s)?Si:r?o==="asc"?Pt:Lt:Lt;if(At(s))return r?o==="asc"?Lt:Pt:Pt;let n=e.dateFormat,a=(0,kv.default)(i,n),l=(0,kv.default)(s,n);return a.isValid()?l.isValid()?l.isAfter(a)?o==="asc"?Pt:Lt:l.isBefore(a)?o==="asc"?Lt:Pt:Si:Pt:Lt}}var cI="date";var{register:$m,getItem:uI,hasItem:sj}=qt("sorting.compareFunctionFactory"),{register:Qu,getItem:Hv}=qt("sorting.mainSortComparator");function Ju(o){return sj(o)?uI(o):uI(Dv)}$m(nI,rI);$m(lI,aI);$m(cI,hI);$m(Dv,zm);var Si=0,Pt=-1,Lt=1;function Fv(o,e){let t=Hv(e);for(var i=arguments.length,s=new Array(i>2?i-2:0),r=2;r<i;r++)s[r-2]=arguments[r];o.sort(t(...s))}function dI(o,e){return function(t,i){let[,...s]=t,[,...r]=i;return function(a){let l=o[a],c=e[a],u=s[a],g=r[a],p=c.columnSorting;return(p.compareFunctionFactory?p.compareFunctionFactory:Ju(c.type))(l,c,p)(u,g)}(0)}}var Xm="columnSorting",mI=50,fI="append",oj="replace";Qu(Xm,dI);He.getSingleton().register("beforeColumnSort");He.getSingleton().register("afterColumnSort");var In=class extends Ye{static get PLUGIN_KEY(){return Xm}static get PLUGIN_PRIORITY(){return mI}constructor(e){super(e),this.columnStatesManager=null,this.columnMetaCache=null,this.pluginKey=Xm,this.indexesSequenceCache=null}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new Gm(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new mi(t=>{let i=this.hot.toVisualColumn(t);return i===null&&(i=t),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,i)=>this.onAfterGetColHeader(t,i)),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",(t,i)=>this.onAfterOnCellMouseDown(t,i)),this.addHook("afterInit",()=>this.loadOrSortBySettings()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.hot.view&&this.loadOrSortBySettings(),super.enablePlugin())}disablePlugin(){let e=(t,i)=>{let s=Pv(i);Lv(t,i)===!1||s===null||this.updateHeaderClasses(s)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,super.disablePlugin()}sort(e){let t=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),s=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",t,i,s)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Pa),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",t,s?i:t,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Pe(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){let t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){let t=this.hot.countCols();return QA(e)&&e.every(i=>{let{column:s}=i;return s<=t&&s>=0})}saveAllSortSettings(e){let t=this.columnStatesManager.getAllColumnsProperties(),i=s=>{let{column:r,...n}=s;return{column:this.hot.toPhysicalColumn(r),...n}};t.initialConfig=Ge(e,i),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){let e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);let t=e.value,i=s=>{let{column:r,...n}=s;return{column:this.hot.toVisualColumn(r),...n}};return Pe(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=Ge(t.initialConfig,i)),t}getColumnNextConfig(e){let t=this.columnStatesManager.getSortOrderOfColumn(e);if(Pe(t)){let s=Nv(t);return Pe(s)?{column:e,sortOrder:s}:void 0}let i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:Nv()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fI,i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),s=i!==-1,r=this.getSortConfig(),n=this.getColumnNextConfig(e);if(s){if(nt(n))return[...r.slice(0,i),...r.slice(i+1)];if(t===fI)return[...r.slice(0,i),...r.slice(i+1),n];if(t===oj)return[...r.slice(0,i),n,...r.slice(i+1)]}return Pe(n)?r.concat(n):r}getPluginColumnConfig(e){if($e(e)){let t=e[this.pluginKey];if($e(t))return t}return{}}getMergedPluginSettings(e){let t=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,e),r=Object.getPrototypeOf(s);return Array.isArray(r.columns)?Object.assign(i,t,this.getPluginColumnConfig(r.columns[e])):ht(r.columns)?Object.assign(i,t,this.getPluginColumnConfig(r.columns(e))):Object.assign(i,t)}getFirstCellSettings(e){let t=this.hot.getCellMeta(0,e),i=Object.create(t);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){let t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}let t=[],i=this.hot.countRows(),s=c=>Ge(e,u=>this.hot.getDataAtCell(c,u.column));for(let c=0;c<this.getNumberOfRowsToSort(i);c+=1)t.push([this.hot.toPhysicalRow(c)].concat(s(c)));let r=Ge(t,c=>c[0]);Fv(t,this.pluginKey,Ge(e,c=>c.sortOrder),Ge(e,c=>this.getFirstCellSettings(c.column)));for(let c=t.length;c<i;c+=1)t.push([c].concat(s(c)));let n=Ge(t,c=>c[0]),a=new Map(Ge(r,(c,u)=>[c,n[u]])),l=Ge(this.hot.rowIndexMapper.getIndexesSequence(),c=>a.has(c)?a.get(c):c);this.hot.rowIndexMapper.setIndexesSequence(l)}loadOrSortBySettings(){let e=this.getAllSavedSortSettings();if($e(e))this.sortBySettings(e);else{let t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}sortBySettings(e){if($e(e)){this.columnStatesManager.updateAllColumnsProperties(e);let t=e.initialConfig;(Array.isArray(t)||$e(t))&&this.sort(t)}else this.hot.render()}onAfterGetColHeader(e,t){let i=Pv(t);if(Lv(e,t)===!1||i===null)return;let s=this.getFirstCellSettings(e)[this.pluginKey],r=s.indicator,n=s.headerAction;this.updateHeaderClasses(i,this.columnStatesManager,e,r,n)}updateHeaderClasses(e){if(je(e,oI(e)),this.enabled!==!1){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];Te(e,sI(...i))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Pe(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}onAfterLoadData(e){e===!0&&this.hot.view&&this.loadOrSortBySettings()}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&e.target.nodeName==="SPAN"}onBeforeOnCellMouseDown(e,t,i,s){Zu(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(s.column=!0)}onAfterOnCellMouseDown(e,t){Zu(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}};var Bv=class{constructor(e,t){this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=t,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){let t=[],i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),we(i,s=>{let r={};this.assignSetting(s,r,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(s,r,"reversedRowCoords",!1),this.assignSetting(s,r,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(s,r,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(s,r,"sourceColumn",s.destinationColumn),this.assignSetting(s,r,"type","sum"),this.assignSetting(s,r,"forceNumeric",!1),this.assignSetting(s,r,"suppressDataTypeErrors",!0),this.assignSetting(s,r,"suppressDataTypeErrors",!0),this.assignSetting(s,r,"customFunction",null),this.assignSetting(s,r,"readOnly",!0),this.assignSetting(s,r,"roundFloat",!1),t.push(r)}),t}assignSetting(e,t,i,s){if(i==="ranges"&&e[i]===void 0){t[i]=s;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(s instanceof Error)throw s;t[i]=s}else i==="destinationRow"&&t.reversedRowCoords?t[i]=this.hot.countRows()-e[i]-1:t[i]=e[i]}resetSetupBeforeStructureAlteration(e,t,i){if(this.settingsType!=="function")return;let s=e.indexOf("row")>-1?"row":"col",r=this.getAllEndpoints();we(r,n=>{s==="row"&&n.destinationRow>=t&&(e==="insert_row"?n.alterRowOffset=i:e==="remove_row"&&(n.alterRowOffset=-1*i)),s==="col"&&n.destinationColumn>=t&&(e==="insert_col"?n.alterColumnOffset=i:e==="remove_col"&&(n.alterColumnOffset=-1*i))}),this.resetAllEndpoints(r,!1)}resetSetupAfterStructureAlteration(e,t,i,s,r){let n=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){let p=()=>(this.hot.removeHook("beforeViewRender",p),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",p);return}let a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,c=this.getAllEndpoints(),u=e.indexOf("move_row")===0,g=t;we(c,p=>{a==="row"&&p.destinationRow>=g&&(p.alterRowOffset=l*i),a==="col"&&p.destinationColumn>=g&&(p.alterColumnOffset=l*i)}),this.resetAllEndpoints(c,!u),u?we(c,p=>{this.extendEndpointRanges(p,g,s[0],s.length),this.recreatePhysicalRanges(p),this.clearOffsetInformation(p)}):we(c,p=>{this.shiftEndpointCoordinates(p,g)}),n&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,i,s){we(e.ranges,r=>{r[1]&&(t>=r[0]&&t<=r[1]?i>r[1]?r[1]+=s:i<r[0]&&(r[0]-=s):i>=r[0]&&i<=r[1]&&(r[1]-=s,t<=r[0]&&(r[0]+=1,r[1]+=1)))})}recreatePhysicalRanges(e){let t=e.ranges,i=[],s=[];we(t,r=>{let n=[];if(r[1])for(let a=r[0];a<=r[1];a++)n.push(this.hot.toPhysicalRow(a));else n.push(this.hot.toPhysicalRow(r[0]));s.push(n)}),we(s,r=>{let n=[];we(r,(a,l)=>{l===0?n.push(a):r[l]!==r[l-1]+1&&(n.push(r[l-1]),i.push(n),n=[],n.push(a)),l===r.length-1&&(n.push(a),i.push(n))})}),e.ranges=i}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,we(e.ranges,i=>{we(i,(s,r)=>{s>=t&&(i[r]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(s=>{let r=s.alterRowOffset||0,n=s.alterColumnOffset||0;return s.destinationRow+r>=this.hot.countRows()||s.destinationColumn+n>=this.hot.countCols()})||(this.cellsToSetCache=[],we(e,s=>{this.resetEndpointValue(s,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],we(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){let t=[];this.cellsToSetCache=[],we(e,(i,s,r)=>{`${i[2]||""}`!=`${i[3]}`&&we(this.getAllEndpoints(),(n,a)=>{this.hot.propToCol(r[s][1])===n.sourceColumn&&t.indexOf(a)===-1&&t.push(a)})}),we(t,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=e.alterRowOffset||0,s=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?i:0)),this.hot.toVisualColumn(e.destinationColumn+(t?s:0)),""])}setEndpointValue(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}let r=this.hot.toVisualRow(e.destinationRow);if(r!==null){let n=this.hot.getCellMeta(r,e.destinationColumn);(t==="init"||n.readOnly!==e.readOnly)&&(n.readOnly=e.readOnly,n.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),i?this.hot.setDataAtCell(s,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([s,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){mt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}},pI=Bv;function qm(o){return o==null||isNaN(o)}var Km="columnSummary",gI=220,ed=class extends Ye{static get PLUGIN_KEY(){return Km}static get PLUGIN_PRIORITY(){return gI}constructor(e){super(e),this.endpoints=null}isEnabled(){return!!this.hot.getSettings()[Km]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Km],this.endpoints=new pI(this,this.settings),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeCreateRow",(t,i,s)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,i,null,s)),this.addHook("beforeCreateCol",(t,i,s)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,i,null,s)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(t,i,s)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,i,null,s)),this.addHook("afterCreateCol",(t,i,s)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,i,null,s)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){return e.onAfterRowMove(...arguments)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break;default:break}}calculateSum(e){let t=0;return ze(e.ranges,i=>{t+=this.getPartialSum(i,e.sourceColumn)}),t}getPartialSum(e,t){let i=0,s=e[1]||e[0],r=null,n=0;do{if(r=this.getCellValue(s,t),r=qm(r)?null:r,r!==null){let a=(`${r}`.split(".")[1]||[]).length||1;a>n&&(n=a)}i+=r||0,s-=1}while(s>=e[0]);return Math.round(i*10**n)/10**n}calculateMinMax(e,t){let i=null;return ze(e.ranges,s=>{let r=this.getPartialMinMax(s,e.sourceColumn,t);if(i===null&&r!==null&&(i=r),r!==null)switch(t){case"min":i=Math.min(i,r);break;case"max":i=Math.max(i,r);break;default:break}}),i===null?"Not enough data":i}getPartialMinMax(e,t,i){let s=null,r=e[1]||e[0],n;do{if(n=this.getCellValue(r,t),n=qm(n)?null:n,s===null)s=n;else if(n!==null)switch(i){case"min":s=Math.min(s,n);break;case"max":s=Math.max(s,n);break;default:break}r-=1}while(r>=e[0]);return s}countEmpty(e,t){let i,s=0,r=e[1]||e[0];do i=this.getCellValue(r,t),i=qm(i)?null:i,i===null&&(s+=1),r-=1;while(r>=e[0]);return s}countEntries(e){let t=0,i=e.ranges;return ze(i,s=>{let r=s[1]===void 0?1:s[1]-s[0]+1,n=this.countEmpty(s,e.sourceColumn);t+=r,t-=n}),t}calculateAverage(e){let t=this.calculateSum(e),i=this.countEntries(e);return t/i}getCellValue(e,t){let i=this.hot.toVisualRow(e),s=this.hot.toVisualColumn(t),r=this.hot.getSourceDataAtCell(e,t),n="";if(i!==null&&s!==null&&(n=this.hot.getCellMeta(i,s).className||""),n.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof r=="string"&&(r=r.replace(/,/,".")),r=parseFloat(r)),isNaN(r)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(st`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return r}onAfterInit(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}onAfterChange(e,t){e&&t!=="ColumnSummary.reset"&&t!=="ColumnSummary.set"&&t!=="loadData"&&this.endpoints.refreshChangedEndpoints(e)}onAfterRowMove(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}};var Vv=class o{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){this.rootDocument=e,this.isRtl=t,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}setPosition(e,t){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${t}px`}setSize(e,t){if(e&&t){let i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${t}px`}}getSize(){return{width:at(this.getInputElement()),height:ft(this.getInputElement())}}resetSize(){let e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){let t=this.getInputElement();t.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){let t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){let e=this.rootDocument.createElement("div"),t=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Te(this.container,o.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Te(e,o.CLASS_EDITOR),Te(t,o.CLASS_INPUT),e.appendChild(t),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${o.CLASS_INPUT}`)}destroy(){let e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}},CI=Vv;var Je="---------";function Wv(){return{name:Je}}function wI(o){return Ge(o,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function td(o){return Ve(o,"htSeparator")}function yI(o){return Ve(o,"htSubmenu")}function id(o){return Ve(o,"htDisabled")}function sd(o){return Ve(o,"htSelectionDisabled")}function Di(o){let e=o.getSelected();return!e||e[0]<0?null:e}function rj(o,e){return o.indexOf(e)!==-1?o:`${o.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function nj(o,e){return o.indexOf(e)!==-1?o:`${o.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ar(o,e){let t={};return we(o,i=>{i.forAll((s,r)=>{s>=0&&r>=0&&(t[s]||(t[s]=[]),t[s][r]=e(s,r))})}),t}function Zs(o,e,t,i,s){we(o,r=>{r.forAll((n,a)=>{n>=0&&a>=0&&aj(n,a,e,t,i,s)})})}function aj(o,e,t,i,s,r){let n=s(o,e),a=i;n.className&&(t==="vertical"?a=rj(n.className,i):a=nj(n.className,i)),r(o,e,"className",a)}function Xi(o,e){let t=!1;return Array.isArray(o)&&we(o,i=>(i.forAll((s,r)=>{if(s>=0&&r>=0&&e(s,r))return t=!0,!1}),t)),t}function Cs(o){return`<span class="selected">${String.fromCharCode(10003)}</span>${o}`}function vI(o,e){return!o.hidden||!(typeof o.hidden=="function"&&o.hidden.call(e))}function bI(o,e){let t=o.slice(0);for(let i=0;i<t.length&&t[i].name===e;)t.shift();return t}function lj(o,e){let t=o.slice(0);return t.reverse(),t=bI(t,e),t.reverse(),t}function hj(o){let e=[];return we(o,(t,i)=>{i>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function xI(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Je,t=o.slice(0);return t=bI(t,e),t=lj(t,e),t=hj(t),t}var cj=250,uj=250,Zm=class{constructor(e){this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},uj)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:cj;this.showDebounced=mh(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}};et(Zm,Nt);var SI=Zm;var ep="comments",TI=60,Qm=new WeakMap,Qs="comment",tl="value",EI="style",Jm="readOnly",od=class extends Ye{static get PLUGIN_KEY(){return ep}static get PLUGIN_PRIORITY(){return TI}constructor(e){super(e),this.editor=null,this.displaySwitch=null,this.eventManager=null,this.range={},this.preventEditorAutoSwitch=!1,Qm.set(this,{tempEditorDimensions:{},cellBelowCursor:null})}isEnabled(){return!!this.hot.getSettings()[ep]}enablePlugin(){this.enabled||(this.editor||(this.editor=new CI(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new tt(this)),this.displaySwitch||(this.displaySwitch=new SI(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,t,i,s,r,n)=>this.onAfterRenderer(e,n)),this.addHook("afterScrollHorizontally",()=>this.hide()),this.addHook("afterScrollVertically",()=>this.hide()),this.addHook("afterBeginEditing",()=>this.hide()),this.displaySwitch.addLocalHook("hide",()=>this.hide()),this.displaySwitch.addLocalHook("show",(e,t)=>this.showAtCell(e,t)),this.registerListeners(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin(),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}disablePlugin(){super.disablePlugin()}registerListeners(){let{rootDocument:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",t=>this.onMouseOver(t)),this.eventManager.addEventListener(e,"mousedown",t=>this.onMouseDown(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",()=>this.onEditorBlur()),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",t=>this.onEditorMouseDown(t)),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",t=>this.onEditorMouseUp(t))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){let t=os(e.target,"TD","TBODY");return!!(t&&Ve(t,"htCommentCell")&&os(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.editor.getInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');let t=this.editor.getValue(),i="";e!=null?i=e:t!=null&&(i=t);let s=this.range.from.row,r=this.range.from.col;this.updateCommentMeta(s,r,{[tl]:i}),this.hot.render()}setCommentAtCell(e,t,i){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Qs),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(i)}getComment(){let e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,tl)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,tl)}show(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');let{from:{row:e,col:t}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||t<0||t>this.hot.countSourceCols()-1)return!1;let i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(i[Qs]?i[Qs][tl]:""),this.editor.show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){this.editor.hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!this.editor.isVisible()))return;let{rowIndexMapper:s,columnIndexMapper:r}=this.hot,{row:n,col:a}=this.range.from,l=s.getRenderableFromVisualIndex(n),c=r.getRenderableFromVisualIndex(a),u=l===null;this.editor.setPosition(0,0),l===null&&(l=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(n,-1))),c===null&&(c=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1)));let g=l===null,p=c===null;l=(e=l)!==null&&e!==void 0?e:0,c=(t=c)!==null&&t!==void 0?t:0;let{rootWindow:C,view:{_wt:y}}=this.hot,{wtTable:S}=y,O=y.getCell({row:l,col:c},!0),M=this.getCommentMeta(n,a,EI);M?this.editor.setSize(M.width,M.height):this.editor.resetSize();let _=p?0:S.getStretchedColumnWidth(c),N=u&&!g?ft(O):0,{left:E,top:k,width:ie,height:$}=O.getBoundingClientRect(),{width:H,height:Q}=this.editor.getSize(),{innerWidth:Y,innerHeight:P}=this.hot.rootWindow,j=this.hot.rootDocument.documentElement,A=E+C.scrollX+_,v=k+C.scrollY+N;this.hot.isRtl()&&(A-=H+_),this.hot.isLtr()&&E+ie+H>Y?A=E+C.scrollX-H-1:this.hot.isRtl()&&A<-(j.scrollWidth-j.clientWidth)&&(A=E+C.scrollX+_+1),k+Q>P&&(v-=Q-$+1),this.editor.setPosition(A,v),this.editor.setReadOnlyState(this.getCommentMeta(n,a,Jm))}checkSelectionCommentsConsistency(){let e=this.hot.getSelectedRangeLast();if(!e)return!1;let t=!1,i=e.getTopStartCorner();return this.getCommentMeta(i.row,i.col,tl)&&(t=!0),t}updateCommentMeta(e,t,i){let s=this.hot.getCellMeta(e,t)[Qs],r;s?(r=Xt(s),cr(r,i)):r=i,this.hot.setCellMeta(e,t,Qs,r)}getCommentMeta(e,t,i){let s=this.hot.getCellMeta(e,t);if(s[Qs])return s[Qs][i]}onMouseDown(e){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(e)){let t=os(e.target,"TD","TBODY"),i=null;t&&(i=this.hot.getCoords(t)),(!t||this.range.from&&i&&(this.range.from.row!==i.row||this.range.from.col!==i.col))&&this.hide()}}onMouseOver(e){let t=Qm.get(this),{rootDocument:i}=this.hot;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Ve(e.target,"wtBorder")||t.cellBelowCursor===e.target||!this.editor))if(t.cellBelowCursor=i.elementFromPoint(e.clientX,e.clientY),this.targetIsCellWithComment(e)){let s=this.hot._createCellRange(this.hot.getCoords(e.target));this.displaySwitch.show(s)}else rs(e.target,i)&&!this.targetIsCommentTextArea(e)&&this.displaySwitch.hide()}onMouseUp(){this.preventEditorAutoSwitch=!1}onAfterRenderer(e,t){t[Qs]&&t[Qs][tl]&&Te(e,t.commentedCellClassName)}onEditorBlur(){this.setComment()}onEditorMouseDown(e){let t=Qm.get(this);t.tempEditorDimensions={width:at(e.target),height:ft(e.target)}}onEditorMouseUp(e){let t=Qm.get(this),i=at(e.target),s=ft(e.target);(i!==t.tempEditorDimensions.width+1||s!==t.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[EI]:{width:i,height:s}})}onContextMenuAddComment(){let e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:e.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}onContextMenuRemoveComment(){let e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((t,i)=>{t>=0&&i>=0&&this.removeCommentAtCell(t,i,!1)}),this.hot.render()}onContextMenuMakeReadOnly(){let e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((t,i)=>{if(t>=0&&i>=0){let s=!!this.getCommentMeta(t,i,Jm);this.updateCommentMeta(t,i,{[Jm]:!s})}})}addToContextMenu(e){let t=()=>this.hot.rowIndexMapper.getRenderableIndexesLength()>0&&this.hot.columnIndexMapper.getRenderableIndexesLength()>0;e.items.push({name:"---------"},{key:"commentsAddEdit",name:()=>this.checkSelectionCommentsConsistency()?this.hot.getTranslatedPhrase(Mc):this.hot.getTranslatedPhrase(Rc),callback:()=>this.onContextMenuAddComment(),disabled:()=>t()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner()):!0},{key:"commentsRemove",name(){return this.getTranslatedPhrase(Oc)},callback:()=>this.onContextMenuRemoveComment(),disabled:()=>t()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner()):!0},{key:"commentsReadOnly",name(){let i=this.getTranslatedPhrase(Ac);return Xi(this.getSelectedRangeLast(),(r,n)=>{let a=this.getCellMeta(r,n)[Qs];if(a&&(a=a[Jm]),a)return!0})&&(i=Cs(i)),i},callback:()=>this.onContextMenuMakeReadOnly(),disabled:()=>t()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner())||!this.checkSelectionCommentsConsistency():!0})}getDisplayDelaySetting(){let e=this.hot.getSettings()[ep];if($e(e))return e.displayDelay}destroy(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),super.destroy()}};var fj=rr(),mj=Zl(),pj=eh(),gj=CC(),Cj=OI(),wj=wC(),yj=[].unshift(0)!==1,vj=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(o){return o instanceof TypeError}},bj=yj||!vj();fj({target:"Array",proto:!0,arity:1,forced:bj},{unshift:function(e){var t=mj(this),i=pj(t),s=arguments.length;if(s){wj(i+s);for(var r=i;r--;){var n=r+s;r in t?t[n]=t[r]:Cj(t,n)}for(var a=0;a<s;a++)t[a]=arguments[a]}return gj(t,i+s)}});var Uv=class{constructor(e){this.hot=e,this.commands={},this.commonCallback=null}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];let r=e.split(":"),n=r[0],a=r.length===2?r[1]:null,l=this.commands[n];if(!l)throw new Error(`Menu command '${n}' not exists.`);if(a&&l.submenu&&(l=xj(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||St(l,"submenu"))return;let c=[];typeof l.callback=="function"&&c.push(l.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),i.unshift(r.join(":")),we(c,u=>u.apply(this.hot,i))}};function xj(o,e){let t;return we(e,i=>{let s=i.key?i.key.split(":"):null;if(Array.isArray(s)&&s[1]===o)return t=i,!1}),t}var tp=Uv;var Ei="alignment";function Yv(){return{key:Ei,name(){return this.getTranslatedPhrase(Ic)},disabled(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Ei}:left`,name(){let o=this.getTranslatedPhrase(_c);return Xi(this.getSelectedRange(),(t,i)=>{let s=this.getCellMeta(t,i).className;if(s&&s.indexOf("htLeft")!==-1)return!0})&&(o=Cs(o)),o},callback(){let o=this.getSelectedRange(),e=Ar(o,(s,r)=>this.getCellMeta(s,r).className),t="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,o,t,i),Zs(o,t,i,(s,r)=>this.getCellMeta(s,r),(s,r,n,a)=>this.setCellMeta(s,r,n,a)),this.render()},disabled:!1},{key:`${Ei}:center`,name(){let o=this.getTranslatedPhrase(Nc);return Xi(this.getSelectedRange(),(t,i)=>{let s=this.getCellMeta(t,i).className;if(s&&s.indexOf("htCenter")!==-1)return!0})&&(o=Cs(o)),o},callback(){let o=this.getSelectedRange(),e=Ar(o,(s,r)=>this.getCellMeta(s,r).className),t="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,o,t,i),Zs(o,t,i,(s,r)=>this.getCellMeta(s,r),(s,r,n,a)=>this.setCellMeta(s,r,n,a)),this.render()},disabled:!1},{key:`${Ei}:right`,name(){let o=this.getTranslatedPhrase(Pc);return Xi(this.getSelectedRange(),(t,i)=>{let s=this.getCellMeta(t,i).className;if(s&&s.indexOf("htRight")!==-1)return!0})&&(o=Cs(o)),o},callback(){let o=this.getSelectedRange(),e=Ar(o,(s,r)=>this.getCellMeta(s,r).className),t="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,o,t,i),Zs(o,t,i,(s,r)=>this.getCellMeta(s,r),(s,r,n,a)=>this.setCellMeta(s,r,n,a)),this.render()},disabled:!1},{key:`${Ei}:justify`,name(){let o=this.getTranslatedPhrase(Lc);return Xi(this.getSelectedRange(),(t,i)=>{let s=this.getCellMeta(t,i).className;if(s&&s.indexOf("htJustify")!==-1)return!0})&&(o=Cs(o)),o},callback(){let o=this.getSelectedRange(),e=Ar(o,(s,r)=>this.getCellMeta(s,r).className),t="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,o,t,i),Zs(o,t,i,(s,r)=>this.getCellMeta(s,r),(s,r,n,a)=>this.setCellMeta(s,r,n,a)),this.render()},disabled:!1},{name:Je},{key:`${Ei}:top`,name(){let o=this.getTranslatedPhrase(Dc);return Xi(this.getSelectedRange(),(t,i)=>{let s=this.getCellMeta(t,i).className;if(s&&s.indexOf("htTop")!==-1)return!0})&&(o=Cs(o)),o},callback(){let o=this.getSelectedRange(),e=Ar(o,(s,r)=>this.getCellMeta(s,r).className),t="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,o,t,i),Zs(o,t,i,(s,r)=>this.getCellMeta(s,r),(s,r,n,a)=>this.setCellMeta(s,r,n,a)),this.render()},disabled:!1},{key:`${Ei}:middle`,name(){let o=this.getTranslatedPhrase(kc);return Xi(this.getSelectedRange(),(t,i)=>{let s=this.getCellMeta(t,i).className;if(s&&s.indexOf("htMiddle")!==-1)return!0})&&(o=Cs(o)),o},callback(){let o=this.getSelectedRange(),e=Ar(o,(s,r)=>this.getCellMeta(s,r).className),t="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,o,t,i),Zs(o,t,i,(s,r)=>this.getCellMeta(s,r),(s,r,n,a)=>this.setCellMeta(s,r,n,a)),this.render()},disabled:!1},{key:`${Ei}:bottom`,name(){let o=this.getTranslatedPhrase(Hc);return Xi(this.getSelectedRange(),(t,i)=>{let s=this.getCellMeta(t,i).className;if(s&&s.indexOf("htBottom")!==-1)return!0})&&(o=Cs(o)),o},callback(){let o=this.getSelectedRange(),e=Ar(o,(s,r)=>this.getCellMeta(s,r).className),t="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,o,t,i),Zs(o,t,i,(s,r)=>this.getCellMeta(s,r),(s,r,n,a)=>this.setCellMeta(s,r,n,a)),this.render()},disabled:!1}]}}}var _n="clear_column";function jv(){return{key:_n,name(){return this.getTranslatedPhrase(gc)},callback(o,e){let t=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){return Di(this)?!this.selection.isSelectedByColumnHeader():!0}}}var ko="col_left";function Gv(){return{key:ko,name(){return this.getTranslatedPhrase(hc)},callback(){let o=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,o.col,1,"ContextMenu.columnLeft")},disabled(){return!this.isColumnModificationAllowed()||!Di(this)?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}var Ho="col_right";function zv(){return{key:Ho,name(){return this.getTranslatedPhrase(cc)},callback(){let o=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,o.col,1,"ContextMenu.columnRight")},disabled(){return!this.isColumnModificationAllowed()||!Di(this)?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}var Fo="make_read_only";function $v(){return{key:Fo,name(){let o=this.getTranslatedPhrase(pc);return Xi(this.getSelectedRange(),(t,i)=>this.getCellMeta(t,i).readOnly)&&(o=Cs(o)),o},callback(){let o=this.getSelectedRange(),e=Xi(o,(t,i)=>this.getCellMeta(t,i).readOnly);we(o,t=>{t.forAll((i,s)=>{i>=0&&s>=0&&this.setCellMeta(i,s,"readOnly",!e)})}),this.render()},disabled(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var Nn="redo";function Xv(){return{key:Nn,name(){return this.getTranslatedPhrase(mc)},callback(){this.redo()},hidden(){let o=this.getPlugin("undoRedo");return!o||!o.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}var Bo="remove_col";function qv(){return{key:Bo,name(){let o=this.getSelected(),e=0;if(o)if(o.length>1)e=1;else{let[,t,,i]=o[0];t-i!==0&&(e=1)}return this.getTranslatedPhrase(dc,e)},callback(){this.alter("remove_col",aA(this.getSelected()),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed()||!Di(this))return!0;let e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}var Pn="remove_row";function Kv(){return{key:Pn,name(){let o=this.getSelected(),e=0;if(o)if(o.length>1)e=1;else{let[t,,i]=o[0];t-i!==0&&(e=1)}return this.getTranslatedPhrase(uc,e)},callback(){this.alter("remove_row",lA(this.getSelected()),1,"ContextMenu.removeRow")},disabled(){if(!Di(this))return!0;let e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}var Ln="row_above";function Zv(){return{key:Ln,name(){return this.getTranslatedPhrase(ac)},callback(){let o=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",o.row,1,"ContextMenu.rowAbove")},disabled(){return Di(this)?this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden(){return!this.getSettings().allowInsertRow}}}var Dn="row_below";function Qv(){return{key:Dn,name(){return this.getTranslatedPhrase(lc)},callback(){let o=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",o.row,1,"ContextMenu.rowBelow")},disabled(){return Di(this)?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden(){return!this.getSettings().allowInsertRow}}}var Ir="no_items";function Jv(){return{key:Ir,name(){return this.getTranslatedPhrase(nc)},disabled:!0,isCommand:!1}}var kn="undo";function eb(){return{key:kn,name(){return this.getTranslatedPhrase(fc)},callback(){this.undo()},hidden(){let o=this.getPlugin("undoRedo");return!o||!o.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}var AI=[Ln,Dn,ko,Ho,_n,Pn,Bo,kn,Nn,Fo,Ei,Je,Ir],Sj={[Je]:Wv,[Ir]:Jv,[Ln]:Zv,[Dn]:Qv,[ko]:Gv,[Ho]:zv,[_n]:jv,[Pn]:Kv,[Bo]:qv,[kn]:eb,[Nn]:Xv,[Fo]:$v,[Ei]:Yv};function ip(){let o={};return ze(Sj,(e,t)=>{o[t]=e()}),o}var tb=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.hot=e,this.predefinedItems=ip(),this.defaultOrderPattern=t}setPredefinedItems(e){let t={};this.defaultOrderPattern.length=0,ze(e,(i,s)=>{let r="";i.name===Je?(t[Je]=i,r=Je):isNaN(parseInt(s,10))?(i.key=i.key===void 0?s:i.key,t[s]=i,r=i.key):(t[i.key]=i,r=i.key),this.defaultOrderPattern.push(r)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Ej(e,this.defaultOrderPattern,this.predefinedItems)}};function Ej(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=[],s=o;return s&&s.items?s=s.items:Array.isArray(s)||(s=e),$e(s)?ze(s,(r,n)=>{let a=t[typeof r=="string"?r:n];a||(a=r),$e(r)?Ct(a,r):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=n),i.push(a)}):we(s,(r,n)=>{let a=t[r];!a&&AI.indexOf(r)>=0||(a||(a={name:r,key:`${n}`}),$e(r)&&Ct(a,r),a.key===void 0&&(a.key=n),i.push(a))}),i}var sp=tb;var ib=class{constructor(e,t){let i=vo(t),s=As(t),r,n,a,l,c,u;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(r=parseInt(e.top,10),a=parseInt(e.left,10),c=e.height||0,u=e.width||0,n=r,l=a,r+=i,a+=s):this.type==="event"&&(r=parseInt(e.pageY,10),a=parseInt(e.pageX,10),c=e.target.clientHeight,u=e.target.clientWidth,n=r-i,l=a-s),this.top=r,this.topRelative=n,this.left=a,this.leftRelative=l,this.scrollTop=i,this.scrollLeft=s,this.cellHeight=c,this.cellWidth=u}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}},II=ib;var _I=215,NI="menu",Tj=NI,op=class o{constructor(e,t){this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:_I,container:this.hot.rootDocument.documentElement},this.eventManager=new tt(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=nr(e)}setMenuItems(e){this.menuItems=e}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[e]=t}isSubMenu(){return this.parentMenu!==null}open(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";let t=mh(p=>this.openSubMenu(p),300),i=this.options.minWidth||_I,s=!1,r=zt(this.menuItems,p=>(p.key===Ir&&(s=!0),vI(p,this.hot)));if(r.length<1&&!s)r.push(ip()[Ir]);else if(r.length===0)return;r=xI(r,Je);let n=!1,a={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(p){return Pe(p)&&p<i?i:p},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:(p,C,y,S,O,M)=>this.menuItemRenderer(p,C,y,S,O,M)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:(p,C)=>{this.isAllSubMenusClosed()?t(C.row):this.openSubMenu(C.row)},rowHeights:p=>r[p].name===Je?1:23,afterOnCellContextMenu:p=>{p.preventDefault(),um()&&n&&this.hasSelectedItem()&&this.close(!0)},beforeOnCellMouseUp:p=>{this.hasSelectedItem()&&(n=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(p))},afterOnCellMouseUp:p=>{(!um()||!Ni(p))&&n&&this.hasSelectedItem()&&(fi()||bh()?setTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new Va(this.container,a),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.addHook("afterSelection",function(){return e.onAfterSelection(...arguments)}),this.hotMenu.init(),this.hotMenu.listen();let l=this.hotMenu.getShortcutManager(),c=l.addContext(Tj),g={...{group:NI},runOnlyIf:p=>rn(p.target)===!1||this.container.contains(p.target)===!1};l.setActiveContextName("menu"),c.addShortcuts([{keys:[["Escape"]],callback:()=>{this.keyEvent=!0,this.close(),this.keyEvent=!1}},{keys:[["ArrowDown"]],callback:()=>{let p=this.hotMenu.getSelectedLast();this.keyEvent=!0,p?this.selectNextCell(p[0],p[1]):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["ArrowUp"]],callback:()=>{let p=this.hotMenu.getSelectedLast();this.keyEvent=!0,p?this.selectPrevCell(p[0],p[1]):this.selectLastCell(),this.keyEvent=!1}},{keys:[["ArrowRight"]],callback:()=>{let p=this.hotMenu.getSelectedLast();if(this.keyEvent=!0,p){let C=this.openSubMenu(p[0]);C&&C.selectFirstCell()}this.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:()=>{let p=this.hotMenu.getSelectedLast();this.keyEvent=!0,p&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen()),this.keyEvent=!1}},{keys:[["Enter"]],callback:p=>{let C=this.hotMenu.getSelectedLast();this.keyEvent=!0,this.hotMenu.getSourceDataAtRow(C[0]).submenu||(this.executeCommand(p),this.close(!0)),this.keyEvent=!1}},{keys:[["PageUp"]],callback:()=>{let p=this.hotMenu.getSelectedLast();this.keyEvent=!0,p?this.hotMenu.selection.transformStart(-this.hotMenu.countVisibleRows(),0):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["PageDown"]],callback:()=>{let p=this.hotMenu.getSelectedLast();this.keyEvent=!0,p?this.hotMenu.selection.transformStart(this.hotMenu.countVisibleRows(),0):this.selectLastCell(),this.keyEvent=!1}}],g),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}openSubMenu(e){if(!this.hotMenu)return!1;let t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!yI(t))return!1;let i=this.hotMenu.getSourceDataAtRow(e),s=new o(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return s.setMenuItems(i.submenu.items),s.open(),s.setPosition(t.getBoundingClientRect()),this.hotSubMenus[i.key]=s,s}closeSubMenu(e){let t=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[t.key];i&&(i.destroy(),delete this.hotSubMenus[t.key])}closeAllSubMenus(){we(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}destroy(){let e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;let t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;let i=this.hot.getSelectedRange(),s=i?wI(i):[];this.runLocalHooks("executeCommand",t.key,s,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,s,e)}isCommandPassive(e){let{isCommand:t,name:i,disabled:s,submenu:r}=e,n=s===!0||typeof s=="function"&&s.call(this.hot)===!0;return t===!1||i===Je||n===!0||r}setPosition(e){let t=new II(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(t.fitsBelow(this.container)?this.setPositionBelowCursor(t):t.fitsAbove(this.container)?this.setPositionAboveCursor(t):this.setPositionBelowCursor(t),this.hot.isLtr()?this.setHorizontalPositionForLtr(t):this.setHorizontalPositionForRtl(t)):(this.setPositionBelowCursor(t),this.setPositionOnRightOfCursor(t))}setHorizontalPositionForRtl(e){e.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(e):this.setPositionOnRightOfCursor(e)}setHorizontalPositionForLtr(e){e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)}setPositionAboveCursor(e){let t=this.offset.above+e.top-this.container.offsetHeight;this.isSubMenu()&&(t=e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top=`${t}px`}setPositionBelowCursor(e){let t=this.offset.below+e.top+1;this.isSubMenu()&&(t=e.top-1),this.container.style.top=`${t}px`}setPositionOnRightOfCursor(e){let t=e.left;if(this.isSubMenu()){let{right:i}=this.parentMenu.container.getBoundingClientRect();t+=e.cellWidth+i-(e.left+e.cellWidth)}else t+=this.offset.right;this.container.style.left=`${t}px`}setPositionOnLeftOfCursor(e){let t=this.offset.left+e.left-this.container.offsetWidth;if(this.isSubMenu()){let{left:i}=this.parentMenu.container.getBoundingClientRect();t-=e.left-i}this.container.style.left=`${t}px`}selectFirstCell(){let e=this.hotMenu.getCell(0,0);td(e)||id(e)||sd(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}selectLastCell(){let e=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(e,0);td(t)||id(t)||sd(t)?this.selectPrevCell(e,0):(this.hotMenu.selectCell(e,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(e,0,!0,!1))}selectNextCell(e,t){let i=e+1,s=i<this.hotMenu.countRows()?this.hotMenu.getCell(i,t):null;s&&(td(s)||id(s)||sd(s)?this.selectNextCell(i,t):this.hotMenu.selectCell(i,t))}selectPrevCell(e,t){let i=e-1,s=i>=0?this.hotMenu.getCell(i,t):null;s&&(td(s)||id(s)||sd(s)?this.selectPrevCell(i,t):this.hotMenu.selectCell(i,t))}menuItemRenderer(e,t,i,s,r,n){let a=e.getSourceDataAtRow(i),l=this.hot.rootDocument.createElement("div"),c=y=>St(y,"submenu"),u=y=>new RegExp(Je,"i").test(y.name),g=y=>y.disabled===!0||typeof y.disabled=="function"&&y.disabled.call(this.hot)===!0,p=y=>y.disableSelection,C=n;typeof C=="function"&&(C=C.call(this.hot)),li(t),Te(l,"htItemWrapper"),t.appendChild(l),u(a)?Te(t,"htSeparator"):typeof a.renderer=="function"?(Te(t,"htCustomMenuRenderer"),t.appendChild(a.renderer(e,l,i,s,r,C))):Yi(l,C),g(a)?(Te(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell())):p(a)?(Te(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell())):c(a)?(Te(t,"htSubmenu"),p(a)?this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell()):this.eventManager.addEventListener(t,"mouseenter",()=>e.selectCell(i,s,void 0,void 0,!1,!1))):(je(t,["htSubmenu","htDisabled"]),p(a)?this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell()):this.eventManager.addEventListener(t,"mouseenter",()=>e.selectCell(i,s,void 0,void 0,!1,!1)))}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=this.options.container.ownerDocument,i=e,s;return i&&(ht(i)&&(i=i.call(this.hot),i===null||nt(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,s=t.querySelector(`.${this.options.className}.${i}`)),s||(s=t.createElement("div"),Te(s,`htMenu ${this.options.className}`),i&&Te(s,i),this.options.container.appendChild(s)),s}blockMainTableCallbacks(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}releaseMainTableCallbacks(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}onAfterInit(){let{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,i=e.hider.style,s=e.holder.style,r=parseInt(i.width,10),n=pt(t,(a,l)=>a+(l.name===Je?1:26),0);s.width=`${r+3}px`,s.height=`${n+3}px`,i.height=s.height}onAfterSelection(e,t,i,s,r){this.keyEvent===!1&&(r.value=!0)}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!rs(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!rs(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ve(e.target,"htCore")&&rs(e.target,this.hotMenu.rootElement)&&e.preventDefault()}};et(op,Nt);var il=op;var rd="contextMenu",PI=70;He.getSingleton().register("afterContextMenuDefaultOptions");He.getSingleton().register("beforeContextMenuShow");He.getSingleton().register("afterContextMenuShow");He.getSingleton().register("afterContextMenuHide");He.getSingleton().register("afterContextMenuExecute");var sl=class o extends Ye{static get PLUGIN_KEY(){return rd}static get PLUGIN_PRIORITY(){return PI}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Ln,Dn,Je,ko,Ho,Je,Pn,Bo,Je,kn,Nn,Je,Fo,Je,Ei]}constructor(e){super(e),this.eventManager=new tt(this),this.commandExecutor=new tp(this.hot),this.itemsFactory=null,this.menu=null}isEnabled(){return!!this.hot.getSettings()[rd]}enablePlugin(){var e=this;if(this.enabled)return;let t=this.hot.getSettings()[rd];typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new il(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return e.executeCommand.call(e,...s)}),this.addHook("afterOnCellContextMenu",i=>this.onAfterOnCellContextMenu(i)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),super.disablePlugin()}open(e){if(!this.menu||(this.prepareMenuItems(),this.menu.open(),!this.menu.isOpened()))return;let t=0,i=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){let{frameElement:s}=this.hot.rootWindow,{top:r,left:n}=s.getBoundingClientRect();t=r-vo(e.view),i=n-As(e.view)}else t=-1*vo(this.menu.hotMenu.rootWindow),i=-1*As(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(e.pageY,10)+t,left:parseInt(e.pageX,10)+i})}close(){this.menu&&(this.menu.close(),this.itemsFactory=null)}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new sp(this.hot,o.DEFAULT_ITEMS);let e=this.hot.getSettings()[rd],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);let i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),we(i,s=>this.commandExecutor.registerCommand(s.key,s))}onAfterOnCellContextMenu(e){let t=this.hot.getSettings(),i=t.rowHeaders,s=t.colHeaders;function r(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}let n=e.target;this.close(),!Ve(n,"handsontableInput")&&(e.preventDefault(),e.stopPropagation(),!(!(i||s)&&!r(n)&&!(Ve(n,"current")&&Ve(n,"wtBorder")))&&this.open(e))}onMenuBeforeOpen(){this.hot.runHooks("beforeContextMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterContextMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}};sl.SEPARATOR={name:Je};function sb(o){return{key:"copy",name(){return this.getTranslatedPhrase(Cc)},callback(){o.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1}}function ob(o){return{key:"copy_column_headers_only",name(){let e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(vc,t)},callback(){o.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1}}function rb(o){return{key:"copy_with_column_group_headers",name(){let e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(yc,t)},callback(){o.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1}}function nb(o){return{key:"copy_with_column_headers",name(){let e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(wc,t)},callback(){o.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1}}function ab(o){return{key:"cut",name(){return this.getTranslatedPhrase(bc)},callback(){o.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1}}var nd=class{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}};var ad=class{constructor(){this.clipboardData=new nd}};var ld=class{constructor(e){this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new tt(this),this.listenersCount=new WeakSet,this.container=e}useSecondaryElement(){let e=Mj(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),LI(this.eventManager,e,this)),this.mainElement=e}setFocusableElement(e){this.listenersCount.has(e)||(this.listenersCount.add(e),LI(this.eventManager,e,this)),this.mainElement=e}getFocusableElement(){return this.mainElement}focus(){this.mainElement.value=" ",fi()||QC(this.mainElement)}};et(ld,Nt);var rp=new WeakMap;function DI(o){let e=new ld(o),t=rp.get(o);return t=isNaN(t)?0:t,rp.set(o,t+1),e}function Rj(o){o.eventManager.clear()}var lb=(o,e)=>t=>e.runLocalHooks(o,t);function LI(o,e,t){o.addEventListener(e,"copy",lb("copy",t)),o.addEventListener(e,"cut",lb("cut",t)),o.addEventListener(e,"paste",lb("paste",t))}var np=new WeakMap;function Mj(o){let e=np.get(o);if(e)return e.parentElement||o.appendChild(e),e;let i=(o.defaultView?o:o.ownerDocument).createElement("textarea");return np.set(o,i),i.setAttribute("data-hot-input",""),i.className="HandsontableCopyPaste",i.tabIndex=-1,i.autocomplete="off",i.wrap="hard",i.value=" ",o.appendChild(i),i}function hb(o){if(!(o instanceof ld))return;let e=rp.get(o.container);if(e=isNaN(e)?0:e,e>0&&(e-=1),Rj(o),e<=0){e=0;let t=np.get(o.container);t&&t.parentNode&&(t.parentNode.removeChild(t),np.delete(o.container)),o.mainElement=null}rp.set(o.container,e)}function kI(o,e){FI(o,e),e.add(o)}function ol(o,e,t){FI(o,e),e.set(o,t)}function FI(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ap(o,e,t){if(!e.has(o))throw new TypeError("attempted to get private field on non-instance");return t}function Oi(o,e){var t=BI(o,e,"get");return Oj(o,t)}function Oj(o,e){return e.get?e.get.call(o):e.value}function rl(o,e,t){var i=BI(o,e,"set");return Aj(o,i,t),t}function BI(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function Aj(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var _r=new WeakMap,cb=new WeakMap,hd=new WeakMap,db=new WeakMap,fb=new WeakMap,cd=new WeakMap,lp=new WeakSet,HI=new WeakSet,hp=class{constructor(e){let{countRows:t,countColumns:i,rowsLimit:s,columnsLimit:r,countColumnHeaders:n}=e;kI(this,HI),kI(this,lp),ol(this,_r,{writable:!0,value:void 0}),ol(this,cb,{writable:!0,value:void 0}),ol(this,hd,{writable:!0,value:void 0}),ol(this,db,{writable:!0,value:void 0}),ol(this,fb,{writable:!0,value:void 0}),ol(this,cd,{writable:!0,value:void 0}),rl(this,cb,t),rl(this,hd,i),rl(this,db,s),rl(this,fb,r),rl(this,cd,n)}setSelectedRange(e){rl(this,_r,e)}getCellsRange(){if(Oi(this,cb).call(this)===0||Oi(this,hd).call(this)===0)return null;let{row:e,col:t}=Oi(this,_r).getTopStartCorner(),{row:i,col:s}=Oi(this,_r).getBottomEndCorner(),r=ap(this,HI,Ij).call(this,e,i),n=ap(this,lp,ub).call(this,t,s);return{isRangeTrimmed:i!==r||s!==n,startRow:e,startCol:t,endRow:r,endCol:n}}getMostBottomColumnHeadersRange(){if(Oi(this,hd).call(this)===0||Oi(this,cd).call(this)===0)return null;let{col:e}=Oi(this,_r).getTopStartCorner(),{col:t}=Oi(this,_r).getBottomEndCorner(),i=ap(this,lp,ub).call(this,e,t);return{isRangeTrimmed:t!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(Oi(this,hd).call(this)===0||Oi(this,cd).call(this)===0)return null;let{col:e}=Oi(this,_r).getTopStartCorner(),{col:t}=Oi(this,_r).getBottomEndCorner(),i=ap(this,lp,ub).call(this,e,t);return{isRangeTrimmed:t!==i,startRow:-Oi(this,cd).call(this),startCol:e,endRow:-1,endCol:i}}};function ub(o,e){return Math.min(e,Math.max(o+Oi(this,fb).call(this)-1,o))}function Ij(o,e){return Math.min(e,Math.max(o+Oi(this,db).call(this)-1,o))}function mb(o){let e=[],t=[];return we(o,i=>{let s=Math.min(i.startRow,i.endRow),r=Math.max(i.startRow,i.endRow);ke(s,r,l=>{e.indexOf(l)===-1&&e.push(l)});let n=Math.min(i.startCol,i.endCol),a=Math.max(i.startCol,i.endCol);ke(n,a,l=>{t.indexOf(l)===-1&&t.push(l)})}),{rows:e,columns:t}}function _j(o,e){UI(o,e),e.add(o)}function Hn(o,e,t){UI(o,e),e.set(o,t)}function UI(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nl(o,e,t){return e=Nj(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Nj(o){var e=Pj(o,"string");return typeof e=="symbol"?e:String(e)}function Pj(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}function Lj(o,e,t){if(!e.has(o))throw new TypeError("attempted to get private field on non-instance");return t}function qi(o,e){var t=YI(o,e,"get");return Dj(o,t)}function Dj(o,e){return e.get?e.get.call(o):e.value}function Vo(o,e,t){var i=YI(o,e,"set");return kj(o,i,t),t}function YI(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function kj(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}He.getSingleton().register("afterCopyLimit");He.getSingleton().register("modifyCopyableRange");He.getSingleton().register("beforeCut");He.getSingleton().register("afterCut");He.getSingleton().register("beforePaste");He.getSingleton().register("afterPaste");He.getSingleton().register("beforeCopy");He.getSingleton().register("afterCopy");var ud="copyPaste",jI=80,Hj=["fragmentSelection"],VI=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),pb=new WeakMap,gb=new WeakMap,Cb=new WeakMap,al=new WeakMap,cp=new WeakMap,up=new WeakMap,ll=new WeakMap,WI=new WeakSet,dd=class extends Ye{constructor(){super(...arguments),_j(this,WI),nl(this,"columnsLimit",1/0),nl(this,"rowsLimit",1/0),nl(this,"pasteMode","overwrite"),nl(this,"uiContainer",this.hot.rootDocument.body),Hn(this,pb,{writable:!0,value:!1}),Hn(this,gb,{writable:!0,value:!1}),Hn(this,Cb,{writable:!0,value:!1}),Hn(this,al,{writable:!0,value:"cells-only"}),Hn(this,cp,{writable:!0,value:!1}),Hn(this,up,{writable:!0,value:!1}),Hn(this,ll,{writable:!0,value:new hp({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),nl(this,"copyableRanges",[]),nl(this,"focusableElement",void 0)}static get PLUGIN_KEY(){return ud}static get SETTING_KEYS(){return[ud,...Hj]}static get PLUGIN_PRIORITY(){return jI}isEnabled(){return!!this.hot.getSettings()[ud]}enablePlugin(){if(this.enabled)return;let{[ud]:e}=this.hot.getSettings();if(typeof e=="object"){var t,i;this.pasteMode=(t=e.pasteMode)!==null&&t!==void 0?t:this.pasteMode,this.rowsLimit=isNaN(e.rowsLimit)?this.rowsLimit:e.rowsLimit,this.columnsLimit=isNaN(e.columnsLimit)?this.columnsLimit:e.columnsLimit,Vo(this,pb,!!e.copyColumnHeaders),Vo(this,gb,!!e.copyColumnGroupHeaders),Vo(this,Cb,!!e.copyColumnHeadersOnly),this.uiContainer=(i=e.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",s=>this.onAfterContextMenuDefaultOptions(s)),this.addHook("afterOnCellMouseUp",()=>this.onAfterOnCellMouseUp()),this.addHook("afterSelectionEnd",()=>this.onAfterSelectionEnd()),this.addHook("beforeKeyDown",()=>this.onBeforeKeyDown()),this.focusableElement=DI(this.uiContainer),this.focusableElement.addLocalHook("copy",s=>this.onCopy(s)).addLocalHook("cut",s=>this.onCut(s)).addLocalHook("paste",s=>this.onPaste(s)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),super.updatePlugin()}disablePlugin(){this.focusableElement&&hb(this.focusableElement),super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Vo(this,al,e),Vo(this,cp,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Vo(this,up,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}getRangedCopyableData(e){return xr(this.getRangedData(e))}getRangedData(e){let t=[],{rows:i,columns:s}=mb(e);return we(i,r=>{let n=[];we(s,a=>{r<0?n.push(this.hot.getColHeader(a,r)):n.push(this.hot.getCopyableData(r,a))}),t.push(n)}),t}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;let i=new ad;e&&i.clipboardData.setData("text/plain",e),t&&i.clipboardData.setData("text/html",t),this.getOrCreateFocusableElement(),this.onPaste(i)}setCopyableText(){let e=this.hot.getSelectedRangeLast();if(!e)return;qi(this,ll).setSelectedRange(e);let t=new Map([["headers",null],["cells",null]]);qi(this,al)==="column-headers-only"?t.set("headers",qi(this,ll).getMostBottomColumnHeadersRange()):(qi(this,al)==="with-column-headers"?t.set("headers",qi(this,ll).getMostBottomColumnHeadersRange()):qi(this,al)==="with-column-group-headers"&&t.set("headers",qi(this,ll).getAllColumnHeadersRange()),t.set("cells",qi(this,ll).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(s=>s!==null).map(s=>{let{startRow:r,startCol:n,endRow:a,endCol:l}=s;return{startRow:r,startCol:n,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);let i=t.get("cells");if(i!==null&&i.isRangeTrimmed){let{startRow:s,startCol:r,endRow:n,endCol:a}=i;this.hot.runHooks("afterCopyLimit",n-s+1,a-r+1,this.rowsLimit,this.columnsLimit)}}getOrCreateFocusableElement(){var e;let t=(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA;t?this.focusableElement.setFocusableElement(t):this.focusableElement.useSecondaryElement()}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;let i=e.length,s=e[0].length,r=[],{row:n,col:a}=t.getTopStartCorner(),{row:l,col:c}=t.getBottomEndCorner(),u=n,g=a,p=n,C=a;for(;r.length<i||u<=l;){let{skipRowOnPaste:y,visualRow:S}=this.hot.getCellMeta(u,a);if(u=S+1,y===!0)continue;p=S,g=a;let O=[],M=r.length%i;for(;O.length<s||g<=c;){let{skipColumnOnPaste:_,visualCol:N}=this.hot.getCellMeta(n,g);if(g=N+1,_===!0)continue;C=N;let E=O.length%s;O.push(e[M][E])}r.push(O)}return this.hot.populateFromArray(n,a,r,void 0,void 0,"CopyPaste.paste",this.pasteMode),[n,a,p,C]}onCopy(e){if(!this.hot.isListening()&&!qi(this,cp)||this.isEditorOpened())return;this.setCopyableText(),Vo(this,cp,!1);let t=this.getRangedData(this.copyableRanges),i=Lj(this,WI,Fj).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",t,this.copyableRanges,i)){let r=xr(t);if(e&&e.clipboardData){let n=gm(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[VI,n].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.runHooks("afterCopy",t,this.copyableRanges,i)}Vo(this,al,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!qi(this,up)||this.isEditorOpened())return;this.setCopyableText(),Vo(this,up,!1);let t=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",t,this.copyableRanges)){let s=xr(t);if(e&&e.clipboardData){let r=gm(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",s),e.clipboardData.setData("text/html",[VI,r].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",t,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened())return;e&&e.preventDefault&&e.preventDefault();let t;if(e&&typeof e.clipboardData<"u"){let a=ha(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?t=yw(a,this.hot.rootDocument).data:t=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof t=="string"&&(t=Sy(t)),t&&t.length===0||this.hot.runHooks("beforePaste",t,this.copyableRanges)===!1)return;let[i,s,r,n]=this.populateValues(t);this.hot.selectCell(i,s,Math.min(this.hot.countRows()-1,r),Math.min(this.hot.countCols()-1,n)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}onAfterContextMenuDefaultOptions(e){e.items.push({name:"---------"},sb(this)),qi(this,pb)&&e.items.push(nb(this)),qi(this,gb)&&e.items.push(rb(this)),qi(this,Cb)&&e.items.push(ob(this)),e.items.push(ab(this))}onAfterOnCellMouseUp(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}onAfterSelectionEnd(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&qC())&&(this.setCopyableText(),this.focusableElement.focus()))}onBeforeKeyDown(){if(!this.hot.isListening()||this.isEditorOpened())return;let e=this.hot.rootDocument.activeElement,t=this.hot.getActiveEditor();!t||e!==this.focusableElement.getFocusableElement()&&e!==t.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}destroy(){this.focusableElement&&(hb(this.focusableElement),this.focusableElement=null),super.destroy()}};function Fj(o){let{rows:e}=mb(o),t=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)t+=1;return{columnHeadersCount:t}}function wb(o,e){return`border_row${o}col${e}`}function hl(){return{width:1,color:"#000"}}function Js(){return{hide:!0}}function Bj(){return{width:1,color:"#000",cornerVisible:!1}}function dp(o){if(Pe(o.start)||Pe(o.left)){var e;o.start=(e=o.start)!==null&&e!==void 0?e:o.left}if(Pe(o.end)||Pe(o.right)){var t;o.end=(t=o.end)!==null&&t!==void 0?t:o.right}return delete o.left,delete o.right,o}function cl(o){return Pe(o.start)&&(o.left=o.start),Pe(o.end)&&(o.right=o.end),o}function fp(o,e){return{id:wb(o,e),border:Bj(),row:o,col:e,top:Js(),bottom:Js(),start:Js(),end:Js()}}function GI(o,e){return St(e,"border")&&e.border&&(o.border=e.border),St(e,"top")&&Pe(e.top)&&(e.top?($e(e.top)||(e.top=hl()),o.top=e.top):(e.top=Js(),o.top=e.top)),St(e,"bottom")&&Pe(e.bottom)&&(e.bottom?($e(e.bottom)||(e.bottom=hl()),o.bottom=e.bottom):(e.bottom=Js(),o.bottom=e.bottom)),St(e,"start")&&Pe(e.start)&&(e.start?($e(e.start)||(e.start=hl()),o.start=e.start):(e.start=Js(),o.start=e.start)),St(e,"end")&&Pe(e.end)&&(e.end?($e(e.end)||(e.end=hl()),o.end=e.end):(e.end=Js(),o.end=e.end)),o}function ki(o,e){let t=!1;return we(o.getSelectedRange(),i=>{i.forAll((s,r)=>{if(s<0||r<0)return;let n=o.getCellMeta(s,r).borders;if(n)if(e){if(!St(n[e],"hide")||n[e].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function Nr(o){return`<span class="selected">${String.fromCharCode(10003)}</span>${o}`}function zI(o){return o.some(e=>Pe(e.left)||Pe(e.right))}function $I(o){return o.some(e=>Pe(e.start)||Pe(e.end))}var Vj=new Map([["left","start"],["right","end"]]);function XI(o){var e;return(e=Vj.get(o))!==null&&e!==void 0?e:o}function mp(o){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(Wc);return ki(this,"bottom")&&(e=Nr(e)),e},callback(e,t){let i=ki(this,"bottom");o.prepareBorder(t,"bottom",i)}}}function pp(o){let e=o.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(Uc);return ki(this,e)&&(t=Nr(t)),t},callback(t,i){let s=ki(this,e);o.prepareBorder(i,e,s)}}}function gp(o){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Yc)},callback(e,t){o.prepareBorder(t,"noBorders")},disabled(){return!ki(this)}}}function Cp(o){let e=o.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(Vc);return ki(this,e)&&(t=Nr(t)),t},callback(t,i){let s=ki(this,e);o.prepareBorder(i,e,s)}}}function wp(o){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(Bc);return ki(this,"top")&&(e=Nr(e)),e},callback(e,t){let i=ki(this,"top");o.prepareBorder(t,"top",i)}}}function Wj(o,e,t){return e=Uj(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Uj(o){var e=Yj(o,"string");return typeof e=="symbol"?e:String(e)}function Yj(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var fd="customBorders",qI=90,md=class extends Ye{constructor(){super(...arguments),Wj(this,"savedBorders",[])}static get PLUGIN_KEY(){return fd}static get PLUGIN_PRIORITY(){return qI}isEnabled(){return!!this.hot.getSettings()[fd]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.onAfterContextMenuDefaultOptions(e)),this.addHook("init",()=>this.onAfterInit()),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let i=["top","bottom","start","end"],s=null;t&&(this.checkSettingsCohesion([t]),i=Object.keys(t),s=dp(t));let r=No(e),n=br(r);we(e,a=>{let[l,c,u,g]=n(a);for(let p=l;p<=u;p+=1)for(let C=c;C<=g;C+=1)we(i,y=>{this.prepareBorderFromCustomAdded(p,C,s,XI(y))})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;let t=No(e),i=br(t),s=[];return we(e,r=>{let[n,a,l,c]=i(r);for(let u=n;u<=l;u+=1)for(let g=a;g<=c;g+=1)we(this.savedBorders,p=>{p.row===u&&p.col===g&&s.push(cl(p))})}),s}clearBorders(e){e?this.setBorders(e):(we(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);let s=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,s,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:s})}prepareBorderFromCustomAdded(e,t,i,s){let r=this.hot.countRows(),n=this.hot.countCols();if(e>=r||t>=n)return;let a=fp(e,t);i&&(a=GI(a,i),we(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,i),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",cl(a)),this.insertBorderIntoSettings(a,s)}prepareBorderFromCustomAddedRange(e,t){let i=Math.min(e.to.row,this.hot.countRows()-1),s=Math.min(e.to.col,this.hot.countCols()-1);ke(e.from.row,i,r=>{ke(e.from.col,s,n=>{let a=fp(r,n),l=0;r===e.from.row&&St(t,"top")&&(l+=1,a.top=t.top),r===e.to.row&&St(t,"bottom")&&(l+=1,a.bottom=t.bottom),n===e.from.col&&St(t,"start")&&(l+=1,a.start=t.start),n===e.to.col&&St(t,"end")&&(l+=1,a.end=t.end),l>0&&(this.hot.setCellMeta(r,n,"borders",cl(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,t){let i=wb(e,t);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,i,s){let r=this.hot.getCellMeta(e,t).borders;!r||r.border===void 0?r=fp(e,t):r=dp(r),s?(r[i]=Js(),this.countHide(r)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(r,i,s)||this.insertBorderIntoSettings(r),this.hot.setCellMeta(e,t,"borders",cl(r)))):(r[i]=hl(),this.checkCustomSelectionsFromContextMenu(r,i,s)||this.insertBorderIntoSettings(r),this.hot.setCellMeta(e,t,"borders",cl(r)))}prepareBorder(e,t,i){we(e,s=>{let{start:r,end:n}=s;if(r.row===n.row&&r.col===n.col)t==="noBorders"?this.removeAllBorders(r.row,r.col):this.setBorder(r.row,r.col,t,i);else switch(t){case"noBorders":ke(r.col,n.col,a=>{ke(r.row,n.row,l=>{this.removeAllBorders(l,a)})});break;case"top":ke(r.col,n.col,a=>{this.setBorder(r.row,a,t,i)});break;case"bottom":ke(r.col,n.col,a=>{this.setBorder(n.row,a,t,i)});break;case"start":ke(r.row,n.row,a=>{this.setBorder(a,r.col,t,i)});break;case"end":ke(r.row,n.row,a=>{this.setBorder(a,n.col,t,i)});break;default:break}})}createCustomBorders(e){we(e,t=>{let i=dp(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,i):this.prepareBorderFromCustomAdded(t.row,t.col,i)})}countHide(e){let{top:t,bottom:i,start:s,end:r}=e;return pt([t,i,s,r],(a,l)=>{let c=a;return l&&l.hide&&(c+=1),c},0)}clearBordersFromSelectionSettings(e){let t=Ge(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){we(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){we(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){let t=Ge(this.savedBorders,i=>i.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):we(this.savedBorders,(s,r)=>{if(e.id===s.id)return this.savedBorders[r]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,i){let s=!1;return we(this.hot.selection.highlight.customSelections,r=>{if(e.id===r.settings.id)return ze(r.instanceBorders,n=>{n.toggleHiddenClass(t,i)}),s=!0,!1}),s}checkCustomSelections(e,t,i){let s=this.countHide(e),r=!1;return s===4?(this.removeAllBorders(e.row,e.col),r=!0):we(this.hot.selection.highlight.customSelections,n=>{if(e.id===n.settings.id)return n.visualCellRange=t,n.commit(),i&&ze(n.instanceBorders,a=>{a.changeBorderStyle(i,e)}),r=!0,!1}),r}changeBorderSettings(){let e=this.hot.getSettings()[fd];if(Array.isArray(e)){let t=Xt(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){let t=zI(e),i=$I(e);if(t&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}onAfterContextMenuDefaultOptions(e){this.hot.getSettings()[fd]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(Fc)},disabled(){return this.selection.isSelectedByCorner()},submenu:{items:[wp(this),Cp(this),mp(this),pp(this),gp(this)]}})}onAfterInit(){this.changeBorderSettings()}destroy(){super.destroy()}};var yb="dragToScroll",KI=100,pd=class extends Ye{static get PLUGIN_KEY(){return yb}static get PLUGIN_PRIORITY(){return KI}constructor(e){super(e),this.eventManager=new tt(this),this.boundaries=null,this.callback=null,this.listening=!1}isEnabled(){return!!this.hot.getSettings()[yb]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>this.setupListening(e)),this.addHook("afterOnCellCornerMouseDown",e=>this.setupListening(e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let i=0,s=0;t<this.boundaries.top?s=t-this.boundaries.top:t>this.boundaries.bottom&&(s=t-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,s)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){let{rootWindow:e}=this.hot,t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",i=>this.onMouseMove(i)),t=nr(t)}unregisterEvents(){this.eventManager.clear()}setupListening(e){if(Ni(e))return;let t=this.hot.view._wt.wtTable.holder;t!==this.hot.rootWindow&&(this.setBoundaries(t.getBoundingClientRect()),this.setCallback((i,s)=>{i<0?t.scrollLeft-=50:i>0&&(t.scrollLeft+=50),s<0?t.scrollTop-=20:s>0&&(t.scrollTop+=20)}),this.listen())}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}};He.getSingleton().register("afterDropdownMenuDefaultOptions");He.getSingleton().register("beforeDropdownMenuShow");He.getSingleton().register("afterDropdownMenuShow");He.getSingleton().register("afterDropdownMenuHide");He.getSingleton().register("afterDropdownMenuExecute");var yp="dropdownMenu",ZI=230,vb="changeType",ul=class o extends Ye{static get PLUGIN_KEY(){return yp}static get PLUGIN_PRIORITY(){return ZI}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[ko,Ho,Je,Bo,Je,_n,Je,Fo,Je,Ei]}constructor(e){super(e),this.eventManager=new tt(this),this.commandExecutor=new tp(this.hot),this.itemsFactory=null,this.menu=null,this.hot.addHook("afterGetColHeader",(t,i)=>this.onAfterGetColHeader(t,i))}isEnabled(){return this.hot.getSettings()[yp]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new sp(this.hot,o.DEFAULT_ITEMS);let t=this.hot.getSettings()[yp],i={items:this.itemsFactory.getItems(t)};this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);let s=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new il(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",s),this.menu.setMenuItems(s),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return e.executeCommand.call(e,...n)}),we(s,r=>this.commandExecutor.registerCommand(r.key,r))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),super.disablePlugin()}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>this.onTableClick(e))}open(e){this.menu&&(this.menu.open(),e.width&&this.menu.setOffset("left",e.width),this.menu.setPosition(e))}close(){this.menu&&this.menu.close()}executeCommand(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}onTableClick(e){if(e.stopPropagation(),Ve(e.target,vb)&&!this.menu.isOpened()){let t=0,i=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){let{frameElement:r}=this.hot.rootWindow,{top:n,left:a}=r.getBoundingClientRect();t=n,i=a}let s=e.target.getBoundingClientRect();this.open({left:s.left+i,top:s.top+e.target.offsetHeight+3+t,width:s.width,height:s.height})}}onAfterGetColHeader(e,t){let i=t.parentNode;if(!i)return;let s=i.parentNode.childNodes,r=Array.prototype.indexOf.call(s,i);if(e<0||r!==s.length-1)return;let n=t.querySelector(`.${vb}`);if(this.enabled&&n)return;if(!this.enabled){n&&n.parentNode.removeChild(n);return}let a=this.hot.rootDocument.createElement("button");a.className=vb,a.type="button",a.onclick=function(){return!1},t.firstChild.insertBefore(a,t.firstChild.firstChild)}onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}};ul.SEPARATOR={name:Je};var bb=class{constructor(e){this.hot=e,this.options={}}setOptions(e){this.options=e}getData(){let{startRow:e,startCol:t,endRow:i,endCol:s}=this._getDataRange(),r=this.options,n=[];return ke(e,i,a=>{let l=[];!r.exportHiddenRows&&this._isHiddenRow(a)||(ke(t,s,c=>{!r.exportHiddenColumns&&this._isHiddenColumn(c)||l.push(this.hot.getDataAtCell(a,c))}),n.push(l))}),n}getRowHeaders(){let e=[];if(this.options.rowHeaders){let{startRow:t,endRow:i}=this._getDataRange(),s=this.hot.getRowHeader();ke(t,i,r=>{!this.options.exportHiddenRows&&this._isHiddenRow(r)||e.push(s[r])})}return e}getColumnHeaders(){let e=[];if(this.options.columnHeaders){let{startCol:t,endCol:i}=this._getDataRange(),s=this.hot.getColHeader();ke(t,i,r=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(r)||e.push(s[r])})}return e}_getDataRange(){let e=this.hot.countCols()-1,t=this.hot.countRows()-1,[i=0,s=0,r=t,n=e]=this.options.range;return i=Math.max(i,0),s=Math.max(s,0),r=Math.min(r,t),n=Math.min(n,e),{startRow:i,startCol:s,endRow:r,endCol:n}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}},QI=bb;var xb=class o{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=Ft(this.constructor.DEFAULT_OPTIONS),i=new Date;return t=Ct(Ft(o.DEFAULT_OPTIONS),t),t=Ct(t,e),t.filename=uh(t.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),t}},JI=xb;var jj=String.fromCharCode(13),Gj=String.fromCharCode(34),zj=String.fromCharCode(10),Sb=class extends JI{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){let e=this.options,t=this.dataProvider.getData(),i=this.dataProvider.getColumnHeaders(),s=i.length>0,r=this.dataProvider.getRowHeaders(),n=r.length>0,a=e.bom?String.fromCharCode(65279):"";return s&&(i=Ge(i,l=>this._escapeCell(l,!0)),n&&(a+=e.columnDelimiter),a+=i.join(e.columnDelimiter),a+=e.rowDelimiter),we(t,(l,c)=>{c>0&&(a+=e.rowDelimiter),n&&(a+=this._escapeCell(r[c])+e.columnDelimiter),a+=l.map(u=>this._escapeCell(u)).join(e.columnDelimiter)}),a}_escapeCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=vt(e);return i!==""&&(t||i.indexOf(jj)>=0||i.indexOf(Gj)>=0||i.indexOf(zj)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`),i}},e1=Sb;var $j="csv";var vp={[$j]:e1};function Eb(o,e,t){return typeof vp[o]=="function"?new vp[o](e,t):null}var t1="exportFile",i1=240,gd=class extends Ye{static get PLUGIN_KEY(){return t1}static get PLUGIN_PRIORITY(){return i1}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{rootDocument:i,rootWindow:s}=this.hot,r=this._createTypeFormatter(e,t),n=this._createBlob(r),a=s.URL||s.webkitURL,l=i.createElement("a"),c=`${r.options.filename}.${r.options.fileExtension}`;if(l.download!==void 0){let u=a.createObjectURL(n);l.style.display="none",l.setAttribute("href",u),l.setAttribute("download",c),i.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),i.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(u)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(n,c)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!vp[e])throw new Error(`Export format type "${e}" is not supported.`);return Eb(e,new QI(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}};var bp=class{constructor(e,t){let{id:i,stateless:s=!0}=t;this.hot=e,this.id=i,this.elements=[],this.hidden=!1,this.stateId=`Filters.component.${this.id}`,this.state=s?null:this.hot.columnIndexMapper.registerMap(this.stateId,new $s)}reset(){we(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),we(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}};et(bp,Nt);var Pr=bp;var Cd={};function Hi(o,e){if(!Cd[o])throw Error(`Filter condition "${o}" does not exist.`);let{condition:t,descriptor:i}=Cd[o],s=e;return i.inputValuesDecorator&&(s=i.inputValuesDecorator(s)),function(r){return t.apply(r.meta.instance,[].concat([r],[s]))}}function eo(o){if(!Cd[o])throw Error(`Filter condition "${o}" does not exist.`);return Cd[o].descriptor}function lt(o,e,t){t.key=o,Cd[o]={condition:e,descriptor:t}}var Jt="none";function Xj(){return!0}lt(Jt,Xj,{name:yn,inputsCount:0,showOperators:!1});var Fn="empty";function qj(o){return At(o.value)}lt(Fn,qj,{name:Kc,inputsCount:0,showOperators:!0});var wd="not_empty";function Kj(o,e){return!Hi(Fn,e)(o)}lt(wd,Kj,{name:Zc,inputsCount:0,showOperators:!0});var Bn="eq";function Zj(o,e){let[t]=e;return vt(o.value).toLocaleLowerCase(o.meta.locale)===vt(t)}lt(Bn,Zj,{name:Qc,inputsCount:1,showOperators:!0});var yd="neq";function Qj(o,e){return!Hi(Bn,e)(o)}lt(yd,Qj,{name:Jc,inputsCount:1,showOperators:!0});var Tb="gt";function Jj(o,e){let[t]=e,i=t;return o.meta.type==="numeric"&&(i=parseFloat(i,10)),o.value>i}lt(Tb,Jj,{name:ou,inputsCount:1,showOperators:!0});var Rb="gte";function e2(o,e){let[t]=e,i=t;return o.meta.type==="numeric"&&(i=parseFloat(i,10)),o.value>=i}lt(Rb,e2,{name:ru,inputsCount:1,showOperators:!0});var Mb="lt";function t2(o,e){let[t]=e,i=t;return o.meta.type==="numeric"&&(i=parseFloat(i,10)),o.value<i}lt(Mb,t2,{name:nu,inputsCount:1,showOperators:!0});var Ob="lte";function i2(o,e){let[t]=e,i=t;return o.meta.type==="numeric"&&(i=parseFloat(i,10)),o.value<=i}lt(Ob,i2,{name:au,inputsCount:1,showOperators:!0});var Ab=ri(Ui(),1);var vd="date_after";function s2(o,e){let[t]=e,i=(0,Ab.default)(o.value,o.meta.dateFormat),s=(0,Ab.default)(t,o.meta.dateFormat);return!i.isValid()||!s.isValid()?!1:i.diff(s)>=0}lt(vd,s2,{name:cu,inputsCount:1,showOperators:!0});var Ib=ri(Ui(),1);var bd="date_before";function o2(o,e){let[t]=e,i=(0,Ib.default)(o.value,o.meta.dateFormat),s=(0,Ib.default)(t,o.meta.dateFormat);return!i.isValid()||!s.isValid()?!1:i.diff(s)<=0}lt(bd,o2,{name:uu,inputsCount:1,showOperators:!0});var dl="between";function r2(o,e){let[t,i]=e,s=t,r=i;if(o.meta.type==="numeric"){let n=parseFloat(s,10),a=parseFloat(r,10);s=Math.min(n,a),r=Math.max(n,a)}else if(o.meta.type==="date"){let n=Hi(bd,[r]),a=Hi(vd,[s]);return n(o)&&a(o)}return o.value>=s&&o.value<=r}lt(dl,r2,{name:lu,inputsCount:2,showOperators:!0});var _b="not_between";function n2(o,e){return!Hi(dl,e)(o)}lt(_b,n2,{name:hu,inputsCount:2,showOperators:!0});var Nb="begins_with";function a2(o,e){let[t]=e;return vt(o.value).toLocaleLowerCase(o.meta.locale).startsWith(vt(t))}lt(Nb,a2,{name:eu,inputsCount:1,showOperators:!0});var Pb="ends_with";function l2(o,e){let[t]=e;return vt(o.value).toLocaleLowerCase(o.meta.locale).endsWith(vt(t))}lt(Pb,l2,{name:tu,inputsCount:1,showOperators:!0});var xd="contains";function h2(o,e){let[t]=e;return vt(o.value).toLocaleLowerCase(o.meta.locale).indexOf(vt(t))>=0}lt(xd,h2,{name:iu,inputsCount:1,showOperators:!0});var Lb="not_contains";function c2(o,e){return!Hi(xd,e)(o)}lt(Lb,c2,{name:su,inputsCount:1,showOperators:!0});var Db=ri(Ui(),1);var kb="date_tomorrow";function u2(o){let e=(0,Db.default)(o.value,o.meta.dateFormat);return e.isValid()?e.isSame((0,Db.default)().subtract(-1,"days").startOf("day"),"d"):!1}lt(kb,u2,{name:fu,inputsCount:0});var Hb=ri(Ui(),1);var Fb="date_today";function d2(o){let e=(0,Hb.default)(o.value,o.meta.dateFormat);return e.isValid()?e.isSame((0,Hb.default)().startOf("day"),"d"):!1}lt(Fb,d2,{name:du,inputsCount:0});var Bb=ri(Ui(),1);var Vb="date_yesterday";function f2(o){let e=(0,Bb.default)(o.value,o.meta.dateFormat);return e.isValid()?e.isSame((0,Bb.default)().subtract(1,"days").startOf("day"),"d"):!1}lt(Vb,f2,{name:mu,inputsCount:0});var Aue=Fw();function m2(o,e){let t=o;return t===""&&(t=`(${e})`),t}var Wb=new Set([1]).has(1),p2=Wb&&typeof Array.from=="function";function Wo(o){let e=o;return Wb&&(e=new Set(e)),function(t){let i;return Wb?i=e.has(t):i=!!~e.indexOf(t),i}}function xp(o){return o??""}function Sd(o){let e=o;return p2?e=Array.from(new Set(e)):e=rh(e),e=e.sort((t,i)=>typeof t=="number"&&typeof i=="number"?t-i:t===i?0:t>i?1:-1),e}function Ub(o,e,t,i){let s=[],r=o===e,n;return r||(n=Wo(e)),we(o,a=>{let l=!1;(r||n(a))&&(l=!0);let c={checked:l,value:a,visualValue:m2(a,t)};i&&i(c),s.push(c)}),s}var to="by_value";function g2(o,e){let[t]=e;return t(o.value)}lt(to,g2,{name:"By value",inputsCount:0,inputValuesDecorator(o){let[e]=o;return[Wo(e)]},showOperators:!1});var fl={};function s1(o){if(!fl[o])throw Error(`Operation with id "${o}" does not exist.`);let e=fl[o].func;return function(t,i){return e(t,i)}}function o1(o){return fl[o].name}function ml(o,e,t){fl[o]={name:e,func:t}}var ws="conjunction",C2=Cu;function w2(o,e){return o.every(t=>t.func(e))}ml(ws,C2,w2);var Vn="disjunction",y2=vn;function v2(o,e){return o.some(t=>t.func(e))}ml(Vn,y2,v2);var pl="disjunctionWithExtraCondition",b2=vn;function x2(o,e){if(o.length<3)throw Error("Operation doesn't work on less then three conditions.");return o.slice(0,o.length-1).some(t=>t.func(e))&&o[o.length-1].func(e)}ml(pl,b2,x2);var S2="numeric",n1="text",E2="date",r1={[S2]:[Jt,Je,Fn,wd,Je,Bn,yd,Je,Tb,Rb,Mb,Ob,dl,_b],[n1]:[Jt,Je,Fn,wd,Je,Bn,yd,Je,Nb,Pb,Je,xd,Lb],[E2]:[Jt,Je,Fn,wd,Je,Bn,yd,Je,bd,vd,dl,Je,kb,Fb,Vb]};function Yb(o){let e=[],t=o;return r1[t]||(t=n1),we(r1[t],i=>{let s;i===Je?s={name:Je}:s=Ft(eo(i)),e.push(s)}),e}var jb="built",Gb="building",a1=["click","input","keydown","keypress","keyup","focus","blur","change"],Sp=class o{static get DEFAULTS(){return Ft({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){this.hot=e,this.eventManager=new tt(this),this.options=Ct(o.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Gb?this._element:this.buildState===jb?(this.update(),this._element):(this.buildState=Gb,this.build(),this.buildState=jb,this._element)}isBuilt(){return this.buildState===jb}translateIfPossible(e){return typeof e=="string"&&e.startsWith(bi)?this.hot.getTranslatedPhrase(e):e}build(){let e=(t,i)=>{this.eventManager.addEventListener(t,i,s=>this.runLocalHooks(i,s,this))};if(this.buildState||(this.buildState=Gb),this.options.className&&Te(this._element,this.options.className),this.options.children.length)we(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){let t=this.hot.rootDocument.createElement(this.options.tagName);ze(this.options,(i,s)=>{t[s]!==void 0&&s!=="className"&&s!=="tagName"&&s!=="children"&&(t[s]=this.translateIfPossible(i))}),this._element.appendChild(t),we(a1,i=>e(t,i))}else we(a1,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};et(Sp,Nt);var Ki=Sp;var Ep=new WeakMap,zb=class o extends Ki{static get DEFAULTS(){return Ft({placeholder:"",type:"text",tagName:"input"})}constructor(e,t){super(e,Ct(o.DEFAULTS,t)),Ep.set(this,{}),this.registerHooks()}registerHooks(){this.addLocalHook("click",()=>this.onClick()),this.addLocalHook("keyup",e=>this.onKeyup(e))}build(){super.build();let e=Ep.get(this),t=this.hot.rootDocument.createElement("div");e.input=this._element.firstChild,Te(this._element,"htUIInput"),Te(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){if(!this.isBuilt())return;let e=Ep.get(this).input;e.type=this.options.type,e.placeholder=this.translateIfPossible(this.options.placeholder),e.value=this.translateIfPossible(this.options.value)}focus(){this.isBuilt()&&Ep.get(this).input.focus()}onClick(){}onKeyup(e){this.options.value=e.target.value}},Uo=zb;var Tp=new WeakMap,$b=class o extends Ki{static get DEFAULTS(){return Ft({className:"htUISelect",wrapIt:!1})}constructor(e,t){super(e,Ct(o.DEFAULTS,t)),Tp.set(this,{}),this.menu=null,this.items=[],this.registerHooks()}registerHooks(){this.addLocalHook("click",()=>this.onClick())}setItems(e){this.items=this.translateNames(e),this.menu&&this.menu.setMenuItems(this.items)}translateNames(e){return we(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),this.menu=new il(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);let e=new Ki(this.hot,{className:"htUISelectCaption"}),t=new Ki(this.hot,{className:"htUISelectDropdown"}),i=Tp.get(this);i.caption=e,i.captionElement=e.element,i.dropdown=t,we([e,t],s=>this._element.appendChild(s.element)),this.menu.addLocalHook("select",s=>this.onMenuSelect(s)),this.menu.addLocalHook("afterClose",()=>this.onMenuClosed()),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=this.menu.hot.getTranslatedPhrase(yn),Tp.get(this).captionElement.textContent=e,super.update()}openOptions(){let e=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}))}closeOptions(){this.menu&&this.menu.close()}onMenuSelect(e){e.name!==Je&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}onMenuClosed(){this.runLocalHooks("afterClose")}onClick(){this.openOptions()}destroy(){this.menu&&(this.menu.destroy(),this.menu=null);let{caption:e,dropdown:t}=Tp.get(this);e&&e.destroy(),t&&t.destroy(),super.destroy()}},Xb=$b;var qb=class extends Pr{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new Xb(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new Uo(this.hot,{placeholder:Su})),this.elements.push(new Uo(this.hot,{placeholder:Eu})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>this.onConditionSelect(e)),this.getSelectElement().addLocalHook("afterClose",()=>this.onSelectUIClosed()),we(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>this.onInputKeyDown(t))})}setState(e){if(this.reset(),!e)return;let t=Ft(e.command);t.name.startsWith(Wt)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),we(e.args,(i,s)=>{if(s>t.inputsCount-1)return!1;let r=this.getInputElement(s);r.setValue(i),r[t.inputsCount>s?"show":"hide"](),s||setTimeout(()=>r.focus(),10)})}getState(){let e=this.getSelectElement().getValue()||eo(Jt),t=[];return we(this.getInputElements(),(i,s)=>{e.inputsCount>s&&t.push(i.getValue())}),{command:e,args:t}}updateState(e,t){let i=e?eo(e.name):eo(Jt);this.state.setValueAtIndex(t,{command:i,args:e?e.args:[]}),e||we(this.getInputElements(),s=>s.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Xb)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Uo)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,i,s,r,n)=>{Te(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Te(t.parentNode,"border");let a=this.hot.rootDocument.createElement("div");return Te(a,"htFiltersMenuLabel"),a.textContent=n,t.appendChild(a),t.parentNode.hasAttribute("ghost-table")||we(this.elements,l=>t.appendChild(l.element)),t}}}reset(){let e=this.hot.getPlugin("filters").getSelectedColumn(),t=[eo(Jt)];if(e!==null){let{visualIndex:i}=e;t=Yb(this.hot.getDataType(0,i,this.hot.countRows(),i))}we(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}onConditionSelect(e){we(this.getInputElements(),(t,i)=>{t[e.inputsCount>i?"show":"hide"](),i===0&&setTimeout(()=>t.focus(),10)}),this.runLocalHooks("change",e)}onSelectUIClosed(){this.runLocalHooks("afterClose")}onInputKeyDown(e){Us(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),ni(e)):Us(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ni(e))}},Rp=qb;var Mp=new WeakMap,Kb=class o extends Ki{static get DEFAULTS(){return Ft({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,Ct(o.DEFAULTS,t)),Mp.set(this,{})}build(){super.build();let e=Mp.get(this);e.input=this._element.firstChild;let t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),e.label=t,this._element.appendChild(t),this.update()}update(){if(!this.isBuilt())return;let e=Mp.get(this);e.input.checked=this.options.checked,e.label.textContent=this.translateIfPossible(this.options.label.textContent)}isChecked(){return this.options.checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=e,this.update()}focus(){this.isBuilt()&&Mp.get(this).input.focus()}},Zb=Kb;var l1=0,Qb=class extends Pr{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(Te(t.parentNode,"htFiltersMenuOperators"),t.parentNode.hasAttribute("ghost-table")||we(this.elements,i=>t.appendChild(i.element)),t)}}buildOperatorsElement(){let e=[ws,Vn];we(e,t=>{let i=new Zb(this.hot,{name:"operator",label:{htmlFor:t,textContent:o1(t)},value:t,checked:t===e[l1],id:t});i.addLocalHook("change",s=>this.onRadioInputChange(s)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(st`Radio button with index ${e} doesn't exist.`);we(this.elements,(t,i)=>{t.setChecked(i===e)})}getActiveOperationId(){let e=this.elements.find(t=>t instanceof Zb&&t.isChecked());return e?e.getValue():ws}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&we(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ws,t=arguments.length>1?arguments[1]:void 0,i=e;i===pl&&(i=Vn),this.state.setValueAtIndex(t,i)}reset(){this.setChecked(l1)}onRadioInputChange(e){this.setState(e.target.value)}},h1=Qb;var Jb=new WeakMap,ex=class o extends Ki{static get DEFAULTS(){return Ft({href:"#",tagName:"a"})}constructor(e,t){super(e,Ct(o.DEFAULTS,t)),Jb.set(this,{})}build(){super.build();let e=Jb.get(this);e.link=this._element.firstChild}update(){this.isBuilt()&&(Jb.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}},tx=ex;var T2=new WeakMap,R2="multipleSelect.itemBox",ix=class o extends Ki{static get DEFAULTS(){return Ft({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,Ct(o.DEFAULTS,t)),T2.set(this,{}),this.searchInput=new Uo(this.hot,{placeholder:xu,className:"htUIMultipleSelectSearch"}),this.selectAllUI=new tx(this.hot,{textContent:wu,className:"htUISelectAll"}),this.clearAllUI=new tx(this.hot,{textContent:yu,className:"htUIClearAll"}),this.items=[],this.itemsBox=null,this.registerHooks()}registerHooks(){this.searchInput.addLocalHook("keydown",e=>this.onInputKeyDown(e)),this.searchInput.addLocalHook("input",e=>this.onInput(e)),this.selectAllUI.addLocalHook("click",e=>this.onSelectAllClick(e)),this.clearAllUI.addLocalHook("click",e=>this.onClearAllClick(e))}setItems(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)}setLocale(e){this.locale=e}getLocale(){return this.locale}getItems(){return[...this.items]}getValue(){return O2(this.items)}isSelectedAllValues(){return this.items.length===this.getValue().length}build(){super.build();let{rootDocument:e}=this.hot,t=e.createElement("div"),i=new Ki(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(i.element),this._element.appendChild(t);let s=r=>{if(!this._element)return;this.itemsBox&&this.itemsBox.destroy(),Te(r,"htUIMultipleSelectHot"),this.itemsBox=new this.hot.constructor(r,{data:this.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,c,u,g,p,C)=>{l.title=C.instance.getDataAtRowProp(c,C.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>this.itemsBox.container.scrollWidth-Rt(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"}),this.itemsBox.init(),this.itemsBox.getShortcutManager().getContext("grid").addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:R2})};s(t),setTimeout(()=>s(t),100)}reset(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}update(){this.isBuilt()&&(this.itemsBox.loadData(M2(this.items,this.options.value)),super.update())}destroy(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,super.destroy()}onInput(e){let t=e.target.value.toLocaleLowerCase(this.getLocale()),i;t===""?i=[...this.items]:i=zt(this.items,s=>`${s.value}`.toLocaleLowerCase(this.getLocale()).indexOf(t)>=0),this.itemsBox.loadData(i)}onInputKeyDown(e){this.runLocalHooks("keydown",e,this),ph(Us,e.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(ni(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}onSelectAllClick(e){let t=[];e.preventDefault(),we(this.itemsBox.getSourceData(),(i,s)=>{i.checked=!0,t.push(Tm(i,s)[0])}),this.itemsBox.setSourceDataAtCell(t)}onClearAllClick(e){let t=[];e.preventDefault(),we(this.itemsBox.getSourceData(),(i,s)=>{i.checked=!1,t.push(Tm(i,s)[0])}),this.itemsBox.setSourceDataAtCell(t)}},sx=ix;function M2(o,e){let t=Wo(e);return Ge(o,i=>(i.checked=t(i.value),i))}function O2(o){let e=[];return we(o,t=>{t.checked&&e.push(t.value)}),e}var ox=class extends Pr{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.elements.push(new sx(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>this.onInputKeyDown(e))}setState(e){if(this.reset(),e&&e.command.key===to){let t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){let e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?Jt:to},args:[e.getValue()],itemsSnapshot:t}}updateState(e){let t=(i,s,r,n,a)=>{let[l]=zt(s,g=>g.name===to),c={},u=this.hot.getTranslatedPhrase(La);if(l){let g=Sd(Ge(n(i,a),S=>S.value));r&&(l.args[0]=r);let p=[],C=Ub(g,l.args[0],u,S=>{S.checked&&p.push(S.value)}),y=e.editedConditionStack.column;c.locale=this.hot.getCellMeta(0,y).locale,c.args=[p],c.command=eo(to),c.itemsSnapshot=C}else c.args=[],c.command=eo(Jt);this.state.setValueAtIndex(i,c)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof sx)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,i,s,r,n)=>{Te(t.parentNode,"htFiltersMenuValue");let a=this.hot.rootDocument.createElement("div");return Te(a,"htFiltersMenuLabel"),a.textContent=n,t.appendChild(a),t.parentNode.hasAttribute("ghost-table")||we(this.elements,l=>t.appendChild(l.element)),t}}}reset(){let e=this.hot.getTranslatedPhrase(La),t=Sd(this._getColumnVisibleValues()),i=Ub(t,t,e);this.getMultipleSelectElement().setItems(i),super.reset(),this.getMultipleSelectElement().setValue(t);let s=this.hot.getPlugin("filters").getSelectedColumn();s!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}onInputKeyDown(e){Us(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ni(e))}_getColumnVisibleValues(){let e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ge(this.hot.getDataAtCol(e.visualIndex),t=>xp(t))}},c1=ox;var rx=class o extends Pr{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),this.name=t.name,this.elements.push(new Uo(this.hot,{type:"button",value:vu,className:"htUIButton htUIButtonOK",identifier:o.BUTTON_OK})),this.elements.push(new Uo(this.hot,{type:"button",value:bu,className:"htUIButton htUIButtonCancel",identifier:o.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){we(this.elements,e=>{e.addLocalHook("click",(t,i)=>this.onButtonClick(t,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(Te(t.parentNode,"htFiltersMenuActionBar"),t.parentNode.hasAttribute("ghost-table")||we(this.elements,i=>t.appendChild(i.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}onButtonClick(e,t){t.options.identifier===o.BUTTON_OK?this.accept():this.cancel()}},u1=rx;var d1="ConditionCollection.filteringStates",Op=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.hot=e,this.isMapRegistrable=t,this.filteringStates=new $s,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(d1,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var i;let s=this.filteringStates.getValueAtIndex(t),r=(i=s?.conditions)!==null&&i!==void 0?i:[],n=s?.operation;return this.isMatchInConditions(r,e,n)}isMatchInConditions(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ws;return e.length?s1(i)(e,t):!0}addCondition(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ws,s=arguments.length>3?arguments[3]:void 0,r=this.hot.getCellMeta(0,e).locale,n=Ge(t.args,u=>typeof u=="string"?u.toLocaleLowerCase(r):u),a=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);let l=this.getOperation(e);if(l){if(l!==i)throw Error(st`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(nt(fl[i]))throw new Error(st`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);let c=this.getConditions(e);c.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:a,args:n,func:Hi(a,n)}]},s):c.push({name:a,args:n,func:Hi(a,n)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,i;return(t=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return pt(this.filteringStates.getEntries(),(e,t)=>{let[i,{operation:s,conditions:r}]=t;return e.push({column:i,operation:s,conditions:Ge(r,n=>{let{name:a,args:l}=n;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),we(e,t=>{we(t.conditions,i=>this.addCondition(t.column,i))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){let i=this.getConditions(e);return t?i.some(s=>s.name===t):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(d1),this.filteringStates=null,this.clearLocalHooks()}};et(Op,Nt);var Ap=Op;var nx=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return we(this.conditionCollection.getFilteredColumns(),(t,i)=>{let s=this.columnDataFactory(t);i&&(s=this._getIntersectData(s,e)),e=this.filterByColumn(t,s)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=[];return we(t,s=>{s!==void 0&&this.conditionCollection.isMatch(s,e)&&i.push(s)}),i}_getIntersectData(e,t){let i=[];return we(t,s=>{let r=s.meta.visualRow;e[r]!==void 0&&(i[r]=e[r])}),i}},Ip=nx;var _p=class{constructor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];this.hot=e,this.conditionCollection=t,this.columnDataFactory=i,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",s=>this._onConditionBeforeModify(s)),this.conditionCollection.addLocalHook("afterRemove",s=>this.updateStatesAtColumn(s)),this.conditionCollection.addLocalHook("afterAdd",s=>this.updateStatesAtColumn(s)),this.conditionCollection.addLocalHook("beforeClean",()=>this._onConditionBeforeClean()),this.conditionCollection.addLocalHook("afterClean",()=>this._onConditionAfterClean())}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,we(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}_onConditionBeforeModify(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}updateStatesAtColumn(e,t){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}let s=this.conditionCollection.exportAllConditions(),r=this.conditionCollection.getColumnStackPosition(e);r===-1&&(r=this.latestEditedColumnPosition);let n=s.slice(0,r),a=s.slice(r);a.length&&a[0].column===e&&a.shift();let l=tw(function(u,g){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],C=new Ap(i.hot,!1),y=[].concat(u,p);C.importAllConditions(y);let S=i.columnDataFactory(g),O;C.isEmpty()?O=S:O=new Ip(C,_=>i.columnDataFactory(_)).filter(),O=Ge(O,_=>_.meta.visualRow);let M=Wo(O);return C.destroy(),zt(S,_=>M(_.meta.visualRow))})(n),c=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:c},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:t})}_onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}_onConditionAfterClean(){we(this.latestOrderStack,e=>{this.updateStatesAtColumn(e)})}destroy(){this.clearLocalHooks(),ze(this,(e,t)=>{this[t]=null})}};et(_p,Nt);var f1=_p;var ax="filters",m1=250,Ed=class extends Ye{static get PLUGIN_KEY(){return ax}static get PLUGIN_PRIORITY(){return m1}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),this.eventManager=new tt(this),this.dropdownMenuPlugin=null,this.conditionCollection=null,this.conditionUpdateObserver=null,this.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),this.filtersRowsMap=null,this.hot.addHook("afterGetColHeader",(t,i)=>this.onAfterGetColHeader(t,i))}isEnabled(){return!!this.hot.getSettings()[ax]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new fs),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");let e=this.hot.getSettings().dropdownMenu,t=e&&e.uiContainer||this.hot.rootDocument.body,i=n=>(n.addLocalHook("accept",()=>this.onActionBarSubmit("accept")),n.addLocalHook("cancel",()=>this.onActionBarSubmit("cancel")),n.addLocalHook("change",a=>this.onComponentChange(n,a)),n),s=()=>`${this.hot.getTranslatedPhrase(pu)}:`,r=()=>`${this.hot.getTranslatedPhrase(gu)}:`;if(!this.components.get("filter_by_condition")){let n=new Rp(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:t});n.addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition",i(n))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new h1(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){let n=new Rp(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:t});n.addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition2",i(n))}this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new c1(this.hot,{id:"filter_by_value",name:r}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new u1(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new Ap(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new f1(this.hot,this.conditionCollection,n=>this.getDataMapAtColumn(n)),this.conditionUpdateObserver.addLocalHook("update",n=>this.updateComponents(n))),this.components.forEach(n=>n.show()),this.addHook("beforeDropdownMenuSetItems",n=>this.onBeforeDropdownMenuSetItems(n)),this.addHook("afterDropdownMenuDefaultOptions",n=>this.onAfterDropdownMenuDefaultOptions(n)),this.addHook("afterDropdownMenuShow",()=>this.onAfterDropdownMenuShow()),this.addHook("afterDropdownMenuHide",()=>this.onAfterDropdownMenuHide()),this.addHook("afterChange",n=>this.onAfterChange(n)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,i)=>{t.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}super.disablePlugin()}addCondition(e,t,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ws,r=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(r,{command:{key:t},args:i},s)}removeConditions(e){let t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{let t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){let e=this._createDataFilter(),t=!this.conditionCollection.isEmpty(),i=[],s=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",s)!==!1)if(t){let n=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ge(e.filter(),l=>l.meta.visualRow);let a=Wo(i);ke(this.hot.countSourceRows()-1,l=>{a(l)||n.push(l)}),we(n,l=>{this.filtersRowsMap.setValueAtIndex(l,!0)})},!0),i.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}getSelectedColumn(){var e;let t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}clearColumnSelection(){let e=this.getSelectedColumn();e!==null&&this.hot.selectCell(0,e.visualIndex)}getDataMapAtColumn(e){let t=this.hot.toVisualColumn(e),i=[];return we(this.hot.getSourceDataAtCol(t),(s,r)=>{var n;let{row:a,col:l,visualCol:c,visualRow:u,type:g,instance:p,dateFormat:C,locale:y}=this.hot.getCellMeta(r,t),S=(n=this.hot.getDataAtCell(this.hot.toVisualRow(r),t))!==null&&n!==void 0?n:s;i.push({meta:{row:a,col:l,visualCol:c,visualRow:u,type:g,instance:p,dateFormat:C,locale:y},value:xp(S)})}),i}onAfterChange(e){e&&we(e,t=>{let[,i]=t,s=this.hot.propToCol(i);this.conditionCollection.hasConditions(s)&&this.updateValueComponentCondition(s)})}updateValueComponentCondition(e){let t=this.hot.getDataAtCol(e),i=Sd(t);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var t;let i=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(s=>{s.isHidden()||s.restoreState(i)}),this.updateDependentComponentsVisibility()}onAfterDropdownMenuShow(){this.restoreComponents(Array.from(this.components.values()))}onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}onBeforeDropdownMenuSetItems(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",()=>{this.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}onAfterDropdownMenuDefaultOptions(e){e.items.push({name:Je}),this.components.forEach(t=>{e.items.push(t.getMenuItemDescriptor())})}getOperationBasedOnArguments(e,t,i,s){let r=e;return r===Vn&&t.command.key!==Jt&&i.command.key!==Jt&&s.command.key!==Jt?r=pl:s.command.key!==Jt&&(t.command.key===Jt||i.command.key===Jt)&&(r=ws),r}onActionBarSubmit(e){var t;if(e==="accept"){let s=this.getSelectedColumn();if(s===null){var i;(i=this.dropdownMenuPlugin)===null||i===void 0||i.close();return}let{physicalIndex:r}=s,n=this.components.get("filter_by_condition").getState(),a=this.components.get("filter_by_condition2").getState(),l=this.components.get("filter_by_value").getState(),c=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),n,a,l);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(r);u===-1&&(u=void 0),this.conditionCollection.removeConditions(r),n.command.key!==Jt&&(this.conditionCollection.addCondition(r,n,c,u),a.command.key!==Jt&&this.conditionCollection.addCondition(r,a,c,u)),l.command.key!==Jt&&this.conditionCollection.addCondition(r,l,c,u),this.conditionUpdateObserver.flush(),this.components.forEach(g=>g.saveState(r)),this.filtersRowsMap.clear(),this.filter()}(t=this.dropdownMenuPlugin)===null||t===void 0||t.close()}onComponentChange(e,t){this.updateDependentComponentsVisibility(),e.constructor===Rp&&!t.inputsCount&&this.setListeningDropdownMenu()}onSelectUIClosed(){this.setListeningDropdownMenu()}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){let e=this.components.get("filter_by_condition"),{command:t}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...i):this.hideComponents(...i)}onAfterGetColHeader(e,t){let i=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(i)?Te(t,"htFiltersActive"):je(t,"htFiltersActive")}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new Ip(e,t=>this.getDataMapAtColumn(t))}updateComponents(e){var t;if(!((t=this.dropdownMenuPlugin)!==null&&t!==void 0&&t.enabled))return;let{editedConditionStack:{conditions:i,column:s}}=e,r=i.filter(a=>a.name===to),n=i.filter(a=>a.name!==to);if(r.length>=2||n.length>=3)mt(st`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{let a=this.conditionCollection.getOperation(s);this.components.get("filter_by_condition").updateState(n[0],s),this.components.get("filter_by_condition2").updateState(n[1],s),this.components.get("filter_operators").updateState(a,s),this.components.get("filter_by_value").updateState(e)}}getIndexesOfComponents(){let e=[];if(!this.dropdownMenuPlugin)return e;let t=this.dropdownMenuPlugin.menu;for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return we(s,n=>{we(t.menuItems,(a,l)=>{a.key===n.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;let i=this.dropdownMenuPlugin.menu.hotMenu,s=i.getPlugin("hiddenRows");for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];let l=this.getIndexesOfComponents(...n);e?s.showRows(l):s.hideRows(l),i.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}};var lx="internal-use-in-handsontable",Np={licenseKey:lx,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function p1(o){var e;return{maxColumns:o.maxColumns,maxRows:o.maxRows,language:(e=o[ci])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function g1(o){return Object.keys(o).reduce((e,t)=>(t!=="hyperformula"&&(e[t]=o[t]),e),{})}function C1(o){var e;let t=o[ci],i=g1(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),s=p1(o);return{...Np,...i,...s}}function w1(o){var e;let t=o[ci],i=g1(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),s=p1(o);return{...i,...s}}function y1(o,e){return Object.keys(e).some(t=>e[t]!==void 0&&e[t]!==o[t])}function Pp(){let o="engine_relationship",e=qt(ci);return e.hasItem(o)||e.register(o,new Map),e.getItem(o)}function hx(){let o="shared_engine_usage",e=qt(ci);return e.hasItem(o)||e.register(o,new Map),e.getItem(o)}function v1(o){let e=o.getSettings(),t=e[ci],i=t?.engine;if(t===!0||nt(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var s;return A2((s=i.hyperformula)!==null&&s!==void 0?s:i,e,o)}else if(typeof i=="object"&&nt(i.hyperformula)){let r=Pp(),n=hx().get(i);return r.has(i)||r.set(i,[]),r.get(i).push(o),n&&n.push(o.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:lx}),(i.getConfig().leapYear1900!==Np.leapYear1900||nn(i.getConfig().nullDate,Np.nullDate)===!1)&&mt(st`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function A2(o,e,t){let i=e[ci],s=C1(e),r=Pp(),n=hx();I2(o,i.functions),_2(o,i.language);let a=o.buildEmpty(s);return r.set(a,[t]),n.set(a,[t.guid]),N2(a,i.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function cx(o){var e;let t=Pp(),i=t.size===0?[]:Array.from((e=t.get(o))!==null&&e!==void 0?e:[]);return new Map(i.map(s=>[s.getPlugin("formulas").sheetId,s]))}function ux(o,e){if(o){let t=Pp(),i=t.get(o),s=hx(),r=s.get(o);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&t.delete(o)),r&&r.includes(e.guid)&&(r.splice(r.indexOf(e.guid),1),r.length===0&&(s.delete(o),o.destroy()))}}function I2(o,e){e&&e.forEach(t=>{let{name:i,plugin:s,translations:r}=t;try{o.registerFunction(i,s,r)}catch(n){mt(n.message)}})}function _2(o,e){if(e){let{langCode:t}=e;try{o.registerLanguage(t,e)}catch(i){mt(i.message)}}}function N2(o,e){e&&(o.suspendEvaluation(),e.forEach(t=>{let{name:i,expression:s,scope:r,options:n}=t;try{o.addNamedExpression(i,s,r,n)}catch(a){mt(a.message)}}),o.resumeEvaluation())}function b1(o,e){return(nt(e)||!o.doesSheetExist(e))&&(e=o.addSheet(e)),e}var Td=ri(Ui(),1),x1="DD/MM/YYYY";function dx(o){return typeof o=="string"&&o.charAt(0)==="'"&&o.charAt(1)==="="}function S1(o){return dx(o)?o.substr(1):o}function E1(o){return typeof o=="string"&&o.startsWith("=")}function Lp(o,e){return typeof o=="string"&&e==="date"}function fx(o,e){return(0,Td.default)(o,e,!0).isValid()}function mx(o,e){return(0,Td.default)(o,e,!0).format(x1)}function T1(o,e){return(0,Td.default)(o,x1,!0).format(e)}function px(o,e){let i=new Date(Date.UTC(0,0,o+-1));return(0,Td.default)(i).format(e)}function Wn(o,e,t){P2(o,e),e.set(o,t)}function P2(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bt(o,e){var t=R1(o,e,"get");return L2(o,t)}function L2(o,e){return e.get?e.get.call(o):e.value}function Lr(o,e,t){var i=R1(o,e,"set");return D2(o,i,t),t}function R1(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function D2(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Rd=new WeakMap,Dr=new WeakMap,Zi=new WeakMap,Dp=new WeakMap,gx=new WeakMap,Cx=new WeakMap,kp=new WeakMap,wx=class{constructor(e,t,i){Wn(this,Rd,{writable:!0,value:void 0}),Wn(this,Dr,{writable:!0,value:void 0}),Wn(this,Zi,{writable:!0,value:void 0}),Wn(this,Dp,{writable:!0,value:[]}),Wn(this,gx,{writable:!0,value:[]}),Wn(this,Cx,{writable:!0,value:void 0}),Wn(this,kp,{writable:!0,value:[]}),Lr(this,Rd,e),Lr(this,Dr,t),Lr(this,Zi,i)}setRemovedHfIndexes(e){return Lr(this,kp,e.map(t=>{let i=Bt(this,Dr).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(i)})),Bt(this,kp)}getRemovedHfIndexes(){return Bt(this,kp)}getHfIndexFromVisualIndex(e){let t=Bt(this,Dr).getIndexesSequence(),i=Bt(this,Dr).getNotTrimmedIndexes();return t.indexOf(i[e])}syncMoves(e){let i=`move${$t(Bt(this,Rd))}s`;Bt(this,Zi).getEngine().batch(()=>{e.forEach(s=>{let r=s.from!==s.to,n=s.from+1!==s.to;r&&n&&Bt(this,Zi).getEngine()[i](Bt(this,Zi).getSheetId(),s.from,1,s.to)})})}storeMovesInformation(e,t,i){i!==!1&&(Lr(this,gx,e.map(s=>this.getHfIndexFromVisualIndex(s))),Lr(this,Cx,this.getHfIndexFromVisualIndex(t)))}getMoveLine(e,t){let i=Bt(this,Dr).getNumberOfIndexes(),s=Array.from(Array(i).keys()).filter(n=>e.includes(n)===!1);if(t===0){var r;return(r=s[t])!==null&&r!==void 0?r:0}return s[t-1]+1}getInitiallyCalculatedMoves(e,t){let i=this.getMoveLine(e,t),s=[];return e.forEach(r=>{let n={from:r,to:i};s.forEach(a=>{let l=a.from>a.to,c=a.to<=n.from;a.from>n.from&&c&&l&&(n.from+=1)}),n.from>=i&&(i+=1),s.push(n)}),s}adjustedCalculatedMoves(e){return e.forEach((t,i)=>{e.slice(i+1).forEach(r=>{let n=r.from<r.to;r.from>t.from&&n&&(r.from-=1)})}),e}calculateAndSyncMoves(e,t){if(Bt(this,Zi).isPerformingUndoRedo()||e===!1||t===!1)return;let i=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(Bt(this,gx),Bt(this,Cx)));Bt(this,Zi).getSheetId()===null?Bt(this,Zi).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){let e=`set${$t(Bt(this,Rd))}Order`;return t=>{if(Bt(this,Zi).isPerformingUndoRedo())return;let i=Bt(this,Dr).getIndexesSequence();if(t==="update"){let s=Bt(this,Dp).map(l=>i.indexOf(l)),r=Bt(this,Zi).getEngine().getSheetDimensions(Bt(this,Zi).getSheetId()),n;Bt(this,Rd)==="row"?n=r.height:n=r.width;let a=s.length;for(let l=a;l<n;l+=1)s.push(l);Bt(this,Zi).getEngine()[e](Bt(this,Zi).getSheetId(),s)}Lr(this,Dp,i)}}init(){Lr(this,Dp,Bt(this,Dr).getIndexesSequence())}},yx=wx;function Un(o,e,t){k2(o,e),e.set(o,t)}function k2(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yo(o,e){var t=M1(o,e,"get");return H2(o,t)}function H2(o,e){return e.get?e.get.call(o):e.value}function Yn(o,e,t){var i=M1(o,e,"set");return F2(o,i,t),t}function M1(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function F2(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Hp=new WeakMap,Fp=new WeakMap,vx=new WeakMap,bx=new WeakMap,xx=new WeakMap,Sx=new WeakMap,Ex=new WeakMap,Tx=class{constructor(e,t,i){Un(this,Hp,{writable:!0,value:void 0}),Un(this,Fp,{writable:!0,value:void 0}),Un(this,vx,{writable:!0,value:void 0}),Un(this,bx,{writable:!0,value:!1}),Un(this,xx,{writable:!0,value:!1}),Un(this,Sx,{writable:!0,value:null}),Un(this,Ex,{writable:!0,value:null}),Yn(this,Hp,new yx("row",e,this)),Yn(this,Fp,new yx("column",t,this)),Yn(this,vx,i)}getForAxis(e){return e==="row"?Yo(this,Hp):Yo(this,Fp)}setPerformUndo(e){Yn(this,bx,e)}setPerformRedo(e){Yn(this,xx,e)}isPerformingUndoRedo(){return Yo(this,bx)||Yo(this,xx)}getSheetId(){return Yo(this,Ex)}getEngine(){return Yo(this,Sx)}getPostponeAction(){return Yo(this,vx)}setupSyncEndpoint(e,t){Yn(this,Sx,e),Yn(this,Ex,t),Yo(this,Hp).init(),Yo(this,Fp).init()}},O1=Tx;function gl(o,e,t){return e=B2(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function B2(o){var e=V2(o,"string");return typeof e=="symbol"?e:String(e)}function V2(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}function Rx(o,e,t){W2(o,e),e.set(o,t)}function W2(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kr(o,e,t){var i=A1(o,e,"set");return U2(o,i,t),t}function U2(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function Cl(o,e){var t=A1(o,e,"get");return Y2(o,t)}function A1(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function Y2(o,e){return e.get?e.get.call(o):e.value}var ci="formulas",j2=["maxRows","maxColumns","language"],I1=260;He.getSingleton().register("afterNamedExpressionAdded");He.getSingleton().register("afterNamedExpressionRemoved");He.getSingleton().register("afterSheetAdded");He.getSingleton().register("afterSheetRemoved");He.getSingleton().register("afterSheetRenamed");He.getSingleton().register("afterFormulasValuesUpdate");var wl=o=>o==="UndoRedo.undo"||o==="UndoRedo.redo"||o==="auto",jo=new WeakMap,Mx=new WeakMap,Md=new WeakMap,Od=class extends Ye{constructor(){var e;super(...arguments),e=this,Rx(this,jo,{writable:!0,value:!1}),Rx(this,Mx,{writable:!0,value:!1}),Rx(this,Md,{writable:!0,value:[["valuesUpdated",function(){return e.onEngineValuesUpdated(...arguments)}],["namedExpressionAdded",function(){return e.onEngineNamedExpressionsAdded(...arguments)}],["namedExpressionRemoved",function(){return e.onEngineNamedExpressionsRemoved(...arguments)}],["sheetAdded",function(){return e.onEngineSheetAdded(...arguments)}],["sheetRenamed",function(){return e.onEngineSheetRenamed(...arguments)}],["sheetRemoved",function(){return e.onEngineSheetRemoved(...arguments)}]]}),gl(this,"staticRegister",qt("formulas")),gl(this,"engine",null),gl(this,"sheetName",null),gl(this,"indexSyncer",null),gl(this,"rowAxisSyncer",null),gl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return ci}static get PLUGIN_PRIORITY(){return I1}static get SETTING_KEYS(){return[ci,...j2]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[ci]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=v1(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){mt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){let i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&(this.sheetName=i)}this.addHook("beforeLoadData",function(){return t.onBeforeLoadData(...arguments)}),this.addHook("afterLoadData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("beforeUpdateData",function(){return t.onBeforeLoadData(...arguments)}),this.addHook("afterUpdateData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("modifyData",function(){return t.onModifyData(...arguments)}),this.addHook("modifySourceData",function(){return t.onModifySourceData(...arguments)}),this.addHook("beforeValidate",function(){return t.onBeforeValidate(...arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return t.onAfterSetSourceDataAtCell(...arguments)}),this.addHook("afterSetDataAtCell",function(){return t.onAfterSetDataAtCell(...arguments)}),this.addHook("afterSetDataAtRowProp",function(){return t.onAfterSetDataAtCell(...arguments)}),this.addHook("beforeCreateRow",function(){return t.onBeforeCreateRow(...arguments)}),this.addHook("beforeCreateCol",function(){return t.onBeforeCreateCol(...arguments)}),this.addHook("afterCreateRow",function(){return t.onAfterCreateRow(...arguments)}),this.addHook("afterCreateCol",function(){return t.onAfterCreateCol(...arguments)}),this.addHook("beforeRemoveRow",function(){return t.onBeforeRemoveRow(...arguments)}),this.addHook("beforeRemoveCol",function(){return t.onBeforeRemoveCol(...arguments)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow(...arguments)}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol(...arguments)}),this.indexSyncer=new O1(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,s,r,n)=>{this.rowAxisSyncer.storeMovesInformation(i,s,n)}),this.hot.addHook("beforeColumnMove",(i,s,r,n)=>{this.columnAxisSyncer.storeMovesInformation(i,s,n)}),this.hot.addHook("afterRowMove",(i,s,r,n,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(n,a)}),this.hot.addHook("afterColumnMove",(i,s,r,n,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(n,a)}),this.hot.addHook("beforeColumnFreeze",(i,s)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",(i,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",(i,s)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",(i,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){return t.onAfterCellMetaReset(...arguments)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return t.onAfterDetachChild(...arguments)}),this.addHook("beforeAutofill",function(){return t.onBeforeAutofill(...arguments)}),Cl(this,Md).forEach(i=>{let[s,r]=i;return this.engine.on(s,r)}),super.enablePlugin()}}disablePlugin(){Cl(this,Md).forEach(e=>{let[t,i]=e;return this.engine.off(t,i)}),ux(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){let t=w1(this.hot.getSettings());y1(this.engine.getConfig(),t)&&this.engine.updateConfig(t);let i=this.hot.getSettings()[ci];if(Pe(i)&&Pe(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){let s=this.hot.getSettings()[ci].sheetName;s&&this.engine.doesSheetExist(s)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(s??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Cl(this,Md).forEach(e=>{var t;let[i,s]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(i,s)}),kr(this,Md,null),ux(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(Pe(t)&&!oy(t))return mt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return mt("Sheet with the provided name already exists."),!1;try{let i=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(i),t),i}catch(i){return mt(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){ga(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;let t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${$t(ci)}.switchSheet`)}getCellType(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(e),r=this.hot.toPhysicalColumn(t);return s!==null&&r!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=new Set;e.forEach(s=>{var r;let n=s==null||(r=s.address)===null||r===void 0?void 0:r.sheet;n!==void 0&&(i.has(n)||i.add(n))}),cx(this.engine).forEach((s,r)=>{if((t||r!==this.sheetId)&&i.has(r)){var n;s.render(),(n=s.view)===null||n===void 0||n.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=r=>{var n;let{row:a,col:l,sheet:c}=(n=r?.address)!==null&&n!==void 0?n:{};return Pe(c)?`${c}:${a}x${l}`:""},s=new Set(t.map(r=>i(r)));e.forEach(r=>{var n,a;let{row:l,col:c}=(n=r.address)!==null&&n!==void 0?n:{};if(Pe(l)===!1||Pe(c)===!1||l>=this.hot.countRows()||c>=this.hot.countCols())return;let u=r==null||(a=r.address)===null||a===void 0?void 0:a.sheet,g=i(r);if(u!==void 0&&!s.has(g)){let p=cx(this.engine).get(u);if(!p)return;p.validateCell(p.getDataAtCell(l,c),p.getCellMeta(l,c),()=>{})}})}syncChangeWithEngine(e,t,i){let s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){mt(`Not possible to set cell data at ${JSON.stringify(s)}`);return}let r=this.hot.getCellMeta(e,t);return Lp(i,r.type)&&(fx(i,r.dateFormat)?i=mx(i,r.dateFormat):E1(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(s,i)}onBeforeValidate(e,t,i){let s=this.hot.propToCol(i);if(this.isFormulaCellType(t,s)){let r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId},n=this.hot.getCellMeta(t,s),a=this.engine.getCellValue(r);return n.type==="date"&&ii(a)&&(a=px(a,n.dateFormat)),typeof a=="object"&&a!==null?a.value:a}return e}onBeforeAutofill(e,t,i){let{row:s,col:r}=t.getTopStartCorner(),{row:n,col:a}=t.getBottomEndCorner(),{row:l,col:c}=i.getTopStartCorner(),{row:u,col:g}=i.getBottomEndCorner(),p={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId}},C={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(g),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(C)===!1)return!1;let y=this.engine.getFillRangeData(p,C),{row:S,col:O}=p.start,{row:M,col:_}=p.end,N=M-S+1,E=_-O+1;for(let k=0;k<y.length;k+=1)for(let ie=0;ie<y[k].length;ie+=1){let $=y[k][ie],H=k%N,Q=ie%E,Y=this.hot.getCellMeta(H,Q);Lp($,Y.type)&&($.startsWith("'")?y[k][ie]=$.slice(1):this.isFormulaCellType(H,Q,this.sheetId)===!1&&(y[k][ie]=T1($,Y.dateFormat)))}return y}onBeforeLoadData(e,t){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes($t(ci))||kr(this,Mx,nt(this.hot.getSettings().data))}onAfterCellMetaReset(){let e=this.hot.getSourceDataArray(),t=!1;e.forEach((i,s)=>{i.forEach((r,n)=>{let a=this.hot.getCellMeta(s,n),l=a.dateFormat;Lp(r,a.type)&&(t=!0,fx(r,l)?e[s][n]=mx(r,l):this.isFormulaCellType(s,n)===!1&&(e[s][n]=`'${r}`))})}),t===!0&&(kr(this,jo,!0),this.engine.setSheetContent(this.sheetId,e),kr(this,jo,!1))}onAfterLoadData(e,t){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes($t(ci)))if(this.sheetName=b1(this.engine,this.hot.getSettings()[ci].sheetName),Cl(this,Mx))this.switchSheet(this.sheetName);else{let s=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,s)){kr(this,jo,!0);let r=this.engine.setSheetContent(this.sheetId,s);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(r),kr(this,jo,!1)}}}onModifyData(e,t,i,s){if(s!=="get"||Cl(this,jo)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;let r=this.hot.toVisualRow(e);if(r===null||t===null)return;if(!this.isFormulaCellType(r,t)&&this.getCellType(r,t)!=="ARRAY"){dx(i.value)&&(i.value=S1(i.value));return}let a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId},l=this.engine.getCellValue(a),c=this.hot.getCellMeta(r,t);c.type==="date"&&ii(l)&&(l=px(l,c.dateFormat));let u=typeof l=="object"&&l!==null?l.value:l;i.value=u}onModifySourceData(e,t,i,s){if(s!=="get"||Cl(this,jo)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;let r=this.hot.toVisualRow(e),n=this.hot.propToCol(t);if(r===null||n===null||!this.isFormulaCellType(r,n)&&this.getCellType(r,n)!=="ARRAY")return;let l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(l.width===0&&l.height===0)return;let c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};i.value=this.engine.getCellSerialized(c)}onAfterSetDataAtCell(e,t){if(wl(t))return;let i=[],s=[],r=this.engine.batch(()=>{e.forEach(n=>{let[a,l,,c]=n,u=this.hot.propToCol(l),g=this.hot.toPhysicalRow(a),p=this.hot.toPhysicalColumn(u),C={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};g!==null&&p!==null?this.syncChangeWithEngine(a,u,c):i.push([a,u,c]),s.push({address:C})})});i.length&&this.hot.addHookOnce("afterChange",()=>{let n=this.engine.batch(()=>{i.forEach(a=>{let[l,c,u]=a;this.syncChangeWithEngine(l,c,u)})});this.renderDependentSheets(n,!0)}),this.renderDependentSheets(r),this.validateDependentCells(r,s)}onAfterSetSourceDataAtCell(e,t){if(wl(t))return;let i=[],s=[];e.forEach(r=>{let[n,a,,l]=r,c=this.hot.propToCol(a);if(!ii(c))return;let u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){mt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}s.push({address:u}),i.push(...this.engine.setCellContents(u,l))}),this.renderDependentSheets(i),this.validateDependentCells(i,s)}onBeforeCreateRow(e,t){let i=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(i=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[i,t]))return!1}onBeforeCreateCol(e,t){let i=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(i=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[i,t]))return!1}onBeforeRemoveRow(e,t,i){return this.rowAxisSyncer.setRemovedHfIndexes(i).every(n=>this.engine.isItPossibleToRemoveRows(this.sheetId,[n,1]))===!1?!1:void 0}onBeforeRemoveCol(e,t,i){return this.columnAxisSyncer.setRemovedHfIndexes(i).every(n=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[n,1]))===!1?!1:void 0}onAfterCreateRow(e,t,i){if(wl(i))return;let s=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(s)}onAfterCreateCol(e,t,i){if(wl(i))return;let s=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(s)}onAfterRemoveRow(e,t,i,s){if(wl(s))return;let r=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),n=this.engine.batch(()=>{r.forEach(a=>{this.engine.removeRows(this.sheetId,[a,1])})});this.renderDependentSheets(n)}onAfterRemoveCol(e,t,i,s){if(wl(s))return;let r=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),n=this.engine.batch(()=>{r.forEach(a=>{this.engine.removeColumns(this.sheetId,[a,1])})});this.renderDependentSheets(n)}onAfterDetachChild(e,t,i){var s;kr(this,jo,!0);let r=this.hot.getSourceDataArray(i,0,i+(((s=t.__children)===null||s===void 0?void 0:s.length)||0),this.hot.countSourceCols());kr(this,jo,!1),r.forEach((n,a)=>{n.forEach((l,c)=>{this.engine.setCellContents({col:c,row:i+a,sheet:this.sheetId},[[l]])})})}onEngineValuesUpdated(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}onEngineNamedExpressionsAdded(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}onEngineNamedExpressionsRemoved(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}onEngineSheetAdded(e){this.hot.runHooks("afterSheetAdded",e)}onEngineSheetRenamed(e,t){this.hot.runHooks("afterSheetRenamed",e,t)}onEngineSheetRemoved(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}};function Ox(o){return{key:"hidden_columns_hide",name(){let e=this.getSelectedLast(),t=0;if(Array.isArray(e)){let[,i,,s]=e;i-s!==0&&(t=1)}return this.getTranslatedPhrase(zc,t)},callback(){let{from:e,to:t}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.col,t.col),0),s=Math.max(e.col,t.col),r=[];for(let l=i;l<=s;l+=1)r.push(l);o.hideColumns(r);let n=r[r.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(n,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Ax(o){let e=[];return{key:"hidden_columns_show",name(){let t=e.length>1?1:0;return this.getTranslatedPhrase($c,t)},callback(){var t,i;if(e.length===0)return;let s=e[0],r=e[e.length-1];s=(t=this.columnIndexMapper.getNearestNotHiddenIndex(s-1,-1))!==null&&t!==void 0?t:0,r=(i=this.columnIndexMapper.getNearestNotHiddenIndex(r+1,1))!==null&&i!==void 0?i:this.countCols()-1,o.showColumns(e),this.render(),this.view.adjustElementsSize(!0),r-s+1===this.countCols()||this.selectColumns(s,r)},disabled:!1,hidden(){let t=Ge(o.getHiddenColumns(),g=>this.toPhysicalColumn(g));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;let i=this.getSelectedRangeLast(),s=i.getTopStartCorner().col,r=i.getBottomEndCorner().col,n=this.columnIndexMapper,a=n.getRenderableFromVisualIndex(s),l=n.getRenderableFromVisualIndex(r),c=n.getNotTrimmedIndexes(),u=[];if(s!==r){let g=r-s+1,p=l-a+1;if(g>p){let C=c.slice(s,r+1);u.push(...C.filter(y=>t.includes(y)))}}else if(a===0&&a<s)u.push(...c.slice(0,s));else if(a===null)u.push(...c.slice(0,this.countCols()));else{let g=this.countCols()-1,p=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(g,-1));l===p&&g>r&&u.push(...c.slice(r+1))}return we(u,g=>{e.push(this.toVisualColumn(g))}),e.length===0}}}function _1(o,e,t){G2(o,e),e.set(o,t)}function G2(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qi(o,e){var t=N1(o,e,"get");return z2(o,t)}function z2(o,e){return e.get?e.get.call(o):e.value}function Ad(o,e,t){var i=N1(o,e,"set");return $2(o,i,t),t}function N1(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function $2(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}He.getSingleton().register("beforeHideColumns");He.getSingleton().register("afterHideColumns");He.getSingleton().register("beforeUnhideColumns");He.getSingleton().register("afterUnhideColumns");var Bp="hiddenColumns",P1=310,io=new WeakMap,so=new WeakMap,Id=class extends Ye{constructor(){super(...arguments),_1(this,io,{writable:!0,value:{}}),_1(this,so,{writable:!0,value:null})}static get PLUGIN_KEY(){return Bp}static get PLUGIN_PRIORITY(){return P1}isEnabled(){return!!this.hot.getSettings()[Bp]}enablePlugin(){var e=this;if(this.enabled)return;let t=this.hot.getSettings()[Bp];$e(t)&&(Ad(this,io,t),nt(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),Ad(this,so,new zs),Qi(this,so).addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,Qi(this,so)),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(i,s,r)=>this.onAfterGetCellMeta(i,s,r)),this.addHook("modifyColWidth",(i,s)=>this.onModifyColWidth(i,s)),this.addHook("afterGetColHeader",function(){return e.onAfterGetColHeader(...arguments)}),this.addHook("modifyCopyableRange",i=>this.onModifyCopyableRange(i)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Ad(this,io,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){let t=this.getHiddenColumns(),i=this.isValidConfig(e),s=t,r=Qi(this,so).getValues().slice(),n=e.length>0;if(i&&n){let l=e.map(c=>this.hot.toPhysicalColumn(c));we(l,c=>{r[c]=!1}),s=pt(r,(c,u,g)=>(u&&c.push(this.hot.toVisualColumn(g)),c),[])}this.hot.runHooks("beforeUnhideColumns",t,s,i&&n)!==!1&&(i&&n&&Qi(this,so).setValues(r),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,s,i&&n,i&&s.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.showColumns(t)}hideColumns(e){let t=this.getHiddenColumns(),i=this.isValidConfig(e),s=t;i&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,s,i)!==!1&&(i&&this.hot.batchExecution(()=>{we(e,n=>{Qi(this,so).setValueAtIndex(this.hot.toPhysicalColumn(n),!0)})},!0),this.hot.runHooks("afterHideColumns",t,s,i,i&&s.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.hideColumns(t)}getHiddenColumns(){return Ge(Qi(this,so).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Qi(this,so).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){let t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<t):!1}resetCellsMeta(){we(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}onModifyColWidth(e,t){if(this.isHidden(t))return 0;if(Qi(this,io).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&typeof e=="number"&&this.hot.hasColHeaders())return e+15}onAfterGetCellMeta(e,t,i){if(Qi(this,io).copyPasteEnabled===!1&&this.isHidden(t)&&(i.skipColumnOnPaste=!0),this.isHidden(t-1))i.className=i.className||"",i.className.indexOf("afterHiddenColumn")===-1&&(i.className+=" afterHiddenColumn");else if(i.className){let s=i.className.split(" ");if(s.length>0){let r=s.indexOf("afterHiddenColumn");r>-1&&s.splice(r,1),i.className=s.join(" ")}}}onModifyCopyableRange(e){if(Qi(this,io).copyPasteEnabled)return e;let t=[],i=(s,r,n,a)=>{t.push({startRow:s,endRow:r,startCol:n,endCol:a})};return we(e,s=>{let r=!0,n=0;ke(s.startCol,s.endCol,a=>{this.isHidden(a)?(r||i(s.startRow,s.endRow,n,a-1),r=!0):(r&&(n=a),a===s.endCol&&i(s.startRow,s.endRow,n,a),r=!1)})}),t}onAfterGetColHeader(e,t){if(!Qi(this,io).indicators||e<0)return;let i=[];e>=1&&this.isHidden(e-1)&&i.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&i.push("beforeHiddenColumn"),Te(t,i)}onAfterContextMenuDefaultOptions(e){e.items.push({name:Je},Ox(this),Ax(this))}onMapInit(){Array.isArray(Qi(this,io).columns)&&this.hideColumns(Qi(this,io).columns)}destroy(){Ad(this,io,null),Ad(this,so,null),super.destroy()}};function Ix(o){return{key:"hidden_rows_hide",name(){let e=this.getSelectedLast(),t=0;if(Array.isArray(e)){let[i,,s]=e;i-s!==0&&(t=1)}return this.getTranslatedPhrase(Xc,t)},callback(){let{from:e,to:t}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.row,t.row),0),s=Math.max(e.row,t.row),r=[];for(let l=i;l<=s;l+=1)r.push(l);o.hideRows(r);let n=r[r.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(n,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function _x(o){let e=[];return{key:"hidden_rows_show",name(){let t=e.length>1?1:0;return this.getTranslatedPhrase(qc,t)},callback(){var t,i;if(e.length===0)return;let s=e[0],r=e[e.length-1];s=(t=this.rowIndexMapper.getNearestNotHiddenIndex(s-1,-1))!==null&&t!==void 0?t:0,r=(i=this.rowIndexMapper.getNearestNotHiddenIndex(r+1,1))!==null&&i!==void 0?i:this.countRows()-1,o.showRows(e),this.render(),this.view.adjustElementsSize(!0),r-s+1===this.countRows()||this.selectRows(s,r)},disabled:!1,hidden(){let t=Ge(o.getHiddenRows(),g=>this.toPhysicalRow(g));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;let i=this.getSelectedRangeLast(),s=i.getTopStartCorner().row,r=i.getBottomEndCorner().row,n=this.rowIndexMapper,a=n.getRenderableFromVisualIndex(s),l=n.getRenderableFromVisualIndex(r),c=n.getNotTrimmedIndexes(),u=[];if(s!==r){let g=r-s+1,p=l-a+1;if(g>p){let C=c.slice(s,r+1);u.push(...C.filter(y=>t.includes(y)))}}else if(a===0&&a<s)u.push(...c.slice(0,s));else if(a===null)u.push(...c.slice(0,this.countRows()));else{let g=this.countRows()-1,p=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(g,-1));l===p&&g>r&&u.push(...c.slice(r+1))}return we(u,g=>{e.push(this.toVisualRow(g))}),e.length===0}}}function L1(o,e,t){X2(o,e),e.set(o,t)}function X2(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ys(o,e){var t=D1(o,e,"get");return q2(o,t)}function q2(o,e){return e.get?e.get.call(o):e.value}function _d(o,e,t){var i=D1(o,e,"set");return K2(o,i,t),t}function D1(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function K2(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}He.getSingleton().register("beforeHideRows");He.getSingleton().register("afterHideRows");He.getSingleton().register("beforeUnhideRows");He.getSingleton().register("afterUnhideRows");var Vp="hiddenRows",k1=320,Go=new WeakMap,oo=new WeakMap,Nd=class extends Ye{constructor(){super(...arguments),L1(this,Go,{writable:!0,value:{}}),L1(this,oo,{writable:!0,value:null})}static get PLUGIN_KEY(){return Vp}static get PLUGIN_PRIORITY(){return k1}isEnabled(){return!!this.hot.getSettings()[Vp]}enablePlugin(){var e=this;if(this.enabled)return;let t=this.hot.getSettings()[Vp];$e(t)&&(_d(this,Go,t),nt(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),_d(this,oo,new zs),ys(this,oo).addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,ys(this,oo)),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(i,s,r)=>this.onAfterGetCellMeta(i,s,r)),this.addHook("modifyRowHeight",(i,s)=>this.onModifyRowHeight(i,s)),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("modifyCopyableRange",i=>this.onModifyCopyableRange(i)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),_d(this,Go,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){let t=this.getHiddenRows(),i=this.isValidConfig(e),s=t,r=ys(this,oo).getValues().slice(),n=e.length>0;if(i&&n){let l=e.map(c=>this.hot.toPhysicalRow(c));we(l,c=>{r[c]=!1}),s=pt(r,(c,u,g)=>(u&&c.push(this.hot.toVisualRow(g)),c),[])}this.hot.runHooks("beforeUnhideRows",t,s,i&&n)!==!1&&(i&&n&&ys(this,oo).setValues(r),this.hot.runHooks("afterUnhideRows",t,s,i&&n,i&&s.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.showRows(t)}hideRows(e){let t=this.getHiddenRows(),i=this.isValidConfig(e),s=t;i&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,s,i)!==!1&&(i&&this.hot.batchExecution(()=>{we(e,n=>{ys(this,oo).setValueAtIndex(this.hot.toPhysicalRow(n),!0)})},!0),this.hot.runHooks("afterHideRows",t,s,i,i&&s.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.hideRows(t)}getHiddenRows(){return Ge(ys(this,oo).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return ys(this,oo).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){let t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<t):!1}resetCellsMeta(){we(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}onModifyRowHeight(e,t){return this.isHidden(t)?0:e}onAfterGetCellMeta(e,t,i){if(ys(this,Go).copyPasteEnabled===!1&&this.isHidden(e)&&(i.skipRowOnPaste=!0),this.isHidden(e-1))i.className=i.className||"",i.className.indexOf("afterHiddenRow")===-1&&(i.className+=" afterHiddenRow");else if(i.className){let s=i.className.split(" ");if(s.length>0){let r=s.indexOf("afterHiddenRow");r>-1&&s.splice(r,1),i.className=s.join(" ")}}}onModifyCopyableRange(e){if(ys(this,Go).copyPasteEnabled)return e;let t=[],i=(s,r,n,a)=>{t.push({startRow:s,endRow:r,startCol:n,endCol:a})};return we(e,s=>{let r=!0,n=0;ke(s.startRow,s.endRow,a=>{this.isHidden(a)?(r||i(n,a-1,s.startCol,s.endCol),r=!0):(r&&(n=a),a===s.endRow&&i(n,a,s.startCol,s.endCol),r=!1)})}),t}onAfterGetRowHeader(e,t){if(!ys(this,Go).indicators||e<0)return;let i=[];e>=1&&this.isHidden(e-1)&&i.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&i.push("beforeHiddenRow"),Te(t,i)}onAfterContextMenuDefaultOptions(e){e.items.push({name:Je},Ix(this),_x(this))}onMapInit(){Array.isArray(ys(this,Go).rows)&&this.hideRows(ys(this,Go).rows)}destroy(){_d(this,Go,null),_d(this,oo,null),super.destroy()}};function Nx(o){return{key:"freeze_column",name(){return this.getTranslatedPhrase(xc)},callback(e,t){let[{start:{col:i}}]=t;o.freezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden(){let e=this.getSelectedRange(),t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function Px(o){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(Sc)},callback(e,t){let[{start:{col:i}}]=t;o.unfreezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden(){let e=this.getSelectedRange(),t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}He.getSingleton().register("beforeColumnFreeze");He.getSingleton().register("afterColumnFreeze");He.getSingleton().register("beforeColumnUnfreeze");He.getSingleton().register("afterColumnUnfreeze");var Lx="manualColumnFreeze",H1=110,Pd=new WeakMap,Ld=class extends Ye{static get PLUGIN_KEY(){return Lx}static get PLUGIN_PRIORITY(){return H1}constructor(e){super(e),Pd.set(this,{afterFirstUse:!1})}isEnabled(){return!!this.hot.getSettings()[Lx]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.addContextMenuEntry(e)),this.addHook("beforeColumnMove",(e,t)=>this.onBeforeColumnMove(e,t)),super.enablePlugin())}disablePlugin(){let e=Pd.get(this);e.afterFirstUse=!1,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){let t=Pd.get(this),i=this.hot.getSettings(),s=i.fixedColumnsStart<this.hot.countCols()&&e>i.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0),this.hot.runHooks("beforeColumnFreeze",e,s)!==!1&&(s&&(this.hot.columnIndexMapper.moveIndexes(e,i.fixedColumnsStart),i._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,s))}unfreezeColumn(e){let t=Pd.get(this),i=this.hot.getSettings(),s=i.fixedColumnsStart>0&&e<=i.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0),this.hot.runHooks("beforeColumnUnfreeze",e,s)!==!1&&(s&&(i._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,i.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,s))}addContextMenuEntry(e){e.items.push({name:"---------"},Nx(this),Px(this))}onBeforeColumnMove(e,t){if(Pd.get(this).afterFirstUse){let s=this.hot.getSettings().fixedColumnsStart;if(t<s||e.some(r=>r<s))return!1}}};var Dx=0,F1=1,B1=2,yl="px",kx=class{constructor(e){this.hot=e,this._element=null,this.state=Dx,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=B1}build(){this.state===Dx&&(this._element=this.hot.rootDocument.createElement("div"),this.state=F1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Dx}isAppended(){return this.state===B1}isBuilt(){return this.state>=F1}setPosition(e,t){ii(e)&&(this._element.style.top=e+yl),ii(t)&&(this._element.style[this.inlineProperty]=t+yl)}getPosition(){let e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){ii(e)&&(this._element.style.width=e+yl),ii(t)&&(this._element.style.height=t+yl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){ii(e)&&(this._element.style.marginTop=e+yl),ii(t)&&(this._element.style[`margin${$t(this.inlineProperty)}`]=t+yl)}getOffset(){let e=this._element.style,t=`margin${$t(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}},Wp=kx;var Z2="ht__manualColumnMove--backlight",Hx=class extends Wp{build(){super.build(),Te(this._element,Z2)}},V1=Hx;var Q2="ht__manualColumnMove--guideline",Fx=class extends Wp{build(){super.build(),Te(this._element,Q2)}},W1=Fx;He.getSingleton().register("beforeColumnMove");He.getSingleton().register("afterColumnMove");var Yp="manualColumnMove",Y1=120,Hr=new WeakMap,U1="ht__manualColumnMove",Up="show-ui",Bx="on-moving--columns",Vx="after-selection--columns",Dd=class extends Ye{static get PLUGIN_KEY(){return Yp}static get PLUGIN_PRIORITY(){return Y1}constructor(e){super(e),Hr.set(this,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),this.eventManager=new tt(this),this.backlight=new V1(e),this.guideline=new W1(e)}isEnabled(){return!!this.hot.getSettings()[Yp]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollVertically",()=>this.onAfterScrollVertically()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),Te(this.hot.rootElement,U1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){je(this.hot.rootElement,U1),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){let i=Hr.get(this),s=i.cachedDropIndex,r=this.isMovePossible(e,t),n=this.hot.runHooks("beforeColumnMove",e,t,s,r);if(i.cachedDropIndex=void 0,n===!1)return;r&&this.hot.columnIndexMapper.moveIndexes(e,t);let a=r&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,s,r,a),a}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){let i=this.countFinalIndex(e,t),s=Hr.get(this);return s.cachedDropIndex=t,this.moveColumns(e,i)}isMovePossible(e,t){let i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=e.length+t>i,r=t<0,n=e.some(l=>l<0),a=e.some(l=>l>=i);return!(s||r||n||a)}isColumnOrderChanged(e,t){return e.some((i,s)=>i-s!==t)}countFinalIndex(e,t){let i=pt(e,(s,r)=>(r<t&&(s+=1),s),0);return t-i}getColumnsWidth(e,t){let i=this.hot.columnIndexMapper,s=0;for(let r=e;r<=t;r+=1){let n=i.getRenderableFromVisualIndex(r);r<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:n!==null&&(s+=this.hot.view._wt.wtTable.getStretchedColumnWidth(n)||0)}return s}moveBySettingsOrLoad(){let e=this.hot.getSettings()[Yp];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){let t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){let e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){let i=[];return ke(e,t,s=>{i.push(s)}),i}refreshPositions(){let e=Hr.get(this),t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(e.hoveredColumn)&&t>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1));let i=this.hot.view._wt.wtTable,s=this.hot.view._wt.wtOverlays.scrollableElement,r=typeof s.scrollX=="number"?s.scrollX:s.scrollLeft,n=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.hoveredColumn-1),a=i.hider.offsetWidth,l=i.TBODY.offsetLeft,c=this.backlight.getOffset().start,u=this.backlight.getSize().width,g=0,p=0;if(this.hot.isRtl()){let S=this.hot.rootWindow,O=at(this.hot.rootElement),M=S.innerWidth-e.rootElementOffset-O;p=S.innerWidth-e.target.eventPageX-M-(s.scrollX===void 0?r:0)}else p=e.target.eventPageX-(e.rootElementOffset-(s.scrollX===void 0?r:0));if(e.hasRowHeaders&&(g=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(e.hoveredColumn)&&(n+=r),n+=g,e.hoveredColumn<0)e.fixedColumnsStart>0?e.target.col=0:e.target.col=t>0?t-1:t;else if(e.target.TD.offsetWidth/2+n<=p){let S=e.hoveredColumn>=e.countCols?e.countCols-1:e.hoveredColumn;e.target.col=S+1,n+=e.target.TD.offsetWidth}else e.target.col=e.hoveredColumn;let C=p,y=n;p+u+c>=a?C=a-u-c:p+c<l+g&&(C=l+g+Math.abs(c)),n>=a-1?y=a-1:y===0?y=1:s.scrollX!==void 0&&e.hoveredColumn<e.fixedColumnsStart&&(y-=e.rootElementOffset<=s.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,C),this.guideline.setPosition(null,y)}registerEvents(){let{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,t,i,s){let r=this.hot.view._wt.wtTable,n=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),l=Hr.get(this),c=Ve(e.target,"sortAction");if(!a||!n||l.pressed||e.button!==0||c){l.pressed=!1,l.columnsToMove.length=0,je(this.hot.rootElement,[Bx,Up]);return}let u=this.guideline.isBuilt()&&!this.guideline.isAppended(),g=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&g&&(this.guideline.appendTo(r.hider),this.backlight.appendTo(r.hider));let{from:p,to:C}=a,y=Math.min(p.col,C.col),S=Math.max(p.col,C.col);if(t.row<0&&t.col>=y&&t.col<=S){s.column=!0,l.pressed=!0,l.target.eventPageX=e.pageX,l.target.eventOffsetX=e.offsetX,l.hoveredColumn=t.col,l.target.TD=i,l.target.col=t.col,l.columnsToMove=this.prepareColumnsToMoving(y,S),l.hasRowHeaders=!!this.hot.getSettings().rowHeaders,l.countCols=this.hot.countCols(),l.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,l.rootElementOffset=Ot(this.hot.rootElement).left;let O=l.hasRowHeaders?-1:0,M=r.holder.scrollTop+r.getColumnHeaderHeight(0)+1,_=t.col<l.fixedColumnsStart,N=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),E=Math.abs(e.offsetX-(this.hot.isRtl()?e.target.offsetWidth:0)),k=this.getColumnsWidth(y,t.col-1)+E,ie=this.getColumnsWidth(O,y-1)+(_?N:0)+k;this.backlight.setPosition(M,ie),this.backlight.setSize(this.getColumnsWidth(y,S),r.hider.offsetHeight-M),this.backlight.setOffset(null,-k),Te(this.hot.rootElement,Bx)}else je(this.hot.rootElement,Vx),l.pressed=!1,l.columnsToMove.length=0}onMouseMove(e){let t=Hr.get(this);if(t.pressed){if(e.target===this.backlight.element){let i=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(i)})}t.target.eventPageX=e.pageX,this.refreshPositions()}}onBeforeOnCellMouseOver(e,t,i,s){let r=this.hot.getSelectedRangeLast(),n=Hr.get(this);!r||!n.pressed||(n.columnsToMove.indexOf(t.col)>-1?je(this.hot.rootElement,Up):Te(this.hot.rootElement,Up),s.row=!0,s.column=!0,s.cell=!0,n.hoveredColumn=t.col,n.target.TD=i)}onMouseUp(){let e=Hr.get(this),t=e.target.col,i=e.columnsToMove.length;if(e.hoveredColumn=void 0,e.pressed=!1,e.backlightWidth=0,je(this.hot.rootElement,[Bx,Up,Vx]),this.hot.selection.isSelectedByColumnHeader()&&Te(this.hot.rootElement,Vx),i<1||t===void 0)return;let s=e.columnsToMove[0],r=this.hot.toPhysicalColumn(s),n=this.dragColumns(e.columnsToMove,t);if(e.columnsToMove.length=0,n===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);let a=this.hot.toVisualColumn(r),l=a+i-1;this.hot.selectColumns(a,l)}}onAfterScrollVertically(){let e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1,i=e.holder.scrollTop,s=t+i;this.backlight.setPosition(s),this.backlight.setSize(null,e.hider.offsetHeight-s)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}};var kd="manualColumnResize",G1=130,j1="manualColumnWidths",Wx=new WeakMap,Hd=class extends Ye{static get PLUGIN_KEY(){return kd}static get PLUGIN_PRIORITY(){return G1}constructor(e){super(e);let{rootDocument:t}=this.hot;this.currentTH=null,this.currentCol=null,this.selectedCols=[],this.currentWidth=null,this.newSize=null,this.startY=null,this.startWidth=null,this.startOffset=null,this.handle=t.createElement("DIV"),this.guide=t.createElement("DIV"),this.eventManager=new tt(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.columnWidthsMap=void 0,Wx.set(this,{config:void 0}),Te(this.handle,"manualColumnResizer"),Te(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[kd]}enablePlugin(){this.enabled||(this.columnWidthsMap=new mi,this.columnWidthsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(e,t)=>this.onModifyColWidth(e,t)),this.addHook("beforeStretchingColumnWidth",(e,t)=>this.onBeforeStretchingColumnWidth(e,t)),this.addHook("beforeColumnResize",(e,t,i)=>this.onBeforeColumnResize(e,t,i)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){let e=Wx.get(this);e.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",j1,this.columnWidthsMap.getValues())}loadManualColumnWidths(){let e={};return this.hot.runHooks("persistentStateLoad",j1,e),e.value}setManualSize(e,t){let i=Math.max(t,20),s=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(s,i),i}clearManualSize(e){let t=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(t,null)}onMapInit(){let e=Wx.get(this),t=this.hot.getSettings()[kd],i=this.loadManualColumnWidths();typeof i<"u"?this.hot.batchExecution(()=>{i.forEach((s,r)=>{this.columnWidthsMap.setValueAtIndex(r,s)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((s,r)=>{this.columnWidthsMap.setValueAtIndex(r,s)})},!0),e.config=t):t===!0&&Array.isArray(e.config)&&this.hot.batchExecution(()=>{e.config.forEach((s,r)=>{this.columnWidthsMap.setValueAtIndex(r,s)})},!0)}setupHandlePosition(e){if(!e.parentNode)return;this.currentTH=e;let{_wt:t}=this.hot.view,i=t.wtTable.getCoords(this.currentTH),s=i.col;if(s<0)return;let r=ft(this.currentTH),n=this.currentTH.getBoundingClientRect(),a=s<t.getSetting("fixedColumnsStart"),l;a&&(l=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col)),l||(l=t.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),this.selectedCols=[];let c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&c){let u=this.hot.getSelectedRange();we(u,g=>{let p=g.getTopStartCorner().col,C=g.getBottomEndCorner().col;ke(p,C,y=>{this.selectedCols.includes(y)||this.selectedCols.push(y)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=l.start-6,this.startWidth=parseInt(n.width,10),this.handle.style.top=`${l.top}px`,this.handle.style[this.inlineDir]=`${this.startOffset+this.startWidth}px`,this.handle.style.height=`${r}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style[this.inlineDir]=`${this.startOffset+this.currentWidth}px`}setupGuidePosition(){let e=parseInt(ft(this.handle),10),t=parseInt(this.handle.style.top,10)+e,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Te(this.handle,"active"),Te(this.guide,"active"),this.guide.style.top=`${t}px`,this.refreshGuidePosition(),this.guide.style.height=`${i-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){je(this.handle,"active"),je(this.guide,"active")}checkIfColumnHeader(e){return!!os(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}onMouseOver(e){if(!fh(e.target)&&this.isTriggeredByRMB!==!0&&this.checkIfColumnHeader(e.target)){let t=this.getClosestTHParent(e.target);if(!t)return;let i=t.getAttribute("colspan");t&&(i===null||i==="1")&&(this.pressed||this.setupHandlePosition(t))}}afterMouseDownTimeout(){let e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(i,s)=>{let r=this.hot.runHooks("beforeColumnResize",this.newSize,i,!0);r!==void 0&&(this.newSize=r),this.hot.getSettings().stretchH==="all"?this.clearManualSize(i):this.setManualSize(i,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,i,!0),s&&e()};this.dblclick>=2&&(this.selectedCols.length>1?(we(this.selectedCols,s=>{t(s)}),e()):we(this.selectedCols,s=>{t(s,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){Ve(e.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=e.pageX,this.newSize=this.startWidth)}onMouseMove(e){if(this.pressed){let t=(e.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+t,we(this.selectedCols,i=>{this.newSize=this.setManualSize(i,this.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}onMouseUp(){let e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(i,s)=>{this.hot.runHooks("beforeColumnResize",this.newSize,i,!1),s&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,i,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?(we(this.selectedCols,s=>{t(s)}),e()):we(this.selectedCols,s=>{t(s,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){let{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",i=>this.onMouseOver(i)),this.eventManager.addEventListener(t,"mousedown",i=>this.onMouseDown(i)),this.eventManager.addEventListener(e,"mousemove",i=>this.onMouseMove(i)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyColWidth(e,t){let i=e;if(this.enabled){let s=this.hot.toPhysicalColumn(t),r=this.columnWidthsMap.getValueAtIndex(s);this.hot.getSettings()[kd]&&r&&(i=r)}return i}onBeforeStretchingColumnWidth(e,t){let i=this.columnWidthsMap.getValueAtIndex(t);return i===null&&(i=e),i}onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}destroy(){super.destroy()}};var vl="px",Ux=class{constructor(e){this.hot=e,this._element=null,this.state=0}appendTo(e){e.appendChild(this._element),this.state=2}build(){this.state===0&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return this.state===2}isBuilt(){return this.state>=1}setPosition(e,t){e!==void 0&&(this._element.style.top=e+vl),t!==void 0&&(this._element.style.left=t+vl)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+vl),t&&(this._element.style.height=t+vl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+vl),t&&(this._element.style.marginLeft=t+vl)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},jp=Ux;var J2="ht__manualRowMove--backlight",Yx=class extends jp{build(){super.build(),Te(this._element,J2)}},z1=Yx;var eG="ht__manualRowMove--guideline",jx=class extends jp{build(){super.build(),Te(this._element,eG)}},$1=jx;He.getSingleton().register("beforeRowMove");He.getSingleton().register("afterRowMove");var zp="manualRowMove",q1=140,Fr=new WeakMap,X1="ht__manualRowMove",Gp="show-ui",Gx="on-moving--rows",zx="after-selection--rows",Fd=class extends Ye{static get PLUGIN_KEY(){return zp}static get PLUGIN_PRIORITY(){return q1}constructor(e){super(e),Fr.set(this,{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),this.eventManager=new tt(this),this.backlight=new z1(e),this.guideline=new $1(e)}isEnabled(){return!!this.hot.getSettings()[zp]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollHorizontally",()=>this.onAfterScrollHorizontally()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),Te(this.hot.rootElement,X1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){je(this.hot.rootElement,X1),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){let i=Fr.get(this),s=i.cachedDropIndex,r=this.isMovePossible(e,t),n=this.hot.runHooks("beforeRowMove",e,t,s,r);if(i.cachedDropIndex=void 0,n===!1)return;r&&this.hot.rowIndexMapper.moveIndexes(e,t);let a=r&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,s,r,a),a}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){let i=this.countFinalIndex(e,t),s=Fr.get(this);return s.cachedDropIndex=t,this.moveRows(e,i)}isMovePossible(e,t){let i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=e.length+t>i,r=t<0,n=e.some(l=>l<0),a=e.some(l=>l>=i);return!(s||r||n||a)}isRowOrderChanged(e,t){return e.some((i,s)=>i-s!==t)}countFinalIndex(e,t){let i=pt(e,(s,r)=>(r<t&&(s+=1),s),0);return t-i}getRowsHeight(e,t){let i=this.hot.rowIndexMapper,s=0;for(let r=e;r<=t;r++){let n=i.getRenderableFromVisualIndex(r);n!==null&&(s+=this.hot.view._wt.wtTable.getRowHeight(n)||23)}return s}moveBySettingsOrLoad(){let e=this.hot.getSettings()[zp];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){let t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){let e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){let e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;let{from:i,to:s}=e,r=Math.min(i.row,s.row),n=Math.max(i.row,s.row);return ke(r,n,a=>{t.push(a)}),t}refreshPositions(){let e=Fr.get(this),t=e.target.coords,i=this.hot.view.getFirstFullyVisibleRow(),s=this.hot.view.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(t.row)&&i>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1)),this.isFixedRowBottom(t.row)&&s<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(s+1,1),void 0,!0);let n=this.hot.view._wt.wtTable,a=e.target.TD,l=this.hot.rootElement,c=Ot(l),u=ns(l),g=n.holder.scrollTop,p;this.hot.rootWindow===u?p=u.scrollY:p=u.scrollTop;let C=c.top-p,y=e.target.eventPageY-C+g,S=n.hider.offsetHeight,O=n.TBODY.offsetTop,M=this.backlight.getOffset().top,_=this.backlight.getSize().height,N=a.offsetHeight/2,E=a.offsetHeight,k=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1),ie=y>=k+N;this.isFixedRowTop(t.row)&&(k+=n.holder.scrollTop),t.row<0?e.target.row=i>0?i-1:i:ie?(e.target.row=t.row+1,k+=t.row===0?E-1:E):e.target.row=t.row;let $=y,H=k;y+_+M>=S?$=S-_-M:y+M<O&&($=O+Math.abs(M)),k>=S-1&&(H=S-1),this.backlight.setPosition($),this.guideline.setPosition(H)}registerEvents(){let{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,t,i,s){let{wtTable:r,wtViewport:n}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast(),c=Fr.get(this);if(!l||!a||c.pressed||e.button!==0){c.pressed=!1,c.rowsToMove.length=0,je(this.hot.rootElement,[Gx,Gp]);return}let u=this.guideline.isBuilt()&&!this.guideline.isAppended(),g=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&g&&(this.guideline.appendTo(r.hider),this.backlight.appendTo(r.hider));let{from:p,to:C}=l,y=Math.min(p.row,C.row),S=Math.max(p.row,C.row);if(t.col<0&&t.row>=y&&t.row<=S){s.row=!0,c.pressed=!0,c.target.eventPageY=e.pageY,c.target.coords=t,c.target.TD=i,c.rowsToMove=this.prepareRowsToMoving();let O=r.holder.scrollLeft+n.getRowHeaderWidth();this.backlight.setPosition(null,O),this.backlight.setSize(r.hider.offsetWidth-O,this.getRowsHeight(y,S)),this.backlight.setOffset((this.getRowsHeight(y,t.row-1)+e.offsetY)*-1,null),Te(this.hot.rootElement,Gx),this.refreshPositions()}else je(this.hot.rootElement,zx),c.pressed=!1,c.rowsToMove.length=0}onMouseMove(e){let t=Fr.get(this);if(t.pressed){if(e.target===this.backlight.element){let i=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,i)})}t.target.eventPageY=e.pageY,this.refreshPositions()}}onBeforeOnCellMouseOver(e,t,i,s){let r=this.hot.getSelectedRangeLast(),n=Fr.get(this);!r||!n.pressed||(n.rowsToMove.indexOf(t.row)>-1?je(this.hot.rootElement,Gp):Te(this.hot.rootElement,Gp),s.row=!0,s.column=!0,s.cell=!0,n.target.coords=t,n.target.TD=i)}onMouseUp(){let e=Fr.get(this),t=e.target.row,i=e.rowsToMove.length;if(e.pressed=!1,e.backlightHeight=0,je(this.hot.rootElement,[Gx,Gp,zx]),this.hot.selection.isSelectedByRowHeader()&&Te(this.hot.rootElement,zx),i<1||t===void 0)return;let s=e.rowsToMove[0],r=this.hot.toPhysicalRow(s),n=this.dragRows(e.rowsToMove,t);if(e.rowsToMove.length=0,n===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);let a=this.hot.toVisualRow(r),l=a+i-1;this.hot.selectRows(a,l)}}onAfterScrollHorizontally(){let e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth(),i=e.holder.scrollLeft,s=t+i;this.backlight.setPosition(null,s),this.backlight.setSize(e.hider.offsetWidth-s)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}};var Bd="manualRowResize",Z1=30,K1="manualRowHeights",$x=new WeakMap,Vd=class extends Ye{static get PLUGIN_KEY(){return Bd}static get PLUGIN_PRIORITY(){return Z1}constructor(e){super(e);let{rootDocument:t}=this.hot;this.currentTH=null,this.currentRow=null,this.selectedRows=[],this.currentHeight=null,this.newSize=null,this.startY=null,this.startHeight=null,this.startOffset=null,this.handle=t.createElement("DIV"),this.guide=t.createElement("DIV"),this.eventManager=new tt(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.rowHeightsMap=void 0,$x.set(this,{config:void 0}),Te(this.handle,"manualRowResizer"),Te(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Bd]}enablePlugin(){this.enabled||(this.rowHeightsMap=new mi,this.rowHeightsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(e,t)=>this.onModifyRowHeight(e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){let e=$x.get(this);e.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",K1,this.rowHeightsMap.getValues())}loadManualRowHeights(){let e={};return this.hot.runHooks("persistentStateLoad",K1,e),e.value}setManualSize(e,t){let i=this.hot.toPhysicalRow(e),s=Math.max(t,Sa.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(i,s),s}setupHandlePosition(e){this.currentTH=e;let{view:t}=this.hot,{_wt:i}=t,s=i.wtTable.getCoords(this.currentTH),r=s.row;if(r<0)return;let n=at(this.currentTH),a=this.currentTH.getBoundingClientRect(),l=r<i.getSetting("fixedRowsTop"),c=r>=t.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom"),u;l?u=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col):c&&(u=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),u||(u=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(r),this.selectedRows=[];let g=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&g){let p=this.hot.getSelectedRange();we(p,C=>{let y=C.getTopStartCorner().row,S=C.getBottomStartCorner().row;ke(y,S,O=>{this.selectedRows.includes(O)||this.selectedRows.push(O)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=u.top-6,this.startHeight=parseInt(a.height,10),this.handle.style.top=`${this.startOffset+this.startHeight}px`,this.handle.style[this.inlineDir]=`${u.start}px`,this.handle.style.width=`${n}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style.top=`${this.startOffset+this.currentHeight}px`}setupGuidePosition(){let e=parseInt(at(this.handle),10),t=parseInt(this.handle.style[this.inlineDir],10)+e,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Te(this.handle,"active"),Te(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=`${t}px`,this.guide.style.width=`${i-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){je(this.handle,"active"),je(this.guide,"active")}checkIfRowHeader(e){var t;return os(e,["TH"],this.hot.rootElement)&&((t=e.parentNode)===null||t===void 0||(t=t.parentNode)===null||t===void 0?void 0:t.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){let t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&this.newSize<t?t:this.newSize}onMouseOver(e){if(!fh(e.target)&&this.isTriggeredByRMB!==!0&&this.checkIfRowHeader(e.target)){let t=this.getClosestTHParent(e.target);t&&(this.pressed||this.setupHandlePosition(t))}}afterMouseDownTimeout(){let e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(i,s)=>{let r=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);r!==void 0&&(this.newSize=r),this.setManualSize(i,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),s&&e()};this.dblclick>=2&&(this.selectedRows.length>1?(we(this.selectedRows,s=>{t(s)}),e()):we(this.selectedRows,s=>{t(s,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){Ve(e.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=e.pageY,this.newSize=this.startHeight)}onMouseMove(e){this.pressed&&(this.currentHeight=this.startHeight+(e.pageY-this.startY),we(this.selectedRows,t=>{this.newSize=this.setManualSize(t,this.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}onMouseUp(){let e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(i,s)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!1),s&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?(we(this.selectedRows,s=>{t(s)}),e()):we(this.selectedRows,s=>{t(s,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){let{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>this.onMouseOver(i)),this.eventManager.addEventListener(e,"mousedown",i=>this.onMouseDown(i)),this.eventManager.addEventListener(t,"mousemove",i=>this.onMouseMove(i)),this.eventManager.addEventListener(t,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyRowHeight(e,t){let i=e;if(this.enabled){let s=this.hot.toPhysicalRow(t),r=this.rowHeightsMap.getValueAtIndex(s);this.hot.getSettings()[Bd]&&r&&(i=r)}return i}onMapInit(){let e=$x.get(this),t=this.hot.getSettings()[Bd],i=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof i<"u"?i.forEach((s,r)=>{this.rowHeightsMap.setValueAtIndex(r,s)}):Array.isArray(t)?(t.forEach((s,r)=>{this.rowHeightsMap.setValueAtIndex(r,s)}),e.config=t):t===!0&&Array.isArray(e.config)&&e.config.forEach((s,r)=>{this.rowHeightsMap.setValueAtIndex(r,s)})},!0)}destroy(){super.destroy()}};var Xx=class{constructor(e,t,i,s,r,n){this.row=e,this.col=t,this.rowspan=i,this.colspan=s,this.removed=!1,this.cellCoordsFactory=r,this.cellRangeFactory=n}static NEGATIVE_VALUES_WARNING(e){return st`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return st`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return st`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return st`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,t,i){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=i||e.col+e.colspan-1>=i}normalize(e){let t=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){let i=e[0]||e[1],s=t+Math.abs(e[0]||e[1])-1,r=e[0]?"colspan":"rowspan",n=e[0]?"col":"row",a=Math.min(t,s),l=Math.max(t,s),c=this[n],u=this[n]+this[r]-1;if(c>=t&&(this[n]+=i),i>0)t<=u&&t>c&&(this[r]+=i);else if(i<0){if(a<=c&&l>=u)return this.removed=!0,!1;if(c>=a&&c<=l){let g=l-c+1,p=Math.abs(i)-g;this[n]-=p+i,this[r]-=g}else if(c<=a&&u>=l)this[r]+=i;else if(c<=a&&u>=a&&u<l){let g=u-a+1;this[r]-=g}}return!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}},Ji=Xx;function Wd(o,e,t,i){e?e.row===t&&e.col===i?(o.setAttribute("rowspan",e.rowspan.toString()),o.setAttribute("colspan",e.colspan.toString())):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none"):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="")}var qx=class o{constructor(e){this.plugin=e,this.mergedCells=[],this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return st`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){let i=this.mergedCells,s=!1;return we(i,r=>r.row<=e&&r.row+r.rowspan-1>=e&&r.col<=t&&r.col+r.colspan-1>=t?(s=r,!1):!0),s}getByRange(e){let t=this.mergedCells,i=!1;return we(t,s=>s.row<=e.from.row&&s.row+s.rowspan-1>=e.to.row&&s.col<=e.from.col&&s.col+s.colspan-1>=e.to.col?(i=s,i):!0),i}getWithinRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.mergedCells,s=[],r=e;if(!r.includesRange){let n=this.hot._createCellCoords(r.from.row,r.from.col),a=this.hot._createCellCoords(r.to.row,r.to.col);r=this.hot._createCellRange(n,n,a)}return we(i,n=>{let a=this.hot._createCellCoords(n.row,n.col),l=this.hot._createCellCoords(n.row+n.rowspan-1,n.col+n.colspan-1),c=this.hot._createCellRange(a,a,l);t?r.overlaps(c)&&s.push(n):r.includesRange(c)&&s.push(n)}),s.length?s:!1}add(e){let t=this.mergedCells,i=e.row,s=e.col,r=e.rowspan,n=e.colspan,a=new Ji(i,s,r,n,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(i,s),c=this.isOverlapping(a);return!l&&!c?(this.hot&&a.normalize(this.hot),t.push(a),a):(mt(o.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,t){let i=this.mergedCells,s=this.get(e,t),r=s?this.mergedCells.indexOf(s):-1;return s&&r!==-1?(i.splice(r,1),s):!1}clear(){let e=this.mergedCells,t=[],i=[];we(e,s=>{let r=this.hot.getCell(s.row,s.col);r&&t.push([r,this.get(s.row,s.col),s.row,s.col])}),this.mergedCells.length=0,we(t,(s,r)=>{ke(0,s.rowspan-1,n=>{ke(0,s.colspan-1,a=>{if(a!==0||n!==0){let l=this.hot.getCell(s.row+n,s.col+a);l&&i.push([l,null,null,null])}})}),t[r][1]=null}),we(t,s=>{Wd(...s)}),we(i,s=>{Wd(...s)})}isOverlapping(e){let t=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1)),i=!1;return we(this.mergedCells,s=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(s.row,s.col),this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1)).overlaps(t)?(i=!0,!1):!0),i}isFirstRenderableMergedCell(e,t){let i=this.get(e,t);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===t}getFirstRenderableCoords(e,t){let i=this.get(e,t);if(!i||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);let s=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),r=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(s,r)}shiftCollections(e,t,i){let s=[0,0];switch(e){case"right":s[0]+=i;break;case"left":s[0]-=i;break;case"down":s[1]+=i;break;case"up":s[1]-=i;break;default:}we(this.mergedCells,r=>{r.shift(s,t)}),ya(this.mergedCells.length-1,0,r=>{let n=this.mergedCells[r];n&&n.removed&&this.mergedCells.splice(this.mergedCells.indexOf(n),1)})}},Q1=qx;var Kx=class{constructor(e){this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){let t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let i=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?i="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?i="up":t[1]===e[1]&&t[2]===e[2]?i="right":i="left",i}snapDragArea(e,t,i,s){let r=t.slice(0),n=this.getAutofillSize(e,t,i),[a,l,c,u]=e,p=["up","down"].indexOf(i)>-1?c-a+1:u-l+1,C=Math.floor(n/p)*p,y=n-C,S=this.getFarthestCollection(e,t,i,s);if(S){if(i==="down"){let O=S.row+S.rowspan-a-y;r[2]+O>=this.plugin.hot.countRows()?r[2]-=y:r[2]+=y?O:0}else if(i==="right"){let O=S.col+S.colspan-l-y;r[3]+O>=this.plugin.hot.countCols()?r[3]-=y:r[3]+=y?O:0}else if(i==="up"){let O=c-y-S.row+1;r[0]+O<0?r[0]+=y:r[0]-=y?O:0}else if(i==="left"){let O=u-y-S.col+1;r[1]+O<0?r[1]+=y:r[1]-=y?O:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:s,fillSize:n,dragArea:r,cycleLength:p}),r}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Ct(this.currentFillData,e)}getAutofillSize(e,t,i){let[s,r,n,a]=e,[l,c,u,g]=t;switch(i){case"up":return s-l;case"down":return u-n;case"left":return r-c;case"right":return g-a;default:return null}}getDragArea(e,t,i){let[s,r,n,a]=e,[l,c,u,g]=t;switch(i){case"up":return[l,c,s-1,a];case"down":return[n+1,r,u,a];case"left":return[l,c,n,r-1];case"right":return[s,a+1,u,g];default:return null}}getFarthestCollection(e,t,i,s){let[r,n,a,l]=e,c=["up","down"].indexOf(i)>-1,u=c?a:l,g=c?r:n,p=this.getAutofillSize(e,t,i),C=c?a-r+1:l-n+1,y=Math.floor(p/C)*C,S=p-y,O=null,M=null,_=null;switch(i){case"up":O="includesVertically",_=u-S+1;break;case"left":O="includesHorizontally",_=u-S+1;break;case"down":O="includesVertically",_=g+S-1;break;case"right":O="includesHorizontally",_=g+S-1;break;default:}return we(s,N=>{N[O](_)&&N.isFarther(M,i)&&(M=N)}),M}recreateAfterDataPopulation(e){if(!this.currentFillData)return;let t=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,s=this.currentFillData.dragDirection,r=(c,u)=>{switch(s){case"up":return c.row-u>=t.from.row;case"down":return c.row+c.rowspan-1+u<=t.to.row;case"left":return c.col-u>=t.from.column;case"right":return c.col+c.colspan-1+u<=t.to.column;default:return null}},n=0,a=null,l=1;do for(let c=0;c<i.length;c+=1){if(a=i[c],n=l*this.currentFillData.cycleLength,r(a,n))switch(s){case"up":this.plugin.mergedCellsCollection.add({row:a.row-n,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+n,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-n,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+n,colspan:a.colspan});break;default:}c===i.length-1&&(l+=1)}while(r(a,n));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){let t={min:null,max:null},i={min:null,max:null};return we(e,s=>{let r=s[0],n=this.plugin.hot.propToCol(s[1]);(t.min===null||r<t.min)&&(t.min=r),(t.max===null||r>t.max)&&(t.max=r),(i.min===null||n<i.min)&&(i.min=n),(i.max===null||n>i.max)&&(i.max=n)}),{from:{row:t.min,column:i.min},to:{row:t.max,column:i.max}}}dragAreaOverlapsCollections(e,t,i){let s=this.getDragArea(e,t,i),[r,n,a,l]=s,c=this.plugin.hot._createCellCoords(r,n),u=this.plugin.hot._createCellCoords(a,l),g=this.plugin.hot._createCellRange(c,c,u);return!!this.mergedCellsCollection.getWithinRange(g,!0)}},J1=Kx;var Zx=class{constructor(e){this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}snapDelta(e,t,i){let s=t.to,r=s.row+e.row,n=s.col+e.col;e.row?this.jumpOverMergedCell(e,i,r):e.col&&this.jumpOverMergedCell(e,i,n)}jumpOverMergedCell(e,t,i){let s=e.row||e.col,r=null,n=null,a=null;e.row?(r=t.includesVertically(i),n=t.row,a=t.getLastRow()):e.col&&(r=t.includesHorizontally(i),n=t.col,a=t.getLastColumn()),s!==0&&(s>0?r&&i!==n&&(s+=a-i+1):r&&i!==a&&(s-=i-n+1),e.row?e.row=s:e.col&&(e.col=s))}getUpdatedSelectionRange(e,t){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+t.row,e.to.col+t.col))}getSelectedMergedCellClassName(e,t,i,s){let r=Math.min(i[0],i[2]),n=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),l=Math.max(i[1],i[3]);if(s===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;let u=this.plugin.mergedCellsCollection.get(e,t);if(!u)return;let g=u.getLastRow(),p=u.getLastColumn();if(r<=u.row&&n<=u.col&&a>=g&&l>=p)return`${this.fullySelectedMergedCellClassName}-${s}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){let i=[];if(!t||!e)return!1;for(let s=0;s<e.rowspan;s+=1)for(let r=0;r<e.colspan;r+=1)i.push(this.hot._createCellCoords(e.row+s,e.col+r));for(let s=0;s<i.length;s+=1){let r=[];for(let n=0;n<t.length;n+=1)r[n]=t[n].includes(i[s]);if(!r.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){let e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}},e_=Zx;function Qx(o){return{key:"mergeCells",name(){let e=this.getSelectedLast();if(e){let t=o.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(Tc)}return this.getTranslatedPhrase(Ec)},callback(){o.toggleMergeOnSelection()},disabled(){let e=this.getSelectedLast();return e?Ji.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}He.getSingleton().register("beforeMergeCells");He.getSingleton().register("afterMergeCells");He.getSingleton().register("beforeUnmergeCells");He.getSingleton().register("afterUnmergeCells");var bl="mergeCells",s_=150,t_=new WeakMap,i_=bl,Ud=class extends Ye{static get PLUGIN_KEY(){return bl}static get PLUGIN_PRIORITY(){return s_}constructor(e){super(e),t_.set(this,{lastDesiredCoords:null}),this.mergedCellsCollection=null,this.autofillCalculations=null,this.selectionCalculations=null}isEnabled(){return!!this.hot.getSettings()[bl]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Q1(this),this.autofillCalculations=new J1(this),this.selectionCalculations=new e_(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("modifyTransformStart",function(){return e.onModifyTransformStart(...arguments)}),this.addHook("afterModifyTransformStart",function(){return e.onAfterModifyTransformStart(...arguments)}),this.addHook("modifyTransformEnd",function(){return e.onModifyTransformEnd(...arguments)}),this.addHook("modifyGetCellCoords",function(){return e.onModifyGetCellCoords(...arguments)}),this.addHook("beforeSetRangeStart",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeEnd",function(){return e.onBeforeSetRangeEnd(...arguments)}),this.addHook("afterIsMultipleSelection",function(){return e.onAfterIsMultipleSelection(...arguments)}),this.addHook("afterRenderer",function(){return e.onAfterRenderer(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.addMergeActionsToContextMenu(...arguments)}),this.addHook("afterGetCellMeta",function(){return e.onAfterGetCellMeta(...arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return e.onAfterViewportRowCalculatorOverride(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),this.addHook("modifyAutofillRange",function(){return e.onModifyAutofillRange(...arguments)}),this.addHook("afterCreateCol",function(){return e.onAfterCreateCol(...arguments)}),this.addHook("afterRemoveCol",function(){return e.onAfterRemoveCol(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeDrawBorders",function(){return e.onBeforeDrawAreaBorders(...arguments)}),this.addHook("afterDrawSelection",function(){return e.onAfterDrawSelection(...arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return e.onBeforeRemoveCellClassNames(...arguments)}),this.addHook("beforeUndoStackChange",(t,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){let e=this.hot.getSettings()[bl];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!wh())return;let e=[],t=[];this.mergedCellsCollection.mergedCells.forEach(i=>{let{row:s,rowspan:r}=i;for(let n=s+1;n<s+r;n++)t.push(n)}),t=[...new Set(t)],t.forEach(i=>{let s=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(r=>r?.name==="master"?r:r.clone.wtTable).forEach(r=>{let n=r.getRow(s);n&&(n.style.background=bo(n,"backgroundColor").replace(")",", 0.99)"),e.push(n))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{i.style.background=bo(i,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let t=!0;return e?(Ji.containsNegativeValues(e)?(mt(Ji.NEGATIVE_VALUES_WARNING(e)),t=!1):Ji.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(mt(Ji.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):Ji.isSingleCell(e)?(mt(Ji.IS_SINGLE_CELL(e)),t=!1):Ji.containsZeroSpan(e)&&(mt(Ji.ZERO_SPAN_WARNING(e)),t=!1),t):!1}generateFromSettings(e){if(Array.isArray(e)){let t=[];if(we(e,i=>{if(!this.validateSetting(i))return;let s=this.hot._createCellCoords(i.row,i.col),r=this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1),n=this.hot._createCellRange(s,s,r);this.mergeRange(n,!0,!0),ke(i.row,i.row+i.rowspan-1,a=>{ke(i.col,i.col+i.colspan-1,l=>{a===i.row&&l===i.col||t.push([a,l,null])})})}),t.length===0)return;this.hot.setDataAtCell(t)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){let e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");let{from:t,to:i}=e;this.toggleMerge(e),this.hot.selectCell(t.row,t.col,i.row,i.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");let{from:t,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;let{from:t,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,i.row,i.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=e.getTopStartCorner(),r=e.getBottomEndCorner(),n={row:s.row,col:s.col,rowspan:r.row-s.row+1,colspan:r.col-s.col+1},a=[],l=null;return this.canMergeRange(n,t)?(this.hot.runHooks("beforeMergeCells",e,t),ke(0,n.rowspan-1,u=>{ke(0,n.colspan-1,g=>{let p=null;a[u]||(a[u]=[]),u===0&&g===0?p=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(n.row),this.hot.toPhysicalColumn(n.col)):this.hot.setCellMeta(n.row+u,n.col+g,"hidden",!0),a[u][g]=p})}),this.hot.setCellMeta(n.row,n.col,"spanned",!0),this.mergedCellsCollection.add(n)?(i?l=[n.row,n.col,a]:this.hot.populateFromArray(n.row,n.col,a,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,n,t),l):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.mergedCellsCollection.getWithinRange(e);i&&(this.hot.runHooks("beforeUnmergeCells",e,t),we(i,s=>{this.mergedCellsCollection.remove(s.row,s.col),ke(0,s.rowspan-1,r=>{ke(0,s.colspan-1,n=>{this.hot.removeCellMeta(s.row+r,s.col+n,"hidden"),this.hot.removeCellMeta(s.row+r,s.col+n,"copyable")})}),this.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){let t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,i,s){let r=this.hot._createCellCoords(e,t),n=this.hot._createCellCoords(i,s);this.mergeRange(this.hot._createCellRange(r,r,n))}unmerge(e,t,i,s){let r=this.hot._createCellCoords(e,t),n=this.hot._createCellCoords(i,s);this.unmergeRange(this.hot._createCellRange(r,r,n))}onAfterInit(){this.generateFromSettings(this.hot.getSettings()[bl]),this.hot.render()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render()},runOnlyIf:i=>!i.altKey,group:i_})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(i_)}onAfterIsMultipleSelection(e){if(e){let t=this.mergedCellsCollection.mergedCells,i=this.hot.getSelectedRangeLast();for(let s=0;s<t.length;s+=1)if(i.from.row===t[s].row&&i.from.col===t[s].col&&i.to.row===t[s].row+t[s].rowspan-1&&i.to.col===t[s].col+t[s].colspan-1)return!1}return e}onModifyTransformStart(e){let t=t_.get(this),i=this.hot.getSelectedRangeLast(),s={row:e.row,col:e.col},r=null,n=this.hot._createCellCoords(i.highlight.row,i.highlight.col),a=this.mergedCellsCollection.get(n.row,n.col);if(t.lastDesiredCoords||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),a){let c=this.hot._createCellCoords(a.row,a.col),u=this.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1);this.hot._createCellRange(c,c,u).includes(t.lastDesiredCoords)||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),s.row=t.lastDesiredCoords.row?t.lastDesiredCoords.row-n.row:s.row,s.col=t.lastDesiredCoords.col?t.lastDesiredCoords.col-n.col:s.col,e.row>0?s.row=a.row+a.rowspan-1-n.row+e.row:e.row<0&&(s.row=n.row-a.row+e.row),e.col>0?s.col=a.col+a.colspan-1-n.col+e.col:e.col<0&&(s.col=n.col-a.col+e.col)}r=this.hot._createCellCoords(i.highlight.row+s.row,i.highlight.col+s.col);let l=this.mergedCellsCollection.get(r.row,r.col);if(l){let c=this.mergedCellsCollection.getFirstRenderableCoords(l.row,l.col);t.lastDesiredCoords=r,s={row:c.row-n.row,col:c.col-n.col}}s.row!==0&&(e.row=s.row),s.col!==0&&(e.col=s.col)}onModifyTransformEnd(e){let t=this.hot.getSelectedRangeLast(),i=Ft(e),s=this.selectionCalculations.getUpdatedSelectionRange(t,e),r=Ft(i),n=this.mergedCellsCollection.getWithinRange(s,!0);do r=Ft(i),this.selectionCalculations.getUpdatedSelectionRange(t,i),we(n,a=>{this.selectionCalculations.snapDelta(i,t,a)});while(i.row!==r.row||i.col!==r.col);e.row=i.row,e.col=i.col}onModifyGetCellCoords(e,t){if(e<0||t<0)return;let i=this.mergedCellsCollection.get(e,t);if(!i)return;let{row:s,col:r,colspan:n,rowspan:a}=i;return[s,r,s+a-1,r+n-1]}addMergeActionsToContextMenu(e){e.items.push({name:"---------"},Qx(this))}onAfterRenderer(e,t,i){let s=this.mergedCellsCollection.get(t,i),r=$e(s)?Ft(s):void 0;if($e(r)){let{rowIndexMapper:n,columnIndexMapper:a}=this.hot,{row:l,col:c,colspan:u,rowspan:g}=r,[p,C]=this.translateMergedCellToRenderable(l,g,c,u),y=n.getRenderableFromVisualIndex(t),S=a.getRenderableFromVisualIndex(i),O=p-y+1,M=C-S+1;r.row=n.getNearestNotHiddenIndex(r.row,1),r.col=a.getNearestNotHiddenIndex(r.col,1),r.rowspan=Math.min(r.rowspan,O),r.colspan=Math.min(r.colspan,M)}Wd(e,r,t,i)}onBeforeSetRangeStart(e){if(this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)){let t=this.mergedCellsCollection.get(e.row,e.col);[e.row,e.col]=[t.row,t.col]}}onBeforeSetRangeEnd(e){let t=this.hot.getSelectedRangeLast();t.highlight=this.hot._createCellCoords(t.highlight.row,t.highlight.col),t.to=e;let i=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{i=!1;for(let s=0;s<this.mergedCellsCollection.mergedCells.length;s+=1){let n=this.mergedCellsCollection.mergedCells[s].getRange();t.expandByRange(n)&&(e.row=t.to.row,e.col=t.to.col,i=!0)}}while(i)}onAfterGetCellMeta(e,t,i){let s=this.mergedCellsCollection.get(e,t);s&&(s.row!==e||s.col!==t?i.copyable=!1:(i.rowspan=s.rowspan,i.colspan=s.colspan))}onAfterViewportRowCalculatorOverride(e){let t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}modifyViewportRowStart(e,t){let i=this.hot.rowIndexMapper,s=i.getVisualFromRenderableIndex(e.startRow);for(let r=0;r<t;r+=1){let n=this.mergedCellsCollection.get(s,r);if($e(n)){let a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(n.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){let i=this.hot.rowIndexMapper,s=i.getVisualFromRenderableIndex(e.endRow);for(let r=0;r<t;r+=1){let n=this.mergedCellsCollection.get(s,r);if($e(n)){let a=n.row+n.rowspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,t);return}}}}onAfterViewportColumnCalculatorOverride(e){let t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}modifyViewportColumnStart(e,t){let i=this.hot.columnIndexMapper,s=i.getVisualFromRenderableIndex(e.startColumn);for(let r=0;r<t;r+=1){let n=this.mergedCellsCollection.get(r,s);if($e(n)){let a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(n.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){let i=this.hot.columnIndexMapper,s=i.getVisualFromRenderableIndex(e.endColumn);for(let r=0;r<t;r+=1){let n=this.mergedCellsCollection.get(r,s);if($e(n)){let a=n.col+n.colspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,i,s){let{rowIndexMapper:r,columnIndexMapper:n}=this.hot,a,l;t===0?a=r.getNearestNotHiddenIndex(e,1):a=r.getNearestNotHiddenIndex(e+t-1,-1),s===0?l=n.getNearestNotHiddenIndex(i,1):l=n.getNearestNotHiddenIndex(i+s-1,-1);let c=e>=0?r.getRenderableFromVisualIndex(a):e,u=i>=0?n.getRenderableFromVisualIndex(l):i;return[c,u]}onModifyAutofillRange(e,t){this.autofillCalculations.correctSelectionAreaSize(t);let i=this.autofillCalculations.getDirection(t,e),s=e;if(this.autofillCalculations.dragAreaOverlapsCollections(t,s,i))return s=t,s;let r=this.mergedCellsCollection.getWithinRange({from:{row:t[0],col:t[1]},to:{row:t[2],col:t[3]}});return r&&(s=this.autofillCalculations.snapDragArea(t,s,i,r)),s}onAfterCreateCol(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}onAfterRemoveCol(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}onAfterCreateRow(e,t,i){i!=="auto"&&this.mergedCellsCollection.shiftCollections("down",e,t)}onAfterRemoveRow(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}onAfterChange(e,t){t==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(e)}onBeforeDrawAreaBorders(e,t){if(t&&t==="area"){let i=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getWithinRange(i);we(s,r=>{i.getBottomEndCorner().row===r.getLastRow()&&i.getBottomEndCorner().col===r.getLastColumn()&&(e[2]=r.row,e[3]=r.col)})}}onAfterModifyTransformStart(e,t,i){if(!this.enabled)return;let s=this.mergedCellsCollection.get(e.row,e.col);if(!s)return;let r=t>0,n=t<0,a=i<0,l=i>0,c=s.row+s.rowspan-1===this.hot.countRows()-1,u=s.row===0,g=s.col+s.colspan-1===this.hot.countCols()-1,p=s.col===0;(r&&c||n&&u||l&&g||a&&p)&&(e.row=s.row,e.col=s.col)}onAfterDrawSelection(e,t,i,s){if(i)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,i,s)}onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}};function o_(o,e){return function(t,i){let[,...s]=t,[,...r]=i;return function n(a){let l=o[a],c=e[a],u=s[a],g=r[a],p=c.multiColumnSorting,y=(p.compareFunctionFactory?p.compareFunctionFactory:Ju(c.type))(l,c,p)(u,g);if(y===Si){let S=a+1;if(typeof e[S]<"u")return n(S)}return y}(0)}}function Jx(){mt(st`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}var r_="sort";function n_(o,e,t){let i=[];return t===!1||o.isColumnSorted(e)&&o.getNumberOfSortedColumns()>1&&i.push(`${r_}-${o.getIndexOfColumnInSortQueue(e)+1}`),i}function a_(o){let e=o.className.split(" "),t=new RegExp(`^${r_}-[0-9]{1,2}$`);return e.filter(i=>t.test(i))}var $p="multiColumnSorting",h_=170,tG="append",l_="columnSorting";Qu($p,o_);var Yd=class extends In{static get PLUGIN_KEY(){return $p}static get PLUGIN_PRIORITY(){return h_}constructor(e){super(e),this.pluginKey=$p}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[l_]&&Jx(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];super.updateHeaderClasses(e,...i),je(e,a_(e)),this.enabled!==!1&&Te(e,n_(...i))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[l_]&&Jx(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){Zu(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,tG))):this.sort(this.getColumnNextConfig(t.col)))}};var c_="multipleSelectionHandles",u_=160,jd=class extends Ye{static get PLUGIN_KEY(){return c_}static get PLUGIN_PRIORITY(){return u_}constructor(e){super(e),this.dragged=[],this.eventManager=null,this.lastSetCell=null}isEnabled(){return fi()}enablePlugin(){this.enabled||(this.eventManager||(this.eventManager=new tt(this)),this.registerListeners(),super.enablePlugin())}registerListeners(){let e=this,{rootElement:t}=this.hot;function i(s){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;let r=e.dragged.indexOf(s);if(r===-1)return!1;r===0?e.dragged=e.dragged.slice(0,1):r===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",s=>{let r;if(Ve(s.target,"topSelectionHandle-HitArea"))return r=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:r.getWidth(),height:r.getHeight(),direction:r.getDirection()},s.preventDefault(),!1;if(Ve(s.target,"bottomSelectionHandle-HitArea"))return r=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:r.getWidth(),height:r.getHeight(),direction:r.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",s=>{if(Ve(s.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,s.preventDefault(),!1;if(Ve(s.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",s=>{let{rootDocument:r}=this.hot,n,a,l,c,u,g;if(e.dragged.length===0)return;let p=r.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!p||p===e.lastSetCell||((p.nodeName==="TD"||p.nodeName==="TH")&&(n=e.hot.getCoords(p),n.col===-1&&(n.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),c=a.getHeight(),u=a.getDirection(),l===1&&c===1&&e.hot.selection.setRangeEnd(n),g=e.getCurrentRangeCoords(a,n,e.touchStartRange.direction,u,e.dragged[0]),g.start!==null&&e.hot.selection.setRangeStart(g.start),e.hot.selection.setRangeEnd(g.end),e.lastSetCell=p),s.preventDefault())})}getCurrentRangeCoords(e,t,i,s,r){let n=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),c=e.getTopEndCorner(),u={start:null,end:null};switch(i){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":r==="top"?u={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(l.row,t.col)}:u={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,n.col)};break;case"SE-NW":r==="bottom"&&(u={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,n.col)});break;default:break}break;case"NW-SE":switch(s){case"NE-SW":r==="top"?u={start:t,end:l}:u.end=t;break;case"NW-SE":r==="top"?u={start:t,end:a}:u.end=t;break;case"SE-NW":r==="top"?u={start:t,end:n}:u.end=t;break;case"SW-NE":r==="top"?u={start:t,end:c}:u.end=t;break;default:break}break;case"SW-NE":switch(s){case"NW-SE":r==="bottom"?u={start:this.hot._createCellCoords(t.row,n.col),end:this.hot._createCellCoords(l.row,t.col)}:u={start:this.hot._createCellCoords(n.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SW-NE":r==="top"?u={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)}:u={start:this.hot._createCellCoords(t.row,n.col),end:this.hot._createCellCoords(n.row,t.col)};break;case"SE-NW":r==="bottom"?u={start:this.hot._createCellCoords(t.row,c.col),end:this.hot._createCellCoords(n.row,t.col)}:r==="top"&&(u={start:l,end:t});break;default:break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":r==="top"&&(u.end=t);break;case"SE-NW":r==="top"?u.end=t:u={start:t,end:n};break;default:break}break;default:break}return u}isDragged(){return this.dragged.length>0}};function Gd(){let{label:o="",colspan:e=1,origColspan:t=1,collapsible:i=!1,crossHiddenColumns:s=[],isCollapsed:r=!1,isHidden:n=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:o,colspan:e,origColspan:t,collapsible:i,isCollapsed:r,crossHiddenColumns:s,isHidden:n,isRoot:a,isPlaceholder:l}}function Xp(){return{label:"",isPlaceholder:!0}}function d_(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,t=[];if(e===0)return t;we(o,s=>{let r=[],n=0;t.push(r),we(s,a=>{let l=Gd();if($e(a)){let{label:u,colspan:g}=a;l.label=vt(u),typeof g=="number"&&g>1&&(l.colspan=g,l.origColspan=g)}else l.label=vt(a);n+=l.origColspan;let c=!1;if(n>=e&&(l.colspan=l.origColspan-(n-e),l.origColspan=l.colspan,c=!0),r.push(l),l.colspan>1)for(let u=0;u<l.colspan-1;u++)r.push(Xp());return!c})});let i=Math.max(...Ge(t,s=>s.length));return we(t,s=>{if(s.length<i){let r=Ge(new Array(i-s.length),()=>Gd());s.splice(s.length,0,...r)}}),t}function eS(o,e,t){iG(o,e),e.set(o,t)}function iG(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hs(o,e){var t=m_(o,e,"get");return sG(o,t)}function sG(o,e){return e.get?e.get.call(o):e.value}function zd(o,e,t){var i=m_(o,e,"set");return oG(o,i,t),t}function m_(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function oG(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var f_=["label","collapsible"],zo=new WeakMap,jn=new WeakMap,tS=new WeakMap,$d=class{constructor(){eS(this,zo,{writable:!0,value:[]}),eS(this,jn,{writable:!0,value:0}),eS(this,tS,{writable:!0,value:1/0})}setColumnsLimit(e){zd(this,tS,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];zd(this,zo,d_(e,Hs(this,tS))),zd(this,jn,Hs(this,zo).length)}getData(){return Hs(this,zo)}mergeWith(e){we(e,t=>{let{row:i,col:s,...r}=t,n=this.getHeaderSettings(i,s);n!==null&&Ct(n,r,f_)})}map(e){we(Hs(this,zo),t=>{we(t,i=>{let s=e({...i});$e(s)&&Ct(i,s,f_)})})}getHeaderSettings(e,t){var i;if(e>=Hs(this,jn)||e<0)return null;let s=Hs(this,zo)[e];return t>=s.length?null:(i=s[t])!==null&&i!==void 0?i:null}getHeadersSettings(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=[];if(e>=Hs(this,jn)||e<0)return s;let r=Hs(this,zo)[e],n=0;for(let a=t;a<r.length;a++){let l=r[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(n+=l.colspan,s.push(l),l.colspan>1&&(a+=l.colspan-1),n===i)break;if(n>i)throw new Error("The last column settings cannot overlap the other header layers")}return s}getLayersCount(){return Hs(this,jn)}getColumnsCount(){return Hs(this,jn)>0?Hs(this,zo)[0].length:0}clear(){zd(this,zo,[]),zd(this,jn,0)}};function iS(o,e,t){return e=rG(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function rG(o){var e=nG(o,"string");return typeof e=="symbol"?e:String(e)}function nG(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var aG="DF-pre-order";function g_(o,e){let t=o.call(e,this);for(let i=0;i<this.childs.length;i++){if(t===!1)return!1;t=g_.call(this.childs[i],o,e)}return t}var lG="DF-post-order";function C_(o,e){for(let t=0;t<this.childs.length;t++)if(C_.call(this.childs[t],o,e)===!1)return!1;return o.call(e,this)}var w_="BF";function hG(o,e){let t=[this];function i(){if(t.length===0)return;let s=t.shift();t.push(...s.childs),o.call(e,s)!==!1&&i()}i()}var cG=w_,p_=new Map([[aG,g_],[lG,C_],[w_,hG]]),xl=class o{constructor(e){iS(this,"data",{}),iS(this,"parent",null),iS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,t=new o({...e.data});for(let i=0;i<e.childs.length;i++)t.addChild(this.cloneTree(e.childs[i]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cG;if(!p_.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);p_.get(t).call(this,e,this)}walkUp(e){let t=this,i=s=>{e.call(t,s)!==!1&&s.parent!==null&&i(s.parent)};i(this)}};function sS(o,e,t){uG(o,e),e.set(o,t)}function uG(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ai(o,e){var t=y_(o,e,"get");return dG(o,t)}function dG(o,e){return e.get?e.get.call(o):e.value}function fG(o,e,t){var i=y_(o,e,"set");return mG(o,i,t),t}function y_(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function mG(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Sl=new WeakMap,Gn=new WeakMap,El=new WeakMap,Xd=class{constructor(e){sS(this,Sl,{writable:!0,value:new Map}),sS(this,Gn,{writable:!0,value:new Map}),sS(this,El,{writable:!0,value:null}),fG(this,El,e)}getRoots(){return Array.from(Ai(this,Sl).values())}getRootByColumn(e){let t;return Ai(this,Gn).has(e)&&(t=Ai(this,Sl).get(Ai(this,Gn).get(e))),t}getNode(e,t){let i=this.getRootByColumn(t);if(!i)return;let s=t-Ai(this,Gn).get(t),r=0,n;return i.walkDown(a=>{let{data:{origColspan:l,headerLevel:c}}=a;if(e===c){if(s>=r&&s<=r+l-1)return n=a,n.data.isRoot=t===n.data.columnIndex,!1;r+=l}}),n}rebuildTreeIndex(){let e=0;Ai(this,Gn).clear(),we(Ai(this,Sl),t=>{let[,{data:{colspan:i}}]=t;for(let s=e;s<e+i;s++)Ai(this,Gn).set(s,e);e+=i})}buildTree(){this.clear();let e=Ai(this,El).getColumnsCount(),t=0;for(;t<e;){let i=Ai(this,El).getHeaderSettings(0,t),s=new xl;Ai(this,Sl).set(t,s),this.buildLeaves(s,t,0,i.origColspan),t+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,r=Ai(this,El).getHeadersSettings(i,t,s);i+=1,we(r,n=>{let a={...n,headerLevel:i-1,columnIndex:t},l;i===1?(e.data=a,l=e):(l=new xl(a),e.addChild(l)),i<Ai(this,El).getLayersCount()&&this.buildLeaves(l,t,i,n.origColspan),t+=n.origColspan})}clear(){Ai(this,Sl).clear(),Ai(this,Gn).clear()}};function qp(o,e){o.walkDown(t=>{let{data:i,childs:s}=t;if(!i.isHidden&&(e(i.columnIndex),s.length===0))for(let r=1;r<i.colspan;r++)e(i.columnIndex+r)})}function Tl(o,e){let{childs:t}=o;if(t.length!==0)return t[0].data[e]}function Rl(o){return Tl(o,"origColspan")===o.data.origColspan}function qd(o){let{data:e,childs:t}=o;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Rl(o))return qd(t[0]);e.isCollapsed=!1;let s=t.slice(1),r=new Set,n=0;if(s.length>0)we(s,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;let l=a.data;n+=l.colspan,qp(a,c=>{r.add(c)})});else{let{colspan:a,origColspan:l,columnIndex:c}=e;n=l-a;for(let u=1;u<l;u++)r.add(c+u)}return o.walkUp(a=>{let{data:l}=a;l.colspan+=n,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Rl(a)&&(l.isCollapsed=Tl(a,"isCollapsed"))}),{rollbackModification:()=>Kd(o),affectedColumns:Array.from(r),colspanCompensation:n}}function Kd(o){var e;let{data:t,childs:i}=o;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Rl(o))return Kd(i[0]);t.isCollapsed=!0;let r=i.slice(1),n=new Set;if(r.length>0)we(r,l=>{qp(l,c=>{n.add(c)}),l.data.clonedTree=l.cloneTree(),l.walkDown(c=>{let{data:u}=c;u.isHidden=!0})});else{let{origColspan:l,columnIndex:c}=t;for(let u=1;u<l;u++){let g=c+u;n.add(g)}}let a=t.colspan-((e=Tl(o,"colspan"))!==null&&e!==void 0?e:1);return o.walkUp(l=>{let{data:c}=l;c.colspan-=a,c.colspan<=1?(c.colspan=1,c.isCollapsed=!0):Rl(l)&&(c.isCollapsed=Tl(l,"isCollapsed"))}),{rollbackModification:()=>qd(o),affectedColumns:Array.from(n),colspanCompensation:a}}function v_(o,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(o.childs.length>0)throw new Error(st`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);let{crossHiddenColumns:t}=o.data;if(t.includes(e))return;let i=!1;o.walkUp(s=>{let{data:{collapsible:r}}=s;if(r)return i=!0,!1}),!i&&o.walkUp(s=>{let{data:r}=s;r.crossHiddenColumns.push(e),r.colspan>1?r.colspan-=1:r.isHidden=!0})}function b_(o,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(o.childs.length>0)throw new Error(st`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);let{crossHiddenColumns:t}=o.data;if(!t.includes(e))return;let i=!1;o.walkUp(s=>{let{data:{collapsible:r}}=s;if(r)return i=!0,!1}),!i&&o.walkUp(s=>{let{data:r}=s;r.crossHiddenColumns.splice(r.crossHiddenColumns.indexOf(e),1),!r.isHidden&&r.colspan<r.origColspan&&(r.colspan+=1),r.isHidden=!1})}var x_=new Map([["collapse",Kd],["expand",qd],["hide-column",v_],["show-column",b_]]);function S_(o,e,t){if(!x_.has(o))throw new Error(`The node modifier action ("${o}") does not exist.`);return x_.get(o)(e,t)}function Zd(o){let e=[];return we(o,t=>{t.walkDown(i=>{let s=i.data,{origColspan:r,columnIndex:n,headerLevel:a,crossHiddenColumns:l}=s,c=gG(e,a),u=!1;for(let g=n;g<n+r;g++)if(l.includes(g)||u)c.push(Xp(s));else{let C=pG(s);C.isRoot=!0,c.push(C),u=!0}})}),e}function pG(o){let{crossHiddenColumns:e,...t}=Gd(o);return t}function gG(o,e){let t;return Array.isArray(o[e])?t=o[e]:(t=[],o[e]=t),t}function oS(o,e,t){CG(o,e),e.set(o,t)}function CG(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qd(o,e,t){var i=E_(o,e,"set");return wG(o,i,t),t}function wG(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function ei(o,e){var t=E_(o,e,"get");return yG(o,t)}function E_(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function yG(o,e){return e.get?e.get.call(o):e.value}var ro=new WeakMap,es=new WeakMap,zn=new WeakMap,Jd=class{constructor(){oS(this,ro,{writable:!0,value:new $d}),oS(this,es,{writable:!0,value:new Xd(ei(this,ro))}),oS(this,zn,{writable:!0,value:[[]]})}setState(e){ei(this,ro).setData(e);let t=!1;try{ei(this,es).buildTree()}catch{ei(this,es).clear(),ei(this,ro).clear(),t=!0}return Qd(this,zn,Zd(ei(this,es).getRoots())),t}setColumnsLimit(e){ei(this,ro).setColumnsLimit(e)}mergeStateWith(e){let t=Ge(e,i=>{let{row:s,...r}=i;return{row:s<0?this.rowCoordsToLevel(s):s,...r}});ei(this,ro).mergeWith(t),ei(this,es).buildTree(),Qd(this,zn,Zd(ei(this,es).getRoots()))}mapState(e){ei(this,ro).map(e),ei(this,es).buildTree(),Qd(this,zn,Zd(ei(this,es).getRoots()))}mapNodes(e){return pt(ei(this,es).getRoots(),(t,i)=>(i.walkDown(s=>{let r=e(s.data);r!==void 0&&t.push(r)}),t),[])}triggerNodeModification(e,t,i){t<0&&(t=this.rowCoordsToLevel(t));let s=ei(this,es).getNode(t,i),r;return s&&(r=S_(e,s,i),Qd(this,zn,Zd(ei(this,es).getRoots()))),r}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;let t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;let t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var i,s;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(s=ei(this,zn)[e])===null||s===void 0?void 0:s[t])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;let i=ei(this,es).getNode(e,t);return i?{...i.data}:null}findLeftMostColumnIndex(e,t){var i;let{isRoot:s}=(i=this.getHeaderSettings(e,t))!==null&&i!==void 0?i:{isRoot:!0};if(s)return t;let r=t-1;for(;r>=0;){var n;let{isRoot:a}=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0};if(a)break;r-=1}return r}getLayersCount(){return ei(this,ro).getLayersCount()}getColumnsCount(){return ei(this,ro).getColumnsCount()}clear(){Qd(this,zn,[]),ei(this,ro).clear(),ei(this,es).clear()}};function ef(o,e,t){return e=vG(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function vG(o){var e=bG(o,"string");return typeof e=="symbol"?e:String(e)}function bG(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var rS=class{constructor(e,t){ef(this,"hot",void 0),ef(this,"nestedHeaderSettingsGetter",void 0),ef(this,"layersCount",0),ef(this,"container",void 0),ef(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);let e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let i=0;i<t;i++){let s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),r=this.hot.toPhysicalColumn(s);this.widthsMap.setValueAtIndex(r,e[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){let{rootDocument:t,columnIndexMapper:i}=this.hot,s=t.createDocumentFragment(),r=t.createElement("table"),n=!!this.hot.getSettings().dropdownMenu,a=i.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){let c=t.createElement("tr");for(let u=0;u<a;u++){let g=i.getVisualFromRenderableIndex(u);g===null&&(g=u);let p=t.createElement("th"),C=this.nestedHeaderSettingsGetter(l,g);if(C&&(!C.isPlaceholder||C.isHidden)){let y=C.label;n&&(y+='<button class="changeType"></button>'),Yi(p,y),p.colSpan=C.colspan,c.appendChild(p)}}r.appendChild(c)}s.appendChild(r),e.appendChild(s)}clear(){this.widthsMap.clear(),this.container=null}},T_=rS;function R_(o,e,t){return e=xG(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function xG(o){var e=SG(o,"string");return typeof e=="symbol"?e:String(e)}function SG(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var i=t.call(o,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}function M_(o,e,t){EG(o,e),e.set(o,t)}function EG(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kp(o,e,t){var i=O_(o,e,"set");return TG(o,i,t),t}function TG(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function Kt(o,e){var t=O_(o,e,"get");return RG(o,t)}function O_(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function RG(o,e){return e.get?e.get.call(o):e.value}var nS="nestedHeaders",A_=280,oi=new WeakMap,Br=new WeakMap,tf=class extends Ye{constructor(){super(...arguments),M_(this,oi,{writable:!0,value:new Jd}),M_(this,Br,{writable:!0,value:null}),R_(this,"ghostTable",new T_(this.hot,(e,t)=>this.getHeaderSettings(e,t))),R_(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return nS}static get PLUGIN_PRIORITY(){return A_}isEnabled(){return!!this.hot.getSettings()[nS]}enablePlugin(){var e=this;if(this.enabled)return;let{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&mt(st`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",function(){return e.onAfterOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterGetColumnHeaderRenderers",i=>this.onAfterGetColumnHeaderRenderers(i)),this.addHook("modifyColWidth",function(){return e.onModifyColWidth(...arguments)}),this.addHook("modifyColumnHeaderValue",function(){return e.onModifyColumnHeaderValue(...arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return e.onBeforeHighlightingColumnHeader(...arguments)}),this.addHook("beforeCopy",function(){return e.onBeforeCopy(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;let{nestedHeaders:e}=this.hot.getSettings();Kt(this,oi).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Kt(this,oi).setState(e)),this.detectedOverlappedHeaders&&mt(st`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,i)=>{let s=t===!0?"hide-column":"show-column";Kt(this,oi).triggerColumnModification(s,i)}),!Kt(this,Br)&&this.enabled&&Kp(this,Br,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(i=>{let{op:s,index:r,newValue:n}=i;if(s==="replace"){let a=n===!0?"hide-column":"show-column";Kt(this,oi).triggerColumnModification(a,r)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Kt(this,oi).clear(),Kt(this,Br).unsubscribe(),Kp(this,Br,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Kt(this,oi)}getLayersCount(){return Kt(this,oi).getLayersCount()}getHeaderSettings(e,t){return Kt(this,oi).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;let{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,s=e.wtOverlays.topOverlay.clone.wtTable.THEAD,r=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let n=0;n<t;n++){let a=i.childNodes[n];if(!a)break;let l=s.childNodes[n],c=r?r.childNodes[n]:null;for(let u=0,g=a.childNodes.length;u<g;u++)a.childNodes[u].removeAttribute("colspan"),je(a.childNodes[u],"hiddenHeader"),l&&l.childNodes[u]&&(l.childNodes[u].removeAttribute("colspan"),je(l.childNodes[u],"hiddenHeader")),r&&c&&c.childNodes[u]&&(c.childNodes[u].removeAttribute("colspan"),je(c.childNodes[u],"hiddenHeader"))}}headerRendererFactory(e){var t=this;let i=this.hot.view._wt.getSetting("fixedColumnsStart");return(s,r)=>{var n;let{columnIndexMapper:a,view:l}=this.hot,c=a.getVisualFromRenderableIndex(s);c===null&&(c=s),r.removeAttribute("colspan"),je(r,"hiddenHeader");let{colspan:u,isHidden:g,isPlaceholder:p}=(n=Kt(this,oi).getHeaderSettings(e,c))!==null&&n!==void 0?n:{label:""};if(p||g)Te(r,"hiddenHeader");else if(u>1){var C,y;let{wtOverlays:S}=l._wt,O=(C=S.topInlineStartCornerOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(r),M=(y=S.inlineStartOverlay)===null||y===void 0?void 0:y.clone.wtTable.THEAD.contains(r),_=O||M?Math.min(u,i-s):u;_>1&&r.setAttribute("colspan",_)}this.hot.view.appendColHeader(c,r,function(){return t.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,t){var i;let{isHidden:s,isPlaceholder:r}=(i=Kt(this,oi).getHeaderSettings(t,e))!==null&&i!==void 0?i:{};return r||s?"":this.hot.getColHeader(e,t)}onBeforeHighlightingColumnHeader(e,t,i){let s=Kt(this,oi).getHeaderTreeNodeData(t,e);if(!s)return e;let{classNames:r,columnCursor:n,selectionType:a,selectionWidth:l}=i,{isRoot:c,colspan:u}=Kt(this,oi).getHeaderSettings(t,e);if(a===Xs){if(!c)return s.columnIndex}else a===yr&&(u>l-n||!c)&&(r.length=0);return e}onBeforeCopy(e,t,i){let{columnHeadersCount:s}=i;if(s!==0)for(let n=0;n<t.length;n++){let{startRow:a,startCol:l,endRow:c,endCol:u}=t[n],g=c-a+1,p=l-u+1;if(a>=0||p===1)break;for(let C=l;C<=u;C++)for(let y=a;y<=c;y++){var r;let S=g+y,O=C-l;if(O===0)continue;((r=Kt(this,oi).getHeaderTreeNodeData(y,C))===null||r===void 0?void 0:r.isRoot)===!1&&(e[S][O]="")}}}onBeforeOnCellMouseDown(e,t,i,s){this._getHeaderTreeNodeDataByCoords(t)&&(s.column=!0)}onAfterOnCellMouseDown(e,t){let i=this._getHeaderTreeNodeDataByCoords(t);if(!i)return;let{selection:s}=this.hot,r=s.isSelected()?s.getSelectedRange().current():null,n=[],{columnIndex:a,origColspan:l}=i,c=!s.inInSelection(t);e.shiftKey&&r?t.col<r.from.col?n.push(r.getTopEndCorner().col,a,t.row):t.col>r.from.col?n.push(r.getTopStartCorner().col,a+l-1,t.row):n.push(a,a+l-1,t.row):(ln(e)||Ni(e)&&c)&&n.push(a,a+l-1,t.row),s.selectColumns(...n)}onBeforeOnCellMouseOver(e,t,i,s){if(!this.hot.view.isMouseDown())return;let r=this._getHeaderTreeNodeDataByCoords(t);if(!r)return;let{columnIndex:n,origColspan:a}=r,l=this.hot.getSelectedRangeLast(),c=l.getTopStartCorner(),u=l.getBottomEndCorner(),{from:g}=l;s.column=!0,s.cell=!0;let p=[];t.col<g.col?p.push(u.col,n):t.col>g.col?p.push(c.col,n+a-1):p.push(n,n+a-1),this.hot.selectColumns(...p)}onAfterGetColumnHeaderRenderers(e){e.length=0;for(let t=0;t<Kt(this,oi).getLayersCount();t++)e.push(this.headerRendererFactory(t))}onAfterViewportColumnCalculatorOverride(e){let t=Kt(this,oi).getLayersCount(),i=e.startColumn,s=!!t;for(let r=0;r<t;r++){let n=Kt(this,oi).findLeftMostColumnIndex(r,e.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(n);if(n>=0&&(s=!1),ii(a)&&a<e.startColumn){i=a;break}}e.startColumn=s?Kt(this,oi).getHeaderTreeNodeData(0,i).columnIndex:i}onModifyColWidth(e,t){let i=this.ghostTable.getWidth(t);return e>i?e:i}onModifyColumnHeaderValue(e,t,i){var s;let{label:r}=(s=Kt(this,oi).getHeaderTreeNodeData(i,t))!==null&&s!==void 0?s:{label:""};return r}onInit(){this.updatePlugin()}onAfterLoadData(e,t){t||this.updatePlugin()}destroy(){Kp(this,oi,null),Kt(this,Br)!==null&&(Kt(this,Br).unsubscribe(),Kp(this,Br,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Kt(this,oi).getHeaderTreeNodeData(e.row,e.col)}};var aS=class{constructor(e,t){this.hot=t,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},ke(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,i){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&we(e.__children,s=>{this.cacheNode(s,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,i,s){let r=!1,n=t;if(isNaN(n)&&n.end)return n;let a=e;return a||(a={__children:this.data},r=!0,n-=1),i!=null&&n===i?{result:a,end:!0}:s!=null&&a===s?{result:n,end:!0}:(n+=1,a.__children&&we(a.__children,l=>{if(this.parentReference.set(l,r?null:a),n=this.readTreeNodes(l,n,i,s),isNaN(n)&&n.end)return!1}),n)}mockParent(){let e=this.mockNode();return e.__children=this.data,e}mockNode(){let e={};return ze(this.data[0],(t,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);let i=this.getRowParent(e);return i==null?this.data.indexOf(t):i.__children.indexOf(t)}countAllRows(){let e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(we(i.__children,s=>{t+=1,s.__children&&(t+=this.countChildren(s))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var i;return((i=e.__children)===null||i===void 0?void 0:i[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((t=i.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let i=t;this.hot.runHooks("beforeAddChild",e,i);let s=null;e&&(s=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",s+this.countChildren(e)+1,1);let r=e;e||(r=this.mockParent()),r.__children||(r.__children=[]),i||(i=this.mockNode()),r.__children.push(i),this.rewriteCache();let n=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(n,1),this.hot.runHooks("afterCreateRow",n,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,t,i){let s=i,r;if(s||(s=this.mockNode()),this.hot.runHooks("beforeAddChild",e,s,t),e){let a=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(t,null,s),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),r=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[t]);s=this.getDataObject(r),this.hot.runHooks("afterAddChild",e,s,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",i=this.translateTrimmedRow(e),s=this.getRowParent(i),r=this.getRowIndexWithinParent(i);switch(t){case"below":this.addChildAtIndex(s,r+1,null);break;case"above":this.addChildAtIndex(s,r,null);break;default:break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null,s=[];Array.isArray(e)?(ke(e[0],e[2],p=>{let C=this.translateTrimmedRow(p);s.push(this.getDataObject(C))}),ke(0,s.length-2,p=>{this.detachFromParent(s[p],!1)}),i=s[s.length-1]):i=e;let r=this.getRowIndex(i),n=this.countChildren(i),a=this.getRowIndexWithinParent(i),l=this.getRowParent(i),c=this.getRowParent(l),u=this.getRowIndex(c),g=null;if(this.hot.runHooks("beforeDetachChild",l,i),a!=null){let p=Array.from(new Array(r+n+1).keys()).splice(-1*(n+1));if(this.hot.runHooks("beforeRemoveRow",r,n+1,p,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",r,n+1,p,this.plugin.pluginName),c){g=u+this.countChildren(c);let C=this.getChild(c,this.countChildren(c)-1),y=this.getRowIndex(C);this.hot.runHooks("beforeCreateRow",y+1,n+1,this.plugin.pluginName),c.__children.push(i)}else g=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",g-2,n+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",g-2,n+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,i,this.getRowIndex(i)),t&&this.hot.render()}filterData(e,t,i){let s=[];we(i,r=>{s.push(this.getDataObject(r))}),we(s,r=>{let n=this.getRowIndexWithinParent(r),a=this.getRowParent(r);a===null?this.data.splice(n,1):a.__children.splice(n,1)}),this.rewriteCache()}spliceData(e,t,i){let s=this.getDataObject(e-1),r=null,n=e;s&&s.__children&&s.__children.length===0?(r=s,n=0):e<this.countAllRows()&&(r=this.getRowParent(e),n=this.getRowIndexWithinParent(e)),r?i?r.__children.splice(n,t,...i):r.__children.splice(n,t):i?this.data.splice(n,t,...i):this.data.splice(n,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,i=null;do i=this.getRowParent(i),i!==null&&(t=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,i,s){let r=t===this.hot.countRows(),n=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=n.__children.slice(a,a+1),c=e>t,u=r?this.getRowParent(t-1):this.getRowParent(t);u==null&&(u=this.getRowParent(t-1)),u==null&&(u=this.getDataObject(t-1)),u?u.__children||(u.__children=[]):(u=this.getDataObject(t),u.__children=[]);let g=r||i||s?u.__children.length:this.getRowIndexWithinParent(t),p=n===u;u.__children.splice(g,0,l[0]),n.__children.splice(a+(c&&p?1:0),1),this.syncRowWithRawSource(n),p||this.syncRowWithRawSource(u)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}},I_=aS;var lS=class{constructor(e,t){this.hot=t,this.plugin=e}},Ml=lS;var hS=class o extends Ml{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){let i=this.hot.toPhysicalRow(e),s=this.dataManager.getRowLevel(i),r=this.dataManager.getDataObject(i),n=t.getElementsByTagName("DIV")[0],a=n.querySelector("span.rowHeader"),l=n.querySelectorAll('[class^="ht_nesting"]');if(we(l,c=>{c&&n.removeChild(c)}),Te(t,o.CSS_CLASSES.indicatorContainer),s){let{rootDocument:c}=this.hot,u=a.cloneNode(!0);n.innerHTML="",ke(0,s-1,()=>{let g=c.createElement("SPAN");Te(g,o.CSS_CLASSES.emptyIndicator),n.appendChild(g)}),n.appendChild(u)}if(this.dataManager.hasChildren(r)){let c=this.hot.rootDocument.createElement("DIV");Te(t,o.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?Te(c,`${o.CSS_CLASSES.button} ${o.CSS_CLASSES.expandButton}`):Te(c,`${o.CSS_CLASSES.button} ${o.CSS_CLASSES.collapseButton}`),n.appendChild(c)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}},Zp=hS;var cS=class extends Ml{constructor(e,t){var i;super(e,t),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,s)},shiftStash:function(s,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;r==null&&(r=1/0),we(i.lastCollapsedRows,(a,l)=>{a>=s&&a<r&&(i.lastCollapsedRows[l]=a+n)})},applyStash:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,s),i.lastCollapsedRows=void 0},trimStash:(s,r)=>{ke(s,s+r-1,n=>{let a=this.lastCollapsedRows.indexOf(n);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],r=null,n=null,a=null;return isNaN(e)?(r=e,n=this.dataManager.getRowIndex(r)):(r=this.dataManager.getDataObject(e),n=e),this.dataManager.hasChildren(r)&&we(r.__children,l=>{s.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(s,!0,!1),i&&this.trimRows(a),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(n)===-1&&this.collapsedRows.push(n),a}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];we(e,r=>{s.push(...this.collapseChildren(r,!1,!1))}),i&&this.trimRows(s),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return we(e,r=>{s.push(r),t&&this.collapseChildRows(r,s)}),i&&this.trimRows(s),s}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){let r=this.dataManager.getDataObject(e);we(r.__children,n=>{let a=this.dataManager.getRowIndex(n);t.push(a),this.collapseChildRows(a,t)})}s&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return we(e,r=>{s.push(r),t&&this.expandChildRows(r,s)}),i&&this.untrimRows(s),s}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){let r=this.dataManager.getDataObject(e);we(r.__children,n=>{if(!this.isAnyParentCollapsed(n)){let a=this.dataManager.getRowIndex(n);t.push(a),this.expandChildRows(a,t)}})}s&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],r=null,n=null,a=null;return isNaN(e)?(r=e,n=this.dataManager.getRowIndex(e)):(r=this.dataManager.getDataObject(e),n=e),this.collapsedRows.splice(this.collapsedRows.indexOf(n),1),this.dataManager.hasChildren(r)&&we(r.__children,l=>{let c=this.dataManager.getRowIndex(l);s.push(c)}),a=this.expandRows(s,!0,!1),i&&this.untrimRows(a),t&&this.renderAndAdjust(),a}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];we(e,r=>{s.push(...this.expandChildren(r,!1,!1))}),i&&this.untrimRows(s),t&&this.renderAndAdjust()}collapseAll(){let e=this.dataManager.getData(),t=[];we(e,i=>{this.dataManager.hasChildren(i)&&t.push(i)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){let e=this.dataManager.getData(),t=[];we(e,i=>{this.dataManager.hasChildren(i)&&t.push(i)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{we(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{we(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&we(t.__children,s=>{let r=this.dataManager.getRowIndex(s);if(!this.plugin.collapsedRowsMap.getValueAtIndex(r))return i=!1,!1}),i}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);let i=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;let i=this.translateTrimmedRow(t.row);Ve(e.target,Zp.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),ni(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}},__=cS;var N_=new WeakMap,uS=class extends Ml{constructor(e,t){super(e,t),N_.set(this,{row_above:(i,s)=>{let r=s[s.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(i,s)=>{let r=s[s.length-1];this.dataManager.addSibling(r.start.row,"below")}}),this.dataManager=this.plugin.dataManager}appendOptions(e){let t=[{key:"add_child",name(){return this.getTranslatedPhrase(jc)},callback:()=>{let i=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),s=this.dataManager.getDataObject(i);this.dataManager.addChild(s)},disabled:()=>{let i=this.hot.getSelectedLast();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Gc)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{let i=this.hot.getSelectedLast(),s=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(s)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return ke(0,e.items.length-1,i=>{if(i===0)return we(t,(s,r)=>{e.items.splice(i+r,0,s)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){let t=N_.get(this);return ke(0,e.items.length-1,i=>{let s=t[e.items[i].key];s!=null&&(e.items[i].callback=s)}),e}},P_=uS;var sf=class{constructor(e){this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,i,s){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:i,movePossible:s}))return!1;this.movedToCollapsed=!1;let n=i===this.hot.countRows(),a=n?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i),l=!0,c=e.map(y=>{if(!l)return!1;let S=this.dataManager.translateTrimmedRow(y);return l=this.shouldAllowMoving(S,a),S}),u=c.indexOf(a)===-1;if(!l||!u)return!1;let g=this.getBaseParent(c),p=this.getTargetParent(n,a),C=g===p;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(p),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,a,C),this.moveRows(c,a,p),this.dataManager.rewriteCache(),this.moveCellsMeta(c,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,i,s,s&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){let{rows:t,finalIndex:i,dropIndex:s,movePossible:r}=e,n=!1;return nt(s)&&(mt(st`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,i,s,r,!1),n=!0),n}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let i=this.dataManager.getRowParent(e?t-1:t);return i==null&&(i=this.dataManager.getRowParent(t-1)),i}shiftCollapsibleParentsLocations(e,t,i){i||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,i){let s=t===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(r=>{this.dataManager.moveRow(r,t,this.movedToCollapsed,s)})})}moveCellsMeta(e,t){let i=[],s=Math.max(...e)<t;e.forEach(r=>{i.push(this.hot.getCellMetaAtRow(r))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(s?i.length:0),0,...i)}selectCells(e,t){let i=e.length,s=0,r=0,n=null,a=null;if(this.movedToCollapsed){let l=null;e[i-1]<t?l=this.dataManager.translateTrimmedRow(t-i):l=this.dataManager.translateTrimmedRow(t);let c=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),u=this.dataManager.getRowIndex(c);s=this.dataManager.untranslateTrimmedRow(u),r=s}else e[i-1]<t?(r=t-1,s=r-i+1):(s=t,r=s+i-1);n=this.hot.selection,a=this.hot.countCols()-1,n.setRangeStart(this.hot._createCellCoords(s,0)),n.setRangeEnd(this.hot._createCellCoords(r,a),!0)}isRowOrderChanged(e,t){return e.some((i,s)=>i-s!==t)}};var Qp="nestedRows",L_=300,$o=new WeakMap,MG="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",of=class extends Ye{static get PLUGIN_KEY(){return Qp}static get PLUGIN_PRIORITY(){return L_}constructor(e){super(e),this.dataManager=null,this.headersUI=null,this.collapsedRowsMap=null,$o.set(this,{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1})}isEnabled(){return!!this.hot.getSettings()[Qp]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new fs),this.dataManager=new I_(this,this.hot),this.collapsingUI=new __(this,this.hot),this.headersUI=new Zp(this,this.hot),this.contextMenuUI=new P_(this,this.hot),this.rowMoveController=new sf(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("beforeViewRender",function(){return e.onBeforeViewRender(...arguments)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){return e.onFilterData(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeRemoveRow",function(){return e.onBeforeRemoveRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("beforeAddChild",function(){return e.onBeforeAddChild(...arguments)}),this.addHook("afterAddChild",function(){return e.onAfterAddChild(...arguments)}),this.addHook("beforeDetachChild",function(){return e.onBeforeDetachChild(...arguments)}),this.addHook("afterDetachChild",function(){return e.onAfterDetachChild(...arguments)}),this.addHook("modifyRowHeaderWidth",function(){return e.onModifyRowHeaderWidth(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("beforeRowMove",function(){return e.onBeforeRowMove(...arguments)}),this.addHook("beforeLoadData",t=>this.onBeforeLoadData(t)),this.addHook("beforeUpdateData",t=>this.onBeforeLoadData(t)),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),super.disablePlugin()}updatePlugin(){this.disablePlugin();let e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}onBeforeRowMove(e,t,i,s){return this.rowMoveController.onBeforeRowMove(e,t,i,s)}disableCoreAPIModifiers(){let e=$o.get(this);e.skipCoreAPIModifiers=!0}enableCoreAPIModifiers(){let e=$o.get(this);e.skipCoreAPIModifiers=!1}onBeforeOnCellMouseDown(e,t,i){this.collapsingUI.toggleState(e,t,i)}onModifyRowData(e){if(!$o.get(this).skipCoreAPIModifiers)return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!$o.get(this).skipCoreAPIModifiers)return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,i){return $o.get(this).skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,i),!1)}onFilterData(e,t,i){let s=$o.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(i[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(i[0],null,-1*t),this.dataManager.filterData(e,t,i),s.skipRender=!0,this.dataManager.getData().slice()}onAfterContextMenuDefaultOptions(e){return this.contextMenuUI.appendOptions(e)}onAfterGetRowHeader(e,t){this.headersUI.appendLevelIndicators(e,t)}onModifyRowHeaderWidth(e){return this.headersUI.rowHeaderWidthCache||e}onAfterRemoveRow(e,t,i,s){if(s===this.pluginName)return;let r=$o.get(this);setTimeout(()=>{r.skipRender=null,this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()},0)}onBeforeRemoveRow(e,t,i){let s=Array.from(i.reduce((r,n)=>{if(this.dataManager.isParent(n)){let a=this.dataManager.getDataObject(n).__children;return r.add(n),Array.isArray(a)&&a.forEach(l=>r.add(this.dataManager.getRowIndex(l))),r}return r.add(n)},new Set));i.length=0,i.push(...s)}onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterAddChild(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterDetachChild(e,t,i){this.collapsingUI.collapsedRowsStash.shiftStash(i,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onAfterCreateRow(){this.dataManager.rewriteCache()}onAfterInit(){let e=Math.max(...this.dataManager.cache.levels);e>0&&this.headersUI.updateRowHeaderWidth(e)}onBeforeViewRender(e,t){$o.get(this).skipRender&&(t.skipRender=!0)}destroy(){super.destroy()}onBeforeLoadData(e){if(!ry(e)){ga(MG),this.hot.getSettings()[Qp]=!1,this.disablePlugin();return}this.dataManager.setData(e),this.dataManager.rewriteCache()}};var dS=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;this.rootWindow=t,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){let i=typeof e>"u"?t:e,s=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return s===null?void 0:JSON.parse(s)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){we(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){let e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}},D_=dS;He.getSingleton().register("persistentStateSave");He.getSingleton().register("persistentStateLoad");He.getSingleton().register("persistentStateReset");var fS="persistentState",k_=0,rf=class extends Ye{static get PLUGIN_KEY(){return fS}static get PLUGIN_PRIORITY(){return k_}constructor(e){super(e),this.storage=void 0}isEnabled(){return!!this.hot.getSettings()[fS]}enablePlugin(){this.enabled||(this.storage||(this.storage=new D_(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}};var Jp="search",H_=190,OG="htSearchResult",AG=function(o,e,t,i,s){o.getCellMeta(e,t).isSearchResult=s},IG=function(o,e,t){return nt(o)||o===null||!o.toLocaleLowerCase||o.length===0||nt(e)||e===null?!1:e.toString().toLocaleLowerCase(t.locale).indexOf(o.toLocaleLowerCase(t.locale))!==-1},nf=class extends Ye{static get PLUGIN_KEY(){return Jp}static get PLUGIN_PRIORITY(){return H_}constructor(e){super(e),this.callback=AG,this.queryMethod=IG,this.searchResultClass=OG}isEnabled(){return this.hot.getSettings()[Jp]}enablePlugin(){var e=this;if(this.enabled)return;let t=this.hot.getSettings()[Jp];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){return e.onBeforeRenderer(...arguments)}),super.enablePlugin()}disablePlugin(){var e=this;let t=function(){return e.onBeforeRenderer(...arguments)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),s=this.hot.countRows(),r=this.hot.countCols(),n=[],a=this.hot;return ke(0,s-1,l=>{ke(0,r-1,c=>{let u=this.hot.getDataAtCell(l,c),g=this.hot.getCellMeta(l,c),p=g.search.callback||t,y=(g.search.queryMethod||i)(e,u,g);if(y){let S={row:l,col:c,data:u};n.push(S)}p&&p(a,l,c,u,y)})}),n}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){$e(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}onBeforeRenderer(e,t,i,s,r,n){let a=n.className||[],l=[];typeof a=="string"?l=a.split(" "):l.push(...a),this.isEnabled()&&n.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),n.className=l.join(" ")}destroy(){super.destroy()}};var F_="touchScroll",B_=200,af=class extends Ye{static get PLUGIN_KEY(){return F_}static get PLUGIN_PRIORITY(){return B_}static get SETTING_KEYS(){return!0}constructor(e){super(e),this.scrollbars=[],this.clones=[],this.lockedCollection=!1,this.freezeOverlays=!1}isEnabled(){return Mh()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>this.onAfterViewRender()),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>this.onBeforeTouchScroll()),this.addHook("afterMomentumScroll",()=>this.onAfterMomentumScroll())}onAfterViewRender(){if(this.lockedCollection)return;let{topOverlay:e,bottomOverlay:t,inlineStartOverlay:i,topInlineStartCornerOverlay:s,bottomInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(i),s&&this.scrollbars.push(s),r&&r.clone&&this.scrollbars.push(r),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),s&&this.clones.push(s.clone.wtTable.holder.parentNode),r&&r.clone&&this.clones.push(r.clone.wtTable.holder.parentNode)}onBeforeTouchScroll(){this.freezeOverlays=!0,we(this.clones,e=>{Te(e,"hide-tween")})}onAfterMomentumScroll(){this.freezeOverlays=!1,we(this.clones,e=>{je(e,"hide-tween"),Te(e,"show-tween")}),this.hot._registerTimeout(()=>{we(this.clones,e=>{je(e,"show-tween")})},400),we(this.scrollbars,e=>{e.refresh(),e.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}};var lf="trimRows",V_=330,hf=class extends Ye{static get PLUGIN_KEY(){return lf}static get PLUGIN_PRIORITY(){return V_}constructor(e){super(e),this.trimmedRowsMap=null}isEnabled(){return!!this.hot.getSettings()[lf]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new fs),this.trimmedRowsMap.addLocalHook("init",()=>this.onMapInit()),super.enablePlugin())}updatePlugin(){let e=this.hot.getSettings()[lf];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),we(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){let t=this.getTrimmedRows(),i=this.isValidConfig(e),s=t;i&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,s,i)!==!1&&(i&&this.hot.batchExecution(()=>{we(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),this.hot.runHooks("afterTrimRow",t,s,i,i&&s.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.trimRows(t)}untrimRows(e){let t=this.getTrimmedRows(),i=this.isValidConfig(e),s=t,r=this.trimmedRowsMap.getValues().slice(),n=e.length>0;i&&n&&(we(e,l=>{r[l]=!1}),s=pt(r,(l,c,u)=>(c&&l.push(u),l),[])),this.hot.runHooks("beforeUntrimRow",t,s,i&&n)!==!1&&(i&&n&&this.trimmedRowsMap.setValues(r),this.hot.runHooks("afterUntrimRow",t,s,i&&n,i&&s.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){let t=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<t)}onMapInit(){let e=this.hot.getSettings()[lf];Array.isArray(e)&&this.hot.batchExecution(()=>{we(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0)}destroy(){super.destroy()}};var W_="undoRedo",U_="undoRedo";function We(o){let e=this;this.instance=o,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,o.addHook("afterChange",function(t,i){let s=t&&t.length;if(!s||!t.find(a=>{let[,,l,c]=a;return l!==c}))return;let n=()=>{let a=t.reduce((c,u)=>(c.push([...u]),c),[]);we(a,c=>{c[1]=o.propToCol(c[1])});let l=s>1?this.getSelected():[[a[0][0],a[0][1]]];return new We.ChangeAction(a,l)};e.done(n,i)}),o.addHook("afterCreateRow",(t,i,s)=>{e.done(()=>new We.CreateRowAction(t,i),s)}),o.addHook("beforeRemoveRow",(t,i,s,r)=>{let n=()=>{let a=o.toPhysicalRow(t),l=Xt(e.instance.getSourceData(a,0,a+i-1,e.instance.countSourceCols()-1));return new We.RemoveRowAction(a,l,o.getSettings().fixedRowsBottom,o.getSettings().fixedRowsTop,o.rowIndexMapper.getIndexesSequence())};e.done(n,r)}),o.addHook("afterCreateCol",(t,i,s)=>{e.done(()=>new We.CreateColumnAction(t,i),s)}),o.addHook("beforeRemoveCol",(t,i,s,r)=>{let n=()=>{let a=e.instance.getSourceDataArray(),l=(e.instance.countCols()+t)%e.instance.countCols(),c=[],u=[],g=[];ke(a.length-1,y=>{let S=[],O=a[y];ke(l,l+(i-1),M=>{S.push(O[o.toPhysicalColumn(M)])}),c.push(S)}),ke(i-1,y=>{g.push(o.toPhysicalColumn(l+y))}),Array.isArray(o.getSettings().colHeaders)&&ke(i-1,y=>{u.push(o.getSettings().colHeaders[o.toPhysicalColumn(l+y)]||null)});let p=o.columnIndexMapper.getIndexesSequence(),C=o.rowIndexMapper.getIndexesSequence();return new We.RemoveColumnAction(l,g,c,u,p,C,o.getSettings().fixedColumnsStart)};e.done(n,r)}),o.addHook("beforeCellAlignment",(t,i,s,r)=>{e.done(()=>new We.CellAlignmentAction(t,i,s,r))}),o.addHook("beforeFilter",t=>{e.done(()=>new We.FiltersAction(t))}),o.addHook("beforeRowMove",(t,i)=>{t!==!1&&e.done(()=>new We.RowMoveAction(t,i))}),o.addHook("beforeMergeCells",(t,i)=>{i||e.done(()=>new We.MergeCellsAction(o,t))}),o.addHook("afterUnmergeCells",(t,i)=>{i||e.done(()=>new We.UnmergeCellsAction(o,t))}),o.addHook("afterInit",()=>{e.init()})}We.prototype.done=function(o,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;let i=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",i,e)===!1)return;let r=o(),n=this.undoneActions.slice();this.doneActions.push(r),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",n),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",n,this.undoneActions.slice())};We.prototype.undo=function(){if(this.isUndoAvailable()){let o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o);let e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice());let t=Xt(e);if(this.instance.runHooks("beforeUndo",t)===!1)return;this.ignoreNewActions=!0;let s=this,r=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",r),e.undo(this.instance,()=>{s.ignoreNewActions=!1,s.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice()),this.instance.runHooks("afterUndo",t)}};We.prototype.redo=function(){if(this.isRedoAvailable()){let o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o);let e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice());let t=Xt(e);if(this.instance.runHooks("beforeRedo",t)===!1)return;this.ignoreNewActions=!0;let s=this,r=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",r),e.redo(this.instance,()=>{s.ignoreNewActions=!1,s.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("afterRedo",t)}};We.prototype.isUndoAvailable=function(){return this.doneActions.length>0};We.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};We.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};We.prototype.isEnabled=function(){return this.enabled};We.prototype.enable=function(){if(this.isEnabled())return;let o=this.instance;this.enabled=!0,_G(o),this.registerShortcuts(),o.addHook("afterChange",Y_)};We.prototype.disable=function(){if(!this.isEnabled())return;let o=this.instance;this.enabled=!1,NG(o),this.unregisterShortcuts(),o.removeHook("afterChange",Y_)};We.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};We.Action=function(){};We.Action.prototype.undo=function(){};We.Action.prototype.redo=function(){};We.ChangeAction=function(o,e){this.changes=o,this.selected=e,this.actionType="change"};Is(We.ChangeAction,We.Action);We.ChangeAction.prototype.undo=function(o,e){let t=Xt(this.changes),i=o.countEmptyRows(!0),s=o.countEmptyCols(!0);for(let r=0,n=t.length;r<n;r++)t[r].splice(3,1);o.addHookOnce("afterChange",e),o.setDataAtCell(t,null,null,"UndoRedo.undo");for(let r=0,n=t.length;r<n;r++){let[a,l]=t[r];o.getSettings().minSpareRows&&a+1+o.getSettings().minSpareRows===o.countRows()&&i===o.getSettings().minSpareRows&&(o.alter("remove_row",parseInt(a+1,10),o.getSettings().minSpareRows),o.undoRedo.doneActions.pop()),o.getSettings().minSpareCols&&l+1+o.getSettings().minSpareCols===o.countCols()&&s===o.getSettings().minSpareCols&&(o.alter("remove_col",parseInt(l+1,10),o.getSettings().minSpareCols),o.undoRedo.doneActions.pop())}o.selectCells(this.selected,!1,!1)};We.ChangeAction.prototype.redo=function(o,e){let t=Xt(this.changes);for(let i=0,s=t.length;i<s;i++)t[i].splice(2,1);o.addHookOnce("afterChange",e),o.setDataAtCell(t,null,null,"UndoRedo.redo"),this.selected&&o.selectCells(this.selected,!1,!1)};We.CreateRowAction=function(o,e){this.index=o,this.amount=e,this.actionType="insert_row"};Is(We.CreateRowAction,We.Action);We.CreateRowAction.prototype.undo=function(o,e){let t=o.countRows(),i=o.getSettings().minSpareRows;this.index>=t&&this.index-i<t&&(this.index-=i),o.addHookOnce("afterRemoveRow",e),o.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};We.CreateRowAction.prototype.redo=function(o,e){o.addHookOnce("afterCreateRow",e),o.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};We.RemoveRowAction=function(o,e,t,i,s){this.index=o,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=t,this.fixedRowsTop=i,this.rowIndexesSequence=s};Is(We.RemoveRowAction,We.Action);We.RemoveRowAction.prototype.undo=function(o,e){let t=o.getSettings(),i=[];t.fixedRowsBottom=this.fixedRowsBottom,t.fixedRowsTop=this.fixedRowsTop,this.data.forEach((s,r)=>{Object.keys(s).forEach(n=>{let a=parseInt(n,10);i.push([this.index+r,isNaN(a)?n:a,s[n]])})}),o.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),o.addHookOnce("afterViewRender",e),o.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),o.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};We.RemoveRowAction.prototype.redo=function(o,e){o.addHookOnce("afterRemoveRow",e),o.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};We.CreateColumnAction=function(o,e){this.index=o,this.amount=e,this.actionType="insert_col"};Is(We.CreateColumnAction,We.Action);We.CreateColumnAction.prototype.undo=function(o,e){o.addHookOnce("afterRemoveCol",e),o.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};We.CreateColumnAction.prototype.redo=function(o,e){o.addHookOnce("afterCreateCol",e),o.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};We.RemoveColumnAction=function(o,e,t,i,s,r,n){this.index=o,this.indexes=e,this.data=t,this.amount=this.data[0].length,this.headers=i,this.columnPositions=s.slice(0),this.rowPositions=r.slice(0),this.actionType="remove_col",this.fixedColumnsStart=n};Is(We.RemoveColumnAction,We.Action);We.RemoveColumnAction.prototype.undo=function(o,e){let t=o.getSettings();t.fixedColumnsStart=this.fixedColumnsStart;let i=this.indexes.slice(0).sort(),s=(c,u,g)=>g[this.indexes.indexOf(i[u])],r=this.data.length,n=[];for(let c=0;c<r;c++)n.push(Ge(this.data[c],s));let a=Ge(this.headers,s),l=[];o.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),we(o.getSourceDataArray(),(c,u)=>{we(i,(g,p)=>{c[g]=n[u][p],l.push([u,g,c[g]])})}),o.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&we(a,(c,u)=>{o.getSettings().colHeaders[i[u]]=c}),o.batchExecution(()=>{o.rowIndexMapper.setIndexesSequence(this.rowPositions),o.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),o.addHookOnce("afterViewRender",e),o.render()};We.RemoveColumnAction.prototype.redo=function(o,e){o.addHookOnce("afterRemoveCol",e),o.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};We.CellAlignmentAction=function(o,e,t,i){this.stateBefore=o,this.range=e,this.type=t,this.alignment=i};We.CellAlignmentAction.prototype.undo=function(o,e){we(this.range,t=>{t.forAll((i,s)=>{i>=0&&s>=0&&o.setCellMeta(i,s,"className",this.stateBefore[i][s]||" htLeft")})}),o.addHookOnce("afterViewRender",e),o.render()};We.CellAlignmentAction.prototype.redo=function(o,e){Zs(this.range,this.type,this.alignment,(t,i)=>o.getCellMeta(t,i),(t,i,s,r)=>o.setCellMeta(t,i,s,r)),o.addHookOnce("afterViewRender",e),o.render()};We.FiltersAction=function(o){this.conditionsStack=o,this.actionType="filter"};Is(We.FiltersAction,We.Action);We.FiltersAction.prototype.undo=function(o,e){let t=o.getPlugin("filters");o.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),t.filter()};We.FiltersAction.prototype.redo=function(o,e){let t=o.getPlugin("filters");o.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack),t.filter()};var mS=class extends We.Action{constructor(e,t){super(),this.cellRange=t;let i=this.cellRange.getTopStartCorner(),s=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(i.row,i.col,s.row,s.col)}undo(e,t){let i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.unmergeRange(this.cellRange,!0);let s=this.cellRange.getTopStartCorner();e.populateFromArray(s.row,s.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){let i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.mergeRange(this.cellRange)}};We.MergeCellsAction=mS;var pS=class extends We.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){let i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.mergeRange(this.cellRange,!0)}redo(e,t){let i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.unmergeRange(this.cellRange,!0),e.render()}};We.UnmergeCellsAction=pS;We.RowMoveAction=function(o,e){this.rows=o.slice(),this.finalIndex=e,this.actionType="row_move"};Is(We.RowMoveAction,We.Action);We.RowMoveAction.prototype.undo=function(o,e){let t=o.getPlugin("manualRowMove"),i=[].concat(this.rows),s=i.filter(a=>a>this.finalIndex),r=i.filter(a=>a<=this.finalIndex),n=s.sort((a,l)=>l-a).concat(r.sort((a,l)=>a-l));o.addHookOnce("afterViewRender",e);for(let a=0;a<n.length;a+=1){let l=o.toVisualRow(n[a]);t.moveRow(l,n[a])}o.render(),o.deselectCell(),o.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};We.RowMoveAction.prototype.redo=function(o,e){let t=o.getPlugin("manualRowMove");o.addHookOnce("afterViewRender",e),t.moveRows(this.rows.slice(),this.finalIndex),o.render(),o.deselectCell(),o.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};We.prototype.init=function(){let o=this.instance.getSettings().undo,e=typeof o>"u"||o;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};We.prototype.registerShortcuts=function(){let e=this.instance.getShortcutManager().getContext("grid"),i={runOnlyIf:s=>!s.altKey,group:W_};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)};We.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(W_)};function Y_(o,e){let t=this;if(e==="loadData")return t.undoRedo.clear()}function _G(o){o.undo=function(){return o.undoRedo.undo()},o.redo=function(){return o.undoRedo.redo()},o.isUndoAvailable=function(){return o.undoRedo.isUndoAvailable()},o.isRedoAvailable=function(){return o.undoRedo.isRedoAvailable()},o.clearUndo=function(){return o.undoRedo.clear()}}function NG(o){delete o.undo,delete o.redo,delete o.isUndoAvailable,delete o.isRedoAvailable,delete o.clearUndo}var cf=He.getSingleton();cf.add("afterUpdateSettings",function(){var o;(o=this.getPlugin("undoRedo"))===null||o===void 0||o.init()});cf.register("beforeUndo");cf.register("afterUndo");cf.register("beforeRedo");cf.register("afterRedo");We.PLUGIN_KEY=U_;We.SETTING_KEYS=!0;var gS=We;function j_(){yt(Yu),yt(ju),yt(zu),yt($u),yt(Xu),yt(In),yt(ed),yt(od),yt(sl),yt(dd),yt(md),yt(pd),yt(ul),yt(gd),yt(Ed),yt(Od),yt(Id),yt(Nd),yt(Ld),yt(Dd),yt(Hd),yt(Fd),yt(Vd),yt(Ud),yt(Yd),yt(jd),yt(tf),yt(of),yt(rf),yt(nf),yt(af),yt(hf),yt(gS)}function G_(){MA(),NA(),DA(),kA(),j_()}function CS(o){let e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(t){let i=this.first(),s=i.data("handsontable");if(typeof t!="string"){let c=t||{};return s?s.updateSettings(c):(s=new o.Core(i[0],c),i.data("handsontable",s),s.init()),i}let r;if(s)if(typeof s[t]<"u"){for(var n=arguments.length,a=new Array(n>1?n-1:0),l=1;l<n;l++)a[l-1]=arguments[l];r=s[t].call(s,...a),t==="destroy"&&i.removeData()}else throw new Error(`Handsontable do not provide action: ${t}`);return r})}var wS,yS,vS,bS,xS;G_();CS(gt);gt.__GhostTable=Za;gt._getListenersCounter=MM;gt._getRegisteredMapsCounter=hy;gt.EventManager=tt;var PG=[FC,lw,ny,sv,Bw,iw,YC,xw,ow,jC,uw,vw],LG=[ew,dw];gt.helper={};gt.dom={};we(PG,o=>{we(Object.getOwnPropertyNames(o),e=>{e.charAt(0)!=="_"&&(gt.helper[e]=o[e])})});we(LG,o=>{we(Object.getOwnPropertyNames(o),e=>{e.charAt(0)!=="_"&&(gt.dom[e]=o[e])})});gt.cellTypes=(wS=gt.cellTypes)!==null&&wS!==void 0?wS:{};we(dA(),o=>{gt.cellTypes[o]=Mu(o)});gt.cellTypes.registerCellType=Pi;gt.cellTypes.getCellType=Mu;gt.editors=(yS=gt.editors)!==null&&yS!==void 0?yS:{};we(RM(),o=>{gt.editors[`${$t(o)}Editor`]=wa(o)});gt.editors.registerEditor=gi;gt.editors.getEditor=wa;gt.renderers=(vS=gt.renderers)!==null&&vS!==void 0?vS:{};we(HM(),o=>{let e=ba(o);o==="base"&&(gt.renderers.cellDecorator=e),gt.renderers[`${$t(o)}Renderer`]=e});gt.renderers.registerRenderer=Gi;gt.renderers.getRenderer=ba;gt.validators=(bS=gt.validators)!==null&&bS!==void 0?bS:{};we(FM(),o=>{gt.validators[`${$t(o)}Validator`]=Th(o)});gt.validators.registerValidator=Ro;gt.validators.getValidator=Th;gt.plugins=(xS=gt.plugins)!==null&&xS!==void 0?xS:{};we(va(),o=>{gt.plugins[o]=un(o)});gt.plugins[`${$t(Ye.PLUGIN_KEY)}Plugin`]=Ye;gt.plugins.registerPlugin=yt;gt.plugins.getPlugin=un;var SS=gt;var DS=ri(z_()),df=ri(X_()),lN=ri(q_()),hN=ri(K_()),cN=ri(Z_()),uN=ri(Q_());lN.default(df);hN.default(df);cN.default(df);function DG(o){switch(o){case 1:return"blue";case 2:return"orange";case 3:return"red";default:return"black"}}function kG(o){switch(o){case 1:return"blue";case 2:return"#be5504";case 3:return"#e3242b";default:return"black"}}function dN(o){return(o&8)==8}function AS(o){return(o&2)==2}function IS(o){return(o&4)==4}var HG=2e3,J_=2.66,FG=3.268,RS=.1,BG=2,VG=2,WG=4,eN="rgb(87 83 78)",kS={avgX:0,LNPL:1/0,UNPL:-1/0,avgMovement:0,URL:-1/0},_e={tableData:[],lockedLimitBaseData:[],xLabel:"Date",yLabel:"Value",xdata:[],movements:[],dividerLines:[],lockedLimits:structuredClone(kS),lockedLimitStatus:0},ai,Fi;function tN(o,e){let t=!1;if(o.length<8)return;let i=0;for(let s=0;s<7;s++)o[s].value>e&&(i|=1<<s%8);for(let s=7;s<o.length;s++)if(o[s].value>e?i|=1<<s%8:i&=~(1<<s%8),i==0||i==255)for(let r=s-7;r<=s;r++)o[r].status=1,t=!0}function iN(o,e,t){let i=!1;if(o.length<4)return;let s=0,r=0;for(let n=0;n<3;n++)o[n].value<e?s+=1:o[n].value>t&&(r+=1);for(let n=3;n<o.length;n++){if(o[n].value<e?s+=1:o[n].value>t&&(r+=1),s>=3||r>=3)for(let a=n-3;a<=n;a++)o[a].status=2,i=!0;o[n-3].value<e?s-=1:o[n-3].value>t&&(r-=1)}}function rg(o,e,t){let i=!1;o.forEach(s=>{(s.value<e||s.value>t)&&(s.status=3,i=!0)})}function _S(o){return{type:"line",color:eN,name:"",data:o,dataLabels:{enabled:!0,style:{color:eN}},marker:{symbol:"circle"}}}function UG(o,e){function t(i,s){let r={chart:{type:"line",scrollablePlotArea:{minWidth:600},plotBackgroundImage:"../xmrit-bg.png"},time:{useUTC:!1},title:{text:i===o?FS():BS(),useHTML:!0},plotOptions:{series:{stickyTracking:!1}},series:NS(s).map(_S),yAxis:{title:{text:`<div class="axis-label-y">${_e.yLabel}</div>`,useHTML:!0},gridLineWidth:0},xAxis:{type:"datetime",title:{text:_e.xLabel},maxPadding:.2,events:{setExtremes:function(n){n.trigger==="zoom"&&!n.min&&!n.max&&setTimeout(no,1)}}},legend:{enabled:!1},credits:{enabled:!1},exporting:{buttons:{contextButton:{enabled:!1,menuItems:["downloadPNG","downloadJPEG","downloadSVG"]}},fallbackToExportServer:!1,allowHTML:!0}};return df.chart(i,r)}Al(_e.xdata,_e.tableData.filter(i=>i.x&&(i.value||i.value==0))),Al(_e.movements,HS(_e.xdata)),ai=t(o,[_e.xdata]),Fi=t(e,[_e.movements]),_e.dividerLines=_e.dividerLines.filter(i=>!VS(i)).concat([{id:"divider-start",x:ai.xAxis[0].min,line:null},{id:"divider-end",x:Math.min(ai.xAxis[0].max,Fi.xAxis[0].max||1/0),line:null}]),_e.dividerLines.forEach(fN),no()}function YG(o,e=!0){ai.update({series:NS(o.xdataPerRange).map(_S)},e,!0),Fi.update({series:NS(o.movementsPerRange).map(_S)},e,!0)}function NS(o){return o.map(e=>e.map(t=>({x:$n(t.x),y:t.value,color:DG(t.status),dataLabels:{style:{color:kG(t.status),textOutline:0}}})))}function jG(){let o=_e.dividerLines.length-2;if(o>=3)return;let e=ai.xAxis[0].toValue(ai.plotWidth*(o+1)/4);e%10&&(e+=1);let t={id:`divider-${o+1}`,x:e,line:null};_e.dividerLines.push(t),fN(t)}function GG(){_e.dividerLines.length>2?document.querySelector("#remove-divider").classList.remove("text-slate-400"):document.querySelector("#remove-divider").classList.add("text-slate-400"),_e.dividerLines.length<5?(document.querySelector("#add-divider").classList.remove("bg-slate-700"),document.querySelector("#add-divider").classList.remove("hover:bg-slate-600")):(document.querySelector("#add-divider").classList.add("bg-slate-700"),document.querySelector("#add-divider").classList.add("hover:bg-slate-600"))}function no(o=!0){let e=XG();return YG(e,o),zG(e,o),GG(),e}function fN(o){VS(o)||(no(!1),ai.removeAnnotation(o.id),o.line=ai.addAnnotation({id:o.id,animation:{defer:0},events:{afterUpdate:function(e){for(let t of _e.dividerLines)if(t.line==e.target){t.x=e.target.options.shapes[0].points[0].x;break}no()}},shapes:[{points:[{x:o.x,y:-9e15,xAxis:0,yAxis:0},{x:o.x,y:9e15,xAxis:0,yAxis:0}],type:"path",stroke:"purple",strokeWidth:WG}],draggable:"x",zIndex:2},!1),ai.redraw(!0),Fi.redraw(!0))}function zG(o,e=!0){function t(r){return{point:r.points[1],shape:"connector",align:"left"}}let i=[],s=[];for(let r=0;r<o.lineValues.length;r++){let n=o.lineValues[r];r==o.lineValues.length-1&&(n.xRight=n.xRight+Math.max(86400*1e3,(Math.min(ai.xAxis[0].max,Fi.xAxis[0].max)-n.xRight)/5));let a=VG,l="red",c="steelblue",u="ShortDash",g={useUpperQuartile:!0,useLowerQuartile:!0};if(r==0&&Vr()&&(g=CN(),_e.lockedLimits.xLeft=n.xLeft,_e.lockedLimits.xRight=n.xRight,n=_e.lockedLimits,a=3,u="Solid"),g.useLowerQuartile){let M={points:[{x:n.xLeft,y:n.lowerQuartile,xAxis:0,yAxis:0},{x:n.xRight,y:n.lowerQuartile,xAxis:0,yAxis:0}],type:"path",dashStyle:"Dot",strokeWidth:1};i.push(M)}if(g.useUpperQuartile){let M={points:[{x:n.xLeft,y:n.upperQuartile,xAxis:0,yAxis:0},{x:n.xRight,y:n.upperQuartile,xAxis:0,yAxis:0}],type:"path",dashStyle:"Dot",strokeWidth:1};i.push(M)}let p={points:[{x:n.xLeft,y:n.avgX,xAxis:0,yAxis:0},{x:n.xRight,y:n.avgX,xAxis:0,yAxis:0}],type:"path",dashStyle:u,stroke:l,strokeWidth:a},C={points:[{x:n.xLeft,y:n.LNPL,xAxis:0,yAxis:0},{x:n.xRight,y:n.LNPL,xAxis:0,yAxis:0}],type:"path",dashStyle:u,stroke:c,strokeWidth:a},y={points:[{x:n.xLeft,y:n.UNPL,xAxis:0,yAxis:0},{x:n.xRight,y:n.UNPL,xAxis:0,yAxis:0}],type:"path",dashStyle:u,stroke:c,strokeWidth:a};i.push(p,C,y);let S={points:[{x:n.xLeft,y:n.avgMovement,xAxis:0,yAxis:0},{x:n.xRight,y:n.avgMovement,xAxis:0,yAxis:0}],type:"path",dashStyle:u,stroke:l,strokeWidth:a},O={points:[{x:n.xLeft,y:n.URL,xAxis:0,yAxis:0},{x:n.xRight,y:n.URL,xAxis:0,yAxis:0}],type:"path",dashStyle:u,stroke:c,strokeWidth:a};s.push(S,O)}ai.yAxis[0].setExtremes(o.xchartMin-(o.xchartMax-o.xchartMin)*RS,o.xchartMax+(o.xchartMax-o.xchartMin)*RS,!1),Fi.yAxis[0].setExtremes(0,(1+RS)*o.mrchartMax,!1),ai.removeAnnotation("limit-lines"),ai.addAnnotation({id:"limit-lines",animation:{defer:0},draggable:"",shapes:i,labels:i.map(r=>t(r)).slice(-3),zIndex:1},!1),Fi.removeAnnotation("limit-lines"),Fi.addAnnotation({id:"limit-lines",animation:{defer:0},draggable:"",shapes:s,labels:s.map(r=>t(r)).slice(-2),zIndex:1},!1),ai.redraw(e),Fi.redraw(e)}function $G(){let o=`divider-${_e.dividerLines.length-2}`;ai.removeAnnotation(o),_e.dividerLines=_e.dividerLines.filter(e=>e.id!=o),no()}function XG(){let o=_e.dividerLines;o.sort((n,a)=>n.x-a.x),console.assert(o.length>=2,"dividerLines should contain at least two divider lines"),Al(_e.xdata,_e.tableData.filter(n=>n.x&&(n.value||n.value==0)));let{min:e,max:t}=ez(_e.xdata);o[0].x=e,o[o.length-1].x=t;let i={xchartMin:1/0,xchartMax:-1/0,mrchartMax:-1/0,lineValues:[],xdataPerRange:[],movementsPerRange:[]},s=[],r=[];for(let n=0;n<o.length-1;n++){let a=o[n].x,l=o[n+1].x,c=_e.xdata.filter(N=>$n(N.x)>=a&&$n(N.x)<=l),u=HS(c);if(c.length===0){console.log(`No data in range ${a} - ${l}`);continue}let{avgX:g,avgMovement:p,UNPL:C,LNPL:y,URL:S,lowerQuartile:O,upperQuartile:M}=pN(c),_={xLeft:a,xRight:l,avgX:g,avgMovement:p,UNPL:C,LNPL:y,URL:S,lowerQuartile:O,upperQuartile:M};if(i.lineValues.push(_),i.xchartMin=Math.min(i.xchartMin,y),i.xchartMax=Math.max(i.xchartMax,C),i.mrchartMax=Math.max(i.mrchartMax,S),c.forEach(N=>N.status=0),n==0&&Vr()){let N=CN();tN(c,_e.lockedLimits.avgX),iN(c,N.useLowerQuartile?_e.lockedLimits.lowerQuartile:-1/0,N.useUpperQuartile?_e.lockedLimits.upperQuartile:1/0),rg(c,_e.lockedLimits.LNPL,_e.lockedLimits.UNPL)}else tN(c,g),iN(c,O,M),rg(c,y,C);s=s.concat(c),i.xdataPerRange.push(c),u.forEach(N=>N.status=0),n==0&&Vr()?rg(u,0,_e.lockedLimits.URL):rg(u,0,S),r=r.concat(u),i.movementsPerRange.push(u)}return Al(_e.xdata,s),Al(_e.movements,r),_e.xdata.forEach(n=>{n.value>i.xchartMax&&(i.xchartMax=n.value),n.value<i.xchartMin&&(i.xchartMin=n.value)}),_e.movements.forEach(n=>{n.value>i.mrchartMax&&(i.mrchartMax=n.value)}),Vr()&&(i.xchartMax=Math.max(i.xchartMax,_e.lockedLimits.UNPL),i.xchartMin=Math.min(i.xchartMin,_e.lockedLimits.LNPL),i.mrchartMax=Math.max(i.mrchartMax,_e.lockedLimits.URL)),i}function qG(o,e=","){let t="",i="",s=0,r=[],n=o.indexOf(`\r
`);if(n==-1){let c=document.getElementById("file-error");return c.style.display="block",c.innerText="Missing CSV labels and/or data.",{passed:!1,multiplier:s,xLabel:t,yLabel:i,xdata:r}}let a=o.slice(0,n).split(e);if(a.length<2){let c=document.getElementById("file-error");return c.style.display="block",c.innerText="First row of CSV must have 2 columns.",{passed:!1,multiplier:s,xLabel:t,yLabel:i,xdata:r}}else if(a[0]===""||a[1]===""){let c=document.getElementById("file-error");return c.style.display="block",c.innerText="Missing CSV label(s).",{passed:!1,multiplier:s,xLabel:t,yLabel:i,xdata:r}}else if(a[0].toLowerCase()!="date"){let c=document.getElementById("file-error");return c.style.display="block",c.innerText="First column of CSV must be 'Date'.",{passed:!1,multiplier:s,xLabel:t,yLabel:i,xdata:r}}t="Date",i=a[1];let l=o.slice(n+2).split(`\r
`);if(l.length==0){let c=document.getElementById("file-error");return c.style.display="block",c.innerText="Missing CSV data.",{passed:!1,multiplier:s,xLabel:t,yLabel:i,xdata:r}}for(let c=0;c<l.length;c++){let u=l[c].split(e);if(u[0]===""||u[1]==="")if(l.slice(c+1).join(e).replace(/,/g,"")!==""){let y=document.getElementById("file-error");return y.style.display="block",y.innerText="Fragmented CSV data.",{passed:!1,multiplier:0,xLabel:t,yLabel:i,xdata:r}}else return{passed:!0,multiplier:s,xLabel:t,yLabel:i,xdata:r};if(!Date.parse(u[0])){let C=document.getElementById("file-error");return C.style.display="block",C.innerText="Please input date in YYYY-MM-DD format (if on Excel, change date format settings).",{passed:!1,multiplier:s,xLabel:t,yLabel:i,xdata:r}}let p=Number(u[1]);if(isNaN(p)){let C=document.getElementById("file-error");return C.style.display="block",C.innerText="Values must be numbers.",{passed:!1,multiplier:s,xLabel:t,yLabel:i,xdata:r}}else{for(;Math.abs(p)/10**s>=1e4;)s+=3;r.push({order:c,x:u[0],value:p,status:0})}}return{passed:!0,multiplier:s,xLabel:t,yLabel:i,xdata:r}}function HS(o){let e=[];for(let t=1;t<o.length;t++){let i=Ii(Math.abs(o[t].value-o[t-1].value));e.push({order:o[t].order,x:o[t].x,value:i})}return e}var KG=window.matchMedia("(max-width: 767px)");KG.addEventListener("change",o=>{no()});screen.orientation.addEventListener("change",o=>{no()});var ng,sN;function PS(){let o=e=>{let t=prompt("Insert a new column name",_e.yLabel);if(t){let i=ng.getColHeader();i[1]=t,_e.yLabel=t,ng.updateSettings({colHeaders:i}),ai.update({yAxis:{title:{text:Ol(t),useHTML:!0}},title:{text:FS(),useHTML:!0}}),Fi.update({yAxis:{title:{text:Ol(t),useHTML:!0}},title:{text:BS(),useHTML:!0}}),PS()}};document.querySelectorAll(".axis-label-y").forEach(e=>e.addEventListener("click",o)),document.querySelectorAll(".plot-title").forEach(e=>e.addEventListener("click",o))}function mN(){let o=new URLSearchParams(window.location.search);return o.has("d")?o:new URLSearchParams(window.location.hash.slice(1))}document.addEventListener("DOMContentLoaded",async function(o){let e=mN();if(e.has("d")){let s=e.get("v")||"0",r=e.get("s")||"",n=e.get("l")||"",{xLabel:a,yLabel:l,data:c,dividerLines:u,lockedLimits:g,lockedLimitStatus:p}=await JG(s,e.get("d"),r,n);_e.xLabel=a,_e.yLabel=l,_e.tableData=c,_e.dividerLines=u,_e.lockedLimits=g,_e.lockedLimitStatus=p}else{let r=[5045,4350,4350,3975,4290,4430,4485,4285,3980,3925,3645,3760,3300,3685,3463,5200].map(function(n,a){return{order:a,x:`2020-01-${(a<9?"0":"")+(a+1)}`,value:n,status:0}});_e.tableData=r}_e.lockedLimitBaseData=LS(_e.tableData),uf(),document.querySelector("#add-divider").addEventListener("click",jG),document.querySelector("#remove-divider").addEventListener("click",$G),document.querySelector("#export-xplot").addEventListener("click",()=>{uf(),ai.exportChartLocal({filename:"xplot"})}),document.querySelector("#export-mrplot").addEventListener("click",()=>{uf(),Fi.exportChartLocal({filename:"mrplot"})}),PS(),Vr()&&(document.querySelectorAll(".lock-limit-remove").forEach(s=>s.classList.remove("hidden")),document.querySelector("#lock-limit-warning").classList.remove("hidden")),document.querySelector("#lock-limit-btn").addEventListener("click",s=>{Vr()||(Al(_e.lockedLimitBaseData,_e.tableData),sN.updateSettings({data:_e.lockedLimitBaseData,colHeaders:[_e.xLabel,_e.yLabel]})),oN(!Vr()),document.querySelector("#lock-limit-dialog").showModal()}),document.querySelector("#lock-limit-close").addEventListener("click",s=>{document.querySelector("#lock-limit-dialog").close()}),document.querySelectorAll(".lock-limit-remove").forEach(s=>s.addEventListener("click",r=>{ai.removeAnnotation("locked-limits"),Fi.removeAnnotation("locked-limits"),s.classList.add("hidden"),document.querySelector("#lock-limit-warning").classList.add("hidden"),_e.lockedLimitStatus&=-2,no(),document.querySelector("#lock-limit-dialog").close()})),document.querySelector("#lock-limit-add").addEventListener("click",s=>{let r=gN(),n=structuredClone(kS);if(document.querySelectorAll(".lock-limit-input").forEach(l=>{n[l.dataset.limit]=l.value!==""?Number(l.value):r[l.dataset.limit]}),n.lowerQuartile=Ii((n.avgX+n.LNPL)/2),n.upperQuartile=Ii((n.avgX+n.UNPL)/2),n.avgX<n.LNPL||n.avgX>n.UNPL||n.avgMovement>n.URL){alert(`Please ensure that the following limits are satisfied:
1. Average X is between Lower Natural Process Limit (LNPL) and Upper Natural Process Limit (UNPL)
2. Average Movement is less than or equal to Upper Range Limit (URL)`);return}r.avgX!=n.avgX&&(_e.lockedLimitStatus|=8),r.LNPL!=n.LNPL&&(_e.lockedLimitStatus|=4),r.UNPL!=n.UNPL&&(_e.lockedLimitStatus|=2),_e.lockedLimits=n,_e.lockedLimitStatus|=1,no(),document.querySelector("#lock-limit-dialog").close(),document.querySelectorAll(".lock-limit-remove").forEach(l=>l.classList.remove("hidden")),document.querySelector("#lock-limit-warning").classList.remove("hidden")}),sN=new SS(document.querySelector("#lock-limit-dataTable"),{data:_e.lockedLimitBaseData,dataSchema:{x:null,value:null},columns:[{data:"x",type:"date",dateFormat:"YYYY-MM-DD",validator:(s,r)=>{if(!s){r(!0);return}let n=new Date($n(s));r(n instanceof Date&&!isNaN(n.getTime()))}},{data:"value",type:"numeric"}],colHeaders:[_e.xLabel,_e.yLabel],contextMenu:!0,allowRemoveColumn:!1,minSpareRows:1,height:"auto",stretchH:"all",fillHandle:{autoInsertRow:!0,direction:"vertical"},beforeAutofill(s,r,n,a){return rN(s,r,n,a)},beforePaste(s,r){return nN(s,r)},afterChange(s,r){r!=="loadData"&&oN(!0)},afterValidate(s,r,n,a,l){let c=document.getElementById("data-table-error");if(s){c.classList.add("hidden");return}return c.classList.remove("hidden"),!1},licenseKey:"non-commercial-and-evaluation"});let t=document.getElementById("csv-file");t.addEventListener("change",s=>{if(!t.files?.length){console.log("No file input");return}let r=t.files[0],n=new FileReader;n.addEventListener("loadend",()=>{let a=n.result,{passed:l,multiplier:c,xLabel:u,yLabel:g,xdata:p}=qG(a);if(!l)return;console.log(l,c,u,g,p);let C="\u2070\xB9\xB2\xB3\u2074\u2075\u2076\u2077\u2078\u2079";function y(O){return O.toString().split("").map(function(M){return C[Number(M)]}).join("")}if(c>0){g+=` (x10${y(c)})`;for(let O=0;O<p.length;O++)p[O].value/=10**c}let S=document.getElementById("file-error");S.style.display="none",S.innerText="",_e.xLabel=u,_e.yLabel=g,_e.tableData=p,_e.lockedLimitBaseData=LS(_e.tableData),ng.updateSettings({data:p,colHeaders:[u,g]}),_e.dividerLines=[],uf()}),n.readAsText(r)}),document.querySelector("#download-data").addEventListener("click",()=>{let s=`${_e.xLabel},${_e.yLabel}\r
`+_e.xdata.filter(l=>l.x||l.value).map(l=>`${l.x||""},${Ii(l.value)||""}`).join(`\r
`);Vr()&&(s+=`\r
\r
limit_lines,value\r
`+[`avg_x,${_e.lockedLimits.avgX}`,`LNPL,${_e.lockedLimits.LNPL}`,`UNPL,${_e.lockedLimits.UNPL}`,`avg_movement,${_e.lockedLimits.avgMovement}`,`URL,${_e.lockedLimits.URL}`].join(`\r
`));let r=new Blob([s],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(r),a=document.createElement("a");a.setAttribute("href",n),a.setAttribute("download","xmr-data.csv"),a.click(),a.remove(),URL.revokeObjectURL(n)}),document.querySelector("#refresh-charts").addEventListener("click",()=>{uf()}),document.querySelector("#share-link").addEventListener("click",()=>{let s=QG(_e);if(s.length>HG){alert("Link too long! Consider removing a few datapoints.");return}navigator.clipboard.writeText(s).then(function(){console.log("Async: Copying to clipboard was successful!")},function(r){console.error("Async: Could not copy text: ",r)}),document.getElementById("data-copied-msg").classList.remove("hidden"),setTimeout(()=>{document.getElementById("data-copied-msg").classList.add("hidden")},2e3)});let i=document.querySelector("#dataTable");ng=new SS(i,{data:_e.tableData,dataSchema:{x:null,value:null},columns:[{data:"x",type:"date",dateFormat:"YYYY-MM-DD",validator:(s,r)=>{if(!s){r(!0);return}let n=new Date($n(s));r(n instanceof Date&&!isNaN(n.getTime()))}},{data:"value",type:"numeric"}],colHeaders:[_e.xLabel??"Date",_e.yLabel==="Value"?"Value (\u270F\uFE0F)":_e.yLabel],afterOnCellMouseDown:function(s,r){if(r.row!==-1)return;let n=prompt("Insert a new column name",this.getColHeader()[r.col]);if(n){let a=this.getColHeader();a[r.col]=n,this.updateSettings({colHeaders:a}),r.col==0?(_e.xLabel=n,ai.update({xAxis:{title:{text:Ol(n),useHTML:!0}}}),Fi.update({xAxis:{title:{text:Ol(n),useHTML:!0}}})):(_e.yLabel=n,ai.update({yAxis:{title:{text:Ol(n),useHTML:!0}},title:{text:FS(),useHTML:!0}}),Fi.update({yAxis:{title:{text:Ol(n),useHTML:!0}},title:{text:BS(),useHTML:!0}})),PS()}},contextMenu:!0,allowRemoveColumn:!1,minSpareRows:1,height:"auto",stretchH:"all",fillHandle:{autoInsertRow:!0,direction:"vertical"},beforeAutofill(s,r,n,a){return rN(s,r,n,a)},beforePaste(s,r){return nN(s,r)},beforeChange(s,r){let n=_e.xdata.map(a=>a.x);s.forEach(([a,l,c,u])=>{l=="x"&&(n[a]=u)}),ZG(n,this)},afterChange(s,r){r!="loadData"&&no()},afterValidate(s,r,n,a,l){let c=document.getElementById("data-table-error");if(s){c.classList.add("hidden");return}return c.classList.remove("hidden"),!1},licenseKey:"non-commercial-and-evaluation"})});function pN(o){let e=HS(o),t=o.reduce((c,u)=>c+u.value,0)/o.length,i=e.reduce((c,u)=>c+u.value,0)/Math.max(e.length,1),s=t+J_*i,r=t-J_*i,n=FG*i,a=(r+t)/2,l=(s+t)/2;return{avgX:Ii(t),avgMovement:Ii(i),UNPL:Ii(s),LNPL:Ii(r),URL:Ii(n),lowerQuartile:Ii(a),upperQuartile:Ii(l)}}function gN(){let o=_e.lockedLimitBaseData.filter(e=>e.x&&(e.value||e.value==0));return pN(o)}function oN(o){let e=gN();document.querySelectorAll(".lock-limit-input").forEach(t=>{t.value=o?e[t.dataset.limit]:_e.lockedLimits[t.dataset.limit]}),o&&(_e.lockedLimitStatus&=-9,_e.lockedLimitStatus&=-5,_e.lockedLimitStatus&=-3),document.querySelector('.lock-limit-input[data-limit="avgX"]').style.color=dN(_e.lockedLimitStatus)?"rgb(220 38 38)":"black",document.querySelector('.lock-limit-input[data-limit="avgX"]').placeholder=`${e.avgX}`,document.querySelector('.lock-limit-input[data-limit="UNPL"]').style.color=AS(_e.lockedLimitStatus)?"rgb(220 38 38)":"black",document.querySelector('.lock-limit-input[data-limit="UNPL"]').placeholder=`${e.UNPL}`,document.querySelector('.lock-limit-input[data-limit="LNPL"]').style.color=IS(_e.lockedLimitStatus)?"rgb(220 38 38)":"black",document.querySelector('.lock-limit-input[data-limit="LNPL"]').placeholder=`${e.LNPL}`,document.querySelector('.lock-limit-input[data-limit="avgMovement"]').placeholder=`${e.avgMovement}`,document.querySelector('.lock-limit-input[data-limit="URL"]').placeholder=`${e.URL}`}function rN(o,e,t,i){if(e.from.col==1)return o;let s=o.map(a=>new Date($n(a[0]))),r=864e5;if(s.length>=2){r=s[1].valueOf()-s[0].valueOf();for(let a=2;a<s.length;a++)if(s[a].valueOf()-s[a-1].valueOf()!=r)return o}let n=[];if(s.length<2){if(i=="down"){n=s.map(a=>new Date(new Date(a.valueOf()).setDate(a.getDate()+1)));for(let a=n.length;a<=t.to.row-t.from.row;a++){let l=n[n.length-1];n.push(new Date(new Date(l.valueOf()).setDate(l.getDate()+1)))}}else if(i=="up"){n=s.map(a=>new Date(new Date(a.valueOf()).setDate(a.getDate()-1)));for(let a=n.length;a<=t.to.row-t.from.row;a++){let l=n[0];n=[new Date(new Date(l.valueOf()).setDate(l.getDate()-1)),...n]}}return n.map(a=>[aN(a)])}if(i=="down"){n=s.map(a=>new Date(a.valueOf()+s.length*r));for(let a=n.length;a<=t.to.row-t.from.row;a++)n.push(new Date(n[n.length-1].valueOf()+r))}else if(i=="up"){n=s.map(a=>new Date(a.valueOf()-s.length*r));for(let a=n.length;a<=t.to.row-t.from.row;a++)n=[new Date(n[0].valueOf()-r),...n]}return n.map(a=>[aN(a)])}function nN(o,e){if(e.length>1)return;let t=e[0];for(let i=t.startRow+o.length;i<=t.endRow;i++)o.push(["",""])}function ZG(o,e){let t={},i=!1;o.forEach((s,r)=>{s&&(s in t?(e.setCellMeta(r,0,"className","duplicate"),i=!0):e.setCellMeta(r,0,"className",""),t[s]=!0)}),i?document.getElementById("duplicate-data-warning").classList.remove("hidden"):document.getElementById("duplicate-data-warning").classList.add("hidden")}function CN(){function o(e,t,i){return Math.abs(t+i-2*e)<.001}return _e.lockedLimitStatus&-2?IS(_e.lockedLimitStatus)&&AS(_e.lockedLimitStatus)||dN(_e.lockedLimitStatus)?o(_e.lockedLimits.avgX,_e.lockedLimits.UNPL,_e.lockedLimits.LNPL)?{useUpperQuartile:!0,useLowerQuartile:!0}:{useUpperQuartile:!1,useLowerQuartile:!1}:AS(_e.lockedLimitStatus)?{useUpperQuartile:!1,useLowerQuartile:!0}:IS(_e.lockedLimitStatus)?{useUpperQuartile:!0,useLowerQuartile:!1}:(console.assert(!1),{useUpperQuartile:!0,useLowerQuartile:!0}):{useUpperQuartile:!0,useLowerQuartile:!0}}function aN(o){let e=o.getTimezoneOffset();return o=new Date(o.getTime()-e*60*1e3),o.toISOString().slice(0,10)}function $n(o){return(0,uN.default)(o).valueOf()}function Al(o,e){o.splice(0,o.length,...LS(e))}function LS(o){return o.map(e=>({x:e.x,value:e.value,order:e.order,status:e.status}))}function Vr(){return(_e.lockedLimitStatus&1)==1}function MS(o){let e=new ArrayBuffer(o.length*4),t=new DataView(e);return o.forEach((i,s)=>{t.setFloat32(s*4,i)}),wN(new Uint8Array(e).reduce((i,s)=>i+String.fromCharCode(s),""))}function wN(o){return btoa(o).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function yN(o){return atob(o.replace(/-/g,"+").replace(/_/g,"/"))}function OS(o){let e=yN(o);var t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);let i=new DataView(t.buffer),s=[];for(let r=0;r<t.length/4;r++)s.push(i.getFloat32(r*4));return s}function QG(o){let e=mN(),t={v:e.get("v")??"0"};if(t.v=="1")t.d=e.get("d");else{let r=o.xdata.filter(l=>l.x||l.value),n=`${o.xLabel.replace(",",";")},${o.yLabel.replace(",",";")},`+r.map(l=>l.x?l.x.replace(",",";"):"").join(","),a=r.map(l=>Ii(l.value));t.d=wN(DS.default.compress(n))+"."+MS(a)}if(o.dividerLines){let r=MS(o.dividerLines.filter(n=>!VS(n)).map(n=>n.x));r.length>0&&(t.s=r)}o.lockedLimits&&(o.lockedLimitStatus&1)==1&&(t.l=MS([o.lockedLimits.avgX,o.lockedLimits.avgMovement,o.lockedLimits.LNPL,o.lockedLimits.UNPL,o.lockedLimits.URL,o.lockedLimitStatus]));let i=new URLSearchParams(t);return`${window.location.origin}${window.location.pathname}#${i.toString()}`}async function JG(o,e,t,i){let s=[],r=[];if(o=="1"){let u=await(await fetch(e)).json();r=[u.xLabel??"Date",u.yLabel??"Value"],s=u.xdata.map((g,p)=>({order:p,x:g.x,value:Ii(+g.value),status:0}))}else{e=decodeURIComponent(e),t=decodeURIComponent(t);let[c,u]=e.split(".",2),g=DS.default.decompress(yN(c)),p=OS(u),C=g.split(",").map(y=>y.replace(";",","));r=C.splice(0,2),s=C.map((y,S)=>({order:S,x:y,value:Ii(p[S]),status:0}))}let n=[];t?.length>0&&(n=n.concat(OS(t).map((c,u)=>({id:`divider-${u+1}`,x:c,line:null}))));let a=structuredClone(kS),l=0;if(i?.length>0){let[c,u,g,p,C,...y]=OS(i).map(Ii);y.length>0&&(l=y[0]),a={avgX:c,avgMovement:u,LNPL:g,UNPL:p,URL:C,lowerQuartile:(c+g)/2,upperQuartile:(c+p)/2}}return{xLabel:r[0].replace(";",","),yLabel:r[1].replace(";",","),data:s,dividerLines:n,lockedLimits:a,lockedLimitStatus:l}}function uf(){UG("xplot","mrplot")}var FS=()=>`<div class="plot-title">X Plot<span>${_e.yLabel.toLowerCase()!=="value"?": "+_e.yLabel:""}</span></div>`,BS=()=>`<div class="plot-title">MR Plot<span>${_e.yLabel.toLowerCase()!=="value"?": "+_e.yLabel:""}</span></div>`,Ol=o=>`<div class="axis-label-y">${o}</div>`;function ez(o){let e=1/0,t=-1/0;return o.forEach(i=>{let s=$n(i.x);e=Math.min(e,s),t=Math.max(t,s)}),{min:e,max:t}}function Ii(o){let e=10**BG;return Math.round(o*e)/e}function VS(o){return o.id&&(o.id=="divider-start"||o.id=="divider-end")}})();
/*! Bundled license information:

dompurify/dist/purify.js:
  (*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE *)

moment/moment.js:
  (*! moment.js *)
  (*! version : 2.29.4 *)
  (*! authors : Tim Wood, Iskren Chernev, Moment.js contributors *)
  (*! license : MIT *)
  (*! momentjs.com *)

pikaday/pikaday.js:
  (*!
   * Pikaday
   *
   * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
   *)

handsontable/i18n/languages/en-US.mjs:
  (**
   * @preserve
   * Authors: Handsoncode
   * Last updated: Nov 15, 2017
   *
   * Description: Definition file for English - United States language-country.
   *)
*/
